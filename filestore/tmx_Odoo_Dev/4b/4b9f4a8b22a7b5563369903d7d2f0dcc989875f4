
/* /base/static/src/js/res_config_settings.js defined in bundle 'web.assets_backend' */
odoo.define('base.settings',function(require){"use strict";var BasicModel=require('web.BasicModel');var core=require('web.core');var FormView=require('web.FormView');var FormController=require('web.FormController');var FormRenderer=require('web.FormRenderer');var view_registry=require('web.view_registry');var QWeb=core.qweb;var _t=core._t;var BaseSettingRenderer=FormRenderer.extend({events:_.extend({},FormRenderer.prototype.events,{'click .tab':'_onSettingTabClick','keyup .searchInput':'_onKeyUpSearch',}),init:function(){this._super.apply(this,arguments);this.activeView=false;this.activeTab=false;},confirmChange:function(){var self=this;return this._super.apply(this,arguments).then(function(){if(!self.$(".o_dirty_warning").length){self.$('.o_statusbar_buttons').append($('<span/>',{text:_t("Unsaved changes"),class:'text-muted ml-2 o_dirty_warning'}))}});},on_attach_callback:function(){this._super.apply(this,arguments);this.searchInput.focus();},displayTranslationAlert:function(){},_initModules:function(){var self=this;this.modules=[];_.each(this.$('.app_settings_block'),function(settingView,index){var group=!$(settingView).hasClass('o_invisible_modifier');var isNotApp=$(settingView).hasClass('o_not_app');if(group&&!isNotApp){var data=$(settingView).data();data.string=$(settingView).attr('string')||data.string;self.modules.push({key:data.key,string:data.string,imgurl:self._getAppIconUrl(data.key),});}else{$(settingView).remove();}});},_initSearch:function(){this.searchInput=this.$('.searchInput');if(this.searchText){this.searchInput.val(this.searchText);this._onKeyUpSearch();}else{this.searchText="";}},_currentAppIndex:function(){var self=this;var index=_.findIndex(this.modules,function(module){return module.key===self.activeSettingTab;});return index;},_getAppIconUrl:function(module){return module==="general_settings"?"/base/static/description/settings.png":"/"+module+"/static/description/icon.png";},_getSearchHeader:function(imgurl,string){return $(QWeb.render('BaseSetting.SearchHeader',{imgurl:imgurl,string:string}));},_moveToTab:function(index){this.currentIndex=!index||index===-1?0:(index===this.modules.length?index-1:index);if(this.currentIndex!==-1){if(this.activeView){this.activeView.addClass("o_hidden");}
if(this.activeTab){this.activeTab.removeClass("selected");}
var view=this.modules[this.currentIndex].settingView;var tab=this.$(".tab[data-key='"+this.modules[this.currentIndex].key+"']");view.removeClass("o_hidden");this.activeView=view;this.activeTab=tab;tab.addClass("selected");}},_onSettingTabClick:function(event){this.searchInput.focus();if(this.searchText.length>0){this.searchInput.val('');this.searchText="";this._searchSetting();}
var settingKey=this.$(event.currentTarget).data('key');this._moveToTab(_.findIndex(this.modules,function(m){return m.key===settingKey;}));},_onKeyUpSearch:function(event){this.searchText=this.searchInput.val();this.activeTab.removeClass('selected');this._searchSetting();},_resetSearch:function(){this.searchInput.val("");_.each(this.modules,function(module){module.settingView.addClass('o_hidden');module.settingView.find('.o_setting_box').removeClass('o_hidden');module.settingView.find('h2').removeClass('o_hidden');module.settingView.find('.settingSearchHeader').addClass('o_hidden');module.settingView.find('.o_settings_container').addClass('mt16');});this.activeTab.removeClass('o_hidden').addClass('selected');this.activeView.removeClass('o_hidden');},_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){self._initModules();self._renderLeftPanel();self._initSearch();});},_renderLeftPanel:function(){var self=this;_.each(this.modules,function(module){module.settingView=self.$('.app_settings_block[data-key="'+module.key+'"]');module.settingView.addClass("o_hidden");module.settingView.prepend(self._getSearchHeader(module.imgurl,module.string));});this._renderTabs();this._moveToTab(this.currentIndex||this._currentAppIndex());},_renderTabs:function(){var tabs=$(QWeb.render('BaseSetting.Tabs',{tabItems:this.modules}));tabs.appendTo(this.$(".settings_tab"));},_searchSetting:function(){var self=this;this.count=0;_.each(this.modules,function(module){self.inVisibleCount=0;module.settingView.find('.o_setting_box').addClass('o_hidden');module.settingView.find('h2').addClass('o_hidden');module.settingView.find('.settingSearchHeader').addClass('o_hidden');module.settingView.find('.o_settings_container').removeClass('mt16');var resultSetting=module.settingView.find(".o_form_label:containsTextLike('"+self.searchText+"')");if(resultSetting.length>0){resultSetting.each(function(){var settingBox=$(this).closest('.o_setting_box');if(!settingBox.hasClass('o_invisible_modifier')){settingBox.removeClass('o_hidden');$(this).html(self._wordHighlighter($(this).html(),self.searchText));}else{self.inVisibleCount++;}});if(self.inVisibleCount!==resultSetting.length){module.settingView.find('.settingSearchHeader').removeClass('o_hidden');module.settingView.removeClass('o_hidden');}}else{++self.count;}});this.count===_.size(this.modules)?this.$('.notFound').removeClass('o_hidden'):this.$('.notFound').addClass('o_hidden');if(this.searchText.length===0){this._resetSearch();}},_wordHighlighter:function(text,word){if(text.indexOf('highlighter')!==-1){text=text.replace('<span class="highlighter">',"");text=text.replace("</span>","");}
var match=text.search(new RegExp(word,"i"));word=text.substring(match,match+word.length);var highlightedWord="<span class='highlighter'>"+word+'</span>';return text.replace(word,highlightedWord);},});var BaseSettingController=FormController.extend({custom_events:_.extend({},FormController.prototype.custom_events,{button_clicked:'_onButtonClicked',}),init:function(){this._super.apply(this,arguments);this.disableAutofocus=true;this.renderer.activeSettingTab=this.initialState.context.module;},willRestore:function(){this.mode='edit';},_onButtonClicked:function(ev){var self=this;if(ev.data.attrs.name!=='execute'&&ev.data.attrs.name!=='cancel'){var recordID=ev.data.recordID;var _super=this._super;var args=arguments;this._discardChanges(recordID,{noAbandon:true}).then(function(){_super.apply(self,args);});}else{this._super.apply(this,arguments);}},});var BaseSettingsModel=BasicModel.extend({save:function(recordID){var self=this;return this._super.apply(this,arguments).then(function(result){delete self.localData[recordID].res_id;return result;});},});var BaseSettingView=FormView.extend({jsLibs:[],config:_.extend({},FormView.prototype.config,{Model:BaseSettingsModel,Renderer:BaseSettingRenderer,Controller:BaseSettingController,}),});view_registry.add('base_settings',BaseSettingView);return{Model:BaseSettingsModel,Renderer:BaseSettingRenderer,Controller:BaseSettingController,};});;

/* /web/static/lib/jquery.scrollTo/jquery.scrollTo.js defined in bundle 'web.assets_backend' */
;(function(define){'use strict';define(['jquery'],function($){var $scrollTo=$.scrollTo=function(target,duration,settings){return $(window).scrollTo(target,duration,settings);};$scrollTo.defaults={axis:'xy',duration:0,limit:true};$scrollTo.window=function(scope){return $(window)._scrollable();};$.fn._scrollable=function(){return this.map(function(){var elem=this,isWin=!elem.nodeName||$.inArray(elem.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!isWin)
return elem;var doc=(elem.contentWindow||elem).document||elem.ownerDocument||elem;return/webkit/i.test(navigator.userAgent)||doc.compatMode=='BackCompat'?doc.body:doc.documentElement;});};$.fn.scrollTo=function(target,duration,settings){if(typeof duration=='object'){settings=duration;duration=0;}
if(typeof settings=='function')
settings={onAfter:settings};if(target=='max')
target=9e9;settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.duration;settings.queue=settings.queue&&settings.axis.length>1;if(settings.queue)
duration/=2;settings.offset=both(settings.offset);settings.over=both(settings.over);return this._scrollable().each(function(){if(target==null)return;var elem=this,$elem=$(elem),targ=target,toff,attr={},win=$elem.is('html,body');switch(typeof targ){case'number':case'string':if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break;}
targ=win?$(targ):$(targ,this);if(!targ.length)return;case'object':if(targ.is||targ.style)
toff=(targ=$(targ)).offset();}
var offset=$.isFunction(settings.offset)&&settings.offset(elem,targ)||settings.offset;$.each(settings.axis.split(''),function(i,axis){var Pos=axis=='x'?'Left':'Top',pos=Pos.toLowerCase(),key='scroll'+Pos,old=elem[key],max=$scrollTo.max(elem,axis);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css('margin'+Pos))||0;attr[key]-=parseInt(targ.css('border'+Pos+'Width'))||0;}
attr[key]+=offset[pos]||0;if(settings.over[pos])
attr[key]+=targ[axis=='x'?'width':'height']()*settings.over[pos];}else{var val=targ[pos];attr[key]=val.slice&&val.slice(-1)=='%'?parseFloat(val)/100*max:val;}
if(settings.limit&&/^\d+$/.test(attr[key]))
attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&settings.queue){if(old!=attr[key])
animate(settings.onAfterFirst);delete attr[key];}});animate(settings.onAfter);function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,targ,settings);});}}).end();};$scrollTo.max=function(elem,axis){var Dim=axis=='x'?'Width':'Height',scroll='scroll'+Dim;if(!$(elem).is('html,body'))
return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size='client'+Dim,html=elem.ownerDocument.documentElement,body=elem.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size]);};function both(val){return $.isFunction(val)||$.isPlainObject(val)?val:{top:val,left:val};}
return $scrollTo;})}(typeof define==='function'&&define.amd?define:function(deps,factory){if(typeof module!=='undefined'&&module.exports){module.exports=factory(require('jquery'));}else{factory(jQuery);}}));;

/* /web/static/lib/fuzzy-master/fuzzy.js defined in bundle 'web.assets_backend' */
(function(){var root=this;var fuzzy={};if(typeof exports!=='undefined'){module.exports=fuzzy;}else{root.fuzzy=fuzzy;}
fuzzy.simpleFilter=function(pattern,array){return array.filter(function(string){return fuzzy.test(pattern,string);});};fuzzy.test=function(pattern,string){return fuzzy.match(pattern,string)!==null;};fuzzy.match=function(pattern,string,opts){opts=opts||{};var patternIdx=0,result=[],len=string.length,totalScore=0,currScore=0,pre=opts.pre||'',post=opts.post||'',compareString=opts.caseSensitive&&string||string.toLowerCase(),ch,compareChar;pattern=opts.caseSensitive&&pattern||pattern.toLowerCase();for(var idx=0;idx<len;idx++){ch=string[idx];if(compareString[idx]===pattern[patternIdx]){if(pattern[patternIdx]===' '){currScore=1-idx/200;}else{currScore+=1+currScore-idx/200;}
ch=pre+ch+post;patternIdx+=1;}else{currScore=0;}
totalScore+=currScore;if(compareString[idx]===' '){currScore=0;}
result[result.length]=ch;}
if(patternIdx===pattern.length){return{rendered:result.join(''),score:totalScore};}
return null;};fuzzy.filter=function(pattern,arr,opts){if(!arr||arr.length===0){return[]}
if(typeof pattern!=='string'){return arr}
opts=opts||{};return arr.reduce(function(prev,element,idx,arr){var str=element;if(opts.extract){str=opts.extract(element);}
var rendered=fuzzy.match(pattern,str,opts);if(rendered!=null){prev[prev.length]={string:rendered.rendered,score:rendered.score,index:idx,original:element};}
return prev;},[]).sort(function(a,b){var compare=b.score-a.score;if(compare)return compare;return a.index-b.index;});};}());;

/* <inline asset> defined in bundle 'web.assets_backend' */
odoo._modules=["base","web","base_setup","bus","web_tour","mail","sales_team","product","web_editor","http_routing","auth_signup","portal","resource","digest","account","payment","utm","contacts","sale","sale_management","calendar","crm","website","barcodes","stock","purchase","rating","project","web_kanban_gauge","mass_mailing","hr","hr_holidays","hr_recruitment","base_account_budget","account_check_printing","base_accounting_kit","sh_message","db_import_lead","maintenance","hr_timesheet","sh_all_in_one_helpdesk","sh_all_in_one_website_helpdesk","sh_import_lead","sh_office365_connector","fleet","repair","website_partner","website_mail","google_recaptcha","website_form","website_hr_recruitment","web_responsive","website_crm","purchase_stock","auth_totp","auth_totp_portal","base_automation","base_import","crm_iap_lead","hr_org_chart","iap","l10n_generic_coa","l10n_us","mail_bot","partner_autocomplete","payment_transfer","portal_rating","sale_stock","sale_timesheet","sale_timesheet_edit","sms","snailmail","snailmail_account","website_form_project","website_links","website_mass_mailing","web_unsplash"];;

/* /web/static/lib/py.js/lib/py.js defined in bundle 'web.assets_backend' */
var py={};(function(py){var create=function(o,props){function F(){}
F.prototype=o;var inst=new F;if(props){for(var name in props){if(!props.hasOwnProperty(name)){continue;}
inst[name]=props[name];}}
return inst;};var symbols={};var comparators={};var Base={nud:function(){throw new Error(this.id+" undefined as prefix");},led:function(led){throw new Error(this.id+" undefined as infix");},toString:function(){if(this.id==='(constant)'||this.id==='(number)'||this.id==='(name)'||this.id==='(string)'){return[this.id.slice(0,this.id.length-1),' ',this.value,')'].join('');}else if(this.id==='(end)'){return'(end)';}else if(this.id==='(comparator)'){var repr=['(comparator',this.expressions[0]];for(var i=0;i<this.operators.length;++i){repr.push(this.operators[i],this.expressions[i+1]);}
return repr.join(' ')+')';}
var out=[this.id,this.first,this.second,this.third].filter(function(r){return r}).join(' ');return'('+out+')';}};function symbol(id,bp){bp=bp||0;var s=symbols[id];if(s){if(bp>s.lbp){s.lbp=bp;}
return s;}
return symbols[id]=create(Base,{id:id,lbp:bp});}
function constant(id){var s=symbol(id);s.id='(constant)';s.value=id;s.nud=function(){return this;};}
function prefix(id,bp,nud){symbol(id).nud=nud||function(){this.first=expression(bp);return this}}
function infix(id,bp,led){symbol(id,bp).led=led||function(left){this.first=left;this.second=expression(bp);return this;}}
function infixr(id,bp){symbol(id,bp).led=function(left){this.first=left;this.second=expression(bp-1);return this;}}
function comparator(id){comparators[id]=true;var bp=60;infix(id,bp,function(left){this.id='(comparator)';this.operators=[id];this.expressions=[left,expression(bp)];while(token.id in comparators){this.operators.push(token.id);advance();this.expressions.push(expression(bp));}
return this;});}
constant('None');constant('False');constant('True');symbol('(number)').nud=function(){return this;};symbol('(name)').nud=function(){return this;};symbol('(string)').nud=function(){return this;};symbol('(end)');symbol(':');symbol(')');symbol(']');symbol('}');symbol(',');symbol('else');infix('=',10,function(left){if(left.id!=='(name)'){throw new Error("Expected keyword argument name, got "+token.id);}
this.first=left;this.second=expression();return this;});symbol('lambda',20).nud=function(){this.first=[];if(token.id!==':'){for(;;){if(token.id!=='(name)'){throw new Error('Excepted an argument name');}
this.first.push(token);advance();if(token.id!==','){break;}
advance(',');}}
advance(':');this.second=expression();return this;};infix('if',20,function(left){this.ifTrue=left;this.condition=expression();advance('else');this.ifFalse=expression();return this;});infixr('or',30);infixr('and',40);prefix('not',50);comparator('in');comparator('not in');comparator('is');comparator('is not');comparator('<');comparator('<=');comparator('>');comparator('>=');comparator('<>');comparator('!=');comparator('==');infix('|',70);infix('^',80);infix('&',90);infix('<<',100);infix('>>',100);infix('+',110);infix('-',110);infix('*',120);infix('/',120);infix('//',120);infix('%',120);prefix('-',130);prefix('+',130);prefix('~',130);infixr('**',140);infix('.',150,function(left){if(token.id!=='(name)'){throw new Error('Expected attribute name, got '+token.id);}
this.first=left;this.second=token;advance();return this;});symbol('(',150).nud=function(){this.first=[];var comma=false;if(token.id!==')'){while(true){if(token.id===')'){break;}
this.first.push(expression());if(token.id!==','){break;}
comma=true;advance(',');}}
advance(')');if(!this.first.length||comma){return this;}else{return this.first[0];}};symbol('(').led=function(left){this.first=left;this.second=[];if(token.id!==")"){for(;;){this.second.push(expression());if(token.id!==','){break;}
advance(',');}}
advance(")");return this;};infix('[',150,function(left){this.first=left;this.second=expression();advance("]");return this;});symbol('[').nud=function(){this.first=[];if(token.id!==']'){for(;;){if(token.id===']'){break;}
this.first.push(expression());if(token.id!==','){break;}
advance(',');}}
advance(']');return this;};symbol('{').nud=function(){this.first=[];if(token.id!=='}'){for(;;){if(token.id==='}'){break;}
var key=expression();advance(':');var value=expression();this.first.push([key,value]);if(token.id!==','){break;}
advance(',');}}
advance('}');return this;};py.tokenize=(function(){function group(){return'('+Array.prototype.join.call(arguments,'|')+')';}
var Whitespace='[ \\f\\t]*';var Name='[a-zA-Z_]\\w*';var DecNumber='\\d+(L|l)?';var IntNumber=DecNumber;var PointFloat=group('\\d+\\.\\d*','\\.\\d+');var FloatNumber=PointFloat;var Number=group(FloatNumber,IntNumber);var Operator=group("\\*\\*=?",">>=?","<<=?","<>","!=","//=?","[+\\-*/%&|^=<>]=?","~");var Bracket='[\\[\\]\\(\\)\\{\\}]';var Special='[:;.,`@]';var Funny=group(Operator,Bracket,Special);var ContStr=group("([uU])?'([^\n'\\\\]*(?:\\\\.[^\n'\\\\]*)*)'",'([uU])?"([^\n"\\\\]*(?:\\\\.[^\n"\\\\]*)*)"');var PseudoToken=Whitespace+group(Number,Funny,ContStr,Name);var number_pattern=new RegExp('^'+Number+'$');var string_pattern=new RegExp('^'+ContStr+'$');var name_pattern=new RegExp('^'+Name+'$');var strip=new RegExp('^'+Whitespace);return function tokenize(s){var max=s.length,tokens=[],start,end;var pseudoprog=new RegExp(PseudoToken,'g');while(pseudoprog.lastIndex<max){var pseudomatch=pseudoprog.exec(s);if(!pseudomatch){if(/^\s+$/.test(s.slice(end))){break;}
throw new Error('Failed to tokenize <<'+s
+'>> at index '+(end||0)
+'; parsed so far: '+tokens);}
start=pseudomatch.index;end=pseudoprog.lastIndex;var token=s.slice(start,end).replace(strip,'');if(number_pattern.test(token)){tokens.push(create(symbols['(number)'],{value:parseFloat(token)}));}else if(string_pattern.test(token)){var m=string_pattern.exec(token);tokens.push(create(symbols['(string)'],{value:PY_decode_string_literal(m[3]!==undefined?m[3]:m[5],!!(m[2]||m[4]))}));}else if(token in symbols){var symbol;if(token==='in'&&tokens.length>1&&tokens[tokens.length-1].id==='not'){symbol=symbols['not in'];tokens.pop();}else if(token==='not'&&tokens.length>1&&tokens[tokens.length-1].id==='is'){symbol=symbols['is not'];tokens.pop();}else{symbol=symbols[token];}
tokens.push(create(symbol));}else if(name_pattern.test(token)){tokens.push(create(symbols['(name)'],{value:token}));}else{throw new Error("Tokenizing failure of <<"+s+">> at index "+start
+" for token [["+token+"]]"
+"; parsed so far: "+tokens);}}
tokens.push(create(symbols['(end)']));return tokens;}})();var token,next;function expression(rbp){rbp=rbp||0;var t=token;token=next();var left=t.nud();while(rbp<token.lbp){t=token;token=next();left=t.led(left);}
return left;}
function advance(id){if(id&&token.id!==id){throw new Error('Expected "'+id+'", got "'+token.id+'"');}
token=next();}
function PY_ensurepy(val,name){switch(val){case undefined:throw new Error("NameError: name '"+name+"' is not defined");case null:return py.None;case true:return py.True;case false:return py.False;}
var fn=function(){};fn.prototype=py.object;if(py.PY_isInstance(val,py.object)||py.PY_isSubclass(val,py.object)){return val;}
switch(typeof val){case'number':return py.float.fromJSON(val);case'string':return py.str.fromJSON(val);case'function':return py.PY_def.fromJSON(val);}
switch(val.constructor){case Object:var o=py.PY_call(py.object);for(var prop in val){if(val.hasOwnProperty(prop)){o[prop]=val[prop];}}
return o;case Array:return py.list.fromJSON(val);}
throw new Error("Could not convert "+val+" to a pyval");}
var typename=function(obj){if(obj.__class__){return obj.__class__.__name__;}else if(typeof obj!=='object'){return typeof obj;}else{return obj.constructor.name;}};py.py={};py.PY_parseArgs=function PY_parseArgs(argument,format){var out={};var args=argument[0];var kwargs={};for(var k in argument[1]){if(!argument[1].hasOwnProperty(k)){continue;}
kwargs[k]=argument[1][k];}
if(typeof format==='string'){format=format.split(/\s+/);}
var name=function(spec){if(typeof spec==='string'){return spec;}else if(spec instanceof Array&&spec.length===2){return spec[0];}
throw new Error("TypeError: unknown format specification "+
JSON.stringify(spec));};var spec;for(var i=0;i<args.length;++i){spec=format[i];if(!spec||spec==='*'){throw new Error("TypeError: function takes exactly "+(i-1)+" positional arguments ("+args.length+" given")}else if(/^\*\w/.test(spec)){out[name(spec.slice(1))]=args.slice(i);break;}
out[name(spec)]=args[i];}
for(var j=i;j<format.length;++j){spec=format[j];var n=name(spec);if(n in out){throw new Error("TypeError: function got multiple values "+"for keyword argument '"+kwarg+"'");}
if(/^\*\*\w/.test(n)){out[n.slice(2)]=kwargs;kwargs={};break;}
if(n in kwargs){out[n]=kwargs[n];delete kwargs[n];}}
for(var key in kwargs){throw new Error("TypeError: function got an unexpected keyword argument '"
+key+"'");}
var kwonly=0;for(var k=0;k<format.length;++k){if(/^\*/.test(format[k])){kwonly=1;break;}}
for(var k=0;k<format.length;++k){spec=format[k];var n=name(spec);if(/^\*/.test(n)||n in out){continue;}
if(!(spec instanceof Array)){throw new Error("TypeError: function takes exactly "+(format.length-kwonly)
+" arguments");}
out[n]=spec[1];}
return out;};py.PY_hasAttr=function(o,attr_name){try{py.PY_getAttr(o,attr_name);return true;}catch(e){return false;}};py.PY_getAttr=function(o,attr_name){return PY_ensurepy(o.__getattribute__(attr_name));};py.PY_str=function(o){var v=o.__str__();if(py.PY_isInstance(v,py.str)){return v;}
throw new Error('TypeError: __str__ returned non-string (type '
+typename(v)
+')');};py.PY_isInstance=function(inst,cls){var fn=function(){};fn.prototype=cls;return inst instanceof fn;};py.PY_isSubclass=function(derived,cls){var fn=function(){};fn.prototype=cls;return derived===cls||derived instanceof fn;};py.PY_call=function(callable,args,kwargs){if(!args){args=[];}
if(typeof args==='object'&&!(args instanceof Array)){kwargs=args;args=[];}
if(!kwargs){kwargs={};}
if(callable.__is_type){var instance=callable.__new__.call(callable,args,kwargs);var typ=function(){};typ.prototype=callable;if(instance instanceof typ){instance.__init__.call(instance,args,kwargs);}
return instance}
return callable.__call__(args,kwargs);};py.PY_isTrue=function(o){var res=o.__nonzero__();if(res===py.True){return true;}
if(res===py.False){return false;}
throw new Error("TypeError: __nonzero__ should return bool, returned "
+typename(res));};py.PY_not=function(o){return!py.PY_isTrue(o);};py.PY_size=function(o){if(!o.__len__){throw new Error("TypeError: object of type '"+
typename(o)+"' has no len()");}
var v=o.__len__();if(typeof v!=='number'){throw new Error("TypeError: a number is required");}
return v;};py.PY_getItem=function(o,key){if(!('__getitem__'in o)){throw new Error("TypeError: '"+typename(o)+"' object is unsubscriptable")}
if(!py.PY_isInstance(key,py.object)){throw new Error("TypeError: '"+typename(key)+"' is not a py.js object");}
var res=o.__getitem__(key);if(!py.PY_isInstance(key,py.object)){throw new Error("TypeError: __getitem__ must return a py.js object, got "
+typename(res));}
return res;};py.PY_setItem=function(o,key,v){if(!('__setitem__'in o)){throw new Error("TypeError: '"+typename(o)+"' object does not support item assignment");}
if(!py.PY_isInstance(key,py.object)){throw new Error("TypeError: '"+typename(key)+"' is not a py.js object");}
if(!py.PY_isInstance(v,py.object)){throw new Error("TypeError: '"+typename(v)+"' is not a py.js object");}
o.__setitem__(key,v);};py.PY_add=function(o1,o2){return PY_op(o1,o2,'+');};py.PY_subtract=function(o1,o2){return PY_op(o1,o2,'-');};py.PY_multiply=function(o1,o2){return PY_op(o1,o2,'*');};py.PY_divide=function(o1,o2){return PY_op(o1,o2,'/');};py.PY_negative=function(o){if(!o.__neg__){throw new Error("TypeError: bad operand for unary -: '"
+typename(o)
+"'");}
return o.__neg__();};py.PY_positive=function(o){if(!o.__pos__){throw new Error("TypeError: bad operand for unary +: '"
+typename(o)
+"'");}
return o.__pos__();};py.type=function type(name,bases,dict){if(typeof name!=='string'){throw new Error("ValueError: a class name should be a string");}
if(!bases||bases.length===0){bases=[py.object];}else if(bases.length>1){throw new Error("ValueError: can't provide multiple bases for a "
+"new type");}
var base=bases[0];var ClassObj=create(base);if(dict){for(var k in dict){if(!dict.hasOwnProperty(k)){continue;}
ClassObj[k]=dict[k];}}
ClassObj.__class__=ClassObj;ClassObj.__name__=name;ClassObj.__bases__=bases;ClassObj.__is_type=true;return ClassObj;};py.type.__call__=function(){var args=py.PY_parseArgs(arguments,['object']);return args.object.__class__;};var hash_counter=0;py.object=py.type('object',[{}],{__new__:function(){var inst=create(this);inst.__is_type=false;return inst;},__init__:function(){},__hash__:function(){if(this._hash){return this._hash;}
return this._hash='\0\0\0'+String(hash_counter++);},__eq__:function(other){return(this===other)?py.True:py.False;},__ne__:function(other){if(py.PY_isTrue(this.__eq__(other))){return py.False;}else{return py.True;}},__lt__:function(){return py.NotImplemented;},__le__:function(){return py.NotImplemented;},__ge__:function(){return py.NotImplemented;},__gt__:function(){return py.NotImplemented;},__str__:function(){return this.__unicode__();},__unicode__:function(){return py.str.fromJSON('<'+typename(this)+' object>');},__nonzero__:function(){return py.True;},__getattribute__:function(name){if(name in this){var val=this[name];if(typeof val==='object'&&'__get__'in val){return val.__get__(this,py.PY_call(py.type,[this]));}
if(typeof val==='function'&&!this.hasOwnProperty(name)){return PY_instancemethod.fromJSON(val,this);}
return val;}
if('__getattr__'in this){return this.__getattr__(name);}
throw new Error("AttributeError: object has no attribute '"+name+"'");},__setattr__:function(name,value){if(name in this&&'__set__'in this[name]){this[name].__set__(this,value);}
this[name]=value;},toJSON:function(){throw new Error(this.constructor.name+' can not be converted to JSON');}});var NoneType=py.type('NoneType',null,{__nonzero__:function(){return py.False;},toJSON:function(){return null;}});py.None=py.PY_call(NoneType);var NotImplementedType=py.type('NotImplementedType',null,{});py.NotImplemented=py.PY_call(NotImplementedType);var booleans_initialized=false;py.bool=py.type('bool',null,{__new__:function(){if(!booleans_initialized){return py.object.__new__.apply(this);}
var ph={};var args=py.PY_parseArgs(arguments,[['value',ph]]);if(args.value===ph){return py.False;}
return py.PY_isTrue(args.value)?py.True:py.False;},__str__:function(){return py.str.fromJSON((this===py.True)?"True":"False");},__nonzero__:function(){return this;},fromJSON:function(val){return val?py.True:py.False},toJSON:function(){return this===py.True;}});py.True=py.PY_call(py.bool);py.False=py.PY_call(py.bool);booleans_initialized=true;py.float=py.type('float',null,{__init__:function(){var placeholder={};var args=py.PY_parseArgs(arguments,[['value',placeholder]]);var value=args.value;if(value===placeholder){this._value=0;return;}
if(py.PY_isInstance(value,py.float)){this._value=value._value;}
if(py.PY_isInstance(value,py.object)&&'__float__'in value){var res=value.__float__();if(py.PY_isInstance(res,py.float)){this._value=res._value;return;}
throw new Error('TypeError: __float__ returned non-float (type '+
typename(res)+')');}
throw new Error('TypeError: float() argument must be a string or a number');},__str__:function(){return py.str.fromJSON(String(this._value));},__eq__:function(other){return this._value===other._value?py.True:py.False;},__lt__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return this._value<other._value?py.True:py.False;},__le__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return this._value<=other._value?py.True:py.False;},__gt__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return this._value>other._value?py.True:py.False;},__ge__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return this._value>=other._value?py.True:py.False;},__abs__:function(){return py.float.fromJSON(Math.abs(this._value));},__add__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return py.float.fromJSON(this._value+other._value);},__mod__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return py.float.fromJSON(this._value%other._value);},__neg__:function(){return py.float.fromJSON(-this._value);},__sub__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return py.float.fromJSON(this._value-other._value);},__mul__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return py.float.fromJSON(this._value*other._value);},__pow__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return py.float.fromJSON(this._value**other._value);},__div__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
return py.float.fromJSON(this._value/other._value);},__nonzero__:function(){return this._value?py.True:py.False;},fromJSON:function(v){if(!(typeof v==='number')){throw new Error('py.float.fromJSON can only take numbers');}
var instance=py.PY_call(py.float);instance._value=v;return instance;},toJSON:function(){return this._value;}});py.str=py.type('str',null,{__init__:function(){var placeholder={};var args=py.PY_parseArgs(arguments,[['value',placeholder]]);var s=args.value;if(s===placeholder){this._value='';return;}
this._value=py.PY_str(s)._value;},__hash__:function(){return'\1\0\1'+this._value;},__str__:function(){return this;},__eq__:function(other){if(py.PY_isInstance(other,py.str)&&this._value===other._value){return py.True;}
return py.False;},__lt__:function(other){if(py.PY_not(py.PY_call(py.isinstance,[other,py.str]))){return py.NotImplemented;}
return this._value<other._value?py.True:py.False;},__le__:function(other){if(!py.PY_isInstance(other,py.str)){return py.NotImplemented;}
return this._value<=other._value?py.True:py.False;},__gt__:function(other){if(!py.PY_isInstance(other,py.str)){return py.NotImplemented;}
return this._value>other._value?py.True:py.False;},__ge__:function(other){if(!py.PY_isInstance(other,py.str)){return py.NotImplemented;}
return this._value>=other._value?py.True:py.False;},__add__:function(other){if(!py.PY_isInstance(other,py.str)){return py.NotImplemented;}
return py.str.fromJSON(this._value+other._value);},__nonzero__:function(){return this._value.length?py.True:py.False;},__contains__:function(s){return(this._value.indexOf(s._value)!==-1)?py.True:py.False;},fromJSON:function(s){if(typeof s==='string'){var instance=py.PY_call(py.str);instance._value=s;return instance;}
throw new Error("str.fromJSON can only take strings");},toJSON:function(){return this._value;}});py.tuple=py.type('tuple',null,{__init__:function(){this._values=[];},__len__:function(){return this._values.length;},__nonzero__:function(){return py.PY_size(this)>0?py.True:py.False;},__contains__:function(value){for(var i=0,len=this._values.length;i<len;++i){if(py.PY_isTrue(this._values[i].__eq__(value))){return py.True;}}
return py.False;},__getitem__:function(index){return this._values[index.toJSON()];},toJSON:function(){var out=[];for(var i=0;i<this._values.length;++i){out.push(this._values[i].toJSON());}
return out;},fromJSON:function(ar){if(!(ar instanceof Array)){throw new Error("Can only create a py.tuple from an Array");}
var t=py.PY_call(py.tuple);for(var i=0;i<ar.length;++i){t._values.push(PY_ensurepy(ar[i]));}
return t;}});py.list=py.type('list',null,{__nonzero__:function(){return this.__len__>0?py.True:py.False;},});_.defaults(py.list,py.tuple)
py.dict=py.type('dict',null,{__init__:function(){this._store={};},__getitem__:function(key){var h=key.__hash__();if(!(h in this._store)){throw new Error("KeyError: '"+key.toJSON()+"'");}
return this._store[h][1];},__setitem__:function(key,value){this._store[key.__hash__()]=[key,value];},__len__:function(){return Object.keys(this._store).length},__nonzero__:function(){return py.PY_size(this)>0?py.True:py.False;},get:function(){var args=py.PY_parseArgs(arguments,['k',['d',py.None]]);var h=args.k.__hash__();if(!(h in this._store)){return args.d;}
return this._store[h][1];},fromJSON:function(d){var instance=py.PY_call(py.dict);for(var k in(d||{})){if(!d.hasOwnProperty(k)){continue;}
instance.__setitem__(py.str.fromJSON(k),PY_ensurepy(d[k]));}
return instance;},toJSON:function(){var out={};for(var k in this._store){var item=this._store[k];out[item[0].toJSON()]=item[1].toJSON();}
return out;}});py.PY_def=py.type('function',null,{__call__:function(){return this._func.apply(this._inst,arguments);},fromJSON:function(nativefunc){var instance=py.PY_call(py.PY_def);instance._inst=null;instance._func=nativefunc;return instance;},toJSON:function(){return this._func;}});py.classmethod=py.type('classmethod',null,{__init__:function(){var args=py.PY_parseArgs(arguments,'function');this._func=args['function'];},__get__:function(obj,type){return PY_instancemethod.fromJSON(this._func,type);},fromJSON:function(func){return py.PY_call(py.classmethod,[func]);}});var PY_instancemethod=py.type('instancemethod',[py.PY_def],{fromJSON:function(nativefunc,instance){var inst=py.PY_call(PY_instancemethod);inst._inst=instance;inst._func=nativefunc;return inst;}});py.abs=new py.PY_def.fromJSON(function abs(){var args=py.PY_parseArgs(arguments,['number']);if(!args.number.__abs__){throw new Error("TypeError: bad operand type for abs(): '"
+typename(args.number)
+"'");}
return args.number.__abs__();});py.len=new py.PY_def.fromJSON(function len(){var args=py.PY_parseArgs(arguments,['object']);return py.float.fromJSON(py.PY_size(args.object));});py.isinstance=new py.PY_def.fromJSON(function isinstance(){var args=py.PY_parseArgs(arguments,['object','class']);return py.PY_isInstance(args.object,args['class'])?py.True:py.False;});py.issubclass=new py.PY_def.fromJSON(function issubclass(){var args=py.PY_parseArgs(arguments,['C','B']);return py.PY_isSubclass(args.C,args.B)?py.True:py.False;});var PY_decode_string_literal=function(str,unicode){var out=[],code;var direct_map={'\\':'\\','"':'"',"'":"'",'a':'\x07','b':'\x08','f':'\x0c','n':'\n','r':'\r','t':'\t','v':'\v'};for(var i=0;i<str.length;++i){if(str[i]!=='\\'){out.push(str[i]);continue;}
var escape=str[i+1];if(escape in direct_map){out.push(direct_map[escape]);++i;continue;}
switch(escape){case'\n':++i;continue;case'N':if(!unicode){break;}
throw Error("SyntaxError: \\N{} escape not implemented");case'u':if(!unicode){break;}
var uni=str.slice(i+2,i+6);if(!/[0-9a-f]{4}/i.test(uni)){throw new Error(["SyntaxError: (unicode error) 'unicodeescape' codec"," can't decode bytes in position ",i,"-",i+4,": truncated \\uXXXX escape"].join(''));}
code=parseInt(uni,16);out.push(String.fromCharCode(code));i+=5;continue;case'U':if(!unicode){break;}
throw Error("SyntaxError: \\U escape not implemented");case'x':var hex=str.slice(i+2,i+4);if(!/[0-9a-f]{2}/i.test(hex)){if(!unicode){throw new Error('ValueError: invalid \\x escape');}
throw new Error(["SyntaxError: (unicode error) 'unicodeescape'"," codec can't decode bytes in position ",i,'-',i+2,": truncated \\xXX escape"].join(''))}
code=parseInt(hex,16);out.push(String.fromCharCode(code));i+=3;continue;default:if(!/[0-8]/.test(escape)){break;}
var r=/[0-8]{1,3}/g;r.lastIndex=i+1;var m=r.exec(str);var oct=m[0];code=parseInt(oct,8);out.push(String.fromCharCode(code));i+=oct.length;continue;}
out.push('\\');}
return out.join('');};var PY_operators={'==':['eq','eq',function(a,b){return a===b;}],'!=':['ne','ne',function(a,b){return a!==b;}],'<>':['ne','ne',function(a,b){return a!==b;}],'<':['lt','gt',function(a,b){return a.__class__.__name__<b.__class__.__name__;}],'<=':['le','ge',function(a,b){return a.__class__.__name__<=b.__class__.__name__;}],'>':['gt','lt',function(a,b){return a.__class__.__name__>b.__class__.__name__;}],'>=':['ge','le',function(a,b){return a.__class__.__name__>=b.__class__.__name__;}],'+':['add','radd'],'-':['sub','rsub'],'*':['mul','rmul'],'/':['div','rdiv'],'//':['floordiv','rfloordiv'],'%':['mod','rmod'],'**':['pow','rpow'],'<<':['lshift','rlshift'],'>>':['rshift','rrshift'],'&':['and','rand'],'^':['xor','rxor'],'|':['or','ror']};var PY_op=function(o1,o2,op){var r;var methods=PY_operators[op];var forward='__'+methods[0]+'__',reverse='__'+methods[1]+'__';var otherwise=methods[2];if(forward in o1&&(r=o1[forward](o2))!==py.NotImplemented){return r;}
if(reverse in o2&&(r=o2[reverse](o1))!==py.NotImplemented){return r;}
if(otherwise){return PY_ensurepy(otherwise(o1,o2));}
throw new Error("TypeError: unsupported operand type(s) for "+op+": '"
+typename(o1)+"' and '"+typename(o2)+"'");};var PY_builtins={type:py.type,None:py.None,True:py.True,False:py.False,NotImplemented:py.NotImplemented,object:py.object,bool:py.bool,float:py.float,str:py.str,unicode:py.unicode,tuple:py.tuple,list:py.list,dict:py.dict,abs:py.abs,len:py.len,isinstance:py.isinstance,issubclass:py.issubclass,classmethod:py.classmethod,};py.parse=function(toks){var index=0;token=toks[0];next=function(){return toks[++index];};return expression();};var evaluate_operator=function(operator,a,b){switch(operator){case'is':return a===b?py.True:py.False;case'is not':return a!==b?py.True:py.False;case'in':return b.__contains__(a);case'not in':return py.PY_isTrue(b.__contains__(a))?py.False:py.True;case'==':case'!=':case'<>':case'<':case'<=':case'>':case'>=':return PY_op(a,b,operator);}
throw new Error('SyntaxError: unknown comparator [['+operator+']]');};py.evaluate=function(expr,context){context=context||{};switch(expr.id){case'(name)':var val=context[expr.value];if(val===undefined&&expr.value in PY_builtins){return PY_builtins[expr.value];}
return PY_ensurepy(val,expr.value);case'(string)':return py.str.fromJSON(expr.value);case'(number)':return py.float.fromJSON(expr.value);case'(constant)':switch(expr.value){case'None':return py.None;case'False':return py.False;case'True':return py.True;}
throw new Error("SyntaxError: unknown constant '"+expr.value+"'");case'(comparator)':var result,left=py.evaluate(expr.expressions[0],context);for(var i=0;i<expr.operators.length;++i){result=evaluate_operator(expr.operators[i],left,left=py.evaluate(expr.expressions[i+1],context));if(py.PY_not(result)){return py.False;}}
return py.True;case'not':return py.PY_isTrue(py.evaluate(expr.first,context))?py.False:py.True;case'and':var and_first=py.evaluate(expr.first,context);if(py.PY_isTrue(and_first.__nonzero__())){return py.evaluate(expr.second,context);}
return and_first;case'or':var or_first=py.evaluate(expr.first,context);if(py.PY_isTrue(or_first.__nonzero__())){return or_first}
return py.evaluate(expr.second,context);case'if':var cond=py.evaluate(expr.condition,context);if(py.PY_isTrue(cond)){return py.evaluate(expr.ifTrue,context);}else{return py.evaluate(expr.ifFalse,context);}
case'(':if(expr.second){var callable=py.evaluate(expr.first,context);var args=[],kwargs={};for(var jj=0;jj<expr.second.length;++jj){var arg=expr.second[jj];if(arg.id!=='='){args.push(py.evaluate(arg,context));}else{kwargs[arg.first.value]=py.evaluate(arg.second,context);}}
return py.PY_call(callable,args,kwargs);}
var tuple_exprs=expr.first,tuple_values=[];for(var j=0,len=tuple_exprs.length;j<len;++j){tuple_values.push(py.evaluate(tuple_exprs[j],context));}
return py.tuple.fromJSON(tuple_values);case'[':if(expr.second){return py.PY_getItem(py.evaluate(expr.first,context),py.evaluate(expr.second,context));}
var list_exprs=expr.first,list_values=[];for(var k=0;k<list_exprs.length;++k){list_values.push(py.evaluate(list_exprs[k],context));}
return py.list.fromJSON(list_values);case'{':var dict_exprs=expr.first,dict=py.PY_call(py.dict);for(var l=0;l<dict_exprs.length;++l){py.PY_setItem(dict,py.evaluate(dict_exprs[l][0],context),py.evaluate(dict_exprs[l][1],context));}
return dict;case'.':if(expr.second.id!=='(name)'){throw new Error('SyntaxError: '+expr);}
return py.PY_getAttr(py.evaluate(expr.first,context),expr.second.value);case'~':return(py.evaluate(expr.first,context)).__invert__();case'+':if(!expr.second){return py.PY_positive(py.evaluate(expr.first,context));}
case'-':if(!expr.second){return py.PY_negative(py.evaluate(expr.first,context));}
case'*':case'/':case'//':case'%':case'**':case'<<':case'>>':case'&':case'^':case'|':return PY_op(py.evaluate(expr.first,context),py.evaluate(expr.second,context),expr.id);default:throw new Error('SyntaxError: Unknown node [['+expr.id+']]');}};py.eval=function(str,context){return py.evaluate(py.parse(py.tokenize(str)),context).toJSON();}})(typeof exports==='undefined'?py:exports);;

/* /web/static/lib/py.js/lib/py_extras.js defined in bundle 'web.assets_backend' */
(function(py){"use strict";function divmod(a,b,fn){var mod=a%b;if(mod>0&&b<0||mod<0&&b>0){mod+=b;}
return fn(Math.floor(a/b),mod);}
function modf(x,fn){var mod=x%1;if(mod<0){mod+=1;}
return fn(mod,Math.floor(x));}
function assert(bool){if(!bool){throw new Error("AssertionError");}}
var obj=function(){};obj.prototype=py.object;var asJS=function(arg){if(arg instanceof obj){return arg.toJSON();}
return arg;};var datetime=py.PY_call(py.object);var zero=py.float.fromJSON(0);var DAYS_IN_MONTH=[null,31,28,31,30,31,30,31,31,30,31,30,31];var DAYS_BEFORE_MONTH=[null];var dbm=0;for(var i=1;i<DAYS_IN_MONTH.length;++i){DAYS_BEFORE_MONTH.push(dbm);dbm+=DAYS_IN_MONTH[i];}
function is_leap(year){return year%4===0&&(year%100!==0||year%400===0);}
function days_before_year(year){var y=year-1;return y*365+Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400);}
function days_in_month(year,month){if(month===2&&is_leap(year)){return 29;}
return DAYS_IN_MONTH[month];}
function days_before_month(year,month){var post_leap_feb=month>2&&is_leap(year);return DAYS_BEFORE_MONTH[month]+(post_leap_feb?1:0);}
function ymd2ord(year,month,day){var dim=days_in_month(year,month);if(!(1<=day&&day<=dim)){throw new Error("ValueError: day must be in 1.."+dim);}
return days_before_year(year)+
days_before_month(year,month)+
day;}
function get_quarter_number(month){return Math.ceil(month/3);}
function get_quarter(year,month){var quarter_number=get_quarter_number(month);var month_from=((quarter_number-1)*3)+1
var date_from={year:year,month:month_from,day:1}
var date_to={year:year,month:month_from+2,day:days_in_month(year,month)}
return[date_from,date_to];}
function get_day_of_week(year,month,day){var d=new Date(year,month-1,day);return(d.getDay()+6)%7;}
var DI400Y=days_before_year(401);var DI100Y=days_before_year(101);var DI4Y=days_before_year(5);function ord2ymd(n){--n;var n400,n100,n4,n1,n0;divmod(n,DI400Y,function(_n400,n){n400=_n400;divmod(n,DI100Y,function(_n100,n){n100=_n100;divmod(n,DI4Y,function(_n4,n){n4=_n4;divmod(n,365,function(_n1,n){n1=_n1;n0=n;});});});});n=n0;var year=n400*400+1+n100*100+n4*4+n1;if(n1==4||n100==100){assert(n0===0);return{year:year-1,month:12,day:31};}
var leapyear=n1===3&&(n4!==24||n100==3);assert(leapyear==is_leap(year));var month=(n+50)>>5;var preceding=DAYS_BEFORE_MONTH[month]+((month>2&&leapyear)?1:0);if(preceding>n){--month;preceding-=DAYS_IN_MONTH[month]+((month===2&&leapyear)?1:0);}
n-=preceding;return{year:year,month:month,day:n+1};}
function tmxxx(year,month,day,hour,minute,second,microsecond){hour=hour||0;minute=minute||0;second=second||0;microsecond=microsecond||0;if(microsecond<0||microsecond>999999){divmod(microsecond,1000000,function(carry,ms){microsecond=ms;second+=carry;});}
if(second<0||second>59){divmod(second,60,function(carry,s){second=s;minute+=carry;});}
if(minute<0||minute>59){divmod(minute,60,function(carry,m){minute=m;hour+=carry;});}
if(hour<0||hour>23){divmod(hour,24,function(carry,h){hour=h;day+=carry;});}
if(month<1||month>12){divmod(month-1,12,function(carry,m){month=m+1;year+=carry;});}
var dim=days_in_month(year,month);if(day<1||day>dim){if(day===0){--month;if(month>0){day=days_in_month(year,month);}else{--year;month=12;day=31;}}else if(day==dim+1){++month;day=1;if(month>12){month=1;++year;}}else{var r=ord2ymd(ymd2ord(year,month,1)+(day-1));year=r.year;month=r.month;day=r.day;}}
return{year:year,month:month,day:day,hour:hour,minute:minute,second:second,microsecond:microsecond};}
datetime.timedelta=py.type('timedelta',null,{__init__:function(){var args=py.PY_parseArgs(arguments,[['days',zero],['seconds',zero],['microseconds',zero],['milliseconds',zero],['minutes',zero],['hours',zero],['weeks',zero]]);var d=0,s=0,m=0;var days=args.days.toJSON()+args.weeks.toJSON()*7;var seconds=args.seconds.toJSON()
+args.minutes.toJSON()*60
+args.hours.toJSON()*3600;var microseconds=args.microseconds.toJSON()
+args.milliseconds.toJSON()*1000;var daysecondsfrac=modf(days,function(dayfrac,days){d=days;if(dayfrac){return modf(dayfrac*24*3600,function(dsf,dsw){s=dsw;return dsf;});}
return 0;});var secondsfrac=modf(seconds,function(sf,s){seconds=s;return sf+daysecondsfrac;});divmod(seconds,24*3600,function(days,seconds){d+=days;s+=seconds;});microseconds+=secondsfrac*1e6;divmod(microseconds,1000000,function(seconds,microseconds){divmod(seconds,24*3600,function(days,seconds){d+=days;s+=seconds;m+=Math.round(microseconds);});});this.days=d;this.seconds=s;this.microseconds=m;},__str__:function(){var hh,mm,ss;divmod(this.seconds,60,function(m,s){divmod(m,60,function(h,m){hh=h;mm=m;ss=s;});});var s=_.str.sprintf("%d:%02d:%02d",hh,mm,ss);if(this.days){s=_.str.sprintf("%d day%s, %s",this.days,(this.days!=1&&this.days!=-1)?'s':'',s);}
if(this.microseconds){s=_.str.sprintf("%s.%06d",s,this.microseconds);}
return py.str.fromJSON(s);},__eq__:function(other){if(!py.PY_isInstance(other,datetime.timedelta)){return py.False;}
return(this.days===other.days&&this.seconds===other.seconds&&this.microseconds===other.microseconds)?py.True:py.False;},__add__:function(other){if(!py.PY_isInstance(other,datetime.timedelta)){return py.NotImplemented;}
return py.PY_call(datetime.timedelta,[py.float.fromJSON(this.days+other.days),py.float.fromJSON(this.seconds+other.seconds),py.float.fromJSON(this.microseconds+other.microseconds)]);},__radd__:function(other){return this.__add__(other);},__sub__:function(other){if(!py.PY_isInstance(other,datetime.timedelta)){return py.NotImplemented;}
return py.PY_call(datetime.timedelta,[py.float.fromJSON(this.days-other.days),py.float.fromJSON(this.seconds-other.seconds),py.float.fromJSON(this.microseconds-other.microseconds)]);},__rsub__:function(other){if(!py.PY_isInstance(other,datetime.timedelta)){return py.NotImplemented;}
return this.__neg__().__add__(other);},__neg__:function(){return py.PY_call(datetime.timedelta,[py.float.fromJSON(-this.days),py.float.fromJSON(-this.seconds),py.float.fromJSON(-this.microseconds)]);},__pos__:function(){return this;},__mul__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
var n=other.toJSON();return py.PY_call(datetime.timedelta,[py.float.fromJSON(this.days*n),py.float.fromJSON(this.seconds*n),py.float.fromJSON(this.microseconds*n)]);},__rmul__:function(other){return this.__mul__(other);},__div__:function(other){if(!py.PY_isInstance(other,py.float)){return py.NotImplemented;}
var usec=((this.days*24*3600)+this.seconds)*1000000
+this.microseconds;return py.PY_call(datetime.timedelta,[zero,zero,py.float.fromJSON(usec/other.toJSON())]);},__floordiv__:function(other){return this.__div__(other);},total_seconds:function(){return py.float.fromJSON(this.days*86400
+this.seconds
+this.microseconds/1000000);},__nonzero__:function(){return(!!this.days||!!this.seconds||!!this.microseconds)?py.True:py.False;}});datetime.datetime=py.type('datetime',null,{__init__:function(){var zero=py.float.fromJSON(0);var args=py.PY_parseArgs(arguments,['year','month','day',['hour',zero],['minute',zero],['second',zero],['microsecond',zero],['tzinfo',py.None]]);for(var key in args){if(!args.hasOwnProperty(key)){continue;}
this[key]=asJS(args[key]);}},__eq__:function(other){return(this.year===other.year&&this.month===other.month&&this.day===other.day&&this.hour===other.hour&&this.minute===other.minute&&this.second===other.second&&this.microsecond===other.microsecond&&this.tzinfo===other.tzinfo)?py.True:py.False;},replace:function(){var args=py.PY_parseArgs(arguments,[['year',py.None],['month',py.None],['day',py.None],['hour',py.None],['minute',py.None],['second',py.None],['microsecond',py.None]]);var params={};for(var key in args){if(!args.hasOwnProperty(key)){continue;}
var arg=args[key];params[key]=(arg===py.None?this[key]:asJS(arg));}
return py.PY_call(datetime.datetime,params);},start_of:function(){var args=py.PY_parseArgs(arguments,'granularity');var granularity=args.granularity.toJSON();if(granularity==='year'){return py.PY_call(datetime.datetime,[this.year,1,1]);}else if(granularity==='quarter'){var quarter=get_quarter(this.year,this.month)[0];return py.PY_call(datetime.datetime,[quarter.year,quarter.month,quarter.day]);}else if(granularity==='month'){return py.PY_call(datetime.datetime,[this.year,this.month,1]);}else if(granularity==='week'){var dow=get_day_of_week(this.year,this.month,this.day);return py.PY_call(datetime.datetime,[this.year,this.month,this.day-dow]);}else if(granularity==='day'){return py.PY_call(datetime.datetime,[this.year,this.month,this.day]);}else if(granularity==='hour'){return py.PY_call(datetime.datetime,[this.year,this.month,this.day,this.hour]);}else{throw new Error('ValueError: '+granularity+' is not a supported granularity, supported '+' granularities are: year, quarter, month, week, day and hour.')}},end_of:function(){var args=py.PY_parseArgs(arguments,'granularity');var granularity=args.granularity.toJSON();var min=[23,59,59];if(granularity==='year'){return py.PY_call(datetime.datetime,[this.year,12,31].concat(min));}else if(granularity==='quarter'){var quarter=get_quarter(this.year,this.month)[1];return py.PY_call(datetime.datetime,[quarter.year,quarter.month,quarter.day].concat(min));}else if(granularity==='month'){var dom=days_in_month(this.year,this.month);return py.PY_call(datetime.datetime,[this.year,this.month,dom].concat(min));}else if(granularity==='week'){var dow=get_day_of_week(this.year,this.month,this.day);return py.PY_call(datetime.datetime,[this.year,this.month,this.day+(6-dow)].concat(min));}else if(granularity==='day'){return py.PY_call(datetime.datetime,[this.year,this.month,this.day].concat(min));}else if(granularity==='hour'){return py.PY_call(datetime.datetime,[this.year,this.month,this.day,this.hour,59,59]);}else{throw new Error('ValueError: '+granularity+' is not a supported granularity, supported '+' granularities are: year, quarter, month, week, day and hour.')}},add:function(){var args=py.PY_parseArgs(arguments,[['years',py.None],['months',py.None],['days',py.None],['hours',py.None],['minutes',py.None],['seconds',py.None],]);return py.PY_add(this,py.PY_call(relativedelta,{'years':args.years,'months':args.months,'days':args.days,'hours':args.hours,'minutes':args.minutes,'seconds':args.seconds,}));},subtract:function(){var args=py.PY_parseArgs(arguments,[['years',py.None],['months',py.None],['days',py.None],['hours',py.None],['minutes',py.None],['seconds',py.None],]);var params={};for(var key in args){params[key]=(args[key]===py.None?args[key]:py.float.fromJSON(-asJS(args[key])));}
return py.PY_add(this,py.PY_call(relativedelta,params));},strftime:function(){var self=this;var args=py.PY_parseArgs(arguments,'format');return py.str.fromJSON(args.format.toJSON().replace(/%([A-Za-z])/g,function(m,c){switch(c){case'Y':return _.str.sprintf('%04d',self.year);case'm':return _.str.sprintf('%02d',self.month);case'd':return _.str.sprintf('%02d',self.day);case'H':return _.str.sprintf('%02d',self.hour);case'M':return _.str.sprintf('%02d',self.minute);case'S':return _.str.sprintf('%02d',self.second);}
throw new Error('ValueError: No known conversion for '+m);}));},to_utc:function(){var d=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);var offset=d.getTimezoneOffset();var kwargs={minutes:py.float.fromJSON(offset)};var timedelta=py.PY_call(py.extras.datetime.timedelta,[],kwargs);var s=tmxxx(this.year,this.month,this.day+timedelta.days,this.hour,this.minute,this.second+timedelta.seconds);return datetime.datetime.fromJSON(s.year,s.month,s.day,s.hour,s.minute,s.second);},now:py.classmethod.fromJSON(function(){var d=new Date();return py.PY_call(datetime.datetime,[d.getFullYear(),d.getMonth()+1,d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds()*1000]);}),today:py.classmethod.fromJSON(function(){var dt_class=py.PY_getAttr(datetime,'datetime');return py.PY_call(py.PY_getAttr(dt_class,'now'));}),utcnow:py.classmethod.fromJSON(function(){var d=new Date();return py.PY_call(datetime.datetime,[d.getUTCFullYear(),d.getUTCMonth()+1,d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()*1000]);}),combine:py.classmethod.fromJSON(function(){var args=py.PY_parseArgs(arguments,'date time');return py.PY_call(datetime.datetime,[py.PY_getAttr(args.date,'year'),py.PY_getAttr(args.date,'month'),py.PY_getAttr(args.date,'day'),py.PY_getAttr(args.time,'hour'),py.PY_getAttr(args.time,'minute'),py.PY_getAttr(args.time,'second')]);}),toJSON:function(){return new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.microsecond/1000);},__add__:function(other){if(!py.PY_isInstance(other,datetime.timedelta)){return py.NotImplemented;}
var s=tmxxx(this.year,this.month,this.day+other.days,this.hour,this.minute,this.second+other.seconds);return datetime.datetime.fromJSON(s.year,s.month,s.day,s.hour,s.minute,s.second);},__sub__:function(other){if(py.PY_isInstance(other,datetime.timedelta)){return py.PY_add(this,py.PY_negative(other));}
return py.NotImplemented;},fromJSON:function(year,month,day,hour,minute,second){return py.PY_call(datetime.datetime,[year,month,day,hour,minute,second]);},});datetime.date=py.type('date',null,{__init__:function(){var args=py.PY_parseArgs(arguments,'year month day');this.year=asJS(args.year);this.month=asJS(args.month);this.day=asJS(args.day);},strftime:function(){var self=this;var args=py.PY_parseArgs(arguments,'format');return py.str.fromJSON(args.format.toJSON().replace(/%([A-Za-z])/g,function(m,c){switch(c){case'Y':return self.year;case'm':return _.str.sprintf('%02d',self.month);case'd':return _.str.sprintf('%02d',self.day);}
throw new Error('ValueError: No known conversion for '+m);}));},__eq__:function(other){return(this.year===other.year&&this.month===other.month&&this.day===other.day)?py.True:py.False;},replace:function(){var args=py.PY_parseArgs(arguments,[['year',py.None],['month',py.None],['day',py.None]]);var params={};for(var key in args){if(!args.hasOwnProperty(key)){continue;}
var arg=args[key];params[key]=(arg===py.None?this[key]:asJS(arg));}
return py.PY_call(datetime.date,params);},start_of:function(){var args=py.PY_parseArgs(arguments,'granularity');var granularity=args.granularity.toJSON();if(granularity==='year'){return py.PY_call(datetime.date,[this.year,1,1]);}else if(granularity==='quarter'){var quarter=get_quarter(this.year,this.month)[0];return py.PY_call(datetime.date,[quarter.year,quarter.month,quarter.day]);}else if(granularity==='month'){return py.PY_call(datetime.date,[this.year,this.month,1]);}else if(granularity==='week'){var dow=get_day_of_week(this.year,this.month,this.day);return py.PY_call(datetime.date,[this.year,this.month,this.day-dow]);}else if(granularity==='day'){return py.PY_call(datetime.date,[this.year,this.month,this.day]);}else{throw new Error('ValueError: '+granularity+' is not a supported granularity, supported '+' granularities are: year, quarter, month, week and day.')}},end_of:function(){var args=py.PY_parseArgs(arguments,'granularity');var granularity=args.granularity.toJSON();if(granularity==='year'){return py.PY_call(datetime.date,[this.year,12,31]);}else if(granularity==='quarter'){var quarter=get_quarter(this.year,this.month)[1];return py.PY_call(datetime.date,[quarter.year,quarter.month,quarter.day]);}else if(granularity==='month'){var dom=days_in_month(this.year,this.month);return py.PY_call(datetime.date,[this.year,this.month,dom]);}else if(granularity==='week'){var dow=get_day_of_week(this.year,this.month,this.day);return py.PY_call(datetime.date,[this.year,this.month,this.day+(6-dow)]);}else if(granularity==='day'){return py.PY_call(datetime.date,[this.year,this.month,this.day]);}else{throw new Error('ValueError: '+granularity+' is not a supported granularity, supported '+' granularities are: year, quarter, month, week and day.')}},add:function(){var args=py.PY_parseArgs(arguments,[['years',py.None],['months',py.None],['days',py.None],]);return py.PY_add(this,py.PY_call(relativedelta,{'years':args.years,'months':args.months,'days':args.days,}));},subtract:function(){var args=py.PY_parseArgs(arguments,[['years',py.None],['months',py.None],['days',py.None],]);var params={};for(var key in args){params[key]=(args[key]===py.None?args[key]:py.float.fromJSON(-asJS(args[key])));}
return py.PY_add(this,py.PY_call(relativedelta,params));},__add__:function(other){if(!py.PY_isInstance(other,datetime.timedelta)){return py.NotImplemented;}
var s=tmxxx(this.year,this.month,this.day+other.days);return datetime.date.fromJSON(s.year,s.month,s.day);},__radd__:function(other){return this.__add__(other);},__sub__:function(other){if(py.PY_isInstance(other,datetime.timedelta)){return py.PY_add(this,py.PY_negative(other));}
if(py.PY_isInstance(other,datetime.date)){return py.PY_call(datetime.timedelta,[py.PY_subtract(py.PY_call(py.PY_getAttr(this,'toordinal')),py.PY_call(py.PY_getAttr(other,'toordinal')))]);}
return py.NotImplemented;},toordinal:function(){return py.float.fromJSON(ymd2ord(this.year,this.month,this.day));},weekday:function(){return py.float.fromJSON((this.toordinal().toJSON()+6)%7);},fromJSON:function(year,month,day){return py.PY_call(datetime.date,[year,month,day]);},today:py.classmethod.fromJSON(function(){var d=new Date();return py.PY_call(datetime.date,[d.getFullYear(),d.getMonth()+1,d.getDate()]);}),});datetime.time=py.type('time',null,{__init__:function(){var zero=py.float.fromJSON(0);var args=py.PY_parseArgs(arguments,[['hour',zero],['minute',zero],['second',zero],['microsecond',zero],['tzinfo',py.None]]);for(var k in args){if(!args.hasOwnProperty(k)){continue;}
this[k]=asJS(args[k]);}}});var time=py.PY_call(py.object);time.strftime=py.PY_def.fromJSON(function(){var args=py.PY_parseArgs(arguments,'format');var dt_class=py.PY_getAttr(datetime,'datetime');var d=py.PY_call(py.PY_getAttr(dt_class,'utcnow'));return py.PY_call(py.PY_getAttr(d,'strftime'),[args.format]);});var args=_.map(('year month day hour minute second '
+'years months weeks days hours minutes seconds '
+'weekday leapdays yearday nlyearday').split(' '),function(arg){switch(arg){case'years':case'months':case'days':case'leapdays':case'weeks':case'hours':case'minutes':case'seconds':return[arg,zero];case'year':case'month':case'day':case'weekday':case'hour':case'minute':case'second':case'yearday':case'nlyearday':return[arg,null];default:throw new Error("Unknown relativedelta argument "+arg);}});args.unshift('*');var _utils={monthrange:function(year,month){if(month<1||month>12){throw new Error("Illegal month "+month);}
var day1=this.weekday(year,month,1);var ndays=this.mdays[month]+(month==this.February&&this.isleap(year));return[day1,ndays];},weekday:function(year,month,day){var date=py.PY_call(datetime.date,[year,month,day]);return py.PY_call(py.PY_getAttr(date,'weekday'));},isleap:function(year){return year%4===0&&(year%100!==0||year%400===0);},mdays:[0,31,28,31,30,31,30,31,31,30,31,30,31],January:1,February:2};var relativedelta=py.type('relativedelta',null,{__init__:function(){this.ops=py.PY_parseArgs(arguments,args);this.ops.days=py.float.fromJSON(asJS(this.ops.days)+asJS(this.ops.weeks)*7);var yday=zero;if(this.ops.nlyearday){yday=this.ops.nlyearday;}else if(this.ops.yearday){yday=this.ops.yearday;if(asJS(this.ops.yearday)>59){this.ops.leapdays=py.float.fromJS(-1);}}
if(py.PY_isTrue(yday)){var ydayidx=[31,59,90,120,151,181,212,243,273,304,334,366];for(var idx=0;idx<ydayidx.length;++idx){var ydays=ydayidx[idx];if(asJS(yday)<=ydays){this.ops.month=py.float.fromJSON(idx+1);if(!idx){this.ops.day=yday;}else{this.ops.day=py.PY_subtract(yday,py.float.fromJSON(ydayidx[idx-1]));}
break;}}
if(idx===ydayidx.length){throw new Error("Invalid year day ("+asJS(yday)+")");}}
this._fix();},_fix:function(){var self=this;var months=asJS(this.ops.months);if(Math.abs(months)>11){var s=months>0?1:-1;divmod(months*s,12,function(years,months){self.ops.months=py.float.fromJSON(months*s);self.ops.years=py.float.fromJSON(asJS(self.ops.years)+years*s);});}
this._has_time=0;},__add__:function(other){if(!(py.PY_isInstance(other,datetime.date)||py.PY_isInstance(other,datetime.datetime))){return py.NotImplemented;}
var year=(asJS(this.ops.year)||asJS(other.year))+asJS(this.ops.years);var month=asJS(this.ops.month)||asJS(other.month);var months;if(months=asJS(this.ops.months)){if(Math.abs(months)<1||Math.abs(months)>12){throw new Error("Can only use relative months between -12 and +12");}
month+=months;if(month>12){year+=1;month-=12;}
if(month<1){year-=1;month+=12;}}
var day=Math.min(_utils.monthrange(year,month)[1],asJS(this.ops.day)||asJS(other.day));var repl={year:py.float.fromJSON(year),month:py.float.fromJSON(month),day:py.float.fromJSON(day)};if(py.PY_isInstance(other,datetime.datetime)){repl.hour=py.float.fromJSON(asJS(this.ops.hour)||asJS(other.hour));repl.minute=py.float.fromJSON(asJS(this.ops.minute)||asJS(other.minute));repl.second=py.float.fromJSON(asJS(this.ops.second)||asJS(other.second));}
var days=asJS(this.ops.days);if(py.PY_isTrue(this.ops.leapdays)&&month>2&&_utils.isleap(year)){days+=asJS(this.ops.leapdays);}
var ret=py.PY_add(py.PY_call(py.PY_getAttr(other,'replace'),repl),py.PY_call(datetime.timedelta,{days:py.float.fromJSON(days),hours:py.float.fromJSON(asJS(this.ops.hours)),minutes:py.float.fromJSON(asJS(this.ops.minutes)),seconds:py.float.fromJSON(asJS(this.ops.seconds))}));if(this.ops.weekday){var weekday=asJS(this.ops.weekday),nth=1;var jumpdays=(Math.abs(nth)-1)*7;var ret_weekday=asJS(py.PY_call(py.PY_getAttr(ret,'weekday')));if(nth>0){jumpdays+=(7-ret_weekday+weekday)%7;}else{jumpdays+=(ret_weekday-weekday)%7;jumpdays*=-1;}
ret=py.PY_add(ret,py.PY_call(datetime.timedelta,{days:py.float.fromJSON(jumpdays)}));}
return ret;},__radd__:function(other){return this.__add__(other);},__rsub__:function(other){return this.__neg__().__radd__(other);},__neg__:function(){return py.PY_call(relativedelta,{years:py.PY_negative(this.ops.years),months:py.PY_negative(this.ops.months),days:py.PY_negative(this.ops.days),leapdays:this.ops.leapdays,hours:py.PY_negative(this.ops.hours),minutes:py.PY_negative(this.ops.minutes),seconds:py.PY_negative(this.ops.seconds),year:this.ops.year,month:this.ops.month,day:this.ops.day,weekday:this.ops.weekday,hour:this.ops.hour,minute:this.ops.minute,second:this.ops.second});}});py.extras={datetime:datetime,time:time,relativedelta:relativedelta,};})(typeof exports==='undefined'?py:exports);;

/* /web/static/lib/jquery.ba-bbq/jquery.ba-bbq.js defined in bundle 'web.assets_backend' */
(function($,window){'$:nomunge';var undefined,aps=Array.prototype.slice,decode=decodeURIComponent,jq_param=$.param,jq_param_sorted,jq_param_fragment,jq_deparam,jq_deparam_fragment,jq_bbq=$.bbq=$.bbq||{},jq_bbq_pushState,jq_bbq_getState,jq_elemUrlAttr,special=$.event.special,str_hashchange='hashchange',str_querystring='querystring',str_fragment='fragment',str_elemUrlAttr='elemUrlAttr',str_href='href',str_src='src',re_params_querystring=/^.*\?|#.*$/g,re_params_fragment,re_fragment,re_no_escape,ajax_crawlable,fragment_prefix,elemUrlAttr_cache={};function is_string(arg){return typeof arg==='string';};function curry(func){var args=aps.call(arguments,1);return function(){return func.apply(this,args.concat(aps.call(arguments)));};};function get_fragment(url){return url.replace(re_fragment,'$2');};function get_querystring(url){return url.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,'$1');};function jq_param_sub(is_fragment,get_func,url,params,merge_mode){var result,qs,matches,url_params,hash;if(params!==undefined){matches=url.match(is_fragment?re_fragment:/^([^#?]*)\??([^#]*)(#?.*)/);hash=matches[3]||'';if(merge_mode===2&&is_string(params)){qs=params.replace(is_fragment?re_params_fragment:re_params_querystring,'');}else{url_params=jq_deparam(matches[2]);params=is_string(params)?jq_deparam[is_fragment?str_fragment:str_querystring](params):params;qs=merge_mode===2?params:merge_mode===1?$.extend({},params,url_params):$.extend({},url_params,params);qs=jq_param_sorted(qs);if(is_fragment){qs=qs.replace(re_no_escape,decode);}}
result=matches[1]+(is_fragment?fragment_prefix:qs||!matches[1]?'?':'')+qs+hash;}else{result=get_func(url!==undefined?url:location.href);}
return result;};jq_param[str_querystring]=curry(jq_param_sub,0,get_querystring);jq_param[str_fragment]=jq_param_fragment=curry(jq_param_sub,1,get_fragment);jq_param.sorted=jq_param_sorted=function(a,traditional){var arr=[],obj={};$.each(jq_param(a,traditional).split('&'),function(i,v){var key=v.replace(/(?:%5B|=).*$/,''),key_obj=obj[key];if(!key_obj){key_obj=obj[key]=[];arr.push(key);}
key_obj.push(v);});return $.map(arr.sort(),function(v){return obj[v];}).join('&');};jq_param_fragment.noEscape=function(chars){chars=chars||'';var arr=$.map(chars.split(''),encodeURIComponent);re_no_escape=new RegExp(arr.join('|'),'g');};jq_param_fragment.noEscape(',/');jq_param_fragment.ajaxCrawlable=function(state){if(state!==undefined){if(state){re_params_fragment=/^.*(?:#!|#)/;re_fragment=/^([^#]*)(?:#!|#)?(.*)$/;fragment_prefix='#!';}else{re_params_fragment=/^.*#/;re_fragment=/^([^#]*)#?(.*)$/;fragment_prefix='#';}
ajax_crawlable=!!state;}
return ajax_crawlable;};jq_param_fragment.ajaxCrawlable(0);$.deparam=jq_deparam=function(params,coerce){var obj={},coerce_types={'true':!0,'false':!1,'null':null};$.each(params.replace(/\+/g,' ').split('&'),function(j,v){var param=v.split('='),key=decode(param[0]),val,cur=obj,i=0,keys=key.split(']['),keys_last=keys.length-1;if(/\[/.test(keys[0])&&/\]$/.test(keys[keys_last])){keys[keys_last]=keys[keys_last].replace(/\]$/,'');keys=keys.shift().split('[').concat(keys);keys_last=keys.length-1;}else{keys_last=0;}
if(param.length===2){val=decode(param[1]);if(coerce){val=val&&!isNaN(val)?+val:val==='undefined'?undefined:coerce_types[val]!==undefined?coerce_types[val]:val;}
if(keys_last){for(;i<=keys_last;i++){key=keys[i]===''?cur.length:keys[i];cur=cur[key]=i<keys_last?cur[key]||(keys[i+1]&&isNaN(keys[i+1])?{}:[]):val;}}else{if($.isArray(obj[key])){obj[key].push(val);}else if(obj[key]!==undefined){obj[key]=[obj[key],val];}else{obj[key]=val;}}}else if(key){obj[key]=coerce?undefined:'';}});return obj;};function jq_deparam_sub(is_fragment,url_or_params,coerce){if(url_or_params===undefined||typeof url_or_params==='boolean'){coerce=url_or_params;url_or_params=jq_param[is_fragment?str_fragment:str_querystring]();}else{url_or_params=is_string(url_or_params)?url_or_params.replace(is_fragment?re_params_fragment:re_params_querystring,''):url_or_params;}
return jq_deparam(url_or_params,coerce);};jq_deparam[str_querystring]=curry(jq_deparam_sub,0);jq_deparam[str_fragment]=jq_deparam_fragment=curry(jq_deparam_sub,1);$[str_elemUrlAttr]||($[str_elemUrlAttr]=function(obj){return $.extend(elemUrlAttr_cache,obj);})({a:str_href,base:str_href,iframe:str_src,img:str_src,input:str_src,form:'action',link:str_href,script:str_src});jq_elemUrlAttr=$[str_elemUrlAttr];function jq_fn_sub(mode,force_attr,params,merge_mode){if(!is_string(params)&&typeof params!=='object'){merge_mode=params;params=force_attr;force_attr=undefined;}
return this.each(function(){var that=$(this),attr=force_attr||jq_elemUrlAttr()[(this.nodeName||'').toLowerCase()]||'',url=attr&&that.attr(attr)||'';that.attr(attr,jq_param[mode](url,params,merge_mode));});};$.fn[str_querystring]=curry(jq_fn_sub,str_querystring);$.fn[str_fragment]=curry(jq_fn_sub,str_fragment);jq_bbq.pushState=jq_bbq_pushState=function(params,merge_mode){if(is_string(params)&&/^#/.test(params)&&merge_mode===undefined){merge_mode=2;}
var has_args=params!==undefined,url=jq_param_fragment(location.href,has_args?params:{},has_args?merge_mode:2);location.href=url;};jq_bbq.getState=jq_bbq_getState=function(key,coerce){return key===undefined||typeof key==='boolean'?jq_deparam_fragment(key):jq_deparam_fragment(coerce)[key];};jq_bbq.removeState=function(arr){var state={};if(arr!==undefined){state=jq_bbq_getState();$.each($.isArray(arr)?arr:arguments,function(i,v){delete state[v];});}
jq_bbq_pushState(state,2);};special[str_hashchange]=$.extend(special[str_hashchange],{add:function(handleObj){var old_handler;function new_handler(e){var hash=e[str_fragment]=jq_param_fragment();e.getState=function(key,coerce){return key===undefined||typeof key==='boolean'?jq_deparam(hash,key):jq_deparam(hash,coerce)[key];};old_handler.apply(this,arguments);};if($.isFunction(handleObj)){old_handler=handleObj;return new_handler;}else{old_handler=handleObj.handler;handleObj.handler=new_handler;}}});})(jQuery,this);(function($,window,undefined){'$:nomunge';var str_hashchange='hashchange',doc=document,fake_onhashchange,special=$.event.special,doc_mode=doc.documentMode,supports_onhashchange='on'+str_hashchange in window&&(doc_mode===undefined||doc_mode>7);function get_fragment(url){url=url||location.href;return'#'+url.replace(/^[^#]*#?(.*)$/,'$1');};$.fn[str_hashchange]=function(fn){return fn?this.bind(str_hashchange,fn):this.trigger(str_hashchange);};$.fn[str_hashchange].delay=50;special[str_hashchange]=$.extend(special[str_hashchange],{setup:function(){if(supports_onhashchange){return false;}
$(fake_onhashchange.start);},teardown:function(){if(supports_onhashchange){return false;}
$(fake_onhashchange.stop);}});fake_onhashchange=(function(){var self={},timeout_id,last_hash=get_fragment(),fn_retval=function(val){return val;},history_set=fn_retval,history_get=fn_retval;self.start=function(){timeout_id||poll();};self.stop=function(){timeout_id&&clearTimeout(timeout_id);timeout_id=undefined;};function poll(){var hash=get_fragment(),history_hash=history_get(last_hash);if(hash!==last_hash){history_set(last_hash=hash,history_hash);$(window).trigger(str_hashchange);}else if(history_hash!==last_hash){location.href=location.href.replace(/#.*/,'')+history_hash;}
timeout_id=setTimeout(poll,$.fn[str_hashchange].delay);};$.browser.msie&&!supports_onhashchange&&(function(){var iframe,iframe_src;self.start=function(){if(!iframe){iframe_src=$.fn[str_hashchange].src;iframe_src=iframe_src&&iframe_src+get_fragment();iframe=$('<iframe tabindex="-1" title="empty"/>').hide().one('load',function(){iframe_src||history_set(get_fragment());poll();}).attr('src',iframe_src||'javascript:0').insertAfter('body')[0].contentWindow;doc.onpropertychange=function(){try{if(event.propertyName==='title'){iframe.document.title=doc.title;}}catch(e){}};}};self.stop=fn_retval;history_get=function(){return get_fragment(iframe.location.href);};history_set=function(hash,history_hash){var iframe_doc=iframe.document,domain=$.fn[str_hashchange].domain;if(hash!==history_hash){iframe_doc.title=doc.title;iframe_doc.open();domain&&iframe_doc.write('<script>document.domain="'+domain+'"</script>');iframe_doc.close();iframe.location.hash=hash;}};})();return self;})();})(jQuery,this);;

/* /web/static/src/js/core/domain.js defined in bundle 'web.assets_backend' */
odoo.define("web.Domain",function(require){"use strict";var collections=require("web.collections");var pyUtils=require("web.py_utils");var py=window.py;const TRUE_LEAF=[1,'=',1];const FALSE_LEAF=[0,'=',1];const TRUE_DOMAIN=[TRUE_LEAF];const FALSE_DOMAIN=[FALSE_LEAF];function compare(a,b){return JSON.stringify(a)===JSON.stringify(b);}
var Domain=collections.Tree.extend({init:function(domain,evalContext){this._super.apply(this,arguments);if(_.isArray(domain)||_.isString(domain)){this._parse(this.normalizeArray(_.clone(this.stringToArray(domain,evalContext))));}else{this._data=!!domain;}},compute:function(values){if(this._data===true||this._data===false){return this._data;}else if(_.isArray(this._data)){var isParentField=false;var fieldName=this._data[0];let fieldValue;if(compare(this._data,FALSE_LEAF)||compare(this._data,TRUE_LEAF)){fieldValue=this._data[0];}else{var parentField=this._data[0].split('.');if('parent'in values&&parentField.length===2){fieldName=parentField[1];isParentField=parentField[0]==='parent'&&fieldName in values.parent;}
if(!(this._data[0]in values)&&!(isParentField)){throw new Error(_.str.sprintf("Unknown field %s in domain",this._data[0]));}
fieldValue=isParentField?values.parent[fieldName]:values[fieldName];}
switch(this._data[1]){case"=":case"==":return _.isEqual(fieldValue,this._data[2]);case"!=":case"<>":return!_.isEqual(fieldValue,this._data[2]);case"<":return(fieldValue<this._data[2]);case">":return(fieldValue>this._data[2]);case"<=":return(fieldValue<=this._data[2]);case">=":return(fieldValue>=this._data[2]);case"in":return _.intersection(_.isArray(this._data[2])?this._data[2]:[this._data[2]],_.isArray(fieldValue)?fieldValue:[fieldValue],).length!==0;case"not in":return _.intersection(_.isArray(this._data[2])?this._data[2]:[this._data[2]],_.isArray(fieldValue)?fieldValue:[fieldValue],).length===0;case"like":if(fieldValue===false){return false;}
return(fieldValue.indexOf(this._data[2])>=0);case"=like":if(fieldValue===false){return false;}
return new RegExp(this._data[2].replace(/%/g,'.*')).test(fieldValue);case"ilike":if(fieldValue===false){return false;}
return(fieldValue.toLowerCase().indexOf(this._data[2].toLowerCase())>=0);case"=ilike":if(fieldValue===false){return false;}
return new RegExp(this._data[2].replace(/%/g,'.*'),'i').test(fieldValue);default:throw new Error(_.str.sprintf("Domain %s uses an unsupported operator",this._data));}}else{switch(this._data){case"&":return _.every(this._children,function(child){return child.compute(values);});case"|":return _.some(this._children,function(child){return child.compute(values);});case"!":return!this._children[0].compute(values);}}},toArray:function(){if(this._data===false){throw new Error("'false' domain cannot be converted to array");}else if(this._data===true){return[];}else{var arr=[this._data];return arr.concat.apply(arr,_.map(this._children,function(child){return child.toArray();}));}},toString:function(){return Domain.prototype.arrayToString(this.toArray());},_parse:function(domain){this._data=(domain.length===0?true:domain[0]);if(domain.length<=1)return;var expected=1;for(var i=1;i<domain.length;i++){if(domain[i]==="&"||domain[i]==="|"){expected++;}else if(domain[i]!=="!"){expected--;}
if(!expected){i++;this._addSubdomain(domain.slice(1,i));this._addSubdomain(domain.slice(i));break;}}},_addSubdomain:function(domain){if(!domain.length)return;var subdomain=new Domain(domain);if(!subdomain._children.length||subdomain._data!==this._data){this._children.push(subdomain);}else{var self=this;_.each(subdomain._children,function(childDomain){self._children.push(childDomain);});}},arrayToString:function(domain){if(_.isString(domain))return domain;const parts=(domain||[]).map(part=>{if(_.isArray(part)){return"["+part.map(c=>{switch(c){case null:return"None";case true:return"True";case false:return"False";default:return JSON.stringify(c);}}).join(',')+"]";}else{return JSON.stringify(part);}});return"["+parts.join(',')+"]";},stringToArray:function(domain,evalContext){if(!_.isString(domain))return _.clone(domain);return pyUtils.eval("domain",domain?domain.replace(/%%/g,'%'):"[]",evalContext);},normalizeArray:function(domain){if(domain.length===0){return domain;}
var expected=1;_.each(domain,function(item){if(item==="&"||item==="|"){expected++;}else if(item!=="!"){expected--;}});if(expected<0){domain.unshift.apply(domain,_.times(Math.abs(expected),_.constant("&")));}else if(expected>0){throw new Error(_.str.sprintf("invalid domain %s (missing %d segment(s))",JSON.stringify(domain),expected));}
return domain;},domainToCondition:function(domain){if(!domain.length){return'True';}
var self=this;function consume(stack){var len=stack.length;if(len<=1){return stack;}else if(stack[len-1]==='|'||stack[len-1]==='&'||stack[len-2]==='|'||stack[len-2]==='&'){return stack;}else if(len==2){stack.splice(-2,2,stack[len-2]+' and '+stack[len-1]);}else if(stack[len-3]=='|'){if(len===3){stack.splice(-3,3,stack[len-2]+' or '+stack[len-1]);}else{stack.splice(-3,3,'('+stack[len-2]+' or '+stack[len-1]+')');}}else{stack.splice(-3,3,stack[len-2]+' and '+stack[len-1]);}
consume(stack);}
var stack=[];_.each(domain,function(dom){if(dom==='|'||dom==='&'){stack.push(dom);}else{var operator=dom[1]==='='?'==':dom[1];if(!operator){throw new Error('Wrong operator for this domain');}
if(operator==='!='&&dom[2]===false){stack.push(dom[0]);}else if(dom[2]===null||dom[2]===true||dom[2]===false){stack.push(dom[0]+' '+(operator==='!='?'is not ':'is ')+(dom[2]===null?'None':(dom[2]?'True':'False')));}else{stack.push(dom[0]+' '+operator+' '+JSON.stringify(dom[2]));}
consume(stack);}});if(stack.length!==1){throw new Error('Wrong domain');}
return stack[0];},conditionToDomain:function(condition){if(!condition||condition.match(/^\s*(True)?\s*$/)){return[];}
var ast=py.parse(py.tokenize(condition));function astToStackValue(node){switch(node.id){case'(name)':return node.value;case'.':return astToStackValue(node.first)+'.'+astToStackValue(node.second);case'(string)':return node.value;case'(number)':return node.value;case'(constant)':return node.value==='None'?null:node.value==='True'?true:false;case'[':return _.map(node.first,function(node){return astToStackValue(node);});}}
function astToStack(node){switch(node.id){case'(name)':return[[astToStackValue(node),'!=',false]];case'.':return[[astToStackValue(node.first)+'.'+astToStackValue(node.second),'!=',false]];case'not':return[[astToStackValue(node.first),'=',false]];case'or':return['|'].concat(astToStack(node.first)).concat(astToStack(node.second));case'and':return['&'].concat(astToStack(node.first)).concat(astToStack(node.second));case'(comparator)':if(node.operators.length!==1){throw new Error('Wrong condition to convert in domain');}
var right=astToStackValue(node.expressions[0]);var left=astToStackValue(node.expressions[1]);var operator=node.operators[0];switch(operator){case'is':operator='=';break;case'is not':operator='!=';break;case'==':operator='=';break;}
return[[right,operator,left]];default:throw"Condition cannot be transformed into domain";}}
return astToStack(ast);},});Domain.TRUE_LEAF=TRUE_LEAF;Domain.FALSE_LEAF=FALSE_LEAF;Domain.TRUE_DOMAIN=TRUE_DOMAIN;Domain.FALSE_DOMAIN=FALSE_DOMAIN;return Domain;});;

/* /web/static/src/js/core/mvc.js defined in bundle 'web.assets_backend' */
odoo.define('web.mvc',function(require){"use strict";var ajax=require('web.ajax');var Class=require('web.Class');var mixins=require('web.mixins');var ServicesMixin=require('web.ServicesMixin');var Widget=require('web.Widget');var Model=Class.extend(mixins.EventDispatcherMixin,ServicesMixin,{init:function(parent,params){mixins.EventDispatcherMixin.init.call(this);this.setParent(parent);},get:function(){},load:function(){return Promise.resolve();},});var Renderer=Widget.extend({init:function(parent,state,params){this._super(parent);this.state=state;},});var Controller=Widget.extend({init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.handle=params.handle||null;this.model=model;this.renderer=renderer;},start:function(){return Promise.all([this._super.apply(this,arguments),this._startRenderer()]);},_startRenderer:function(){return this.renderer.appendTo(this.$el);},});var Factory=Class.extend({config:{Model:Model,Renderer:Renderer,Controller:Controller,},init:function(){this.rendererParams={};this.controllerParams={};this.modelParams={};this.loadParams={};},getController:function(parent){var self=this;var model=this.getModel(parent);return Promise.all([this._loadData(model),ajax.loadLibs(this)]).then(function(result){const{state,handle}=result[0];var renderer=self.getRenderer(parent,state);var Controller=self.Controller||self.config.Controller;const initialState=model.get(handle);var controllerParams=_.extend({initialState,handle,},self.controllerParams);var controller=new Controller(parent,model,renderer,controllerParams);model.setParent(controller);renderer.setParent(controller);return controller;});},getModel:function(parent){var Model=this.config.Model;return new Model(parent,this.modelParams);},getRenderer:function(parent,state){var Renderer=this.config.Renderer;return new Renderer(parent,state,this.rendererParams);},_loadData:function(model,options={}){options.withSampleData='withSampleData'in options?options.withSampleData:true;return model.load(this.loadParams).then(function(handle){return{state:model.get(handle,options),handle};});},});return{Factory:Factory,Model:Model,Renderer:Renderer,Controller:Controller,};});;

/* /web/static/src/js/core/py_utils.js defined in bundle 'web.assets_backend' */
odoo.define('web.py_utils',function(require){"use strict";var core=require('web.core');var _t=core._t;var py=window.py;function wrap(value){if(value===null){return py.None;}
switch(typeof value){case'undefined':throw new Error("No conversion for undefined");case'boolean':return py.bool.fromJSON(value);case'number':return py.float.fromJSON(value);case'string':return py.str.fromJSON(value);}
switch(value.constructor){case Object:return wrapping_dict.fromJSON(value);case Array:return wrapping_list.fromJSON(value);}
throw new Error("ValueError: unable to wrap "+value);}
var wrapping_dict=py.type('wrapping_dict',null,{__init__:function(){this._store={};},__getitem__:function(key){var k=key.toJSON();if(!(k in this._store)){throw new Error("KeyError: '"+k+"'");}
return wrap(this._store[k]);},__getattr__:function(key){return this.__getitem__(py.str.fromJSON(key));},__len__:function(){return Object.keys(this._store).length;},__nonzero__:function(){return py.PY_size(this)>0?py.True:py.False;},get:function(){var args=py.PY_parseArgs(arguments,['k',['d',py.None]]);if(!(args.k.toJSON()in this._store)){return args.d;}
return this.__getitem__(args.k);},fromJSON:function(d){var instance=py.PY_call(wrapping_dict);instance._store=d;return instance;},toJSON:function(){return this._store;},});var wrapping_list=py.type('wrapping_list',null,{__init__:function(){this._store=[];},__getitem__:function(index){return wrap(this._store[index.toJSON()]);},__len__:function(){return this._store.length;},__nonzero__:function(){return py.PY_size(this)>0?py.True:py.False;},fromJSON:function(ar){var instance=py.PY_call(wrapping_list);instance._store=ar;return instance;},toJSON:function(){return this._store;},});function wrap_context(context){for(var k in context){if(!context.hasOwnProperty(k)){continue;}
var val=context[k];if(val===null){continue;}
if(val.constructor===Array){context[k]=wrapping_list.fromJSON(val);}else if(val.constructor===Object&&!py.PY_isInstance(val,py.object)){context[k]=wrapping_dict.fromJSON(val);}}
return context;}
function eval_contexts(contexts,evaluation_context){evaluation_context=_.extend(pycontext(),evaluation_context||{});return _(contexts).reduce(function(result_context,ctx){if(_.isEmpty(ctx)){return result_context;}
if(_.isString(ctx)){ctx={__ref:'context',__debug:ctx};}
var evaluated=ctx;switch(ctx.__ref){case'context':evaluation_context.context=evaluation_context;evaluated=py.eval(ctx.__debug,wrap_context(evaluation_context));break;case'compound_context':var eval_context=eval_contexts([ctx.__eval_context]);evaluated=eval_contexts(ctx.__contexts,_.extend({},evaluation_context,eval_context));break;}
_.extend(evaluation_context,evaluated);return _.extend(result_context,evaluated);},{});}
function eval_domains(domains,evaluation_context){evaluation_context=_.extend(pycontext(),evaluation_context||{});var result_domain=[];var need_normalization=(domains&&domains.length>0&&domains[0].length===1&&(domains[0][0]==="|"||domains[0][0]==="!"));_(domains).each(function(domain){if(_.isString(domain)){domain={__ref:'domain',__debug:domain};}
var domain_array_to_combine;switch(domain.__ref){case'domain':evaluation_context.context=evaluation_context;domain_array_to_combine=py.eval(domain.__debug,wrap_context(evaluation_context));break;default:domain_array_to_combine=domain;}
if(need_normalization){domain_array_to_combine=get_normalized_domain(domain_array_to_combine);}
result_domain.push.apply(result_domain,domain_array_to_combine);});return result_domain;}
function get_normalized_domain(domain_array){var expected=1;_.each(domain_array,function(item){if(item==="&"||item==="|"){expected++;}else if(item!=="!"){expected--;}});var new_explicit_ands=_.times(-expected,_.constant("&"));return new_explicit_ands.concat(domain_array);}
function eval_groupbys(contexts,evaluation_context){evaluation_context=_.extend(pycontext(),evaluation_context||{});var result_group=[];_(contexts).each(function(ctx){if(_.isString(ctx)){ctx={__ref:'context',__debug:ctx};}
var group;var evaluated=ctx;switch(ctx.__ref){case'context':evaluation_context.context=evaluation_context;evaluated=py.eval(ctx.__debug,wrap_context(evaluation_context));break;case'compound_context':var eval_context=eval_contexts([ctx.__eval_context]);evaluated=eval_contexts(ctx.__contexts,_.extend({},evaluation_context,eval_context));break;}
group=evaluated.group_by;if(!group){return;}
if(typeof group==='string'){result_group.push(group);}else if(group instanceof Array){result_group.push.apply(result_group,group);}else{throw new Error('Got invalid groupby {{'
+JSON.stringify(group)+'}}');}
_.extend(evaluation_context,evaluated);});return result_group;}
function context_today(){var d=new Date();return py.PY_call(py.extras.datetime.date,[d.getFullYear(),d.getMonth()+1,d.getDate()]);}
function tz_offset(){var offset=new Date().getTimezoneOffset();var kwargs={minutes:py.float.fromJSON(offset)};return py.PY_call(py.extras.datetime.timedelta,[],kwargs);}
function pycontext(){const d=new Date();const today=`${
        String(d.getFullYear()).padStart(4, "0")}-${
        String(d.getMonth() + 1).padStart(2, "0")}-${
        String(d.getDate()).padStart(2, "0")}`;const now=`${
        String(d.getUTCFullYear()).padStart(4, "0")}-${
        String(d.getUTCMonth() + 1).padStart(2, "0")}-${
        String(d.getUTCDate()).padStart(2, "0")} ${
        String(d.getUTCHours()).padStart(2, "0")}:${
        String(d.getUTCMinutes()).padStart(2, "0")}:${
        String(d.getUTCSeconds()).padStart(2, "0")}`;const{datetime,relativedelta,time}=py.extras;return{current_date:today,datetime,time,now,today,relativedelta,context_today,tz_offset,};}
function pyeval(type,object,context){context=_.extend(pycontext(),context||{});switch(type){case'context':case'contexts':if(type==='context'){object=[object];}
return eval_contexts(object,context);case'domain':case'domains':if(type==='domain')
object=[object];return eval_domains(object,context);case'groupbys':return eval_groupbys(object,context);}
throw new Error("Unknow evaluation type "+type);}
function eval_arg(arg){if(typeof arg!=='object'||!arg.__ref){return arg;}
switch(arg.__ref){case'domain':return pyeval('domains',[arg]);case'context':case'compound_context':return pyeval('contexts',[arg]);default:throw new Error(_t("Unknown nonliteral type ")+' '+arg.__ref);}}
function ensure_evaluated(args,kwargs){for(var i=0;i<args.length;++i){args[i]=eval_arg(args[i]);}
for(var k in kwargs){if(!kwargs.hasOwnProperty(k)){continue;}
kwargs[k]=eval_arg(kwargs[k]);}}
function eval_domains_and_contexts(source){return{context:pyeval('contexts',source.contexts||[],source.eval_context),domain:pyeval('domains',source.domains,source.eval_context),group_by:pyeval('groupbys',source.group_by_seq||[],source.eval_context),};}
function py_eval(expr,context){return py.eval(expr,_.extend({},context||{},{"true":true,"false":false,"null":null}));}
function assembleDomains(domains,operator){var ASTs=domains.map(_getPyJSAST);if(operator==="OR"){operator=py.tokenize("'|'")[0];}else{operator=py.tokenize("'&'")[0];}
var result=_getPyJSAST("[]");var normalizedDomains=ASTs.filter(function(AST){return AST.first.length>0;}).map(_normalizeDomainAST);if(normalizedDomains.length>0){result.first=normalizedDomains.reduce(function(acc,ast){return acc.concat(ast.first);},_.times(normalizedDomains.length-1,_.constant(operator)));}
return _formatAST(result);}
function normalizeDomain(domain){return _formatAST(_normalizeDomainAST(_getPyJSAST(domain)));}
var BINDING_POWERS={or:30,and:40,not:50,};function _formatAST(ast,lbp){lbp=lbp||0;switch(ast.id){case"(number)":return String(ast.value);case"(string)":return JSON.stringify(ast.value);case"(constant)":return ast.value;case"(name)":return ast.value;case"[":if(ast.second){return _formatAST(ast.first)+'['+_formatAST(ast.second)+']';}else{var values=ast.first.map(_formatAST);return'['+values.join(', ')+']';}
case"{":var keyValues=ast.first.map(function(kv){return _formatAST(kv[0])+': '+_formatAST(kv[1]);});return'{'+keyValues.join(', ')+'}';case"=":return _formatAST(ast.first)+' '+ast.id+' '+_formatAST(ast.second);case"-":case"+":case"~":case"*":case"**":case"%":case"//":case"and":case"or":if(ast.second){var r=_formatAST(ast.first,ast.lbp)+' '+ast.id+' '+_formatAST(ast.second,ast.lbp);if(ast.lbp<lbp){r='('+r+')';}
return r;}
var actualBP=BINDING_POWERS[ast.id]||130;return ast.id+_formatAST(ast.first,actualBP);case"if":var t=_formatAST(ast.ifTrue)
+' if '+_formatAST(ast.condition)
+' else '+_formatAST(ast.ifFalse);return ast.lbp<lbp?'('+t+')':t;case".":return _formatAST(ast.first,ast.lbp)+'.'+_formatAST(ast.second);case"not":return"not "+_formatAST(ast.first);case"(comparator)":var operator=ast.operators[0];return _formatAST(ast.expressions[0])+' '+operator+' '+_formatAST(ast.expressions[1]);case"(":if(ast.second){return _formatAST(ast.first)+'('+ast.second.map(_formatAST).join(', ')+')';}else{return'('+ast.first.map(_formatAST).join(', ')+')';}}
throw new Error("Unimplemented python construct");}
function _getPyJSAST(domain){return py.parse(py.tokenize(domain));}
function _normalizeDomainAST(domain){var expected=1;for(var i=0;i<domain.first.length;i++){var value=domain.first[i].value;if(value==='&'||value==='|'){expected++;}else if(value!=='!'){expected--;}}
var andOperator=py.tokenize("'&'")[0];if(expected<0){domain.first.unshift.apply(domain.first,_.times(Math.abs(expected),_.constant(andOperator)));}
return domain;}
return{context:pycontext,ensure_evaluated:ensure_evaluated,eval:pyeval,eval_domains_and_contexts:eval_domains_and_contexts,py_eval:py_eval,normalizeDomain:normalizeDomain,assembleDomains:assembleDomains,_getPyJSAST:_getPyJSAST,_formatAST:_formatAST,_normalizeDomainAST:_normalizeDomainAST,};});;

/* /web/static/src/js/chrome/abstract_action.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractAction',function(require){"use strict";var ActionMixin=require('web.ActionMixin');const ActionModel=require('web/static/src/js/views/action_model.js');var ControlPanel=require('web.ControlPanel');var Widget=require('web.Widget');const{ComponentWrapper}=require('web.OwlCompatibility');var AbstractAction=Widget.extend(ActionMixin,{config:{ControlPanel:ControlPanel,},hasControlPanel:false,loadControlPanel:false,withSearchBar:false,searchMenuTypes:[],init:function(parent,action,options){this._super(parent);this._title=action.display_name||action.name;this.searchModelConfig={context:Object.assign({},action.context),domain:action.domain||[],env:owl.Component.env,searchMenuTypes:this.searchMenuTypes,};this.extensions={};if(this.hasControlPanel){this.extensions.ControlPanel={actionId:action.id,withSearchBar:this.withSearchBar,};this.viewId=action.search_view_id&&action.search_view_id[0];this.controlPanelProps={action,breadcrumbs:options&&options.breadcrumbs,withSearchBar:this.withSearchBar,searchMenuTypes:this.searchMenuTypes,};}},willStart:async function(){const superPromise=this._super(...arguments);if(this.hasControlPanel){if(this.loadControlPanel){const{context,modelName}=this.searchModelConfig;const options={load_filters:this.searchMenuTypes.includes('favorite')};const{arch,fields,favoriteFilters}=await this.loadFieldView(modelName,context||{},this.viewId,'search',options);const archs={search:arch};const{ControlPanel:controlPanelInfo}=ActionModel.extractArchInfo(archs);Object.assign(this.extensions.ControlPanel,{archNodes:controlPanelInfo.children,favoriteFilters,fields,});this.controlPanelProps.fields=fields;}}
this.searchModel=new ActionModel(this.extensions,this.searchModelConfig);if(this.hasControlPanel){this.controlPanelProps.searchModel=this.searchModel;}
return Promise.all([superPromise,this.searchModel.load(),]);},start:async function(){await this._super(...arguments);if(this.hasControlPanel){if('title'in this.controlPanelProps){this._setTitle(this.controlPanelProps.title);}
this.controlPanelProps.title=this.getTitle();this._controlPanelWrapper=new ComponentWrapper(this,this.config.ControlPanel,this.controlPanelProps);await this._controlPanelWrapper.mount(this.el,{position:'first-child'});}},destroy:function(){this._super.apply(this,arguments);ActionMixin.destroy.call(this);},on_attach_callback:function(){ActionMixin.on_attach_callback.call(this);this.searchModel.on('search',this,this._onSearch);if(this.hasControlPanel){this.searchModel.on('get-controller-query-params',this,this._onGetOwnedQueryParams);}},on_detach_callback:function(){ActionMixin.on_detach_callback.call(this);this.searchModel.off('search',this);if(this.hasControlPanel){this.searchModel.off('get-controller-query-params',this);}},_onSearch:function(){},});return AbstractAction;});;

/* /web/static/src/js/chrome/action_manager.js defined in bundle 'web.assets_backend' */
odoo.define('web.ActionManager',function(require){"use strict";var AbstractAction=require('web.AbstractAction');var concurrency=require('web.concurrency');var Context=require('web.Context');var core=require('web.core');var Dialog=require('web.Dialog');var dom=require('web.dom');var framework=require('web.framework');var pyUtils=require('web.py_utils');var Widget=require('web.Widget');var _t=core._t;var ActionManager=Widget.extend({className:'o_action_manager',custom_events:{breadcrumb_clicked:'_onBreadcrumbClicked',history_back:'_onHistoryBack',push_state:'_onPushState',redirect:'_onRedirect',},init:function(parent,userContext){this._super.apply(this,arguments);this.userContext=userContext||{};this.dp=new concurrency.DropPrevious();this.actions={};this.controllers={};this.controllerStack=[];this.currentDialogController=null;},on_attach_callback:function(){this.isInDOM=true;var currentController=this.getCurrentController();if(currentController){currentController.widget.on_attach_callback();}},on_detach_callback:function(){this.isInDOM=false;var currentController=this.getCurrentController();if(currentController){currentController.widget.on_detach_callback();}},clearUncommittedChanges:function(){var currentController=this.getCurrentController();if(currentController){return currentController.widget.canBeRemoved();}
return Promise.resolve();},doAction:function(action,options){var self=this;options=_.defaults({},options,{additional_context:{},clear_breadcrumbs:false,on_close:function(){},on_reverse_breadcrumb:function(){},pushState:true,replace_last_action:false,});var def;if(_.isString(action)&&core.action_registry.contains(action)){action={type:'ir.actions.client',tag:action};}else if(_.isNumber(action)||_.isString(action)){def=this._loadAction(action,{active_id:options.additional_context.active_id,active_ids:options.additional_context.active_ids,active_model:options.additional_context.active_model,}).then(function(result){action=result;});}
return this.dp.add(Promise.resolve(def)).then(function(){options.clear_breadcrumbs=action.target==='main'||options.clear_breadcrumbs;self._preprocessAction(action,options);return self._handleAction(action,options).then(function(){action.pushState=true;return action;});}).then(function(action){self.trigger_up('webclient_started');return action;});},do_push_state:function(state){this.trigger_up('push_state',{state:state});},getCurrentAction:function(){var controller=this.getCurrentController();return controller?this.actions[controller.actionID]:null;},getCurrentController:function(){var currentControllerID=_.last(this.controllerStack);return currentControllerID?this.controllers[currentControllerID]:null;},loadState:function(state){var action;if(!state.action){return Promise.resolve();}
if(_.isString(state.action)&&core.action_registry.contains(state.action)){action={params:state,tag:state.action,type:'ir.actions.client',};}else{action=state.action;}
return this.doAction(action,{clear_breadcrumbs:true,pushState:false,});},_appendController:function(controller){dom.append(this.$el,controller.widget.$el,{in_DOM:this.isInDOM,callbacks:[{widget:controller.widget}],});if(controller.scrollPosition){this.trigger_up('scrollTo',controller.scrollPosition);}},_closeDialog:function(options){if(this.currentDialogController){this.currentDialogController.dialog.destroy(options);}},_detachCurrentController:function(){var currentController=this.getCurrentController();if(currentController){currentController.scrollPosition=this._getScrollPosition();dom.detach([{widget:currentController.widget}]);}},_executeAction:function(action,options){var self=this;this.actions[action.jsID]=action;if(action.target==='new'){return this._executeActionInDialog(action,options);}
var controller=self.controllers[action.controllerID];return this.clearUncommittedChanges().then(function(){return self.dp.add(self._startController(controller));}).then(function(){if(self.currentDialogController){self._closeDialog({silent:true});}
if(options.on_reverse_breadcrumb){var currentAction=self.getCurrentAction();if(currentAction){currentAction.on_reverse_breadcrumb=options.on_reverse_breadcrumb;}}
self._pushController(controller);self.call('session_storage','setItem','current_action',action._originalAction);return action;}).guardedCatch(function(){self._removeAction(action.jsID);});},_executeActionInDialog:function(action,options){var self=this;var controller=this.controllers[action.controllerID];var widget=controller.widget;return this._startController(controller).then(function(controller){var prevDialogOnClose;if(self.currentDialogController){prevDialogOnClose=self.currentDialogController.onClose;self._closeDialog({silent:true});}
controller.onClose=prevDialogOnClose||options.on_close;var dialog=new Dialog(self,_.defaults({},options,{buttons:[],dialogClass:controller.className,title:action.name,size:action.context.dialog_size,}));dialog.on('closed',self,function(options){options=options||{};self._removeAction(action.jsID);self.currentDialogController=null;if(options.silent!==true){controller.onClose(options.infos);}});controller.dialog=dialog;return dialog.open().opened(function(){self.currentDialogController=controller;widget.setParent(dialog);dom.append(dialog.$el,widget.$el,{in_DOM:true,callbacks:[{widget:controller.widget}],});widget.renderButtons(dialog.$footer);dialog.rebindButtonBehavior();return action;});}).guardedCatch(function(){self._removeAction(action.jsID);});},_executeClientAction:function(action,options){var self=this;var ClientAction=core.action_registry.get(action.tag);if(!ClientAction){console.error("Could not find client action "+action.tag,action);return Promise.reject();}
if(!(ClientAction.prototype instanceof Widget)){var next=ClientAction(this,action);if(next){return this.doAction(next,options);}
return Promise.resolve();}
if(!(ClientAction.prototype instanceof AbstractAction)){console.warn('The client action '+action.tag+' should be an instance of AbstractAction!');}
var controllerID=_.uniqueId('controller_');var index=this._getControllerStackIndex(options);options.breadcrumbs=this._getBreadcrumbs(this.controllerStack.slice(0,index));options.controllerID=controllerID;var widget=new ClientAction(this,action,options);var controller={actionID:action.jsID,index:index,jsID:controllerID,title:widget.getTitle(),widget:widget,};this.controllers[controllerID]=controller;action.controllerID=controllerID;var prom=this._executeAction(action,options);prom.then(function(){self._pushState(controllerID,{});});return prom;},_executeCloseAction:function(action,options){var result;if(!this.currentDialogController){result=options.on_close(action.infos);}
this._closeDialog({infos:action.infos});if(action.effect){this.trigger_up('show_effect',action.effect);}
return Promise.resolve(result);},_executeServerAction:function(action,options){var self=this;var runDef=this._rpc({route:'/web/action/run',params:{action_id:action.id,context:action.context||{},},});return this.dp.add(runDef).then(function(action){action=action||{type:'ir.actions.act_window_close'};return self.doAction(action,options);});},_executeURLAction:function(action,options){var url=action.url;if(action.target==='self'){framework.redirect(url);return Promise.resolve();}else{var w=window.open(url,'_blank');if(!w||w.closed||typeof w.closed==='undefined'){var message=_t('A popup window has been blocked. You '+'may need to change your browser settings to allow '+'popup windows for this page.');this.do_warn(false,message,true);}}
options.on_close();return Promise.resolve();},_getBreadcrumbs:function(controllerStack){var self=this;return _.map(controllerStack,function(controllerID){return{controllerID:controllerID,title:self.controllers[controllerID].title,};});},_getControllerStackIndex:function(options){var index;if('index'in options){index=options.index;}else if(options.clear_breadcrumbs){index=0;}else if(options.replace_last_action){index=this.controllerStack.length-1;}else{index=this.controllerStack.length;}
return index;},_getControllerState:function(controllerID){var controller=this.controllers[controllerID];var action=this.actions[controller.actionID];var state={title:controller.widget.getTitle(),};if(action.id){state.action=action.id;}else if(action.type==='ir.actions.client'){state.action=action.tag;var params=_.pick(action.params,function(v){return _.isString(v)||_.isNumber(v);});state=_.extend(params||{},state);}
if(action.context){var active_id=action.context.active_id;if(active_id){state.active_id=active_id;}
var active_ids=action.context.active_ids;if(active_ids&&!(active_ids.length===1&&active_ids[0]===active_id)){state.active_ids=action.context.active_ids.join(',');}}
state=_.extend({},controller.widget.getState(),state);return state;},_getScrollPosition:function(){var scrollPosition;this.trigger_up('getScrollPosition',{callback:function(_scrollPosition){scrollPosition=_scrollPosition;}});return scrollPosition;},_handleAction:function(action,options){if(!action.type){console.error("No type for action",action);return Promise.reject();}
switch(action.type){case'ir.actions.act_url':return this._executeURLAction(action,options);case'ir.actions.act_window_close':return this._executeCloseAction(action,options);case'ir.actions.client':return this._executeClientAction(action,options);case'ir.actions.server':return this._executeServerAction(action,options);default:console.error("The ActionManager can't handle actions of type "+
action.type,action);return Promise.reject();}},_pushController:function(controller){var self=this;this._detachCurrentController();var toDestroy=this.controllerStack.slice(controller.index);toDestroy=_.reject(toDestroy,function(controllerID){return controllerID===controller.jsID||self.controllers[controllerID].actionID===controller.actionID;});this._removeControllers(toDestroy);this.controllerStack=this.controllerStack.slice(0,controller.index);this.controllerStack.push(controller.jsID);this._appendController(controller);this.trigger_up('current_action_updated',{action:this.getCurrentAction(),controller:controller,});core.bus.trigger('close_dialogs');this._toggleFullscreen();},_pushState:function(controllerID,state){var controller=this.controllers[controllerID];if(controller){var action=this.actions[controller.actionID];if(action.target==='new'){return;}
if(action.pushState===false){this.trigger_up('set_title_part',{part:"action",title:controller.widget.getTitle()});return;}
state=_.extend({},state,this._getControllerState(controller.jsID));this.trigger_up('push_state',{state:state});}},_loadAction:function(actionID,context){var self=this;return new Promise(function(resolve,reject){self.trigger_up('load_action',{actionID:actionID,context:context,on_success:resolve,});});},_preprocessAction:function(action,options){var context=new Context(this.userContext,options.additional_context,action.context);action.context=pyUtils.eval('context',context);if(action.domain){action.domain=pyUtils.eval('domain',action.domain,action.context);}
action._originalAction=JSON.stringify(action);action.jsID=_.uniqueId('action_');action.pushState=options.pushState;},_removeAction:function(actionID){var action=this.actions[actionID];var controller=this.controllers[action.controllerID];delete this.actions[action.jsID];delete this.controllers[action.controllerID];controller.widget.destroy();},_removeControllers:function(controllerIDs){var self=this;var actionsToRemove=_.map(controllerIDs,function(controllerID){return self.controllers[controllerID].actionID;});_.each(_.uniq(actionsToRemove),this._removeAction.bind(this));},_restoreController:function(controllerID){var self=this;var controller=this.controllers[controllerID];var action=this.actions[controller.actionID];var def;if(action.on_reverse_breadcrumb){def=action.on_reverse_breadcrumb();}
return Promise.resolve(def).then(function(){return Promise.resolve(controller.widget.do_show()).then(function(){var index=_.indexOf(self.controllerStack,controllerID);self._pushController(controller,index);});});},_startController:function(controller){var fragment=document.createDocumentFragment();return controller.widget.appendTo(fragment).then(function(){return controller;});},_toggleFullscreen:function(){var self=this;var fullscreen=_.some(this.controllerStack,function(controllerID){var controller=self.controllers[controllerID];return self.actions[controller.actionID].target==='fullscreen';});this.trigger_up('toggle_fullscreen',{fullscreen:fullscreen});},_onBreadcrumbClicked:function(ev){ev.stopPropagation();this._restoreController(ev.data.controllerID);},_onHistoryBack:function(){if(this.currentDialogController){this._closeDialog();}else{var length=this.controllerStack.length;if(length>1){this._restoreController(this.controllerStack[length-2]);}}},_onPushState:function(ev){if(ev.target!==this){ev.stopPropagation();this._pushState(ev.data.controllerID,ev.data.state);}},_onRedirect:function(ev){this.do_action({type:'ir.actions.act_window',view_mode:'form',res_model:ev.data.res_model,views:[[false,'form']],res_id:ev.data.res_id,});},});return ActionManager;});;

/* /web/static/src/js/chrome/action_manager_act_window.js defined in bundle 'web.assets_backend' */
odoo.define('web.ActWindowActionManager',function(require){"use strict";var ActionManager=require('web.ActionManager');var config=require('web.config');var Context=require('web.Context');var core=require('web.core');var pyUtils=require('web.py_utils');var view_registry=require('web.view_registry');ActionManager.include({custom_events:_.extend({},ActionManager.prototype.custom_events,{execute_action:'_onExecuteAction',switch_view:'_onSwitchView',}),getCurrentController:function(){var currentController=this._super.apply(this,arguments);var action=currentController&&this.actions[currentController.actionID];if(action&&action.type==='ir.actions.act_window'&&!currentController.widget){var lastControllerID=this.controllerStack.pop();currentController=this._super.apply(this,arguments);this.controllerStack.push(lastControllerID);}
return currentController;},loadState:function(state){var _super=this._super.bind(this);var action;var options={clear_breadcrumbs:true,pushState:false,};if(state.action){var currentController=this.getCurrentController();var currentAction=currentController&&this.actions[currentController.actionID];if(currentAction&&currentAction.id===state.action&&currentAction.type==='ir.actions.act_window'){this._closeDialog(true);var viewOptions={currentId:state.id};var viewType=state.view_type||currentController.viewType;return this._switchController(currentAction,viewType,viewOptions);}else if(!core.action_registry.contains(state.action)){var context={};if(state.active_id){context.active_id=state.active_id;}
if(state.active_ids){context.active_ids=state.active_ids.toString().split(',').map(function(id){return parseInt(id,10)||id;});}else if(state.active_id){context.active_ids=[state.active_id];}
context.params=state;action=state.action;options=_.extend(options,{additional_context:context,resID:state.id||undefined,viewType:state.view_type,});}}else if(state.model&&state.id){action={res_model:state.model,res_id:state.id,type:'ir.actions.act_window',views:[[state.view_id||false,'form']],};}else if(state.model&&state.view_type){var storedAction=this.call('session_storage','getItem','current_action');var lastAction=JSON.parse(storedAction||'{}');if(lastAction.res_model===state.model){action=lastAction;options.viewType=state.view_type;}}
if(action){return this.doAction(action,options);}
return _super.apply(this,arguments);},_createViewController:function(action,viewType,viewOptions,options){var self=this;var viewDescr=_.findWhere(action.views,{type:viewType});if(!viewDescr){return Promise.reject();}
options=options||{};var index=options.index||0;var controllerID=options.controllerID||_.uniqueId('controller_');var controller={actionID:action.jsID,className:'o_act_window',index:index,jsID:controllerID,viewType:viewType,};Object.defineProperty(controller,'title',{get:function(){return controller.widget?controller.widget.getTitle():(action.display_name||action.name);},});this.controllers[controllerID]=controller;if(!options.lazy){var flags=action.flags||{};viewOptions=_.extend({},flags,flags[viewType],viewOptions,{action:action,breadcrumbs:this._getBreadcrumbs(this.controllerStack.slice(0,index)),controllerID:controllerID,});var rejection;var view=new viewDescr.Widget(viewDescr.fieldsView,viewOptions);var def=new Promise(function(resolve,reject){rejection=reject;view.getController(self).then(function(widget){if(def.rejected){widget.destroy();}else{controller.widget=widget;resolve(controller);}}).guardedCatch(reject);});def.reject=rejection;def.guardedCatch(function(){def.rejected=true;delete self.controllers[controllerID];});action.controllers[viewType]=def;}else{action.controllers[viewType]=Promise.resolve(controller);}
return action.controllers[viewType];},_destroyWindowAction:function(action){var self=this;for(var c in action.controllers){var controllerDef=action.controllers[c];controllerDef.then(function(controller){delete self.controllers[controller.jsID];if(controller.widget){controller.widget.destroy();}});if(controllerDef.reject){controllerDef.reject();}}},_executeWindowAction:function(action,options){var self=this;return this.dp.add(this._loadViews(action)).then(function(fieldsViews){var views=self._generateActionViews(action,fieldsViews);action._views=action.views;action.views=views;action.controlPanelFieldsView=fieldsViews.search;action.controllers={};var curView=options.viewType&&_.findWhere(views,{type:options.viewType});var lazyView;if(curView){if(!curView.multiRecord&&views[0].multiRecord){lazyView=views[0];}}else{curView=views[0];}
if(config.device.isMobile){if(!curView.isMobileFriendly){curView=self._findMobileView(views,curView.multiRecord)||curView;}
if(lazyView&&!lazyView.isMobileFriendly){lazyView=self._findMobileView(views,lazyView.multiRecord)||lazyView;}}
var lazyViewDef;var lazyControllerID;if(lazyView){options.clear_breadcrumbs=false;lazyViewDef=self._createViewController(action,lazyView.type,{},{lazy:true}).then(function(lazyLoadedController){lazyControllerID=lazyLoadedController.jsID;self.controllerStack.push(lazyLoadedController.jsID);});}
return self.dp.add(Promise.resolve(lazyViewDef)).then(function(){var viewOptions={controllerState:options.controllerState,currentId:options.resID,};var curViewDef=self._createViewController(action,curView.type,viewOptions,{index:self._getControllerStackIndex(options),});return self.dp.add(curViewDef);}).then(function(controller){action.controllerID=controller.jsID;return self._executeAction(action,options);}).guardedCatch(function(){if(lazyControllerID){var index=self.controllerStack.indexOf(lazyControllerID);self.controllerStack=self.controllerStack.slice(0,index);}
self._destroyWindowAction(action);});});},_findMobileView:function(views,multiRecord){return _.findWhere(views,{isMobileFriendly:true,multiRecord:multiRecord,});},_generateActionViews:function(action,fieldsViews){var views=[];_.each(action.views,function(view){var viewType=view[1];var fieldsView=fieldsViews[viewType];var parsedXML=new DOMParser().parseFromString(fieldsView.arch,"text/xml");var key=parsedXML.documentElement.getAttribute('js_class');var View=view_registry.get(key||viewType);if(View){views.push({accessKey:View.prototype.accessKey||View.prototype.accesskey,displayName:View.prototype.display_name,fieldsView:fieldsView,icon:View.prototype.icon,isMobileFriendly:View.prototype.mobile_friendly,multiRecord:View.prototype.multi_record,type:viewType,viewID:view[0],Widget:View,});}else if(config.isDebug('assets')){console.log("View type '"+viewType+"' is not present in the view registry.");}});return views;},_getControllerState:function(controllerID){var state=this._super.apply(this,arguments);var controller=this.controllers[controllerID];var action=this.actions[controller.actionID];if(action.type==='ir.actions.act_window'){state.model=action.res_model;state.view_type=controller.viewType;}
return state;},_handleAction:function(action,options){if(action.type==='ir.actions.act_window'){return this._executeWindowAction(action,options);}
return this._super.apply(this,arguments);},_loadViews:function(action){var inDialog=action.target==='new';var inline=action.target==='inline';var options={action_id:action.id,toolbar:!inDialog&&!inline,};var views=action.views.slice();if(!inline&&!(inDialog&&action.views[0][1]==='form')){options.load_filters=true;var searchviewID=action.search_view_id&&action.search_view_id[0];views.push([searchviewID||false,'search']);}
return this.loadViews(action.res_model,action.context,views,options);},_removeAction:function(actionID){var action=this.actions[actionID];if(action.type==='ir.actions.act_window'){delete this.actions[action.jsID];this._destroyWindowAction(action);}else{this._super.apply(this,arguments);}},_restoreController:function(controllerID){var self=this;var controller=this.controllers[controllerID];var action=this.actions[controller.actionID];if(action.type==='ir.actions.act_window'){return this.clearUncommittedChanges().then(function(){var def=Promise.resolve();if(action.on_reverse_breadcrumb){def=action.on_reverse_breadcrumb();}
return Promise.resolve(def).then(function(){return self._switchController(action,controller.viewType);});});}
return this._super.apply(this,arguments);},_switchController:function(action,viewType,viewOptions){var self=this;var view=_.findWhere(action.views,{type:viewType});if(!view){return Promise.reject();}
var currentController=this.getCurrentController();var index;if(currentController.actionID!==action.jsID){var controller=_.findWhere(this.controllers,{actionID:action.jsID,viewType:viewType,});index=_.indexOf(this.controllerStack,controller.jsID);}else{if(view.multiRecord){index=_.findIndex(this.controllerStack,function(controllerID){return self.controllers[controllerID].actionID===action.jsID;});}else if(!_.findWhere(action.views,{type:currentController.viewType}).multiRecord){index=this.controllerStack.length-1;}else{index=this.controllerStack.length;}}
var newController=function(controllerID){var options={controllerID:controllerID,index:index,};return self._createViewController(action,viewType,viewOptions,options).then(function(controller){return self._startController(controller);});};var controllerDef=action.controllers[viewType];if(controllerDef){controllerDef=controllerDef.then(function(controller){if(!controller.widget){return newController(controller.jsID);}else{return Promise.resolve(controller.widget.willRestore()).then(function(){viewOptions=_.extend({},viewOptions,{breadcrumbs:self._getBreadcrumbs(self.controllerStack.slice(0,index)),shouldUpdateSearchComponents:true,});return controller.widget.reload(viewOptions).then(function(){return controller;});});}},function(){return newController();});}else{controllerDef=newController();}
return this.dp.add(controllerDef).then(function(controller){return self._pushController(controller);});},_onExecuteAction:function(ev){ev.stopPropagation();var self=this;var actionData=ev.data.action_data;var env=ev.data.env;var context=new Context(env.context,actionData.context||{});var recordID=env.currentID||null;var def;if(actionData.special){def=Promise.resolve({type:'ir.actions.act_window_close',infos:{special:true},});}else if(actionData.type==='object'){var args=recordID?[[recordID]]:[env.resIDs];if(actionData.args){try{var additionalArgs=JSON.parse(actionData.args.replace(/'/g,'"'));args=args.concat(additionalArgs);}catch(e){console.error("Could not JSON.parse arguments",actionData.args);}}
def=this._rpc({route:'/web/dataset/call_button',params:{args:args,kwargs:{context:context.eval()},method:actionData.name,model:env.model,},});}else if(actionData.type==='action'){def=this._loadAction(actionData.name,_.extend(pyUtils.eval('context',context),{active_model:env.model,active_ids:env.resIDs,active_id:recordID,}));}else{def=Promise.reject();}
def.guardedCatch(ev.data.on_fail);this.dp.add(def).then(function(action){var effect=false;if(actionData.effect){effect=pyUtils.py_eval(actionData.effect);}
if(action&&action.constructor===Object){var ctx=new Context(_.object(_.reject(_.pairs(env.context),function(pair){return pair[0].match('^(?:(?:default_|search_default_|show_).+|'+'.+_view_ref|group_by|group_by_no_leaf|active_id|'+'active_ids|orderedBy)$')!==null;})));ctx.add(actionData.context||{});ctx.add({active_model:env.model});if(recordID){ctx.add({active_id:recordID,active_ids:[recordID],});}
ctx.add(action.context||{});action.context=ctx;action.effect=effect||action.effect;}else{action={effect:effect,type:'ir.actions.act_window_close',};}
var options={on_close:ev.data.on_closed};if(config.device.isMobile&&actionData.mobile){options=Object.assign({},options,actionData.mobile);}
return self.doAction(action,options).then(ev.data.on_success,ev.data.on_fail);});},_onSwitchView:function(ev){ev.stopPropagation();const viewType=ev.data.view_type;const currentController=this.getCurrentController();if(currentController.jsID===ev.data.controllerID){const action=this.actions[currentController.actionID];const currentControllerState=currentController.widget.exportState();action.controllerState=_.extend({},action.controllerState,currentControllerState);const options={controllerState:action.controllerState,currentId:ev.data.res_id,};if(ev.data.mode){options.mode=ev.data.mode;}
this._switchController(action,viewType,options);}},});});;

/* /web/static/src/js/chrome/action_manager_report.js defined in bundle 'web.assets_backend' */
odoo.define('web.ReportActionManager',function(require){"use strict";var ActionManager=require('web.ActionManager');var core=require('web.core');var framework=require('web.framework');var session=require('web.session');var _t=core._t;var _lt=core._lt;var link='<br><br><a href="http://wkhtmltopdf.org/" target="_blank">wkhtmltopdf.org</a>';var WKHTMLTOPDF_MESSAGES={broken:_lt('Your installation of Wkhtmltopdf seems to be broken. The report will be shown '+'in html.')+link,install:_lt('Unable to find Wkhtmltopdf on this system. The report will be shown in '+'html.')+link,upgrade:_lt('You should upgrade your version of Wkhtmltopdf to at least 0.12.0 in order to '+'get a correct display of headers and footers as well as support for '+'table-breaking between pages.')+link,workers:_lt('You need to start Odoo with at least two workers to print a pdf version of '+'the reports.'),};ActionManager.include({_downloadReport:function(url){var self=this;framework.blockUI();return new Promise(function(resolve,reject){var type='qweb-'+url.split('/')[2];var blocked=!session.get_file({url:'/report/download',data:{data:JSON.stringify([url,type]),context:JSON.stringify(session.user_context),},success:resolve,error:(error)=>{self.call('crash_manager','rpc_error',error);reject();},complete:framework.unblockUI,});if(blocked){var message=_t('A popup window with your report was blocked. You '+'may need to change your browser settings to allow '+'popup windows for this page.');self.do_warn(_t('Warning'),message,true);}});},_triggerDownload:function(action,options,type){var self=this;var reportUrls=this._makeReportUrls(action);return this._downloadReport(reportUrls[type]).then(function(){if(action.close_on_report_download){var closeAction={type:'ir.actions.act_window_close'};return self.doAction(closeAction,_.pick(options,'on_close'));}else{return options.on_close();}});},_executeReportAction:function(action,options){var self=this;if(action.report_type==='qweb-html'){return this._executeReportClientAction(action,options);}else if(action.report_type==='qweb-pdf'){return this.call('report','checkWkhtmltopdf').then(function(state){if(state in WKHTMLTOPDF_MESSAGES){self.do_notify(_t('Report'),WKHTMLTOPDF_MESSAGES[state],true);}
if(state==='upgrade'||state==='ok'){return self._triggerDownload(action,options,'pdf');}else{return self._executeReportClientAction(action,options);}});}else if(action.report_type==='qweb-text'){return self._triggerDownload(action,options,'text');}else{console.error("The ActionManager can't handle reports of type "+
action.report_type,action);return Promise.reject();}},_executeReportClientAction:function(action,options){var urls=this._makeReportUrls(action);var clientActionOptions=_.extend({},options,{context:action.context,data:action.data,display_name:action.display_name,name:action.name,report_file:action.report_file,report_name:action.report_name,report_url:urls.html,});return this.doAction('report.client_action',clientActionOptions);},_handleAction:function(action,options){if(action.type==='ir.actions.report'){return this._executeReportAction(action,options);}
return this._super.apply(this,arguments);},_makeReportUrls:function(action){var reportUrls={html:'/report/html/'+action.report_name,pdf:'/report/pdf/'+action.report_name,text:'/report/text/'+action.report_name,};if(_.isUndefined(action.data)||_.isNull(action.data)||(_.isObject(action.data)&&_.isEmpty(action.data))){if(action.context.active_ids){var activeIDsPath='/'+action.context.active_ids.join(',');reportUrls=_.mapObject(reportUrls,function(value){return value+=activeIDsPath;});}
reportUrls.html+='?context='+encodeURIComponent(JSON.stringify(session.user_context));}else{var serializedOptionsPath='?options='+encodeURIComponent(JSON.stringify(action.data));serializedOptionsPath+='&context='+encodeURIComponent(JSON.stringify(action.context));reportUrls=_.mapObject(reportUrls,function(value){return value+=serializedOptionsPath;});}
return reportUrls;},});});;

/* /web/static/src/js/chrome/action_mixin.js defined in bundle 'web.assets_backend' */
odoo.define('web.ActionMixin',function(require){"use strict";const core=require('web.core');const{WidgetAdapterMixin}=require('web.OwlCompatibility');const ActionMixin=Object.assign({},WidgetAdapterMixin,{template:'Action',contentTemplate:null,custom_events:{get_controller_query_params:'_onGetOwnedQueryParams',},_controlPanel:null,_title:'',renderElement:function(){this._super.apply(this,arguments);if(this.contentTemplate){const content=core.qweb.render(this.contentTemplate,{widget:this});this.$('.o_content').append(content);}},willRestore:function(){},canBeRemoved:function(){return Promise.resolve();},getOwnedQueryParams:function(){return{};},getState:function(){return{};},getTitle:function(){return this._title;},renderButtons:function($node){},updateButtons:function(){},updateControlPanel:async function(newProps={}){if(!this.withControlPanel&&!this.hasControlPanel){return;}
const props=Object.assign({},newProps);if('title'in props){this._setTitle(props.title);this.controlPanelProps.title=this.getTitle();delete props.title;}
if('cp_content'in props){this.controlPanelProps.cp_content=Object.assign({},this.controlPanelProps.cp_content,props.cp_content,);delete props.cp_content;}
Object.assign(this.controlPanelProps,props);return this._controlPanelWrapper.update(this.controlPanelProps);},_setTitle:function(title){this._title=title;},_onGetOwnedQueryParams:function(callback){const state=this.getOwnedQueryParams();callback(state||{});},});return ActionMixin;});;

/* /web/static/src/js/chrome/abstract_web_client.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractWebClient',function(require){"use strict";var ActionManager=require('web.ActionManager');var concurrency=require('web.concurrency');var core=require('web.core');var config=require('web.config');var WarningDialog=require('web.CrashManager').WarningDialog;var data_manager=require('web.data_manager');var dom=require('web.dom');var KeyboardNavigationMixin=require('web.KeyboardNavigationMixin');var Loading=require('web.Loading');var RainbowMan=require('web.RainbowMan');var session=require('web.session');var utils=require('web.utils');var Widget=require('web.Widget');const env=require('web.env');var _t=core._t;var AbstractWebClient=Widget.extend(KeyboardNavigationMixin,{dependencies:['notification'],events:_.extend({},KeyboardNavigationMixin.events),custom_events:{call_service:'_onCallService',clear_uncommitted_changes:function(e){this.clear_uncommitted_changes().then(e.data.callback);},toggle_fullscreen:function(event){this.toggle_fullscreen(event.data.fullscreen);},current_action_updated:function(ev){this.current_action_updated(ev.data.action,ev.data.controller);},warning:'_onDisplayWarning',load_action:'_onLoadAction',load_views:function(event){var params={model:event.data.modelName,context:event.data.context,views_descr:event.data.views,};return data_manager.load_views(params,event.data.options||{}).then(event.data.on_success);},load_filters:function(event){return data_manager.load_filters(event.data).then(event.data.on_success);},create_filter:'_onCreateFilter',delete_filter:'_onDeleteFilter',push_state:'_onPushState',show_effect:'_onShowEffect',get_session:function(event){if(event.data.callback){event.data.callback(session);}},do_action:function(event){const actionProm=this.do_action(event.data.action,event.data.options||{});this.menu_dp.add(actionProm).then(function(result){if(event.data.on_success){event.data.on_success(result);}}).guardedCatch(function(result){if(event.data.on_fail){event.data.on_fail(result);}});},getScrollPosition:'_onGetScrollPosition',scrollTo:'_onScrollTo',set_title_part:'_onSetTitlePart',webclient_started:'_onWebClientStarted',},init:function(parent){odoo.isReady=false;this.client_options={};this._super(parent);KeyboardNavigationMixin.init.call(this);this.origin=undefined;this._current_state=null;this.menu_dp=new concurrency.DropPrevious();this.action_mutex=new concurrency.Mutex();this.set('title_part',{"zopenerp":"Odoo"});this.env=env;this.env.bus.on('set_title_part',this,this._onSetTitlePart);},start:function(){KeyboardNavigationMixin.start.call(this);var self=this;this.$el.toggleClass('o_touch_device',config.device.touch);this.on("change:title_part",this,this._title_changed);this._title_changed();var state=$.bbq.getState();var current_company_id=session.user_companies.current_company[0]
if(!state.cids){state.cids=utils.get_cookie('cids')!==null?utils.get_cookie('cids'):String(current_company_id);}
const cids=Array.isArray(state.cids)?state.cids[0]:state.cids;let stateCompanyIDS=cids.split(',').map(cid=>parseInt(cid,10));var userCompanyIDS=_.map(session.user_companies.allowed_companies,function(company){return company[0]});if(!_.isEmpty(_.difference(stateCompanyIDS,userCompanyIDS))){state.cids=String(current_company_id);stateCompanyIDS=[current_company_id]}
session.user_context.allowed_company_ids=stateCompanyIDS;$.bbq.pushState(state);$("link[type='image/x-icon']").attr('href','/web/image/res.company/'+String(stateCompanyIDS[0])+'/favicon/')
return session.is_bound.then(function(){self.$el.toggleClass('o_rtl',_t.database.parameters.direction==="rtl");self.bind_events();return Promise.all([self.set_action_manager(),self.set_loading()]);}).then(function(){if(session.session_is_valid()){return self.show_application();}else{return Promise.resolve();}});},destroy:function(){KeyboardNavigationMixin.destroy.call(this);return this._super(...arguments);},bind_events:function(){var self=this;$('.oe_systray').show();this.$el.on('mouseenter','.oe_systray > div:not([data-toggle=tooltip])',function(){$(this).attr('data-toggle','tooltip').tooltip().trigger('mouseenter');});this.$el.on('click','.oe_dropdown_toggle',function(ev){ev.preventDefault();var $toggle=$(this);var doc_width=$(document).width();var $menu=$toggle.siblings('.oe_dropdown_menu');$menu=$menu.length>=1?$menu:$toggle.find('.oe_dropdown_menu');var state=$menu.is('.oe_opened');setTimeout(function(){$toggle.add($menu).toggleClass('oe_opened',!state);if(!state){var offset=$menu.offset();var menu_width=$menu.width();var x=doc_width-offset.left-menu_width-2;if(x<0){$menu.offset({left:offset.left+x}).width(menu_width);}}},0);});core.bus.on('click',this,function(ev){$('.tooltip').remove();if(!$(ev.target).is('input[type=file]')){$(this.el.getElementsByClassName('oe_dropdown_menu oe_opened')).removeClass('oe_opened');$(this.el.getElementsByClassName('oe_dropdown_toggle oe_opened')).removeClass('oe_opened');}});core.bus.on('connection_lost',this,this._onConnectionLost);core.bus.on('connection_restored',this,this._onConnectionRestored);},set_action_manager:function(){var self=this;this.action_manager=new ActionManager(this,session.user_context);this.env.bus.on('do-action',this,payload=>{this.do_action(payload.action,payload.options||{}).then(payload.on_success||(()=>{})).guardedCatch(payload.on_fail||(()=>{}));});var fragment=document.createDocumentFragment();return this.action_manager.appendTo(fragment).then(function(){dom.append(self.$el,fragment,{in_DOM:true,callbacks:[{widget:self.action_manager}],});});},set_loading:function(){this.loading=new Loading(this);return this.loading.appendTo(this.$el);},show_application:function(){},clear_uncommitted_changes:function(){return this.action_manager.clearUncommittedChanges();},destroy_content:function(){_.each(_.clone(this.getChildren()),function(el){el.destroy();});this.$el.children().remove();},set_title:function(title){this.set_title_part("action",title);},set_title_part:function(part,title){var tmp=_.clone(this.get("title_part"));tmp[part]=title;this.set("title_part",tmp);},_title_changed:function(){var parts=_.sortBy(_.keys(this.get("title_part")),function(x){return x;});var tmp="";_.each(parts,function(part){var str=this.get("title_part")[part];if(str){tmp=tmp?tmp+" - "+str:str;}},this);document.title=tmp;},do_action:function(){return this.action_manager.doAction.apply(this.action_manager,arguments);},do_reload:function(){var self=this;return session.session_reload().then(function(){session.load_modules(true).then(self.menu.proxy('do_reload'));});},do_push_state:function(state){if(!state.menu_id&&this.menu){state.menu_id=this.menu.getCurrentPrimaryMenu();}
if('title'in state){this.set_title(state.title);delete state.title;}
var url='#'+$.param(state);this._current_state=$.deparam($.param(state),false);$.bbq.pushState(url);this.trigger('state_pushed',state);},current_action_updated:function(action,controller){},toggle_fullscreen:function(fullscreen){this.$el.toggleClass('o_fullscreen',fullscreen);},getScrollPosition:function(){var scrollingEl=this.action_manager.el.getElementsByClassName('o_content')[0];return{left:scrollingEl?scrollingEl.scrollLeft:0,top:scrollingEl?scrollingEl.scrollTop:0,};},_onCallService:function(ev){const payload=ev.data;let args=payload.args||[];if(payload.service==='ajax'&&payload.method==='rpc'){args=args.concat(ev.target);}
const service=this.env.services[payload.service];const result=service[payload.method].apply(service,args);payload.callback(result);},_onConnectionLost:function(){this.connectionNotificationID=this.displayNotification({message:_t('Connection lost. Trying to reconnect...'),sticky:true});},_onConnectionRestored:function(){if(this.connectionNotificationID){this.call('notification','close',this.connectionNotificationID);this.displayNotification({type:'info',message:_t('Connection restored. You are back online.'),sticky:false});this.connectionNotificationID=false;}},_onCreateFilter:function(e){data_manager.create_filter(e.data.filter).then(e.data.on_success);},_onDeleteFilter:function(e){data_manager.delete_filter(e.data.filterId).then(e.data.on_success);},_onDisplayWarning:function(e){var data=e.data;if(data.type==='dialog'){new WarningDialog(this,{title:data.title,},data).open();}else{data.type='warning';this.call('notification','notify',data);}},_onGetScrollPosition:function(ev){ev.data.callback(this.getScrollPosition());},_onLoadAction:function(event){data_manager.load_action(event.data.actionID,event.data.context).then(event.data.on_success);},_onPushState:function(e){this.do_push_state(_.extend(e.data.state,{'cids':$.bbq.getState().cids}));},_onScrollTo:function(ev){var scrollingEl=this.action_manager.el.getElementsByClassName('o_content')[0];if(!scrollingEl){return;}
var offset={top:ev.data.top,left:ev.data.left||0};if(ev.data.selector){offset=dom.getPosition(document.querySelector(ev.data.selector));offset.top-=dom.getPosition(scrollingEl).top;}
scrollingEl.scrollTop=offset.top;scrollingEl.scrollLeft=offset.left;},_onSetTitlePart:function(payload){var part=payload.part;var title=payload.title;this.set_title_part(part,title);},_onShowEffect:function(e){var data=e.data||{};var type=data.type||'rainbow_man';if(type==='rainbow_man'){if(session.show_effect){new RainbowMan(data).appendTo(this.$el);}else{this.call('notification','notify',{title:"",message:data.message,sticky:false});}}else{throw new Error('Unknown effect type: '+type);}},_onWebClientStarted:function(){if(!this.isStarted){this.action_manager.$el.on('scroll',core.bus.trigger.bind(core.bus,'scroll'));odoo.isReady=true;core.bus.trigger('web_client_ready');if(session.uid===1){this.$el.addClass('o_is_superuser');}
this.isStarted=true;}}});return AbstractWebClient;});;

/* /web/static/src/js/chrome/web_client.js defined in bundle 'web.assets_backend' */
odoo.define('web.WebClient',function(require){"use strict";var AbstractWebClient=require('web.AbstractWebClient');var config=require('web.config');var core=require('web.core');var data_manager=require('web.data_manager');var dom=require('web.dom');var Menu=require('web.Menu');var session=require('web.session');return AbstractWebClient.extend({custom_events:_.extend({},AbstractWebClient.prototype.custom_events,{app_clicked:'on_app_clicked',menu_clicked:'on_menu_clicked',}),start:function(){core.bus.on('change_menu_section',this,function(menuID){this.do_push_state(_.extend($.bbq.getState(),{menu_id:menuID,}));});return this._super.apply(this,arguments);},bind_events:function(){var self=this;this._super.apply(this,arguments);this.$el.on('click','a',function(ev){var disable_anchor=ev.target.attributes.disable_anchor;if(disable_anchor&&disable_anchor.value==="true"){return;}
var href=ev.target.attributes.href;if(href){if(href.value[0]==='#'&&href.value.length>1){if(self.$("[id='"+href.value.substr(1)+"']").length){ev.preventDefault();self.trigger_up('scrollTo',{'selector':href.value});}}}});},load_menus:function(){return(odoo.loadMenusPromise||odoo.reloadMenus()).then(function(menuData){for(var i=0;i<menuData.children.length;i++){var child=menuData.children[i];if(child.action===false){while(child.children&&child.children.length){child=child.children[0];if(child.action){menuData.children[i].action=child.action;break;}}}}
odoo.loadMenusPromise=null;return menuData;});},async show_application(){this.set_title();await this.menu_dp.add(this.instanciate_menu_widgets());$(window).bind('hashchange',this.on_hashchange);const state=$.bbq.getState(true);if(!_.isEqual(_.keys(state),["cids"])){return this.on_hashchange();}
const[data]=await this.menu_dp.add(this._rpc({model:'res.users',method:'read',args:[session.uid,["action_id"]],}));if(data.action_id){await this.do_action(data.action_id[0]);this.menu.change_menu_section(this.menu.action_id_to_primary_menu_id(data.action_id[0]));return;}
if(!this.menu.openFirstApp()){this.trigger_up('webclient_started');}},instanciate_menu_widgets:function(){var self=this;var proms=[];return this.load_menus().then(function(menuData){self.menu_data=menuData;if(self.menu){self.menu.destroy();}
self.menu=new Menu(self,menuData);proms.push(self.menu.prependTo(self.$el));return Promise.all(proms);});},on_hashchange:function(event){if(this._ignore_hashchange){this._ignore_hashchange=false;return Promise.resolve();}
var self=this;return this.clear_uncommitted_changes().then(function(){var stringstate=$.bbq.getState(false);if(!_.isEqual(self._current_state,stringstate)){var state=$.bbq.getState(true);if(state.action||(state.model&&(state.view_type||state.id))){return self.menu_dp.add(self.action_manager.loadState(state,!!self._current_state)).then(function(){if(state.menu_id){if(state.menu_id!==self.menu.current_primary_menu){core.bus.trigger('change_menu_section',state.menu_id);}}else{var action=self.action_manager.getCurrentAction();if(action){var menu_id=self.menu.action_id_to_primary_menu_id(action.id);core.bus.trigger('change_menu_section',menu_id);}}});}else if(state.menu_id){var action_id=self.menu.menu_id_to_action_id(state.menu_id);return self.menu_dp.add(self.do_action(action_id,{clear_breadcrumbs:true})).then(function(){core.bus.trigger('change_menu_section',state.menu_id);});}else{self.menu.openFirstApp();}}
self._current_state=stringstate;},function(){if(event){self._ignore_hashchange=true;window.location=event.originalEvent.oldURL;}});},on_app_clicked:function(ev){var self=this;return this.menu_dp.add(data_manager.load_action(ev.data.action_id)).then(function(result){return self.action_mutex.exec(function(){var completed=new Promise(function(resolve,reject){var options=_.extend({},ev.data.options,{clear_breadcrumbs:true,action_menu_id:ev.data.menu_id,});Promise.resolve(self._openMenu(result,options)).then(function(){self._on_app_clicked_done(ev).then(resolve).guardedCatch(reject);}).guardedCatch(function(){resolve();});setTimeout(function(){resolve();},2000);});return completed;});});},_on_app_clicked_done:function(ev){core.bus.trigger('change_menu_section',ev.data.menu_id);return Promise.resolve();},on_menu_clicked:function(ev){var self=this;return this.menu_dp.add(data_manager.load_action(ev.data.action_id)).then(function(result){self.$el.removeClass('o_mobile_menu_opened');return self.action_mutex.exec(function(){var completed=new Promise(function(resolve,reject){Promise.resolve(self._openMenu(result,{clear_breadcrumbs:true,})).then(resolve).guardedCatch(reject);setTimeout(function(){resolve();},2000);});return completed;});}).guardedCatch(function(){self.$el.removeClass('o_mobile_menu_opened');});},_openMenu:function(action,options){return this.do_action(action,options);},});});;

/* /web/static/src/js/chrome/root_widget.js defined in bundle 'web.assets_backend' */
odoo.define('root.widget',function(require){"use strict";var webClient=require('web.web_client');return webClient;});;

/* /web/static/src/js/_deprecated/data.js defined in bundle 'web.assets_backend' */
odoo.define('web.data',function(require){"use strict";var Class=require('web.Class');var Context=require('web.Context');var concurrency=require('web.concurrency');var mixins=require('web.mixins');var session=require('web.session');var translation=require('web.translation');var pyUtils=require('web.py_utils');var _t=translation._t;function serialize_sort(criterion){return _.map(criterion,function(criteria){if(criteria[0]==='-'){return criteria.slice(1)+' DESC';}
return criteria+' ASC';}).join(', ');}
function deserialize_sort(criterion){return _.map(criterion,function(criteria){var split=_.without(criteria.split(' '),'');return(split[1]&&split[1].toLowerCase()==='desc'?'-':'')+split[0];});}
var Query=Class.extend({init:function(model,fields){this._model=model;this._fields=fields;this._filter=[];this._context={};this._lazy=true;this._limit=false;this._offset=0;this._order_by=[];},clone:function(to_set){to_set=to_set||{};var q=new Query(this._model,this._fields);q._context=this._context;q._filter=this._filter;q._lazy=this._lazy;q._limit=this._limit;q._offset=this._offset;q._order_by=this._order_by;for(var key in to_set){if(!to_set.hasOwnProperty(key)){continue;}
switch(key){case'filter':q._filter=(q._filter||[]).concat(to_set.filter||[]);break;case'context':q._context=new Context(q._context,to_set.context);break;case'lazy':case'limit':case'offset':case'order_by':q['_'+key]=to_set[key];}}
return q;},_execute:function(options){var self=this;options=options||{};return session.rpc('/web/dataset/search_read',{model:this._model.name,fields:this._fields||false,domain:pyUtils.eval('domains',[this._model.domain(this._filter)]),context:pyUtils.eval('contexts',[this._model.context(this._context)]),offset:this._offset,limit:this._limit,sort:serialize_sort(this._order_by)},options).then(function(results){self._count=results.length;return results.records;},null);},first:function(options){var self=this;return this.clone({limit:1})._execute(options).then(function(records){delete self._count;if(records.length){return records[0];}
return null;});},all:function(options){return this._execute(options);},count:function(){if(this._count!==undefined){return Promise.resolve(this._count);}
return this._model.call('search_count',[this._filter],{context:this._model.context(this._context)});},group_by:function(grouping){var ctx=pyUtils.eval('context',this._model.context(this._context));if(_.isUndefined(grouping)){grouping=[];}
if(!(grouping instanceof Array)){grouping=_.toArray(arguments);}
if(_.isEmpty(grouping)&&!ctx.group_by_no_leaf){return null;}
var raw_fields=_.map(grouping.concat(this._fields||[]),function(field){return field.split(':')[0];});var self=this;return this._model.call('read_group',{groupby:grouping,fields:_.uniq(raw_fields),domain:this._model.domain(this._filter),context:ctx,offset:this._offset,lazy:this._lazy,limit:this._limit,orderby:serialize_sort(this._order_by)||false}).then(function(results){return _(results).map(function(result){result.__context=result.__context||{};result.__context.group_by=result.__context.group_by||[];_.defaults(result.__context,ctx);var grouping_fields=self._lazy?[grouping[0]]:grouping;return new QueryGroup(self._model.name,grouping_fields,result);});});},context:function(context){if(!context){return this;}
return this.clone({context:context});},filter:function(domain){if(!domain){return this;}
return this.clone({filter:domain});},lazy:function(lazy){return this.clone({lazy:lazy});},limit:function(limit){return this.clone({limit:limit});},offset:function(offset){return this.clone({offset:offset});},order_by:function(fields){if(fields===undefined){return this;}
if(!(fields instanceof Array)){fields=_.toArray(arguments);}
if(_.isEmpty(fields)){return this;}
return this.clone({order_by:fields});}});var QueryGroup=Class.extend({init:function(model,grouping_fields,read_group_group){var fixed_group=_.extend({__context:{group_by:[]},__domain:[]},read_group_group);var count_key=(grouping_fields[0]&&grouping_fields[0].split(':')[0])+'_count';var aggregates={};for(var key in fixed_group){if(fixed_group.hasOwnProperty(key)){if(!(key.indexOf('__')===0||_.contains(grouping_fields,key)||(key===count_key))){aggregates[key]=fixed_group[key]||0;}}}
this.model=new Model(model,fixed_group.__context,fixed_group.__domain);var group_size=fixed_group[count_key]||fixed_group.__count||0;var leaf_group=fixed_group.__context.group_by.length===0;var value=(grouping_fields.length===1)?fixed_group[grouping_fields[0]]:_.map(grouping_fields,function(field){return fixed_group[field];});var grouped_on=(grouping_fields.length===1)?grouping_fields[0]:grouping_fields;this.attributes={folded:!!(fixed_group.__fold),grouped_on:grouped_on,length:group_size,value:value,has_children:!(leaf_group&&fixed_group.__context.group_by_no_leaf),aggregates:aggregates};},get:function(key){return this.attributes[key];},subgroups:function(){return this.model.query().group_by(this.model.context().group_by);},query:function(){return this.model.query.apply(this.model,arguments);}});var DataSet=Class.extend(mixins.PropertiesMixin,{init:function(parent,model,context){mixins.PropertiesMixin.init.call(this);this.setParent(parent);this.model=model;this.context=context||{};this.index=null;this._sort=[];this._model=new Model(model,context);this.orderer=new concurrency.DropMisordered();},previous:function(){this.index-=1;if(!this.ids.length){this.index=null;}else if(this.index<0){this.index=this.ids.length-1;}
return this;},next:function(){this.index+=1;if(!this.ids.length){this.index=null;}else if(this.index>=this.ids.length){this.index=0;}
return this;},select_id:function(id){var idx=this.get_id_index(id);if(idx===null){return false;}else{this.index=idx;return true;}},get_id_index:function(id){for(var i=0,ii=this.ids.length;i<ii;i++){if(id==this.ids[i]){return i;}}
return null;},read_ids:function(ids,fields,options){if(_.isEmpty(ids)){return Promise.resolve([]);}
options=options||{};var method='read';var ids_arg=ids;var context=this.get_context(options.context);if(options.check_access_rule===true){method='search_read';ids_arg=[['id','in',ids]];context=new Context(context,{active_test:false});}
return this._model.call(method,[ids_arg,fields||false],{context:context}).then(function(records){if(records.length<=1){return records;}
var indexes={};for(var i=0;i<ids.length;i++){indexes[ids[i]]=i;}
records.sort(function(a,b){return indexes[a.id]-indexes[b.id];});return records;});},read_slice:function(fields,options){var self=this;options=options||{};var query=this._model.query(fields).limit(options.limit||false).offset(options.offset||0).all();var prom=this.orderer.add(query);prom.then(function(records){self.ids=_(records).pluck('id');});return prom;},read_index:function(fields,options){options=options||{};return this.read_ids([this.ids[this.index]],fields,options).then(function(records){if(_.isEmpty(records)){return Promise.reject();}
return records[0];});},default_get:function(fields,options){options=options||{};return this._model.call('default_get',[fields],{context:this.get_context(options.context)});},create:function(data,options){var self=this;var prom=this._model.call('create',[data],{context:this.get_context()});prom.then(function(){self.trigger('dataset_changed',data,options);});return prom;},write:function(id,data,options){options=options||{};var self=this;var prom=this._model.call('write',[[id],data],{context:this.get_context(options.context)});prom.then(function(){self.trigger('dataset_changed',id,data,options);});return prom;},unlink:function(ids){var self=this;var prom=this._model.call('unlink',[ids],{context:this.get_context()});prom.then(function(){self.trigger('dataset_changed',ids);});return prom;},call:function(method,args){return this._model.call(method,args);},call_button:function(method,args){return this._model.call_button(method,args);},name_get:function(ids){return this._model.call('name_get',[ids],{context:this.get_context()});},name_search:function(name,domain,operator,limit){return this._model.call('name_search',{name:name||'',args:domain||false,operator:operator||'ilike',context:this._model.context(),limit:limit||0});},name_create:function(name,context){return this._model.call('name_create',[name],{context:this.get_context(context)});},get_context:function(request_context){return this._model.context(request_context);},sort:function(field,force_reverse){if(!field){return serialize_sort(this._sort);}
var reverse=force_reverse||(this._sort[0]===field);this._sort.splice.apply(this._sort,[0,this._sort.length].concat(_.without(this._sort,field,'-'+field)));this._sort.unshift((reverse?'-':'')+field);return undefined;},set_sort:function(fields_list){this._sort=deserialize_sort(fields_list);},size:function(){return this.ids.length;},alter_ids:function(n_ids){this.ids=n_ids;},remove_ids:function(ids){this.alter_ids(_(this.ids).difference(ids));},add_ids:function(ids,at){var args=[at,0].concat(_.difference(ids,this.ids));this.ids.splice.apply(this.ids,args);},resequence:function(ids,options){options=options||{};return session.rpc('/web/dataset/resequence',{model:this.model,ids:ids,context:pyUtils.eval('context',this.get_context(options.context)),}).then(function(results){return results;});},});var DataSetStatic=DataSet.extend({init:function(parent,model,context,ids){this._super(parent,model,context);this.ids=ids||[];},read_slice:function(fields,options){options=options||{};fields=fields||{};var offset=options.offset||0,limit=options.limit||false;var end_pos=limit&&limit!==-1?offset+limit:this.ids.length;return this.read_ids(this.ids.slice(offset,end_pos),fields,options);},set_ids:function(ids){this.ids=ids;if(ids.length===0){this.index=null;}else if(this.index>=ids.length-1){this.index=ids.length-1;}},unlink:function(ids){this.set_ids(_.without.apply(null,[this.ids].concat(ids)));this.trigger('unlink',ids);return Promise.resolve({result:true});},});var DataSetSearch=DataSet.extend({init:function(parent,model,context,domain){this._super(parent,model,context);this.domain=domain||[];this._length=null;this.ids=[];this._model=new Model(model,context,domain);},read_slice:function(fields,options){options=options||{};var self=this;var q=this._model.query(fields||false).filter(options.domain).context(options.context).offset(options.offset||0).limit(options.limit||false);q=q.order_by.apply(q,this._sort);var prom=this.orderer.add(q.all());prom.then(function(records){q.count().then(function(count){self._length=count;});self.ids=_(records).pluck('id');});return prom;},get_domain:function(other_domain){return this._model.domain(other_domain);},alter_ids:function(ids){this._super(ids);if(this.index!==null&&this.index>=this.ids.length){this.index=this.ids.length>0?this.ids.length-1:0;}},remove_ids:function(ids){var before=this.ids.length;this._super(ids);if(this._length){this._length-=(before-this.ids.length);}},add_ids:function(ids,at){var before=this.ids.length;this._super(ids,at);if(this._length){this._length+=(this.ids.length-before);}},unlink:function(ids,callback,error_callback){var self=this;var prom=this._super(ids);prom.then(function(){self.remove_ids(ids);self.trigger("dataset_changed",ids,callback,error_callback);});return prom;},size:function(){if(this._length!==null){return this._length;}
return this._super();}});var data={Query:Query,DataSet:DataSet,DataSetStatic:DataSetStatic,DataSetSearch:DataSetSearch,noDisplayContent:"<em class=\"text-warning\">"+_t("Unnamed")+"</em>",};var Model=Class.extend({init:function(name,context,domain){this.name=name;this._context=context||{};this._domain=domain||[];},get_func:function(method_name){var self=this;return function(){return self.call(method_name,_.toArray(arguments));};},query:function(fields){return new data.Query(this,fields);},domain:function(domain){if(!domain){return this._domain;}
return this._domain.concat(domain);},context:function(context){return new Context(session.user_context,this._context,context||{});},call:function(method,args,kwargs,options){args=args||[];kwargs=kwargs||{};if(!_.isArray(args)){kwargs=args;args=[];}
pyUtils.ensure_evaluated(args,kwargs);var call_kw='/web/dataset/call_kw/'+this.name+'/'+method;return session.rpc(call_kw,{model:this.name,method:method,args:args,kwargs:kwargs},options);},call_button:function(method,args){pyUtils.ensure_evaluated(args,{});var context=(args||[]).length>0?args.pop():{};return session.rpc('/web/dataset/call_button',{model:this.name,method:method,args:args||[],kwargs:{context:context},});},});return data;});;

/* /web/static/src/js/core/context.js defined in bundle 'web.assets_backend' */
odoo.define('web.Context',function(require){"use strict";var Class=require('web.Class');var pyUtils=require('web.py_utils');var Context=Class.extend({init:function(){this.__ref="compound_context";this.__contexts=[];this.__eval_context=null;var self=this;_.each(arguments,function(x){self.add(x);});},add:function(context){this.__contexts.push(context);return this;},eval:function(){return pyUtils.eval('context',this);},set_eval_context:function(evalContext){for(var key in evalContext){if(evalContext[key]instanceof moment){evalContext[key]=evalContext[key].toJSON();}}
this.__eval_context=evalContext;return this;},});return Context;});;

/* /web/static/src/js/core/data_comparison_utils.js defined in bundle 'web.assets_backend' */
odoo.define('web.dataComparisonUtils',function(require){"use strict";var fieldUtils=require('web.field_utils');var Class=require('web.Class');var DateClasses=Class.extend({init:function(dateSets){this.dateSets=dateSets;this.referenceIndex=null;for(var i=0;i<dateSets.length;i++){var dateSet=dateSets[i];if(dateSet.length&&this.referenceIndex===null){this.referenceIndex=i;}}},dateClass:function(datesetIndex,date){return this.dateSets[datesetIndex].indexOf(date);},dateClassMembers:function(dateClass){return _.uniq(_.compact(this.dateSets.map(function(dateSet){return dateSet[dateClass];})));},representative:function(dateClass,index){index=index===undefined?this.referenceIndex:index;return this.dateSets[index][dateClass];},});function computeVariation(value,comparisonValue){if(isNaN(value)||isNaN(comparisonValue)){return NaN;}
if(comparisonValue===0){if(value===0){return 0;}else if(value>0){return 1;}else{return-1;}}
return(value-comparisonValue)/Math.abs(comparisonValue);}
function renderVariation(variation,field,options){var className='o_variation';var value;if(!isNaN(variation)){if(variation>0){className+=' o_positive';}else if(variation<0){className+=' o_negative';}else{className+=' o_null';}
value=fieldUtils.format.percentage(variation,field,options);}else{value='-';}
return $('<div>',{class:className,html:value});}
function renderComparison($node,value,comparisonValue,variation,formatter,field,options){var $variation=renderVariation(variation,field,options);$node.append($variation);if(!isNaN(variation)){$node.append($('<div>',{class:'o_comparison'}).html(formatter(value,field,options)+' <span>vs</span> '+formatter(comparisonValue,field,options)));}}
return{computeVariation:computeVariation,DateClasses:DateClasses,renderComparison:renderComparison,renderVariation:renderVariation,};});;

/* /web/static/src/js/core/math_utils.js defined in bundle 'web.assets_backend' */
odoo.define('web.mathUtils',function(){"use strict";function _cartesian(){var args=Array.prototype.slice.call(arguments);if(args.length===0){return[undefined];}
var firstArray=args[0].map(function(elem){return[elem];});if(args.length===1){return firstArray;}
var productOfOtherArrays=_cartesian.apply(null,args.slice(1));var result=firstArray.reduce(function(acc,elem){return acc.concat(productOfOtherArrays.map(function(tuple){return elem.concat(tuple);}));},[]);return result;}
function cartesian(){var args=Array.prototype.slice.call(arguments);if(args.length===0){return[undefined];}else if(args.length===1){return args[0];}else{return _cartesian.apply(null,args);}}
function sections(array){var sections=[];for(var i=0;i<array.length+1;i++){sections.push(array.slice(0,i));}
return sections;}
return{cartesian:cartesian,sections:sections,};});;

/* /web/static/src/js/core/misc.js defined in bundle 'web.assets_backend' */
odoo.define('web.framework',function(require){"use strict";var core=require('web.core');var ajax=require('web.ajax');var Widget=require('web.Widget');var disableCrashManager=require('web.CrashManager').disable;const{sprintf}=require('web.utils')
var _t=core._t;var messages_by_seconds=function(){return[[0,_t("Loading...")],[20,_t("Still loading...")],[60,_t("Still loading...<br />Please be patient.")],[120,_t("Don't leave yet,<br />it's still loading...")],[300,_t("You may not believe it,<br />but the application is actually loading...")],[420,_t("Take a minute to get a coffee,<br />because it's loading...")],[3600,_t("Maybe you should consider reloading the application by pressing F5...")]];};var Throbber=Widget.extend({template:"Throbber",start:function(){this.start_time=new Date().getTime();this.act_message();},act_message:function(){var self=this;setTimeout(function(){if(self.isDestroyed())
return;var seconds=(new Date().getTime()-self.start_time)/1000;var mes;_.each(messages_by_seconds(),function(el){if(seconds>=el[0])
mes=el[1];});self.$(".oe_throbber_message").html(mes);self.act_message();},1000);},});if($.blockUI){$.blockUI.defaults.baseZ=1100;$.blockUI.defaults.message='<div class="openerp oe_blockui_spin_container" style="background-color: transparent;">';$.blockUI.defaults.css.border='0';$.blockUI.defaults.css["background-color"]='';}
function blockAccessKeys(){var elementWithAccessKey=[];elementWithAccessKey=document.querySelectorAll('[accesskey]');_.each(elementWithAccessKey,function(elem){elem.setAttribute("data-accesskey",elem.getAttribute('accesskey'));elem.removeAttribute('accesskey');});}
function unblockAccessKeys(){var elementWithDataAccessKey=[];elementWithDataAccessKey=document.querySelectorAll('[data-accesskey]');_.each(elementWithDataAccessKey,function(elem){elem.setAttribute('accesskey',elem.getAttribute('data-accesskey'));elem.removeAttribute('data-accesskey');});}
var throbbers=[];function blockUI(){var tmp=$.blockUI.apply($,arguments);var throbber=new Throbber();throbbers.push(throbber);throbber.appendTo($(".oe_blockui_spin_container"));$(document.body).addClass('o_ui_blocked');blockAccessKeys();return tmp;}
function unblockUI(){_.invoke(throbbers,'destroy');throbbers=[];$(document.body).removeClass('o_ui_blocked');unblockAccessKeys();return $.unblockUI.apply($,arguments);}
function redirect(url,wait){disableCrashManager();var load=function(){var old=""+window.location;var old_no_hash=old.split("#")[0];var url_no_hash=url.split("#")[0];location.assign(url);if(old_no_hash===url_no_hash){location.reload(true);}};var wait_server=function(){ajax.rpc("/web/webclient/version_info",{}).then(load).guardedCatch(function(){setTimeout(wait_server,250);});};if(wait){setTimeout(wait_server,1000);}else{load();}}
function Reload(parent,action){var params=action.params||{};var menu_id=params.menu_id||false;var l=window.location;var sobj=$.deparam(l.search.substr(1));if(params.url_search){sobj=_.extend(sobj,params.url_search);}
var search='?'+$.param(sobj);var hash=l.hash;if(menu_id){hash="#menu_id="+menu_id;}
var url=l.protocol+"//"+l.host+l.pathname+search+hash;core.bus.trigger('clear_cache');redirect(url,params.wait);}
core.action_registry.add("reload",Reload);function Home(parent,action){var url='/'+(window.location.search||'');redirect(url,action&&action.params&&action.params.wait);}
core.action_registry.add("home",Home);function login(){redirect('/web/login');}
core.action_registry.add("login",login);function logout(){redirect('/web/session/logout');}
core.action_registry.add("logout",logout);function displayNotification(parent,action){let{title='',message='',links=[],type='info',sticky=false,next}=action.params||{};links=links.map(({url,label})=>`<a href="${_.escape(url)}" target="_blank">${_.escape(label)}</a>`)
parent.displayNotification({title:_.escape(title),message:sprintf(_.escape(message),...links),type,sticky});return next;}
core.action_registry.add("display_notification",displayNotification);function ReloadContext(parent,action){ajax.rpc("/web/session/get_session_info",{}).then(function(){Reload(parent,action);});}
core.action_registry.add("reload_context",ReloadContext);if(!document.contains){document.contains=function contains(node){if(!(0 in arguments)){throw new TypeError('1 argument is required');}
do{if(this===node){return true;}}while(node=node&&node.parentNode);return false;};}
return{blockUI:blockUI,unblockUI:unblockUI,redirect:redirect,};});;

/* /web/static/src/js/services/crash_manager_service.js defined in bundle 'web.assets_backend' */
odoo.define('crash_manager.service',function(require){'use strict';const core=require('web.core');const CrashManager=require('web.CrashManager').CrashManager;core.serviceRegistry.add('crash_manager',CrashManager);});;

/* /web/static/src/js/services/data_manager.js defined in bundle 'web.assets_backend' */
odoo.define('web.DataManager',function(require){"use strict";var config=require('web.config');var core=require('web.core');var rpc=require('web.rpc');var session=require('web.session');var utils=require('web.utils');return core.Class.extend({init:function(){this._init_cache();core.bus.on('clear_cache',this,this.invalidate.bind(this));},_init_cache:function(){this._cache={actions:{},filters:{},views:{},};},invalidate:function(){session.invalidateCacheKey('load_menus');this._init_cache();},load_action:function(action_id,additional_context){var self=this;var key=this._gen_key(action_id,additional_context||{});if(config.isDebug('assets')||!this._cache.actions[key]){this._cache.actions[key]=rpc.query({route:"/web/action/load",params:{action_id:action_id,additional_context:additional_context,},}).then(function(action){self._cache.actions[key]=action.no_cache?null:self._cache.actions[key];return action;}).guardedCatch(()=>this._invalidate('actions',key));}
return this._cache.actions[key].then(function(action){return $.extend(true,{},action);});},load_views:async function({model,context,views_descr},options={}){const viewsKey=this._gen_key(model,views_descr,options,context);const filtersKey=this._gen_key(model,options.action_id);const withFilters=Boolean(options.load_filters);const shouldLoadViews=config.isDebug('assets')||!this._cache.views[viewsKey];const shouldLoadFilters=config.isDebug('assets')||(withFilters&&!this._cache.filters[filtersKey]);if(shouldLoadViews){options.load_filters=shouldLoadFilters;this._cache.views[viewsKey]=rpc.query({args:[],kwargs:{context,options,views:views_descr},model,method:'load_views',}).then(result=>{utils.deepFreeze(result.fields);for(const[viewId,viewType]of views_descr){const fvg=result.fields_views[viewType];fvg.viewFields=fvg.fields;fvg.fields=result.fields;}
if(shouldLoadFilters){this._cache.filters[filtersKey]=Promise.resolve(result.filters);}
return result.fields_views;}).guardedCatch(()=>this._invalidate('views',viewsKey));}
const result=await this._cache.views[viewsKey];if(withFilters&&result.search){if(shouldLoadFilters){await this.load_filters({actionId:options.action_id,context,forceReload:false,modelName:model,});}
result.search.favoriteFilters=await this._cache.filters[filtersKey];}
return result;},load_filters:function(params){const key=this._gen_key(params.modelName,params.actionId);const forceReload=params.forceReload!==false&&config.isDebug('assets');if(forceReload||!this._cache.filters[key]){this._cache.filters[key]=rpc.query({args:[params.modelName,params.actionId],kwargs:{context:params.context||{},},model:'ir.filters',method:'get_filters',}).guardedCatch(()=>this._invalidate('filters',key));}
return this._cache.filters[key];},create_filter:function(filter){return rpc.query({args:[filter],model:'ir.filters',method:'create_or_replace',}).then(filterId=>{const filtersKey=this._gen_key(filter.model_id,filter.action_id);this._invalidate('filters',filtersKey);return filterId;});},delete_filter:function(filterId){return rpc.query({args:[filterId],model:'ir.filters',method:'unlink',}).then(()=>this._invalidate('filters'));},_gen_key:function(){return _.map(Array.prototype.slice.call(arguments),function(arg){if(!arg){return false;}
return _.isObject(arg)?JSON.stringify(arg):arg;}).join(',');},_invalidate(section,key){if(key){delete this._cache[section][key];}else{this._cache[section]={};}},});});odoo.define('web.data_manager',function(require){"use strict";var DataManager=require('web.DataManager');var data_manager=new DataManager();return data_manager;});;

/* /web/static/src/js/services/report_service.js defined in bundle 'web.assets_backend' */
odoo.define('web.ReportService',function(require){"use strict";var AbstractService=require('web.AbstractService');var core=require('web.core');var ReportService=AbstractService.extend({dependencies:['ajax'],checkWkhtmltopdf:function(){if(!this.wkhtmltopdfState){this.wkhtmltopdfState=this._rpc({route:'/report/check_wkhtmltopdf'});}
return this.wkhtmltopdfState;},});core.serviceRegistry.add('report',ReportService);return ReportService;});;

/* /web/static/src/js/services/session.js defined in bundle 'web.assets_backend' */
odoo.define('web.session',function(require){"use strict";var Session=require('web.Session');var modules=odoo._modules;var session=new Session(undefined,undefined,{modules:modules,use_cors:false});session.is_bound=session.session_bind();return session;});;

/* /web/static/src/js/widgets/change_password.js defined in bundle 'web.assets_backend' */
odoo.define('web.ChangePassword',function(require){"use strict";var AbstractAction=require('web.AbstractAction');var core=require('web.core');var Dialog=require('web.Dialog');var web_client=require('web.web_client');var _t=core._t;var ChangePassword=AbstractAction.extend({template:"ChangePassword",start:function(){var self=this;web_client.set_title(_t("Change Password"));var $button=self.$('.oe_form_button');$button.appendTo(this.getParent().$footer);$button.eq(1).click(function(){self.$el.parents('.modal').modal('hide');});$button.eq(0).click(function(){self._rpc({route:'/web/session/change_password',params:{fields:$('form[name=change_password_form]').serializeArray()}}).then(function(result){if(result.error){self._display_error(result);}else{self.do_action('logout');}});});},_display_error:function(error){return new Dialog(this,{size:'medium',title:error.title,$content:$('<div>').html(error.error)}).open();},});core.action_registry.add("change_password",ChangePassword);return ChangePassword;});;

/* /web/static/src/js/tools/test_menus_loader.js defined in bundle 'web.assets_backend' */
odoo.define('web.clickEverywhere',function(require){"use strict";var ajax=require('web.ajax');function startClickEverywhere(xmlId,appsMenusOnly){ajax.loadJS('web/static/src/js/tools/test_menus.js').then(function(){clickEverywhere(xmlId,appsMenusOnly);});}
return startClickEverywhere;});;

/* /web/static/src/js/tools/debug_manager_backend.js defined in bundle 'web.assets_backend' */
odoo.define('web.DebugManager.Backend',function(require){"use strict";var ActionManager=require('web.ActionManager');var DebugManager=require('web.DebugManager');var dialogs=require('web.view_dialogs');var startClickEverywhere=require('web.clickEverywhere');var config=require('web.config');var core=require('web.core');var Dialog=require('web.Dialog');var field_utils=require('web.field_utils');var SystrayMenu=require('web.SystrayMenu');var utils=require('web.utils');var WebClient=require('web.WebClient');var Widget=require('web.Widget');var QWeb=core.qweb;var _t=core._t;DebugManager.include({requests_clear:function(){if(!this._events){return;}
this._events=[];this.trigger('update-stats',this._events);},show_timelines:function(){if(this._overlay){this._overlay.destroy();this._overlay=null;return;}
this._overlay=new RequestsOverlay(this);this._overlay.appendTo(document.body);},update:function(tag,descriptor){return this._super().then(function(){this.$dropdown.find(".o_debug_split_assets").before(QWeb.render('WebClient.DebugManager.Backend',{manager:this,}));}.bind(this));},select_view:function(){var self=this;new dialogs.SelectCreateDialog(this,{res_model:'ir.ui.view',title:_t('Select a view'),disable_multiple_selection:true,domain:[['type','!=','qweb'],['type','!=','search']],on_selected:function(records){self._rpc({model:'ir.ui.view',method:'search_read',domain:[['id','=',records[0].id]],fields:['name','model','type'],limit:1,}).then(function(views){var view=views[0];view.type=view.type==='tree'?'list':view.type;self.do_action({type:'ir.actions.act_window',name:view.name,res_model:view.model,views:[[view.id,view.type]]});});}}).open();},perform_js_tests:function(){this.do_action({name:_t("JS Tests"),target:'new',type:'ir.actions.act_url',url:'/web/tests?mod=*'});},perform_js_mobile_tests:function(){this.do_action({name:_t("JS Mobile Tests"),target:'new',type:'ir.actions.act_url',url:'/web/tests/mobile?mod=*'});},perform_click_everywhere_test:function(){var $homeMenu=$("nav.o_main_navbar > a.o_menu_toggle.fa-th");$homeMenu.click();startClickEverywhere();},});DebugManager.include({async start(){const[_,canSeeRecordRules,canSeeModelAccess]=await Promise.all([this._super(...arguments),this._checkAccessRight('ir.rule','read'),this._checkAccessRight('ir.model.access','read'),])
this.canSeeRecordRules=canSeeRecordRules;this.canSeeModelAccess=canSeeModelAccess;},async getModelId(modelName){const[modelId]=await this._rpc({model:'ir.model',method:'search',args:[[['model','=',modelName]]],kwargs:{limit:1},});return modelId},update:function(tag,descriptor){if(tag==='action'){this._action=descriptor;}
return this._super().then(function(){this.$dropdown.find(".o_debug_leave_section").before(QWeb.render('WebClient.DebugManager.Action',{manager:this,action:this._action}));}.bind(this));},edit:function(params,evt){this.do_action({res_model:params.model,res_id:params.id,name:evt.target.text,type:'ir.actions.act_window',views:[[false,'form']],view_mode:'form',target:'new',flags:{action_buttons:true,headless:true}});},async get_view_fields(){const modelId=await this.getModelId(this._action.res_model);this.do_action({res_model:'ir.model.fields',name:_t('View Fields'),views:[[false,'list'],[false,'form']],domain:[['model_id','=',modelId]],type:'ir.actions.act_window',context:{'default_model_id':modelId}});},manage_filters:function(){this.do_action({res_model:'ir.filters',name:_t('Manage Filters'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',context:{search_default_my_filters:true,search_default_model_id:this._action.res_model}});},translate:function(){this._rpc({model:'ir.translation',method:'get_technical_translations',args:[this._action.res_model],}).then(this.do_action);},async actionRecordRules(){const modelId=await this.getModelId(this._action.res_model);this.do_action({res_model:'ir.rule',name:_t('Model Record Rules'),views:[[false,'list'],[false,'form']],domain:[['model_id','=',modelId]],type:'ir.actions.act_window',context:{'default_model_id':modelId,},});},async actionModelAccess(){const modelId=await this.getModelId(this._action.res_model);this.do_action({res_model:'ir.model.access',name:_t('Model Access'),views:[[false,'list'],[false,'form']],domain:[['model_id','=',modelId]],type:'ir.actions.act_window',context:{'default_model_id':modelId,},});},});DebugManager.include({start:function(){this._can_edit_views=false;return Promise.all([this._super(),this._checkAccessRight('ir.ui.view','write').then(function(ar){this._can_edit_views=ar;}.bind(this))]);},update:function(tag,descriptor,widget){if(tag==='action'||tag==='view'){this._controller=widget;}
return this._super(tag,descriptor).then(function(){this.$dropdown.find(".o_debug_leave_section").before(QWeb.render('WebClient.DebugManager.View',{action:this._action,can_edit:this._can_edit_views,controller:this._controller,withControlPanel:this._controller&&this._controller.withControlPanel,manager:this,view:this._controller&&_.findWhere(this._action.views,{type:this._controller.viewType,}),}));}.bind(this));},get_attachments:function(){var selectedIDs=this._controller.getSelectedIds();if(!selectedIDs.length){console.warn(_t("No attachment available"));return;}
this.do_action({res_model:'ir.attachment',name:_t('Manage Attachments'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['res_model','=',this._action.res_model],['res_id','=',selectedIDs[0]]],context:{default_res_model:this._action.res_model,default_res_id:selectedIDs[0],},});},get_metadata:function(){var self=this;var selectedIDs=this._controller.getSelectedIds();if(!selectedIDs.length){console.warn(_t("No metadata available"));return;}
this._rpc({model:this._action.res_model,method:'get_metadata',args:[selectedIDs],}).then(function(result){var metadata=result[0];metadata.creator=field_utils.format.many2one(metadata.create_uid);metadata.lastModifiedBy=field_utils.format.many2one(metadata.write_uid);var createDate=field_utils.parse.datetime(metadata.create_date);metadata.create_date=field_utils.format.datetime(createDate);var modificationDate=field_utils.parse.datetime(metadata.write_date);metadata.write_date=field_utils.format.datetime(modificationDate);var dialog=new Dialog(this,{title:_.str.sprintf(_t("Metadata (%s)"),self._action.res_model),size:'medium',$content:QWeb.render('WebClient.DebugViewLog',{perm:metadata,})});dialog.open().opened(function(){dialog.$el.on('click','a[data-action="toggle_noupdate"]',function(ev){ev.preventDefault();self._rpc({model:'ir.model.data',method:'toggle_noupdate',args:[self._action.res_model,metadata.id]}).then(function(res){dialog.close();self.get_metadata();})});})});},set_defaults:function(){var self=this;var display=function(fieldInfo,value){var displayed=value;if(value&&fieldInfo.type==='many2one'){displayed=value.data.display_name;value=value.data.id;}else if(value&&fieldInfo.type==='selection'){displayed=_.find(fieldInfo.selection,function(option){return option[0]===value;})[1];}
return[value,displayed];};var renderer=this._controller.renderer;var state=renderer.state;var fields=state.fields;var fieldsInfo=state.fieldsInfo.form;var fieldNamesInView=state.getFieldNames();var fieldNamesOnlyOnView=['message_attachment_count'];var fieldsValues=state.data;var modifierDatas={};_.each(fieldNamesInView,function(fieldName){modifierDatas[fieldName]=_.find(renderer.allModifiersData,function(modifierdata){return modifierdata.node.attrs.name===fieldName;});});this.fields=_.chain(fieldNamesInView).difference(fieldNamesOnlyOnView).map(function(fieldName){var modifierData=modifierDatas[fieldName];var invisibleOrReadOnly;if(modifierData){var evaluatedModifiers=modifierData.evaluatedModifiers[state.id];invisibleOrReadOnly=evaluatedModifiers.invisible||evaluatedModifiers.readonly;}
var fieldInfo=fields[fieldName];var valueDisplayed=display(fieldInfo,fieldsValues[fieldName]);var value=valueDisplayed[0];var displayed=valueDisplayed[1];if(!value||invisibleOrReadOnly||fieldInfo.type==='one2many'||fieldInfo.type==='many2many'||fieldInfo.type==='binary'||fieldsInfo[fieldName].options.isPassword||!_.isEmpty(fieldInfo.depends)){return false;}
return{name:fieldName,string:fieldInfo.string,value:value,displayed:displayed,};}).compact().sortBy(function(field){return field.string;}).value();var conditions=_.chain(fieldNamesInView).filter(function(fieldName){var fieldInfo=fields[fieldName];return fieldInfo.change_default;}).map(function(fieldName){var fieldInfo=fields[fieldName];var valueDisplayed=display(fieldInfo,fieldsValues[fieldName]);var value=valueDisplayed[0];var displayed=valueDisplayed[1];return{name:fieldName,string:fieldInfo.string,value:value,displayed:displayed,};}).value();var d=new Dialog(this,{title:_t("Set Default"),buttons:[{text:_t("Close"),close:true},{text:_t("Save default"),click:function(){var $defaults=d.$el.find('#formview_default_fields');var fieldToSet=$defaults.val();if(!fieldToSet){$defaults.parent().addClass('o_form_invalid');return;}
var selfUser=d.$el.find('#formview_default_self').is(':checked');var condition=d.$el.find('#formview_default_conditions').val();var value=_.find(self.fields,function(field){return field.name===fieldToSet;}).value;self._rpc({model:'ir.default',method:'set',args:[self._action.res_model,fieldToSet,value,selfUser,true,condition||false,],}).then(function(){d.close();});}}]});d.args={fields:this.fields,conditions:conditions,};d.template='FormView.set_default';d.open();},fvg:function(){var self=this;var dialog=new Dialog(this,{title:_t("Fields View Get")});dialog.opened().then(function(){const arch=self._controller.renderer.arch||self._controller.renderer.props.arch;$('<pre>').text(utils.json_node_to_xml(arch,true)).appendTo(dialog.$el);});dialog.open();},});function make_context(width,height,fn){var canvas=document.createElement('canvas');canvas.width=width;canvas.height=height;canvas.style.position='relative';var ctx=canvas.getContext('2d');ctx.imageSmoothingEnabled=false;ctx.mozImageSmoothingEnabled=false;ctx.oImageSmoothingEnabled=false;ctx.webkitImageSmoothingEnabled=false;fn&&fn(ctx);return ctx;}
var RequestsOverlay=Widget.extend({template:'WebClient.DebugManager.RequestsOverlay',TRACKS:8,TRACK_WIDTH:9,events:{mousemove:function(e){this.$tooltip.hide();}},init:function(){this._super.apply(this,arguments);this._render=_.throttle(this._render.bind(this),1000/15,{leading:false});},start:function(){var _super=this._super();this.$tooltip=this.$('div.o_debug_tooltip');this.getParent().on('update-stats',this,this._render);this._render();return _super;},tooltip:function(text,start,end,x,y){var top=y-this.el.offsetTop+this.el.scrollTop+1;var left=x-this.el.offsetLeft+this.el.scrollLeft+1;this.$tooltip.css({top:top,left:left}).show()[0].innerHTML=['<p>',text,' (',(end-start),'ms)','</p>'].join('');},_render:function(){var $summary=this.$('header'),w=$summary[0].clientWidth,$requests=this.$('.o_debug_requests');$summary.find('canvas').attr('width',w);var tracks=document.getElementById('o_debug_requests_summary');_.invoke(this.getChildren(),'destroy');var requests=this.getParent()._events;var bounds=this._get_bounds(requests);var scale=w/(bounds.high-bounds.low);var track_ends=_(this.TRACKS).times(_.constant(-Infinity));var ctx=tracks.getContext('2d');ctx.lineWidth=this.TRACK_WIDTH;for(var i=0;i<requests.length;i++){var request=requests[i];var rstart=Math.floor(request[0][3]*1e3);var rend=Math.ceil(request[request.length-1][3]*1e3);for(var track=0;track<track_ends.length;++track){if(track_ends[track]<rstart){break;}}
if(track>=track_ends.length){console.warn("could not find an empty summary track");continue;}
track_ends[track]=rend;ctx.save();ctx.translate(Math.floor((rstart-bounds.low)*scale),track*(this.TRACK_WIDTH+1));this._draw_request(request,ctx,0,scale);ctx.restore();new RequestDetails(this,request,scale).appendTo($requests);}},_draw_request:function(request,to_context,step,hscale,handle_event){var surfaces={request:make_context(to_context.canvas.width,to_context.canvas.height,function(ctx){ctx.strokeStyle='blue';ctx.fillStyle='#88f';ctx.lineJoin='round';ctx.lineWidth=1;}),sql:make_context(to_context.canvas.width,to_context.canvas.height,function(ctx){ctx.strokeStyle='red';ctx.fillStyle='#f88';ctx.lineJoin='round';ctx.lineWidth=1;}),template:make_context(to_context.canvas.width,to_context.canvas.height,function(ctx){ctx.strokeStyle='green';ctx.fillStyle='#8f8';ctx.lineJoin='round';ctx.lineWidth=1;})};var stacks={},start=Math.floor(request[0][3]*1e3*hscale);var event_idx=0;var rect_width=to_context.lineWidth;for(var i=0;i<request.length;i++){var type,m,event=request[i];var tag=event[0],timestamp=Math.floor(event[3]*1e3*hscale)-start;if(m=/(\w+)-start/.exec(tag)){type=m[1];if(!(type in stacks)){stacks[type]=[];}
handle_event&&handle_event(event_idx,timestamp,event);stacks[type].push({timestamp:timestamp,idx:event_idx++});}else if(m=/(\w+)-end/.exec(tag)){type=m[1];var stack=stacks[type];var estart=stack.pop(),duration=Math.ceil(timestamp-estart.timestamp);handle_event&&handle_event(estart.idx,timestamp,event);var surface=surfaces[type];if(!surface){continue;}
var y=step*estart.idx;surface.rect(estart.timestamp+0.5,y+0.5,duration||1,rect_width);}}
var keys=['request','template','sql'];for(var j=0;j<keys.length;++j){var ctx=surfaces[keys[j]];ctx.fill();ctx.stroke();to_context.drawImage(ctx.canvas,0,0);}},_get_bounds:function(requests){var low=+Infinity;var high=-+Infinity;for(var i=0;i<requests.length;i++){var request=requests[i];for(var j=0;j<request.length;j++){var event=request[j];var timestamp=event[3];low=Math.min(low,timestamp);high=Math.max(high,timestamp);}}
return{low:Math.floor(low*1e3),high:Math.ceil(high*1e3)};}});var RequestDetails=Widget.extend({events:{click:function(){this._open=!this._open;this.render();},'mousemove canvas':function(e){e.stopPropagation();var y=e.y||e.offsetY||e.layerY;if(!y){return;}
var event=this._payloads[Math.floor(y/this._REQ_HEIGHT)];if(!event){return;}
this.getParent().tooltip(event.payload,event.start,event.stop,e.clientX,e.clientY);}},init:function(parent,request,scale){this._super.apply(this,arguments);this._request=request;this._open=false;this._scale=scale;this._REQ_HEIGHT=20;},start:function(){this.el.style.borderBottom='1px solid black';this.render();return this._super();},render:function(){var request_cell_height=this._REQ_HEIGHT,TITLE_WIDTH=200;var request=this._request;var req_start=request[0][3]*1e3;var req_duration=request[request.length-1][3]*1e3-req_start;var height=request_cell_height*(this._open?request.length/2:1);var cell_center=request_cell_height/2;var ctx=make_context(210+Math.ceil(req_duration*this._scale),height,function(ctx){ctx.lineWidth=cell_center;});this.$el.empty().append(ctx.canvas);var payloads=this._payloads=[];var text_ctx=make_context(TITLE_WIDTH,height,function(ctx){ctx.font='12px sans-serif';ctx.textAlign='right';ctx.textBaseline='middle';ctx.translate(0,cell_center);});ctx.save();ctx.translate(TITLE_WIDTH+10,((request_cell_height/4)|0));this.getParent()._draw_request(request,ctx,this._open?request_cell_height:0,this._scale,function(idx,timestamp,event){if(/-start$/g.test(event[0])){payloads.push({payload:event[2],start:timestamp,stop:null});var title=event[2];title=title.replace(/\s+$/,'');title=title.length<=50?title:(''+title.slice(-49));while(text_ctx.measureText(title).width>200){title=''+title.slice(2);}
text_ctx.fillText(title,TITLE_WIDTH,request_cell_height*idx);}else if(/-end$/g.test(event[0])){payloads[idx].stop=timestamp;}});ctx.restore();ctx.drawImage(text_ctx.canvas,0,0);}});if(config.isDebug()){SystrayMenu.Items.push(DebugManager);WebClient.include({current_action_updated:function(action,controller){this._super.apply(this,arguments);this.update_debug_manager(action,controller);},update_debug_manager:function(action,controller){var debugManager=_.find(this.menu.systray_menu.widgets,function(item){return item instanceof DebugManager;});debugManager.update('action',action,controller&&controller.widget);}});ActionManager.include({getCurrentActionInDialog:function(){if(this.currentDialogController){return this.actions[this.currentDialogController.actionID];}
return null;},getCurrentControllerInDialog:function(){return this.currentDialogController;},});Dialog.include({open:function(){var self=this;this.opened(function(){setTimeout(function(){var parent=self.getParent();if(parent instanceof ActionManager){var action=parent.getCurrentActionInDialog();if(action){var controller=parent.getCurrentControllerInDialog();self.debugManager=new DebugManager(self);var $header=self.$modal.find('.modal-header:first');return self.debugManager.prependTo($header).then(function(){self.debugManager.update('action',action,controller.widget);});}}},0);});return this._super.apply(this,arguments);},});}
return DebugManager;});;

/* /web/static/src/js/tools/tools.js defined in bundle 'web.assets_backend' */
odoo.define('web.tools',function(require){"use strict";function deprecated(fn,message){return function(){console.warn(message||(fn.name+' is deprecated.'));return fn.apply(this,arguments);};}
return{deprecated:deprecated,};});;

/* /web/static/src/js/env.js defined in bundle 'web.assets_backend' */
odoo.define("web.env",function(require){"use strict";const commonEnv=require('web.commonEnv');const dataManager=require('web.data_manager');const{blockUI,unblockUI}=require("web.framework");const env=Object.assign(commonEnv,{dataManager});env.services=Object.assign(env.services,{blockUI,unblockUI});return env;});;

/* /web/static/src/js/widgets/data_export.js defined in bundle 'web.assets_backend' */
odoo.define('web.DataExport',function(require){"use strict";var config=require('web.config');var core=require('web.core');var Dialog=require('web.Dialog');var data=require('web.data');var framework=require('web.framework');var pyUtils=require('web.py_utils');var QWeb=core.qweb;var _t=core._t;var DataExport=Dialog.extend({template:'ExportDialog',events:{'change .o_exported_lists_select':'_onChangeExportList','change .o_import_compat input':'_onChangeCompatibleInput','click .o_add_field':'_onClickAddField','click .o_delete_exported_list':'_onClickDeleteExportListBtn','click .o_expand':'_onClickExpand','click .o_remove_field':'_onClickRemoveField','click .o_save_list .o_save_list_btn':'_onClickSaveListBtn','click .o_save_list .o_cancel_list_btn':'_resetTemplateField','click .o_export_tree_item':'_onClickTreeItem','dblclick .o_export_tree_item:not(.haschild)':'_onDblclickTreeItem','keydown .o_export_tree_item':'_onKeydownTreeItem','keydown .o_save_list_name':'_onKeydownSaveList','input .o_export_search_input':'_onSearchInput',},init:function(parent,record,defaultExportFields,groupedBy,activeDomain,idsToExport){var options={title:_t("Export Data"),buttons:[{text:_t("Export"),click:this._onExportData,classes:'btn-primary'},{text:_t("Close"),close:true},],};this._super(parent,options);this.records={};this.record=record;this.defaultExportFields=defaultExportFields;this.groupby=groupedBy;this.exports=new data.DataSetSearch(this,'ir.exports',this.record.getContext());this.rowIndex=0;this.rowIndexLevel=0;this.isCompatibleMode=false;this.domain=activeDomain||this.record.domain;this.idsToExport=activeDomain?false:idsToExport;},start:function(){var self=this;var proms=[this._super.apply(this,arguments)];this.$modal.find('.modal-content').css('height','100%');this.$fieldsList=this.$('.o_fields_list');proms.push(this._rpc({route:'/web/export/formats'}).then(doSetupExportFormats));proms.push(this._onChangeCompatibleInput().then(function(){_.each(self.defaultExportFields,function(field){var record=self.records[field];self._addField(record.id,record.string);});}));proms.push(this._showExportsList());this.opened().then(function(){self.$('.o_fields_list').sortable({axis:'y',handle:'.o_short_field',forcePlaceholderSize:true,placeholder:'o-field-placeholder',update:self.proxy('_resetTemplateField'),});});return Promise.all(proms);function doSetupExportFormats(formats){var $fmts=self.$('.o_export_format');_.each(formats,function(format){var $radio=$('<input/>',{type:'radio',value:format.tag,name:'o_export_format_name',class:'form-check-input',id:'o_radio'+format.label});var $label=$('<label/>',{html:format.label,class:'form-check-label',for:'o_radio'+format.label});if(format.error){$radio.prop('disabled',true);$label.html(_.str.sprintf("%s  %s",format.label,format.error));}
$fmts.append($("<div class='radio form-check form-check-inline pl-4'></div>").append($radio,$label));});self.$exportFormatInputs=$fmts.find('input');self.$exportFormatInputs.filter(':enabled').first().prop('checked',true);}},export(){let exportedFields=this.defaultExportFields.map(field=>({name:field,label:this.record.fields[field].string,store:this.record.fields[field].store,type:this.record.fields[field].type,}));this._exportData(exportedFields,'xlsx',false);},_addField:function(fieldID,label){var $fieldList=this.$('.o_fields_list');if(!$fieldList.find(".o_export_field[data-field_id='"+fieldID+"']").length){$fieldList.append($('<li>',{'class':'o_export_field','data-field_id':fieldID}).append($('<span>',{'class':"fa fa-arrows o_short_field mx-1"}),label.trim(),$('<span>',{'class':'fa fa-trash m-1 pull-right o_remove_field','title':_t("Remove field")})));}},_exportData(exportedFields,exportFormat,idsToExport){if(_.isEmpty(exportedFields)){Dialog.alert(this,_t("Please select fields to export..."));return;}
if(this.isCompatibleMode){exportedFields.unshift({name:'id',label:_t('External ID')});}
framework.blockUI();this.getSession().get_file({url:'/web/export/'+exportFormat,data:{data:JSON.stringify({model:this.record.model,fields:exportedFields,ids:idsToExport,domain:this.domain,groupby:this.groupby,context:pyUtils.eval('contexts',[this.record.getContext()]),import_compat:this.isCompatibleMode,})},complete:framework.unblockUI,error:(error)=>this.call('crash_manager','rpc_error',error),});},_getFields:function(){var exportFields=this.$('.o_export_field').map(function(){return $(this).data('field_id');}).get();if(exportFields.length===0){Dialog.alert(this,_t("Please select fields to save export list..."));}
return exportFields;},_onExpandAction:function(record){var self=this;if(!record.children){return;}
var model=record.params.model;var prefix=record.params.prefix;var name=record.params.name;var excludeFields=[];if(record.relation_field){excludeFields.push(record.relation_field);}
if(!record.loaded){this._rpc({route:'/web/export/get_fields',params:{model:model,prefix:prefix,parent_name:name,import_compat:this.isCompatibleMode,parent_field_type:record.field_type,parent_field:record.params.parent_field,exclude:excludeFields,},}).then(function(results){record.loaded=true;self._onShowData(results,record.id);});}else{this._showContent(record.id);}},_onShowData:function(records,expansion){var self=this;if(expansion){this.$('.o_export_tree_item[data-id="'+expansion+'"]').addClass('show').find('.o_expand_parent').toggleClass('fa-chevron-right fa-chevron-down').next().after(QWeb.render('Export.TreeItems',{fields:records,debug:config.isDebug()}));}else{this.$('.o_left_field_panel').empty().append($('<div/>').addClass('o_field_tree_structure').append(QWeb.render('Export.TreeItems',{fields:records,debug:config.isDebug()})));}
_.extend(this.records,_.object(_.pluck(records,'id'),records));this.$records=this.$('.o_export_tree_item');this.$records.each(function(i,el){var $el=$(el);$el.find('.o_tree_column').first().toggleClass('o_required',!!self.records[$el.data('id')].required);});},_addNewTemplate:function(){this.$('.o_exported_lists').addClass('d-none');this.$(".o_save_list").show().find(".o_save_list_name").val("").focus();},_resetTemplateField:function(){this.$('.o_exported_lists_select').val("");this.$('.o_delete_exported_list').addClass('d-none');this.$('.o_exported_lists').removeClass('d-none');this.$(".o_save_list").hide().find(".o_save_list_name").val("");},_showContent:function(fieldID){var $item=this.$('.o_export_tree_item[data-id="'+fieldID+'"]');$item.toggleClass('show');var isOpen=$item.hasClass('show');$item.children('.o_expand_parent').toggleClass('fa-chevron-down',!!isOpen).toggleClass('fa-chevron-right',!isOpen);var $childField=$item.find('.o_export_tree_item');var childLength=(fieldID.split('/')).length+1;for(var i=0;i<$childField.length;i++){var $child=$childField.eq(i);if(!isOpen){$child.hide();}else if(childLength===$childField.eq(i).data('id').split('/').length){if($child.hasClass('show')){$child.removeClass('show');$child.children('.o_expand_parent').removeClass('fa-chevron-down').addClass('fa-chevron-right');}
$child.show();}}},_showExportsList:function(){var self=this;if(this.$('.o_exported_lists_select').is(':hidden')){this.$('.o_exported_lists').show();return Promise.resolve();}
return this._rpc({model:'ir.exports',method:'search_read',fields:['name'],domain:[['resource','=',this.record.model]]}).then(function(exportList){self.$('.o_exported_lists').append(QWeb.render('Export.SavedList',{existing_exports:exportList,}));});},_onChangeExportList:function(){var self=this;var exportID=this.$('.o_exported_lists_select option:selected').val();this.$('.o_delete_exported_list').toggleClass('d-none',!exportID);if(exportID&&exportID!=='new_template'){this.$('.o_fields_list').empty();this._rpc({route:'/web/export/namelist',params:{model:this.record.model,export_id:parseInt(exportID,10),},}).then(function(fieldList){_.each(fieldList,function(field){self._addField(field.name,field.label);});});}else if(exportID==='new_template'){self._addNewTemplate();}},_onChangeCompatibleInput:function(){var self=this;this.isCompatibleMode=this.$('.o_import_compat input').is(':checked');this.$('.o_field_tree_structure').remove();this._resetTemplateField();return this._rpc({route:'/web/export/get_fields',params:{model:this.record.model,import_compat:this.isCompatibleMode,},}).then(function(records){var compatibleFields=_.map(records,function(record){return record.id;});self._onShowData(records);self.$('.o_fields_list').empty();_.chain(self.$fieldsList.find('.o_export_field')).map(function(field){return $(field).data('field_id');}).union(self.defaultExportFields).intersection(compatibleFields).each(function(field){var record=_.find(records,function(rec){return rec.id===field;});self._addField(record.id,record.string);});self.$('#o-export-search-filter').val('');});},_onClickAddField:function(ev){ev.stopPropagation();var $field=$(ev.currentTarget);this._resetTemplateField();this._addField($field.closest('.o_export_tree_item').data('id'),$field.closest('.o_tree_column').text());},_onClickDeleteExportListBtn:function(){var self=this;var selectExp=this.$('.o_exported_lists_select option:selected');var options={confirm_callback:function(){if(selectExp.val()){self.exports.unlink([parseInt(selectExp.val(),10)]);selectExp.remove();if(self.$('.o_exported_lists_select option').length<=1){self.$('.o_exported_lists').hide();}}}};Dialog.confirm(this,_t("Do you really want to delete this export template?"),options);},_onClickExpand:function(ev){this._onExpandAction(this.records[$(ev.target).closest('.o_export_tree_item').data('id')]);},_onClickRemoveField:function(ev){$(ev.currentTarget).closest('.o_export_field').remove();this._resetTemplateField();},_onClickSaveListBtn:function(){var self=this;var $saveList=this.$('.o_save_list');var value=$saveList.find('input').val();if(!value){Dialog.alert(this,_t("Please enter save field list name"));return;}
var fields=this._getFields();if(fields.length===0){return;}
$saveList.hide();this.exports.create({name:value,resource:this.record.model,export_fields:_.map(fields,function(field){return[0,0,{name:field}];}),}).then(function(exportListID){if(!exportListID){return;}
var $select=self.$('.o_exported_lists_select');if($select.length===0||$select.is(':hidden')){self._showExportsList();}
$select.append(new Option(value,exportListID));self.$('.o_exported_lists').removeClass('d-none');$select.val(exportListID);});},_onClickTreeItem:function(ev){ev.stopPropagation();var $elem=$(ev.currentTarget);var rowIndex=$elem.prevAll('.o_export_tree_item').length;var rowIndexLevel=$elem.parents('.o_export_tree_item').length;if(ev.shiftKey&&rowIndexLevel===this.rowIndexLevel){var minIndex=Math.min(rowIndex,this.rowIndex);var maxIndex=Math.max(rowIndex,this.rowIndex);this.$records.filter(function(){return($elem.parent()[0]===$(this).parent()[0]);}).slice(minIndex,maxIndex+1).addClass('o_selected').filter(':not(:last)').each(processChildren);}
this.rowIndex=rowIndex;this.rowIndexLevel=rowIndexLevel;if(ev.ctrlKey){$elem.toggleClass('o_selected').focus();}else if(ev.shiftKey){$elem.addClass('o_selected').focus();}else{this.$('.o_selected').removeClass('o_selected');$elem.addClass('o_selected').focus();}
function processChildren(){var $child=$(this);if($child.hasClass('show')){$child.children('.o_export_tree_item').addClass('o_selected').each(processChildren);}}},_onExportData(){let exportedFields=this.$('.o_export_field').map((i,field)=>({name:$(field).data('field_id'),label:field.textContent,})).get();let exportFormat=this.$exportFormatInputs.filter(':checked').val();this._exportData(exportedFields,exportFormat,this.idsToExport);},_onDblclickTreeItem:function(ev){var self=this;this._resetTemplateField();function addElement(el){self._addField(el.getAttribute('data-id'),el.querySelector('.o_tree_column').textContent);}
var target=ev.currentTarget;target.classList.remove('o_selected');[].reverse.call($(target).parents('.o_export_tree_item')).each(function(){addElement(this);});addElement(target);},_onKeydownSaveList:function(ev){if(ev.keyCode===$.ui.keyCode.ENTER){this._onClickSaveListBtn();}},_onKeydownTreeItem:function(ev){ev.stopPropagation();var $el=$(ev.currentTarget);var record=this.records[$el.data('id')];switch(ev.keyCode||ev.which){case $.ui.keyCode.LEFT:if($el.hasClass('show')){this._onExpandAction(record);}
break;case $.ui.keyCode.RIGHT:if(!$el.hasClass('show')){this._onExpandAction(record);}
break;case $.ui.keyCode.UP:var $prev=$el.prev('.o_export_tree_item');if($prev.length===1){while($prev.hasClass('show')){$prev=$prev.children('.o_export_tree_item').last();}}else{$prev=$el.parent('.o_export_tree_item');if($prev.length===0){break;}}
$el.removeClass('o_selected').blur();$prev.addClass("o_selected").focus();break;case $.ui.keyCode.DOWN:var $next;if($el.hasClass('show')){$next=$el.children('.o_export_tree_item').first();}else{$next=$el.next('.o_export_tree_item');if($next.length===0){$next=$el.parent('.o_export_tree_item').next('.o_export_tree_item');if($next.length===0){break;}}}
$el.removeClass('o_selected').blur();$next.addClass('o_selected').focus();break;}},_onSearchInput:function(ev){var searchText=$(ev.currentTarget).val().trim().toUpperCase();if(!searchText){this.$('.o_no_match').remove();this.$(".o_export_tree_item").show();this.$(".o_export_tree_item.haschild:not(.show) .o_export_tree_item").hide();return;}
var matchItems=this.$(".o_tree_column").filter(function(){var title=this.getAttribute('title');return this.innerText.toUpperCase().indexOf(searchText)>=0||title&&title.toUpperCase().indexOf(searchText)>=0;}).parent();this.$(".o_export_tree_item").hide();if(matchItems.length){this.$('.o_no_match').remove();_.each(matchItems,function(col){var $col=$(col);$col.show();$col.parents('.haschild.show').show();if(!$col.parent().hasClass('show')&&!$col.parent().hasClass('o_field_tree_structure')){$col.hide();}});}else if(!this.$('.o_no_match').length){this.$(".o_field_tree_structure").append($("<h3/>",{class:'text-center text-muted mt-5 o_no_match',text:_t("No match found.")}));}},});return DataExport;});;

/* /web/static/src/js/widgets/date_picker.js defined in bundle 'web.assets_backend' */
odoo.define('web.datepicker',function(require){"use strict";var core=require('web.core');var field_utils=require('web.field_utils');var time=require('web.time');var Widget=require('web.Widget');var _t=core._t;var DateWidget=Widget.extend({template:"web.datepicker",type_of_date:"date",events:{'error.datetimepicker':'errorDatetime','change .o_datepicker_input':'changeDatetime','click input':'_onInputClicked','input input':'_onInput','keydown':'_onKeydown','show.datetimepicker':'_onDateTimePickerShow','hide.datetimepicker':'_onDateTimePickerHide',},init:function(parent,options){this._super.apply(this,arguments);this.name=parent.name;this.options=_.extend({locale:moment.locale(),format:this.type_of_date==='datetime'?time.getLangDatetimeFormat():time.getLangDateFormat(),minDate:moment({y:1000}),maxDate:moment({y:9999,M:11,d:31}),useCurrent:false,icons:{time:'fa fa-clock-o',date:'fa fa-calendar',up:'fa fa-chevron-up',down:'fa fa-chevron-down',previous:'fa fa-chevron-left',next:'fa fa-chevron-right',today:'fa fa-calendar-check-o',clear:'fa fa-trash',close:'fa fa-check primary',},calendarWeeks:true,buttons:{showToday:false,showClear:false,showClose:false,},widgetParent:'body',keyBinds:null,},options||{});this.__libInput=0;this.__isOpen=false;},start:function(){this.$input=this.$('input.o_datepicker_input');this.__libInput++;this.$el.datetimepicker(this.options);this.__libInput--;this._setReadonly(false);},destroy:function(){if(this._onScroll){window.removeEventListener('wheel',this._onScroll,true);}
this.__libInput++;this.$el.datetimepicker('destroy');this.__libInput--;this._super.apply(this,arguments);},changeDatetime:function(){if(this.__libInput>0){if(this.options.warn_future){this._warnFuture(this.getValue());}
this.trigger("datetime_changed");return;}
var oldValue=this.getValue();if(this.isValid()){this._setValueFromUi();var newValue=this.getValue();var hasChanged=!oldValue!==!newValue;if(oldValue&&newValue){var formattedOldValue=oldValue.format(time.getLangDatetimeFormat());var formattedNewValue=newValue.format(time.getLangDatetimeFormat());if(formattedNewValue!==formattedOldValue){hasChanged=true;}}
if(hasChanged){if(this.options.warn_future){this._warnFuture(newValue);}
this.trigger("datetime_changed");}}else{var formattedValue=oldValue?this._formatClient(oldValue):null;this.$input.val(formattedValue);}},errorDatetime:function(e){return false;},focus:function(){this.__libInput++;this.$input.focus();this.__libInput--;},getValue:function(){var value=this.get('value');return value&&value.clone();},isValid:function(){var value=this.$input.val();if(value===""){return true;}else{try{this._parseClient(value);return true;}catch(e){return false;}}},maxDate:function(date){this.__libInput++;this.$el.datetimepicker('maxDate',date||null);this.__libInput--;},minDate:function(date){this.__libInput++;this.$el.datetimepicker('minDate',date||null);this.__libInput--;},setValue:function(value){this.set({'value':value});var formatted_value=value?this._formatClient(value):null;this.$input.val(formatted_value);this._setLibInputValue(value);},_warnFuture:function(currentDate){if(!this.$warning){this.$warning=$('<span>',{class:'fa fa-exclamation-triangle o_tz_warning o_datepicker_warning',});var title=_t("This date is in the future. Make sure this is what you expect.");this.$warning.attr('title',title);this.$input.after(this.$warning);}
if(currentDate&&currentDate.format('YYYY-MM-DD')>moment().format('YYYY-MM-DD')){this.$warning.show();}else{this.$warning.hide();}},_formatClient:function(v){return field_utils.format[this.type_of_date](v,null,{timezone:false});},_parseClient:function(v){return field_utils.parse[this.type_of_date](v,null,{timezone:false});},_setLibInputValue:function(value){this.__libInput++;this.$el.datetimepicker('date',value||null);this.__libInput--;},_setReadonly:function(readonly){this.readonly=readonly;this.$input.prop('readonly',this.readonly);},_setValueFromUi:function(){var value=this.$input.val()||false;this.setValue(this._parseClient(value));},_onDateTimePickerHide:function(){this.__isOpen=false;this.changeDatetime();if(this._onScroll){window.removeEventListener('wheel',this._onScroll,true);}
this.changeDatetime();},_onDateTimePickerShow:function(){this.__isOpen=true;if(this.$input.val().length!==0&&this.isValid()){this.$input.select();}
var self=this;this._onScroll=function(ev){if(ev.target!==self.$input.get(0)){self.__libInput++;self.$el.datetimepicker('hide');self.__libInput--;}};window.addEventListener('wheel',this._onScroll,true);},_onKeydown:function(ev){if(ev.which===$.ui.keyCode.ESCAPE){if(this.__isOpen){ev.stopImmediatePropagation();this.__libInput++;this.$el.datetimepicker('hide');this.__libInput--;this.focus();}}},_onInput:function(ev){if(this.__libInput>0){ev.stopImmediatePropagation();}},_onInputClicked:function(){this.__libInput++;this.$el.datetimepicker('toggle');this.__libInput--;this.focus();},});var DateTimeWidget=DateWidget.extend({type_of_date:"datetime",init:function(parent,options){this._super(parent,_.extend({buttons:{showToday:false,showClear:false,showClose:true,},},options||{}));},});return{DateWidget:DateWidget,DateTimeWidget:DateTimeWidget,};});;

/* /web/static/src/js/widgets/domain_selector_dialog.js defined in bundle 'web.assets_backend' */
odoo.define("web.DomainSelectorDialog",function(require){"use strict";var core=require("web.core");var Dialog=require("web.Dialog");var DomainSelector=require("web.DomainSelector");var _t=core._t;return Dialog.extend({init:function(parent,model,domain,options){this.model=model;this.options=_.extend({readonly:true,debugMode:false,},options||{});var buttons;if(this.options.readonly){buttons=[{text:_t("Close"),close:true},];}else{buttons=[{text:_t("Save"),classes:"btn-primary",close:true,click:function(){this.trigger_up("domain_selected",{domain:this.domainSelector.getDomain()});}},{text:_t("Discard"),close:true},];}
this._super(parent,_.extend({},{title:_t("Domain"),buttons:buttons,},options||{}));this.domainSelector=new DomainSelector(this,model,domain,options);},start:function(){var self=this;this.opened().then(function(){self.$el.css('overflow','visible').closest('.modal-dialog').css('height','auto');});return Promise.all([this._super.apply(this,arguments),this.domainSelector.appendTo(this.$el)]);},});});;

/* /web/static/src/js/widgets/domain_selector.js defined in bundle 'web.assets_backend' */
odoo.define("web.DomainSelector",function(require){"use strict";var core=require("web.core");var datepicker=require("web.datepicker");var Domain=require("web.Domain");var field_utils=require("web.field_utils");var ModelFieldSelector=require("web.ModelFieldSelector");var Widget=require("web.Widget");var _t=core._t;var _lt=core._lt;var operator_mapping={"=":"=","!=":_lt("is not ="),">":">","<":"<",">=":">=","<=":"<=","ilike":_lt("contains"),"not ilike":_lt("does not contain"),"in":_lt("in"),"not in":_lt("not in"),"child_of":_lt("child of"),"parent_of":_lt("parent of"),"like":"like","not like":"not like","=like":"=like","=ilike":"=ilike","set":_lt("is set"),"not set":_lt("is not set"),};var DomainNode=Widget.extend({events:{"click .o_domain_add_node_button":"_onAddButtonClick","click .o_domain_delete_node_button":"_onDeleteButtonClick","mouseenter button":"_onButtonEntered","mouseleave button":"_onButtonLeft",},init:function(parent,model,domain,options){this._super.apply(this,arguments);this.model=model;this.options=_.extend({readonly:true,operators:null,debugMode:false,},options||{});this.readonly=this.options.readonly;this.debug=this.options.debugMode;},isValid:function(){},getDomain:function(){},_onAddButtonClick:function(e){e.preventDefault();e.stopPropagation();this.trigger_up("add_node_clicked",{newBranch:!!$(e.currentTarget).data("branch"),child:this});},_onDeleteButtonClick:function(e){e.preventDefault();e.stopPropagation();this.trigger_up("delete_node_clicked",{child:this});},_onButtonEntered:function(e){e.preventDefault();e.stopPropagation();var $target=$(e.currentTarget);this.$el.toggleClass("o_hover_btns",$target.hasClass("o_domain_delete_node_button"));this.$el.toggleClass("o_hover_add_node",$target.hasClass("o_domain_add_node_button"));this.$el.toggleClass("o_hover_add_inset_node",!!$target.data("branch"));},_onButtonLeft:function(e){e.preventDefault();e.stopPropagation();this.$el.removeClass("o_hover_btns o_hover_add_node o_hover_add_inset_node");},});var DomainTree=DomainNode.extend({template:"DomainTree",events:_.extend({},DomainNode.prototype.events,{"click .o_domain_tree_operator_selector .dropdown-item":"_onOperatorChange",}),custom_events:{"add_node_clicked":"_onNodeAdditionAsk","delete_node_clicked":"_onNodeDeletionAsk",},init:function(parent,model,domain){this._super.apply(this,arguments);var parsedDomain=this._parseDomain(domain);if(parsedDomain){this._initialize(parsedDomain);}},start:function(){this._postRender();return Promise.all([this._super.apply(this,arguments),this._renderChildrenTo(this.$childrenContainer)]);},isValid:function(){for(var i=0;i<this.children.length;i++){var cValid=this.children[i].isValid();if(!cValid){return cValid;}}
return this._isValid;},getDomain:function(){var childDomains=[];var nbChildren=0;_.each(this.children,function(child){var childDomain=child.getDomain();if(childDomain.length){nbChildren++;childDomains=childDomains.concat(child.getDomain());}});var nbChildRequired=this.operator==="!"?1:2;var operators=_.times(nbChildren-nbChildRequired+1,_.constant(this.operator));return operators.concat(childDomains);},_addChild:function(domain,afterNode){var i=afterNode?_.indexOf(this.children,afterNode):this.children.length;if(i<0)return false;this.children.splice(i+1,0,instantiateNode(this,this.model,domain,this.options));this.trigger_up("domain_changed",{child:this});return true;},_addFlattenedChildren:function(domain){var node=instantiateNode(this,this.model,domain,this.options);if(node===null){return;}
if(!node.children||node.operator!==this.operator){this.children.push(node);return;}
_.each(node.children,(function(child){child.setParent(this);this.children.push(child);}).bind(this));node.destroy();},_changeOperator:function(operator,silent){this.operator=operator;if(!silent)this.trigger_up("domain_changed",{child:this});},_initialize:function(domain){this._isValid=true;this.operator=domain[0];this.children=[];if(domain.length<=1){return;}
var nbLeafsToFind=1;for(var i=1;i<domain.length;i++){if(domain[i]==="&"||domain[i]==="|"){nbLeafsToFind++;}else if(domain[i]!=="!"){nbLeafsToFind--;}
if(!nbLeafsToFind){var partLeft=domain.slice(1,i+1);var partRight=domain.slice(i+1);if(partLeft.length){this._addFlattenedChildren(partLeft);}
if(partRight.length){this._addFlattenedChildren(partRight);}
break;}}
this._isValid=(nbLeafsToFind===0);if(this.operator==="!"){this.children[0].noControlPanel=true;}},_postRender:function(){this.$childrenContainer=this.$("> .o_domain_node_children_container");},_removeChild:function(oldChild){var i=_.indexOf(this.children,oldChild);if(i<0)return false;this.children[i].destroy();this.children.splice(i,1);this.trigger_up("domain_changed",{child:this});return true;},_renderChildrenTo:function($to){var $div=$("<div/>");return Promise.all(_.map(this.children,(function(child){return child.appendTo($div);}).bind(this))).then((function(){_.each(this.children,function(child){child.$el.appendTo($to);});}).bind(this));},_parseDomain:function(domain){var parsedDomain=false;try{parsedDomain=Domain.prototype.stringToArray(domain);this.invalidDomain=false;}catch(err){this.invalidDomain=true;this.children=[];}
return parsedDomain;},_onOperatorChange:function(e){e.preventDefault();e.stopPropagation();this._changeOperator($(e.target).data("operator"));},_onNodeAdditionAsk:function(e){var domain=this.options.default||[["id","=",1]];if(e.data.newBranch){domain=[this.operator==="&"?"|":"&"].concat(domain).concat(domain);}
if(this._addChild(domain,e.data.child)){e.stopPropagation();}},_onNodeDeletionAsk:function(e){if(this._removeChild(e.data.child)){e.stopPropagation();}},});var DomainSelector=DomainTree.extend({template:"DomainSelector",events:_.extend({},DomainTree.prototype.events,{"click .o_domain_add_first_node_button":"_onAddFirstButtonClick","change .o_domain_debug_input":"_onDebugInputChange",}),custom_events:_.extend({},DomainTree.prototype.custom_events,{domain_changed:"_onDomainChange",}),start:function(){var self=this;return this._super.apply(this,arguments).then(function(){if(self.invalidDomain){var msg=_t("This domain is not supported.");self.$el.html(msg);}});},setDomain:function(domain){if(domain===Domain.prototype.arrayToString(this.getDomain())){return Promise.resolve();}
var parsedDomain=this._parseDomain(domain);if(parsedDomain){return this._redraw(parsedDomain);}},_initialize:function(domain){if(domain.length>1){Domain.prototype.normalizeArray(domain);}else{domain=["&"].concat(domain);}
return this._super(domain);},_postRender:function(){this._super.apply(this,arguments);this.$debugInput=this.$(".o_domain_debug_input");if(this.$debugInput.length){this.$debugInput.val(Domain.prototype.arrayToString(this.getDomain()));}
if(!this._isValid){this.do_warn(false,_t("Domain not supported"));}},_redraw:function(domain){var oldChildren=this.children.slice();this._initialize(domain||this.getDomain());return this._renderChildrenTo($("<div/>")).then((function(){_.each(oldChildren,function(child){child.destroy();});this.renderElement();this._postRender();_.each(this.children,(function(child){child.$el.appendTo(this.$childrenContainer);}).bind(this));}).bind(this));},_onAddFirstButtonClick:function(){this._addChild(this.options.default||[["id","=",1]]);},_onDebugInputChange:function(e){var domain;try{domain=Domain.prototype.stringToArray($(e.currentTarget).val());}catch(err){this.do_warn(_t("Syntax error"),_t("Domain not properly formed"));return;}
this._redraw(domain).then((function(){this.trigger_up("domain_changed",{child:this,alreadyRedrawn:true});}).bind(this));},_onDomainChange:function(e){if(!e.data.alreadyRedrawn){this._redraw();}},});var DomainLeaf=DomainNode.extend({template:"DomainLeaf",events:_.extend({},DomainNode.prototype.events,{"change .o_domain_leaf_operator_select":"_onOperatorSelectChange","change .o_domain_leaf_value_input":"_onValueInputChange","click .o_domain_leaf_value_add_tag_button":"on_add_tag","keyup .o_domain_leaf_value_tags input":"on_add_tag","click .o_domain_leaf_value_remove_tag_button":"on_remove_tag",}),custom_events:{"field_chain_changed":"_onFieldChainChange",},init:function(parent,model,domain,options){this._super.apply(this,arguments);var currentDomain=Domain.prototype.stringToArray(domain);this.chain=currentDomain[0][0];this.operator=currentDomain[0][1];this.value=currentDomain[0][2];this.operator_mapping=operator_mapping;},willStart:function(){var defs=[this._super.apply(this,arguments)];this.fieldSelector=new ModelFieldSelector(this,this.model,this.chain!==undefined?this.chain.toString().split("."):[],this.options);defs.push(this.fieldSelector.appendTo($("<div/>")).then((function(){var wDefs=[];if(!this.readonly){var selectedField=this.fieldSelector.getSelectedField()||{};this.operators=this._getOperatorsFromType(selectedField.type);if(_.contains(["child_of","parent_of","like","not like","=like","=ilike"],this.operator)){this.operators[this.operator]=operator_mapping[this.operator];}else if(!this.operators[this.operator]){this.operators[this.operator]="?";}
this.selectionChoices=null;if(selectedField.type==="boolean"){this.selectionChoices=[["1",_t("set (true)")],["0",_t("not set (false)")]];}else if(selectedField.type==="selection"){this.selectionChoices=selectedField.selection;}
this.displayValue=this.value;try{if(selectedField&&!selectedField.relation&&!_.isArray(this.value)){this.displayValue=field_utils.format[selectedField.type](this.value,selectedField);}}catch(err){}
this.displayOperator=this.operator;if(selectedField.type==="boolean"){this.displayValue=this.value?"1":"0";}else if((this.operator==="!="||this.operator==="=")&&this.value===false){this.displayOperator=this.operator==="!="?"set":"not set";}
if(_.contains(["date","datetime"],selectedField.type)){this.valueWidget=new(selectedField.type==="datetime"?datepicker.DateTimeWidget:datepicker.DateWidget)(this);wDefs.push(this.valueWidget.appendTo("<div/>").then((function(){this.valueWidget.$el.addClass("o_domain_leaf_value_input");this.valueWidget.setValue(moment(this.value));this.valueWidget.on("datetime_changed",this,function(){this._changeValue(this.valueWidget.getValue());});}).bind(this)));}
return Promise.all(wDefs);}}).bind(this)));return Promise.all(defs);},start:function(){this.fieldSelector.$el.prependTo(this.$("> .o_domain_leaf_info, > .o_domain_leaf_edition"));if(!this.readonly&&this.valueWidget){this.$(".o_domain_leaf_value_input").replaceWith(this.valueWidget.$el);}
return this._super.apply(this,arguments);},isValid:function(){return this.fieldSelector&&this.fieldSelector.isValid();},getDomain:function(){return[[this.chain,this.operator,this.value]];},_changeFieldChain:function(chain,silent){this.chain=chain.join(".");this.fieldSelector.setChain(chain).then((function(){if(!this.fieldSelector.isValid())return;var selectedField=this.fieldSelector.getSelectedField()||{};var operators=this._getOperatorsFromType(selectedField.type);if(operators[this.operator]===undefined){this._changeOperator("=",true);}
this._changeValue(this.value,true);if(!silent)this.trigger_up("domain_changed",{child:this});}).bind(this));},_changeOperator:function(operator,silent){this.operator=operator;if(_.contains(["set","not set"],this.operator)){this.operator=this.operator==="not set"?"=":"!=";this.value=false;}else if(_.contains(["in","not in"],this.operator)){this.value=_.isArray(this.value)?this.value:this.value?(""+this.value).split(","):[];}else{if(_.isArray(this.value)){this.value=this.value.join(",");}
this._changeValue(this.value,true);}
if(!silent)this.trigger_up("domain_changed",{child:this});},_changeValue:function(value,silent){var couldNotParse=false;var selectedField=this.fieldSelector.getSelectedField()||{};try{this.value=field_utils.parse[selectedField.type](value,selectedField);}catch(err){this.value=value;couldNotParse=true;}
if(selectedField.type==="boolean"){if(!_.isBoolean(this.value)){this.value=!!parseFloat(this.value);}}else if(selectedField.type==="selection"){if(!_.some(selectedField.selection,(function(option){return option[0]===this.value;}).bind(this))){this.value=selectedField.selection[0][0];}}else if(_.contains(["date","datetime"],selectedField.type)){if(couldNotParse||_.isBoolean(this.value)){this.value=field_utils.parse[selectedField.type](field_utils.format[selectedField.type](moment())).toJSON();}else{this.value=this.value.toJSON();}}else{if(_.isBoolean(this.value)){this.value="";}else if(_.isObject(this.value)&&!_.isArray(this.value)){this.value=this.value.id||value||"";}}
if(!silent)this.trigger_up("domain_changed",{child:this});},_getOperatorsFromType:function(type){var operators={};switch(type){case"boolean":operators={"=":_t("is"),"!=":_t("is not"),};break;case"char":case"text":case"html":operators=_.pick(operator_mapping,"=","!=","ilike","not ilike","set","not set","in","not in");break;case"many2many":case"one2many":case"many2one":operators=_.pick(operator_mapping,"=","!=","ilike","not ilike","set","not set");break;case"integer":case"float":case"monetary":operators=_.pick(operator_mapping,"=","!=",">","<",">=","<=","ilike","not ilike","set","not set");break;case"selection":operators=_.pick(operator_mapping,"=","!=","set","not set");break;case"date":case"datetime":operators=_.pick(operator_mapping,"=","!=",">","<",">=","<=","set","not set");break;default:operators=_.extend({},operator_mapping);break;}
if(this.options.operators){operators=_.pick.apply(_,[operators].concat(this.options.operators));}
return operators;},_onOperatorSelectChange:function(e){this._changeOperator($(e.currentTarget).val());},_onValueInputChange:function(e){if(e.currentTarget!==e.target)return;this._changeValue($(e.currentTarget).val());},_onFieldChainChange:function(e){this._changeFieldChain(e.data.chain);},on_add_tag:function(e){if(e.type==="keyup"&&e.which!==$.ui.keyCode.ENTER)return;if(!_.contains(["not in","in"],this.operator))return;var values=_.isArray(this.value)?this.value.slice():[];var $input=this.$(".o_domain_leaf_value_tags input");var val=$input.val().trim();if(val&&values.indexOf(val)<0){values.push(val);_.defer(this._changeValue.bind(this,values));$input.focus();}},on_remove_tag:function(e){var values=_.isArray(this.value)?this.value.slice():[];var val=this.$(e.currentTarget).data("value");var index=values.indexOf(val);if(index>=0){values.splice(index,1);_.defer(this._changeValue.bind(this,values));}},});function instantiateNode(parent,model,domain,options){if(domain.length>1){return new DomainTree(parent,model,domain,options);}else if(domain.length===1){return new DomainLeaf(parent,model,domain,options);}
return null;}
return DomainSelector;});;

/* /web/static/src/js/widgets/iframe_widget.js defined in bundle 'web.assets_backend' */
odoo.define('web.IFrameWidget',function(require){"use strict";var Widget=require('web.Widget');var IFrameWidget=Widget.extend({tagName:'iframe',init:function(parent,url){this._super(parent);this.url=url;},start:function(){this.$el.css({height:'100%',width:'100%',border:0});this.$el.attr({src:this.url});this.$el.on("load",this._bindEvents.bind(this));return this._super();},_bindEvents:function(){this.$el.contents().click(this._onIFrameClicked.bind(this));},_onIFrameClicked:function(event){}});return IFrameWidget;});;

/* /web/static/src/js/chrome/loading.js defined in bundle 'web.assets_backend' */
odoo.define('web.Loading',function(require){"use strict";var config=require('web.config');var core=require('web.core');var framework=require('web.framework');var Widget=require('web.Widget');var _t=core._t;var Loading=Widget.extend({template:"Loading",init:function(parent){this._super(parent);this.count=0;this.blocked_ui=false;},start:function(){core.bus.on('rpc_request',this,this.request_call);core.bus.on("rpc_response",this,this.response_call);core.bus.on("rpc_response_failed",this,this.response_call);},destroy:function(){this.on_rpc_event(-this.count);this._super();},request_call:function(){this.on_rpc_event(1);},response_call:function(){this.on_rpc_event(-1);},on_rpc_event:function(increment){var self=this;if(!this.count&&increment===1){this.long_running_timer=setTimeout(function(){self.blocked_ui=true;framework.blockUI();},3000);}
this.count+=increment;if(this.count>0){if(config.isDebug()){this.$el.text(_.str.sprintf(_t("Loading (%d)"),this.count));}else{this.$el.text(_t("Loading"));}
this.$el.show();this.getParent().$el.addClass('oe_wait');}else{this.count=0;clearTimeout(this.long_running_timer);if(self.blocked_ui){this.blocked_ui=false;framework.unblockUI();}
this.$el.fadeOut();this.getParent().$el.removeClass('oe_wait');}}});return Loading;});;

/* /web/static/src/js/widgets/model_field_selector.js defined in bundle 'web.assets_backend' */
odoo.define("web.ModelFieldSelector",function(require){"use strict";var core=require("web.core");var Widget=require("web.Widget");var _t=core._t;var modelFieldsCache={cache:{},cacheDefs:{},};core.bus.on('clear_cache',null,function(){modelFieldsCache.cache={};modelFieldsCache.cacheDefs={};});var ModelFieldSelector=Widget.extend({template:"ModelFieldSelector",events:{},editionEvents:{"focusin":"_onFocusIn","focusout":"_onFocusOut","click .o_field_selector_close":"_onCloseClick","click .o_field_selector_prev_page":"_onPrevPageClick","click .o_field_selector_next_page":"_onNextPageClick","click li.o_field_selector_select_button":"_onLastFieldClick","change input.o_field_selector_debug":"_onDebugInputChange","keyup .o_field_selector_search > input":"_onSearchInputChange","mouseover li.o_field_selector_item":"_onItemHover","keydown":"_onKeydown",},init:function(parent,model,chain,options){this._super.apply(this,arguments);this.model=model;this.chain=chain;this.options=_.extend({order:'string',readonly:true,filters:{},fields:null,filter:function(){return true;},followRelations:true,debugMode:false,showSearchInput:true,},options||{});this.options.filters=_.extend({searchable:true,},this.options.filters);if(typeof this.options.followRelations!=='function'){this.options.followRelations=this.options.followRelations?function(){return true;}:function(){return false;};}
this.pages=[];this.dirty=false;if(!this.options.readonly){_.extend(this.events,this.editionEvents);}
this.searchValue='';},willStart:function(){return Promise.all([this._super.apply(this,arguments),this._prefill()]);},start:function(){this.$value=this.$(".o_field_selector_value");this.$popover=this.$(".o_field_selector_popover");this.$input=this.$popover.find(".o_field_selector_popover_footer > input");this.$searchInput=this.$popover.find(".o_field_selector_search > input");this.$valid=this.$(".o_field_selector_warning");this._render();return this._super.apply(this,arguments);},getSelectedField:function(){return _.findWhere(this.pages[this.chain.length-1],{name:_.last(this.chain)});},isValid:function(){return this.valid;},setChain:function(chain){if(_.isEqual(chain,this.chain)){return Promise.resolve();}
this.chain=chain;return this._prefill().then(this._render.bind(this));},_addChainNode:function(fieldName){this.dirty=true;this.chain=this.chain.slice(0,this.pages.length-1);this.chain.push(fieldName);this.searchValue='';this.$searchInput.val('');},_getLastPageField:function(name){return _.findWhere(_.last(this.pages),{name:name,});},_getModelFieldsFromCache:function(model,filters){var self=this;var def=modelFieldsCache.cacheDefs[model];if(!def){def=modelFieldsCache.cacheDefs[model]=this._rpc({model:model,method:'fields_get',args:[false,["store","searchable","type","string","relation","selection","related"]],context:this.getSession().user_context,}).then((function(fields){modelFieldsCache.cache[model]=sortFields(fields,model,self.options.order);}).bind(this));}
return def.then((function(){return _.filter(modelFieldsCache.cache[model],function(f){return(!filters.searchable||f.searchable)&&self.options.filter(f);});}).bind(this));},_goToNextPage:function(field){if(!_.isEqual(this._getLastPageField(field.name),field))return;this._validate(true);this._addChainNode(field.name);this._pushPageData(field.relation).then(this._render.bind(this));},_goToPrevPage:function(){if(this.pages.length<=0)return;this._validate(true);this._removeChainNode();if(this.pages.length>1){this.pages.pop();}
this._render();},_hidePopover:function(){if(!this._isOpen)return;this._isOpen=false;this.$popover.addClass('d-none');if(this.dirty){this.dirty=false;this.trigger_up("field_chain_changed",{chain:this.chain});}},_prefill:function(){this.pages=[];return this._pushPageData(this.model).then((function(){this._validate(true);return(this.chain.length?processChain.call(this,this.chain.slice().reverse()):Promise.resolve());}).bind(this));function processChain(chain){var fieldName=chain.pop();var field=this._getLastPageField(fieldName);if(field&&field.relation){if(chain.length){return this._pushPageData(field.relation).then(processChain.bind(this,chain));}else{return this._pushPageData(field.relation);}}else if(field&&chain.length===0){return Promise.resolve();}else if(!field&&fieldName==="1"){this._validate(true);}else if(!field&&fieldName==="0"){this._validate(true);}else{this._validate(false);}
return Promise.resolve();}},_pushPageData:function(model){var def;if(this.model===model&&this.options.fields){def=Promise.resolve(sortFields(this.options.fields,model,this.options.order));}else{def=this._getModelFieldsFromCache(model,this.options.filters);}
return def.then((function(fields){this.pages.push(fields);}).bind(this));},_removeChainNode:function(){this.dirty=true;this.chain=this.chain.slice(0,this.pages.length-1);this.chain.pop();},_render:function(){this.$value.html(core.qweb.render(this.template+".value",{chain:this.chain,pages:this.pages,}));this.$valid.toggleClass('d-none',!!this.isValid());var page=_.last(this.pages);var title="";if(this.pages.length>1){var prevField=_.findWhere(this.pages[this.pages.length-2],{name:(this.chain.length===this.pages.length)?this.chain[this.chain.length-2]:_.last(this.chain),});if(prevField)title=prevField.string;}
this.$(".o_field_selector_popover_header .o_field_selector_title").text(title);var lines=_.filter(page,this.options.filter);if(this.searchValue){var matches=fuzzy.filter(this.searchValue,_.pluck(lines,'string'));lines=_.map(_.pluck(matches,'index'),function(i){return lines[i];});}
this.$(".o_field_selector_page").replaceWith(core.qweb.render(this.template+".page",{lines:lines,followRelations:this.options.followRelations,debug:this.options.debugMode,}));this.$input.val(this.chain.join("."));},_selectField:function(field){if(!_.isEqual(this._getLastPageField(field.name),field))return;this._validate(true);this._addChainNode(field.name);this._render();this._hidePopover();},_showPopover:function(){if(this._isOpen)return;this._isOpen=true;this.$popover.removeClass('d-none');},_validate:function(valid){this.valid=!!valid;if(!this.valid){this.do_warn(false,_t("Invalid field chain. You may have used a non-existing field name or followed a non-relational field."));}},_onFocusIn:function(){clearTimeout(this._hidePopoverTimeout);this._showPopover();},_onFocusOut:function(){this._hidePopoverTimeout=_.defer(this._hidePopover.bind(this));},_onCloseClick:function(){this._hidePopover();},_onPrevPageClick:function(){this._goToPrevPage();},_onNextPageClick:function(e){e.stopPropagation();this._goToNextPage(this._getLastPageField($(e.currentTarget).data("name")));},_onLastFieldClick:function(e){this._selectField(this._getLastPageField($(e.currentTarget).data("name")));},_onDebugInputChange:function(){var userChainStr=this.$input.val();var userChain=userChainStr.split(".");if(!this.options.followRelations&&userChain.length>1){this.do_warn(_t("Relation not allowed"),_t("You cannot follow relations for this field chain construction"));userChain=[userChain[0]];}
this.setChain(userChain).then((function(){this.trigger_up("field_chain_changed",{chain:this.chain});}).bind(this));},_onSearchInputChange:function(){this.searchValue=this.$searchInput.val();this._render();},_onItemHover:function(e){this.$("li.o_field_selector_item").removeClass("active");$(e.currentTarget).addClass("active");},_onKeydown:function(e){if(!this.$popover.is(":visible"))return;var inputHasFocus=this.$input.is(":focus");var searchInputHasFocus=this.$searchInput.is(":focus");switch(e.which){case $.ui.keyCode.UP:case $.ui.keyCode.DOWN:e.preventDefault();var $active=this.$("li.o_field_selector_item.active");var $to=$active[e.which===$.ui.keyCode.DOWN?"next":"prev"](".o_field_selector_item");if($to.length){$active.removeClass("active");$to.addClass("active");this.$popover.focus();var $page=$to.closest(".o_field_selector_page");var full_height=$page.height();var el_position=$to.position().top;var el_height=$to.outerHeight();var current_scroll=$page.scrollTop();if(el_position<0){$page.scrollTop(current_scroll-el_height);}else if(full_height<el_position+el_height){$page.scrollTop(current_scroll+el_height);}}
break;case $.ui.keyCode.RIGHT:if(inputHasFocus)break;e.preventDefault();var name=this.$("li.o_field_selector_item.active").data("name");if(name){var field=this._getLastPageField(name);if(field.relation){this._goToNextPage(field);}}
break;case $.ui.keyCode.LEFT:if(inputHasFocus)break;e.preventDefault();this._goToPrevPage();break;case $.ui.keyCode.ESCAPE:e.stopPropagation();this._hidePopover();break;case $.ui.keyCode.ENTER:if(inputHasFocus||searchInputHasFocus)break;e.preventDefault();this._selectField(this._getLastPageField(this.$("li.o_field_selector_item.active").data("name")));break;}}});return ModelFieldSelector;function sortFields(fields,model,order){var array=_.chain(fields).pairs().sortBy(function(p){return p[1].string;});if(order!=='string'){array=array.sortBy(function(p){return p[1][order];});}
return array.map(function(p){return _.extend({name:p[0],model:model,},p[1]);}).value();}});;

/* /web/static/src/js/chrome/systray_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.SystrayMenu',function(require){"use strict";var dom=require('web.dom');var Widget=require('web.Widget');var SystrayMenu=Widget.extend({init:function(parent){this._super(parent);this.items=[];this.widgets=[];},willStart:function(){var self=this;var proms=[];SystrayMenu.Items=_.sortBy(SystrayMenu.Items,function(item){return!_.isUndefined(item.prototype.sequence)?item.prototype.sequence:50;});SystrayMenu.Items.forEach(function(WidgetClass){var cur_systray_item=new WidgetClass(self);self.widgets.push(cur_systray_item);proms.push(cur_systray_item.appendTo($('<div>')));});return this._super.apply(this,arguments).then(function(){return Promise.all(proms);});},on_attach_callback(){this.widgets.filter(widget=>widget.on_attach_callback).forEach(widget=>widget.on_attach_callback());},start:function(){var self=this;return this._super.apply(this,arguments).then(function(){self.widgets.forEach(function(widget){dom.prepend(self.$el,widget.$el);});});},});SystrayMenu.Items=[];return SystrayMenu;});;

/* /web/static/src/js/widgets/switch_company_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.SwitchCompanyMenu',function(require){"use strict";var config=require('web.config');var core=require('web.core');var session=require('web.session');var SystrayMenu=require('web.SystrayMenu');var Widget=require('web.Widget');var _t=core._t;var SwitchCompanyMenu=Widget.extend({template:'SwitchCompanyMenu',events:{'click .dropdown-item[data-menu] div.log_into':'_onSwitchCompanyClick','keydown .dropdown-item[data-menu] div.log_into':'_onSwitchCompanyClick','click .dropdown-item[data-menu] div.toggle_company':'_onToggleCompanyClick','keydown .dropdown-item[data-menu] div.toggle_company':'_onToggleCompanyClick',},sequence:1,init:function(){this._super.apply(this,arguments);this.isMobile=config.device.isMobile;this._onSwitchCompanyClick=_.debounce(this._onSwitchCompanyClick,1500,true);},willStart:function(){var self=this;this.allowed_company_ids=String(session.user_context.allowed_company_ids).split(',').map(function(id){return parseInt(id);});this.user_companies=session.user_companies.allowed_companies;this.current_company=this.allowed_company_ids[0];this.current_company_name=_.find(session.user_companies.allowed_companies,function(company){return company[0]===self.current_company;})[1];return this._super.apply(this,arguments);},_onSwitchCompanyClick:function(ev){if(ev.type=='keydown'&&ev.which!=$.ui.keyCode.ENTER&&ev.which!=$.ui.keyCode.SPACE){return;}
ev.preventDefault();ev.stopPropagation();var dropdownItem=$(ev.currentTarget).parent();var dropdownMenu=dropdownItem.parent();var companyID=dropdownItem.data('company-id');var allowed_company_ids=this.allowed_company_ids;if(dropdownItem.find('.fa-square-o').length){if(this.allowed_company_ids.length===1){if(this.isMobile){dropdownMenu=dropdownMenu.parent();}
dropdownMenu.find('.fa-check-square').removeClass('fa-check-square').addClass('fa-square-o');dropdownItem.find('.fa-square-o').removeClass('fa-square-o').addClass('fa-check-square');allowed_company_ids=[companyID];}else{allowed_company_ids.push(companyID);dropdownItem.find('.fa-square-o').removeClass('fa-square-o').addClass('fa-check-square');}}
$(ev.currentTarget).attr('aria-pressed','true');session.setCompanies(companyID,allowed_company_ids);},_onToggleCompanyClick:function(ev){if(ev.type=='keydown'&&ev.which!=$.ui.keyCode.ENTER&&ev.which!=$.ui.keyCode.SPACE){return;}
ev.preventDefault();ev.stopPropagation();var dropdownItem=$(ev.currentTarget).parent();var companyID=dropdownItem.data('company-id');var allowed_company_ids=this.allowed_company_ids;var current_company_id=allowed_company_ids[0];if(dropdownItem.find('.fa-square-o').length){allowed_company_ids.push(companyID);dropdownItem.find('.fa-square-o').removeClass('fa-square-o').addClass('fa-check-square');$(ev.currentTarget).attr('aria-checked','true');}else{allowed_company_ids.splice(allowed_company_ids.indexOf(companyID),1);dropdownItem.find('.fa-check-square').addClass('fa-square-o').removeClass('fa-check-square');$(ev.currentTarget).attr('aria-checked','false');}
session.setCompanies(current_company_id,allowed_company_ids);},});if(session.display_switch_company_menu){SystrayMenu.Items.push(SwitchCompanyMenu);}
return SwitchCompanyMenu;});;

/* /web/static/src/js/chrome/user_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.UserMenu',function(require){"use strict";var config=require('web.config');var core=require('web.core');var framework=require('web.framework');var Dialog=require('web.Dialog');var Widget=require('web.Widget');var _t=core._t;var QWeb=core.qweb;var UserMenu=Widget.extend({template:'UserMenu',start:function(){var self=this;var session=this.getSession();this.$el.on('click','[data-menu]',function(ev){ev.preventDefault();var menu=$(this).data('menu');self['_onMenu'+menu.charAt(0).toUpperCase()+menu.slice(1)]();});return this._super.apply(this,arguments).then(function(){var $avatar=self.$('.oe_topbar_avatar');if(!session.uid){$avatar.attr('src',$avatar.data('default-src'));return Promise.resolve();}
var topbar_name=session.name;if(config.isDebug()){topbar_name=_.str.sprintf("%s (%s)",topbar_name,session.db);}
self.$('.oe_topbar_name').text(topbar_name);var avatar_src=session.url('/web/image',{model:'res.users',field:'image_128',id:session.uid,});$avatar.attr('src',avatar_src);});},_onMenuAccount:function(){var self=this;this.trigger_up('clear_uncommitted_changes',{callback:function(){self._rpc({route:'/web/session/account'}).then(function(url){framework.redirect(url);}).guardedCatch(function(result,ev){ev.preventDefault();framework.redirect('https://accounts.odoo.com/account');});},});},_onMenuDocumentation:function(){window.open('https://www.odoo.com/documentation/14.0','_blank');},_onMenuLogout:function(){this.trigger_up('clear_uncommitted_changes',{callback:this.do_action.bind(this,'logout'),});},_onMenuSettings:function(){var self=this;var session=this.getSession();this.trigger_up('clear_uncommitted_changes',{callback:function(){self._rpc({model:"res.users",method:"action_get"}).then(function(result){result.res_id=session.uid;self.do_action(result);});},});},_onMenuSupport:function(){window.open('https://www.odoo.com/buy','_blank');},_onMenuShortcuts:function(){new Dialog(this,{size:'large',dialogClass:'o_act_window',title:_t("Keyboard Shortcuts"),$content:$(QWeb.render("UserMenu.shortcuts"))}).open();},});return UserMenu;});;

/* /web/static/src/js/chrome/menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.Menu',function(require){"use strict";var AppsMenu=require('web.AppsMenu');var config=require('web.config');var core=require('web.core');var dom=require('web.dom');var SystrayMenu=require('web.SystrayMenu');var UserMenu=require('web.UserMenu');var Widget=require('web.Widget');UserMenu.prototype.sequence=0;SystrayMenu.Items.push(UserMenu);var QWeb=core.qweb;var Menu=Widget.extend({template:'Menu',menusTemplate:'Menu.sections',events:{'mouseover .o_menu_sections > li:not(.show)':'_onMouseOverMenu','click .o_menu_brand':'_onAppNameClicked',},init:function(parent,menu_data){var self=this;this._super.apply(this,arguments);this.$menu_sections={};this.menu_data=menu_data;var $menu_sections=$(QWeb.render(this.menusTemplate,{menu_data:this.menu_data,}));$menu_sections.filter('section').each(function(){self.$menu_sections[parseInt(this.className,10)]=$(this).children('li');});core.bus.on('change_menu_section',this,this.change_menu_section);},start:function(){var self=this;this.$menu_apps=this.$('.o_menu_apps');this.$menu_brand_placeholder=this.$('.o_menu_brand');this.$section_placeholder=this.$('.o_menu_sections');this._updateMenuBrand();var on_secondary_menu_click=function(ev){ev.preventDefault();var menu_id=$(ev.currentTarget).data('menu');var action_id=$(ev.currentTarget).data('action-id');self._on_secondary_menu_click(menu_id,action_id);};var menu_ids=_.keys(this.$menu_sections);var primary_menu_id,$section;for(var i=0;i<menu_ids.length;i++){primary_menu_id=menu_ids[i];$section=this.$menu_sections[primary_menu_id];$section.on('click','a[data-menu]',self,on_secondary_menu_click.bind(this));}
this._appsMenu=new AppsMenu(self,this.menu_data);var appsMenuProm=this._appsMenu.appendTo(this.$menu_apps);this.systray_menu=new SystrayMenu(this);var systrayMenuProm=this.systray_menu.attachTo(this.$('.o_menu_systray')).then(function(){self.systray_menu.on_attach_callback();dom.initAutoMoreMenu(self.$section_placeholder,{maxWidth:function(){return self.$el.width()-(self.$menu_apps.outerWidth(true)+self.$menu_brand_placeholder.outerWidth(true)+self.systray_menu.$el.outerWidth(true));},sizeClass:'SM',});});return Promise.all([this._super.apply(this,arguments),appsMenuProm,systrayMenuProm]);},change_menu_section:function(primary_menu_id){if(!this.$menu_sections[primary_menu_id]){this._updateMenuBrand();return;}
if(this.current_primary_menu===primary_menu_id){return;}
if(this.current_primary_menu){this.$menu_sections[this.current_primary_menu].detach();}
for(var i=0;i<this.menu_data.children.length;i++){if(this.menu_data.children[i].id===primary_menu_id){this._updateMenuBrand(this.menu_data.children[i].name);break;}}
this.$menu_sections[primary_menu_id].appendTo(this.$section_placeholder);this.current_primary_menu=primary_menu_id;core.bus.trigger('resize');},_trigger_menu_clicked:function(menu_id,action_id){this.trigger_up('menu_clicked',{id:menu_id,action_id:action_id,previous_menu_id:this.current_secondary_menu||this.current_primary_menu,});},_updateMenuBrand:function(brandName){if(brandName){this.$menu_brand_placeholder.text(brandName).show();this.$section_placeholder.show();}else{this.$menu_brand_placeholder.hide()
this.$section_placeholder.hide();}},_on_secondary_menu_click:function(menu_id,action_id){var self=this;if(action_id){self._trigger_menu_clicked(menu_id,action_id);this.current_secondary_menu=menu_id;}},action_id_to_primary_menu_id:function(action_id){var primary_menu_id,found;for(var i=0;i<this.menu_data.children.length&&!primary_menu_id;i++){found=this._action_id_in_subtree(this.menu_data.children[i],action_id);if(found){primary_menu_id=this.menu_data.children[i].id;}}
return primary_menu_id;},_action_id_in_subtree:function(root,action_id){if(root.action&&root.action.split(',')[1]===String(action_id)){return true;}
var found;for(var i=0;i<root.children.length&&!found;i++){found=this._action_id_in_subtree(root.children[i],action_id);}
return found;},menu_id_to_action_id:function(menu_id,root){if(!root){root=$.extend(true,{},this.menu_data);}
if(root.id===menu_id){return root.action.split(',')[1];}
for(var i=0;i<root.children.length;i++){var action_id=this.menu_id_to_action_id(menu_id,root.children[i]);if(action_id!==undefined){return action_id;}}
return undefined;},getCurrentPrimaryMenu:function(){return this.current_primary_menu;},openFirstApp:function(){return this._appsMenu.openFirstApp();},_onAppNameClicked:function(ev){var actionID=parseInt(this.menu_id_to_action_id(this.current_primary_menu));this._trigger_menu_clicked(this.current_primary_menu,actionID);},_onMouseOverMenu:function(ev){if(config.device.isMobile){return;}
var $target=$(ev.currentTarget);var $opened=$target.siblings('.show');if($opened.length){$opened.find('[data-toggle="dropdown"]:first').dropdown('toggle');$opened.removeClass('show');$target.find('[data-toggle="dropdown"]:first').dropdown('toggle');$target.addClass('show');}},});return Menu;});;

/* /web/static/src/js/chrome/apps_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.AppsMenu',function(require){"use strict";var Widget=require('web.Widget');var AppsMenu=Widget.extend({template:'AppsMenu',events:{'click .o_app':'_onAppsMenuItemClicked',},init:function(parent,menuData){this._super.apply(this,arguments);this._activeApp=undefined;this._apps=_.map(menuData.children,function(appMenuData){return{actionID:parseInt(appMenuData.action.split(',')[1]),menuID:appMenuData.id,name:appMenuData.name,xmlID:appMenuData.xmlid,};});},getApps:function(){return this._apps;},openFirstApp:function(){if(!this._apps.length){return false;}
var firstApp=this._apps[0];this._openApp(firstApp);return true;},_openApp:function(app){this._setActiveApp(app);this.trigger_up('app_clicked',{action_id:app.actionID,menu_id:app.menuID,});},_setActiveApp:function(app){var $oldActiveApp=this.$('.o_app.active');$oldActiveApp.removeClass('active');var $newActiveApp=this.$('.o_app[data-action-id="'+app.actionID+'"]');$newActiveApp.addClass('active');},_onAppsMenuItemClicked:function(ev){var $target=$(ev.currentTarget);var actionID=$target.data('action-id');var menuID=$target.data('menu-id');var app=_.findWhere(this._apps,{actionID:actionID,menuID:menuID});this._openApp(app);},});return AppsMenu;});;

/* /web/static/src/js/widgets/pie_chart.js defined in bundle 'web.assets_backend' */
odoo.define('web.PieChart',function(require){"use strict";var core=require('web.core');var Domain=require('web.Domain');var viewRegistry=require('web.view_registry');var Widget=require('web.Widget');var widgetRegistry=require('web.widget_registry');var qweb=core.qweb;var PieChart=Widget.extend({className:'o_pie_chart',xmlDependencies:['/web/static/src/xml/chart.xml'],init:function(parent,record,node){this._super.apply(this,arguments);var modifiers=node.attrs.modifiers;var domain=record.domain.concat(Domain.prototype.stringToArray(modifiers.domain||'[]'));var arch=qweb.render('web.PieChart',{modifiers:modifiers,title:node.attrs.title||modifiers.title||modifiers.measure,});var pieChartContext=JSON.parse(JSON.stringify(record.context));delete pieChartContext.graph_mode;delete pieChartContext.graph_measure;delete pieChartContext.graph_groupbys;this.subViewParams={modelName:record.model,withButtons:false,withControlPanel:false,withSearchPanel:false,isEmbedded:true,useSampleModel:record.isSample,mode:'pie',};this.subViewParams.searchQuery={context:pieChartContext,domain:domain,groupBy:[],timeRanges:record.timeRanges||{},};this.viewInfo={arch:arch,fields:record.fields,viewFields:record.fieldsInfo.dashboard,};},willStart:function(){var self=this;var def1=this._super.apply(this,arguments);var SubView=viewRegistry.get('graph');var subView=new SubView(this.viewInfo,this.subViewParams);var def2=subView.getController(this).then(function(controller){self.controller=controller;return self.controller.appendTo(document.createDocumentFragment());});return Promise.all([def1,def2]);},start:function(){this.$el.append(this.controller.$el);return this._super.apply(this,arguments);},on_attach_callback:function(){this.controller.on_attach_callback();},});widgetRegistry.add('pie_chart',PieChart);return PieChart;});;

/* /web/static/src/js/widgets/ribbon.js defined in bundle 'web.assets_backend' */
odoo.define('web.ribbon',function(require){'use strict';var widgetRegistry=require('web.widget_registry');var Widget=require('web.Widget');var RibbonWidget=Widget.extend({template:'web.ribbon',xmlDependencies:['/web/static/src/xml/ribbon.xml'],init:function(parent,data,options){this._super.apply(this,arguments);this.text=options.attrs.title||options.attrs.text;this.tooltip=options.attrs.tooltip;this.className=options.attrs.bg_color?options.attrs.bg_color:'bg-success';if(this.text.length>15){this.className+=' o_small';}else if(this.text.length>10){this.className+=' o_medium';}},});widgetRegistry.add('web_ribbon',RibbonWidget);return RibbonWidget;});;

/* /web/static/src/js/widgets/signature.js defined in bundle 'web.assets_backend' */
odoo.define('web.signature_widget',function(require){"use strict";const framework=require('web.framework');const SignatureDialog=require('web.signature_dialog');const widgetRegistry=require('web.widget_registry');const Widget=require('web.Widget');const WidgetSignature=Widget.extend({custom_events:Object.assign({},Widget.prototype.custom_events,{upload_signature:'_onUploadSignature',}),events:Object.assign({},Widget.prototype.events,{'click .o_sign_label':'_onClickSignature',}),template:'SignButton',init:function(parent,record,nodeInfo){this._super.apply(this,arguments);this.res_id=record.res_id;this.res_model=record.model;this.state=record;this.node=nodeInfo;this.signature_field=this.node.attrs.signature_field||'signature';},_onClickSignature:function(){const nameAndSignatureOptions={displaySignatureRatio:3,mode:'draw',noInputName:true,signatureType:'signature',};if(this.node.attrs.full_name){let signName;const fieldFullName=this.state.data[this.node.attrs.full_name];if(fieldFullName&&fieldFullName.type==='record'){signName=fieldFullName.data.display_name;}else{signName=fieldFullName;}
nameAndSignatureOptions.defaultName=signName||undefined;}
nameAndSignatureOptions.defaultFont=this.node.attrs.default_font||'';this.signDialog=new SignatureDialog(this,{nameAndSignatureOptions:nameAndSignatureOptions,});this.signDialog.open();},_onUploadSignature:function(ev){const file=ev.data.signatureImage[1];const always=()=>{this.trigger_up('reload');framework.unblockUI();};framework.blockUI();const rpcProm=this._rpc({model:this.res_model,method:'write',args:[[this.res_id],{[this.signature_field]:file,}],});rpcProm.then(always).guardedCatch(always);return rpcProm;},});widgetRegistry.add('signature',WidgetSignature);});;

/* /web/static/src/js/components/action_menus.js defined in bundle 'web.assets_backend' */
odoo.define('web.ActionMenus',function(require){"use strict";const Context=require('web.Context');const DropdownMenu=require('web.DropdownMenu');const Registry=require('web.Registry');const{Component}=owl;let registryActionId=1;class ActionMenus extends Component{async willStart(){this.actionItems=await this._setActionItems(this.props);this.printItems=await this._setPrintItems(this.props);}
async willUpdateProps(nextProps){this.actionItems=await this._setActionItems(nextProps);this.printItems=await this._setPrintItems(nextProps);}
mounted(){this._addTooltips();}
patched(){this._addTooltips();}
_addTooltips(){$(this.el.querySelectorAll('[title]')).tooltip({delay:{show:500,hide:0}});}
async _setActionItems(props){const callbackActions=(props.items.other||[]).map(action=>Object.assign({key:`action-${action.description}`},action));const actionActions=props.items.action||[];const relateActions=props.items.relate||[];const formattedActions=[...actionActions,...relateActions].map(action=>({action,description:action.name,key:action.id}));const registryActions=[];const rpc=this.rpc.bind(this);for(const{Component,getProps}of this.constructor.registry.values()){const itemProps=await getProps(props,this.env,rpc);if(itemProps){registryActions.push({Component,key:`registry-action-${registryActionId++}`,props:itemProps,});}}
return[...callbackActions,...formattedActions,...registryActions];}
async _setPrintItems(props){const printActions=props.items.print||[];const printItems=printActions.map(action=>({action,description:action.name,key:action.id}));return printItems;}
async _executeAction(action){let activeIds=this.props.activeIds;if(this.props.isDomainSelected){activeIds=await this.rpc({model:this.env.action.res_model,method:'search',args:[this.props.domain],kwargs:{limit:this.env.session.active_ids_limit,},});}
const activeIdsContext={active_id:activeIds[0],active_ids:activeIds,active_model:this.env.action.res_model,};if(this.props.domain){activeIdsContext.active_domain=this.props.domain;}
const context=new Context(this.props.context,activeIdsContext).eval();const result=await this.rpc({route:'/web/action/load',params:{action_id:action.id,context},});result.context=new Context(result.context||{},activeIdsContext).set_eval_context(context);result.flags=result.flags||{};result.flags.new_window=true;this.trigger('do-action',{action:result,options:{on_close:()=>this.trigger('reload'),},});}
_onItemSelected(ev){ev.stopPropagation();const{item}=ev.detail;if(item.callback){item.callback([item]);}else if(item.action){this._executeAction(item.action);}else if(item.url){this.env.services.navigate(item.url);}}}
ActionMenus.registry=new Registry();ActionMenus.components={DropdownMenu};ActionMenus.props={activeIds:{type:Array,element:[Number,String]},context:Object,domain:{type:Array,optional:1},isDomainSelected:{type:Boolean,optional:1},items:{type:Object,shape:{action:{type:Array,optional:1},print:{type:Array,optional:1},other:{type:Array,optional:1},},},};ActionMenus.template='web.ActionMenus';return ActionMenus;});;

/* /web/static/src/js/components/dropdown_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.DropdownMenu',function(require){"use strict";const DropdownMenuItem=require('web.DropdownMenuItem');const{Component,hooks}=owl;const{useExternalListener,useRef,useState}=hooks;class DropdownMenu extends Component{constructor(){super(...arguments);this.dropdownMenu=useRef('dropdown');this.state=useState({open:false});useExternalListener(window,'click',this._onWindowClick,true);useExternalListener(window,'keydown',this._onWindowKeydown);}
get displayCaret(){return false;}
get displayChevron(){return this.env.device.isMobile;}
get icon(){return this.props.icon;}
get items(){return this.props.items;}
get title(){return this.props.title;}
_onButtonKeydown(ev){switch(ev.key){case'ArrowLeft':case'ArrowRight':case'ArrowUp':case'ArrowDown':const firstItem=this.el.querySelector('.dropdown-item');if(firstItem){ev.preventDefault();firstItem.focus();}}}
_onItemSelected(){if(this.props.closeOnSelected){this.state.open=false;}}
_onWindowClick(ev){if(this.state.open&&!this.el.contains(ev.target)&&!this.el.contains(document.activeElement)){if(document.body.classList.contains("modal-open")){const modal=document.querySelector('body > .modal:not(.o_inactive_modal)');if(modal&&!modal.contains(this.el)){return;}
const owlModal=document.querySelector('body > .o_dialog > .modal:not(.o_inactive_modal)');if(owlModal&&!owlModal.contains(this.el)){return;}}
if(document.querySelector('body > .bootstrap-datetimepicker-widget')){return;}
this.state.open=false;}}
_onWindowKeydown(ev){if(this.state.open&&ev.key==='Escape'){this.state.open=false;}}}
DropdownMenu.components={DropdownMenuItem};DropdownMenu.defaultProps={items:[]};DropdownMenu.props={icon:{type:String,optional:1},items:{type:Array,element:Object,optional:1,},title:{type:String,optional:1},closeOnSelected:{type:Boolean,optional:1},};DropdownMenu.template='web.DropdownMenu';return DropdownMenu;});;

/* /web/static/src/js/components/dropdown_menu_item.js defined in bundle 'web.assets_backend' */
odoo.define('web.DropdownMenuItem',function(require){"use strict";const{useListener}=require('web.custom_hooks');const{Component,hooks}=owl;const{useExternalListener,useRef,useState}=hooks;class DropdownMenuItem extends Component{constructor(){super(...arguments);this.canBeOpened=Boolean(this.props.options&&this.props.options.length);this.fallbackFocusRef=useRef('fallback-focus');this.state=useState({open:false});useExternalListener(window,'click',this._onWindowClick);useListener('keydown',this._onKeydown);}
_onKeydown(ev){if(['INPUT','TEXTAREA'].includes(document.activeElement.tagName)){return;}
switch(ev.key){case'ArrowLeft':if(this.canBeOpened&&this.state.open){ev.preventDefault();if(this.fallbackFocusRef.el){this.fallbackFocusRef.el.focus();}
this.state.open=false;}
break;case'ArrowRight':if(this.canBeOpened&&!this.state.open){ev.preventDefault();this.state.open=true;}
break;case'Escape':ev.target.blur();if(this.canBeOpened&&this.state.open){ev.preventDefault();ev.stopPropagation();if(this.fallbackFocusRef.el){this.fallbackFocusRef.el.focus();}
this.state.open=false;}}}
_onWindowClick(ev){if(this.state.open&&!this.el.contains(ev.target)&&!this.el.contains(document.activeElement)){this.state.open=false;}}}
DropdownMenuItem.template='web.DropdownMenuItem';return DropdownMenuItem;});;

/* /web/static/src/js/components/custom_checkbox.js defined in bundle 'web.assets_backend' */
odoo.define('web.CustomCheckbox',function(require){"use strict";const utils=require('web.utils');const{Component}=owl;class CustomCheckbox extends Component{constructor(){super(...arguments);this._id=`checkbox-comp-${utils.generateID()}`;}}
CustomCheckbox.props={id:{type:[String,Number],optional:1,},disabled:{type:Boolean,optional:1,},value:{type:Boolean,optional:1,},text:{type:String,optional:1,},};CustomCheckbox.template='web.CustomCheckbox';return CustomCheckbox;});;

/* /web/static/src/js/components/custom_file_input.js defined in bundle 'web.assets_backend' */
odoo.define('web.CustomFileInput',function(require){"use strict";const{Component,hooks}=owl;const{useRef}=hooks;class CustomFileInput extends Component{constructor(){super(...arguments);this.fileInputRef=useRef('file-input');}
async _onFileInputChange(){const{action,model,id}=this.props;const params={csrf_token:odoo.csrf_token,ufile:[...this.fileInputRef.el.files],};if(model){params.model=model;}
if(id){params.id=id;}
const fileData=await this.env.services.httpRequest(action,params,'text');const parsedFileData=JSON.parse(fileData);if(parsedFileData.error){throw new Error(parsedFileData.error);}
this.trigger('uploaded',{files:parsedFileData});}
_onTriggerClicked(){this.fileInputRef.el.click();}}
CustomFileInput.defaultProps={accepted_file_extensions:'*',action:'/web/binary/upload',multi_upload:false,};CustomFileInput.props={accepted_file_extensions:{type:String,optional:1},action:{type:String,optional:1},id:{type:Number,optional:1},model:{type:String,optional:1},multi_upload:{type:Boolean,optional:1},};CustomFileInput.template='web.CustomFileInput';return CustomFileInput;});;

/* /web/static/src/js/components/datepicker.js defined in bundle 'web.assets_backend' */
odoo.define('web.DatePickerOwl',function(require){"use strict";const field_utils=require('web.field_utils');const time=require('web.time');const{useAutofocus}=require('web.custom_hooks');const{Component,hooks}=owl;const{useExternalListener,useRef,useState}=hooks;let datePickerId=0;class DatePicker extends Component{constructor(){super(...arguments);this.inputRef=useRef('input');this.state=useState({warning:false});this.datePickerId=`o_datepicker_${datePickerId++}`;this.typeOfDate='date';useAutofocus();useExternalListener(window,'scroll',this._onWindowScroll);}
mounted(){$(this.el).on('show.datetimepicker',this._onDateTimePickerShow.bind(this));$(this.el).on('hide.datetimepicker',this._onDateTimePickerHide.bind(this));$(this.el).on('error.datetimepicker',()=>false);const pickerOptions=Object.assign({format:this.defaultFormat},this.props);this._datetimepicker(pickerOptions);this.inputRef.el.value=this._formatDate(this.props.date);}
willUnmount(){this._datetimepicker('destroy');}
willUpdateProps(nextProps){for(const prop in nextProps){this._datetimepicker(prop,nextProps[prop]);}
if(nextProps.date){this.inputRef.el.value=this._formatDate(nextProps.date);}}
get defaultFormat(){return time.getLangDateFormat();}
_datetimepicker(...args){this.ignoreBootstrapEvents=true;$(this.el).datetimepicker(...args);this.ignoreBootstrapEvents=false;}
_formatDate(date){try{return field_utils.format[this.typeOfDate](date,null,{timezone:false});}catch(err){return false;}}
_parseInput(inputValue){try{return field_utils.parse[this.typeOfDate](inputValue,null,{timezone:false});}catch(err){return false;}}
_onDateTimePickerHide(){if(this.ignoreBootstrapEvents){return;}
const date=this._parseInput(this.inputRef.el.value);this.state.warning=date.format('YYYY-MM-DD')>moment().format('YYYY-MM-DD');this.trigger('datetime-changed',{date});}
_onDateTimePickerShow(){if(this.ignoreBootstrapEvents){return;}
this.inputRef.el.select();}
_onInputClick(){this._datetimepicker('toggle');}
_onInputChange(){const date=this._parseInput(this.inputRef.el.value);if(date){this.state.warning=date.format('YYYY-MM-DD')>moment().format('YYYY-MM-DD');this.trigger('datetime-changed',{date});}else{this.inputRef.el.value=this._formatDate(this.props.date);}}
_onWindowScroll(ev){if(ev.target!==this.inputRef.el){this._datetimepicker('hide');}}}
DatePicker.defaultProps={calendarWeeks:true,icons:{clear:'fa fa-delete',close:'fa fa-check primary',date:'fa fa-calendar',down:'fa fa-chevron-down',next:'fa fa-chevron-right',previous:'fa fa-chevron-left',time:'fa fa-clock-o',today:'fa fa-calendar-check-o',up:'fa fa-chevron-up',},get locale(){return moment.locale();},maxDate:moment({y:9999,M:11,d:31}),minDate:moment({y:1000}),useCurrent:false,widgetParent:'body',};DatePicker.props={date:moment,buttons:{type:Object,shape:{showClear:Boolean,showClose:Boolean,showToday:Boolean,},optional:1,},calendarWeeks:Boolean,format:{type:String,optional:1},icons:{type:Object,shape:{clear:String,close:String,date:String,down:String,next:String,previous:String,time:String,today:String,up:String,},},keyBinds:{validate:kb=>typeof kb==='object'||kb===null,optional:1},locale:String,maxDate:moment,minDate:moment,readonly:{type:Boolean,optional:1},useCurrent:Boolean,widgetParent:String,};DatePicker.template='web.DatePicker';class DateTimePicker extends DatePicker{constructor(){super(...arguments);this.typeOfDate='datetime';}
get defaultFormat(){return time.getLangDatetimeFormat();}}
DateTimePicker.defaultProps=Object.assign(Object.create(DatePicker.defaultProps),{buttons:{showClear:false,showClose:true,showToday:false,},});return{DatePicker,DateTimePicker,};});;

/* /web/static/src/js/components/pager.js defined in bundle 'web.assets_backend' */
odoo.define('web.Pager',function(require){"use strict";const{useAutofocus}=require('web.custom_hooks');const{Component,hooks}=owl;const{useState}=hooks;class Pager extends Component{constructor(){super(...arguments);this.state=useState({disabled:false,editing:false,});useAutofocus();}
async willUpdateProps(){this.state.editing=false;this.state.disabled=false;}
get maximum(){return Math.min(this.props.currentMinimum+this.props.limit-1,this.props.size);}
get singlePage(){return(1===this.props.currentMinimum)&&(this.maximum===this.props.size);}
get value(){return this.props.currentMinimum+(this.props.limit>1?`-${this.maximum}`:'');}
async _changeSelection(direction){try{await this.props.validate();}catch(err){return;}
const{limit,size}=this.props;let currentMinimum=(this.props.currentMinimum+limit*direction);if(currentMinimum>size){currentMinimum=1;}else if((currentMinimum<1)&&(limit===1)){currentMinimum=size;}else if((currentMinimum<1)&&(limit>1)){currentMinimum=size-((size%limit)||limit)+1;}
this._updateAndDisable(currentMinimum,limit);}
async _saveValue(value){try{await this.props.validate();}catch(err){return;}
const[min,max]=value.trim().split(/\s*[\-\s,;]\s*/);let currentMinimum=Math.max(Math.min(parseInt(min,10),this.props.size),1);let maximum=max?Math.max(Math.min(parseInt(max,10),this.props.size),1):min;if(!isNaN(currentMinimum)&&!isNaN(maximum)&&currentMinimum<=maximum){const limit=Math.max(maximum-currentMinimum)+1;this._updateAndDisable(currentMinimum,limit);}}
_updateAndDisable(currentMinimum,limit){if(currentMinimum!==this.props.currentMinimum||limit!==this.props.limit){this.state.disabled=true;}else{this.state.editing=false;}
this.trigger('pager-changed',{currentMinimum,limit});}
_onEdit(){if(this.props.editable&&!this.state.editing&&!this.state.disabled){this.state.editing=true;}}
_onValueChange(ev){this._saveValue(ev.currentTarget.value);if(!this.state.disabled){ev.preventDefault();}}
_onValueKeydown(ev){switch(ev.key){case'Enter':ev.preventDefault();ev.stopPropagation();this._saveValue(ev.currentTarget.value);break;case'Escape':ev.preventDefault();ev.stopPropagation();this.state.editing=false;break;}}}
Pager.defaultProps={editable:true,validate:async()=>{},withAccessKey:true,};Pager.props={currentMinimum:{type:Number,optional:1},editable:Boolean,limit:{validate:l=>!isNaN(l),optional:1},size:{type:Number,optional:1},validate:Function,withAccessKey:Boolean,};Pager.template='web.Pager';return Pager;});;

/* /web/static/src/js/apps.js defined in bundle 'web.assets_backend' */
odoo.define('web.Apps',function(require){"use strict";var AbstractAction=require('web.AbstractAction');var config=require('web.config');var core=require('web.core');var framework=require('web.framework');var session=require('web.session');var _t=core._t;var apps_client=null;var Apps=AbstractAction.extend({contentTemplate:'EmptyComponent',remote_action_tag:'loempia.embed',failback_action_id:'base.open_module_tree',init:function(parent,action){this._super(parent,action);var options=action.params||{};this.params=options;},get_client:function(){var check_client_available=function(client){var i=new Image();var def=new Promise(function(resolve,reject){i.onerror=function(){reject(client);};i.onload=function(){resolve(client);};});var ts=new Date().getTime();i.src=_.str.sprintf('%s/web/static/src/img/sep-a.gif?%s',client.origin,ts);return def;};if(apps_client){return check_client_available(apps_client);}else{return this._rpc({model:'ir.module.module',method:'get_apps_server'}).then(function(u){var link=$(_.str.sprintf('<a href="%s"></a>',u))[0];var host=_.str.sprintf('%s//%s',link.protocol,link.host);var dbname=link.pathname;if(dbname[0]==='/'){dbname=dbname.substr(1);}
var client={origin:host,dbname:dbname};apps_client=client;return check_client_available(client);});}},destroy:function(){$(window).off("message."+this.uniq);if(this.$ifr){this.$ifr.remove();this.$ifr=null;}
return this._super();},_on_message:function($e){var self=this,client=this.client,e=$e.originalEvent;if(e.origin!==client.origin){return;}
var dispatcher={'event':function(m){self.trigger('message:'+m.event,m);},'action':function(m){self.do_action(m.action).then(function(r){var w=self.$ifr[0].contentWindow;w.postMessage({id:m.id,result:r},client.origin);});},'rpc':function(m){return self._rpc({route:m.args[0],params:m.args[1]}).then(function(r){var w=self.$ifr[0].contentWindow;w.postMessage({id:m.id,result:r},client.origin);});},'Model':function(m){return self._rpc({model:m.model,method:m.args[0],args:m.args[1]}).then(function(r){var w=self.$ifr[0].contentWindow;w.postMessage({id:m.id,result:r},client.origin);});},};if(!_.isObject(e.data)){return;}
if(dispatcher[e.data.type]){dispatcher[e.data.type](e.data);}},start:function(){var self=this;return new Promise(function(resolve,reject){self.get_client().then(function(client){self.client=client;var qs={db:client.dbname};if(config.isDebug()){qs.debug=odoo.debug;}
var u=$.param.querystring(client.origin+"/apps/embed/client",qs);var css={width:'100%',height:'750px'};self.$ifr=$('<iframe>').attr('src',u);self.uniq=_.uniqueId('apps');$(window).on("message."+self.uniq,self.proxy('_on_message'));self.on('message:ready',self,function(m){var w=this.$ifr[0].contentWindow;var act={type:'ir.actions.client',tag:this.remote_action_tag,params:_.extend({},this.params,{db:session.db,origin:session.origin,})};w.postMessage({type:'action',action:act},client.origin);});self.on('message:set_height',self,function(m){this.$ifr.height(m.height);});self.on('message:blockUI',self,function(){framework.blockUI();});self.on('message:unblockUI',self,function(){framework.unblockUI();});self.on('message:warn',self,function(m){self.do_warn(m.title,m.message,m.sticky);});self.$ifr.appendTo(self.$('.o_content')).css(css).addClass('apps-client');resolve();},function(){self.do_warn(_t('Odoo Apps will be available soon'),_t('Showing locally available modules'),true);return self._rpc({route:'/web/action/load',params:{action_id:self.failback_action_id},}).then(function(action){return self.do_action(action);}).then(reject,reject);});});}});var AppsUpdates=Apps.extend({remote_action_tag:'loempia.embed.updates',});core.action_registry.add("apps",Apps);core.action_registry.add("apps.updates",AppsUpdates);return Apps;});;

/* /web/static/src/js/_deprecated/basic_fields.js defined in bundle 'web.assets_backend' */
odoo.define('web.basic_fields.deprecated',function(require){"use strict";var AbstractField=require('web.AbstractField');var core=require('web.core');var _lt=core._lt;var FieldBoolean=AbstractField.extend({className:'o_field_boolean',description:_lt("Checkbox"),events:_.extend({},AbstractField.prototype.events,{change:'_onChange',}),supportedFieldTypes:['boolean'],activate:function(options){var activated=this._super.apply(this,arguments);if(activated&&options&&options.event&&$(options.event.target).closest('.custom-control.custom-checkbox').length){this._setValue(!this.value);}
return activated;},getFocusableElement:function(){return this.mode==='readonly'?$():this.$input;},isSet:function(){return true;},reset:function(record,event){var rendered=this._super.apply(this,arguments);if(event&&event.target.name===this.name){this.activate();}
return rendered;},setIDForLabel:function(id){this._super.apply(this,arguments);this.$('.custom-control-label').attr('for',id);},_render:function(){var $checkbox=this._formatValue(this.value);this.$input=$checkbox.find('input');this.$input.prop('disabled',this.mode==='readonly');this.$el.addClass($checkbox.attr('class'));this.$el.empty().append($checkbox.contents());},_onChange:function(){this._setValue(this.$input[0].checked);},_onKeydown:function(ev){switch(ev.which){case $.ui.keyCode.ENTER:ev.preventDefault();this.$input.prop('checked',!this.value);this._setValue(!this.value);return;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:ev.preventDefault();}
this._super.apply(this,arguments);},});return{FieldBoolean:FieldBoolean,};});;

/* /web/static/src/js/fields/abstract_field.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractField',function(require){"use strict";var field_utils=require('web.field_utils');var Widget=require('web.Widget');var AbstractField=Widget.extend({events:{'keydown':'_onKeydown',},custom_events:{navigation_move:'_onNavigationMove',},fieldDependencies:{},resetOnAnyFieldChange:false,specialData:false,supportedFieldTypes:[],description:"",noLabel:false,label:'',init:function(parent,name,record,options){this._super(parent);options=options||{};this.name=name;this.record=record;this.field=record.fields[name];this.viewType=options.viewType||'default';var fieldsInfo=record.fieldsInfo[this.viewType];this.attrs=options.attrs||(fieldsInfo&&fieldsInfo[name])||{};this.additionalContext=options.additionalContext||{};this.value=record.data[name];this.recordData=record.data;this.string=this.attrs.string||this.field.string||this.name;this.nodeOptions=this.attrs.options||{};this.dataPointID=record.id;this.res_id=record.res_id;this.model=record.model;this.mode=options.mode||"readonly";this._isValid=true;this.lastSetValue=undefined;this.formatType=this.attrs.widget in field_utils.format?this.attrs.widget:this.field.type;this.formatOptions={};this.parseOptions={};if(this.attrs.decorations){this.resetOnAnyFieldChange=true;}},start:function(){var self=this;return this._super.apply(this,arguments).then(function(){self.$el.attr('name',self.name);self.$el.addClass('o_field_widget');return self._render();});},activate:function(options){if(this.isFocusable()){var $focusable=this.getFocusableElement();$focusable.focus();if($focusable.is('input[type="text"], textarea')){$focusable[0].selectionStart=$focusable[0].selectionEnd=$focusable[0].value.length;if(options&&!options.noselect){$focusable.select();}}
return true;}
return false;},commitChanges:function(){},getFocusableElement:function(){return $();},isEmpty:function(){return!this.isSet();},isFocusable:function(){var $focusable=this.getFocusableElement();return $focusable.length&&$focusable.is(':visible');},isSet:function(){return!!this.value;},isValid:function(){return this._isValid;},reset:function(record,event){this._reset(record,event);return this._render()||Promise.resolve();},removeInvalidClass:function(){this.$el.removeClass('o_field_invalid');this.$el.removeAttr('aria-invalid');},setIDForLabel:function(id){this.getFocusableElement().attr('id',id);},setInvalidClass:function(){this.$el.addClass('o_field_invalid');this.$el.attr('aria-invalid','true');},updateModifiersValue:function(modifiers){this.attrs.modifiersValue=modifiers||{};},_applyDecorations:function(){var self=this;this.attrs.decorations.forEach(function(dec){var isToggled=py.PY_isTrue(py.evaluate(dec.expression,self.record.evalContext));const className=self._getClassFromDecoration(dec.name);self.$el.toggleClass(className,isToggled);});},_formatValue:function(value,formatType){var options=_.extend({},this.nodeOptions,{data:this.recordData},this.formatOptions);return field_utils.format[formatType||this.formatType](value,this.field,options);},_getClassFromDecoration:function(decoration){return`text-${decoration.split('-')[1]}`;},_isLastSetValue:function(value){return this.lastSetValue===value||(this.value===false&&value==='');},_isSameValue:function(value){return this.value===value;},_parseValue:function(value){return field_utils.parse[this.formatType](value,this.field,this.parseOptions);},_render:function(){if(this.attrs.decorations){this._applyDecorations();}
if(this.mode==='edit'){return this._renderEdit();}else if(this.mode==='readonly'){return this._renderReadonly();}},_renderEdit:function(){},_renderReadonly:function(){},_reset:function(record,event){this.lastSetValue=undefined;this.record=record;this.value=record.data[this.name];this.recordData=record.data;},_setValue:function(value,options){if(this._isLastSetValue(value)){return Promise.resolve();}
this.lastSetValue=value;try{value=this._parseValue(value);this._isValid=true;}catch(e){this._isValid=false;this.trigger_up('set_dirty',{dataPointID:this.dataPointID});return Promise.reject({message:"Value set is not valid"});}
if(!(options&&options.forceChange)&&this._isSameValue(value)){return Promise.resolve();}
var self=this;return new Promise(function(resolve,reject){var changes={};changes[self.name]=value;self.trigger_up('field_changed',{dataPointID:self.dataPointID,changes:changes,viewType:self.viewType,doNotSetDirty:options&&options.doNotSetDirty,notifyChange:!options||options.notifyChange!==false,allowWarning:options&&options.allowWarning,onSuccess:resolve,onFailure:reject,});});},_onKeydown:function(ev){switch(ev.which){case $.ui.keyCode.TAB:var event=this.trigger_up('navigation_move',{direction:ev.shiftKey?'previous':'next',});if(event.is_stopped()){ev.preventDefault();ev.stopPropagation();}
break;case $.ui.keyCode.ENTER:ev.preventDefault();ev.stopPropagation();this.trigger_up('navigation_move',{direction:'next_line'});break;case $.ui.keyCode.ESCAPE:this.trigger_up('navigation_move',{direction:'cancel',originalEvent:ev});break;case $.ui.keyCode.UP:ev.stopPropagation();this.trigger_up('navigation_move',{direction:'up'});break;case $.ui.keyCode.RIGHT:ev.stopPropagation();this.trigger_up('navigation_move',{direction:'right'});break;case $.ui.keyCode.DOWN:ev.stopPropagation();this.trigger_up('navigation_move',{direction:'down'});break;case $.ui.keyCode.LEFT:ev.stopPropagation();this.trigger_up('navigation_move',{direction:'left'});break;}},_onNavigationMove:function(ev){ev.data.target=this;},});return AbstractField;});;

/* /web/static/src/js/fields/basic_fields.js defined in bundle 'web.assets_backend' */
odoo.define('web.basic_fields',function(require){"use strict";var AbstractField=require('web.AbstractField');var config=require('web.config');var core=require('web.core');var datepicker=require('web.datepicker');var deprecatedFields=require('web.basic_fields.deprecated');var dom=require('web.dom');var Domain=require('web.Domain');var DomainSelector=require('web.DomainSelector');var DomainSelectorDialog=require('web.DomainSelectorDialog');var framework=require('web.framework');var py_utils=require('web.py_utils');var session=require('web.session');var utils=require('web.utils');var view_dialogs=require('web.view_dialogs');var field_utils=require('web.field_utils');var time=require('web.time');const{ColorpickerDialog}=require('web.Colorpicker');let FieldBoolean=deprecatedFields.FieldBoolean;require("web.zoomodoo");var qweb=core.qweb;var _t=core._t;var _lt=core._lt;var TranslatableFieldMixin={_renderTranslateButton:function(){if(_t.database.multi_lang&&this.field.translate){var lang=_t.database.parameters.code.split('_')[0].toUpperCase();return $(`<span class="o_field_translate btn btn-link">${lang}</span>`).on('click',this._onTranslate.bind(this));}
return $();},_onTranslate:function(ev){ev.preventDefault();this.trigger_up('translate',{fieldName:this.name,id:this.dataPointID,isComingFromTranslationAlert:false,});},};var DebouncedField=AbstractField.extend({DEBOUNCE:1000000000,init:function(){this._super.apply(this,arguments);this._isDirty=false;if(this.mode==='edit'){if(this.DEBOUNCE){this._doDebouncedAction=_.debounce(this._doAction,this.DEBOUNCE);}else{this._doDebouncedAction=this._doAction;}
var self=this;var debouncedFunction=this._doDebouncedAction;this._doDebouncedAction=function(){self._isDirty=true;debouncedFunction.apply(self,arguments);};}},commitChanges:function(){if(this._isDirty&&this.mode==='edit'){return this._doAction();}},_doAction:function(){if(!this.isDestroyed()){return this._setValue(this._getValue());}},_getValue:function(){},_onBlur:function(){},});var InputField=DebouncedField.extend({custom_events:_.extend({},DebouncedField.prototype.custom_events,{field_changed:'_onFieldChanged',}),events:_.extend({},DebouncedField.prototype.events,{'input':'_onInput','change':'_onChange','blur':'_onBlur',}),init:function(){this._super.apply(this,arguments);this.nodeOptions.isPassword='password'in this.attrs;if(this.mode==='edit'){this.tagName='input';}
this.isDirty=false;this.lastChangeEvent=undefined;},getFocusableElement:function(){return this.$input||$();},reset:function(record,event){this._reset(record,event);if(!event||event===this.lastChangeEvent){this.isDirty=false;}
if(this.isDirty||(event&&event.target===this&&event.data.changes&&event.data.changes[this.name]===this.value)){if(this.attrs.decorations){this._applyDecorations();}
return Promise.resolve();}else{return this._render();}},_getValue:function(){return this.$input.val();},_prepareInput:function($input){this.$input=$input||$("<input/>");this.$input.addClass('o_input');var inputAttrs={placeholder:this.attrs.placeholder||""};var inputVal;if(this.nodeOptions.isPassword){inputAttrs=_.extend(inputAttrs,{type:'password',autocomplete:this.attrs.autocomplete||'new-password'});inputVal=this.value||'';}else{inputAttrs=_.extend(inputAttrs,{type:'text',autocomplete:this.attrs.autocomplete||'off'});inputVal=this._formatValue(this.value);}
this.$input.attr(inputAttrs);this.$input.val(inputVal);return this.$input;},_renderEdit:function(){this._prepareInput(this.$el);},_renderReadonly:function(){this.$el.text(this._formatValue(this.value));},_onChange:function(){this._doAction();},_onFieldChanged:function(event){this.lastChangeEvent=event;},_onInput:function(){this.isDirty=!this._isLastSetValue(this.$input.val());this._doDebouncedAction();},_onNavigationMove:function(ev){this._super.apply(this,arguments);if(this.mode==='edit'&&ev.data.direction!=='cancel'){var input=this.$input[0];var selecting=(input.selectionEnd!==input.selectionStart);if((ev.data.direction==="left"&&(selecting||input.selectionStart!==0))||(ev.data.direction==="right"&&(selecting||input.selectionStart!==input.value.length))){ev.stopPropagation();}
if(ev.data.direction==='next'&&this.attrs.modifiersValue&&this.attrs.modifiersValue.required&&this.viewType!=='list'){if(!this.$input.val()){this.setInvalidClass();ev.stopPropagation();}else{this.removeInvalidClass();}}}},});var NumericField=InputField.extend({tagName:'span',init(){this._super.apply(this,arguments);this.shouldFormat=Boolean(JSON.parse('format'in this.nodeOptions?this.nodeOptions.format:true));},isSet:function(){return this.value===0||this._super.apply(this,arguments);},_evalFormula:function(expr,context){var val=expr.replace(new RegExp(/( )/g),'');var safeEvalString='';for(let v of val.split(new RegExp(/([-+*/()^])/g))){if(!['+','-','*','/','(',')','^'].includes(v)&&v.length){v=field_utils.parse.float(v);}
if(v==='^'){v='**';}
safeEvalString+=v;};return py_utils.py_eval(safeEvalString,context);},_formatValue:function(value){if(!this.shouldFormat||(this.mode==='edit'&&this.nodeOptions.type==='number')){return value;}
return this._super.apply(this,arguments);},_parseValue:function(value){if(this.mode==='edit'&&this.nodeOptions.type==='number'){return Number(value);}
return this._super.apply(this,arguments);},_prepareInput:function($input){var result=this._super.apply(this,arguments);if(this.nodeOptions.type==='number'){this.$input.attr({type:'number'});}
if(this.nodeOptions.step){this.$input.attr({step:this.nodeOptions.step});}
return result;},_setValue:function(value,options){var originalValue=value;value=value.trim();if(value.startsWith('=')){try{value=this._evalFormula(value.substr(1));value=this._formatValue(value);this.$input.val(value);}catch(err){value=originalValue;}}
return this._super(value,options);},});var FieldChar=InputField.extend(TranslatableFieldMixin,{description:_lt("Text"),className:'o_field_char',tagName:'span',supportedFieldTypes:['char'],_renderEdit:function(){var def=this._super.apply(this,arguments);if(this.field.size&&this.field.size>0){this.$el.attr('maxlength',this.field.size);}
if(this.field.translate){this.$el=this.$el.add(this._renderTranslateButton());this.$el.addClass('o_field_translate');}
return def;},_setValue:function(value,options){if(this.field.trim){value=value.trim();}
return this._super(value,options);},});var LinkButton=AbstractField.extend({events:_.extend({},AbstractField.prototype.events,{'click':'_onClick'}),_render:function(){if(this.value){var className=this.attrs.icon||'fa-globe';this.$el.html("<span role='img'/>");this.$el.addClass("fa "+className);this.$el.attr('title',this.value);this.$el.attr('aria-label',this.value);}},_onClick:function(event){event.stopPropagation();window.open(this.value,'_blank');},});var FieldDateRange=InputField.extend({className:'o_field_date_range',tagName:'span',jsLibs:['/web/static/lib/daterangepicker/daterangepicker.js','/web/static/src/js/libs/daterangepicker.js',],cssLibs:['/web/static/lib/daterangepicker/daterangepicker.css',],supportedFieldTypes:['date','datetime'],init:function(){this._super.apply(this,arguments);this.isDateField=this.formatType==='date';this.dateRangePickerOptions=_.defaults({},this.nodeOptions.picker_options||{},{timePicker:!this.isDateField,timePicker24Hour:_t.database.parameters.time_format.search('%H')!==-1,autoUpdateInput:false,timePickerIncrement:5,locale:{applyLabel:_t('Apply'),cancelLabel:_t('Cancel'),format:this.isDateField?time.getLangDateFormat():time.getLangDatetimeFormat(),},});this.relatedEndDate=this.nodeOptions.related_end_date;this.relatedStartDate=this.nodeOptions.related_start_date;},destroy:function(){if(this.$pickerContainer){this.$pickerContainer.remove();}
if(this._onScroll){window.removeEventListener('scroll',this._onScroll,true);}
this._super.apply(this,arguments);},isValid:function(){const value=this.mode==="readonly"?this.value:this.$input.val();try{return field_utils.parse[this.formatType](value,this.field,{timezone:true})||true;}catch(error){return false;}},_getValue:function(){try{this.removeInvalidClass();return field_utils.parse[this.formatType](this.$input.val(),this.field,{timezone:true});}catch(error){this.setInvalidClass();return false;}},_applyChanges:function(ev,picker){var changes={};var displayStartDate=field_utils.format[this.formatType](picker.startDate,{},{timezone:false});var displayEndDate=field_utils.format[this.formatType](picker.endDate,{},{timezone:false});var changedStartDate=picker.startDate;var changedEndDate=picker.endDate;if(this.isDateField){changedStartDate=picker.startDate.add(session.getTZOffset(picker.startDate),'minutes');changedEndDate=picker.endDate.startOf('day').add(session.getTZOffset(picker.endDate),'minutes');}
if(this.relatedEndDate){this.$el.val(displayStartDate);changes[this.name]=this._parseValue(changedStartDate);changes[this.relatedEndDate]=this._parseValue(changedEndDate);}
if(this.relatedStartDate){this.$el.val(displayEndDate);changes[this.name]=this._parseValue(changedEndDate);changes[this.relatedStartDate]=this._parseValue(changedStartDate);}
this.trigger_up('field_changed',{dataPointID:this.dataPointID,viewType:this.viewType,changes:changes,});},_renderEdit:function(){this._super.apply(this,arguments);var self=this;var startDate;var endDate;if(this.relatedEndDate){startDate=this._formatValue(this.value);endDate=this._formatValue(this.recordData[this.relatedEndDate]);}
if(this.relatedStartDate){startDate=this._formatValue(this.recordData[this.relatedStartDate]);endDate=this._formatValue(this.value);}
this.dateRangePickerOptions.startDate=startDate||moment();this.dateRangePickerOptions.endDate=endDate||moment();this.$el.daterangepicker(this.dateRangePickerOptions);this.$el.on('apply.daterangepicker',this._applyChanges.bind(this));this.$el.on('show.daterangepicker',this._onDateRangePickerShow.bind(this));this.$el.on('hide.daterangepicker',this._onDateRangePickerHide.bind(this));this.$el.off('keyup.daterangepicker');this.$pickerContainer=this.$el.data('daterangepicker').container;this.$pickerContainer.on('click',function(ev){ev.stopPropagation();if($(ev.target).hasClass('applyBtn')){self.$el.data('daterangepicker').hide();}});this.$pickerContainer.on('focusin.bs.modal','select',function(ev){ev.stopPropagation();});},_onDateRangePickerHide(){if(this._onScroll){window.removeEventListener('scroll',this._onScroll,true);}},_onDateRangePickerShow(){this._onScroll=ev=>{if(!config.device.isMobile&&!this.$pickerContainer.get(0).contains(ev.target)){this.$el.data('daterangepicker').hide();}};window.addEventListener('scroll',this._onScroll,true);},});var FieldDate=InputField.extend({description:_lt("Date"),className:"o_field_date",tagName:"span",supportedFieldTypes:['date','datetime'],events:AbstractField.prototype.events,init:function(){this._super.apply(this,arguments);this.formatOptions.timezone=true;this.datepickerOptions=_.defaults({},this.nodeOptions.datepicker||{},{defaultDate:this.value});},start:function(){var self=this;var prom;if(this.mode==='edit'){this.datewidget=this._makeDatePicker();this.datewidget.on('datetime_changed',this,function(){var value=this._getValue();if((!value&&this.value)||(value&&!this._isSameValue(value))){this._setValue(value);}});prom=this.datewidget.appendTo('<div>').then(function(){self.datewidget.$el.addClass(self.$el.attr('class'));self._prepareInput(self.datewidget.$input);self._replaceElement(self.datewidget.$el);});}
return Promise.resolve(prom).then(this._super.bind(this));},activate:function(){if(this.isFocusable()&&this.datewidget){this.datewidget.$input.select();return true;}
return false;},_doDebouncedAction:function(){this.datewidget.changeDatetime();},_getValue:function(){return this.datewidget.getValue();},_isSameValue:function(value){if(value===false){return this.value===false;}
return value.isSame(this.value,'day');},_makeDatePicker:function(){return new datepicker.DateWidget(this,this.datepickerOptions);},_renderEdit:function(){this.datewidget.setValue(this.value);this.$input=this.datewidget.$input;},async _onKeydown(ev){this._super(...arguments);if(ev.which===$.ui.keyCode.ENTER){await this._setValue(this.$input.val());this._render();}},});var FieldDateTime=FieldDate.extend({description:_lt("Date & Time"),supportedFieldTypes:['datetime'],init:function(){this._super.apply(this,arguments);if(this.value){var offset=this.getSession().getTZOffset(this.value);var displayedValue=this.value.clone().add(offset,'minutes');this.datepickerOptions.defaultDate=displayedValue;}},_getValue:function(){var value=this.datewidget.getValue();return value&&value.add(-this.getSession().getTZOffset(value),'minutes');},_isSameValue:function(value){if(value===false){return this.value===false;}
return value.isSame(this.value);},_makeDatePicker:function(){return new datepicker.DateTimeWidget(this,this.datepickerOptions);},_renderEdit:function(){var value=this.value&&this.value.clone().add(this.getSession().getTZOffset(this.value),'minutes');this.datewidget.setValue(value);this.$input=this.datewidget.$input;},});const RemainingDays=AbstractField.extend({description:_lt("Remaining Days"),supportedFieldTypes:['date','datetime'],_render(){if(this.value===false){this.$el.removeClass('text-bf text-danger text-warning');return;}
const nowUTC=moment().utc();const nowUserTZ=nowUTC.clone().add(session.getTZOffset(nowUTC),'minutes');const fieldValue=this.field.type=="datetime"?this.value.clone().add(session.getTZOffset(this.value),'minutes'):this.value;const diffDays=fieldValue.startOf('day').diff(nowUserTZ.startOf('day'),'days');let text;if(Math.abs(diffDays)>99){text=this._formatValue(this.value,'date');}else if(diffDays===0){text=_t("Today");}else if(diffDays<0){text=diffDays===-1?_t("Yesterday"):_.str.sprintf(_t('%s days ago'),-diffDays);}else{text=diffDays===1?_t("Tomorrow"):_.str.sprintf(_t('In %s days'),diffDays);}
this.$el.text(text).attr('title',this._formatValue(this.value,'date'));this.$el.toggleClass('text-bf',diffDays<=0);this.$el.toggleClass('text-danger',diffDays<0);this.$el.toggleClass('text-warning',diffDays===0);},});var FieldMonetary=NumericField.extend({description:_lt("Monetary"),className:'o_field_monetary o_field_number',tagName:'span',supportedFieldTypes:['float','monetary'],resetOnAnyFieldChange:true,init:function(){this._super.apply(this,arguments);this._setCurrency();if(this.mode==='edit'){this.tagName='div';this.className+=' o_input';this.formatOptions.noSymbol=true;}
this.formatOptions.currency=this.currency;this.formatOptions.digits=[16,2];this.formatOptions.field_digits=this.nodeOptions.field_digits;},isSet:function(){return this.value===0||this._super.apply(this,arguments);},_renderEdit:function(){this.$el.empty();var def=this._prepareInput(this.$input).appendTo(this.$el);if(this.currency){var $currencySymbol=$('<span>',{text:this.currency.symbol});if(this.currency.position==="after"){this.$el.append($currencySymbol);}else{this.$el.prepend($currencySymbol);}}
return def;},_renderReadonly:function(){this.$el.html(this._formatValue(this.value));},_reset:function(){this._super.apply(this,arguments);this._setCurrency();},_setCurrency:function(){var currencyField=this.nodeOptions.currency_field||this.field.currency_field||'currency_id';var currencyID=this.record.data[currencyField]&&this.record.data[currencyField].res_id;this.currency=session.get_currency(currencyID);this.formatOptions.currency=this.currency;},});var FieldInteger=NumericField.extend({description:_lt("Integer"),className:'o_field_integer o_field_number',supportedFieldTypes:['integer'],_formatValue:function(value){if(typeof value==='string'){if(!/^[0-9]+-/.test(value)){throw new Error('"'+value+'" is not an integer or a virtual id');}
return value;}
return this._super.apply(this,arguments);},});var FieldFloat=NumericField.extend({description:_lt("Decimal"),className:'o_field_float o_field_number',supportedFieldTypes:['float'],init:function(){this._super.apply(this,arguments);if(this.attrs.digits){this.nodeOptions.digits=JSON.parse(this.attrs.digits);}},});var FieldFloatTime=FieldFloat.extend({description:_lt("Time"),formatType:'float_time',init:function(){this._super.apply(this,arguments);this.formatType='float_time';}});var FieldFloatFactor=FieldFloat.extend({supportedFieldTypes:['float'],className:'o_field_float_factor',formatType:'float_factor',init:function(){this._super.apply(this,arguments);if(!this.nodeOptions.factor){this.nodeOptions.factor=1;}
this.parseOptions=this.nodeOptions;}});var FieldFloatToggle=AbstractField.extend({supportedFieldTypes:['float'],formatType:'float_factor',className:'o_field_float_toggle',tagName:'span',events:{click:'_onClick'},init:function(){this._super.apply(this,arguments);this.formatType='float_factor';if(this.mode==='edit'){this.tagName='button';}
if(this.attrs.digits){this.nodeOptions.digits=JSON.parse(this.attrs.digits);}
if(!this.nodeOptions.factor){this.nodeOptions.factor=1;}
if(!this.nodeOptions.range){this.nodeOptions.range=[0.0,0.5,1.0];}
this.parseOptions=this.nodeOptions;},_getDisplayedValue:function(){var usrFormatValue=this._formatValue(this.value);return field_utils.parse['float'](usrFormatValue);},_renderEdit:function(){this.$el.text(this._formatValue(this.value));},_renderReadonly:function(){this.$el.text(this._formatValue(this.value));},_nextValue:function(){var range=this.nodeOptions.range;var val=utils.closestNumber(this._getDisplayedValue(),range);var index=_.indexOf(range,val);if(index!==-1){if(index+1<range.length){return range[index+1];}}
return range[0];},_onClick:function(ev){if(this.mode==='edit'){ev.stopPropagation();var next_val=this._nextValue();next_val=field_utils.format['float'](next_val);this._setValue(next_val);}},isSet:function(){return this.value===0||this._super(...arguments);},});var FieldPercentage=FieldFloat.extend({className:'o_field_float_percentage o_field_number',description:_lt("Percentage"),init(){this._super(...arguments);if(this.mode==='edit'){this.tagName='div';this.className+=' o_input';this.formatOptions.noSymbol=true;}},_renderEdit(){this.$el.empty();this._prepareInput(this.$input).appendTo(this.$el);const $percentageSymbol=$('<span>',{text:'%'});this.$el.append($percentageSymbol);},});var FieldText=InputField.extend(TranslatableFieldMixin,{description:_lt("Multiline Text"),className:'o_field_text',supportedFieldTypes:['text','html'],tagName:'span',init:function(){this._super.apply(this,arguments);if(this.mode==='edit'){this.tagName='textarea';}
this.autoResizeOptions={parent:this};},start:function(){if(this.mode==='edit'){dom.autoresize(this.$el,this.autoResizeOptions);if(this.field.translate){this.$el=this.$el.add(this._renderTranslateButton());this.$el.addClass('o_field_translate');}}
return this._super();},reset:function(){var self=this;return Promise.resolve(this._super.apply(this,arguments)).then(function(){if(self.mode==='edit'){self.$input.trigger('change');}});},_onKeydown:function(ev){if(ev.which===$.ui.keyCode.ENTER){ev.stopPropagation();return;}
this._super.apply(this,arguments);},});var ListFieldText=FieldText.extend({init:function(){this._super.apply(this,arguments);this.autoResizeOptions.min_height=0;},});var HandleWidget=AbstractField.extend({description:_lt("Handle"),noLabel:true,className:'o_row_handle fa fa-arrows ui-sortable-handle',widthInList:'33px',tagName:'span',supportedFieldTypes:['integer'],isSet:function(){return true;},});var FieldEmail=InputField.extend({description:_lt("Email"),className:'o_field_email',events:_.extend({},InputField.prototype.events,{'click':'_onClick',}),prefix:'mailto',supportedFieldTypes:['char'],init:function(){this._super.apply(this,arguments);this.tagName=this.mode==='readonly'?'a':'input';},getFocusableElement:function(){return this.mode==='readonly'?this.$el:this._super.apply(this,arguments);},_renderReadonly:function(){if(this.value){this.$el.closest("."+this.className).text(this.value).addClass('o_form_uri o_text_overflow').attr('href',this.prefix+':'+this.value);}else{this.$el.text('');}},_setValue:function(value,options){if(this.field.trim){value=value.trim();}
return this._super(value,options);},_onClick:function(ev){ev.stopPropagation();},});var FieldPhone=FieldEmail.extend({description:_lt("Phone"),className:'o_field_phone',prefix:'tel',_renderReadonly:function(){this._super();this.$el.removeClass('o_text_overflow');},});var UrlWidget=InputField.extend({description:_lt("URL"),className:'o_field_url',events:_.extend({},InputField.prototype.events,{'click':'_onClick',}),supportedFieldTypes:['char'],init:function(){this._super.apply(this,arguments);this.tagName=this.mode==='readonly'?'a':'input';this.websitePath=this.nodeOptions.website_path||false;},getFocusableElement:function(){return this.mode==='readonly'?this.$el:this._super.apply(this,arguments);},_renderReadonly:function(){let href=this.value;if(this.value&&!this.websitePath){const regex=/^(?:[fF]|[hH][tT])[tT][pP][sS]?:\/\//;href=!regex.test(this.value)?`http://${href}`:href;}
this.$el.text(this.attrs.text||this.value).addClass('o_form_uri o_text_overflow').attr('target','_blank').attr('href',href);},_onClick:function(ev){ev.stopPropagation();},});var CopyClipboard={destroy:function(){this._super.apply(this,arguments);if(this.clipboard){this.clipboard.destroy();}},_initClipboard:function(){var self=this;var $clipboardBtn=this.$('.o_clipboard_button');$clipboardBtn.tooltip({title:_t('Copied !'),trigger:'manual',placement:'right'});this.clipboard=new ClipboardJS($clipboardBtn[0],{text:function(){return self.value.trim();},container:self.$el[0]});this.clipboard.on('success',function(){_.defer(function(){$clipboardBtn.tooltip('show');_.delay(function(){$clipboardBtn.tooltip('hide');},800);});});},_renderReadonly:function(){this._super.apply(this,arguments);if(this.value){this.$el.append($(qweb.render(this.clipboardTemplate)));this._initClipboard();}}};var TextCopyClipboard=FieldText.extend(CopyClipboard,{description:_lt("Copy to Clipboard"),clipboardTemplate:'CopyClipboardText',className:"o_field_copy",});var CharCopyClipboard=FieldChar.extend(CopyClipboard,{description:_lt("Copy to Clipboard"),clipboardTemplate:'CopyClipboardChar',className:'o_field_copy o_text_overflow',});var AbstractFieldBinary=AbstractField.extend({events:_.extend({},AbstractField.prototype.events,{'change .o_input_file':'on_file_change','click .o_select_file_button':function(){this.$('.o_input_file').click();},'click .o_clear_file_button':'_onClearClick',}),init:function(parent,name,record){this._super.apply(this,arguments);this.fields=record.fields;this.useFileAPI=!!window.FileReader;this.max_upload_size=session.max_file_upload_size||128*1024*1024;this.accepted_file_extensions=(this.nodeOptions&&this.nodeOptions.accepted_file_extensions)||this.accepted_file_extensions||'*';if(!this.useFileAPI){var self=this;this.fileupload_id=_.uniqueId('o_fileupload');$(window).on(this.fileupload_id,function(){var args=[].slice.call(arguments).slice(1);self.on_file_uploaded.apply(self,args);});}},destroy:function(){if(this.fileupload_id){$(window).off(this.fileupload_id);}
this._super.apply(this,arguments);},on_file_change:function(e){var self=this;var file_node=e.target;if((this.useFileAPI&&file_node.files.length)||(!this.useFileAPI&&$(file_node).val()!=='')){if(this.useFileAPI){var file=file_node.files[0];if(file.size>this.max_upload_size){var msg=_t("The selected file exceed the maximum file size of %s.");this.do_warn(_t("File upload"),_.str.sprintf(msg,utils.human_size(this.max_upload_size)));return false;}
utils.getDataURLFromFile(file).then(function(data){data=data.split(',')[1];self.on_file_uploaded(file.size,file.name,file.type,data);});}else{this.$('form.o_form_binary_form').submit();}
this.$('.o_form_binary_progress').show();this.$('button').hide();}},on_file_uploaded:function(size,name){if(size===false){this.do_warn(false,_t("There was a problem while uploading your file"));console.warn("Error while uploading file : ",name);}else{this.on_file_uploaded_and_valid.apply(this,arguments);}
this.$('.o_form_binary_progress').hide();this.$('button').show();},on_file_uploaded_and_valid:function(size,name,content_type,file_base64){this.set_filename(name);this._setValue(file_base64);this._render();},set_filename:function(value){var filename=this.attrs.filename;if(filename&&filename in this.fields){var changes={};changes[filename]=value;this.trigger_up('field_changed',{dataPointID:this.dataPointID,changes:changes,viewType:this.viewType,});}},_clearFile:function(){var self=this;this.$('.o_input_file').val('');this.set_filename('');if(!this.isDestroyed()){this._setValue(false).then(function(){self._render();});}},_onClearClick:function(ev){this._clearFile();},});var FieldBinaryImage=AbstractFieldBinary.extend({description:_lt("Image"),fieldDependencies:_.extend({},AbstractFieldBinary.prototype.fieldDependencies,{__last_update:{type:'datetime'},}),template:'FieldBinaryImage',placeholder:"/web/static/src/img/placeholder.png",events:_.extend({},AbstractFieldBinary.prototype.events,{'click img':function(){if(this.mode==="readonly"){this.trigger_up('bounce_edit');}},}),supportedFieldTypes:['binary'],file_type_magic_word:{'/':'jpg','R':'gif','i':'png','P':'svg+xml',},accepted_file_extensions:'image/*',_getImageUrl:function(model,res_id,field,unique){return session.url('/web/image',{model:model,id:JSON.stringify(res_id),field:field,unique:field_utils.format.datetime(unique).replace(/[^0-9]/g,''),});},_render:function(){var self=this;var url=this.placeholder;if(this.value){if(!utils.is_bin_size(this.value)){url='data:image/'+(this.file_type_magic_word[this.value[0]]||'png')+';base64,'+this.value;}else{var field=this.nodeOptions.preview_image||this.name;var unique=this.recordData.__last_update;url=this._getImageUrl(this.model,this.res_id,field,unique);}}
var $img=$(qweb.render("FieldBinaryImage-img",{widget:this,url:url}));var width=this.nodeOptions.size?this.nodeOptions.size[0]:this.attrs.width;var height=this.nodeOptions.size?this.nodeOptions.size[1]:this.attrs.height;if(width){$img.attr('width',width);$img.css('max-width',width+'px');}
if(height){$img.attr('height',height);$img.css('max-height',height+'px');}
this.$('> img').remove();this.$el.prepend($img);$img.one('error',function(){$img.attr('src',self.placeholder);self.do_warn(false,_t("Could not display the selected image"));});return this._super.apply(this,arguments);},_renderReadonly:function(){this._super.apply(this,arguments);if(this.nodeOptions.zoom){var unique=this.recordData.__last_update;var url=this._getImageUrl(this.model,this.res_id,'image_1920',unique);var $img;var imageField=_.find(Object.keys(this.recordData),function(o){return o.startsWith('image_');});if(this.nodeOptions.background)
{if('tag'in this.nodeOptions){this.tagName=this.nodeOptions.tag;}
if('class'in this.attrs){this.$el.addClass(this.attrs.class);}
const image_field=this.field.manual?this.name:'image_128';var urlThumb=this._getImageUrl(this.model,this.res_id,image_field,unique);this.$el.empty();$img=this.$el;$img.css('backgroundImage','url('+urlThumb+')');}else{$img=this.$('img');}
var zoomDelay=0;if(this.nodeOptions.zoom_delay){zoomDelay=this.nodeOptions.zoom_delay;}
if(this.recordData[imageField]){$img.attr('data-zoom',1);$img.attr('data-zoom-image',url);$img.zoomOdoo({event:'mouseenter',timer:zoomDelay,attach:'.o_content',attachToTarget:true,onShow:function(){var zoomHeight=Math.ceil(this.$zoom.height());var zoomWidth=Math.ceil(this.$zoom.width());if(zoomHeight<128&&zoomWidth<128){this.hide();}
core.bus.on('keydown',this,this.hide);core.bus.on('click',this,this.hide);},beforeAttach:function(){this.$flyout.css({width:'512px',height:'512px'});},preventClicks:this.nodeOptions.preventClicks,});}}},});var CharImageUrl=AbstractField.extend({className:'o_field_image',description:_lt("Image"),supportedFieldTypes:['char'],placeholder:"/web/static/src/img/placeholder.png",_renderReadonly:function(){var self=this;const url=this.value;if(url){var $img=$(qweb.render("FieldBinaryImage-img",{widget:this,url:url}));const width=this.nodeOptions.size?this.nodeOptions.size[0]:this.attrs.width;const height=this.nodeOptions.size?this.nodeOptions.size[1]:this.attrs.height;if(width){$img.attr('width',width);$img.css('max-width',width+'px');}
if(height){$img.attr('height',height);$img.css('max-height',height+'px');}
this.$('> img').remove();this.$el.prepend($img);$img.one('error',function(){$img.attr('src',self.placeholder);self.displayNotification({type:'info',message:_t("Could not display the specified image url."),});});}
return this._super.apply(this,arguments);},});var KanbanFieldBinaryImage=FieldBinaryImage.extend({events:{},});var KanbanCharImageUrl=CharImageUrl.extend({events:{},});var FieldBinaryFile=AbstractFieldBinary.extend({description:_lt("File"),template:'FieldBinaryFile',events:_.extend({},AbstractFieldBinary.prototype.events,{'click':function(event){if(this.mode==='readonly'&&this.value&&this.recordData.id){this.on_save_as(event);}},'click .o_input':function(){this.$('.o_input_file').click();},}),supportedFieldTypes:['binary'],init:function(){this._super.apply(this,arguments);this.filename_value=this.recordData[this.attrs.filename];},_renderReadonly:function(){var visible=!!(this.value&&this.res_id);this.$el.empty().css('cursor','not-allowed');this.do_toggle(visible);if(visible){this.$el.css('cursor','pointer').text(this.filename_value||'').prepend($('<span class="fa fa-download"/>'),' ');}},_renderEdit:function(){if(this.value){this.$el.children().removeClass('o_hidden');this.$('.o_select_file_button').first().addClass('o_hidden');this.$('.o_input').eq(0).val(this.filename_value||this.value);}else{this.$el.children().addClass('o_hidden');this.$('.o_select_file_button').first().removeClass('o_hidden');}},set_filename:function(value){this._super.apply(this,arguments);this.filename_value=value;this.$('.o_save_file_button').prop('disabled',true);},on_save_as:function(ev){if(!this.value){this.do_warn(false,_t("The field is empty, there's nothing to save."));ev.stopPropagation();}else if(this.res_id){framework.blockUI();var filename_fieldname=this.attrs.filename;this.getSession().get_file({complete:framework.unblockUI,data:{'model':this.model,'id':this.res_id,'field':this.name,'filename_field':filename_fieldname,'filename':this.recordData[filename_fieldname]||"",'download':true,'data':utils.is_bin_size(this.value)?null:this.value,},error:(error)=>this.call('crash_manager','rpc_error',error),url:'/web/content',});ev.stopPropagation();}},});var FieldPdfViewer=FieldBinaryFile.extend({description:_lt("PDF Viewer"),supportedFieldTypes:['binary'],template:'FieldPdfViewer',accepted_file_extensions:'application/pdf',init:function(){this._super.apply(this,arguments);this.PDFViewerApplication=false;},_disableButtons:function(iframe){$(iframe).contents().find('button#openFile').hide();},_getURI:function(fileURI){var page=this.recordData[this.name+'_page']||1;if(!fileURI){var queryObj={model:this.model,field:this.name,id:this.res_id,};var queryString=$.param(queryObj);fileURI='/web/content?'+queryString;}
fileURI=encodeURIComponent(fileURI);var viewerURL='/web/static/lib/pdfjs/web/viewer.html?file=';return viewerURL+fileURI+'#page='+page;},_render:function(){var self=this;var $pdfViewer=this.$('.o_form_pdf_controls').children().add(this.$('.o_pdfview_iframe'));var $selectUpload=this.$('.o_select_file_button').first();var $iFrame=this.$('.o_pdfview_iframe');$iFrame.on('load',function(){self.PDFViewerApplication=this.contentWindow.window.PDFViewerApplication;self._disableButtons(this);});if(this.mode==="readonly"&&this.value){$iFrame.attr('src',this._getURI());}else{if(this.value){var binSize=utils.is_bin_size(this.value);$pdfViewer.removeClass('o_hidden');$selectUpload.addClass('o_hidden');if(binSize){$iFrame.attr('src',this._getURI());}}else{$pdfViewer.addClass('o_hidden');$selectUpload.removeClass('o_hidden');}}},on_file_change:function(ev){this._super.apply(this,arguments);var files=ev.target.files;if(!files||files.length===0){return;}
var fileURI=URL.createObjectURL(files[0]);if(this.PDFViewerApplication){this.PDFViewerApplication.open(fileURI,0);}else{this.$('.o_pdfview_iframe').attr('src',this._getURI(fileURI));}},on_save_as:function(ev){ev.stopPropagation();},});var PriorityWidget=AbstractField.extend({description:_lt("Priority"),className:"o_priority",attributes:{'role':'radiogroup',},events:{'mouseover > a':'_onMouseOver','mouseout > a':'_onMouseOut','click > a':'_onClick','keydown > a':'_onKeydown',},supportedFieldTypes:['selection'],isSet:function(){return true;},getFocusableElement:function(){var checked=this.$("[aria-checked='true']");return checked.length?checked:this.$("[data-index='1']");},_render:function(){var self=this;var index_value=this.value?_.findIndex(this.field.selection,function(v){return v[0]===self.value;}):0;this.$el.empty();this.empty_value=this.field.selection[0][0];this.$el.attr('aria-label',this.string);const isReadonly=this.record.evalModifiers(this.attrs.modifiers).readonly;_.each(this.field.selection.slice(1),function(choice,index){const tag=isReadonly?'<span>':'<a href="#">';self.$el.append(self._renderStar(tag,index_value>=index+1,index+1,choice[1],index_value));});},_renderStar:function(tag,isFull,index,tip,indexValue){var isChecked=indexValue===index;var defaultFocus=indexValue===0&&index===1;return $(tag).attr('role','radio').attr('aria-checked',isChecked).attr('title',tip).attr('aria-label',tip).attr('tabindex',isChecked||defaultFocus?0:-1).attr('data-index',index).addClass('o_priority_star fa').toggleClass('fa-star',isFull).toggleClass('fa-star-o',!isFull);},_onClick:function(event){event.preventDefault();event.stopPropagation();var index=$(event.currentTarget).data('index');var newValue=this.field.selection[index][0];if(newValue===this.value){newValue=this.empty_value;}
this._setValue(newValue);},_onMouseOut:function(){clearTimeout(this.hoverTimer);var self=this;this.hoverTimer=setTimeout(function(){self._render();},200);},_onMouseOver:function(event){clearTimeout(this.hoverTimer);this.$('.o_priority_star').removeClass('fa-star-o').addClass('fa-star');$(event.currentTarget).nextAll().removeClass('fa-star').addClass('fa-star-o');},_onKeydown:function(event){if(event.which===$.ui.keyCode.ENTER){return;}
this._super.apply(this,arguments);},_onNavigationMove:function(ev){var $curControl=this.$('a:focus');var $nextControl;if(ev.data.direction==='right'||ev.data.direction==='down'){$nextControl=$curControl.next('a');}else if(ev.data.direction==='left'||ev.data.direction==='up'){$nextControl=$curControl.prev('a');}
if($nextControl&&$nextControl.length){ev.stopPropagation();$nextControl.focus();return;}
this._super.apply(this,arguments);},});var AttachmentImage=AbstractField.extend({className:'o_attachment_image',_render:function(){if(this.value){this.$el.empty().append($('<img>/',{src:"/web/image/"+this.value.data.id+"?unique=1",title:this.value.data.display_name,alt:_t("Image")}));}}});var StateSelectionWidget=AbstractField.extend({template:'FormSelection',events:{'click .dropdown-item':'_setSelection',},supportedFieldTypes:['selection'],getFocusableElement:function(){return this.$("a[data-toggle='dropdown']");},_prepareDropdownValues:function(){var self=this;var _data=[];var current_stage_id=self.recordData.stage_id&&self.recordData.stage_id[0];var stage_data={id:current_stage_id,legend_normal:this.recordData.legend_normal||undefined,legend_blocked:this.recordData.legend_blocked||undefined,legend_done:this.recordData.legend_done||undefined,};_.map(this.field.selection||[],function(selection_item){var value={'name':selection_item[0],'tooltip':selection_item[1],};if(selection_item[0]==='normal'){value.state_name=stage_data.legend_normal?stage_data.legend_normal:selection_item[1];}else if(selection_item[0]==='done'){value.state_class='o_status_green';value.state_name=stage_data.legend_done?stage_data.legend_done:selection_item[1];}else{value.state_class='o_status_red';value.state_name=stage_data.legend_blocked?stage_data.legend_blocked:selection_item[1];}
_data.push(value);});return _data;},_render:function(){var states=this._prepareDropdownValues();var currentState=_.findWhere(states,{name:this.value})||states[0];this.$('.o_status').removeClass('o_status_red o_status_green').addClass(currentState.state_class).prop('special_click',true).parent().attr('title',currentState.state_name).attr('aria-label',this.string+": "+currentState.state_name);var $items=$(qweb.render('FormSelection.items',{states:_.without(states,currentState)}));var $dropdown=this.$('.dropdown-menu');$dropdown.children().remove();$items.appendTo($dropdown);var isReadonly=this.record.evalModifiers(this.attrs.modifiers).readonly;this.$('a[data-toggle=dropdown]').toggleClass('disabled',isReadonly||false);},_setSelection:function(ev){ev.preventDefault();var $item=$(ev.currentTarget);var value=String($item.data('value'));this._setValue(value);if(this.mode==='edit'){this._render();}},});var FavoriteWidget=AbstractField.extend({className:'o_favorite',events:{'click':'_setFavorite'},supportedFieldTypes:['boolean'],isSet:function(){return true;},_render:function(){var tip=this.value?_t('Remove from Favorites'):_t('Add to Favorites');var template=this.attrs.nolabel?'<a href="#"><i class="fa %s" title="%s" aria-label="%s" role="img"></i></a>':'<a href="#"><i class="fa %s" role="img" aria-label="%s"></i> %s</a>';this.$el.empty().append(_.str.sprintf(template,this.value?'fa-star':'fa-star-o',tip,tip));},_setFavorite:function(event){event.preventDefault();event.stopPropagation();this._setValue(!this.value);},});var LabelSelection=AbstractField.extend({supportedFieldTypes:['selection'],_render:function(){this.classes=this.nodeOptions&&this.nodeOptions.classes||{};var labelClass=this.classes[this.value]||'primary';this.$el.addClass('badge badge-'+labelClass).text(this._formatValue(this.value));},});var BooleanToggle=FieldBoolean.extend({description:_lt("Toggle"),className:FieldBoolean.prototype.className+' o_boolean_toggle',events:{'click':'_onClick'},_onClick:function(event){event.stopPropagation();this._setValue(!this.value);},});var StatInfo=AbstractField.extend({supportedFieldTypes:['integer','float'],isSet:function(){return true;},_render:function(){var options={value:this._formatValue(this.value||0),};if(!this.attrs.nolabel){if(this.nodeOptions.label_field&&this.recordData[this.nodeOptions.label_field]){options.text=this.recordData[this.nodeOptions.label_field];}else{options.text=this.string;}}
this.$el.html(qweb.render("StatInfo",options));this.$el.addClass('o_stat_info');},});var FieldPercentPie=AbstractField.extend({description:_lt("Percentage Pie"),template:'FieldPercentPie',supportedFieldTypes:['integer','float'],start:function(){this.$leftMask=this.$('.o_mask').first();this.$rightMask=this.$('.o_mask').last();this.$pieValue=this.$('.o_pie_value');return this._super();},isSet:function(){return true;},_render:function(){var value=this.value||0;var degValue=360*value/100;this.$rightMask.toggleClass('o_full',degValue>=180);var leftDeg='rotate('+((degValue<180)?180:degValue)+'deg)';var rightDeg='rotate('+((degValue<180)?degValue:0)+'deg)';this.$leftMask.css({transform:leftDeg,msTransform:leftDeg,mozTransform:leftDeg,webkitTransform:leftDeg});this.$rightMask.css({transform:rightDeg,msTransform:rightDeg,mozTransform:rightDeg,webkitTransform:rightDeg});this.$pieValue.text(Math.round(value)+'%');},});var FieldProgressBar=AbstractField.extend({description:_lt("Progress Bar"),template:"ProgressBar",events:{'change input':'on_change_input','input input':'on_change_input','keyup input':function(e){if(e.which===$.ui.keyCode.ENTER){this.on_change_input(e);}},},supportedFieldTypes:['integer','float'],init:function(){this._super.apply(this,arguments);if(this.recordData[this.nodeOptions.current_value]){this.value=this.recordData[this.nodeOptions.current_value];}
this.editable_readonly=!!this.nodeOptions.editable_readonly;this.readonly=this.nodeOptions.readonly||!this.nodeOptions.editable;this.canWrite=!this.readonly&&(this.mode==='edit'||(this.editable_readonly&&this.mode==='readonly')||(this.viewType==='kanban'));this.edit_max_value=!!this.nodeOptions.edit_max_value;this.max_value=this.recordData[this.nodeOptions.max_value]||100;this.title=_t(this.attrs.title||this.nodeOptions.title)||'';this.enableBarAsInput=false;this.edit_on_click=this.enableBarAsInput&&this.mode==='readonly'&&!this.edit_max_value;this.write_mode=false;},_render:function(){var self=this;this._render_value();if(this.canWrite){if(this.edit_on_click){this.$el.on('click','.o_progress',function(e){var $target=$(e.currentTarget);var numValue=Math.floor((e.pageX-$target.offset().left)/$target.outerWidth()*self.max_value);self.on_update(numValue);self._render_value();});}else{this.$el.on('click',function(){if(!self.write_mode){var $input=$('<input>',{type:'text',class:'o_progressbar_value o_input'});$input.on('blur',self.on_change_input.bind(self));self.$('.o_progressbar_value').replaceWith($input);self.write_mode=true;self._render_value();}});}}
return this._super();},on_update:function(value){if(this.edit_max_value){this.max_value=value;this._isValid=true;var changes={};changes[this.nodeOptions.max_value]=this.max_value;this.trigger_up('field_changed',{dataPointID:this.dataPointID,changes:changes,});}else{var formattedValue=this._formatValue(value);this._setValue(formattedValue);}},on_change_input:function(e){var $input=$(e.target);if(e.type==='change'&&!$input.is(':focus')){return;}
var parsedValue;try{parsedValue=field_utils.parse.float($input.val());}catch(error){this.do_warn(false,_t("Please enter a numerical value"));}
if(parsedValue!==undefined){if(e.type==='input'){this._render_value(parsedValue);if(parsedValue===0){$input.select();}}else{if(this.edit_max_value){parsedValue=parsedValue||100;}
var $div=$('<div>',{class:'o_progressbar_value'});this.$('.o_progressbar_value').replaceWith($div);this.write_mode=false;this.on_update(parsedValue);this._render_value();}}},_render_value:function(v){var value=this.value;var max_value=this.max_value;if(!isNaN(v)){if(this.edit_max_value){max_value=v;}else{value=v;}}
value=value||0;max_value=max_value||0;var widthComplete;if(value<=max_value){widthComplete=value/max_value*100;}else{widthComplete=100;}
this.$('.o_progress').toggleClass('o_progress_overflow',value>max_value).attr('aria-valuemin','0').attr('aria-valuemax',max_value).attr('aria-valuenow',value);this.$('.o_progressbar_complete').css('width',widthComplete+'%');if(!this.write_mode){if(max_value!==100){this.$('.o_progressbar_value').text(utils.human_number(value)+" / "+utils.human_number(max_value));}else{this.$('.o_progressbar_value').text(utils.human_number(value)+"%");}}else if(isNaN(v)){this.$('.o_progressbar_value').val(this.edit_max_value?max_value:value);this.$('.o_progressbar_value').focus().select();}},_reset:function(){this._super.apply(this,arguments);var new_max_value=this.recordData[this.nodeOptions.max_value];this.max_value=new_max_value!==undefined?new_max_value:this.max_value;},isSet:function(){return true;},});var FieldToggleBoolean=AbstractField.extend({description:_lt("Button"),template:"toggle_button",events:{'click':'_onToggleButton'},supportedFieldTypes:['boolean'],isSet:function(){return true;},_render:function(){this.$('i').toggleClass('o_toggle_button_success',!!this.value).toggleClass('text-muted',!this.value);var isReadonly=this.record.evalModifiers(this.attrs.modifiers).readonly;this.$el.prop('disabled',isReadonly);var title=this.value?this.attrs.options.active:this.attrs.options.inactive;this.$el.attr('title',title);this.$el.attr('aria-pressed',this.value);},_onToggleButton:function(event){event.stopPropagation();this._setValue(!this.value);},});var JournalDashboardGraph=AbstractField.extend({className:"o_dashboard_graph",jsLibs:['/web/static/lib/Chart/Chart.js',],init:function(){this._super.apply(this,arguments);this.graph_type=this.attrs.graph_type;this.data=JSON.parse(this.value);},on_attach_callback:function(){this._isInDOM=true;this._renderInDOM();},on_detach_callback:function(){this._isInDOM=false;},_render:function(){if(this._isInDOM){return this._renderInDOM();}
return Promise.resolve();},_renderInDOM:function(){this.$el.empty();var config,cssClass;if(this.graph_type==='line'){config=this._getLineChartConfig();cssClass='o_graph_linechart';}else if(this.graph_type==='bar'){config=this._getBarChartConfig();cssClass='o_graph_barchart';}
this.$canvas=$('<canvas/>');this.$el.addClass(cssClass);this.$el.empty();this.$el.append(this.$canvas);var context=this.$canvas[0].getContext('2d');this.chart=new Chart(context,config);},_getLineChartConfig:function(){var labels=this.data[0].values.map(function(pt){return pt.x;});var borderColor=this.data[0].is_sample_data?'#dddddd':'#875a7b';var backgroundColor=this.data[0].is_sample_data?'#ebebeb':'#dcd0d9';return{type:'line',data:{labels:labels,datasets:[{data:this.data[0].values,fill:'start',label:this.data[0].key,backgroundColor:backgroundColor,borderColor:borderColor,borderWidth:2,}]},options:{legend:{display:false},scales:{yAxes:[{display:false}],xAxes:[{display:false}]},maintainAspectRatio:false,elements:{line:{tension:0.000001}},tooltips:{intersect:false,position:'nearest',caretSize:0,},},};},_getBarChartConfig:function(){var data=[];var labels=[];var backgroundColor=[];this.data[0].values.forEach(function(pt){data.push(pt.value);labels.push(pt.label);var color=pt.type==='past'?'#ccbdc8':(pt.type==='future'?'#a5d8d7':'#ebebeb');backgroundColor.push(color);});return{type:'bar',data:{labels:labels,datasets:[{data:data,fill:'start',label:this.data[0].key,backgroundColor:backgroundColor,}]},options:{legend:{display:false},scales:{yAxes:[{display:false}],},maintainAspectRatio:false,tooltips:{intersect:false,position:'nearest',caretSize:0,},elements:{line:{tension:0.000001}},},};},});var FieldDomain=AbstractField.extend({specialData:"_fetchSpecialDomain",events:_.extend({},AbstractField.prototype.events,{"click .o_domain_show_selection_button":"_onShowSelectionButtonClick","click .o_field_domain_dialog_button":"_onDialogEditButtonClick",}),custom_events:_.extend({},AbstractField.prototype.custom_events,{domain_changed:"_onDomainSelectorValueChange",domain_selected:"_onDomainSelectorDialogValueChange",open_record:"_onOpenRecord",}),init:function(){this._super.apply(this,arguments);this.inDialog=!!this.nodeOptions.in_dialog;this.fsFilters=this.nodeOptions.fs_filters||{};this.className="o_field_domain";if(this.mode==="edit"){this.className+=" o_edit_mode";}
if(!this.inDialog){this.className+=" o_inline_mode";}
this._setState();},isSet:function(){return true;},isValid:function(){return(this._super.apply(this,arguments)&&(!this.domainSelector||this.domainSelector.isValid())&&this._isValidForModel);},_render:function(){if(!this._domainModel){this._replaceContent();return Promise.resolve();}
var value=this.value||"[]";var def;if(!this.domainSelector){this.domainSelector=new DomainSelector(this,this._domainModel,value,{readonly:this.mode==="readonly"||this.inDialog,filters:this.fsFilters,debugMode:config.isDebug(),});def=this.domainSelector.prependTo(this.$el);}else{def=this.domainSelector.setDomain(value);}
return def.then(this._replaceContent.bind(this));},_replaceContent:function(){if(this._$content){this._$content.remove();}
this._$content=$(qweb.render("FieldDomain.content",{hasModel:!!this._domainModel,isValid:!!this._isValidForModel,nbRecords:this.record.specialData[this.name].nbRecords||0,inDialogEdit:this.inDialog&&this.mode==="edit",}));this._$content.appendTo(this.$el);},_reset:function(){this._super.apply(this,arguments);var oldDomainModel=this._domainModel;this._setState();if(this.domainSelector&&this._domainModel!==oldDomainModel){this.domainSelector.destroy();this.domainSelector=null;}},_setState:function(){var specialData=this.record.specialData[this.name];this._domainModel=specialData.model;this._isValidForModel=(specialData.nbRecords!==false);},_onShowSelectionButtonClick:function(e){e.preventDefault();new view_dialogs.SelectCreateDialog(this,{title:_t("Selected records"),res_model:this._domainModel,context:this.record.getContext({fieldName:this.name,viewType:this.viewType}),domain:this.value||"[]",no_create:true,readonly:true,disable_multiple_selection:true,}).open();},_onDialogEditButtonClick:function(e){e.preventDefault();new DomainSelectorDialog(this,this._domainModel,this.value||"[]",{readonly:this.mode==="readonly",filters:this.fsFilters,debugMode:config.isDebug(),}).open();},_onDomainSelectorValueChange:function(e){if(this.inDialog)return;this._setValue(Domain.prototype.arrayToString(this.domainSelector.getDomain()));},_onDomainSelectorDialogValueChange:function(e){this._setValue(Domain.prototype.arrayToString(e.data.domain));},_onOpenRecord:function(event){event.stopPropagation();},});var AceEditor=DebouncedField.extend({template:"AceEditor",jsLibs:['/web/static/lib/ace/ace.js',['/web/static/lib/ace/mode-python.js','/web/static/lib/ace/mode-xml.js']],events:{},start:function(){this._startAce(this.$('.ace-view-editor')[0]);return this._super.apply(this,arguments);},destroy:function(){if(this.aceEditor){this.aceEditor.destroy();}
this._super.apply(this,arguments);},_formatValue:function(value){return this._super.apply(this,arguments)||'';},_getValue:function(){return this.aceSession.getValue();},_render:function(){var newValue=this._formatValue(this.value);if(this.aceSession.getValue()!==newValue){this.aceSession.setValue(newValue);}},_startAce:function(node){this.aceEditor=ace.edit(node);this.aceEditor.setOptions({maxLines:Infinity,showPrintMargin:false,});if(this.mode==='readonly'){this.aceEditor.renderer.setOptions({displayIndentGuides:false,showGutter:false,});this.aceEditor.setOptions({highlightActiveLine:false,highlightGutterLine:false,readOnly:true,});this.aceEditor.renderer.$cursorLayer.element.style.display="none";}
this.aceEditor.$blockScrolling=true;this.aceSession=this.aceEditor.getSession();this.aceSession.setOptions({useWorker:false,mode:"ace/mode/"+(this.nodeOptions.mode||'xml'),tabSize:2,useSoftTabs:true,});if(this.mode==="edit"){this.aceEditor.on("change",this._doDebouncedAction.bind(this));this.aceEditor.on("blur",this._doAction.bind(this));}},});var FieldColor=AbstractField.extend({template:'FieldColor',events:_.extend({},AbstractField.prototype.events,{'click .o_field_color':'_onColorClick',}),custom_events:_.extend({},AbstractField.prototype.custom_events,{'colorpicker:saved':'_onColorpickerSaved',}),getFocusableElement:function(){return this.$('.o_field_color');},_render:function(){this.$('.o_field_color').data('value',this.value).css('background-color',this.value).attr('title',this.value);return this._super.apply(this,arguments);},_onColorClick:function(){if(this.mode==='edit'){const dialog=new ColorpickerDialog(this,{defaultColor:this.value,noTransparency:true,}).open();dialog.on('closed',this,()=>{Promise.resolve().then(()=>{this.getFocusableElement().focus();});});}},_onColorpickerSaved:function(ev){this._setValue(ev.data.hex);},_onKeydown:function(ev){if(ev.which===$.ui.keyCode.ENTER){ev.preventDefault();ev.stopPropagation();this._onColorClick(ev);}else{this._super.apply(this,arguments);}},});var FieldColorPicker=FieldInteger.extend({RECORD_COLORS:[_t('No color'),_t('Red'),_t('Orange'),_t('Yellow'),_t('Light blue'),_t('Dark purple'),_t('Salmon pink'),_t('Medium blue'),_t('Dark blue'),_t('Fushia'),_t('Green'),_t('Purple'),],init:function(){this._super.apply(this,arguments);this.tagName='div';},_renderEdit:function(){this.$el.html(qweb.render('ColorPicker'));this._setupColorPicker();this._highlightSelectedColor();},_renderReadonly:function(){var selectedColorName=this.RECORD_COLORS[this.value];this.$el.html(qweb.render('ColorPickerReadonly',{active_color:this.value,name_color:selectedColorName}));this.$el.on('click','a',function(ev){ev.preventDefault();});},_setupColorPicker:function(){var $colorpicker=this.$('ul');if(!$colorpicker.length){return;}
$colorpicker.html(qweb.render('KanbanColorPicker',{colors:this.RECORD_COLORS}));$colorpicker.on('click','a',this._onColorChanged.bind(this));},_getValue:function(){return this.value;},_onColorChanged:function(ev){ev.preventDefault();var color=null;if(ev.currentTarget&&ev.currentTarget.dataset&&ev.currentTarget.dataset.color){color=ev.currentTarget.dataset.color;}
if(color){this.value=color;this._onChange();this._renderEdit();}},_highlightSelectedColor:function(){try{$(this.$('li')[parseInt(this.value)]).css('border','2px solid teal');}catch(err){}},_onNavigationMove(){}});return{TranslatableFieldMixin:TranslatableFieldMixin,DebouncedField:DebouncedField,FieldEmail:FieldEmail,FieldBinaryFile:FieldBinaryFile,FieldPdfViewer:FieldPdfViewer,AbstractFieldBinary:AbstractFieldBinary,FieldBinaryImage:FieldBinaryImage,KanbanFieldBinaryImage:KanbanFieldBinaryImage,CharImageUrl:CharImageUrl,KanbanCharImageUrl:KanbanCharImageUrl,FieldBoolean:FieldBoolean,BooleanToggle:BooleanToggle,FieldChar:FieldChar,LinkButton:LinkButton,FieldDate:FieldDate,FieldDateTime:FieldDateTime,FieldDateRange:FieldDateRange,RemainingDays:RemainingDays,FieldDomain:FieldDomain,FieldFloat:FieldFloat,FieldFloatTime:FieldFloatTime,FieldFloatFactor:FieldFloatFactor,FieldFloatToggle:FieldFloatToggle,FieldPercentage:FieldPercentage,FieldInteger:FieldInteger,FieldMonetary:FieldMonetary,FieldPercentPie:FieldPercentPie,FieldPhone:FieldPhone,FieldProgressBar:FieldProgressBar,FieldText:FieldText,ListFieldText:ListFieldText,FieldToggleBoolean:FieldToggleBoolean,HandleWidget:HandleWidget,InputField:InputField,NumericField:NumericField,AttachmentImage:AttachmentImage,LabelSelection:LabelSelection,StateSelectionWidget:StateSelectionWidget,FavoriteWidget:FavoriteWidget,PriorityWidget:PriorityWidget,StatInfo:StatInfo,UrlWidget:UrlWidget,TextCopyClipboard:TextCopyClipboard,CharCopyClipboard:CharCopyClipboard,JournalDashboardGraph:JournalDashboardGraph,AceEditor:AceEditor,FieldColor:FieldColor,FieldColorPicker:FieldColorPicker,};});;

/* /web/static/src/js/fields/field_registry.js defined in bundle 'web.assets_backend' */
odoo.define('web.field_registry',function(require){"use strict";const Registry=require('web.Registry');return new Registry(null,(value)=>!(value.prototype instanceof owl.Component));});odoo.define('web._field_registry',function(require){"use strict";var AbstractField=require('web.AbstractField');var basic_fields=require('web.basic_fields');var relational_fields=require('web.relational_fields');var registry=require('web.field_registry');var special_fields=require('web.special_fields');registry.add('abstract',AbstractField).add('input',basic_fields.InputField).add('integer',basic_fields.FieldInteger).add('boolean',basic_fields.FieldBoolean).add('date',basic_fields.FieldDate).add('datetime',basic_fields.FieldDateTime).add('daterange',basic_fields.FieldDateRange).add('remaining_days',basic_fields.RemainingDays).add('domain',basic_fields.FieldDomain).add('text',basic_fields.FieldText).add('list.text',basic_fields.ListFieldText).add('html',basic_fields.FieldText).add('float',basic_fields.FieldFloat).add('char',basic_fields.FieldChar).add('link_button',basic_fields.LinkButton).add('handle',basic_fields.HandleWidget).add('email',basic_fields.FieldEmail).add('phone',basic_fields.FieldPhone).add('url',basic_fields.UrlWidget).add('CopyClipboardText',basic_fields.TextCopyClipboard).add('CopyClipboardChar',basic_fields.CharCopyClipboard).add('image',basic_fields.FieldBinaryImage).add('image_url',basic_fields.CharImageUrl).add('kanban.image',basic_fields.KanbanFieldBinaryImage).add('kanban.image_url',basic_fields.KanbanCharImageUrl).add('binary',basic_fields.FieldBinaryFile).add('pdf_viewer',basic_fields.FieldPdfViewer).add('monetary',basic_fields.FieldMonetary).add('percentage',basic_fields.FieldPercentage).add('priority',basic_fields.PriorityWidget).add('attachment_image',basic_fields.AttachmentImage).add('label_selection',basic_fields.LabelSelection).add('kanban_label_selection',basic_fields.LabelSelection).add('state_selection',basic_fields.StateSelectionWidget).add('kanban_state_selection',basic_fields.StateSelectionWidget).add('boolean_favorite',basic_fields.FavoriteWidget).add('boolean_toggle',basic_fields.BooleanToggle).add('statinfo',basic_fields.StatInfo).add('percentpie',basic_fields.FieldPercentPie).add('float_time',basic_fields.FieldFloatTime).add('float_factor',basic_fields.FieldFloatFactor).add('float_toggle',basic_fields.FieldFloatToggle).add('progressbar',basic_fields.FieldProgressBar).add('toggle_button',basic_fields.FieldToggleBoolean).add('dashboard_graph',basic_fields.JournalDashboardGraph).add('ace',basic_fields.AceEditor).add('color',basic_fields.FieldColor).add('many2one_reference',basic_fields.FieldInteger).add('color_picker',basic_fields.FieldColorPicker);registry.add('selection',relational_fields.FieldSelection).add('radio',relational_fields.FieldRadio).add('selection_badge',relational_fields.FieldSelectionBadge).add('many2one',relational_fields.FieldMany2One).add('many2one_barcode',relational_fields.Many2oneBarcode).add('list.many2one',relational_fields.ListFieldMany2One).add('kanban.many2one',relational_fields.KanbanFieldMany2One).add('many2one_avatar',relational_fields.Many2OneAvatar).add('many2many',relational_fields.FieldMany2Many).add('many2many_binary',relational_fields.FieldMany2ManyBinaryMultiFiles).add('many2many_tags',relational_fields.FieldMany2ManyTags).add('many2many_tags_avatar',relational_fields.FieldMany2ManyTagsAvatar).add('form.many2many_tags',relational_fields.FormFieldMany2ManyTags).add('kanban.many2many_tags',relational_fields.KanbanFieldMany2ManyTags).add('many2many_checkboxes',relational_fields.FieldMany2ManyCheckBoxes).add('one2many',relational_fields.FieldOne2Many).add('statusbar',relational_fields.FieldStatus).add('reference',relational_fields.FieldReference).add('font',relational_fields.FieldSelectionFont);registry.add('timezone_mismatch',special_fields.FieldTimezoneMismatch).add('report_layout',special_fields.FieldReportLayout).add('iframe_wrapper',special_fields.IframeWrapper)});;

/* /web/static/src/js/fields/field_registry_owl.js defined in bundle 'web.assets_backend' */
odoo.define('web.field_registry_owl',function(require){"use strict";const Registry=require('web.Registry');return new Registry(null,(value)=>value.prototype instanceof owl.Component);});odoo.define('web._field_registry_owl',function(require){"use strict";const basicFields=require('web.basic_fields_owl');const registry=require('web.field_registry_owl');registry.add('badge',basicFields.FieldBadge).add('boolean',basicFields.FieldBoolean);});;

/* /web/static/src/js/views/basic/widget_registry.js defined in bundle 'web.assets_backend' */
odoo.define('web.widget_registry',function(require){"use strict";var Registry=require('web.Registry');return new Registry();});;

/* /web/static/src/js/fields/field_utils.js defined in bundle 'web.assets_backend' */
odoo.define('web.field_utils',function(require){"use strict";var core=require('web.core');var dom=require('web.dom');var session=require('web.session');var time=require('web.time');var utils=require('web.utils');var _t=core._t;function formatBinary(value,field,options){if(!value){return'';}
return utils.binaryToBinsize(value);}
function formatBoolean(value,field,options){if(options&&options.forceString){return value?_t('True'):_t('False');}
return dom.renderCheckbox({prop:{checked:value,disabled:true,},});}
function formatChar(value,field,options){value=typeof value==='string'?value:'';if(options&&options.isPassword){return _.str.repeat('*',value?value.length:0);}
if(options&&options.escape){value=_.escape(value);}
return value;}
function formatDate(value,field,options){if(value===false||isNaN(value)){return"";}
if(field&&field.type==='datetime'){if(!options||!('timezone'in options)||options.timezone){value=value.clone().add(session.getTZOffset(value),'minutes');}}
var date_format=time.getLangDateFormat();return value.format(date_format);}
function formatDateTime(value,field,options){if(value===false){return"";}
if(!options||!('timezone'in options)||options.timezone){value=value.clone().add(session.getTZOffset(value),'minutes');}
return value.format(time.getLangDatetimeFormat());}
function formatFloat(value,field,options){options=options||{};if(value===false){return"";}
if(options.humanReadable&&options.humanReadable(value)){return utils.human_number(value,options.decimals,options.minDigits,options.formatterCallback);}
var l10n=core._t.database.parameters;var precision;if(options.digits){precision=options.digits[1];}else if(field&&field.digits){precision=field.digits[1];}else{precision=2;}
var formatted=_.str.sprintf('%.'+precision+'f',value||0).split('.');formatted[0]=utils.insert_thousand_seps(formatted[0]);return formatted.join(l10n.decimal_point);}
function formatFloatFactor(value,field,options){var factor=options.factor||1;return formatFloat(value*factor,field,options);}
function formatFloatTime(value,field,options){options=options||{};var pattern=options.noLeadingZeroHour?'%1d:%02d':'%02d:%02d';if(value<0){value=Math.abs(value);pattern='-'+pattern;}
var hour=Math.floor(value);var min=Math.round((value%1)*60);if(min===60){min=0;hour=hour+1;}
return _.str.sprintf(pattern,hour,min);}
function formatInteger(value,field,options){options=options||{};if(options.isPassword){return _.str.repeat('*',String(value).length);}
if(!value&&value!==0){return"";}
if(options.humanReadable&&options.humanReadable(value)){return utils.human_number(value,options.decimals,options.minDigits,options.formatterCallback);}
return utils.insert_thousand_seps(_.str.sprintf('%d',value));}
function formatMany2one(value,field,options){if(!value){value='';}else if(_.isArray(value)){value=value[1];}else{while(value.data){value=value.data.display_name||'';}}
if(options&&options.escape){value=_.escape(value);}
return value;}
function formatX2Many(value){if(value.data.length===0){return _t('No records');}else if(value.data.length===1){return _t('1 record');}else{return value.data.length+_t(' records');}}
function formatMonetary(value,field,options){if(value===false){return"";}
options=Object.assign({forceString:false},options);var currency=options.currency;if(!currency){var currency_id=options.currency_id;if(!currency_id&&options.data){var currency_field=options.currency_field||field.currency_field||'currency_id';currency_id=options.data[currency_field]&&options.data[currency_field].res_id;}
currency=session.get_currency(currency_id);}
var digits=(currency&&currency.digits)||options.digits;if(options.field_digits===true){digits=field.digits||digits;}
var formatted_value=formatFloat(value,field,_.extend({},options,{digits:digits}));if(!currency||options.noSymbol){return formatted_value;}
const ws=options.forceString?' ':'&nbsp;';if(currency.position==="after"){return formatted_value+ws+currency.symbol;}else{return currency.symbol+ws+formatted_value;}}
function formatPercentage(value,field,options){options=options||{};let result=formatFloat(value*100,field,options)||'0';if(!options.humanReadable||!options.humanReadable(value*100)){result=parseFloat(result).toString().replace('.',_t.database.parameters.decimal_point);}
return result+(options.noSymbol?'':'%');}
function formatSelection(value,field,options){var val=_.find(field.selection,function(option){return option[0]===value;});if(!val){return'';}
value=val[1];if(options&&options.escape){value=_.escape(value);}
return value;}
function parseSmartDateInput(value){const units={d:'days',m:'months',w:'weeks',y:'years',};const re=new RegExp(`^([+-])(\\d+)([${Object.keys(units).join('')}]?)$`);const match=re.exec(value);if(match){let date=moment();const offset=parseInt(match[2],10);const unit=units[match[3]||'d'];if(match[1]==='+'){date.add(offset,unit);}else{date.subtract(offset,unit);}
return date;}
return false;}
function parseDate(value,field,options){if(!value){return false;}
var datePattern=time.getLangDateFormat();var datePatternWoZero=time.getLangDateFormatWoZero();var date;const smartDate=parseSmartDateInput(value);if(smartDate){date=smartDate;}else{if(options&&options.isUTC){value=value.padStart(10,"0");date=moment.utc(value);}else{date=moment.utc(value,[datePattern,datePatternWoZero,moment.ISO_8601]);}}
if(date.isValid()){if(date.year()===0){date.year(moment.utc().year());}
if(date.year()>=1000){date.toJSON=function(){return this.clone().locale('en').format('YYYY-MM-DD');};return date;}}
throw new Error(_.str.sprintf(core._t("'%s' is not a correct date"),value));}
function parseDateTime(value,field,options){if(!value){return false;}
const datePattern=time.getLangDateFormat();const timePattern=time.getLangTimeFormat();const datePatternWoZero=time.getLangDateFormatWoZero();const timePatternWoZero=time.getLangTimeFormatWoZero();var pattern1=datePattern+' '+timePattern;var pattern2=datePatternWoZero+' '+timePatternWoZero;var datetime;const smartDate=parseSmartDateInput(value);if(smartDate){datetime=smartDate;}else{if(options&&options.isUTC){value=value.padStart(19,"0");datetime=moment.utc(value.replace(' ','T')+'Z');}else{datetime=moment.utc(value,[pattern1,pattern2,moment.ISO_8601]);if(options&&options.timezone){datetime.add(-session.getTZOffset(datetime),'minutes');}}}
if(datetime.isValid()){if(datetime.year()===0){datetime.year(moment.utc().year());}
if(datetime.year()>=1000){datetime.toJSON=function(){return this.clone().locale('en').format('YYYY-MM-DD HH:mm:ss');};return datetime;}}
throw new Error(_.str.sprintf(core._t("'%s' is not a correct datetime"),value));}
function parseNumber(value){if(core._t.database.parameters.thousands_sep){var escapedSep=_.str.escapeRegExp(core._t.database.parameters.thousands_sep);value=value.replace(new RegExp(escapedSep,'g'),'');}
if(core._t.database.parameters.decimal_point){value=value.replace(core._t.database.parameters.decimal_point,'.');}
return Number(value);}
function parseFloat(value){var parsed=parseNumber(value);if(isNaN(parsed)){throw new Error(_.str.sprintf(core._t("'%s' is not a correct float"),value));}
return parsed;}
function parseMonetary(value,field,options){var values=value.split('&nbsp;');if(values.length===1){return parseFloat(value);}
else if(values.length!==2){throw new Error(_.str.sprintf(core._t("'%s' is not a correct monetary field"),value));}
options=options||{};var currency=options.currency;if(!currency){var currency_id=options.currency_id;if(!currency_id&&options.data){var currency_field=options.currency_field||field.currency_field||'currency_id';currency_id=options.data[currency_field]&&options.data[currency_field].res_id;}
currency=session.get_currency(currency_id);}
return parseFloat(values[0]===currency.symbol?values[1]:values[0]);}
function parseFloatFactor(value,field,options){var parsed=parseFloat(value);var factor=options.factor||1.0;return parsed/factor;}
function parseFloatTime(value){var factor=1;if(value[0]==='-'){value=value.slice(1);factor=-1;}
var float_time_pair=value.split(":");if(float_time_pair.length!==2)
return factor*parseFloat(value);var hours=parseInteger(float_time_pair[0]);var minutes=parseInteger(float_time_pair[1]);return factor*(hours+(minutes/60));}
function parsePercentage(value){return parseFloat(value)/100;}
function parseInteger(value){var parsed=parseNumber(value);if(isNaN(parsed)||parsed%1||parsed<-2147483648||parsed>2147483647){throw new Error(_.str.sprintf(core._t("'%s' is not a correct integer"),value));}
return parsed;}
function parseMany2one(value){if(_.isArray(value)){return{id:value[0],display_name:value[1],};}
if(_.isNumber(value)||_.isString(value)){return{id:parseInt(value,10),};}
return value;}
return{format:{binary:formatBinary,boolean:formatBoolean,char:formatChar,date:formatDate,datetime:formatDateTime,float:formatFloat,float_factor:formatFloatFactor,float_time:formatFloatTime,html:_.identity,integer:formatInteger,many2many:formatX2Many,many2one:formatMany2one,many2one_reference:formatInteger,monetary:formatMonetary,one2many:formatX2Many,percentage:formatPercentage,reference:formatMany2one,selection:formatSelection,text:formatChar,},parse:{binary:_.identity,boolean:_.identity,char:_.identity,date:parseDate,datetime:parseDateTime,float:parseFloat,float_factor:parseFloatFactor,float_time:parseFloatTime,html:_.identity,integer:parseInteger,many2many:_.identity,many2one:parseMany2one,many2one_reference:parseInteger,monetary:parseMonetary,one2many:_.identity,percentage:parsePercentage,reference:parseMany2one,selection:_.identity,text:_.identity,},};});;

/* /web/static/src/js/fields/relational_fields.js defined in bundle 'web.assets_backend' */
odoo.define('web.relational_fields',function(require){"use strict";var AbstractField=require('web.AbstractField');var basicFields=require('web.basic_fields');var concurrency=require('web.concurrency');const ControlPanelX2Many=require('web.ControlPanelX2Many');var core=require('web.core');var data=require('web.data');var Dialog=require('web.Dialog');var dialogs=require('web.view_dialogs');var dom=require('web.dom');const Domain=require('web.Domain');var KanbanRecord=require('web.KanbanRecord');var KanbanRenderer=require('web.KanbanRenderer');var ListRenderer=require('web.ListRenderer');const{ComponentWrapper,WidgetAdapterMixin}=require('web.OwlCompatibility');const{sprintf}=require("web.utils");const{escape}=owl.utils;var _t=core._t;var _lt=core._lt;var qweb=core.qweb;var M2ODialog=Dialog.extend({template:"M2ODialog",init:function(parent,name,value){this.name=name;this.value=value;this._super(parent,{title:_.str.sprintf(_t("New %s"),this.name),size:'medium',buttons:[{text:_t('Create'),classes:'btn-primary',close:true,click:function(){this.trigger_up('quick_create',{value:this.value});},},{text:_t('Create and edit'),classes:'btn-primary',close:true,click:function(){this.trigger_up('search_create_popup',{view_type:'form',value:this.value,});},},{text:_t('Cancel'),close:true,}],});},close:function(isSet){this.isSet=isSet;this._super.apply(this,arguments);},destroy:function(){if(!this.isSet){this.trigger_up('closed_unset');}
this._super.apply(this,arguments);},});var FieldMany2One=AbstractField.extend({description:_lt("Many2one"),supportedFieldTypes:['many2one'],template:'FieldMany2One',custom_events:_.extend({},AbstractField.prototype.custom_events,{'closed_unset':'_onDialogClosedUnset','field_changed':'_onFieldChanged','quick_create':'_onQuickCreate','search_create_popup':'_onSearchCreatePopup',}),events:_.extend({},AbstractField.prototype.events,{'click input':'_onInputClick','focusout input':'_onInputFocusout','keyup input':'_onInputKeyup','click .o_external_button':'_onExternalButtonClick','click':'_onClick',}),AUTOCOMPLETE_DELAY:200,SEARCH_MORE_LIMIT:320,init:function(parent,name,record,options){options=options||{};this._super.apply(this,arguments);this.limit=7;this.orderer=new concurrency.DropMisordered();const canCreate='can_create'in this.attrs?JSON.parse(this.attrs.can_create):true;this.can_create=canCreate&&!this.nodeOptions.no_create&&!options.noCreate;this.can_write='can_write'in this.attrs?JSON.parse(this.attrs.can_write):true;this.nodeOptions=_.defaults(this.nodeOptions,{quick_create:true,});this.noOpen='noOpen'in options?options.noOpen:this.nodeOptions.no_open;this.m2o_value=this._formatValue(this.value);this.recordParams={fieldName:this.name,viewType:this.viewType};this.isDirty=false;this.lastChangeEvent=undefined;this._autocompleteSources=[];this._addAutocompleteSource(this._search,{placeholder:_t('Loading...'),order:1});this.dp=new concurrency.DropPrevious();this.createDef=undefined;},start:function(){this.floating=false;this.$input=this.$('input');this.$external_button=this.$('.o_external_button');return this._super.apply(this,arguments);},destroy:function(){if(this._onScroll){window.removeEventListener('scroll',this._onScroll,true);}
this._super.apply(this,arguments);},commitChanges:function(){return Promise.resolve(this.createDef);},getFocusableElement:function(){return this.mode==='edit'&&this.$input||this.$el;},reinitialize:function(value){this.isDirty=false;this.floating=false;return this._setValue(value);},reset:function(record,event){this._reset(record,event);if(!event||event===this.lastChangeEvent){this.isDirty=false;}
if(this.isDirty){return Promise.resolve();}else{return this._render();}},_addAutocompleteSource:function(method,params){this._autocompleteSources.push({method:method,placeholder:(params.placeholder?_t(params.placeholder):_t('Loading...'))+'<i class="fa fa-spinner fa-spin pull-right"></i>',validation:params.validation,loading:false,order:params.order||999});this._autocompleteSources=_.sortBy(this._autocompleteSources,'order');},_bindAutoComplete:function(){var self=this;if($.browser.chrome&&this.$input.attr('placeholder')){this.$input.attr('placeholder',function(index,val){return val.split('').join('\ufeff');});}
this.$input.autocomplete({source:function(req,resp){_.each(self._autocompleteSources,function(source){source.results=[];const search=req.term.trim();if(!source.validation||source.validation.call(self,search)){source.loading=true;Promise.resolve(source.method.call(self,search)).then(function(results){source.results=results;source.loading=false;resp(self._concatenateAutocompleteResults());});}});},select:function(event,ui){event.stopImmediatePropagation();event.preventDefault();var item=ui.item;self.floating=false;if(item.id){self.reinitialize({id:item.id,display_name:item.name});}else if(item.action){item.action();}
return false;},focus:function(event){event.preventDefault();},open:function(event){self._onScroll=function(ev){if(ev.target!==self.$input.get(0)&&self.$input.hasClass('ui-autocomplete-input')){self.$input.autocomplete('close');}};window.addEventListener('scroll',self._onScroll,true);},close:function(event){if(event.which===$.ui.keyCode.ESCAPE){event.stopPropagation();}
if(self._onScroll){window.removeEventListener('scroll',self._onScroll,true);}},autoFocus:true,html:true,minLength:0,delay:this.AUTOCOMPLETE_DELAY,});this.$input.autocomplete("option","position",{my:"left top",at:"left bottom"});this.autocomplete_bound=true;},_concatenateAutocompleteResults:function(){var results=[];_.each(this._autocompleteSources,function(source){if(source.results&&source.results.length){results=results.concat(source.results);}else if(source.loading){results.push({label:source.placeholder});}});return results;},_createContext:function(name){var tmp={};var field=this.nodeOptions.create_name_field;if(field===undefined){field="name";}
if(field!==false&&name&&this.nodeOptions.quick_create!==false){tmp["default_"+field]=name;}
return tmp;},_getSearchBlacklist:function(){return[];},_getDisplayName:function(value){return value.split('\n')[0];},_getSearchCreatePopupOptions:function(view,ids,context,dynamicFilters){var self=this;return{res_model:this.field.relation,domain:this.record.getDomain({fieldName:this.name}),context:_.extend({},this.record.getContext(this.recordParams),context||{}),_createContext:this._createContext.bind(this),dynamicFilters:dynamicFilters||[],title:(view==='search'?_t("Search: "):_t("Create: "))+this.string,initial_ids:ids,initial_view:view,disable_multiple_selection:true,no_create:!self.can_create,kanban_view_ref:this.attrs.kanban_view_ref,on_selected:function(records){self.reinitialize(records[0]);},on_closed:function(){self.activate();},};},_manageSearchMore:function(values,search_val,domain,context){var self=this;values=values.slice(0,this.limit);values.push({label:_t("Search More..."),action:function(){var prom;if(search_val!==''){prom=self._rpc({model:self.field.relation,method:'name_search',kwargs:{name:search_val,args:domain,operator:"ilike",limit:self.SEARCH_MORE_LIMIT,context:context,},});}
Promise.resolve(prom).then(function(results){var dynamicFilters;if(results){var ids=_.map(results,function(x){return x[0];});dynamicFilters=[{description:_.str.sprintf(_t('Quick search: %s'),search_val),domain:[['id','in',ids]],}];}
self._searchCreatePopup("search",false,{},dynamicFilters);});},classname:'o_m2o_dropdown_option',});return values;},_onFieldChanged:function(event){this.lastChangeEvent=event;},_quickCreate:function(name){var self=this;var createDone;var def=new Promise(function(resolve,reject){self.createDef=new Promise(function(innerResolve){createDone=function(){innerResolve();resolve();self.createDef=undefined;};});var slowCreate=function(){var dialog=self._searchCreatePopup("form",false,self._createContext(name));dialog.on('closed',self,createDone);};if(self.nodeOptions.quick_create){const prom=self.reinitialize({id:false,display_name:name});prom.guardedCatch(reason=>{reason.event.preventDefault();slowCreate();});self.dp.add(prom).then(createDone).guardedCatch(reject);}else{slowCreate();}});return def;},_renderEdit:function(){var value=this.m2o_value;if(this.nodeOptions.always_reload){value=this._getDisplayName(value);}
this.$input.val(value);if(!this.autocomplete_bound){this._bindAutoComplete();}
this._updateExternalButton();},_renderReadonly:function(){var escapedValue=_.escape((this.m2o_value||"").trim());var value=escapedValue.split('\n').map(function(line){return'<span>'+line+'</span>';}).join('<br/>');this.$el.html(value);if(!this.noOpen&&this.value){this.$el.attr('href',_.str.sprintf('#id=%s&model=%s',this.value.res_id,this.field.relation));this.$el.addClass('o_form_uri');}},_reset:function(){this._super.apply(this,arguments);this.floating=false;this.m2o_value=this._formatValue(this.value);},_search:async function(searchValue=""){const value=searchValue.trim();const domain=this.record.getDomain(this.recordParams);const context=Object.assign(this.record.getContext(this.recordParams),this.additionalContext);const blackListedIds=this._getSearchBlacklist();if(blackListedIds.length){domain.push(['id','not in',blackListedIds]);}
const nameSearch=this._rpc({model:this.field.relation,method:"name_search",kwargs:{name:value,args:domain,operator:"ilike",limit:this.limit+1,context,}});const results=await this.orderer.add(nameSearch);let values=results.map((result)=>{const[id,fullName]=result;const displayName=this._getDisplayName(fullName).trim();result[1]=displayName;return{id,label:escape(displayName)||data.noDisplayContent,value:displayName,name:displayName,};});if(this.limit<values.length){values=this._manageSearchMore(values,value,domain,context);}
if(!this.can_create){return values;}
const canQuickCreate=!this.nodeOptions.no_quick_create;const canCreateEdit=!this.nodeOptions.no_create_edit;if(value.length){const nameExists=results.some((result)=>result[1]===value);if(canQuickCreate&&!nameExists){values.push({label:sprintf(_t(`Create "<strong>%s</strong>"`),escape(value)),action:()=>this._quickCreate(value),classname:'o_m2o_dropdown_option'});}
if(canCreateEdit){const valueContext=this._createContext(value);values.push({label:_t("Create and Edit..."),action:()=>{this.el.querySelector(':scope input').value="";return this._searchCreatePopup('form',false,valueContext);},classname:'o_m2o_dropdown_option',});}
if(!values.length){values.push({label:_t("No results to show..."),});}}else if(!this.value&&(canQuickCreate||canCreateEdit)){values.push({label:_t("Start typing..."),classname:'o_m2o_start_typing',});}
return values;},_searchCreatePopup:function(view,ids,context,dynamicFilters){var options=this._getSearchCreatePopupOptions(view,ids,context,dynamicFilters);return new dialogs.SelectCreateDialog(this,_.extend({},this.nodeOptions,options)).open();},_updateExternalButton:function(){var has_external_button=!this.noOpen&&!this.floating&&this.isSet();this.$external_button.toggle(has_external_button);this.$el.toggleClass('o_with_button',has_external_button);},_onClick:function(event){var self=this;if(this.mode==='readonly'&&!this.noOpen){event.preventDefault();event.stopPropagation();this._rpc({model:this.field.relation,method:'get_formview_action',args:[[this.value.res_id]],context:this.record.getContext(this.recordParams),}).then(function(action){self.trigger_up('do_action',{action:action});});}},_onDialogClosedUnset:function(){this.isDirty=false;this.floating=false;this._render();},_onExternalButtonClick:function(){if(!this.value){this.activate();return;}
var self=this;var context=this.record.getContext(this.recordParams);this._rpc({model:this.field.relation,method:'get_formview_id',args:[[this.value.res_id]],context:context,}).then(function(view_id){new dialogs.FormViewDialog(self,{res_model:self.field.relation,res_id:self.value.res_id,context:context,title:_t("Open: ")+self.string,view_id:view_id,readonly:!self.can_write,on_saved:function(record,changed){if(changed){const _setValue=self._setValue.bind(self,self.value.data,{forceChange:true,});self.trigger_up('reload',{db_id:self.value.id,onSuccess:_setValue,onFailure:_setValue,});}},}).open();});},_onInputClick:function(){if(this.$input.autocomplete("widget").is(":visible")){this.$input.autocomplete("close");}else if(this.floating){this.$input.autocomplete("search");}else{this.$input.autocomplete("search",'');}},_onInputFocusout:function(){if(this.can_create&&this.floating){new M2ODialog(this,this.string,this.$input.val()).open();}},_onInputKeyup:function(ev){if(ev.which===$.ui.keyCode.ENTER||ev.which===$.ui.keyCode.TAB){return;}
this.isDirty=true;if(this.$input.val()===""){this.reinitialize(false);}else if(this._getDisplayName(this.m2o_value)!==this.$input.val()){this.floating=true;this._updateExternalButton();}},_onKeydown:function(){this.floating=false;this._super.apply(this,arguments);},_onNavigationMove:function(ev){basicFields.InputField.prototype._onNavigationMove.apply(this,arguments);if(this.mode==='edit'&&$(this.$input.autocomplete('widget')).is(':visible')){ev.stopPropagation();}},_onQuickCreate:function(event){this._quickCreate(event.data.value);},_onSearchCreatePopup:function(event){var data=event.data;this._searchCreatePopup(data.view_type,false,this._createContext(data.value));},});var Many2oneBarcode=FieldMany2One.extend({});var ListFieldMany2One=FieldMany2One.extend({events:_.extend({},FieldMany2One.prototype.events,{'focusin input':'_onInputFocusin',}),init:function(){this._super.apply(this,arguments);this.mustSetValue=false;this.m2oDialogFocused=false;},activate:function(){if(this.mode==='readonly'){return false;}
return this._super.apply(this,arguments);},reinitialize:function(){this.mustSetValue=false;return this._super.apply(this,arguments);},_renderReadonly:function(){this.$el.text(this.m2o_value);},_searchCreatePopup:function(){this.m2oDialogFocused=true;return this._super.apply(this,arguments);},_onInputFocusin:function(){this.m2oDialogFocused=false;},_onInputFocusout:function(){if(this.can_create&&this.floating){var attachedEvents=['click','mousedown'];var stopNextClick=(function(ev){ev.stopPropagation();attachedEvents.forEach(function(eventName){window.removeEventListener(eventName,stopNextClick,true);});}).bind(this);attachedEvents.forEach(function(eventName){window.addEventListener(eventName,stopNextClick,true);});}
this._super.apply(this,arguments);if(!this.m2oDialogFocused&&this.$input.val()===""&&this.mustSetValue){this.reinitialize(false);}},_onInputKeyup:function(){if(this.$input.val()!==""){this._super.apply(this,arguments);}else{this.mustSetValue=true;}},});var KanbanFieldMany2One=AbstractField.extend({tagName:'span',init:function(){this._super.apply(this,arguments);this.m2o_value=this._formatValue(this.value);},_render:function(){this.$el.text(this.m2o_value);},});const Many2OneAvatar=FieldMany2One.extend({_template:'web.Many2OneAvatar',init(){this._super.apply(this,arguments);if(this.mode==='readonly'){this.template=null;this.tagName='div';this.className='o_field_many2one_avatar';this.noOpen=true;}},_renderReadonly(){this.$el.empty();if(this.value){this.$el.html(qweb.render(this._template,{url:`/web/image/${this.field.relation}/${this.value.res_id}/image_128`,value:this.m2o_value,}));}},});var FieldX2Many=AbstractField.extend(WidgetAdapterMixin,{tagName:'div',custom_events:_.extend({},AbstractField.prototype.custom_events,{add_record:'_onAddRecord',discard_changes:'_onDiscardChanges',edit_line:'_onEditLine',field_changed:'_onFieldChanged',open_record:'_onOpenRecord',kanban_record_delete:'_onRemoveRecord',list_record_remove:'_onRemoveRecord',resequence_records:'_onResequenceRecords',save_line:'_onSaveLine',toggle_column_order:'_onToggleColumnOrder',activate_next_widget:'_onActiveNextWidget',navigation_move:'_onNavigationMove',save_optional_fields:'_onSaveOrLoadOptionalFields',load_optional_fields:'_onSaveOrLoadOptionalFields',pager_changed:'_onPagerChanged',}),resetOnAnyFieldChange:true,useSubview:true,init:function(parent,name,record,options){this._super.apply(this,arguments);this.nodeOptions=_.defaults(this.nodeOptions,{create_text:_t('Add'),});this.operations=[];this.isReadonly=this.mode==='readonly';this.view=this.attrs.views[this.attrs.mode];this.isMany2Many=this.field.type==='many2many'||this.attrs.widget==='many2many';this.activeActions={};this.recordParams={fieldName:this.name,viewType:this.viewType};this.pagingState={currentMinimum:this.value.offset+1,limit:this.value.limit,size:this.value.count,validate:()=>{return this.view.arch.tag==='tree'?this.renderer.unselectRow():Promise.resolve();},withAccessKey:false,};var arch=this.view&&this.view.arch;if(arch){this.activeActions.create=arch.attrs.create?!!JSON.parse(arch.attrs.create):true;this.activeActions.delete=arch.attrs.delete?!!JSON.parse(arch.attrs.delete):true;this.editable=arch.attrs.editable;}
this._computeAvailableActions(record);if(this.attrs.columnInvisibleFields){this._processColumnInvisibleFields();}},start:async function(){const _super=this._super.bind(this);if(this.view){this._renderButtons();this._controlPanelWrapper=new ComponentWrapper(this,ControlPanelX2Many,{cp_content:{$buttons:this.$buttons},pager:this.pagingState,});await this._controlPanelWrapper.mount(this.el,{position:'first-child'});}
return _super(...arguments);},destroy:function(){WidgetAdapterMixin.destroy.call(this);this._super();},on_attach_callback:function(){this.isInDOM=true;WidgetAdapterMixin.on_attach_callback.call(this);if(this.renderer){this.renderer.on_attach_callback();}},on_detach_callback:function(){this.isInDOM=false;WidgetAdapterMixin.on_detach_callback.call(this);if(this.renderer){this.renderer.on_detach_callback();}},commitChanges:function(){var self=this;var inEditionRecordID=this.renderer&&this.renderer.viewType==="list"&&this.renderer.getEditableRecordID();if(inEditionRecordID){return this.renderer.commitChanges(inEditionRecordID).then(function(){return self._saveLine(inEditionRecordID);});}
return this._super.apply(this,arguments);},isSet:function(){return true;},reset:function(record,ev,fieldChanged){const oldCanCreate=this.canCreate;const oldCanDelete=this.canDelete;const oldCanLink=this.canLink;const oldCanUnlink=this.canUnlink;this._computeAvailableActions(record);const actionsChanged=this.canCreate!==oldCanCreate||this.canDelete!==oldCanDelete||this.canLink!==oldCanLink||this.canUnlink!==oldCanUnlink;if(!fieldChanged&&!actionsChanged){var newEval=this._evalColumnInvisibleFields();if(_.isEqual(this.currentColInvisibleFields,newEval)){this._reset(record,ev);return Promise.resolve();}}else if(ev&&ev.target===this&&ev.data.changes&&this.view.arch.tag==='tree'){var command=ev.data.changes[this.name];if(command&&command.operation==='UPDATE'&&command.data){var state=record.data[this.name];var fieldNames=state.getFieldNames({viewType:'list'});this._reset(record,ev);return this.renderer.confirmUpdate(state,command.id,fieldNames,ev.initialEvent);}}
return this._super.apply(this,arguments);},getFocusableElement:function(){return(this.mode==='edit'&&this.$input)||this.$el;},activate:function(options){if(!this.activeActions.create||this.isReadonly||!this.$el.is(":visible")){return false;}
if(this.view.type==='kanban'){this.$buttons.find(".o-kanban-button-new").focus();}
if(this.view.arch.tag==='tree'){if(options&&options.noAutomaticCreate){this.renderer.$('.o_field_x2many_list_row_add a:first').focus();}else{this.renderer.$('.o_field_x2many_list_row_add a:first').click();}}
return true;},_computeAvailableActions:function(record){const evalContext=record.evalContext;this.canCreate='create'in this.nodeOptions?new Domain(this.nodeOptions.create,evalContext).compute(evalContext):true;this.canDelete='delete'in this.nodeOptions?new Domain(this.nodeOptions.delete,evalContext).compute(evalContext):true;this.canLink='link'in this.nodeOptions?new Domain(this.nodeOptions.link,evalContext).compute(evalContext):true;this.canUnlink='unlink'in this.nodeOptions?new Domain(this.nodeOptions.unlink,evalContext).compute(evalContext):true;},_evalColumnInvisibleFields:function(){var self=this;return _.mapObject(this.columnInvisibleFields,function(domains){return self.record.evalModifiers({column_invisible:domains,}).column_invisible;});},_getButtonsRenderingContext(){return{btnClass:'btn-secondary',create_text:this.nodeOptions.create_text,};},_getRenderer:function(){if(this.view.arch.tag==='tree'){return ListRenderer;}
if(this.view.arch.tag==='kanban'){return KanbanRenderer;}},_hasCreateLine:function(){return!this.isReadonly&&((!this.isMany2Many&&this.activeActions.create&&this.canCreate)||(this.isMany2Many&&this.canLink));},_hasTrashIcon:function(){return!this.isReadonly&&((!this.isMany2Many&&this.activeActions.delete&&this.canDelete)||(this.isMany2Many&&this.canUnlink));},_render:function(){var self=this;if(!this.view){return this._super();}
if(this.renderer){this.currentColInvisibleFields=this._evalColumnInvisibleFields();return this.renderer.updateState(this.value,{addCreateLine:this._hasCreateLine(),addTrashIcon:this._hasTrashIcon(),columnInvisibleFields:this.currentColInvisibleFields,keepWidths:true,}).then(()=>{return this._updateControlPanel({size:this.value.count});});}
var arch=this.view.arch;var viewType;var rendererParams={arch:arch,};if(arch.tag==='tree'){viewType='list';this.currentColInvisibleFields=this._evalColumnInvisibleFields();_.extend(rendererParams,{editable:this.mode==='edit'&&arch.attrs.editable,addCreateLine:this._hasCreateLine(),addTrashIcon:this._hasTrashIcon(),isMany2Many:this.isMany2Many,columnInvisibleFields:this.currentColInvisibleFields,});}
if(arch.tag==='kanban'){viewType='kanban';var record_options={editable:false,deletable:false,read_only_mode:this.isReadonly,};_.extend(rendererParams,{record_options:record_options,readOnlyMode:this.isReadonly,});}
_.extend(rendererParams,{viewType:viewType,});var Renderer=this._getRenderer();this.renderer=new Renderer(this,this.value,rendererParams);this.$el.addClass('o_field_x2many o_field_x2many_'+viewType);if(this.renderer){return this.renderer.appendTo(document.createDocumentFragment()).then(function(){dom.append(self.$el,self.renderer.$el,{in_DOM:self.isInDOM,callbacks:[{widget:self.renderer}],});});}else{return this._super();}},_renderButtons:function(){if(!this.isReadonly&&this.view.arch.tag==='kanban'){const renderingContext=this._getButtonsRenderingContext();this.$buttons=$(qweb.render('KanbanView.buttons',renderingContext));this.$buttons.on('click','button.o-kanban-button-new',this._onAddRecord.bind(this));}},_saveLine:function(recordID){var self=this;return new Promise(function(resolve,reject){var fieldNames=self.renderer.canBeSaved(recordID);if(fieldNames.length){self.trigger_up('discard_changes',{recordID:recordID,onSuccess:resolve,onFailure:reject,});}else{self.renderer.setRowMode(recordID,'readonly').then(resolve);}}).then(async function(){self._updateControlPanel({size:self.value.count});var newEval=self._evalColumnInvisibleFields();if(!_.isEqual(self.currentColInvisibleFields,newEval)){self.currentColInvisibleFields=newEval;self.renderer.updateState(self.value,{columnInvisibleFields:self.currentColInvisibleFields,});}});},_updateControlPanel:function(pagingState){if(this._controlPanelWrapper){this._renderButtons();const pagerProps=Object.assign(this.pagingState,pagingState,{limit:Math.max(this.value.limit,this.value.data.length),});const newProps={cp_content:{$buttons:this.$buttons},pager:pagerProps,};return this._controlPanelWrapper.update(newProps);}},_processColumnInvisibleFields:function(){var columnInvisibleFields={};_.each(this.attrs.columnInvisibleFields,function(domains,fieldName){if(_.isArray(domains)){columnInvisibleFields[fieldName]=_.map(domains,function(domain){if(_.isArray(domain)){return[domain[0].split('.')[1]].concat(domain.slice(1));}
return domain;});}});this.columnInvisibleFields=columnInvisibleFields;},_onAddRecord:function(){},_onRemoveRecord:function(ev){ev.stopPropagation();var operation=this.isMany2Many?'FORGET':'DELETE';this._setValue({operation:operation,ids:[ev.data.id],});},_onDiscardChanges:function(ev){if(ev.target!==this){ev.stopPropagation();this.trigger_up('discard_changes',_.extend({},ev.data,{fieldName:this.name}));}},_onEditLine:function(ev){ev.stopPropagation();this.trigger_up('edited_list',{id:this.value.id});this.renderer.setRowMode(ev.data.recordId,'edit').then(ev.data.onSuccess);},_onFieldChanged:function(ev){if(ev.target===this){ev.initialEvent=this.lastInitialEvent;return;}
ev.stopPropagation();var changes=ev.data.changes;this.lastInitialEvent=undefined;if(Object.keys(changes).length){this.lastInitialEvent=ev;this._setValue({operation:'UPDATE',id:ev.data.dataPointID,data:changes,}).then(function(){if(ev.data.onSuccess){ev.data.onSuccess();}}).guardedCatch(function(reason){if(ev.data.onFailure){ev.data.onFailure(reason);}});}},_onNavigationMove:function(ev){if(this.view.arch.tag==='tree'){var $curControl=this.renderer.$('.o_field_x2many_list_row_add a:focus');if($curControl.length){var $nextControl;if(ev.data.direction==='right'){$nextControl=$curControl.next('a');}else if(ev.data.direction==='left'){$nextControl=$curControl.prev('a');}
if($nextControl&&$nextControl.length){ev.stopPropagation();$nextControl.focus();return;}}}
this._super.apply(this,arguments);},_onOpenRecord:function(){},_onPagerChanged:function(ev){ev.stopPropagation();const{currentMinimum,limit}=ev.data;this._updateControlPanel({currentMinimum,limit});this.trigger_up('load',{id:this.value.id,limit,offset:currentMinimum-1,on_success:value=>{this.value=value;this.pagingState.limit=value.limit;this.pagingState.size=value.count;this._render();},});},_onSaveLine:function(ev){var self=this;ev.stopPropagation();this.renderer.commitChanges(ev.data.recordID).then(function(){self.trigger_up('mutexify',{action:function(){return self._saveLine(ev.data.recordID).then(ev.data.onSuccess).guardedCatch(ev.data.onFailure);},});});},_onSaveOrLoadOptionalFields:function(ev){ev.data.keyParts.relationalField=this.name;ev.data.keyParts.subViewId=this.view.view_id;ev.data.keyParts.subViewType=this.view.type;},_onResequenceRecords:function(ev){ev.stopPropagation();var self=this;if(this.view.arch.tag==='tree'){this.trigger_up('edited_list',{id:this.value.id});}
var handleField=ev.data.handleField;var offset=ev.data.offset;var recordIds=ev.data.recordIds.slice();var recordId=recordIds.pop();var proms=recordIds.map(function(recordId,index){var data={};data[handleField]=offset+index;return self._setValue({operation:'UPDATE',id:recordId,data:data,},{notifyChange:false,});});Promise.all(proms).then(function(){function always(){if(self.view.arch.tag==='tree'){self.trigger_up('toggle_column_order',{id:self.value.id,name:handleField,});}}
var data={};data[handleField]=offset+recordIds.length;self._setValue({operation:'UPDATE',id:recordId,data:data,}).then(always).guardedCatch(always);});},_onToggleColumnOrder:function(ev){ev.data.field=this.name;},_onActiveNextWidget:function(e){e.stopPropagation();this.renderer.unselectRow();this.trigger_up('navigation_move',{direction:e.data.direction||'next',});},});var One2ManyKanbanRecord=KanbanRecord.extend({_postProcessObjectButtons:function(){var self=this;if(!this.state.res_id){this.$('.oe_kanban_action[data-type=object]').each(function(index,button){var $button=$(button);if($button.attr('warn')){$button.on('click',function(e){e.stopPropagation();self.do_warn(false,_t('Please click on the "save" button first'));});}else{$button.attr('disabled','disabled');}});}},_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){self._postProcessObjectButtons();});},});var One2ManyKanbanRenderer=KanbanRenderer.extend({config:_.extend({},KanbanRenderer.prototype.config,{KanbanRecord:One2ManyKanbanRecord,}),});var FieldOne2Many=FieldX2Many.extend({description:_lt("One2many"),className:'o_field_one2many',supportedFieldTypes:['one2many'],init:function(){this._super.apply(this,arguments);this.creatingRecord=false;},reset:function(record,ev){var self=this;return this._super.apply(this,arguments).then(()=>{if(ev&&ev.target===self&&ev.data.changes&&self.view.arch.tag==='tree'){if(ev.data.changes[self.name]&&ev.data.changes[self.name].operation==='CREATE'){var index=0;if(self.editable!=='top'){index=self.value.data.length-1;}
var newID=self.value.data[index].id;return self.renderer.editRecord(newID);}}});},_getButtonsRenderingContext(){const renderingContext=this._super(...arguments);renderingContext.noCreate=!this.canCreate;return renderingContext;},_getRenderer:function(){if(this.view.arch.tag==='kanban'){return One2ManyKanbanRenderer;}
return this._super.apply(this,arguments);},_renderButtons:function(){if(this.activeActions.create){return this._super(...arguments);}},_openFormDialog:function(params){var context=this.record.getContext(_.extend({},this.recordParams,{additionalContext:params.context}));if(this.nodeOptions.no_open){return;}
this.trigger_up('open_one2many_record',_.extend(params,{domain:this.record.getDomain(this.recordParams),context:context,field:this.field,fields_view:this.attrs.views&&this.attrs.views.form,parentID:this.value.id,viewInfo:this.view,deletable:this.activeActions.delete&&params.deletable&&this.canDelete,}));},_onAddRecord:function(ev){var self=this;var data=ev.data||{};ev.stopPropagation();if(this.editable||data.forceEditable){if(!this.activeActions.create){if(data.onFail){data.onFail();}}else if(!this.creatingRecord){this.creatingRecord=true;this.trigger_up('edited_list',{id:this.value.id});this._setValue({operation:'CREATE',position:this.editable||data.forceEditable,context:data.context,},{allowWarning:data.allowWarning}).then(function(){self.creatingRecord=false;}).then(function(){if(data.onSuccess){data.onSuccess();}}).guardedCatch(function(){self.creatingRecord=false;});}}else{this._openFormDialog({context:data.context&&data.context[0],on_saved:function(record){self._setValue({operation:'ADD',id:record.id});},});}},_onOpenRecord:function(ev){var self=this;ev.stopPropagation();var id=ev.data.id;var onSaved=function(record){if(_.some(self.value.data,{id:record.id})){self._setValue({operation:'UPDATE',id:record.id});}else{self._setValue({operation:'ADD',id:record.id});}};this._openFormDialog({id:id,on_saved:onSaved,on_remove:function(){self._setValue({operation:'DELETE',ids:[id]});},deletable:this.activeActions.delete&&this.view.arch.tag!=='tree'&&this.canDelete,readonly:this.mode==='readonly',});},});var FieldMany2Many=FieldX2Many.extend({description:_lt("Many2many"),className:'o_field_many2many',supportedFieldTypes:['many2many'],onAddRecordOpenDialog:function(){var self=this;var domain=this.record.getDomain({fieldName:this.name});new dialogs.SelectCreateDialog(this,{res_model:this.field.relation,domain:domain.concat(["!",["id","in",this.value.res_ids]]),context:this.record.getContext(this.recordParams),title:_t("Add: ")+this.string,no_create:this.nodeOptions.no_create||!this.activeActions.create||!this.canCreate,fields_view:this.attrs.views.form,kanban_view_ref:this.attrs.kanban_view_ref,on_selected:function(records){var resIDs=_.pluck(records,'id');var newIDs=_.difference(resIDs,self.value.res_ids);if(newIDs.length){var values=_.map(newIDs,function(id){return{id:id};});self._setValue({operation:'ADD_M2M',ids:values,});}}}).open();},_getButtonsRenderingContext(){const renderingContext=this._super(...arguments);renderingContext.noCreate=!this.canLink;return renderingContext;},_onAddRecord:function(ev){ev.stopPropagation();this.onAddRecordOpenDialog();},_onOpenRecord:function(ev){var self=this;_.extend(ev.data,{context:this.record.getContext(this.recordParams),domain:this.record.getDomain(this.recordParams),fields_view:this.attrs.views&&this.attrs.views.form,on_saved:function(){self._setValue({operation:'TRIGGER_ONCHANGE'},{forceChange:true}).then(function(){self.trigger_up('reload',{db_id:ev.data.id});});},on_remove:function(){self._setValue({operation:'FORGET',ids:[ev.data.id]});},readonly:this.mode==='readonly',deletable:this.activeActions.delete&&this.view.arch.tag!=='tree'&&this.canDelete,string:this.string,});},});var FieldMany2ManyBinaryMultiFiles=AbstractField.extend({template:"FieldBinaryFileUploader",template_files:"FieldBinaryFileUploader.files",supportedFieldTypes:['many2many'],fieldsToFetch:{name:{type:'char'},mimetype:{type:'char'},},events:{'click .o_attach':'_onAttach','click .o_attachment_delete':'_onDelete','change .o_input_file':'_onFileChanged',},init:function(){this._super.apply(this,arguments);if(this.field.type!=='many2many'||this.field.relation!=='ir.attachment'){var msg=_t("The type of the field '%s' must be a many2many field with a relation to 'ir.attachment' model.");throw _.str.sprintf(msg,this.field.string);}
this.uploadedFiles={};this.uploadingFiles=[];this.fileupload_id=_.uniqueId('oe_fileupload_temp');this.accepted_file_extensions=(this.nodeOptions&&this.nodeOptions.accepted_file_extensions)||this.accepted_file_extensions||'*';$(window).on(this.fileupload_id,this._onFileLoaded.bind(this));this.metadata={};},destroy:function(){this._super();$(window).off(this.fileupload_id);},_getFileUrl:function(attachment){return'/web/content/'+attachment.id+'?download=true';},_generatedMetadata:function(){var self=this;_.each(this.value.data,function(record){self.metadata[record.id]={allowUnlink:self.uploadedFiles[record.data.id]||false,url:self._getFileUrl(record.data),};});},_render:function(){this._generatedMetadata();this.$('.oe_placeholder_files, .o_attachments').replaceWith($(qweb.render(this.template_files,{widget:this,})));this.$('.oe_fileupload').show();this.$('.o_image[data-mimetype^="image"]').each(function(){var $img=$(this);if(/gif|jpe|jpg|png/.test($img.data('mimetype'))&&$img.data('src')){$img.css('background-image',"url('"+$img.data('src')+"')");}});},_onAttach:function(){this.$('.o_input_file').click();},_onDelete:function(ev){ev.preventDefault();ev.stopPropagation();var fileID=$(ev.currentTarget).data('id');var record=_.findWhere(this.value.data,{res_id:fileID});if(record){this._setValue({operation:'FORGET',ids:[record.id],});var metadata=this.metadata[record.id];if(!metadata||metadata.allowUnlink){this._rpc({model:'ir.attachment',method:'unlink',args:[record.res_id],});}}},_onFileChanged:function(ev){var self=this;ev.stopPropagation();var files=ev.target.files;var attachment_ids=this.value.res_ids;if(files.length===0)
return;_.each(files,function(file){var record=_.find(self.value.data,function(attachment){return attachment.data.name===file.name;});if(record){var metadata=self.metadata[record.id];if(!metadata||metadata.allowUnlink){attachment_ids=_.without(attachment_ids,record.res_id);self._rpc({model:'ir.attachment',method:'unlink',args:[record.res_id],});}}
self.uploadingFiles.push(file);});this._setValue({operation:'REPLACE_WITH',ids:attachment_ids,});this.$('form.o_form_binary_form').submit();this.$('.oe_fileupload').hide();ev.target.value="";},_onFileLoaded:function(){var self=this;var files=Array.prototype.slice.call(arguments,1);this.uploadingFiles=[];var attachment_ids=this.value.res_ids;_.each(files,function(file){if(file.error){self.do_warn(_t('Uploading Error'),file.error);}else{attachment_ids.push(file.id);self.uploadedFiles[file.id]=true;}});this._setValue({operation:'REPLACE_WITH',ids:attachment_ids,});},});var FieldMany2ManyTags=AbstractField.extend({description:_lt("Tags"),tag_template:"FieldMany2ManyTag",className:"o_field_many2manytags",supportedFieldTypes:['many2many'],custom_events:_.extend({},AbstractField.prototype.custom_events,{field_changed:'_onFieldChanged',}),events:_.extend({},AbstractField.prototype.events,{'click .o_delete':'_onDeleteTag',}),fieldsToFetch:{display_name:{type:'char'},},limit:1000,init:function(){this._super.apply(this,arguments);if(this.mode==='edit'){this.className+=' o_input';}
this.colorField=this.nodeOptions.color_field;this.hasDropdown=false;this._computeAvailableActions(this.record);this.resetOnAnyFieldChange=this.resetOnAnyFieldChange||'create'in this.nodeOptions;},activate:function(){return this.many2one?this.many2one.activate():false;},getFocusableElement:function(){return this.many2one?this.many2one.getFocusableElement():$();},isSet:function(){return!!this.value&&this.value.count;},reset:function(record,event){var self=this;this._computeAvailableActions(record);return this._super.apply(this,arguments).then(function(){if(event&&event.target===self){self.activate();}});},_addTag:function(data){if(!_.contains(this.value.res_ids,data.id)){return this._setValue({operation:'ADD_M2M',ids:data});}
return Promise.resolve();},_computeAvailableActions:function(record){const evalContext=record.evalContext;this.canCreate='create'in this.nodeOptions?new Domain(this.nodeOptions.create,evalContext).compute(evalContext):true;},_getRenderTagsContext:function(){var elements=this.value?_.pluck(this.value.data,'data'):[];return{colorField:this.colorField,elements:elements,hasDropdown:this.hasDropdown,readonly:this.mode==="readonly",};},_removeTag:function(id){var record=_.findWhere(this.value.data,{res_id:id});this._setValue({operation:'FORGET',ids:[record.id],});},_renderEdit:function(){var self=this;this._renderTags();if(this.many2one){this.many2one.destroy();}
this.many2one=new FieldMany2One(this,this.name,this.record,{mode:'edit',noOpen:true,noCreate:!this.canCreate,viewType:this.viewType,attrs:this.attrs,});this.many2one.value=false;this.many2one.m2o_value='';this.many2one._getSearchBlacklist=function(){return self.value.res_ids;};var _getSearchCreatePopupOptions=this.many2one._getSearchCreatePopupOptions;this.many2one._getSearchCreatePopupOptions=function(view,ids,context,dynamicFilters){var options=_getSearchCreatePopupOptions.apply(this,arguments);var domain=this.record.getDomain({fieldName:this.name});var m2mRecords=[];return _.extend({},options,{domain:domain.concat(["!",["id","in",self.value.res_ids]]),disable_multiple_selection:false,on_selected:function(records){m2mRecords.push(...records);},on_closed:function(){self.many2one.reinitialize(m2mRecords);},});};return this.many2one.appendTo(this.$el);},_renderReadonly:function(){this._renderTags();},_renderTags:function(){this.$el.html(qweb.render(this.tag_template,this._getRenderTagsContext()));},_onDeleteTag:function(event){event.preventDefault();event.stopPropagation();this._removeTag($(event.target).parent().data('id'));},_onFieldChanged:function(ev){if(ev.target!==this.many2one){return;}
ev.stopPropagation();var newValue=ev.data.changes[this.name];if(newValue){this._addTag(newValue).then(ev.data.onSuccess||function(){}).guardedCatch(ev.data.onFailure||function(){});this.many2one.reinitialize(false);}},_onKeydown:function(ev){if(ev.which===$.ui.keyCode.BACKSPACE&&this.$('input').val()===""){var $badges=this.$('.badge');if($badges.length){this._removeTag($badges.last().data('id'));return;}}
this._super.apply(this,arguments);},_onQuickCreate:function(event){this._quickCreate(event.data.value);},});var FieldMany2ManyTagsAvatar=FieldMany2ManyTags.extend({tag_template:'FieldMany2ManyTagAvatar',className:'o_field_many2manytags avatar',_getRenderTagsContext:function(){var result=this._super.apply(this,arguments);result.avatarModel=this.nodeOptions.avatarModel||this.field.relation;result.avatarField=this.nodeOptions.avatarField||'image_128';return result;},});var FormFieldMany2ManyTags=FieldMany2ManyTags.extend({events:_.extend({},FieldMany2ManyTags.prototype.events,{'click .dropdown-toggle':'_onOpenColorPicker','mousedown .o_colorpicker a':'_onUpdateColor','mousedown .o_colorpicker .o_hide_in_kanban':'_onUpdateColor',}),init:function(){this._super.apply(this,arguments);this.hasDropdown=!!this.colorField;},_onOpenColorPicker:function(ev){ev.preventDefault();if(this.nodeOptions.no_edit_color){ev.stopPropagation();return;}
var tagID=$(ev.currentTarget).parent().data('id');var tagColor=$(ev.currentTarget).parent().data('color');var tag=_.findWhere(this.value.data,{res_id:tagID});if(tag&&this.colorField in tag.data){this.$color_picker=$(qweb.render('FieldMany2ManyTag.colorpicker',{'widget':this,'tag_id':tagID,}));$(ev.currentTarget).after(this.$color_picker);this.$color_picker.dropdown();this.$color_picker.attr("tabindex",1).focus();if(!tagColor){this.$('.custom-checkbox input').prop('checked',true);}}},_onUpdateColor:function(ev){ev.preventDefault();var $target=$(ev.currentTarget);var color=$target.data('color');var id=$target.data('id');var $tag=this.$(".badge[data-id='"+id+"']");var currentColor=$tag.data('color');var changes={};if($target.is('.o_hide_in_kanban')){var $checkbox=$('.o_hide_in_kanban .custom-checkbox input');$checkbox.prop('checked',!$checkbox.prop('checked'));this.prevColors=this.prevColors?this.prevColors:{};if($checkbox.is(':checked')){this.prevColors[id]=currentColor;}else{color=this.prevColors[id]?this.prevColors[id]:1;}}else if($target.is('[class^="o_tag_color"]')){if(color===currentColor){return;}}
changes[this.colorField]=color;this.trigger_up('field_changed',{dataPointID:_.findWhere(this.value.data,{res_id:id}).id,changes:changes,force_save:true,});},});var KanbanFieldMany2ManyTags=FieldMany2ManyTags.extend({events:AbstractField.prototype.events,_render:function(){var self=this;if(this.$el){this.$el.empty().addClass('o_field_many2manytags o_kanban_tags');}
_.each(this.value.data,function(m2m){if(self.colorField in m2m.data&&!m2m.data[self.colorField]){return;}
$('<span>',{class:'o_tag o_tag_color_'+(m2m.data[self.colorField]||0),text:m2m.data.display_name,}).prepend('<span>').appendTo(self.$el);});},});var FieldMany2ManyCheckBoxes=AbstractField.extend({description:_lt("Checkboxes"),template:'FieldMany2ManyCheckBoxes',events:_.extend({},AbstractField.prototype.events,{change:'_onChange',}),specialData:"_fetchSpecialRelation",supportedFieldTypes:['many2many'],limit:100000,init:function(){this._super.apply(this,arguments);this.m2mValues=this.record.specialData[this.name];},isSet:function(){return true;},_renderCheckboxes:function(){var self=this;this.m2mValues=this.record.specialData[this.name];this.$el.html(qweb.render(this.template,{widget:this}));_.each(this.value.res_ids,function(id){self.$('input[data-record-id="'+id+'"]').prop('checked',true);});},_renderEdit:function(){this._renderCheckboxes();},_renderReadonly:function(){this._renderCheckboxes();this.$("input").prop("disabled",true);},_onChange:function(){var ids=_.map(this.$('input:checked'),function(input){return $(input).data("record-id");});const displayedIds=this.m2mValues.map(v=>v[0]);const idsInRelation=this.value.res_ids;ids=ids.concat(idsInRelation.filter(a=>!displayedIds.includes(a)));this._setValue({operation:'REPLACE_WITH',ids:ids,});},});var FieldStatus=AbstractField.extend({className:'o_statusbar_status',events:{'click button:not(.dropdown-toggle)':'_onClickStage',},specialData:"_fetchSpecialStatus",supportedFieldTypes:['selection','many2one'],init:function(){this._super.apply(this,arguments);this._setState();this._onClickStage=_.debounce(this._onClickStage,300,true);try{this.isClickable=!!JSON.parse(this.attrs.clickable);}catch(_){this.isClickable=!!this.nodeOptions.clickable;}},isEmpty:function(){return false;},_reset:function(){this._super.apply(this,arguments);this._setState();},_setState:function(){var self=this;if(this.field.type==='many2one'){this.status_information=_.map(this.record.specialData[this.name],function(info){return _.extend({selected:info.id===self.value.res_id,},info);});}else{var selection=this.field.selection;if(this.attrs.statusbar_visible){var restriction=this.attrs.statusbar_visible.split(",");selection=_.filter(selection,function(val){return _.contains(restriction,val[0])||val[0]===self.value;});}
this.status_information=_.map(selection,function(val){return{id:val[0],display_name:val[1],selected:val[0]===self.value,fold:false};});}},_render:function(){var selections=_.partition(this.status_information,function(info){return(info.selected||!info.fold);});this.$el.html(qweb.render("FieldStatus.content",{selection_unfolded:selections[0],selection_folded:selections[1],clickable:this.isClickable,}));},_onClickStage:function(e){this._setValue($(e.currentTarget).data("value"));},});var FieldSelection=AbstractField.extend({description:_lt("Selection"),template:'FieldSelection',specialData:"_fetchSpecialRelation",supportedFieldTypes:['selection'],events:_.extend({},AbstractField.prototype.events,{'change':'_onChange',}),init:function(){this._super.apply(this,arguments);this._setValues();},getFocusableElement:function(){return this.$el&&this.$el.is('select')?this.$el:$();},isSet:function(){return this.value!==false;},updateModifiersValue:function(){this._super.apply(this,arguments);if(!this.attrs.modifiersValue.invisible&&this.mode!=='readonly'){this._setValues();this._renderEdit();}},_renderEdit:function(){this.$el.empty();var required=this.attrs.modifiersValue&&this.attrs.modifiersValue.required;for(var i=0;i<this.values.length;i++){var disabled=required&&this.values[i][0]===false;this.$el.append($('<option/>',{value:JSON.stringify(this.values[i][0]),text:this.values[i][1],style:disabled?"display: none":"",}));}
this.$el.val(JSON.stringify(this._getRawValue()));},_renderReadonly:function(){this.$el.empty().text(this._formatValue(this.value));this.$el.attr('raw-value',this._getRawValue());},_getRawValue:function(){var raw_value=this.value;if(this.field.type==='many2one'&&raw_value){raw_value=raw_value.data.id;}
return raw_value;},_reset:function(){this._super.apply(this,arguments);this._setValues();},_setValues:function(){if(this.field.type==='many2one'){this.values=this.record.specialData[this.name];this.formatType='many2one';}else{this.values=_.reject(this.field.selection,function(v){return v[0]===false&&v[1]==='';});}
this.values=[[false,this.attrs.placeholder||'']].concat(this.values);},_onChange:function(){var res_id=JSON.parse(this.$el.val());if(this.field.type==='many2one'){var value=_.find(this.values,function(val){return val[0]===res_id;});this._setValue({id:res_id,display_name:value[1]});}else{this._setValue(res_id);}},});var FieldRadio=FieldSelection.extend({description:_lt("Radio"),template:null,className:'o_field_radio',tagName:'span',specialData:"_fetchSpecialMany2ones",supportedFieldTypes:['selection','many2one'],events:_.extend({},AbstractField.prototype.events,{'click input':'_onInputClick',}),init:function(){this._super.apply(this,arguments);if(this.mode==='edit'){this.tagName='div';this.className+=this.nodeOptions.horizontal?' o_horizontal':' o_vertical';}
this.unique_id=_.uniqueId("radio");this._setValues();},getFocusableElement:function(){var checked=this.$("[checked='true']");return checked.length?checked:this.$("[data-index='0']");},isSet:function(){return true;},setIDForLabel:function(id){this.$el.attr('id',id);},_renderEdit:function(){var self=this;var currentValue;if(this.field.type==='many2one'){currentValue=this.value&&this.value.data.id;}else{currentValue=this.value;}
this.$el.empty();this.$el.attr('role','radiogroup').attr('aria-label',this.string);_.each(this.values,function(value,index){self.$el.append(qweb.render('FieldRadio.button',{checked:value[0]===currentValue,id:self.unique_id+'_'+value[0],index:index,name:self.unique_id,value:value,}));});},_reset:function(){this._super.apply(this,arguments);this._setValues();},_setValues:function(){if(this.field.type==='selection'){this.values=this.field.selection||[];}else if(this.field.type==='many2one'){this.values=_.map(this.record.specialData[this.name],function(val){return[val.id,val.display_name];});}},_onInputClick:function(event){var index=$(event.target).data('index');var value=this.values[index];if(this.field.type==='many2one'){this._setValue({id:value[0],display_name:value[1]});}else{this._setValue(value[0]);}},});var FieldSelectionBadge=FieldSelection.extend({description:_lt("Badges"),template:null,className:'o_field_selection_badge',tagName:'span',specialData:"_fetchSpecialMany2ones",events:_.extend({},AbstractField.prototype.events,{'click span.o_selection_badge':'_onBadgeClicked',}),_renderEdit:function(){this.currentValue=this.value;if(this.field.type==='many2one'){this.currentValue=this.value&&this.value.data.id;}
this.$el.empty();this.$el.html(qweb.render('FieldSelectionBadge',{'values':this.values,'current_value':this.currentValue}));},_setValues:function(){if(this.field.type==='selection'){this.values=this.field.selection||[];}else if(this.field.type==='many2one'){this.values=_.map(this.record.specialData[this.name],function(val){return[val.id,val.display_name];});}},_onBadgeClicked:function(event){var index=$(event.target).data('index');var value=this.values[index];if(value[0]!==this.currentValue){if(this.field.type==='many2one'){this._setValue({id:value[0],display_name:value[1]});}else{this._setValue(value[0]);}}else{this._setValue(false);}},});var FieldSelectionFont=FieldSelection.extend({_renderEdit:function(){this._super.apply(this,arguments);this.$('option').each(function(i,option){if(!option.label){$(option).remove();}
$(option).css('font-family',option.value);});this.$el.css('font-family',this.value);},});var FieldReference=FieldMany2One.extend({specialData:"_fetchSpecialReference",supportedFieldTypes:['reference'],template:'FieldReference',events:_.extend({},FieldMany2One.prototype.events,{'change select':'_onSelectionChange',}),init:function(){this._super.apply(this,arguments);this.field=_.extend({},this.field);this._setState();},start:function(){this.$('select').val(this.field.relation);return this._super.apply(this,arguments);},getFocusableElement:function(){if(this.mode==='edit'&&!this.field.relation){return this.$('select');}
return this._super.apply(this,arguments);},_formatValue:function(){var value;if(this.field.type==='char'){value=this.record.specialData[this.name];}else{value=this.value;}
return value&&value.data&&value.data.display_name||'';},_renderEdit:function(){this._super.apply(this,arguments);if(this.$('select').val()){this.$('.o_input_dropdown').show();this.$el.addClass('o_row');}else{this.$('.o_input_dropdown').hide();}},_reset:function(){this._super.apply(this,arguments);var value=this.$('select').val();this._setState();this.$('select').val(this.value&&this.value.model||value);},_setRelation:function(model){this.field.relation=model;},_setState:function(){if(this.field.type==='char'){this.value=this.record.specialData[this.name];}
if(this.value){this._setRelation(this.value.model);}},_setValue:function(value,options){value=value||{};value.model=this.$('select').val();return this._super(value,options);},_onSelectionChange:function(){var value=this.$('select').val();this.reinitialize(false);this._setRelation(value);},});return{FieldMany2One:FieldMany2One,Many2oneBarcode:Many2oneBarcode,KanbanFieldMany2One:KanbanFieldMany2One,ListFieldMany2One:ListFieldMany2One,Many2OneAvatar:Many2OneAvatar,FieldX2Many:FieldX2Many,FieldOne2Many:FieldOne2Many,FieldMany2Many:FieldMany2Many,FieldMany2ManyBinaryMultiFiles:FieldMany2ManyBinaryMultiFiles,FieldMany2ManyCheckBoxes:FieldMany2ManyCheckBoxes,FieldMany2ManyTags:FieldMany2ManyTags,FieldMany2ManyTagsAvatar:FieldMany2ManyTagsAvatar,FormFieldMany2ManyTags:FormFieldMany2ManyTags,KanbanFieldMany2ManyTags:KanbanFieldMany2ManyTags,FieldRadio:FieldRadio,FieldSelectionBadge:FieldSelectionBadge,FieldSelection:FieldSelection,FieldStatus:FieldStatus,FieldSelectionFont:FieldSelectionFont,FieldReference:FieldReference,};});;

/* /web/static/src/js/fields/special_fields.js defined in bundle 'web.assets_backend' */
odoo.define('web.special_fields',function(require){"use strict";var core=require('web.core');var field_utils=require('web.field_utils');var relational_fields=require('web.relational_fields');var AbstractField=require('web.AbstractField');var FieldSelection=relational_fields.FieldSelection;var _t=core._t;var _lt=core._lt;var FieldTimezoneMismatch=FieldSelection.extend({start:function(){var interval=navigator.platform.toUpperCase().indexOf('MAC')>=0?60000:1000;this._datetime=setInterval(this._renderDateTimeTimezone.bind(this),interval);return this._super.apply(this,arguments);},destroy:function(){clearInterval(this._datetime);return this._super();},_render:function(){this._super.apply(this,arguments);this._renderTimezoneMismatch();},_renderDateTimeTimezone:function(){if(!this.mismatch||!this.$option.html()){return;}
var offset=this.recordData.tz_offset.match(/([+-])([0-9]{2})([0-9]{2})/);offset=(offset[1]==='-'?-1:1)*(parseInt(offset[2])*60+parseInt(offset[3]));var datetime=field_utils.format.datetime(moment.utc().add(offset,'minutes'),this.field,{timezone:false});var content=this.$option.html().split(' ')[0];content+='    ('+datetime+')';this.$option.html(content);},_renderTimezoneMismatch:function(){this.$el.last().filter('.o_tz_warning').remove();this.$el=this.$el.first();var value=this.$el.val();var $span=$('<span class="fa fa-exclamation-triangle o_tz_warning"/>');if(this.$option&&this.$option.html()){this.$option.html(this.$option.html().split(' ')[0]);}
var userOffset=this.recordData.tz_offset;this.mismatch=false;if(userOffset&&value!==""&&value!=="false"){var offset=-(new Date().getTimezoneOffset());var browserOffset=(offset<0)?"-":"+";browserOffset+=_.str.sprintf("%02d",Math.abs(offset/60));browserOffset+=_.str.sprintf("%02d",Math.abs(offset%60));this.mismatch=(browserOffset!==userOffset);}
if(this.mismatch){$span.insertAfter(this.$el);$span.attr('title',_t("Timezone Mismatch : This timezone is different from that of your browser.\nPlease, set the same timezone as your browser's to avoid time discrepancies in your system."));this.$el=this.$el.add($span);this.$option=this.$('option').filter(function(){return $(this).attr('value')===value;});this._renderDateTimeTimezone();}else if(value=="false"){$span.insertAfter(this.$el);$span.attr('title',_t("Set a timezone on your user"));this.$el=this.$el.add($span);}},_renderEdit:function(){var $otherEl=this.$el.not('select');this.$el=this.$el.first();this._super.apply(this,arguments);$otherEl.insertAfter(this.$el);this.$el=this.$el.add($otherEl);},});var FieldReportLayout=relational_fields.FieldMany2One.extend({events:_.extend({},relational_fields.FieldMany2One.prototype.events,{'click img':'_onImgClicked',}),willStart:function(){var self=this;this.previews={};return this._super().then(function(){return self._rpc({model:'report.layout',method:"search_read"}).then(function(values){self.previews=values;});});},_render:function(){var self=this;this.$el.empty();var value=_.isObject(this.value)?this.value.data.id:this.value;_.each(this.previews,function(val){var $container=$('<div>').addClass('col-3 text-center');var $img=$('<img>').addClass('img img-fluid img-thumbnail ml16').toggleClass('btn-info',val.view_id[0]===value).attr('src',val.image).data('key',val.view_id[0]);$container.append($img);if(val.pdf){var $previewLink=$('<a>').text('Example').attr('href',val.pdf).attr('target','_blank');$container.append($previewLink);}
self.$el.append($container);});},_onImgClicked:function(event){this._setValue($(event.currentTarget).data('key'));},});const IframeWrapper=AbstractField.extend({description:_lt("Wrap raw html within an iframe"),supportedFieldTypes:['text','html'],template:"web.IframeWrapper",_render(){const spinner=this.el.querySelector('.o_iframe_wrapper_spinner');const iframe=this.el.querySelector('.o_preview_iframe');iframe.style.display='none';spinner.style.display='block';let resolver;$(iframe).data('ready',new Promise((resolve)=>{resolver=resolve;}));const onloadReplacement=setInterval(()=>{const iframeDoc=iframe.contentDocument;if(iframeDoc&&(iframeDoc.readyState==='complete'||iframeDoc.readyState==='interactive')){iframeDoc.open();iframeDoc.write(this.value);iframeDoc.close();iframe.style.display='block';spinner.style.display='none';resolver();clearInterval(onloadReplacement);}},100);}});return{FieldTimezoneMismatch:FieldTimezoneMismatch,FieldReportLayout:FieldReportLayout,IframeWrapper,};});;

/* /web/static/src/js/fields/upgrade_fields.js defined in bundle 'web.assets_backend' */
odoo.define('web.upgrade_widgets',function(require){"use strict";var AbstractField=require('web.AbstractField');var basic_fields=require('web.basic_fields');var core=require('web.core');var Dialog=require('web.Dialog');var field_registry=require('web.field_registry');var framework=require('web.framework');var relational_fields=require('web.relational_fields');var _t=core._t;var QWeb=core.qweb;var FieldBoolean=basic_fields.FieldBoolean;var FieldRadio=relational_fields.FieldRadio;var AbstractFieldUpgrade={_confirmUpgrade:function(){return this._rpc({model:'res.users',method:'search_count',args:[[["share","=",false]]],}).then(function(data){framework.redirect("https://www.odoo.com/odoo-enterprise/upgrade?num_users="+data);});},_insertEnterpriseLabel:function($enterpriseLabel){},_openDialog:function(){var message=$(QWeb.render('EnterpriseUpgrade'));var buttons=[{text:_t("Upgrade now"),classes:'btn-primary',close:true,click:this._confirmUpgrade.bind(this),},{text:_t("Cancel"),close:true,},];return new Dialog(this,{size:'medium',buttons:buttons,$content:$('<div>',{html:message,}),title:_t("Odoo Enterprise"),}).open();},_render:function(){this._super.apply(this,arguments);this._insertEnterpriseLabel($("<span>",{text:"Enterprise",'class':"badge badge-primary oe_inline o_enterprise_label"}));},_resetValue:function(){},_onInputClicked:function(event){if($(event.currentTarget).prop("checked")){this._openDialog().on('closed',this,this._resetValue.bind(this));}},};var UpgradeBoolean=FieldBoolean.extend(AbstractFieldUpgrade,{supportedFieldTypes:[],events:_.extend({},AbstractField.prototype.events,{'click input':'_onInputClicked',}),renderWithLabel:function($label){this.$label=$label;this._render();},_insertEnterpriseLabel:function($enterpriseLabel){var $el=this.$label||this.$el;$el.append('&nbsp;').append($enterpriseLabel);},_resetValue:function(){this.$input.prop("checked",false).change();},});var UpgradeRadio=FieldRadio.extend(AbstractFieldUpgrade,{supportedFieldTypes:[],events:_.extend({},FieldRadio.prototype.events,{'click input:last':'_onInputClicked',}),isSet:function(){return true;},_insertEnterpriseLabel:function($enterpriseLabel){this.$('label').last().append('&nbsp;').append($enterpriseLabel);},_resetValue:function(){this.$('input').first().prop("checked",true).click();},});field_registry.add('upgrade_boolean',UpgradeBoolean).add('upgrade_radio',UpgradeRadio);});;

/* /web/static/src/js/fields/field_wrapper.js defined in bundle 'web.assets_backend' */
odoo.define('web.FieldWrapper',function(require){"use strict";const{ComponentWrapper}=require('web.OwlCompatibility');const field_utils=require('web.field_utils');class FieldWrapper extends ComponentWrapper{constructor(){super(...arguments);this._data={};const options=this.props.options||{};const record=this.props.record;this._data.name=this.props.fieldName;this._data.record=record;this._data.field=record.fields[this._data.name];this._data.viewType=options.viewType||'default';const fieldsInfo=record.fieldsInfo[this._data.viewType];this._data.attrs=options.attrs||(fieldsInfo&&fieldsInfo[this._data.name])||{};this._data.additionalContext=options.additionalContext||{};this._data.value=record.data[this._data.name];this._data.recordData=record.data;this._data.string=this._data.attrs.string||this._data.field.string||this._data.name;this._data.nodeOptions=this._data.attrs.options||{};this._data.dataPointID=record.id;this._data.res_id=record.res_id;this._data.model=record.model;this._data.mode=options.mode||"readonly";this._data.formatType=this._data.attrs.widget in field_utils.format?this._data.attrs.widget:this._data.field.type;this._data.formatOptions={};this._data.parseOptions={};if(this._data.attrs.decorations){this._data.resetOnAnyFieldChange=true;}
for(let key in this._data){Object.defineProperty(this,key,{get:()=>{if(this.el){if(key==='dataPointID'){return this.componentRef.comp.dataPointId;}else if(key==='res_id'){return this.componentRef.comp.resId;}}
return(this.el?this.componentRef.comp:this._data)[key];},});}}
mounted(){super.mounted(...arguments);this.componentRef.comp.__node=this.__node;}
get $el(){return $(this.el);}
get fieldDependencies(){return this.Component.fieldDependencies;}
get specialData(){return this.Component.specialData;}
get supportedFieldTypes(){return this.Component.supportedFieldTypes;}
get description(){return this.Component.description;}
get noLabel(){return this.Component.noLabel;}
activate(){return this.componentRef.comp.activate(...arguments);}
commitChanges(){return this.componentRef.comp.commitChanges(...arguments);}
getFocusableElement(){return $(this.componentRef.comp.focusableElement);}
isEmpty(){return this.componentRef.comp.isEmpty;}
isFocusable(){return this.componentRef.comp.isFocusable;}
isSet(){if(this.componentRef.comp){return this.componentRef.comp.isSet;}
const c=new this.Component(null,this.props);const isSet=c.isSet;c.destroy();return isSet;}
isValid(){return this.componentRef.comp.isValid;}
removeInvalidClass(){return this.componentRef.comp.removeInvalidClass(...arguments);}
reset(record,event){return this.update({record,event});}
setIDForLabel(){return this.componentRef.comp.setIdForLabel(...arguments);}
setInvalidClass(){return this.componentRef.comp.setInvalidClass(...arguments);}
updateModifiersValue(modifiers){if(this.props.options.attrs){this.props.options.attrs.modifiersValue=modifiers||{};}else{const viewType=this.props.options.viewType||'default';const fieldsInfo=this.props.record.fieldsInfo[viewType];fieldsInfo[this.props.fieldName].modifiersValue=modifiers||{};}
this.componentRef.comp.props=this.props;}}
return FieldWrapper;});;

/* /web/static/src/js/fields/abstract_field_owl.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractFieldOwl',function(require){"use strict";const field_utils=require('web.field_utils');const{useListener}=require('web.custom_hooks');const{onMounted,onPatched}=owl.hooks;class AbstractField extends owl.Component{constructor(){super(...arguments);this._isValid=true;this._lastSetValue=undefined;useListener('keydown',this._onKeydown);useListener('navigation-move',this._onNavigationMove);onMounted(()=>this._applyDecorations());onPatched(()=>this._applyDecorations());}
__patch(){const res=super.__patch(...arguments);this.el.setAttribute('name',this.name);this.el.classList.add('o_field_widget');return res;}
async willUpdateProps(nextProps){this._lastSetValue=undefined;return super.willUpdateProps(nextProps);}
get additionalContext(){return this.options.additionalContext||{};}
get attrs(){const fieldsInfo=this.record.fieldsInfo[this.viewType];return this.options.attrs||(fieldsInfo&&fieldsInfo[this.name])||{};}
get dataPointId(){return this.record.id;}
get field(){return this.record.fields[this.name];}
get focusableElement(){return null;}
get formatOptions(){return{};}
get formatType(){return this.attrs.widget in field_utils.format?this.attrs.widget:this.field.type;}
get isEmpty(){return!this.isSet;}
get isFocusable(){const focusable=this.focusableElement;return focusable&&!!(focusable.offsetWidth||focusable.offsetHeight||focusable.getClientRects().length);}
get isSet(){return!!this.value;}
get isValid(){return this._isValid;}
get mode(){return this.options.mode||"readonly";}
get model(){return this.record.model;}
get name(){return this.props.fieldName;}
get nodeOptions(){return this.attrs.options||{};}
get options(){return this.props.options||{};}
get parseOptions(){return{};}
get record(){return this.props.record;}
get recordData(){return this.record.data;}
get resetOnAnyFieldChange(){return!!this.attrs.decorations;}
get resId(){return this.record.res_id;}
get string(){return this.attrs.string||this.field.string||this.name;}
get value(){return this.record.data[this.name];}
get viewType(){return this.options.viewType||'default';}
activate(options){if(this.isFocusable){const focusable=this.focusableElement;focusable.focus();if(focusable.matches('input[type="text"], textarea')){focusable.selectionStart=focusable.selectionEnd=focusable.value.length;if(options&&!options.noselect){focusable.select();}}
return true;}
return false;}
commitChanges(){}
removeInvalidClass(){this.el.classList.remove('o_field_invalid');this.el.removeAttribute('aria-invalid');}
setIdForLabel(id){if(this.focusableElement){this.focusableElement.setAttribute('id',id);}}
setInvalidClass(){this.el.classList.add('o_field_invalid');this.el.setAttribute('aria-invalid','true');}
_applyDecorations(){for(const dec of this.attrs.decorations||[]){const isToggled=py.PY_isTrue(py.evaluate(dec.expression,this.record.evalContext));const className=this._getClassFromDecoration(dec.name);this.el.classList.toggle(className,isToggled);}}
_formatValue(value){const options=Object.assign({},this.nodeOptions,{data:this.recordData},this.formatOptions);return field_utils.format[this.formatType](value,this.field,options);}
_getClassFromDecoration(decoration){return`text-${decoration.split('-')[1]}`;}
_isLastSetValue(value){return this._lastSetValue===value||(this.value===false&&value==='');}
_isSameValue(value){return this.value===value;}
_parseValue(value){return field_utils.parse[this.formatType](value,this.field,this.parseOptions);}
_setValue(value,options){if(this._isLastSetValue(value)){return Promise.resolve();}
this._lastSetValue=value;try{value=this._parseValue(value);this._isValid=true;}catch(e){this._isValid=false;this.trigger('set-dirty',{dataPointID:this.dataPointId});return Promise.reject({message:"Value set is not valid"});}
if(!(options&&options.forceChange)&&this._isSameValue(value)){return Promise.resolve();}
return new Promise((resolve,reject)=>{const changes={};changes[this.name]=value;this.trigger('field-changed',{dataPointID:this.dataPointId,changes:changes,viewType:this.viewType,doNotSetDirty:options&&options.doNotSetDirty,notifyChange:!options||options.notifyChange!==false,allowWarning:options&&options.allowWarning,onSuccess:resolve,onFailure:reject,});});}
_onKeydown(ev){switch(ev.which){case $.ui.keyCode.TAB:this.trigger('navigation-move',{direction:ev.shiftKey?'previous':'next',originalEvent:ev,});break;case $.ui.keyCode.ENTER:ev.preventDefault();ev.stopPropagation();this.trigger('navigation-move',{direction:'next_line'});break;case $.ui.keyCode.ESCAPE:this.trigger('navigation-move',{direction:'cancel',originalEvent:ev});break;case $.ui.keyCode.UP:ev.stopPropagation();this.trigger('navigation-move',{direction:'up'});break;case $.ui.keyCode.RIGHT:ev.stopPropagation();this.trigger('navigation-move',{direction:'right'});break;case $.ui.keyCode.DOWN:ev.stopPropagation();this.trigger('navigation-move',{direction:'down'});break;case $.ui.keyCode.LEFT:ev.stopPropagation();this.trigger('navigation-move',{direction:'left'});break;}}
_onNavigationMove(ev){ev.detail.target=this;}}
AbstractField.fieldDependencies={};AbstractField.specialData=false;AbstractField.supportedFieldTypes=[];AbstractField.description="";AbstractField.noLabel=false;AbstractField.label="";return AbstractField;});;

/* /web/static/src/js/fields/basic_fields_owl.js defined in bundle 'web.assets_backend' */
odoo.define('web.basic_fields_owl',function(require){"use strict";const AbstractField=require('web.AbstractFieldOwl');const CustomCheckbox=require('web.CustomCheckbox');const{_lt}=require('web.translation');class FieldBadge extends AbstractField{_getClassFromDecoration(decoration){return`bg-${decoration.split('-')[1]}-light`;}}
FieldBadge.description=_lt("Badge");FieldBadge.supportedFieldTypes=['selection','many2one','char'];FieldBadge.template='web.FieldBadge';class FieldBoolean extends AbstractField{patched(){super.patched();if(this.props.event&&this.props.event.target===this){this.activate();}}
get focusableElement(){return this.mode==='readonly'?null:this.el.querySelector('input');}
get isSet(){return true;}
activate(options){const activated=super.activate(options);if(activated&&options&&options.event&&options.event.target.closest('.custom-control.custom-checkbox')){this._setValue(!this.value);}
return activated;}
setIdForLabel(id){super.setIdForLabel(id);this.el.querySelector('label').setAttribute('for',id);}
_onChange(ev){this._setValue(ev.target.checked);}
_onKeydown(ev){switch(ev.which){case $.ui.keyCode.ENTER:ev.preventDefault();this._setValue(!this.value);return;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:ev.preventDefault();}
super._onKeydown(ev);}}
FieldBoolean.components={CustomCheckbox};FieldBoolean.description=_lt("Checkbox");FieldBoolean.supportedFieldTypes=['boolean'];FieldBoolean.template='web.FieldBoolean';return{FieldBadge,FieldBoolean,};});;

/* /web/static/src/js/views/abstract_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractView',function(require){"use strict";const ActionModel=require("web/static/src/js/views/action_model.js");var AbstractModel=require('web.AbstractModel');var AbstractRenderer=require('web.AbstractRenderer');var AbstractController=require('web.AbstractController');const ControlPanel=require('web.ControlPanel');const SearchPanel=require("web/static/src/js/views/search_panel.js");var mvc=require('web.mvc');var viewUtils=require('web.viewUtils');const{Component}=owl;var Factory=mvc.Factory;var AbstractView=Factory.extend({display_name:'',mobile_friendly:false,icon:'fa-question',multi_record:true,viewType:undefined,withSearchBar:true,searchMenuTypes:['filter','groupBy','favorite'],withControlPanel:true,withSearchPanel:true,config:_.extend({},Factory.prototype.config,{Model:AbstractModel,Renderer:AbstractRenderer,Controller:AbstractController,ControlPanel,SearchPanel,}),init:function(viewInfo,params){this._super.apply(this,arguments);var action=params.action||{};params=_.defaults(params,this._extractParamsFromAction(action));if(typeof viewInfo.arch==='string'){this.fieldsView=this._processFieldsView(viewInfo);}else{this.fieldsView=viewInfo;}
this.arch=this.fieldsView.arch;this.fields=this.fieldsView.viewFields;this.userContext=params.userContext||{};var isEmbedded=params.isEmbedded||false;var help=params.noContentHelp||"";var htmlHelp=document.createElement("div");htmlHelp.innerHTML=help;this.rendererParams={arch:this.arch,isEmbedded:isEmbedded,noContentHelp:htmlHelp.innerText.trim()?help:"",};this.controllerParams={actionViews:params.actionViews,activeActions:{edit:this.arch.attrs.edit?!!JSON.parse(this.arch.attrs.edit):true,create:this.arch.attrs.create?!!JSON.parse(this.arch.attrs.create):true,delete:this.arch.attrs.delete?!!JSON.parse(this.arch.attrs.delete):true,duplicate:this.arch.attrs.duplicate?!!JSON.parse(this.arch.attrs.duplicate):true,},bannerRoute:this.arch.attrs.banner_route,controllerID:params.controllerID,displayName:params.displayName,isEmbedded:isEmbedded,modelName:params.modelName,viewType:this.viewType,};var controllerState=params.controllerState||{};var currentId=controllerState.currentId||params.currentId;this.loadParams={context:params.context,count:params.count||((this.controllerParams.ids!==undefined)&&this.controllerParams.ids.length)||0,domain:params.domain,modelName:params.modelName,res_id:currentId,res_ids:controllerState.resIds||params.ids||(currentId?[currentId]:undefined),};const useSampleModel='useSampleModel'in params?params.useSampleModel:!!(this.arch.attrs.sample&&JSON.parse(this.arch.attrs.sample));this.modelParams={fields:this.fields,modelName:params.modelName,useSampleModel,};if(useSampleModel){this.modelParams.SampleModel=this.config.Model;}
var defaultOrder=this.arch.attrs.default_order;if(defaultOrder){this.loadParams.orderedBy=_.map(defaultOrder.split(','),function(order){order=order.trim().split(' ');return{name:order[0],asc:order[1]!=='desc'};});}
if(params.searchQuery){this._updateMVCParams(params.searchQuery);}
this.withControlPanel=this.withControlPanel&&params.withControlPanel;this.withSearchPanel=this.withSearchPanel&&this.multi_record&&params.withSearchPanel&&!('search_panel'in params.context&&!params.search_panel);const searchModelParams=Object.assign({},params,{action});if(this.withControlPanel||this.withSearchPanel){const{arch,fields,favoriteFilters}=params.controlPanelFieldsView||{};const archInfo=ActionModel.extractArchInfo({search:arch},this.viewType);const controlPanelInfo=archInfo[this.config.ControlPanel.modelExtension];const searchPanelInfo=archInfo[this.config.SearchPanel.modelExtension];this.withSearchPanel=this.withSearchPanel&&Boolean(searchPanelInfo);Object.assign(searchModelParams,{fields,favoriteFilters,controlPanelInfo,searchPanelInfo,});}
const searchModel=this._createSearchModel(searchModelParams);this.controllerParams.searchModel=searchModel;if(this.controllerParams.controlPanel){this.controllerParams.controlPanel.props.searchModel=searchModel;}
if(this.controllerParams.searchPanel){this.controllerParams.searchPanel.props.searchModel=searchModel;}},_createSearchModel:function(params,extraExtensions){const{fields,favoriteFilters,controlPanelInfo,searchPanelInfo}=params;const extensions=Object.assign({},extraExtensions);const importedState=params.controllerState||{};if(this.withControlPanel){const ControlPanelComponent=this.config.ControlPanel;extensions[ControlPanelComponent.modelExtension]={actionId:params.action.id,activateDefaultFavorite:params.activateDefaultFavorite,archNodes:controlPanelInfo.children,dynamicFilters:params.dynamicFilters,favoriteFilters,withSearchBar:params.withSearchBar,};this.controllerParams.withControlPanel=true;const controlPanelProps={action:params.action,breadcrumbs:params.breadcrumbs,fields,searchMenuTypes:params.searchMenuTypes,view:this.fieldsView,views:params.action.views&&params.action.views.filter(v=>v.multiRecord===this.multi_record),withBreadcrumbs:params.withBreadcrumbs,withSearchBar:params.withSearchBar,};this.controllerParams.controlPanel={Component:ControlPanelComponent,props:controlPanelProps,};}
if(this.withSearchPanel){const SearchPanelComponent=this.config.SearchPanel;extensions[SearchPanelComponent.modelExtension]={archNodes:searchPanelInfo.children,};this.controllerParams.withSearchPanel=true;this.rendererParams.withSearchPanel=true;const searchPanelProps={importedState:importedState.searchPanel,};if(searchPanelInfo.attrs.class){searchPanelProps.className=searchPanelInfo.attrs.class;}
this.controllerParams.searchPanel={Component:SearchPanelComponent,props:searchPanelProps,};}
const searchModel=new ActionModel(extensions,{env:Component.env,modelName:params.modelName,context:Object.assign({},this.loadParams.context),domain:this.loadParams.domain||[],importedState:importedState.searchModel,searchMenuTypes:params.searchMenuTypes,searchQuery:params.searchQuery,fields,});return searchModel;},getController:async function(){const _super=this._super.bind(this);const{searchModel}=this.controllerParams;await searchModel.load();this._updateMVCParams(searchModel.get("query"));const modelParent=this.model&&this.model.getParent();const[controller]=await Promise.all([_super(...arguments),searchModel.isReady(),]);if(modelParent){this.model.setParent(modelParent);}
return controller;},getModel:function(){if(!this.model){this.model=this._super.apply(this,arguments);}
return this.model;},setController:function(Controller){this.Controller=Controller;},_extractParamsFromAction:function(action){action=action||{};var context=action.context||{};var inline=action.target==='inline';const params={actionId:action.id||false,actionViews:action.views||[],activateDefaultFavorite:!context.active_id&&!context.active_ids,context:action.context||{},controlPanelFieldsView:action.controlPanelFieldsView,currentId:action.res_id?action.res_id:undefined,displayName:action.display_name||action.name,domain:action.domain||[],limit:action.limit,modelName:action.res_model,noContentHelp:action.help,searchMenuTypes:inline?[]:this.searchMenuTypes,withBreadcrumbs:'no_breadcrumbs'in context?!context.no_breadcrumbs:true,withControlPanel:this.withControlPanel,withSearchBar:inline?false:this.withSearchBar,withSearchPanel:this.withSearchPanel,};if('useSampleModel'in action){params.useSampleModel=action.useSampleModel;}
return params;},_processFieldsView:function(fieldsView){var fv=_.extend({},fieldsView);fv.arch=viewUtils.parseArch(fv.arch);fv.viewFields=_.defaults({},fv.viewFields,fv.fields);return fv;},_updateMVCParams:function(searchQuery){this.loadParams=_.extend(this.loadParams,{context:searchQuery.context,domain:searchQuery.domain,groupedBy:searchQuery.groupBy,});this.loadParams.orderedBy=Array.isArray(searchQuery.orderedBy)&&searchQuery.orderedBy.length?searchQuery.orderedBy:this.loadParams.orderedBy;if(searchQuery.timeRanges){this.loadParams.timeRanges=searchQuery.timeRanges;this.rendererParams.timeRanges=searchQuery.timeRanges;}},});return AbstractView;});;

/* /web/static/src/js/views/abstract_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractRenderer',function(require){"use strict";var mvc=require('web.mvc');const FOCUSABLE_ELEMENTS=['a','button','input','select','textarea','[tabindex="0"]'].map((sel)=>`:scope ${sel}`).join(', ');return mvc.Renderer.extend({sampleDataTargets:[],init:function(parent,state,params){this._super.apply(this,arguments);this.arch=params.arch;this.noContentHelp=params.noContentHelp;this.withSearchPanel=params.withSearchPanel;},async start(){this.$el.addClass(this.arch.attrs.class);if(this.withSearchPanel){this.$el.addClass('o_renderer_with_searchpanel');}
await Promise.all([this._render(),this._super()]);},on_attach_callback:function(){},on_detach_callback:function(){},getLocalState:function(){},giveFocus:function(){},resetLocalState(){},setLocalState:function(localState){},async updateState(state,params){this._setState(state);if(!params.noRender){await this._render();}},async _render(){await this._renderView();this._suppressFocusableElements();},_renderNoContentHelper:function(context){let templateName;if(!context&&this.noContentHelp){templateName="web.ActionHelper";context={noContentHelp:this.noContentHelp};}else{templateName="web.NoContentHelper";}
const template=document.createElement('template');const owlQWeb=owl.Component.env.qweb;template.innerHTML=owlQWeb.renderToString(templateName,context);this.el.append(template.content.firstChild);},async _renderView(){},_setState(state=false){if(state!==false){this.state=state;}},_suppressFocusableElements(){if(!this.state.isSample||this.isEmbedded){return;}
const rootEls=[];for(const selector of this.sampleDataTargets){rootEls.push(...this.el.querySelectorAll(`:scope ${selector}`));}
const focusableEls=new Set(rootEls);for(const rootEl of rootEls){rootEl.classList.add('o_sample_data_disabled');for(const focusableEl of rootEl.querySelectorAll(FOCUSABLE_ELEMENTS)){focusableEls.add(focusableEl);}}
for(const focusableEl of focusableEls){focusableEl.setAttribute('tabindex',-1);if(focusableEl.classList.contains('dropdown-item')){focusableEl.classList.add('disabled');}}},});});;

/* /web/static/src/js/views/abstract_renderer_owl.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractRendererOwl',function(){"use strict";const FOCUSABLE_ELEMENTS=['a','button','input','select','textarea','[tabindex="0"]'].map((sel)=>`:scope ${sel}`).join(', ');class AbstractRenderer extends owl.Component{constructor(){super(...arguments);this.sampleDataTargets=[];}
mounted(){this._suppressFocusableElements();}
patched(){this._suppressFocusableElements();}
_suppressFocusableElements(){if(!this.props.isSample||this.props.isEmbedded){const disabledEls=this.el.querySelectorAll(`.o_sample_data_disabled`);disabledEls.forEach(el=>el.classList.remove('o_sample_data_disabled'));return;}
const rootEls=[];for(const selector of this.sampleDataTargets){rootEls.push(...this.el.querySelectorAll(`:scope ${selector}`));}
const focusableEls=new Set(rootEls);for(const rootEl of rootEls){rootEl.classList.add('o_sample_data_disabled');for(const focusableEl of rootEl.querySelectorAll(FOCUSABLE_ELEMENTS)){focusableEls.add(focusableEl);}}
for(const focusableEl of focusableEls){focusableEl.setAttribute('tabindex',-1);if(focusableEl.classList.contains('dropdown-item')){focusableEl.classList.add('disabled');}}}}
return AbstractRenderer;});;

/* /web/static/src/js/views/abstract_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractModel',function(require){"use strict";var fieldUtils=require('web.field_utils');var mvc=require('web.mvc');const SampleServer=require('web.SampleServer');var AbstractModel=mvc.Model.extend({init(parent,params={}){this._super(...arguments);this.useSampleModel=params.useSampleModel||false;if(params.isSampleModel){this.isSampleModel=true;this.sampleServer=new SampleServer(params.modelName,params.fields);}else if(this.useSampleModel){const sampleModelParams=Object.assign({},params,{isSampleModel:true,SampleModel:null,useSampleModel:false,});this.sampleModel=new params.SampleModel(this,sampleModelParams);this._isInSampleMode=false;}},get(_,options){let state;if(options&&options.withSampleData&&this._isInSampleMode){state=this.sampleModel.__get(...arguments);}else{state=this.__get(...arguments);}
return state;},isInSampleMode(){return!!this._isInSampleMode;},leaveSampleMode(){if(this.useSampleModel){this.useSampleModel=false;this._isInSampleMode=false;this.sampleModel.destroy();}},async load(params){this.loadParams=params;const handle=await this.__load(...arguments);await this._callSampleModel('__load',handle,...arguments);return handle;},async reload(_,params){const handle=await this.__reload(...arguments);if(this._isInSampleMode){if(!this._haveParamsChanged(params)){await this._callSampleModel('__reload',handle,...arguments);}else{this.leaveSampleMode();}}
return handle;},async _callSampleModel(method,handle,...args){if(this.useSampleModel&&this._isEmpty(handle)){try{if(method==='__load'){await this.sampleModel.__load(...args);}else if(method==='__reload'){await this.sampleModel.__reload(...args);}
this._isInSampleMode=true;}catch(error){if(error instanceof SampleServer.UnimplementedRouteError){this.leaveSampleMode();}else{throw error;}}}else{this.leaveSampleMode();}},__get(){return{};},_isEmpty(){return false;},async __load(){return Promise.resolve();},_parseServerValue:function(field,value){if(field.type==='date'||field.type==='datetime'){value=fieldUtils.parse[field.type](value,field,{isUTC:true});}else if(field.type==='selection'&&value===false){var hasKey0=_.find(field.selection,function(option){return option[0]===0;});value=hasKey0?0:value;}
return value;},async __reload(){return Promise.resolve();},_haveParamsChanged(params={}){for(const key of['context','domain','timeRanges']){if(key in params){const diff=JSON.stringify(params[key])!==JSON.stringify(this.loadParams[key]);if(diff){return true;}}}
if(this.useSampleModel&&'groupBy'in params){return JSON.stringify(params.groupBy)!==JSON.stringify(this.loadParams.groupedBy);}},async _rpc(){if(this.isSampleModel){return this.sampleServer.mockRpc(...arguments);}
return this._super(...arguments);},});return AbstractModel;});;

/* /web/static/src/js/model.js defined in bundle 'web.assets_backend' */
odoo.define("web/static/src/js/model.js",function(require){"use strict";const{groupBy,partitionBy}=require("web.utils");const Registry=require("web.Registry");const{Component,core}=owl;const{EventBus,Observer}=core;const isNotNull=(val)=>val!==null&&val!==undefined;class ModelExtension{constructor(config){this.config=config;this.env=this.config.env;this.shouldLoad=true;this.state={};}
async callLoad(params){if(this.shouldLoad){this.shouldLoad=false;await this.load(params);}}
dispatch(method,...args){if(method in this){this[method](...args);}}
exportState(){return this.state;}
get(){return null;}
importState(state){this.shouldLoad=!state;if(this.shouldLoad){this.prepareState();}else{Object.assign(this.state,state);}}
async load(){}
prepareState(){}}
ModelExtension.layer=0;class Model extends EventBus{constructor(extensions={},globalConfig={}){super();this.config=globalConfig;this.env=this.config.env;this.dispatching=false;this.extensions=[];this.externalState={};this.mapping={};this.rev=1;const{name,registry}=this.constructor;if(!registry||!(registry instanceof Registry)){throw new Error(`Unimplemented registry on model "${name}".`);}
const registryExtensions=Object.entries(registry.entries());const extensionNameLayers=registryExtensions.map(([name,{layer}])=>({name,layer}));const groupedNameLayers=groupBy(extensionNameLayers,"layer");for(const groupNameLayers of Object.values(groupedNameLayers)){for(const{name}of groupNameLayers){if(name in extensions){this.addExtension(name,extensions[name]);}}}
this.importState(this.config.importedState);}
addExtension(extensionName,extensionConfig){const{name,registry}=this.constructor;const Extension=registry.get(extensionName);if(!Extension){throw new Error(`Unknown model extension "${extensionName}" in model "${name}"`);}
const get=this.__get.bind(this,Extension.name);const trigger=this.trigger.bind(this);const config=Object.assign({get,trigger},this.config,extensionConfig);const extension=new Extension(config);if(!(Extension.layer in this.extensions)){this.extensions[Extension.layer]=[];}
this.extensions[Extension.layer].push(extension);}
dispatch(method,...args){const isInitialDispatch=!this.dispatching;this.dispatching=true;for(const extension of this.extensions.flat()){extension.dispatch(method,...args);}
if(!isInitialDispatch){return;}
this.dispatching=false;let rev=this.rev;this._loadExtensions({isInitialLoad:false}).then(()=>{if(rev===this.rev){this._notifyComponents();}});}
exportState(){const exported={};for(const extension of this.extensions.flat()){exported[extension.constructor.name]=extension.exportState();}
const fullState=Object.assign({},this.externalState,exported);return JSON.stringify(fullState);}
get(property,...args){for(const extension of this.extensions.flat()){const result=extension.get(property,...args);if(isNotNull(result)){return result;}}
return null;}
importState(stringifiedState="null"){const state=JSON.parse(stringifiedState)||{};Object.assign(this.externalState,state);for(const extension of this.extensions.flat()){extension.importState(state[extension.constructor.name]);}}
async load(){await this._loadExtensions({isInitialLoad:true});}
__get(excluded,property,...args){const results=[];for(const extension of this.extensions.flat()){if(extension.constructor.name!==excluded){const result=extension.get(property,...args);if(isNotNull(result)){results.push(result);}}}
return results;}
async _loadExtensions(params){for(let layer=0;layer<this.extensions.length;layer++){await Promise.all(this.extensions[layer].map((extension)=>extension.callLoad(params)));}}
async _notifyComponents(){const rev=++this.rev;const subscriptions=this.subscriptions.update||[];const groups=partitionBy(subscriptions,(s)=>s.owner?s.owner.__owl__.depth:-1);for(let group of groups){const proms=group.map((sub)=>sub.callback.call(sub.owner,rev));Component.scheduler.flush();await Promise.all(proms);}}}
Model.Extension=ModelExtension;function useModel(modelName){const component=Component.current;const model=component.env[modelName];if(!(model instanceof Model)){throw new Error(`No Model found when connecting '${
                component.name
                }'`);}
const mapping=model.mapping;const __owl__=component.__owl__;const componentId=__owl__.id;if(!__owl__.observer){__owl__.observer=new Observer();__owl__.observer.notifyCB=component.render.bind(component);}
const currentCB=__owl__.observer.notifyCB;__owl__.observer.notifyCB=function(){if(model.rev>mapping[componentId]){return;}
currentCB();};mapping[componentId]=0;const renderFn=__owl__.renderFn;__owl__.renderFn=function(comp,params){mapping[componentId]=model.rev;return renderFn(comp,params);};model.on("update",component,async(modelRev)=>{if(mapping[componentId]<modelRev){mapping[componentId]=modelRev;await component.render();}});const __destroy=component.__destroy;component.__destroy=(parent)=>{model.off("update",component);__destroy.call(component,parent);};return model;}
return{Model,useModel,};});;

/* /web/static/src/js/views/abstract_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.AbstractController',function(require){"use strict";var ActionMixin=require('web.ActionMixin');var ajax=require('web.ajax');var concurrency=require('web.concurrency');const config=require('web.config');const{ComponentWrapper}=require('web.OwlCompatibility');var mvc=require('web.mvc');var session=require('web.session');var AbstractController=mvc.Controller.extend(ActionMixin,{custom_events:_.extend({},ActionMixin.custom_events,{navigation_move:'_onNavigationMove',open_record:'_onOpenRecord',switch_view:'_onSwitchView',}),events:{'click a[type="action"]':'_onActionClicked',},init:function(parent,model,renderer,params){this._super.apply(this,arguments);this._title=params.displayName;this.modelName=params.modelName;this.activeActions=params.activeActions;this.controllerID=params.controllerID;this.initialState=params.initialState;this.bannerRoute=params.bannerRoute;this.actionViews=params.actionViews;this.viewType=params.viewType;this.dp=new concurrency.DropPrevious();this.withControlPanel=params.withControlPanel;this.withSearchPanel=params.withSearchPanel;if(params.searchModel){this.searchModel=params.searchModel;}
if(this.withControlPanel){const{Component,props}=params.controlPanel;this.ControlPanel=Component;this.controlPanelProps=props;}
if(this.withSearchPanel){const{Component,props}=params.searchPanel;this.SearchPanel=Component;this.searchPanelProps=props;}},start:async function(){this.$el.addClass('o_view_controller');this.renderButtons();const promises=[this._super(...arguments)];if(this.withControlPanel){this._updateControlPanelProps(this.initialState);this._controlPanelWrapper=new ComponentWrapper(this,this.ControlPanel,this.controlPanelProps);this._controlPanelWrapper.env.bus.on('focus-view',this,()=>this._giveFocus());promises.push(this._controlPanelWrapper.mount(this.el,{position:'first-child'}));}
if(this.withSearchPanel){this._searchPanelWrapper=new ComponentWrapper(this,this.SearchPanel,this.searchPanelProps);const content=this.el.querySelector(':scope .o_content');content.classList.add('o_controller_with_searchpanel');promises.push(this._searchPanelWrapper.mount(content,{position:'first-child'}));}
await Promise.all(promises);await this._update(this.initialState,{shouldUpdateSearchComponents:false});this.updateButtons();this.el.classList.toggle('o_view_sample_data',this.model.isInSampleMode());},destroy:function(){if(this.$buttons){this.$buttons.off();}
ActionMixin.destroy.call(this);this._super.apply(this,arguments);},on_attach_callback:function(){ActionMixin.on_attach_callback.call(this);this.searchModel.on('search',this,this._onSearch);if(!config.device.isMobileDevice){this.searchModel.trigger('focus-control-panel');}
if(this.withControlPanel){this.searchModel.on('get-controller-query-params',this,this._onGetOwnedQueryParams);}
if(!(this.renderer instanceof owl.Component)){this.renderer.on_attach_callback();}},on_detach_callback:function(){ActionMixin.on_detach_callback.call(this);this.searchModel.off('search',this);if(this.withControlPanel){this.searchModel.off('get-controller-query-params',this);}
if(!(this.renderer instanceof owl.Component)){this.renderer.on_detach_callback();}},canBeRemoved:function(){return this.discardChanges(undefined,{noAbandon:true,readonlyIfRealDiscard:true,});},discardChanges:function(recordID,options){return Promise.resolve();},exportState(){const exported={searchModel:this.searchModel.exportState(),};if(this.withSearchPanel){const searchPanel=this._searchPanelWrapper.componentRef.comp;exported.searchPanel=searchPanel.exportState();}
return exported;},importState(state){this.searchModel.importState(state.searchModel);if(this.withSearchPanel){const searchPanel=this._searchPanelWrapper.componentRef.comp;searchPanel.importState(state.searchPanel);}},is_action_enabled:function(action){return this.activeActions[action];},reload:async function(params={}){if(params.controllerState){this.importState(params.controllerState);Object.assign(params,this.searchModel.get('query'));}
return this.update(params,{});},async update(params,options={}){const shouldReload='reload'in options?options.reload:true;if(shouldReload){this.handle=await this.dp.add(this.model.reload(this.handle,params));}
const localState=this.renderer.getLocalState();const state=this.model.get(this.handle,{withSampleData:true});const promises=[this._updateRendererState(state,params).then(()=>{this.renderer.setLocalState(localState);}),this._update(this.model.get(this.handle),params)];await this.dp.add(Promise.all(promises));this.updateButtons();this.el.classList.toggle('o_view_sample_data',this.model.isInSampleMode());},_getPagingInfo:function(state){return null;},_getActionMenuItems:function(state){return null;},_giveFocus(){if(!this.model.isInSampleMode()){this.renderer.giveFocus();}},_pushState:function(){this.trigger_up('push_state',{controllerID:this.controllerID,state:this.getState(),});},async _removeSampleData(callback){this.model.leaveSampleMode();if(callback){await callback();}
this.el.classList.remove('o_view_sample_data');},_renderBanner:async function(){if(this.bannerRoute!==undefined){const response=await this._rpc({route:this.bannerRoute,params:{context:session.user_context},});if(!response.html){this.$el.removeClass('o_has_banner');return Promise.resolve();}
this.$el.addClass('o_has_banner');var $banner=$(response.html);if(this._$banner&&this._$banner.remove){this._$banner.remove();}
var defs=[];$('link[rel="stylesheet"]',$banner).each(function(i,link){defs.push(ajax.loadCSS(link.href));link.remove();});$('script[type="text/javascript"]',$banner).each(function(i,js){defs.push(ajax.loadJS(js.src));js.remove();});await Promise.all(defs);$banner.insertBefore(this.$('> .o_content'));this._$banner=$banner;}},_startRenderer:function(){if(this.renderer instanceof owl.Component){return this.renderer.mount(this.$('.o_content')[0]);}
return this.renderer.appendTo(this.$('.o_content'));},async _update(state,params){if(!this.$buttons){this.renderButtons();}
const promises=[this._renderBanner()];if(params.shouldUpdateSearchComponents!==false){if(this.withControlPanel){this._updateControlPanelProps(state);if(params.breadcrumbs){this.controlPanelProps.breadcrumbs=params.breadcrumbs;}
promises.push(this.updateControlPanel());}
if(this.withSearchPanel){this._updateSearchPanel();}}
this._pushState();await Promise.all(promises);},_updateControlPanelProps(state){if(!this.controlPanelProps.cp_content){this.controlPanelProps.cp_content={};}
if(this.$buttons){this.controlPanelProps.cp_content.$buttons=this.$buttons;}
Object.assign(this.controlPanelProps,{actionMenus:this._getActionMenuItems(state),pager:this._getPagingInfo(state),title:this.getTitle(),});},_updatePaging:async function(state,newProps){const pagingInfo=this._getPagingInfo(state);if(pagingInfo){Object.assign(pagingInfo,newProps);return this.updateControlPanel({pager:pagingInfo});}},_updateRendererState(state,params={}){if(this.renderer instanceof owl.Component){return this.renderer.update(state);}
return this.renderer.updateState(state,params);},async _updateSearchPanel(newProps){Object.assign(this.searchPanelProps,newProps);await this._searchPanelWrapper.update(this.searchPanelProps);},_onActionClicked:function(ev){ev.preventDefault();var $target=$(ev.currentTarget);var self=this;var data=$target.data();if(data.method!==undefined&&data.model!==undefined){var options={};if(data.reloadOnClose){options.on_close=function(){self.trigger_up('reload');};}
this.dp.add(this._rpc({model:data.model,method:data.method,context:session.user_context,})).then(function(action){if(action!==undefined){self.do_action(action,options);}});}else if($target.attr('name')){this.do_action($target.attr('name'),data.context&&{additional_context:data.context});}else{this.do_action({name:$target.attr('title')||_.str.strip($target.text()),type:'ir.actions.act_window',res_model:data.model||this.modelName,res_id:data.resId,target:'current',views:data.views||(data.resId?[[false,'form']]:[[false,'list'],[false,'form']]),domain:data.domain||[],},{additional_context:_.extend({},data.context)});}},_onNavigationMove:function(ev){switch(ev.data.direction){case'up':ev.stopPropagation();this.searchModel.trigger('focus-control-panel');break;case'down':ev.stopPropagation();this._giveFocus();break;}},_onOpenRecord:function(ev){ev.stopPropagation();var record=this.model.get(ev.data.id,{raw:true});this.trigger_up('switch_view',{view_type:'form',res_id:record.res_id,mode:ev.data.mode||'readonly',model:this.modelName,});},_onSearch:function(searchQuery){this.reload(_.extend({offset:0,groupsOffset:0},searchQuery));},_onSwitchView:function(ev){ev.data.controllerID=this.controllerID;},});return AbstractController;});;

/* /web/static/src/js/views/renderer_wrapper.js defined in bundle 'web.assets_backend' */
odoo.define('web.RendererWrapper',function(require){"use strict";const{ComponentWrapper}=require('web.OwlCompatibility');class RendererWrapper extends ComponentWrapper{getLocalState(){}
setLocalState(){}
giveFocus(){}
resetLocalState(){}}
return RendererWrapper;});;

/* /web/static/src/js/views/basic/basic_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.BasicModel',function(require){"use strict";var AbstractModel=require('web.AbstractModel');var concurrency=require('web.concurrency');var Context=require('web.Context');var core=require('web.core');var Domain=require('web.Domain');const pyUtils=require('web.py_utils');var session=require('web.session');var utils=require('web.utils');var viewUtils=require('web.viewUtils');var localStorage=require('web.local_storage');var _t=core._t;const AGGREGATABLE_TYPES=['float','integer','monetary'];var x2ManyCommands={CREATE:0,create:function(virtualID,values){delete values.id;return[x2ManyCommands.CREATE,virtualID||false,values];},UPDATE:1,update:function(id,values){delete values.id;return[x2ManyCommands.UPDATE,id,values];},DELETE:2,delete:function(id){return[x2ManyCommands.DELETE,id,false];},FORGET:3,forget:function(id){return[x2ManyCommands.FORGET,id,false];},LINK_TO:4,link_to:function(id){return[x2ManyCommands.LINK_TO,id,false];},DELETE_ALL:5,delete_all:function(){return[5,false,false];},REPLACE_WITH:6,replace_with:function(ids){return[6,false,ids];}};var BasicModel=AbstractModel.extend({OPEN_GROUP_LIMIT:10,noCacheModels:['ir.actions.act_window','ir.filters','ir.ui.view',],init:function(){this.mutex=new concurrency.Mutex();this.batchedRPCsRequests=[];this.localData=Object.create(null);this.__id=0;this._super.apply(this,arguments);},addDefaultRecord:function(listID,options){var self=this;var list=this.localData[listID];var context=_.extend({},this._getDefaultContext(list),this._getContext(list));var position=(options&&options.position)||'top';var params={context:context,fields:list.fields,fieldsInfo:list.fieldsInfo,parentID:list.id,position:position,viewType:list.viewType,};return this._makeDefaultRecord(list.model,params).then(function(id){list.count++;if(position==='top'){list.data.unshift(id);}else{list.data.push(id);}
var record=self.localData[id];list._cache[record.res_id]=id;return id;});},addFieldsInfo:async function(dataPointID,viewInfo){var dataPoint=this.localData[dataPointID];dataPoint.fields=_.extend({},dataPoint.fields,viewInfo.fields);dataPoint.fieldsInfo=dataPoint.fieldsInfo||{};const mainFieldInfo=dataPoint.fieldsInfo[dataPoint[viewInfo.viewType]];dataPoint.fieldsInfo[viewInfo.viewType]=_.defaults({},viewInfo.fieldInfo,mainFieldInfo);if(dataPoint.type==='record'){await this.applyRawChanges(dataPointID,viewInfo.viewType);}
const proms=[];const fieldInfo=dataPoint.fieldsInfo[viewInfo.viewType];if(dataPoint.type==='list'){Object.values(dataPoint._cache).forEach(subDataPointID=>{proms.push(this.addFieldsInfo(subDataPointID,{fields:dataPoint.fields,fieldInfo:dataPoint.fieldsInfo[viewInfo.viewType],viewType:viewInfo.viewType,}));});}else{const values=_.extend({},dataPoint.data,dataPoint._changes);Object.keys(fieldInfo).forEach(fieldName=>{const fieldType=dataPoint.fields[fieldName].type;if(fieldType==='one2many'||fieldType==='many2many'){const mode=fieldInfo[fieldName].mode;const views=fieldInfo[fieldName].views;const x2mDataPointID=values[fieldName];if(views[mode]&&x2mDataPointID){proms.push(this.addFieldsInfo(x2mDataPointID,{fields:views[mode].fields,fieldInfo:views[mode].fieldsInfo[mode],viewType:mode,}));}}});}
return Promise.all(proms);},applyRawChanges:function(recordID,viewType){var record=this.localData[recordID];return this._applyOnChange(record._rawChanges,record,{viewType}).then(function(){return record.id;});},canBeAbandoned:function(id){if(this.localData[id]._noAbandon){return false;}
var record=this.localData[id];var parent=this.localData[record.parentID];if(parent){var entry=_.findWhere(parent._savePoint,{operation:'ADD',id:id});if(entry){if(!entry.isNew){return false;}
var lastEntry=_.last(parent._savePoint);if(lastEntry.operation==='UPDATE'&&lastEntry.id===id){return false;}}}
return this.isNew(id);},deleteRecords:function(recordIds,modelName){var self=this;var records=_.map(recordIds,function(id){return self.localData[id];});var context=_.extend(records[0].getContext(),session.user_context);return this._rpc({model:modelName,method:'unlink',args:[_.pluck(records,'res_id')],context:context,}).then(function(){_.each(records,function(record){var parent=record.parentID&&self.localData[record.parentID];if(parent&&parent.type==='list'){parent.data=_.without(parent.data,record.id);delete self.localData[record.id];if(!parent.data.length&&parent.offset>0){parent.offset=Math.max(parent.offset-parent.limit,0);}}else{record.res_ids.splice(record.offset,1);record.offset=Math.min(record.offset,record.res_ids.length-1);record.res_id=record.res_ids[record.offset];record.count--;}});self._invalidateCache(records[0]);});},discardChanges:function(id,options){options=options||{};var element=this.localData[id];var isNew=this.isNew(id);var rollback='rollback'in options?options.rollback:isNew;var initialOffset=element.offset;element._domains={};this._visitChildren(element,function(elem){if(rollback&&elem._savePoint){if(elem._savePoint instanceof Array){elem._changes=elem._savePoint.slice(0);}else{elem._changes=_.extend({},elem._savePoint);}
elem._isDirty=!isNew;}else{elem._changes=null;elem._isDirty=false;}
elem.offset=0;if(elem.tempLimitIncrement){elem.limit-=elem.tempLimitIncrement;delete elem.tempLimitIncrement;}});element.offset=initialOffset;},duplicateRecord:function(recordID){var self=this;var record=this.localData[recordID];var context=this._getContext(record);return this._rpc({model:record.model,method:'copy',args:[record.data.id],context:context,}).then(function(res_id){var index=record.res_ids.indexOf(record.res_id);record.res_ids.splice(index+1,0,res_id);return self.load({fieldsInfo:record.fieldsInfo,fields:record.fields,modelName:record.model,res_id:res_id,res_ids:record.res_ids.slice(0),viewType:record.viewType,context:context,});});},freezeOrder:function(listID){var list=this.localData[listID];if(list.type==='record'){return;}
list=this._applyX2ManyOperations(list);this._sortList(list);this.localData[listID].orderedResIDs=list.res_ids;},__get:function(id,options){var self=this;options=options||{};if(!(id in this.localData)){return null;}
var element=this.localData[id];if(options.env){var env={ids:element.res_ids?element.res_ids.slice(0):[],};if(element.type==='record'){env.currentId=this.isNew(element.id)?undefined:element.res_id;}
return env;}
if(element.type==='record'){var data=_.extend({},element.data,element._changes);var relDataPoint;for(var fieldName in data){var field=element.fields[fieldName];if(data[fieldName]===null){data[fieldName]=false;}
if(!field){continue;}
if(field.type==='many2one'){if(options.raw){relDataPoint=this.localData[data[fieldName]];data[fieldName]=relDataPoint?relDataPoint.res_id:false;}else{data[fieldName]=this.__get(data[fieldName])||false;}}else if(field.type==='reference'){if(options.raw){relDataPoint=this.localData[data[fieldName]];data[fieldName]=relDataPoint?relDataPoint.model+','+relDataPoint.res_id:false;}else{data[fieldName]=this.__get(data[fieldName])||false;}}else if(field.type==='one2many'||field.type==='many2many'){if(options.raw){if(typeof data[fieldName]==='string'){relDataPoint=this.localData[data[fieldName]];relDataPoint=this._applyX2ManyOperations(relDataPoint);data[fieldName]=relDataPoint.res_ids;}else{data[fieldName]=data[fieldName]||[];}}else{data[fieldName]=this.__get(data[fieldName])||[];}}}
var record={context:_.extend({},element.context),count:element.count,data:data,domain:element.domain.slice(0),evalModifiers:element.evalModifiers,fields:element.fields,fieldsInfo:element.fieldsInfo,getContext:element.getContext,getDomain:element.getDomain,getFieldNames:element.getFieldNames,id:element.id,isDirty:element.isDirty,limit:element.limit,model:element.model,offset:element.offset,ref:element.ref,res_ids:element.res_ids.slice(0),specialData:_.extend({},element.specialData),type:'record',viewType:element.viewType,};if(!this.isNew(element.id)){record.res_id=element.res_id;}
var evalContext;Object.defineProperty(record,'evalContext',{get:function(){evalContext=evalContext||self._getEvalContext(element);return evalContext;},});return record;}
element=this._applyX2ManyOperations(element);this._sortList(element);if(!element.orderedResIDs&&element._changes){_.each(element._changes,function(change){if(change.operation==='ADD'&&change.isNew){element.data=_.without(element.data,change.id);if(change.position==='top'){element.data.unshift(change.id);}else{element.data.push(change.id);}}});}
var list={aggregateValues:_.extend({},element.aggregateValues),context:_.extend({},element.context),count:element.count,data:_.map(element.data,function(elemID){return self.__get(elemID,options);}),domain:element.domain.slice(0),fields:element.fields,getContext:element.getContext,getDomain:element.getDomain,getFieldNames:element.getFieldNames,groupedBy:element.groupedBy,groupsCount:element.groupsCount,groupsLimit:element.groupsLimit,groupsOffset:element.groupsOffset,id:element.id,isDirty:element.isDirty,isOpen:element.isOpen,isSample:this.isSampleModel,limit:element.limit,model:element.model,offset:element.offset,orderedBy:element.orderedBy,res_id:element.res_id,res_ids:element.res_ids.slice(0),type:'list',value:element.value,viewType:element.viewType,};if(element.fieldsInfo){list.fieldsInfo=element.fieldsInfo;}
return list;},generateDefaultValues(recordID,options={}){const record=this.localData[recordID];const viewType=options.viewType||record.viewType;const fieldNames=options.fieldNames||Object.keys(record.fieldsInfo[viewType]);const numericFields=['float','integer','monetary'];const proms=[];record._changes=record._changes||{};fieldNames.forEach(fieldName=>{record.data[fieldName]=null;if(!(fieldName in record._changes)){const field=record.fields[fieldName];if(numericFields.includes(field.type)){record._changes[fieldName]=0;}else if(field.type==='one2many'||field.type==='many2many'){proms.push(this._processX2ManyCommands(record,fieldName,[],options));}else{record._changes[fieldName]=null;}}});return Promise.all(proms);},getName:function(id){var record=this.localData[id];var returnValue='';if(record._changes&&'display_name'in record._changes){returnValue=record._changes.display_name;}
else if('display_name'in record.data){returnValue=record.data.display_name;}
return returnValue||_t("New");},isDirty:function(id){var isDirty=false;this._visitChildren(this.localData[id],function(r){if(r._isDirty){isDirty=true;}});return isDirty;},_isEmpty(dataPointID){const dataPoint=this.localData[dataPointID];if(dataPoint.type==='list'){const hasRecords=dataPoint.count===0;if(dataPoint.groupedBy.length){return dataPoint.data.length>0&&hasRecords;}else{return hasRecords;}}
return false;},isNew:function(id){var data=this.localData[id];if(data.type!=="record"){return false;}
var res_id=data.res_id;if(typeof res_id==='number'){return false;}else if(typeof res_id==='string'&&/^[0-9]+-/.test(res_id)){return false;}
return true;},__load:async function(params){await this._super(...arguments);params.type=params.type||(params.res_id!==undefined?'record':'list');params.viewType=params.viewType||'default';if(!params.fieldsInfo){var fieldsInfo={};for(var fieldName in params.fieldNames){fieldsInfo[params.fieldNames[fieldName]]={};}
params.fieldsInfo={};params.fieldsInfo[params.viewType]=fieldsInfo;}
if(params.type==='record'&&params.res_id===undefined){params.allowWarning=true;return this._makeDefaultRecord(params.modelName,params);}
var dataPoint=this._makeDataPoint(params);return this._load(dataPoint).then(function(){return dataPoint.id;});},localIdsToResIds:function(localIds){return localIds.map(localId=>this.localData[localId].res_id);},makeRecord:function(model,fields,fieldInfo){var self=this;var defs=[];var record_fields={};_.each(fields,function(field){record_fields[field.name]=_.pick(field,'type','relation','domain','selection');});fieldInfo=fieldInfo||{};var fieldsInfo={};fieldsInfo.default={};_.each(fields,function(field){fieldsInfo.default[field.name]=fieldInfo[field.name]||{};});var record=this._makeDataPoint({modelName:model,fields:record_fields,fieldsInfo:fieldsInfo,viewType:'default',});_.each(fields,function(field){var dataPoint;record.data[field.name]=null;if(field.type==='many2one'){if(field.value){var id=_.isArray(field.value)?field.value[0]:field.value;var display_name=_.isArray(field.value)?field.value[1]:undefined;dataPoint=self._makeDataPoint({modelName:field.relation,data:{id:id,display_name:display_name,},parentID:record.id,});record.data[field.name]=dataPoint.id;if(display_name===undefined){defs.push(self._fetchNameGet(dataPoint));}}}else if(field.type==='reference'&&field.value){const ref=field.value.split(',');dataPoint=self._makeDataPoint({context:record.context,data:{id:parseInt(ref[1],10)},modelName:ref[0],parentID:record.id,});defs.push(self._fetchNameGet(dataPoint));record.data[field.name]=dataPoint.id;}else if(field.type==='one2many'||field.type==='many2many'){var relatedFieldsInfo={};relatedFieldsInfo.default={};_.each(field.fields,function(field){relatedFieldsInfo.default[field.name]={};});var dpParams={fieldsInfo:relatedFieldsInfo,modelName:field.relation,parentID:record.id,static:true,type:'list',viewType:'default',};var needLoad=false;if(field.value&&field.value.length){if(_.isObject(field.value[0])){dpParams.res_ids=_.pluck(field.value,'id');dataPoint=self._makeDataPoint(dpParams);_.each(field.value,function(data){var recordDP=self._makeDataPoint({data:data,modelName:field.relation,parentID:dataPoint.id,type:'record',});dataPoint.data.push(recordDP.id);dataPoint._cache[recordDP.res_id]=recordDP.id;});}else{dpParams.res_ids=field.value;dataPoint=self._makeDataPoint(dpParams);needLoad=true;}}else{dpParams.res_ids=[];dataPoint=self._makeDataPoint(dpParams);}
if(needLoad){defs.push(self._load(dataPoint));}
record.data[field.name]=dataPoint.id;}else if(field.value){record.data[field.name]=field.value;}});return Promise.all(defs).then(function(){return record.id;});},notifyChanges:function(record_id,changes,options){return this.mutex.exec(this._applyChange.bind(this,record_id,changes,options));},__reload:async function(id,options){await this._super(...arguments);return this.mutex.exec(this._reload.bind(this,id,options));},removeLine:function(elementID){var record=this.localData[elementID];var parent=this.localData[record.parentID];if(parent.static){parent._changes=_.filter(parent._changes,function(change){if(change.id===elementID&&change.operation==='ADD'&&parent.tempLimitIncrement){parent.tempLimitIncrement--;parent.limit--;}
return change.id!==elementID;});}else{parent.data=_.without(parent.data,elementID);parent.count--;}},resequence:function(modelName,resIDs,parentID,options){options=options||{};if((resIDs.length<=1)){return Promise.resolve(parentID);}
var self=this;var data=this.localData[parentID];var params={model:modelName,ids:resIDs,context:data.getContext(),};if(options.offset){params.offset=options.offset;}
if(options.field){params.field=options.field;}
return this._rpc({route:'/web/dataset/resequence',params:params,}).then(function(wasResequenced){if(!wasResequenced){return Promise.resolve();}
var field=params.field?params.field:'sequence';return self._rpc({model:modelName,method:'read',args:[resIDs,[field]],context:data.getContext(),}).then(function(records){if(data.data.length){var dataType=self.localData[data.data[0]].type;if(dataType==='record'){_.each(data.data,function(dataPoint){var recordData=self.localData[dataPoint].data;var inRecords=_.findWhere(records,{id:recordData.id});if(inRecords){recordData[field]=inRecords[field];}});data.data=_.sortBy(data.data,function(d){return self.localData[d].data[field];});}
if(dataType==='list'){data.data=_.sortBy(data.data,function(d){return _.indexOf(resIDs,self.localData[d].res_id)});}}
data.res_ids=[];_.each(data.data,function(d){var dataPoint=self.localData[d];if(dataPoint.type==='record'){data.res_ids.push(dataPoint.res_id);}else{data.res_ids=data.res_ids.concat(dataPoint.res_ids);}});self._updateParentResIDs(data);return parentID;})});},save:function(recordID,options){var self=this;return this.mutex.exec(function(){options=options||{};var record=self.localData[recordID];if(options.savePoint){self._visitChildren(record,function(rec){var newValue=rec._changes||rec.data;if(newValue instanceof Array){rec._savePoint=newValue.slice(0);}else{rec._savePoint=_.extend({},newValue);}});for(let fieldName in(record._changes||{})){record._editionViewType[fieldName]=options.viewType;}}
var shouldReload='reload'in options?options.reload:true;var method=self.isNew(recordID)?'create':'write';if(record._changes){delete record._changes.id;}
var changes=self._generateChanges(record,{viewType:options.viewType,changesOnly:method!=='create'});delete changes.id;if(method==='create'){var fieldNames=record.getFieldNames();_.each(fieldNames,function(name){if(changes[name]===null){delete changes[name];}});}
var prom=new Promise(function(resolve,reject){var changedFields=Object.keys(changes);if(options.savePoint){resolve(changedFields);return;}
if(method==='create'||changedFields.length){var args=method==='write'?[[record.data.id],changes]:[changes];self._rpc({model:record.model,method:method,args:args,context:record.getContext(),}).then(function(id){if(method==='create'){record.res_id=id;record.data.id=id;record.offset=record.res_ids.length;record.res_ids.push(id);record.count++;}
var _changes=record._changes;record._changes={};self._invalidateCache(record);self.unfreezeOrder(record.id);if(shouldReload){self._fetchRecord(record).then(function(){resolve(changedFields);});}else{_.extend(record.data,_changes);resolve(changedFields);}}).guardedCatch(reject);}else{resolve(changedFields);}});prom.then(function(){record._isDirty=false;});return prom;});},setDirty:function(id){this.localData[id]._isDirty=true;},setSort:function(list_id,fieldName){var list=this.localData[list_id];if(list.type==='record'){return;}else if(list._changes){_.each(list._changes,function(change){delete change.isNew;});}
if(list.orderedBy.length===0){list.orderedBy.push({name:fieldName,asc:true});}else if(list.orderedBy[0].name===fieldName){if(!list.orderedResIDs){list.orderedBy[0].asc=!list.orderedBy[0].asc;}}else{var orderedBy=_.reject(list.orderedBy,function(o){return o.name===fieldName;});list.orderedBy=[{name:fieldName,asc:true}].concat(orderedBy);}
list.orderedResIDs=null;if(list.static){return this._fetchUngroupedList(list);}
return Promise.resolve();},getActiveField:function(record){const fields=Object.keys(record.fields);const has_active=fields.includes('active');if(has_active){return'active';}
const has_x_active=fields.includes('x_active');return has_x_active?'x_active':undefined},toggleActive:function(recordIDs,parentID){var self=this;var parent=this.localData[parentID];var resIDs=_.map(recordIDs,function(recordID){return self.localData[recordID].res_id;});return this._rpc({model:parent.model,method:'toggle_active',args:[resIDs],}).then(function(action){self._invalidateCache(parent);if(!_.isEmpty(action)){return self.do_action(action,{on_close:function(){return self.trigger_up('reload');}});}else{return self.reload(parentID);}});},actionArchive:function(resIDs,parentID){var self=this;var parent=this.localData[parentID];return this._rpc({model:parent.model,method:'action_archive',args:[resIDs],}).then(function(action){self._invalidateCache(parent);if(!_.isEmpty(action)){return new Promise(function(resolve,reject){self.do_action(action,{on_close:function(result){return self.trigger_up('reload',{onSuccess:resolve,});}});});}else{return self.reload(parentID);}}).then(function(datapoint){if(parent&&parent.type==='list'&&!parent.data.length&&parent.offset>0){parent.offset=Math.max(parent.offset-parent.limit,0);return self.reload(parentID);}
return datapoint;});},actionUnarchive:function(resIDs,parentID){var self=this;var parent=this.localData[parentID];return this._rpc({model:parent.model,method:'action_unarchive',args:[resIDs],}).then(function(action){self._invalidateCache(parent);if(!_.isEmpty(action)){return new Promise(function(resolve,reject){self.do_action(action,{on_close:function(){return self.trigger_up('reload',{onSuccess:resolve,});}});});}else{return self.reload(parentID);}}).then(function(datapoint){if(parent&&parent.type==='list'&&!parent.data.length&&parent.offset>0){parent.offset=Math.max(parent.offset-parent.limit,0);return self.reload(parentID);}
return datapoint;});},toggleGroup:function(groupId){var self=this;var group=this.localData[groupId];if(group.isOpen){group.isOpen=false;group.data=[];group.res_ids=[];group.offset=0;this._updateParentResIDs(group);return Promise.resolve(groupId);}
if(!group.isOpen){group.isOpen=true;var def;if(group.count>0){def=this._load(group).then(function(){self._updateParentResIDs(group);});}
return Promise.resolve(def).then(function(){return groupId;});}},unfreezeOrder:function(elementID){var list=this.localData[elementID];if(list.type==='record'){var data=_.extend({},list.data,list._changes);for(var fieldName in data){var field=list.fields[fieldName];if(!field||!data[fieldName]){continue;}
if(field.type==='one2many'||field.type==='many2many'){var recordlist=this.localData[data[fieldName]];recordlist.orderedResIDs=null;for(var index in recordlist.data){this.unfreezeOrder(recordlist.data[index]);}}}
return;}
list.orderedResIDs=null;this._sortList(list);},_addX2ManyDefaultRecord:function(list,options){var self=this;var position=options&&options.position||'top';var params={fields:list.fields,fieldsInfo:list.fieldsInfo,parentID:list.id,position:position,viewType:options.viewType||list.viewType,allowWarning:options&&options.allowWarning};var additionalContexts=options&&options.context;var makeDefaultRecords=[];if(additionalContexts){_.each(additionalContexts,function(context){params.context=self._getContext(list,{additionalContext:context});makeDefaultRecords.push(self._makeDefaultRecord(list.model,params));});}else{params.context=self._getContext(list);makeDefaultRecords.push(self._makeDefaultRecord(list.model,params));}
return Promise.all(makeDefaultRecords).then(function(resultIds){var ids=[];_.each(resultIds,function(id){ids.push(id);list._changes.push({operation:'ADD',id:id,position:position,isNew:true});var record=self.localData[id];list._cache[record.res_id]=id;if(list.orderedResIDs){var index=list.offset+(position!=='top'?list.limit:0);list.orderedResIDs.splice(index,0,record.res_id);self.localData[list.id].orderedResIDs=list.orderedResIDs;}});return ids;});},_applyChange:function(recordID,changes,options){var self=this;var record=this.localData[recordID];var field;var defs=[];options=options||{};record._changes=record._changes||{};if(!options.doNotSetDirty){record._isDirty=true;}
var initialData={};this._visitChildren(record,function(elem){initialData[elem.id]=$.extend(true,{},_.pick(elem,'data','_changes'));});for(var fieldName in changes){field=record.fields[fieldName];if(field&&(field.type==='one2many'||field.type==='many2many')){defs.push(this._applyX2ManyChange(record,fieldName,changes[fieldName],options));}else if(field&&(field.type==='many2one'||field.type==='reference')){defs.push(this._applyX2OneChange(record,fieldName,changes[fieldName],options));}else{record._changes[fieldName]=changes[fieldName];}}
if(options.notifyChange===false){return Promise.all(defs).then(function(){return Promise.resolve(_.keys(changes));});}
return Promise.all(defs).then(function(){var onChangeFields=[];for(var fieldName in changes){field=record.fields[fieldName];if(field&&field.onChange){var isX2Many=field.type==='one2many'||field.type==='many2many';if(!isX2Many||(self._isX2ManyValid(record._changes[fieldName]||record.data[fieldName]))){onChangeFields.push(fieldName);}}}
return new Promise(function(resolve,reject){if(onChangeFields.length){self._performOnChange(record,onChangeFields,{viewType:options.viewType}).then(function(result){delete record._warning;resolve(_.keys(changes).concat(Object.keys(result&&result.value||{})));}).guardedCatch(function(){self._visitChildren(record,function(elem){_.extend(elem,initialData[elem.id]);});reject();});}else{resolve(_.keys(changes));}}).then(function(fieldNames){return self._fetchSpecialData(record).then(function(fieldNames2){return _.union(fieldNames,fieldNames2);});});});},_applyX2OneChange:async function(record,fieldName,data,options){options=options||{};var self=this;if(!data||(!data.id&&!data.display_name)){record._changes[fieldName]=false;return Promise.resolve();}
const field=record.fields[fieldName];const coModel=field.type==='reference'?data.model:field.relation;const allowedTypes=['many2one','reference'];if(allowedTypes.includes(field.type)&&!data.id&&data.display_name){const result=await this._rpc({model:coModel,method:'name_create',args:[data.display_name],context:this._getContext(record,{fieldName:fieldName,viewType:options.viewType}),});if(!result){record._changes[fieldName]=false;return Promise.resolve();}
data={id:result[0],display_name:result[1]};}
var relatedID;if(record._changes&&fieldName in record._changes){relatedID=record._changes[fieldName];}else{relatedID=record.data[fieldName];}
var relatedRecord=this.localData[relatedID];if(relatedRecord&&(data.id===this.localData[relatedID].res_id)){return Promise.resolve();}
var rel_data=_.pick(data,'id','display_name');var def;if(rel_data.display_name===undefined){def=this._rpc({model:coModel,method:'name_get',args:[data.id],context:record.context,}).then(function(result){rel_data.display_name=result[0][1];});}
return Promise.resolve(def).then(function(){var rec=self._makeDataPoint({context:record.context,data:rel_data,fields:{},fieldsInfo:{},modelName:coModel,parentID:record.id,});record._changes[fieldName]=rec.id;});},_applyOnChange:function(values,record,options={}){var self=this;var defs=[];var rec;const viewType=options.viewType||record.viewType;record._changes=record._changes||{};for(let name in(values||{})){const val=values[name];var field=record.fields[name];if(!field){record._rawChanges[name]=val;continue;}
if(record._rawChanges[name]){delete record._rawChanges[name];}
var oldValue=name in record._changes?record._changes[name]:record.data[name];var id;if(field.type==='many2one'){id=false;if(val){var data=_.isArray(val)?{id:val[0],display_name:val[1]}:{id:val};if(!oldValue||(self.localData[oldValue].res_id!==data.id)){rec=self._makeDataPoint({context:record.context,data:data,modelName:field.relation,parentID:record.id,});id=rec.id;record._changes[name]=id;}}else{record._changes[name]=false;}}else if(field.type==='reference'){id=false;if(val){var ref=val.split(',');var modelName=ref[0];var resID=parseInt(ref[1]);if(!oldValue||self.localData[oldValue].res_id!==resID||self.localData[oldValue].model!==modelName){rec=self._makeDataPoint({context:record.context,data:{id:parseInt(ref[1])},modelName:modelName,parentID:record.id,});defs.push(self._fetchNameGet(rec));id=rec.id;record._changes[name]=id;}}else{record._changes[name]=id;}}else if(field.type==='one2many'||field.type==='many2many'){var listId=record._changes[name]||record.data[name];var list;if(listId){list=self.localData[listId];}else{var fieldInfo=record.fieldsInfo[viewType][name];if(!fieldInfo){continue;}
var view=fieldInfo.views&&fieldInfo.views[fieldInfo.mode];list=self._makeDataPoint({fields:view?view.fields:fieldInfo.relatedFields,fieldsInfo:view?view.fieldsInfo:fieldInfo.fieldsInfo,limit:fieldInfo.limit,modelName:field.relation,parentID:record.id,static:true,type:'list',viewType:view?view.type:fieldInfo.viewType,});}
record._changes[name]=list.id;list._changes=list._changes||[];var oldChanges=list._changes;_.each(val,function(command){var rec,recID;if(command[0]===0||command[0]===1){if(command[0]===0&&command[1]){var previousChange=_.find(oldChanges,function(operation){var child=self.localData[operation.id];return child&&(child.ref===command[1]);});recID=previousChange&&previousChange.id;rec=self.localData[recID];}
if(command[0]===1&&command[1]){rec=self.localData[list._cache[command[1]]];}
if(!rec){var params={context:list.context,fields:list.fields,fieldsInfo:list.fieldsInfo,modelName:list.model,parentID:list.id,viewType:list.viewType,ref:command[1],};if(command[0]===1){params.res_id=command[1];}
rec=self._makeDataPoint(params);list._cache[rec.res_id]=rec.id;if(options.firstOnChange){rec.getFieldNames().forEach(fieldName=>{if(!(fieldName in rec.data)){rec.data[fieldName]=null;}});}}
rec._noAbandon=!list._savePoint;list._changes.push({operation:'ADD',id:rec.id});if(command[0]===1){list._changes.push({operation:'UPDATE',id:rec.id});}
defs.push(self._applyOnChange(command[2],rec,{firstOnChange:options.firstOnChange,}));}else if(command[0]===4){linkRecord(list,command[1]);}else if(command[0]===5){list._changes=[{operation:'REMOVE_ALL'}];}else if(command[0]===6){list._changes=[{operation:'REMOVE_ALL'}];_.each(command[2],function(resID){linkRecord(list,resID);});}});var def=self._readUngroupedList(list).then(function(){var x2ManysDef=self._fetchX2ManysBatched(list);var referencesDef=self._fetchReferencesBatched(list);return Promise.all([x2ManysDef,referencesDef]);});defs.push(def);}else{var newValue=self._parseServerValue(field,val);if(newValue!==oldValue){record._changes[name]=newValue;}}}
return Promise.all(defs);function linkRecord(list,resID){rec=self.localData[list._cache[resID]];if(rec){self.discardChanges(rec.id);}
list._changes.push({operation:'ADD',id:rec?rec.id:null,resID:resID,});}},_applyX2ManyChange:async function(record,fieldName,command,options){if(command.operation==='TRIGGER_ONCHANGE'){return Promise.resolve();}
var self=this;var localID=(record._changes&&record._changes[fieldName])||record.data[fieldName];var list=this.localData[localID];var field=record.fields[fieldName];var viewType=(options&&options.viewType)||record.viewType;var fieldInfo=record.fieldsInfo[viewType][fieldName];var view=fieldInfo.views&&fieldInfo.views[fieldInfo.mode];var def,rec;var defs=[];list._changes=list._changes||[];switch(command.operation){case'ADD':var newRecord=this.localData[command.id];_.defaults(list.fields,newRecord.fields);_.defaults(list.fieldsInfo,newRecord.fieldsInfo);newRecord.fields=list.fields;newRecord.fieldsInfo=list.fieldsInfo;newRecord.viewType=list.viewType;list._cache[newRecord.res_id]=newRecord.id;list._changes.push(command);break;case'ADD_M2M':list._forceM2MLink=true;var data=_.isArray(command.ids)?command.ids:[command.ids];for(const r of data){if(!r.id&&r.display_name){const prom=this._rpc({model:field.relation,method:'name_create',args:[r.display_name],context:this._getContext(record,{fieldName:fieldName,viewType:options.viewType}),}).then(result=>{r.id=result[0];r.display_name=result[1];});defs.push(prom);}}
await Promise.all(defs);if(data.length+list.res_ids.length>list.limit){list.limit=data.length+list.res_ids.length;}
var list_records={};_.each(data,function(d){rec=self._makeDataPoint({context:record.context,modelName:field.relation,fields:view?view.fields:fieldInfo.relatedFields,fieldsInfo:view?view.fieldsInfo:fieldInfo.fieldsInfo,res_id:d.id,data:d,viewType:view?view.type:fieldInfo.viewType,parentID:list.id,});list_records[d.id]=rec;list._cache[rec.res_id]=rec.id;list._changes.push({operation:'ADD',id:rec.id});});var fieldNames=list.getFieldNames();if(fieldNames.length){def=this._rpc({model:list.model,method:'read',args:[_.pluck(data,'id'),fieldNames],context:_.extend({},record.context,field.context),}).then(function(records){_.each(records,function(record){list_records[record.id].data=record;self._parseServerData(fieldNames,list,record);});return Promise.all([self._fetchX2ManysBatched(list),self._fetchReferencesBatched(list)]);});defs.push(def);}
break;case'CREATE':var createOptions=_.extend({context:command.context,position:command.position},options||{});createOptions.viewType=fieldInfo.mode;def=this._addX2ManyDefaultRecord(list,createOptions).then(function(ids){_.each(ids,function(id){if(command.position==='bottom'&&list.orderedResIDs&&list.orderedResIDs.length>=list.limit){list.tempLimitIncrement=(list.tempLimitIncrement||0)+1;list.limit+=1;}
if(command.data){return self._applyChange(id,command.data);}});});defs.push(def);break;case'UPDATE':list._changes.push({operation:'UPDATE',id:command.id});if(command.data){defs.push(this._applyChange(command.id,command.data,{viewType:view&&view.type,}));}
break;case'FORGET':list._forceM2MUnlink=true;case'DELETE':var idsToRemove=command.ids;list._changes=_.reject(list._changes,function(change,index){var idInCommands=_.contains(command.ids,change.id);if(idInCommands&&change.operation==='ADD'){idsToRemove=_.without(idsToRemove,change.id);}
return idInCommands;});_.each(idsToRemove,function(id){var operation=list._forceM2MUnlink?'FORGET':'DELETE';list._changes.push({operation:operation,id:id});});break;case'DELETE_ALL':list._changes=_.reject(list._changes,function(change){return change.operation==='ADD';});return this._applyX2ManyChange(record,fieldName,{operation:'DELETE',ids:list.res_ids},options);case'REPLACE_WITH':list._changes=[];var newIds=_.difference(command.ids,list.res_ids);var removedIds=_.difference(list.res_ids,command.ids);var addDef,removedDef,values;if(newIds.length){values=_.map(newIds,function(id){return{id:id};});addDef=this._applyX2ManyChange(record,fieldName,{operation:'ADD_M2M',ids:values},options);}
if(removedIds.length){var listData=_.map(list.data,function(localId){return self.localData[localId];});removedDef=this._applyX2ManyChange(record,fieldName,{operation:'DELETE',ids:_.map(removedIds,function(resID){if(resID in list._cache){return list._cache[resID];}
return _.findWhere(listData,{res_id:resID}).id;}),},options);}
return Promise.all([addDef,removedDef]);case'MULTI':_.each(command.commands,function(innerCommand){defs.push(self._applyX2ManyChange(record,fieldName,innerCommand,options));});break;}
return Promise.all(defs).then(function(){return self._readUngroupedList(list).then(function(){return self._fetchX2ManysBatched(list);});});},_applyX2ManyOperations:function(list,options){if(!list.static){return list;}
var self=this;list=_.extend({},list);list.res_ids=list.res_ids.slice(0);var changes=list._changes||[];if(options){var to=options.to===0?0:(options.to||changes.length);changes=changes.slice(options.from||0,to);}
_.each(changes,function(change){var relRecord;if(change.id){relRecord=self.localData[change.id];}
switch(change.operation){case'ADD':list.count++;var resID=relRecord?relRecord.res_id:change.resID;if(change.position==='top'&&(options?options.position!=='bottom':true)){list.res_ids.unshift(resID);}else{list.res_ids.push(resID);}
break;case'FORGET':case'DELETE':list.count--;var deletedResID=relRecord?relRecord.res_id:change.id;list.res_ids=_.without(list.res_ids,deletedResID);break;case'REMOVE_ALL':list.count=0;list.res_ids=[];break;case'UPDATE':break;}});this._setDataInRange(list);return list;},_buildOnchangeSpecs:function(record,viewType){let hasOnchange=false;const onchangeSpec={};var fieldsInfo=record.fieldsInfo[viewType||record.viewType];generateSpecs(fieldsInfo,record.fields);function generateSpecs(fieldsInfo,fields,prefix){prefix=prefix||'';_.each(Object.keys(fieldsInfo),function(name){var field=fields[name];var fieldInfo=fieldsInfo[name];var key=prefix+name;onchangeSpec[key]=(field.onChange)||"";if(field.onChange){hasOnchange=true;}
if(field.type==='one2many'||field.type==='many2many'){_.each(fieldInfo.views,function(view){generateSpecs(view.fieldsInfo[view.type],view.fields,key+'.');});}});}
return{hasOnchange,onchangeSpec};},async _callSampleModel(){await this._super(...arguments);if(this._isInSampleMode){this.__id=this.sampleModel.__id;}},_computeOverrideDefaultFields:function(listID,position){var list=this.localData[listID];var handleField;if(!list){return{};}
position=position||'bottom';if(!list.fieldsInfo){return{};}
for(var field in list.fieldsInfo.list){if(list.fieldsInfo.list[field].widget==='handle'){handleField=field;break;}}
if(!handleField){return{};}
var isOrderedByHandle=list.orderedBy&&list.orderedBy.length&&list.orderedBy[0].asc===true&&list.orderedBy[0].name===handleField;if(!isOrderedByHandle){return{};}
var computedList=this.get(list.id,{raw:true});if(!computedList||!computedList.data||!computedList.data.length){return{};}
var index=Math.min(computedList.data.length-1,position!=='top'?list.limit-1:0);var handleFieldValue=computedList.data[index].data[handleField];if(position==='top'){handleFieldValue--;}else if(list.count<=list.offset+list.limit-(list.tempLimitIncrement||0)){handleFieldValue++;}
return{field:handleField,value:handleFieldValue,};},_evalModifiers:function(element,modifiers){let evalContext=null;const evaluated={};for(const k of['invisible','column_invisible','readonly','required']){const mod=modifiers[k];if(mod===undefined||mod===false||mod===true){if(k in modifiers){evaluated[k]=!!mod;}
continue;}
try{evalContext=evalContext||this._getEvalContext(element);evaluated[k]=new Domain(mod,evalContext).compute(evalContext);}catch(e){throw new Error(_.str.sprintf('for modifier "%s": %s',k,e.message));}}
return evaluated;},_fetchNameGet:function(dataPoint){return this._rpc({model:dataPoint.model,method:'name_get',args:[dataPoint.res_id],context:dataPoint.getContext(),}).then(function(result){dataPoint.data.display_name=result[0][1];});},_fetchNameGets:function(list,fieldName){var self=this;var model=list.fields[fieldName].relation;var records=[];var ids=[];list=this._applyX2ManyOperations(list);_.each(list.data,function(localId){var record=self.localData[localId];var data=record._changes||record.data;var many2oneId=data[fieldName];if(!many2oneId){return;}
var many2oneRecord=self.localData[many2oneId];records.push(many2oneRecord);ids.push(many2oneRecord.res_id);model=many2oneRecord.model;});if(!ids.length){return Promise.resolve();}
return this._rpc({model:model,method:'name_get',args:[_.uniq(ids)],context:list.context,}).then(function(name_gets){_.each(records,function(record){var nameGet=_.find(name_gets,function(nameGet){return nameGet[0]===record.data.id;});record.data.display_name=nameGet[1];});});},_fetchRecord:function(record,options){var self=this;options=options||{};var fieldNames=options.fieldNames||record.getFieldNames(options);fieldNames=_.uniq(fieldNames.concat(['display_name']));return this._rpc({model:record.model,method:'read',args:[[record.res_id],fieldNames],context:_.extend({bin_size:true},record.getContext()),}).then(function(result){if(result.length===0){return Promise.reject();}
result=result[0];record.data=_.extend({},record.data,result);}).then(function(){self._parseServerData(fieldNames,record,record.data);}).then(function(){return Promise.all([self._fetchX2Manys(record,options),self._fetchReferences(record,options)]).then(function(){return self._postprocess(record,options);});});},_fetchReference:function(record,fieldName){var self=this;var def;var value=record._changes&&record._changes[fieldName]||record.data[fieldName];var model=value&&value.split(',')[0];var resID=value&&parseInt(value.split(',')[1]);if(model&&model!=='False'&&resID){def=self._rpc({model:model,method:'name_get',args:[resID],context:record.getContext({fieldName:fieldName}),}).then(function(result){return self._makeDataPoint({data:{id:result[0][0],display_name:result[0][1],},modelName:model,parentID:record.id,});});}
return Promise.resolve(def);},_fetchReferenceData:function(datapoints,model,fieldName){var self=this;var ids=_.map(Object.keys(datapoints),function(id){return parseInt(id);});var parent=datapoints[ids[0]][0];var def=self._rpc({model:model,method:'name_get',args:[ids],context:self.localData[parent].getContext({fieldName:fieldName}),}).then(function(result){_.each(result,function(el){var parentIDs=datapoints[el[0]];_.each(parentIDs,function(parentID){var parent=self.localData[parentID];var referenceDp=self._makeDataPoint({data:{id:el[0],display_name:el[1],},modelName:model,parentID:parent.id,});parent.data[fieldName]=referenceDp.id;});});});return def;},_fetchReferences:function(record,options){var self=this;var defs=[];var fieldNames=options&&options.fieldNames||record.getFieldNames();_.each(fieldNames,function(fieldName){var field=record.fields[fieldName];if(field.type==='reference'){var def=self._fetchReference(record,fieldName).then(function(dataPoint){if(dataPoint){record.data[fieldName]=dataPoint.id;}});defs.push(def);}});return Promise.all(defs);},_fetchReferenceBatched:function(list,fieldName){var self=this;list=this._applyX2ManyOperations(list);this._sortList(list);var toFetch=this._getDataToFetchByModel(list,fieldName);var defs=[];_.each(toFetch,function(datapoints,model){defs.push(self._fetchReferenceData(datapoints,model,fieldName));});return Promise.all(defs);},_fetchReferencesBatched:function(list){var defs=[];var fieldNames=list.getFieldNames();for(var i=0;i<fieldNames.length;i++){var field=list.fields[fieldNames[i]];if(field.type==='reference'){defs.push(this._fetchReferenceBatched(list,fieldNames[i]));}}
return Promise.all(defs);},_fetchReferenceSingleBatch:function(list,fieldName){var self=this;var toFetch={};_.each(list.data,function(groupIndex){var group=self.localData[groupIndex];self._getDataToFetchByModel(group,fieldName,toFetch);});var defs=[];_.each(toFetch,function(datapoints,model){defs.push(self._fetchReferenceData(datapoints,model,fieldName));});return Promise.all(defs);},_fetchReferencesSingleBatch:function(list){var defs=[];var fieldNames=list.getFieldNames();for(var fIndex in fieldNames){var field=list.fields[fieldNames[fIndex]];if(field.type==='reference'){defs.push(this._fetchReferenceSingleBatch(list,fieldNames[fIndex]));}}
return Promise.all(defs);},_fetchRelatedData:function(list,toFetch,fieldName){var self=this;var ids=_.keys(toFetch);for(var i=0;i<ids.length;i++){ids[i]=Number(ids[i]);}
var fieldInfo=list.fieldsInfo[list.viewType][fieldName];if(!ids.length||fieldInfo.__no_fetch){return Promise.resolve();}
var def;var fieldNames=_.keys(fieldInfo.relatedFields);if(fieldNames.length){var field=list.fields[fieldName];def=this._rpc({model:field.relation,method:'read',args:[ids,fieldNames],context:list.getContext()||{},});}else{def=Promise.resolve(_.map(ids,function(id){return{id:id};}));}
return def.then(function(result){var records=_.uniq(_.flatten(_.values(toFetch)));self._updateRecordsData(records,fieldName,result);});},_fetchSpecialData:function(record,options){var self=this;var specialFieldNames=[];var fieldNames=(options&&options.fieldNames)||record.getFieldNames();return Promise.all(_.map(fieldNames,function(name){var viewType=(options&&options.viewType)||record.viewType;var fieldInfo=record.fieldsInfo[viewType][name]||{};var Widget=fieldInfo.Widget;if(Widget&&Widget.prototype.specialData){return self[Widget.prototype.specialData](record,name,fieldInfo).then(function(data){if(data===undefined){return;}
record.specialData[name]=data;specialFieldNames.push(name);});}})).then(function(){return specialFieldNames;});},_fetchSpecialMany2ones:function(record,fieldName,fieldInfo,fieldsToRead){var field=record.fields[fieldName];if(field.type!=="many2one"){return Promise.resolve();}
var context=record.getContext({fieldName:fieldName});var domain=record.getDomain({fieldName:fieldName});if(domain.length){var localID=(record._changes&&fieldName in record._changes)?record._changes[fieldName]:record.data[fieldName];if(localID){var element=this.localData[localID];domain=["|",["id","=",element.data.id]].concat(domain);}}
var hasChanged=this._saveSpecialDataCache(record,fieldName,{context:context,domain:domain,});if(!hasChanged){return Promise.resolve();}
var self=this;return this._rpc({model:field.relation,method:'search_read',fields:["id"].concat(fieldsToRead||[]),context:context,domain:domain,}).then(function(records){var ids=_.pluck(records,'id');return self._rpc({model:field.relation,method:'name_get',args:[ids],context:context,}).then(function(name_gets){_.each(records,function(rec){var name_get=_.find(name_gets,function(n){return n[0]===rec.id;});rec.display_name=name_get[1];});return records;});});},_fetchSpecialRelation:function(record,fieldName){var field=record.fields[fieldName];if(!_.contains(["many2one","many2many","one2many"],field.type)){return Promise.resolve();}
var context=record.getContext({fieldName:fieldName});var domain=record.getDomain({fieldName:fieldName});var hasChanged=this._saveSpecialDataCache(record,fieldName,{context:context,domain:domain,});if(!hasChanged){return Promise.resolve();}
return this._rpc({model:field.relation,method:'name_search',args:["",domain],context:context});},_fetchSpecialReference:function(record,fieldName){var def;var field=record.fields[fieldName];if(field.type==='char'){def=this._fetchReference(record,fieldName);}
return Promise.resolve(def);},_fetchSpecialStatus:function(record,fieldName,fieldInfo){var foldField=fieldInfo.options.fold_field;var fieldsToRead=foldField?[foldField]:[];return this._fetchSpecialMany2ones(record,fieldName,fieldInfo,fieldsToRead).then(function(m2os){_.each(m2os,function(m2o){m2o.fold=foldField?m2o[foldField]:false;});return m2os;});},_fetchSpecialDomain:function(record,fieldName,fieldInfo){var self=this;var context=record.getContext({fieldName:fieldName});var domainModel=fieldInfo.options.model;if(record.data.hasOwnProperty(domainModel)){domainModel=record._changes&&record._changes[domainModel]||record.data[domainModel];}
var domainValue=record._changes&&record._changes[fieldName]||record.data[fieldName]||[];var hasChanged=this._saveSpecialDataCache(record,fieldName,{context:context,domainModel:domainModel,domainValue:domainValue,});if(!hasChanged){return Promise.resolve();}else if(!domainModel){return Promise.resolve({model:domainModel,nbRecords:0,});}
return new Promise(function(resolve){var evalContext=self._getEvalContext(record);self._rpc({model:domainModel,method:'search_count',args:[Domain.prototype.stringToArray(domainValue,evalContext)],context:context}).then(function(nbRecords){resolve({model:domainModel,nbRecords:nbRecords,});}).guardedCatch(function(reason){var e=reason.event;e.preventDefault();resolve({model:domainModel,nbRecords:0,});});});},_fetchUngroupedList:function(list,options){options=_.defaults(options||{},{enableRelationalFetch:true});var self=this;var def;if(list.static){def=this._readUngroupedList(list).then(function(){if(list.parentID&&self.isNew(list.parentID)){var many2ones=self._getMany2OneFieldNames(list);var defs=_.map(many2ones,function(name){return self._fetchNameGets(list,name);});return Promise.all(defs);}});}else{def=this._searchReadUngroupedList(list);}
return def.then(function(){if(options.enableRelationalFetch){return Promise.all([self._fetchX2ManysBatched(list),self._fetchReferencesBatched(list)]);}}).then(function(){return list;});},_fetchX2ManyBatched:function(list,fieldName){list=this._applyX2ManyOperations(list);this._sortList(list);var toFetch=this._getDataToFetch(list,fieldName);return this._fetchRelatedData(list,toFetch,fieldName);},_fetchX2Manys:function(record,options){var self=this;var defs=[];options=options||{};var fieldNames=options.fieldNames||record.getFieldNames(options);var viewType=options.viewType||record.viewType;_.each(fieldNames,function(fieldName){var field=record.fields[fieldName];if(field.type==='one2many'||field.type==='many2many'){var fieldInfo=record.fieldsInfo[viewType][fieldName];var rawContext=fieldInfo&&fieldInfo.context;var view=fieldInfo.views&&fieldInfo.views[fieldInfo.mode];var fieldsInfo=view?view.fieldsInfo:(fieldInfo.fieldsInfo||{});var ids=record.data[fieldName]||[];var list=self._makeDataPoint({count:ids.length,context:_.extend({},record.context,field.context),fieldsInfo:fieldsInfo,fields:view?view.fields:fieldInfo.relatedFields,limit:fieldInfo.limit,modelName:field.relation,res_ids:ids,static:true,type:'list',orderedBy:fieldInfo.orderedBy,parentID:record.id,rawContext:rawContext,relationField:field.relation_field,viewType:view?view.type:fieldInfo.viewType,});record.data[fieldName]=list.id;if(!fieldInfo.__no_fetch){var def=self._readUngroupedList(list).then(function(){return Promise.all([self._fetchX2ManysBatched(list),self._fetchReferencesBatched(list)]);});defs.push(def);}}});return Promise.all(defs);},_fetchX2ManysBatched:function(list){var defs=[];var fieldNames=list.getFieldNames();for(var i=0;i<fieldNames.length;i++){var field=list.fields[fieldNames[i]];if(field.type==='many2many'||field.type==='one2many'){defs.push(this._fetchX2ManyBatched(list,fieldNames[i]));}}
return Promise.all(defs);},_fetchX2ManySingleBatch:function(list,fieldName){var self=this;var toFetch={};_.each(list.data,function(groupIndex){var group=self.localData[groupIndex];var nextDataToFetch=self._getDataToFetch(group,fieldName);_.each(_.keys(nextDataToFetch),function(id){if(toFetch[id]){toFetch[id]=toFetch[id].concat(nextDataToFetch[id]);}else{toFetch[id]=nextDataToFetch[id];}});});return self._fetchRelatedData(list,toFetch,fieldName);},_fetchX2ManysSingleBatch:function(list){var defs=[];var fieldNames=list.getFieldNames();for(var i=0;i<fieldNames.length;i++){var field=list.fields[fieldNames[i]];if(field.type==='many2many'||field.type==='one2many'){defs.push(this._fetchX2ManySingleBatch(list,fieldNames[i]));}}
return Promise.all(defs);},_generateChanges:function(record,options){options=options||{};var viewType=options.viewType||record.viewType;var changes;const changesOnly='changesOnly'in options?!!options.changesOnly:true;if(!changesOnly){changes=_.extend({},record.data,record._changes);}else{changes=_.extend({},record._changes);}
var withReadonly=options.withReadonly||false;var commands=this._generateX2ManyCommands(record,{changesOnly:changesOnly,withReadonly:withReadonly,});for(var fieldName in record.fields){if(!withReadonly&&fieldName in changes||fieldName in commands){var editionViewType=record._editionViewType[fieldName]||viewType;if(this._isFieldProtected(record,fieldName,editionViewType)){delete changes[fieldName];continue;}}
var type=record.fields[fieldName].type;var value;if(type==='one2many'||type==='many2many'){if(!changesOnly||(commands[fieldName]&&commands[fieldName].length)){changes[fieldName]=commands[fieldName];}else{delete changes[fieldName];}}else if(type==='many2one'&&fieldName in changes){value=changes[fieldName];changes[fieldName]=value?this.localData[value].res_id:false;}else if(type==='reference'&&fieldName in changes){value=changes[fieldName];changes[fieldName]=value?this.localData[value].model+','+this.localData[value].res_id:false;}else if(type==='char'&&changes[fieldName]===''){changes[fieldName]=false;}else if(changes[fieldName]===null){changes[fieldName]=false;}}
return changes;},_generateOnChangeData:function(record,options){options=_.extend({},options||{},{withReadonly:true});var data={};if(!options.firstOnChange){var commands=this._generateX2ManyCommands(record,options);data=_.extend(this.get(record.id,{raw:true}).data,commands);var hasDisplayName=_.some(record.fieldsInfo,function(fieldsInfo){return'display_name'in fieldsInfo;});if(!hasDisplayName){delete data.display_name;}}
if(record.parentID){var parent=this.localData[record.parentID];if(parent.parentID&&parent.relationField){var parentRecord=this.localData[parent.parentID];data[parent.relationField]=this._generateOnChangeData(parentRecord);}}
return data;},_generateX2ManyCommands:function(record,options){var self=this;options=options||{};var fields=record.fields;if(options.fieldNames){fields=_.pick(fields,options.fieldNames);}
var commands={};var data=_.extend({},record.data,record._changes);var type;for(var fieldName in fields){type=fields[fieldName].type;if(type==='many2many'||type==='one2many'){if(!data[fieldName]){continue;}
commands[fieldName]=[];var list=this.localData[data[fieldName]];if(options.changesOnly&&(!list._changes||!list._changes.length)){continue;}
var oldResIDs=list.res_ids.slice(0);var relRecordAdded=[];var relRecordUpdated=[];_.each(list._changes,function(change){if(change.operation==='ADD'&&change.id){relRecordAdded.push(self.localData[change.id]);}else if(change.operation==='UPDATE'&&!self.isNew(change.id)){relRecordUpdated.push(self.localData[change.id]);}});list=this._applyX2ManyOperations(list);this._sortList(list);if(type==='many2many'||list._forceM2MLink){var relRecordCreated=_.filter(relRecordAdded,function(rec){return typeof rec.res_id==='string';});var realIDs=_.difference(list.res_ids,_.pluck(relRecordCreated,'res_id'));commands[fieldName].push(x2ManyCommands.replace_with(realIDs));_.each(relRecordCreated,function(relRecord){var changes=self._generateChanges(relRecord,options);commands[fieldName].push(x2ManyCommands.create(relRecord.ref,changes));});_.each(relRecordUpdated,function(relRecord){var changes=self._generateChanges(relRecord,options);if(!_.isEmpty(changes)){var command=x2ManyCommands.update(relRecord.res_id,changes);commands[fieldName].push(command);}});}else if(type==='one2many'){var removedIds=_.difference(oldResIDs,list.res_ids);var addedIds=_.difference(list.res_ids,oldResIDs);var keptIds=_.intersection(oldResIDs,list.res_ids);var didChange=false;var changes,command,relRecord;for(var i=0;i<list.res_ids.length;i++){if(_.contains(keptIds,list.res_ids[i])){relRecord=_.findWhere(relRecordUpdated,{res_id:list.res_ids[i]});changes=relRecord?this._generateChanges(relRecord,options):{};if(!_.isEmpty(changes)){command=x2ManyCommands.update(relRecord.res_id,changes);didChange=true;}else{command=x2ManyCommands.link_to(list.res_ids[i]);}
commands[fieldName].push(command);}else if(_.contains(addedIds,list.res_ids[i])){relRecord=_.findWhere(relRecordAdded,{res_id:list.res_ids[i]});if(!relRecord){commands[fieldName].push(x2ManyCommands.link_to(list.res_ids[i]));continue;}
changes=this._generateChanges(relRecord,options);if(!this.isNew(relRecord.id)){commands[fieldName].push(x2ManyCommands.link_to(relRecord.res_id));if(this.isDirty(relRecord.id)){delete changes.id;commands[fieldName].push(x2ManyCommands.update(relRecord.res_id,changes));}}else{const rawChangesEntries=Object.entries(relRecord._rawChanges);for(const[fieldName,value]of rawChangesEntries){const isMany2OneValue=Array.isArray(value)&&value.length===2&&Number.isInteger(value[0])&&typeof value[1]==='string';changes[fieldName]=isMany2OneValue?value[0]:value;}
commands[fieldName].push(x2ManyCommands.create(relRecord.ref,changes));}}}
if(options.changesOnly&&!didChange&&addedIds.length===0&&removedIds.length===0){commands[fieldName]=[];}
for(i=0;i<removedIds.length;i++){if(list._forceM2MUnlink){commands[fieldName].push(x2ManyCommands.forget(removedIds[i]));}else{commands[fieldName].push(x2ManyCommands.delete(removedIds[i]));}}}}}
return commands;},_getContext:function(element,options){options=options||{};var context=new Context(session.user_context);context.set_eval_context(this._getEvalContext(element));if(options.full||!(options.fieldName||options.additionalContext)){context.add(element.context);}
if(options.fieldName){var viewType=options.viewType||element.viewType;var fieldInfo=element.fieldsInfo[viewType][options.fieldName];if(fieldInfo&&fieldInfo.context){context.add(fieldInfo.context);}else{var fieldParams=element.fields[options.fieldName];if(fieldParams.context){context.add(fieldParams.context);}}}
if(options.additionalContext){context.add(options.additionalContext);}
if(element.rawContext){var rawContext=new Context(element.rawContext);var evalContext=this._getEvalContext(this.localData[element.parentID]);evalContext.id=evalContext.id||false;rawContext.set_eval_context(evalContext);context.add(rawContext);}
return context.eval();},_getDataToFetch:function(list,fieldName){var self=this;var field=list.fields[fieldName];var fieldInfo=list.fieldsInfo[list.viewType][fieldName];var view=fieldInfo.views&&fieldInfo.views[fieldInfo.mode];var fieldsInfo=view?view.fieldsInfo:fieldInfo.fieldsInfo;var fields=view?view.fields:fieldInfo.relatedFields;var viewType=view?view.type:fieldInfo.viewType;var toFetch={};let dataPointIds=list.data;for(let i=0;i<list.groupedBy.length;i++){dataPointIds=dataPointIds.reduce((acc,groupId)=>acc.concat(this.localData[groupId].data),[]);}
dataPointIds.forEach(function(dataPoint){var record=self.localData[dataPoint];if(typeof record.data[fieldName]==='string'){return;}
_.each(record.data[fieldName],function(id){toFetch[id]=toFetch[id]||[];toFetch[id].push(record);});var m2mList=self._makeDataPoint({fieldsInfo:fieldsInfo,fields:fields,modelName:field.relation,parentID:record.id,res_ids:record.data[fieldName],static:true,type:'list',viewType:viewType,});record.data[fieldName]=m2mList.id;});return toFetch;},_getDataToFetchByModel:function(list,fieldName,toFetchAcc){var self=this;var toFetch=toFetchAcc||{};_.each(list.data,function(dataPoint){var record=self.localData[dataPoint];var value=record.data[fieldName];if(value&&!self.localData[value]){var model=value.split(',')[0];var resID=value.split(',')[1];if(!(model in toFetch)){toFetch[model]={};}
if(toFetch[model][resID]){toFetch[model][resID].push(dataPoint);}else{toFetch[model][resID]=[dataPoint];}}});return toFetch;},_getDefaultContext:function(dataPoint){var defaultContext={};while(dataPoint.parentID){var parent=this.localData[dataPoint.parentID];var groupByField=parent.groupedBy[0].split(':')[0];var value=viewUtils.getGroupValue(dataPoint,groupByField);if(value){defaultContext['default_'+groupByField]=value;}
dataPoint=parent;}
return defaultContext;},_getDomain:function(element,options){if(options&&options.fieldName){if(element._domains[options.fieldName]){return Domain.prototype.stringToArray(element._domains[options.fieldName],this._getEvalContext(element,true));}
var viewType=options.viewType||element.viewType;var fieldInfo=element.fieldsInfo[viewType][options.fieldName];if(fieldInfo&&fieldInfo.domain){return Domain.prototype.stringToArray(fieldInfo.domain,this._getEvalContext(element,true));}
var fieldParams=element.fields[options.fieldName];if(fieldParams.domain){return Domain.prototype.stringToArray(fieldParams.domain,this._getEvalContext(element,true));}
return[];}
return Domain.prototype.stringToArray(element.domain,this._getEvalContext(element,true));},_getEvalContext:function(element,forDomain){var evalContext=element.type==='record'?this._getRecordEvalContext(element,forDomain):{};if(element.parentID){var parent=this.localData[element.parentID];if(parent.type==='list'&&parent.parentID){parent=this.localData[parent.parentID];}
if(parent.type==='record'){evalContext.parent=this._getRecordEvalContext(parent,forDomain);}}
let current_company_id;if(session.user_context.allowed_company_ids){current_company_id=session.user_context.allowed_company_ids[0];}else{current_company_id=session.user_companies?session.user_companies.current_company[0]:false;}
return Object.assign({active_id:evalContext.id||false,active_ids:evalContext.id?[evalContext.id]:[],active_model:element.model,current_company_id,id:evalContext.id||false,},pyUtils.context(),session.user_context,element.context,evalContext,);},_getFieldNames:function(element,options){var fieldsInfo=element.fieldsInfo;var viewType=options&&options.viewType||element.viewType;return Object.keys(fieldsInfo&&fieldsInfo[viewType]||{});},_getMany2OneFieldNames:function(datapoint){var many2ones=[];_.each(datapoint.fields,function(field,name){if(field.type==='many2one'){many2ones.push(name);}});return many2ones;},_getRecordEvalContext:function(record,forDomain){var self=this;var relDataPoint;var context=_.extend({},record.data,record._changes);function _generateX2ManyCommands(fieldName){var commands=self._generateX2ManyCommands(record,{fieldNames:[fieldName]});return commands[fieldName];}
for(var fieldName in context){var field=record.fields[fieldName];if(context[fieldName]===null){context[fieldName]=false;}
if(!field||field.name==='id'){continue;}
if(field.type==='date'||field.type==='datetime'){if(context[fieldName]){context[fieldName]=JSON.parse(JSON.stringify(context[fieldName]));}
continue;}
if(field.type==='many2one'){relDataPoint=this.localData[context[fieldName]];context[fieldName]=relDataPoint?relDataPoint.res_id:false;continue;}
if(field.type==='one2many'||field.type==='many2many'){var ids;if(!context[fieldName]||_.isArray(context[fieldName])){ids=context[fieldName]?context[fieldName].slice(0):[];}else{relDataPoint=this._applyX2ManyOperations(this.localData[context[fieldName]]);ids=relDataPoint.res_ids.slice(0);}
if(!forDomain){ids.toJSON=_generateX2ManyCommands.bind(null,fieldName);}else if(field.type==='one2many'){ids=_.filter(ids,function(id){return typeof id!=='string';});}
context[fieldName]=ids;}}
return context;},_invalidateCache:function(dataPoint){while(dataPoint.parentID){dataPoint=this.localData[dataPoint.parentID];}
if(dataPoint.model==='res.currency'){session.reloadCurrencies();}
if(dataPoint.model==='res.company'&&!localStorage.getItem('running_tour')){this.do_action('reload_context');}
if(_.contains(this.noCacheModels,dataPoint.model)){core.bus.trigger('clear_cache');}},_isFieldProtected:function(record,fieldName,viewType){viewType=viewType||record.viewType;var fieldInfo=viewType&&record.fieldsInfo&&record.fieldsInfo[viewType][fieldName];if(fieldInfo){var rawModifiers=fieldInfo.modifiers||{};var modifiers=this._evalModifiers(record,_.pick(rawModifiers,'readonly'));return modifiers.readonly&&!fieldInfo.force_save;}else{return false;}},_isFieldSet:function(value,fieldType){switch(fieldType){case'boolean':return true;case'one2many':case'many2many':return value.length>0;default:return value!==false;}},_isX2ManyValid:function(id){var self=this;var isValid=true;var element=this.localData[id];_.each(element._changes,function(command){if(command.operation==='DELETE'||command.operation==='FORGET'||(command.operation==='ADD'&&!command.isNew)||command.operation==='REMOVE_ALL'){return;}
var recordData=self.get(command.id,{raw:true}).data;var record=self.localData[command.id];_.each(element.getFieldNames(),function(fieldName){var field=element.fields[fieldName];var fieldInfo=element.fieldsInfo[element.viewType][fieldName];var rawModifiers=fieldInfo.modifiers||{};var modifiers=self._evalModifiers(record,_.pick(rawModifiers,'required'));if(modifiers.required&&!self._isFieldSet(recordData[fieldName],field.type)){isValid=false;}});});return isValid;},_load:function(dataPoint,options){if(options&&options.onlyGroups&&!(dataPoint.type==='list'&&dataPoint.groupedBy.length)){return Promise.resolve(dataPoint);}
if(dataPoint.type==='record'){return this._fetchRecord(dataPoint,options);}
if(dataPoint.type==='list'&&dataPoint.groupedBy.length){return this._readGroup(dataPoint,options);}
if(dataPoint.type==='list'&&!dataPoint.groupedBy.length){return this._fetchUngroupedList(dataPoint,options);}},_makeDataPoint:function(params){var type=params.type||('domain'in params&&'list')||'record';var res_id,value;var res_ids=params.res_ids||[];var data=params.data||(type==='record'?{}:[]);var context=params.context;if(type==='record'){res_id=params.res_id||(params.data&&params.data.id);if(res_id){data.id=res_id;}else{res_id=_.uniqueId('virtual_');}
context=_.omit(context,['orderedBy','group_by']);}else{var isValueArray=params.value instanceof Array;res_id=isValueArray?params.value[0]:undefined;value=isValueArray?params.value[1]:params.value;}
var fields=_.extend({display_name:{type:'char'},id:{type:'integer'},},params.fields);var dataPoint={_cache:type==='list'?{}:undefined,_changes:null,_domains:{},_rawChanges:{},aggregateValues:params.aggregateValues||{},context:context,count:params.count||res_ids.length,data:data,domain:params.domain||[],fields:fields,fieldsInfo:params.fieldsInfo,groupedBy:params.groupedBy||[],groupsCount:0,groupsLimit:type==='list'&&params.groupsLimit||null,groupsOffset:0,id:`${params.modelName}_${++this.__id}`,isOpen:params.isOpen,limit:type==='record'?1:(params.limit||Number.MAX_SAFE_INTEGER),loadMoreOffset:0,model:params.modelName,offset:params.offset||(type==='record'?_.indexOf(res_ids,res_id):0),openGroupByDefault:params.openGroupByDefault,orderedBy:params.orderedBy||[],orderedResIDs:params.orderedResIDs,parentID:params.parentID,rawContext:params.rawContext,ref:params.ref||res_id,relationField:params.relationField,res_id:res_id,res_ids:res_ids,specialData:{},_specialDataCache:{},static:params.static||false,type:type,value:value,viewType:params.viewType,};dataPoint._editionViewType={};dataPoint.evalModifiers=this._evalModifiers.bind(this,dataPoint);dataPoint.getContext=this._getContext.bind(this,dataPoint);dataPoint.getDomain=this._getDomain.bind(this,dataPoint);dataPoint.getFieldNames=this._getFieldNames.bind(this,dataPoint);dataPoint.isDirty=this.isDirty.bind(this,dataPoint.id);this.localData[dataPoint.id]=dataPoint;return dataPoint;},async _makeDefaultRecord(modelName,params){var targetView=params.viewType;var fields=params.fields;var fieldsInfo=params.fieldsInfo;var fieldNames=Object.keys(fieldsInfo[targetView]);var parentRecord=params.parentID&&this.localData[params.parentID].type==='list'?this.localData[params.parentID]:null;if(parentRecord&&parentRecord.viewType in parentRecord.fieldsInfo){var originView=parentRecord.viewType;fieldNames=_.union(fieldNames,Object.keys(parentRecord.fieldsInfo[originView]));fieldsInfo[targetView]=_.defaults({},fieldsInfo[targetView],parentRecord.fieldsInfo[originView]);fields=_.defaults({},fields,parentRecord.fields);}
var record=this._makeDataPoint({modelName:modelName,fields:fields,fieldsInfo:fieldsInfo,context:params.context,parentID:params.parentID,res_ids:params.res_ids,viewType:targetView,});await this.generateDefaultValues(record.id,{},{fieldNames});try{await this._performOnChange(record,[],{firstOnChange:true});}finally{if(record._warning&&params.allowWarning){delete record._warning;}}
if(record._warning){return Promise.reject();}
var overrideDefaultFields=this._computeOverrideDefaultFields(params.parentID,params.position);if(overrideDefaultFields.field){record._changes[overrideDefaultFields.field]=overrideDefaultFields.value;}
await this._postprocess(record);this.save(record.id,{savePoint:true});return record.id;},_parseServerData:function(fieldNames,element,data){var self=this;_.each(fieldNames,function(fieldName){var field=element.fields[fieldName];var val=data[fieldName];if(field.type==='many2one'){if(val!==false){var r=self._makeDataPoint({modelName:field.relation,fields:{display_name:{type:'char'},id:{type:'integer'},},data:{display_name:val[1],id:val[0],},parentID:element.id,});data[fieldName]=r.id;}else{data[fieldName]=false;}}else{data[fieldName]=self._parseServerValue(field,val);}});},async _performOnChange(record,fields,options={}){const firstOnChange=options.firstOnChange;let{hasOnchange,onchangeSpec}=this._buildOnchangeSpecs(record,options.viewType);if(!firstOnChange&&!hasOnchange){return;}
var idList=record.data.id?[record.data.id]:[];const ctxOptions={full:true,};if(fields.length===1){fields=fields[0];ctxOptions.fieldName=fields;}
var context=this._getContext(record,ctxOptions);var currentData=this._generateOnChangeData(record,{changesOnly:false,firstOnChange,});const result=await this._rpc({model:record.model,method:'onchange',args:[idList,currentData,fields,onchangeSpec],context:context,});if(!record._changes){return;}
if(result.warning){this.trigger_up('warning',result.warning);record._warning=true;}
if(result.domain){record._domains=Object.assign(record._domains,result.domain);}
await this._applyOnChange(result.value,record,{firstOnChange});return result;},_performRPC:function(params){var self=this;var request=_.extend({},params);var prom=new Promise(function(resolve,reject){request.resolve=resolve;request.reject=reject;});this.batchedRPCsRequests.push(request);Promise.resolve().then(function(){if(!self.batchedRPCsRequests.length){return;}
var batchedRPCsRequests=self.batchedRPCsRequests;self.batchedRPCsRequests=[];var batches={};var key;for(var i=0;i<batchedRPCsRequests.length;i++){var request=batchedRPCsRequests[i];key=request.model+','+JSON.stringify(request.context);if(!batches[key]){batches[key]=_.extend({},request,{requests:[request]});}else{batches[key].ids=_.uniq(batches[key].ids.concat(request.ids));batches[key].fieldNames=_.uniq(batches[key].fieldNames.concat(request.fieldNames));batches[key].requests.push(request);}}
function onSuccess(batch,results){for(var i=0;i<batch.requests.length;i++){var request=batch.requests[i];var fieldNames=request.fieldNames.concat(['id']);var filteredResults=results.filter(function(record){return request.ids.indexOf(record.id)>=0;}).map(function(record){return _.pick(record,fieldNames);});request.resolve(filteredResults);}}
function onFailure(batch,error){for(var i=0;i<batch.requests.length;i++){var request=batch.requests[i];request.reject(error);}}
for(key in batches){var batch=batches[key];self._rpc({model:batch.model,method:'read',args:[batch.ids,batch.fieldNames],context:batch.context,}).then(onSuccess.bind(null,batch)).guardedCatch(onFailure.bind(null,batch));}});return prom;},_postprocess:function(record,options){var self=this;var viewType=options&&options.viewType||record.viewType;var defs=[];_.each(record.getFieldNames(options),function(name){var field=record.fields[name];var fieldInfo=record.fieldsInfo[viewType][name]||{};var options=fieldInfo.options||{};if(options.always_reload){if(record.fields[name].type==='many2one'){const _changes=record._changes||{};const relRecordId=_changes[name]||record.data[name];if(!relRecordId){return;}
var relRecord=self.localData[relRecordId];defs.push(self._rpc({model:field.relation,method:'name_get',args:[relRecord.data.id],context:self._getContext(record,{fieldName:name,viewType:viewType}),}).then(function(result){relRecord.data.display_name=result[0][1];}));}}});defs.push(this._fetchSpecialData(record,options));return Promise.all(defs).then(function(){return record;});},_processX2ManyCommands:function(record,fieldName,commands,options){var self=this;options=options||{};var defs=[];var field=record.fields[fieldName];var fieldInfo=record.fieldsInfo[options.viewType||record.viewType][fieldName]||{};var view=fieldInfo.views&&fieldInfo.views[fieldInfo.mode];var fieldsInfo=view?view.fieldsInfo:fieldInfo.fieldsInfo;var fields=view?view.fields:fieldInfo.relatedFields;var viewType=view?view.type:fieldInfo.viewType;var parentContext=_.omit(record.context,function(val,key){return _.str.startsWith(key,'default_');});var x2manyList=self._makeDataPoint({context:parentContext,fieldsInfo:fieldsInfo,fields:fields,limit:fieldInfo.limit,modelName:field.relation,parentID:record.id,rawContext:fieldInfo&&fieldInfo.context,relationField:field.relation_field,res_ids:[],static:true,type:'list',viewType:viewType,});record._changes[fieldName]=x2manyList.id;x2manyList._changes=[];var many2ones={};var r;commands=commands||[];var isCommandList=commands.length&&_.isArray(commands[0]);if(!isCommandList){commands=[[6,false,commands]];}
_.each(commands,function(value){if(value[0]===0){r=self._makeDataPoint({modelName:x2manyList.model,context:x2manyList.context,fieldsInfo:fieldsInfo,fields:fields,parentID:x2manyList.id,viewType:viewType,});r._noAbandon=true;x2manyList._changes.push({operation:'ADD',id:r.id});x2manyList._cache[r.res_id]=r.id;_.each(r.getFieldNames(),function(fieldName){r.data[fieldName]=null;});r._changes=_.defaults(value[2],r.data);for(var fieldName in r._changes){if(!r._changes[fieldName]){continue;}
var isFieldInView=fieldName in r.fields;if(isFieldInView){var field=r.fields[fieldName];var fieldType=field.type;var rec;if(fieldType==='many2one'){rec=self._makeDataPoint({context:r.context,modelName:field.relation,data:{id:r._changes[fieldName]},parentID:r.id,});r._changes[fieldName]=rec.id;many2ones[fieldName]=true;}else if(fieldType==='reference'){var reference=r._changes[fieldName].split(',');rec=self._makeDataPoint({context:r.context,modelName:reference[0],data:{id:parseInt(reference[1])},parentID:r.id,});r._changes[fieldName]=rec.id;many2ones[fieldName]=true;}else if(_.contains(['one2many','many2many'],fieldType)){var x2mCommands=value[2][fieldName];defs.push(self._processX2ManyCommands(r,fieldName,x2mCommands));}else{r._changes[fieldName]=self._parseServerValue(field,r._changes[fieldName]);}}}}
if(value[0]===6){_.each(value[2],function(res_id){x2manyList._changes.push({operation:'ADD',resID:res_id});});var def=self._readUngroupedList(x2manyList).then(function(){return Promise.all([self._fetchX2ManysBatched(x2manyList),self._fetchReferencesBatched(x2manyList)]);});defs.push(def);}});_.each(_.keys(many2ones),function(name){defs.push(self._fetchNameGets(x2manyList,name));});return Promise.all(defs);},_readMissingFields:function(list,resIDs,fieldNames){var self=this;var missingIDs=[];for(var i=0,len=resIDs.length;i<len;i++){var resId=resIDs[i];var dataPointID=list._cache[resId];if(!dataPointID){missingIDs.push(resId);continue;}
var record=self.localData[dataPointID];var data=_.extend({},record.data,record._changes);if(_.difference(fieldNames,_.keys(data)).length){missingIDs.push(resId);}}
var def;if(missingIDs.length&&fieldNames.length){def=self._performRPC({context:list.getContext(),fieldNames:fieldNames,ids:missingIDs,method:'read',model:list.model,});}else{def=Promise.resolve(_.map(missingIDs,function(id){return{id:id};}));}
return def.then(function(records){_.each(resIDs,function(id){var dataPoint;var data=_.findWhere(records,{id:id});if(id in list._cache){dataPoint=self.localData[list._cache[id]];if(data){self._parseServerData(fieldNames,dataPoint,data);_.extend(dataPoint.data,data);}}else{dataPoint=self._makeDataPoint({context:list.getContext(),data:data,fieldsInfo:list.fieldsInfo,fields:list.fields,modelName:list.model,parentID:list.id,viewType:list.viewType,});self._parseServerData(fieldNames,dataPoint,dataPoint.data);list._cache[id]=dataPoint.id;}
_.each(list._changes,function(change){if(change.operation==='ADD'&&!change.id&&change.resID===id){change.id=dataPoint.id;}});});return list;});},_readGroup:function(list,options){var self=this;options=options||{};var groupByField=list.groupedBy[0];var rawGroupBy=groupByField.split(':')[0];var fields=_.uniq(list.getFieldNames().concat(rawGroupBy));var orderedBy=_.filter(list.orderedBy,function(order){return order.name===rawGroupBy||list.fields[order.name].group_operator!==undefined;});var openGroupsLimit=list.groupsLimit||self.OPEN_GROUP_LIMIT;var expand=list.openGroupByDefault&&options.fetchRecordsWithGroups;return this._rpc({model:list.model,method:'web_read_group',fields:fields,domain:list.domain,context:list.context,groupBy:list.groupedBy,limit:list.groupsLimit,offset:list.groupsOffset,orderBy:orderedBy,lazy:true,expand:expand,expand_limit:expand?list.limit:null,expand_orderby:expand?list.orderedBy:null,}).then(function(result){var groups=result.groups;list.groupsCount=result.length;var previousGroups=_.map(list.data,function(groupID){return self.localData[groupID];});list.data=[];list.count=0;var defs=[];var openGroupCount=0;_.each(groups,function(group){var aggregateValues={};_.each(group,function(value,key){if(_.contains(fields,key)&&key!==groupByField&&AGGREGATABLE_TYPES.includes(list.fields[key].type)){aggregateValues[key]=value;}});var value=group[groupByField];if(list.fields[rawGroupBy].type==="selection"){var choice=_.find(list.fields[rawGroupBy].selection,function(c){return c[0]===value;});value=choice?choice[1]:false;}
var newGroup=self._makeDataPoint({modelName:list.model,count:group[rawGroupBy+'_count'],domain:group.__domain,context:list.context,fields:list.fields,fieldsInfo:list.fieldsInfo,value:value,aggregateValues:aggregateValues,groupedBy:list.groupedBy.slice(1),orderedBy:list.orderedBy,orderedResIDs:list.orderedResIDs,limit:list.limit,openGroupByDefault:list.openGroupByDefault,parentID:list.id,type:'list',viewType:list.viewType,});var oldGroup=_.find(previousGroups,function(g){return g.res_id===newGroup.res_id&&g.value===newGroup.value;});if(oldGroup){delete self.localData[newGroup.id];var updatedProps=_.pick(oldGroup,'isOpen','offset','id');if(options.onlyGroups||oldGroup.isOpen&&newGroup.groupedBy.length){updatedProps.data=oldGroup.data;if(options.onlyGroups){updatedProps.res_ids=oldGroup.res_ids;updatedProps.count=oldGroup.count;}}
_.extend(newGroup,updatedProps);newGroup.limit=oldGroup.limit+oldGroup.loadMoreOffset;self.localData[newGroup.id]=newGroup;}else if(!newGroup.openGroupByDefault||openGroupCount>=openGroupsLimit){newGroup.isOpen=false;}else if('__fold'in group){newGroup.isOpen=!group.__fold;}else{newGroup.isOpen=!self.localData[newGroup.parentID].parentID;}
list.data.push(newGroup.id);list.count+=newGroup.count;if(newGroup.isOpen&&newGroup.count>0){openGroupCount++;if(group.__data){newGroup.__data=group.__data;}
options=_.defaults({enableRelationalFetch:false},options);defs.push(self._load(newGroup,options));}});if(options.keepEmptyGroups){var emptyGroupsIDs=_.difference(_.pluck(previousGroups,'id'),list.data);_.each(emptyGroupsIDs,function(groupID){list.data.push(groupID);var emptyGroup=self.localData[groupID];emptyGroup.aggregateValues={};});}
return Promise.all(defs).then(function(groups){if(!options.onlyGroups){list.res_ids=_.flatten(_.map(groups,function(group){return group?group.res_ids:[];}));}
return list;}).then(function(){return Promise.all([self._fetchX2ManysSingleBatch(list),self._fetchReferencesSingleBatch(list)]).then(function(){return list;});});});},_readUngroupedList:function(list){var self=this;var def=Promise.resolve();list=this._applyX2ManyOperations(list);if(list.res_ids.length>list.limit&&list.orderedBy.length){if(!list.orderedResIDs){var fieldNames=_.pluck(list.orderedBy,'name');def=this._readMissingFields(list,_.filter(list.res_ids,_.isNumber),fieldNames);}
def.then(function(){self._sortList(list);});}
return def.then(function(){var resIDs=[];var currentResIDs=list.res_ids;if(list.orderedResIDs){currentResIDs=list.orderedResIDs.filter(function(resID){return list.res_ids.indexOf(resID)>=0;});}
var currentCount=currentResIDs.length;var upperBound=list.limit?Math.min(list.offset+list.limit,currentCount):currentCount;var fieldNames=list.getFieldNames();for(var i=list.offset;i<upperBound;i++){var resId=currentResIDs[i];if(_.isNumber(resId)){resIDs.push(resId);}}
return self._readMissingFields(list,resIDs,fieldNames).then(function(){if(list.res_ids.length<=list.limit){self._sortList(list);}else{self._setDataInRange(list);}
return list;});});},_reload:function(id,options){options=options||{};var element=this.localData[id];if(element.type==='record'){if(!options.currentId&&(('currentId'in options)||this.isNew(id))){var params={context:element.context,fieldsInfo:element.fieldsInfo,fields:element.fields,viewType:element.viewType,allowWarning:true,};return this._makeDefaultRecord(element.model,params);}
if(!options.keepChanges){this.discardChanges(id,{rollback:false});}}else if(element._changes){delete element.tempLimitIncrement;_.each(element._changes,function(change){delete change.isNew;});}
if(options.context!==undefined){element.context=options.context;}
if(options.orderedBy!==undefined){element.orderedBy=(options.orderedBy.length&&options.orderedBy)||element.orderedBy;}
if(options.domain!==undefined){element.domain=options.domain;}
if(options.groupBy!==undefined){element.groupedBy=options.groupBy;}
if(options.limit!==undefined){element.limit=options.limit;}
if(options.offset!==undefined){this._setOffset(element.id,options.offset);}
if(options.groupsLimit!==undefined){element.groupsLimit=options.groupsLimit;}
if(options.groupsOffset!==undefined){element.groupsOffset=options.groupsOffset;}
if(options.loadMoreOffset!==undefined){element.loadMoreOffset=options.loadMoreOffset;}else{element.loadMoreOffset=0;}
if(options.currentId!==undefined){element.res_id=options.currentId;}
if(options.ids!==undefined){element.res_ids=options.ids;element.count=element.res_ids.length;}
if(element.type==='record'){element.offset=_.indexOf(element.res_ids,element.res_id);}
var loadOptions=_.pick(options,'fieldNames','viewType');return this._load(element,loadOptions).then(function(result){return result.id;});},async _rpc(params){const result=await this._super(...arguments);if(this.sampleModel&&params.method==='web_read_group'&&result.length){const sampleServer=this.sampleModel.sampleServer;sampleServer.setExistingGroups(result.groups);}
return result;},_saveSpecialDataCache:function(record,fieldName,value){if(_.isEqual(record._specialDataCache[fieldName],value)){return false;}
record._specialDataCache[fieldName]=value;return true;},_searchReadUngroupedList:function(list){var self=this;var fieldNames=list.getFieldNames();var prom;if(list.__data){prom=Promise.resolve(list.__data);}else{prom=this._rpc({route:'/web/dataset/search_read',model:list.model,fields:fieldNames,context:_.extend({},list.getContext(),{bin_size:true}),domain:list.domain||[],limit:list.limit,offset:list.loadMoreOffset+list.offset,orderBy:list.orderedBy,});}
return prom.then(function(result){delete list.__data;list.count=result.length;var ids=_.pluck(result.records,'id');var data=_.map(result.records,function(record){var dataPoint=self._makeDataPoint({context:list.context,data:record,fields:list.fields,fieldsInfo:list.fieldsInfo,modelName:list.model,parentID:list.id,viewType:list.viewType,});self._parseServerData(fieldNames,dataPoint,dataPoint.data);return dataPoint.id;});if(list.loadMoreOffset){list.data=list.data.concat(data);list.res_ids=list.res_ids.concat(ids);}else{list.data=data;list.res_ids=ids;}
self._updateParentResIDs(list);return list;});},_setDataInRange:function(list){var idsInRange;if(list.limit){idsInRange=list.res_ids.slice(list.offset,list.offset+list.limit);}else{idsInRange=list.res_ids;}
list.data=[];_.each(idsInRange,function(id){if(list._cache[id]){list.data.push(list._cache[id]);}});if(list.limit){for(var i=list.offset+list.limit;i<list.res_ids.length;i++){var id=list.res_ids[i];var dataPointID=list._cache[id];if(_.findWhere(list._changes,{isNew:true,id:dataPointID})){list.data.push(dataPointID);}else{break;}}}},_setOffset:function(elementId,offset){var element=this.localData[elementId];element.offset=offset;if(element.type==='record'&&element.res_ids.length){element.res_id=element.res_ids[offset];}},_sortList:function(list){if(!list.static){return;}
var self=this;if(list.orderedResIDs){var orderedResIDs={};for(var k=0;k<list.orderedResIDs.length;k++){orderedResIDs[list.orderedResIDs[k]]=k;}
utils.stableSort(list.res_ids,function compareResIdIndexes(resId1,resId2){if(!(resId1 in orderedResIDs)&&!(resId2 in orderedResIDs)){return 0;}
if(!(resId1 in orderedResIDs)){return Infinity;}
if(!(resId2 in orderedResIDs)){return-Infinity;}
return orderedResIDs[resId1]-orderedResIDs[resId2];});}else if(list.orderedBy.length){var compareRecords=function(resId1,resId2,level){if(!level){level=0;}
if(list.orderedBy.length<level+1){return 0;}
var order=list.orderedBy[level];var record1ID=list._cache[resId1];var record2ID=list._cache[resId2];if(!record1ID&&!record2ID){return 0;}
if(!record1ID){return Infinity;}
if(!record2ID){return-Infinity;}
var r1=self.localData[record1ID];var r2=self.localData[record2ID];var data1=_.extend({},r1.data,r1._changes);var data2=_.extend({},r2.data,r2._changes);var orderData1=data1[order.name];var orderData2=data2[order.name];if(list.fields[order.name].type==='many2one'){orderData1=orderData1?self.localData[orderData1].data.display_name:"";orderData2=orderData2?self.localData[orderData2].data.display_name:"";}
if(orderData1<orderData2){return order.asc?-1:1;}
if(orderData1>orderData2){return order.asc?1:-1;}
return compareRecords(resId1,resId2,level+1);};utils.stableSort(list.res_ids,compareRecords);}
this._setDataInRange(list);},_updateParentResIDs:function(element){var self=this;if(element.parentID){var parent=this.localData[element.parentID];parent.res_ids=_.flatten(_.map(parent.data,function(dataPointID){return self.localData[dataPointID].res_ids;}));this._updateParentResIDs(parent);}},_updateRecordsData:function(records,fieldName,values){if(!records.length||!values){return;}
var self=this;var field=records[0].fields[fieldName];var fieldInfo=records[0].fieldsInfo[records[0].viewType][fieldName];var view=fieldInfo.views&&fieldInfo.views[fieldInfo.mode];var fieldsInfo=view?view.fieldsInfo:fieldInfo.fieldsInfo;var fields=view?view.fields:fieldInfo.relatedFields;var viewType=view?view.type:fieldInfo.viewType;_.each(records,function(record){var x2mList=self.localData[record.data[fieldName]];x2mList.data=[];_.each(x2mList.res_ids,function(res_id){var dataPoint=self._makeDataPoint({modelName:field.relation,data:_.findWhere(values,{id:res_id}),fields:fields,fieldsInfo:fieldsInfo,parentID:x2mList.id,viewType:viewType,});x2mList.data.push(dataPoint.id);x2mList._cache[res_id]=dataPoint.id;});});},_visitChildren:function(element,fn){var self=this;fn(element);if(element.type==='record'){for(var fieldName in element.data){var field=element.fields[fieldName];if(!field){continue;}
if(_.contains(['one2many','many2one','many2many'],field.type)){var hasChange=element._changes&&fieldName in element._changes;var value=hasChange?element._changes[fieldName]:element.data[fieldName];var relationalElement=this.localData[value];if(relationalElement){self._visitChildren(relationalElement,fn);}}}}
if(element.type==='list'){element=this._applyX2ManyOperations(element);_.each(element.data,function(elemId){var elem=self.localData[elemId];self._visitChildren(elem,fn);});}},});return BasicModel;});;

/* /web/static/src/js/views/basic/basic_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.BasicView',function(require){"use strict";var AbstractView=require('web.AbstractView');var BasicController=require('web.BasicController');var BasicModel=require('web.BasicModel');var config=require('web.config');var fieldRegistry=require('web.field_registry');var fieldRegistryOwl=require('web.field_registry_owl');var pyUtils=require('web.py_utils');var utils=require('web.utils');var BasicView=AbstractView.extend({config:_.extend({},AbstractView.prototype.config,{Model:BasicModel,Controller:BasicController,}),viewType:undefined,init:function(viewInfo,params){this._super.apply(this,arguments);this.fieldsInfo={};this.fieldsInfo[this.viewType]=this.fieldsView.fieldsInfo[this.viewType];this.rendererParams.viewType=this.viewType;this.controllerParams.confirmOnDelete=true;this.controllerParams.archiveEnabled='active'in this.fields||'x_active'in this.fields;this.controllerParams.hasButtons='action_buttons'in params?params.action_buttons:true;this.controllerParams.viewId=viewInfo.view_id;this.loadParams.fieldsInfo=this.fieldsInfo;this.loadParams.fields=this.fields;this.loadParams.limit=parseInt(this.arch.attrs.limit,10)||params.limit;this.loadParams.parentID=params.parentID;this.loadParams.viewType=this.viewType;this.recordID=params.recordID;this.model=params.model;},_getFieldWidgetClass:function(viewType,field,attrs){var FieldWidget;if(attrs.widget){FieldWidget=fieldRegistryOwl.getAny([viewType+"."+attrs.widget,attrs.widget])||fieldRegistry.getAny([viewType+"."+attrs.widget,attrs.widget]);if(!FieldWidget){console.warn("Missing widget: ",attrs.widget," for field",attrs.name,"of type",field.type);}}else if(viewType==='kanban'&&field.type==='many2many'){FieldWidget=fieldRegistry.get('kanban.many2many_tags');}
return FieldWidget||fieldRegistryOwl.getAny([viewType+"."+field.type,field.type,"abstract"])||fieldRegistry.getAny([viewType+"."+field.type,field.type,"abstract"]);},_loadData:async function(model){if(this.recordID){await model.addFieldsInfo(this.recordID,{fields:this.fields,fieldInfo:this.fieldsInfo[this.viewType],viewType:this.viewType,});var record=model.get(this.recordID);var viewType=this.viewType;var viewFields=Object.keys(record.fieldsInfo[viewType]);var fieldNames=_.difference(viewFields,Object.keys(record.data));var fieldsInfo=record.fieldsInfo[viewType];_.each(viewFields,(name)=>{if(!_.contains(fieldNames,name)){var fieldType=record.fields[name].type;var fieldInfo=fieldsInfo[name];if(fieldInfo.Widget){var requiresSpecialData=fieldInfo.Widget.prototype.specialData;if(requiresSpecialData&&!(name in record.specialData)){fieldNames.push(name);return;}}
if((fieldType==='one2many'||fieldType==='many2many')){if(!('fieldsInfo'in record.data[name])){fieldNames.push(name);}else{var x2mFieldInfo=record.fieldsInfo[this.viewType][name];var viewType=x2mFieldInfo.viewType||x2mFieldInfo.mode;var knownFields=Object.keys(record.data[name].fieldsInfo[record.data[name].viewType]||{});var newFields=Object.keys(record.data[name].fieldsInfo[viewType]||{});if(_.difference(newFields,knownFields).length){fieldNames.push(name);}
if(record.data[name].viewType==='default'){var fieldViews=fieldInfo.views||fieldInfo.fieldsInfo||{};var defaultFieldInfo=record.data[name].fieldsInfo.default;_.each(fieldViews,function(fieldView){_.each(fieldView.fieldsInfo,function(x2mFieldInfo){_.defaults(x2mFieldInfo,defaultFieldInfo);});});}}}
if(fieldType==='many2one'){if(JSON.stringify(record.data[name].context)!==JSON.stringify(fieldInfo.context)){fieldNames.push(name);}}}});var def;if(fieldNames.length){if(model.isNew(record.id)){def=model.generateDefaultValues(record.id,{fieldNames:fieldNames,viewType:viewType,});}else{def=model.reload(record.id,{fieldNames:fieldNames,keepChanges:true,viewType:viewType,});}}
return Promise.resolve(def).then(function(){const handle=record.id;return{state:model.get(handle),handle};});}
return this._super.apply(this,arguments);},_processArch:function(arch,fv){var self=this;utils.traverse(arch,function(node){return self._processNode(node,fv);});},_processField:function(viewType,field,attrs){var self=this;attrs.Widget=this._getFieldWidgetClass(viewType,field,attrs);_.each(attrs,function(value,key){if(key.startsWith('decoration-')){attrs.decorations=attrs.decorations||[];attrs.decorations.push({name:key,expression:pyUtils._getPyJSAST(value),});}});if(!_.isObject(attrs.options)){attrs.options=attrs.options?pyUtils.py_eval(attrs.options):{};}
if(attrs.on_change&&attrs.on_change!=="0"&&!field.onChange){field.onChange="1";}
if(attrs.modifiers.invisible===true||attrs.modifiers.column_invisible===true){attrs.__no_fetch=true;}
if(!_.isEmpty(field.views)){attrs.views={};_.each(field.views,function(innerFieldsView,viewType){viewType=viewType==='tree'?'list':viewType;attrs.views[viewType]=self._processFieldsView(innerFieldsView,viewType);});}
attrs.views=attrs.views||{};attrs.mode=attrs.mode==='tree'?'list':attrs.mode;if(!attrs.views.list&&attrs.views.tree){attrs.views.list=attrs.views.tree;}
if(field.type==='one2many'||field.type==='many2many'){if(attrs.Widget.prototype.useSubview){var mode=attrs.mode;if(!mode){if(attrs.views.list&&!attrs.views.kanban){mode='list';}else if(!attrs.views.list&&attrs.views.kanban){mode='kanban';}else{mode='list,kanban';}}
if(mode.indexOf(',')!==-1){mode=config.device.isMobile?'kanban':'list';}
attrs.mode=mode;if(mode in attrs.views){var view=attrs.views[mode];this._processSubViewAttrs(view,attrs);}}
if(attrs.Widget.prototype.fieldsToFetch){attrs.viewType='default';attrs.relatedFields=_.extend({},attrs.Widget.prototype.fieldsToFetch);attrs.fieldsInfo={default:_.mapObject(attrs.Widget.prototype.fieldsToFetch,function(){return{};}),};if(attrs.options.color_field){attrs.relatedFields[attrs.options.color_field]={type:'integer'};attrs.fieldsInfo.default[attrs.options.color_field]={};}}}
if(attrs.Widget.prototype.fieldDependencies){attrs.fieldDependencies=attrs.Widget.prototype.fieldDependencies;}
return attrs;},_processFieldsView:function(fieldsView,viewType){var fv=this._super.apply(this,arguments);viewType=viewType||this.viewType;fv.type=viewType;fv.fieldsInfo=Object.create(null);fv.fieldsInfo[viewType]=Object.create(null);this._processArch(fv.arch,fv);return fv;},_processNode:function(node,fv){if(typeof node==='string'){return false;}
if(!_.isObject(node.attrs.modifiers)){node.attrs.modifiers=node.attrs.modifiers?JSON.parse(node.attrs.modifiers):{};}
if(!_.isObject(node.attrs.options)&&node.tag==='button'){node.attrs.options=node.attrs.options?JSON.parse(node.attrs.options):{};}
if(node.tag==='field'){var viewType=fv.type;var fieldsInfo=fv.fieldsInfo[viewType];var fields=fv.viewFields;fieldsInfo[node.attrs.name]=this._processField(viewType,fields[node.attrs.name],node.attrs?_.clone(node.attrs):{});if(fieldsInfo[node.attrs.name].fieldDependencies){var deps=fieldsInfo[node.attrs.name].fieldDependencies;for(var dependency_name in deps){var dependency_dict={name:dependency_name,type:deps[dependency_name].type};if(!(dependency_name in fieldsInfo)){fieldsInfo[dependency_name]=_.extend({},dependency_dict,{options:deps[dependency_name].options||{},});}
if(!(dependency_name in fields)){fields[dependency_name]=dependency_dict;}
if(fv.fields&&!(dependency_name in fv.fields)){fv.fields[dependency_name]=dependency_dict;}}}
return false;}
return node.tag!=='arch';},_processSubViewAttrs:function(view,attrs){var defaultOrder=view.arch.attrs.default_order;if(defaultOrder){attrs.orderedBy=_.map(defaultOrder.split(','),function(order){order=order.trim().split(' ');return{name:order[0],asc:order[1]!=='desc'};});}else{var handleField=_.find(view.arch.children,function(child){return child.attrs&&child.attrs.widget==='handle';});if(handleField){attrs.orderedBy=[{name:handleField.attrs.name,asc:true}];}}
attrs.columnInvisibleFields={};_.each(view.arch.children,function(child){if(child.attrs&&child.attrs.modifiers){attrs.columnInvisibleFields[child.attrs.name]=child.attrs.modifiers.column_invisible||false;}});},});return BasicView;});;

/* /web/static/src/js/views/basic/basic_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.BasicController',function(require){"use strict";var AbstractController=require('web.AbstractController');var core=require('web.core');var Dialog=require('web.Dialog');var FieldManagerMixin=require('web.FieldManagerMixin');var TranslationDialog=require('web.TranslationDialog');var _t=core._t;var BasicController=AbstractController.extend(FieldManagerMixin,{events:Object.assign({},AbstractController.prototype.events,{'click .o_content':'_onContentClicked',}),custom_events:_.extend({},AbstractController.prototype.custom_events,FieldManagerMixin.custom_events,{discard_changes:'_onDiscardChanges',pager_changed:'_onPagerChanged',reload:'_onReload',resequence_records:'_onResequenceRecords',set_dirty:'_onSetDirty',load_optional_fields:'_onLoadOptionalFields',save_optional_fields:'_onSaveOptionalFields',translate:'_onTranslate',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.archiveEnabled=params.archiveEnabled;this.confirmOnDelete=params.confirmOnDelete;this.hasButtons=params.hasButtons;FieldManagerMixin.init.call(this,this.model);this.mode=params.mode||'readonly';this.savingDef=Promise.resolve();this.discardingDef=null;this.viewId=params.viewId;},start:async function(){this.$el.toggleClass('o_cannot_create',!this.activeActions.create);await this._super(...arguments);},on_detach_callback(){this._super.apply(this,arguments);this.renderer.resetLocalState();},canBeDiscarded:function(recordID){var self=this;if(this.discardingDef){return this.discardingDef;}
if(!this.isDirty(recordID)){return Promise.resolve(false);}
var message=_t("The record has been modified, your changes will be discarded. Do you want to proceed?");this.discardingDef=new Promise(function(resolve,reject){var dialog=Dialog.confirm(self,message,{title:_t("Warning"),confirm_callback:()=>{resolve(true);self.discardingDef=null;},cancel_callback:()=>{reject();self.discardingDef=null;},});dialog.on('closed',self.discardingDef,reject);});return this.discardingDef;},canBeSaved:function(recordID){var fieldNames=this.renderer.canBeSaved(recordID||this.handle);if(fieldNames.length){this._notifyInvalidFields(fieldNames);return false;}
return true;},discardChanges:function(recordID,options){return Promise.all([this.mutex.getUnlockedDef(),this.savingDef]).then(this._discardChanges.bind(this,recordID||this.handle,options));},getSelectedIds:function(){return[];},isDirty:function(recordID){return this.model.isDirty(recordID||this.handle);},saveRecord:function(recordID,options){var self=this;var unlockedMutex=this.mutex.getUnlockedDef().then(function(){return self.renderer.commitChanges(recordID||self.handle);}).then(function(){return self.mutex.exec(self._saveRecord.bind(self,recordID,options));});this.savingDef=new Promise(function(resolve){unlockedMutex.then(resolve).guardedCatch(resolve);});return unlockedMutex;},update:async function(params,options){this.mode=params.mode||this.mode;return this._super(params,options);},reload:function(params){if(params&&params.controllerState){if(params.controllerState.currentId){params.currentId=params.controllerState.currentId;}
params.ids=params.controllerState.resIds;}
return this._super.apply(this,arguments);},_abandonRecord:function(recordID){recordID=recordID||this.handle;if(recordID===this.handle){this.trigger_up('history_back');}else{this.model.removeLine(recordID);}},_applyChanges:function(dataPointID,changes,event){var _super=FieldManagerMixin._applyChanges.bind(this);return this.mutex.exec(function(){return _super(dataPointID,changes,event);});},_archive:async function(ids,archive){if(ids.length===0){return Promise.resolve();}
if(archive){await this.model.actionArchive(ids,this.handle);}else{await this.model.actionUnarchive(ids,this.handle);}
return this.update({},{reload:false});},_callButtonAction:function(attrs,record){record=record||this.model.get(this.handle);const actionData=Object.assign({},attrs,{context:record.getContext({additionalContext:attrs.context||{}})});const recordData={context:record.getContext(),currentID:record.data.id,model:record.model,resIDs:record.res_ids,};return this._executeButtonAction(actionData,recordData);},_confirmChange:function(id,fields,e){if(e.name==='discard_changes'&&e.target.reset){return e.target.reset(this.model.get(e.target.dataPointID),e,true);}
var state=this.model.get(this.handle);return this.renderer.confirmChange(state,id,fields,e);},_confirmSaveNewRecord:function(){var self=this;var def=new Promise(function(resolve,reject){var message=_t("You need to save this new record before editing the translation. Do you want to proceed?");var dialog=Dialog.confirm(self,message,{title:_t("Warning"),confirm_callback:resolve.bind(self,true),cancel_callback:reject,});dialog.on('closed',self,reject);});return def;},_deleteRecords:function(ids){var self=this;function doIt(){return self.model.deleteRecords(ids,self.modelName).then(self._onDeletedRecords.bind(self,ids));}
if(this.confirmOnDelete){const message=ids.length>1?_t("Are you sure you want to delete these records?"):_t("Are you sure you want to delete this record?");Dialog.confirm(this,message,{confirm_callback:doIt});}else{doIt();}},_disableButtons:function(){if(this.$buttons){this.$buttons.find('button').attr('disabled',true);}},_discardChanges:function(recordID,options){var self=this;recordID=recordID||this.handle;options=options||{};return this.canBeDiscarded(recordID).then(function(needDiscard){if(options.readonlyIfRealDiscard&&!needDiscard){return;}
self.model.discardChanges(recordID);if(options.noAbandon){return;}
if(self.model.canBeAbandoned(recordID)){self._abandonRecord(recordID);return;}
return self._confirmSave(recordID);});},_enableButtons:function(){if(this.$buttons){this.$buttons.find('button').removeAttr('disabled');}},async _executeButtonAction(actionData,recordData){const prom=new Promise((resolve,reject)=>{this.trigger_up('execute_action',{action_data:actionData,env:recordData,on_closed:()=>this.isDestroyed()?Promise.resolve():this.reload(),on_success:resolve,on_fail:()=>this.update({},{reload:false}).then(reject).guardedCatch(reject)});});return this.alive(prom);},exportState:function(){var state=this._super.apply(this,arguments);var env=this.model.get(this.handle,{env:true});return _.extend(state,{currentId:env.currentId,resIds:env.ids,});},_getOptionalFieldsLocalStorageKey:function(keyParts){keyParts.model=this.modelName;keyParts.viewType=this.viewType;keyParts.viewId=this.viewId;var parts=['model','viewType','viewId','relationalField','subViewType','subViewId',];var viewIdentifier=parts.reduce(function(identifier,partName){if(partName in keyParts){return identifier+','+keyParts[partName];}
return identifier;},'optional_fields');viewIdentifier=keyParts.fields.sort(this._nameSortComparer).reduce(function(identifier,field){return identifier+','+field.name;},viewIdentifier);return viewIdentifier;},_getPagingInfo:function(state){const isGrouped=state.groupedBy&&state.groupedBy.length;return{currentMinimum:(isGrouped?state.groupsOffset:state.offset)+1,limit:isGrouped?state.groupsLimit:state.limit,size:isGrouped?state.groupsCount:state.count,};},_getActionMenuItems:function(state){return{activeIds:this.getSelectedIds(),context:state.getContext(),};},_nameSortComparer:function(left,right){return left.name<right.name?-1:1;},_notifyInvalidFields:function(invalidFields){var record=this.model.get(this.handle,{raw:true});var fields=record.fields;var warnings=invalidFields.map(function(fieldName){var fieldStr=fields[fieldName].string;return _.str.sprintf('<li>%s</li>',_.escape(fieldStr));});warnings.unshift('<ul>');warnings.push('</ul>');this.do_warn(_t("Invalid fields:"),warnings.join(''));},_onDeletedRecords:function(ids){this.update({});},_saveRecord:function(recordID,options){recordID=recordID||this.handle;options=_.defaults(options||{},{stayInEdit:false,reload:true,savePoint:false,});if(this.canBeSaved(recordID)){var self=this;var saveDef=this.model.save(recordID,{reload:options.reload,savePoint:options.savePoint,viewType:options.viewType,});if(!options.stayInEdit){saveDef=saveDef.then(function(fieldNames){var def=fieldNames.length?self._confirmSave(recordID):self._setMode('readonly',recordID);return def.then(function(){return fieldNames;});});}
return saveDef;}else{return Promise.reject("SaveRecord: this.canBeSave is false");}},_setMode:function(mode,recordID){if((recordID||this.handle)===this.handle){return this.update({mode:mode},{reload:false}).then(function(){core.bus.trigger('DOM_updated');});}
return Promise.resolve();},_shouldBounceOnClick:function(){return false;},_updateControlPanel:function(newProps={}){const state=this.model.get(this.handle);const props=Object.assign(newProps,{actionMenus:this._getActionMenuItems(state),pager:this._getPagingInfo(state),title:this.getTitle(),});return this.updateControlPanel(props);},_onContentClicked(ev){if(this.$buttons&&this._shouldBounceOnClick(ev.target)){this.$buttons.find('.btn-primary:visible:first').odooBounce();}},_onDiscardChanges:function(ev){var self=this;ev.stopPropagation();var recordID=ev.data.recordID;this._discardChanges(recordID).then(function(){self._confirmChange(recordID,[ev.data.fieldName],ev).then(ev.data.onSuccess).guardedCatch(ev.data.onSuccess);}).guardedCatch(ev.data.onFailure);},_onFieldChanged:function(ev){if(this.mode==='readonly'&&!('force_save'in ev.data)){ev.data.force_save=true;}
FieldManagerMixin._onFieldChanged.apply(this,arguments);},_onPagerChanged:async function(ev){ev.stopPropagation();const{currentMinimum,limit}=ev.data;const state=this.model.get(this.handle,{raw:true});const reloadParams=state.groupedBy&&state.groupedBy.length?{groupsLimit:limit,groupsOffset:currentMinimum-1,}:{limit,offset:currentMinimum-1,};await this.reload(reloadParams);if(state.limit===limit){this.trigger_up('scrollTo',{top:0});}},_onReload:function(ev){ev.stopPropagation();var data=ev&&ev.data||{};var handle=data.db_id;var prom;if(handle){prom=this.model.reload(handle).then(this._confirmSave.bind(this,handle));}else{prom=this.reload({fieldNames:data.fieldNames,keepChanges:data.keepChanges||false,});}
prom.then(ev.data.onSuccess).guardedCatch(ev.data.onFailure);},_onResequenceRecords:function(ev){ev.stopPropagation();this.trigger_up('mutexify',{action:async()=>{let state=this.model.get(this.handle);const resIDs=ev.data.recordIds.map(recordID=>state.data.find(d=>d.id===recordID).res_id);const options={offset:ev.data.offset,field:ev.data.handleField,};await this.model.resequence(this.modelName,resIDs,this.handle,options);this._updateControlPanel();state=this.model.get(this.handle);return this._updateRendererState(state,{noRender:true});},});},_onLoadOptionalFields:function(ev){var res=this.call('local_storage','getItem',this._getOptionalFieldsLocalStorageKey(ev.data.keyParts));ev.data.callback(res);},_onSaveOptionalFields:function(ev){this.call('local_storage','setItem',this._getOptionalFieldsLocalStorageKey(ev.data.keyParts),ev.data.optionalColumnsEnabled);},_onSetDirty:function(ev){ev.stopPropagation();this.model.setDirty(ev.data.dataPointID);},_onTranslate:async function(ev){ev.stopPropagation();if(this.model.isNew(ev.data.id)){await this._confirmSaveNewRecord();var updatedFields=await this.saveRecord(ev.data.id,{stayInEdit:true});await this._confirmChange(ev.data.id,updatedFields,ev);}
var record=this.model.get(ev.data.id,{raw:true});var res_id=record.res_id||record.res_ids[0];var result=await this._rpc({route:'/web/dataset/call_button',params:{model:'ir.translation',method:'translate_fields',args:[record.model,res_id,ev.data.fieldName],kwargs:{context:record.getContext()},}});this.translationDialog=new TranslationDialog(this,{domain:result.domain,searchName:result.context.search_default_name,fieldName:ev.data.fieldName,userLanguageValue:ev.target.value||'',dataPointID:record.id,isComingFromTranslationAlert:ev.data.isComingFromTranslationAlert,isText:result.context.translation_type==='text',showSrc:result.context.translation_show_src,});return this.translationDialog.open();},});return BasicController;});;

/* /web/static/src/js/views/basic/basic_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.BasicRenderer',function(require){"use strict";var AbstractRenderer=require('web.AbstractRenderer');var config=require('web.config');var core=require('web.core');var dom=require('web.dom');const session=require('web.session');const utils=require('web.utils');var widgetRegistry=require('web.widget_registry');const{WidgetAdapterMixin}=require('web.OwlCompatibility');const FieldWrapper=require('web.FieldWrapper');var qweb=core.qweb;const _t=core._t;var BasicRenderer=AbstractRenderer.extend(WidgetAdapterMixin,{custom_events:{navigation_move:'_onNavigationMove',},init:function(parent,state,params){this._super.apply(this,arguments);this.activeActions=params.activeActions;this.viewType=params.viewType;this.mode=params.mode||'readonly';this.widgets=[];this.handleField=null;},destroy:function(){this._super.apply(this,arguments);WidgetAdapterMixin.destroy.call(this);},on_attach_callback:function(){this._isInDom=true;for(const handle in this.allFieldWidgets){this.allFieldWidgets[handle].forEach(widget=>{if(!utils.isComponent(widget.constructor)&&widget.on_attach_callback){widget.on_attach_callback();}});}
this.widgets.forEach(widget=>{if(widget.on_attach_callback){widget.on_attach_callback();}});WidgetAdapterMixin.on_attach_callback.call(this);},on_detach_callback:function(){this._isInDom=false;for(const handle in this.allFieldWidgets){this.allFieldWidgets[handle].forEach(widget=>{if(!utils.isComponent(widget.constructor)&&widget.on_detach_callback){widget.on_detach_callback();}});}
this.widgets.forEach(widget=>{if(widget.on_detach_callback){widget.on_detach_callback();}});WidgetAdapterMixin.on_detach_callback.call(this);},canBeSaved:function(recordID){var self=this;var invalidFields=[];_.each(this.allFieldWidgets[recordID],function(widget){var canBeSaved=self._canWidgetBeSaved(widget);if(!canBeSaved){invalidFields.push(widget.name);}
if(widget.el){widget.$el.toggleClass('o_field_invalid',!canBeSaved);widget.$el.attr('aria-invalid',!canBeSaved);}});return invalidFields;},commitChanges:function(recordID){var defs=_.map(this.allFieldWidgets[recordID],function(widget){return widget.commitChanges();});return Promise.all(defs);},confirmChange:function(state,id,fields,ev){var self=this;this._setState(state);var record=this._getRecord(id);if(!record){return this._render().then(_.constant([]));}
_.invoke(this.widgets,'updateState',state);var defs=[];_.each(this.allFieldWidgets[id],function(widget){var fieldChanged=_.contains(fields,widget.name);if(fieldChanged||widget.resetOnAnyFieldChange){defs.push(widget.reset(record,ev,fieldChanged));}});defs.push(this._updateAllModifiers(record));return Promise.all(defs).then(function(){return _.filter(self.allFieldWidgets[id],function(widget){var fieldChanged=_.contains(fields,widget.name);return fieldChanged||widget.resetOnAnyFieldChange;});});},focusField:function(id,fieldName,offset){this.editRecord(id);if(typeof offset==="number"){var field=_.findWhere(this.allFieldWidgets[id],{name:fieldName});dom.setSelectionRange(field.getFocusableElement().get(0),{start:offset,end:offset});}},_activateFieldWidget:function(record,currentIndex,options){options=options||{};_.defaults(options,{inc:1,wrap:false});currentIndex=Math.max(0,currentIndex);var recordWidgets=this.allFieldWidgets[record.id]||[];for(var i=0;i<recordWidgets.length;i++){var activated=recordWidgets[currentIndex].activate({event:options.event,noAutomaticCreate:options.noAutomaticCreate||false});if(activated){return currentIndex;}
currentIndex+=options.inc;if(currentIndex>=recordWidgets.length){if(options.wrap){currentIndex-=recordWidgets.length;}else{return-1;}}else if(currentIndex<0){if(options.wrap){currentIndex+=recordWidgets.length;}else{return-1;}}}
return-1;},_activateNextFieldWidget:function(record,currentIndex,options){currentIndex=(currentIndex+1)%(this.allFieldWidgets[record.id]||[]).length;return this._activateFieldWidget(record,currentIndex,_.extend({inc:1},options));},_activatePreviousFieldWidget:function(record,currentIndex){currentIndex=currentIndex?(currentIndex-1):((this.allFieldWidgets[record.id]||[]).length-1);return this._activateFieldWidget(record,currentIndex,{inc:-1});},_addFieldTooltip:function(widget,$node){$node=$node.length?$node:widget.$el;$node.tooltip(this._getTooltipOptions(widget));},_applyModifiers:function(modifiersData,record,element){var self=this;var modifiers=modifiersData.evaluatedModifiers[record.id]||{};if(element){_apply(element);}else{_.each(_.clone(modifiersData.elementsByRecord[record.id]),_apply);}
function _apply(element){if('readonly'in modifiers&&element.widget){var mode=modifiers.readonly?'readonly':modifiersData.baseModeByRecord[record.id];if(mode!==element.widget.mode){self._rerenderFieldWidget(element.widget,record,{keepBaseMode:true,mode:mode,});return;}}
element.$el.toggleClass("o_invisible_modifier",!!modifiers.invisible);element.$el.toggleClass("o_readonly_modifier",!!modifiers.readonly);element.$el.toggleClass("o_required_modifier",!!modifiers.required);if(element.widget&&element.widget.updateModifiersValue){element.widget.updateModifiersValue(modifiers);}
if(element.callback){element.callback(element,modifiers,record);}}},_canWidgetBeSaved:function(widget){var modifiers=this._getEvaluatedModifiers(widget.__node,widget.record);return widget.isValid()&&(widget.isSet()||!modifiers.required);},_destroyFieldWidget:function(recordID,widget){var recordWidgets=this.allFieldWidgets[recordID];var index=recordWidgets.indexOf(widget);if(index>=0){recordWidgets.splice(index,1);}
this._unregisterModifiersElement(widget.__node,recordID,widget);widget.destroy();return index;},_getEvaluatedModifiers:function(node,record){var element=this._getModifiersData(node);if(!element){return{};}
return element.evaluatedModifiers[record.id]||{};},_getModifiersData:function(node){return _.findWhere(this.allModifiersData,{node:node});},_getRecord:function(recordId){return null;},_getTooltipOptions:function(widget){return{title:function(){let help=widget.attrs.help||widget.field.help||'';if(session.display_switch_company_menu&&widget.field.company_dependent){help+=(help?'\n\n':'')+_t('Values set here are company-specific.');}
const debug=config.isDebug();if(help||debug){return qweb.render('WidgetLabel.tooltip',{debug,help,widget});}}};},_handleAttributes:function($el,node){if($el.is('button')){return;}
if(node.attrs.class){$el.addClass(node.attrs.class);}
if(node.attrs.style){$el.attr('style',node.attrs.style);}
if(node.attrs.placeholder){$el.attr('placeholder',node.attrs.placeholder);}},_hasContent:function(){return this.state.count!==0&&(!('isSample'in this.state)||!this.state.isSample);},_moveRecord:function(recordId,toIndex){var self=this;var records=this.state.data;var record=_.findWhere(records,{id:recordId});var fromIndex=records.indexOf(record);var lowerIndex=Math.min(fromIndex,toIndex);var upperIndex=Math.max(fromIndex,toIndex)+1;var order=_.findWhere(this.state.orderedBy,{name:this.handleField});var asc=!order||order.asc;var reorderAll=false;var sequence=(asc?-1:1)*Infinity;_.each(records,function(record,index){if(((index<lowerIndex||index>=upperIndex)&&((asc&&sequence>=record.data[self.handleField])||(!asc&&sequence<=record.data[self.handleField])))||(index>=lowerIndex&&index<upperIndex&&sequence===record.data[self.handleField])){reorderAll=true;}
sequence=record.data[self.handleField];});if(reorderAll){records=_.without(records,record);records.splice(toIndex,0,record);}else{records=records.slice(lowerIndex,upperIndex);records=_.without(records,record);if(fromIndex>toIndex){records.unshift(record);}else{records.push(record);}}
var sequences=_.pluck(_.pluck(records,'data'),this.handleField);var recordIds=_.pluck(records,'id');if(!asc){recordIds.reverse();}
this.trigger_up('resequence_records',{handleField:this.handleField,offset:_.min(sequences),recordIds:recordIds,});},_postProcessField:function(widget,node){this._handleAttributes(widget.$el,node);},_registerModifiers:function(node,record,element,options){options=options||{};var modifiersData=this._getModifiersData(node);if(!modifiersData){var modifiers=node.attrs.modifiers||{};modifiersData={node:node,modifiers:modifiers,evaluatedModifiers:{},elementsByRecord:{},baseModeByRecord:{},};if(!_.isEmpty(modifiers)){this.allModifiersData.push(modifiersData);}}
if(!modifiersData.baseModeByRecord[record.id]||!options.keepBaseMode){modifiersData.baseModeByRecord[record.id]=options.mode||this.mode;}
if(!modifiersData.evaluatedModifiers[record.id]){try{modifiersData.evaluatedModifiers[record.id]=record.evalModifiers(modifiersData.modifiers);}catch(e){throw new Error(_.str.sprintf("While parsing modifiers for %s%s: %s",node.tag,node.tag==='field'?' '+node.attrs.name:'',e.message));}}
if(element){var newElement={};if(element instanceof jQuery){newElement.$el=element;}else{newElement.widget=element;newElement.$el=element.$el;}
if(options&&options.callback){newElement.callback=options.callback;}
if(!modifiersData.elementsByRecord[record.id]){modifiersData.elementsByRecord[record.id]=[];}
modifiersData.elementsByRecord[record.id].push(newElement);this._applyModifiers(modifiersData,record,newElement);}
return modifiersData.evaluatedModifiers[record.id];},async _render(){const oldAllFieldWidgets=this.allFieldWidgets;this.allFieldWidgets={};this.allModifiersData=[];const oldWidgets=this.widgets;this.widgets=[];await this._super(...arguments);for(const id in oldAllFieldWidgets){for(const widget of oldAllFieldWidgets[id]){widget.destroy();}}
for(const widget of oldWidgets){widget.destroy();}
if(this._isInDom){for(const handle in this.allFieldWidgets){this.allFieldWidgets[handle].forEach(widget=>{if(!utils.isComponent(widget.constructor)&&widget.on_attach_callback){widget.on_attach_callback();}});}
this.widgets.forEach(widget=>{if(widget.on_attach_callback){widget.on_attach_callback();}});WidgetAdapterMixin.on_attach_callback.call(this);}},_renderFieldWidget:function(node,record,options){options=options||{};var fieldName=node.attrs.name;var mode=options.mode||this.mode;var modifiers=this._registerModifiers(node,record,null,options);var Widget=record.fieldsInfo[this.viewType][fieldName].Widget;const legacy=!(Widget.prototype instanceof owl.Component);const widgetOptions={mode:modifiers.readonly?'readonly':mode,viewType:this.viewType,};let widget;if(legacy){widget=new Widget(this,fieldName,record,widgetOptions);}else{widget=new FieldWrapper(this,Widget,{fieldName,record,options:widgetOptions,});}
if(this.allFieldWidgets[record.id]===undefined){this.allFieldWidgets[record.id]=[];}
this.allFieldWidgets[record.id].push(widget);widget.__node=node;var $el=$('<div>');let def;if(legacy){def=widget._widgetRenderAndInsert(function(){});}else{def=widget.mount(document.createDocumentFragment());}
this.defs.push(def);var self=this;def.then(function(){widget.$el.addClass($el.attr('class'));$el.replaceWith(widget.$el);self._registerModifiers(node,record,widget,{callback:function(element,modifiers,record){element.$el.toggleClass('o_field_empty',!!(record.data.id&&(modifiers.readonly||mode==='readonly')&&element.widget.isEmpty()));},keepBaseMode:!!options.keepBaseMode,mode:mode,});self._postProcessField(widget,node);});return $el;},_renderWidget:function(record,node){var Widget=widgetRegistry.get(node.attrs.name);var widget=new Widget(this,record,node);this.widgets.push(widget);var def=widget._widgetRenderAndInsert(function(){});this.defs.push(def);var $el=$('<div>');var self=this;def.then(function(){self._handleAttributes(widget.$el,node);self._registerModifiers(node,record,widget);widget.$el.addClass('o_widget');$el.replaceWith(widget.$el);});return $el;},_rerenderFieldWidget:function(widget,record,options){var $el=this._renderFieldWidget(widget.__node,record,options);const recordWidgets=this.allFieldWidgets[record.id];const newWidget=recordWidgets[recordWidgets.length-1];const def=this.defs[this.defs.length-1];const $div=$('<div>');$div.append($el);def.then(()=>{widget.$el.replaceWith($div.children());recordWidgets.splice(recordWidgets.indexOf(newWidget),1);var oldIndex=this._destroyFieldWidget(record.id,widget);recordWidgets.splice(oldIndex,0,newWidget);if(this._isInDom&&newWidget.on_attach_callback){newWidget.on_attach_callback();}});},_unregisterModifiersElement:function(node,recordID,element){var modifiersData=this._getModifiersData(node);if(modifiersData){var elements=modifiersData.elementsByRecord[recordID];var index=_.findIndex(elements,function(oldElement){return oldElement.widget===element||oldElement.$el[0]===element[0];});if(index>=0){elements.splice(index,1);}}},_updateAllModifiers:function(record){var self=this;var defs=[];this.defs=defs;_.each(this.allModifiersData,function(modifiersData){if(record.id in modifiersData.evaluatedModifiers){modifiersData.evaluatedModifiers[record.id]=record.evalModifiers(modifiersData.modifiers);self._applyModifiers(modifiersData,record);}});delete this.defs;return Promise.all(defs);},_onNavigationMove:function(ev){},});return BasicRenderer;});;

/* /web/static/src/js/control_panel/comparison_menu.js defined in bundle 'web.assets_backend' */
odoo.define("web.ComparisonMenu",function(require){"use strict";const DropdownMenu=require("web.DropdownMenu");const{FACET_ICONS}=require("web.searchUtils");const{useModel}=require("web/static/src/js/model.js");class ComparisonMenu extends DropdownMenu{constructor(){super(...arguments);this.model=useModel('searchModel');}
get icon(){return FACET_ICONS.comparison;}
get items(){return this.model.get('filters',f=>f.type==='comparison');}
get title(){return this.env._t("Comparison");}
_onItemSelected(ev){ev.stopPropagation();const{item}=ev.detail;this.model.dispatch("toggleComparison",item.id);}}
return ComparisonMenu;});;

/* /web/static/src/js/control_panel/control_panel.js defined in bundle 'web.assets_backend' */
odoo.define('web.ControlPanel',function(require){"use strict";const ActionMenus=require('web.ActionMenus');const ComparisonMenu=require('web.ComparisonMenu');const ActionModel=require('web/static/src/js/views/action_model.js');const FavoriteMenu=require('web.FavoriteMenu');const FilterMenu=require('web.FilterMenu');const GroupByMenu=require('web.GroupByMenu');const patchMixin=require('web.patchMixin');const Pager=require('web.Pager');const SearchBar=require('web.SearchBar');const{useModel}=require('web/static/src/js/model.js');const{Component,hooks}=owl;const{useRef,useSubEnv}=hooks;function getAdditionalContent(props){const additionalContent={};if('cp_content'in props){const content=props.cp_content||{};if('$buttons'in content){additionalContent.buttons=content.$buttons;}
if('$searchview'in content){additionalContent.searchView=content.$searchview;}
if('$pager'in content){additionalContent.pager=content.$pager;}
if('$searchview_buttons'in content){additionalContent.searchViewButtons=content.$searchview_buttons;}}
return additionalContent;}
class ControlPanel extends Component{constructor(){super(...arguments);this.additionalContent=getAdditionalContent(this.props);useSubEnv({action:this.props.action,searchModel:this.props.searchModel,view:this.props.view,});if(this.env.searchModel){this.model=useModel('searchModel');}
this.contentRefs={buttons:useRef('buttons'),pager:useRef('pager'),searchView:useRef('searchView'),searchViewButtons:useRef('searchViewButtons'),};this.fields=this._formatFields(this.props.fields);this.sprintf=_.str.sprintf;}
mounted(){this._attachAdditionalContent();}
patched(){this._attachAdditionalContent();}
async willUpdateProps(nextProps){if('view'in nextProps){this.env.view=nextProps.view;}
if('fields'in nextProps){this.fields=this._formatFields(nextProps.fields);}
this.additionalContent=getAdditionalContent(nextProps);}
_attachAdditionalContent(){for(const key in this.additionalContent){if(this.additionalContent[key]&&this.additionalContent[key].length){const target=this.contentRefs[key].el;if(target){target.innerHTML="";target.append(...this.additionalContent[key]);}}}}
_formatFields(fields){const formattedFields={};for(const fieldName in fields){formattedFields[fieldName]=Object.assign({description:fields[fieldName].string,name:fieldName,},fields[fieldName]);}
return formattedFields;}}
ControlPanel.modelExtension="ControlPanel";ControlPanel.components={SearchBar,ActionMenus,Pager,ComparisonMenu,FilterMenu,GroupByMenu,FavoriteMenu,};ControlPanel.defaultProps={breadcrumbs:[],fields:{},searchMenuTypes:[],views:[],withBreadcrumbs:true,withSearchBar:true,};ControlPanel.props={action:Object,breadcrumbs:Array,searchModel:ActionModel,cp_content:{type:Object,optional:1},fields:Object,pager:{validate:p=>typeof p==='object'||p===null,optional:1},searchMenuTypes:Array,actionMenus:{validate:s=>typeof s==='object'||s===null,optional:1},title:{type:String,optional:1},view:{type:Object,optional:1},views:Array,withBreadcrumbs:Boolean,withSearchBar:Boolean,};ControlPanel.template='web.ControlPanel';return patchMixin(ControlPanel);});;

/* /web/static/src/js/control_panel/control_panel_model_extension.js defined in bundle 'web.assets_backend' */
odoo.define("web/static/src/js/control_panel/control_panel_model_extension.js",function(require){"use strict";const ActionModel=require("web/static/src/js/views/action_model.js");const Domain=require('web.Domain');const pyUtils=require('web.py_utils');const{DEFAULT_INTERVAL,DEFAULT_PERIOD,getComparisonOptions,getIntervalOptions,getPeriodOptions,constructDateDomain,rankInterval,yearSelected}=require('web.searchUtils');const FAVORITE_PRIVATE_GROUP=1;const FAVORITE_SHARED_GROUP=2;const DISABLE_FAVORITE="search_disable_custom_filters";let filterId=1;let groupId=1;let groupNumber=0;class ControlPanelModelExtension extends ActionModel.Extension{constructor(){super(...arguments);this.actionContext=Object.assign({},this.config.context);this.searchMenuTypes=this.config.searchMenuTypes||[];this.favoriteFilters=this.config.favoriteFilters||[];this.fields=this.config.fields||{};this.searchDefaults={};for(const key in this.actionContext){const match=/^search_default_(.*)$/.exec(key);if(match){const val=this.actionContext[key];if(val){this.searchDefaults[match[1]]=val;}
delete this.actionContext[key];}}
this.labelPromises=[];this.referenceMoment=moment();this.optionGenerators=getPeriodOptions(this.referenceMoment);this.intervalOptions=getIntervalOptions();this.comparisonOptions=getComparisonOptions();}
get(property,...args){switch(property){case"context":return this.getContext();case"domain":return this.getDomain();case"facets":return this._getFacets();case"filters":return this._getFilters(...args);case"groupBy":return this.getGroupBy();case"orderedBy":return this.getOrderedBy();case"timeRanges":return this.getTimeRanges();}}
async load(){await Promise.all(this.labelPromises);}
prepareState(){Object.assign(this.state,{filters:{},query:[],});if(this.config.withSearchBar!==false){this._addFilters();this._activateDefaultFilters();}}
get activeComparison(){return this.state.query.find(queryElem=>queryElem.type==='comparison');}
addAutoCompletionValues({filterId,label,value,operator}){const queryElem=this.state.query.find(queryElem=>queryElem.filterId===filterId&&queryElem.value===value&&queryElem.operator===operator);if(!queryElem){const{groupId}=this.state.filters[filterId];this.state.query.push({filterId,groupId,label,value,operator});}else{queryElem.label=label;}}
clearQuery(){this.state.query=[];}
async createNewFavorite(preFilter){const preFavorite=await this._saveQuery(preFilter);this.clearQuery();const filter=Object.assign(preFavorite,{groupId,id:filterId,});this.state.filters[filterId]=filter;this.state.query.push({groupId,filterId});groupId++;filterId++;}
createNewFilters(prefilters){if(!prefilters.length){return[];}
const newFilterIdS=[];prefilters.forEach(preFilter=>{const filter=Object.assign(preFilter,{groupId,groupNumber,id:filterId,type:'filter',});this.state.filters[filterId]=filter;this.state.query.push({groupId,filterId});newFilterIdS.push(filterId);filterId++;});groupId++;groupNumber++;return newFilterIdS;}
createNewGroupBy(field){const groupBy=Object.values(this.state.filters).find(f=>f.type==='groupBy');const filter={description:field.string||field.name,fieldName:field.name,fieldType:field.type,groupId:groupBy?groupBy.groupId:groupId++,groupNumber,id:filterId,type:'groupBy',};this.state.filters[filterId]=filter;if(['date','datetime'].includes(field.type)){filter.hasOptions=true;filter.defaultOptionId=DEFAULT_INTERVAL;this.toggleFilterWithOptions(filterId);}else{this.toggleFilter(filterId);}
groupNumber++;filterId++;}
deactivateGroup(groupId){this.state.query=this.state.query.filter(queryElem=>queryElem.groupId!==groupId);this._checkComparisonStatus();}
async deleteFavorite(filterId){const{serverSideId}=this.state.filters[filterId];await this.env.dataManager.delete_filter(serverSideId);const index=this.state.query.findIndex(queryElem=>queryElem.filterId===filterId);delete this.state.filters[filterId];if(index>=0){this.state.query.splice(index,1);}}
getContext(){const groups=this._getGroups();return this._getContext(groups);}
getDomain(){const groups=this._getGroups();const userContext=this.env.session.user_context;try{return Domain.prototype.stringToArray(this._getDomain(groups),userContext);}catch(err){throw new Error(`${this.env._t("Control panel model extension failed to evaluate domain")}:/n${JSON.stringify(err)}`);}}
getGroupBy(){const groups=this._getGroups();return this._getGroupBy(groups);}
getOrderedBy(){const groups=this._getGroups();return this._getOrderedBy(groups);}
getTimeRanges(){const requireEvaluation=true;return this._getTimeRanges(requireEvaluation);}
search(){}
toggleComparison(filterId){const{groupId,dateFilterId}=this.state.filters[filterId];const queryElem=this.state.query.find(queryElem=>queryElem.type==='comparison'&&queryElem.filterId===filterId);this.state.query=this.state.query.filter(queryElem=>queryElem.type!=='comparison');if(!queryElem){this.state.query.push({groupId,filterId,dateFilterId,type:'comparison',});}}
toggleFilter(filterId){const index=this.state.query.findIndex(queryElem=>queryElem.filterId===filterId);if(index>=0){this.state.query.splice(index,1);}else{const{groupId,type}=this.state.filters[filterId];if(type==='favorite'){this.state.query=[];}
this.state.query.push({groupId,filterId});}}
toggleFilterWithOptions(filterId,optionId){const filter=this.state.filters[filterId];optionId=optionId||filter.defaultOptionId;const option=this.optionGenerators.find(o=>o.id===optionId);const index=this.state.query.findIndex(queryElem=>queryElem.filterId===filterId&&queryElem.optionId===optionId);if(index>=0){this.state.query.splice(index,1);if(filter.type==='filter'&&!yearSelected(this._getSelectedOptionIds(filterId))){this.state.query=this.state.query.filter(queryElem=>queryElem.filterId!==filterId);}}else{this.state.query.push({groupId:filter.groupId,filterId,optionId});if(filter.type==='filter'&&!yearSelected(this._getSelectedOptionIds(filterId))){this.state.query.push({groupId:filter.groupId,filterId,optionId:option.defaultYearId,});}}
if(filter.type==='filter'){this._checkComparisonStatus();}}
_activateDefaultFilters(){if(this.defaultFavoriteId){this.toggleFilter(this.defaultFavoriteId);}else{Object.values(this.state.filters).filter((f)=>f.isDefault&&f.type!=='favorite').sort((f1,f2)=>(f1.defaultRank||100)-(f2.defaultRank||100)).forEach(f=>{if(f.hasOptions){this.toggleFilterWithOptions(f.id);}else if(f.type==='field'){let{operator,label,value}=f.defaultAutocompleteValue;this.addAutoCompletionValues({filterId:f.id,value,operator,label,});}else{this.toggleFilter(f.id);}});}}
_addFilters(){this._createGroupOfFavorites();this._createGroupOfFiltersFromArch();this._createGroupOfDynamicFilters();}
_checkComparisonStatus(){const activeComparison=this.activeComparison;if(!activeComparison){return;}
const{dateFilterId}=activeComparison;const dateFilterIsActive=this.state.query.some(queryElem=>queryElem.filterId===dateFilterId);if(!dateFilterIsActive){this.state.query=this.state.query.filter(queryElem=>queryElem.type!=='comparison');}}
_computeTimeRanges(comparisonFilter){const{filterId}=this.activeComparison;if(filterId!==comparisonFilter.id){return null;}
const{dateFilterId,comparisonOptionId}=comparisonFilter;const{fieldName,fieldType,description:dateFilterDescription,}=this.state.filters[dateFilterId];const selectedOptionIds=this._getSelectedOptionIds(dateFilterId);const{domain:range,description:rangeDescription}=constructDateDomain(this.referenceMoment,fieldName,fieldType,selectedOptionIds,);const{domain:comparisonRange,description:comparisonRangeDescription,}=constructDateDomain(this.referenceMoment,fieldName,fieldType,selectedOptionIds,comparisonOptionId);return{comparisonId:comparisonOptionId,fieldName,fieldDescription:dateFilterDescription,range,rangeDescription,comparisonRange,comparisonRangeDescription,};}
_createGroupOfComparisons(dateFilters){const preFilters=[];for(const dateFilter of dateFilters){for(const comparisonOption of this.comparisonOptions){const{id:dateFilterId,description}=dateFilter;const preFilter={type:'comparison',comparisonOptionId:comparisonOption.id,description:`${description}: ${comparisonOption.description}`,dateFilterId,};preFilters.push(preFilter);}}
this._createGroupOfFilters(preFilters);}
_createGroupOfDynamicFilters(){const dynamicFilters=this.config.dynamicFilters||[];const pregroup=dynamicFilters.map(filter=>{return{description:filter.description,domain:JSON.stringify(filter.domain),isDefault:true,type:'filter',};});this._createGroupOfFilters(pregroup);}
_createGroupOfFavorites(){const activateFavorite=DISABLE_FAVORITE in this.actionContext?!this.actionContext[DISABLE_FAVORITE]:true;this.favoriteFilters.forEach(irFilter=>{const favorite=this._irFilterToFavorite(irFilter);this._createGroupOfFilters([favorite]);if(activateFavorite&&favorite.isDefault){this.defaultFavoriteId=favorite.id;}});}
_createGroupOfFilters(pregroup){pregroup.forEach(preFilter=>{const filter=Object.assign(preFilter,{groupId,id:filterId});this.state.filters[filterId]=filter;if(!this.defaultFavoriteId&&filter.isDefault&&filter.type==='field'){this._prepareDefaultLabel(filter);}
filterId++;});groupId++;}
_createGroupOfFiltersFromArch(){const preFilters=this.config.archNodes.reduce((preFilters,child)=>{if(child.tag==='group'){return[...preFilters,...child.children.map(c=>this._evalArchChild(c))];}else{return[...preFilters,this._evalArchChild(child)];}},[]);preFilters.push({tag:'separator'});let currentTag;let currentGroup=[];let pregroupOfGroupBys=[];preFilters.forEach(preFilter=>{if(preFilter.tag!==currentTag||['separator','field'].includes(preFilter.tag)){if(currentGroup.length){if(currentTag==='groupBy'){pregroupOfGroupBys=[...pregroupOfGroupBys,...currentGroup];}else{this._createGroupOfFilters(currentGroup);}}
currentTag=preFilter.tag;currentGroup=[];groupNumber++;}
if(preFilter.tag!=='separator'){const filter={type:preFilter.tag,};if(preFilter.attrs&&JSON.parse(preFilter.attrs.modifiers||'{}').invisible){filter.invisible=true;let preFilterFieldName=null;if(preFilter.tag==='filter'&&preFilter.attrs.date){preFilterFieldName=preFilter.attrs.date;}else if(preFilter.tag==='groupBy'){preFilterFieldName=preFilter.attrs.fieldName;}
if(preFilterFieldName&&!this.fields[preFilterFieldName]){return;}}
if(filter.type==='filter'||filter.type==='groupBy'){filter.groupNumber=groupNumber;}
this._extractAttributes(filter,preFilter.attrs);currentGroup.push(filter);}});if(pregroupOfGroupBys.length){this._createGroupOfFilters(pregroupOfGroupBys);}
const dateFilters=Object.values(this.state.filters).filter((filter)=>filter.isDateFilter);if(dateFilters.length){this._createGroupOfComparisons(dateFilters);}}
_enrichFilterCopy(filter,filterQueryElements){const isActive=Boolean(filterQueryElements.length);const f=Object.assign({isActive},filter);function _enrichOptions(options){return options.map(o=>{const{description,id,groupNumber}=o;const isActive=filterQueryElements.some(a=>a.optionId===id);return{description,id,groupNumber,isActive};});}
switch(f.type){case'comparison':{const{dateFilterId}=filter;const dateFilterIsActive=this.state.query.some(queryElem=>queryElem.filterId===dateFilterId);if(!dateFilterIsActive){return null;}
break;}
case'filter':if(f.hasOptions){f.options=_enrichOptions(this.optionGenerators);}
break;case'groupBy':if(f.hasOptions){f.options=_enrichOptions(this.intervalOptions);}
break;case'field':f.autoCompleteValues=filterQueryElements.map(({label,value,operator})=>({label,value,operator}));break;}
return f;}
_evalArchChild(child){if(child.attrs.context){try{const context=pyUtils.eval('context',child.attrs.context);child.attrs.context=context;if(context.group_by){child.attrs.fieldName=context.group_by.split(':')[0];child.attrs.defaultInterval=context.group_by.split(':')[1];child.tag='groupBy';}}catch(e){}}
if(child.attrs.name in this.searchDefaults){child.attrs.isDefault=true;let value=this.searchDefaults[child.attrs.name];if(child.tag==='field'){child.attrs.defaultValue=this.fields[child.attrs.name].type==='many2one'&&Array.isArray(value)?value[0]:value;}else if(child.tag==='groupBy'){child.attrs.defaultRank=typeof value==='number'?value:100;}}
return child;}
_extractAttributes(filter,attrs){if(attrs.isDefault){filter.isDefault=attrs.isDefault;}
filter.description=attrs.string||attrs.help||attrs.name||attrs.domain||'';switch(filter.type){case'filter':if(attrs.context){filter.context=attrs.context;}
if(attrs.date){filter.isDateFilter=true;filter.hasOptions=true;filter.fieldName=attrs.date;filter.fieldType=this.fields[attrs.date].type;filter.defaultOptionId=attrs.default_period||DEFAULT_PERIOD;}else{filter.domain=attrs.domain||'[]';}
if(filter.isDefault){filter.defaultRank=-5;}
break;case'groupBy':filter.fieldName=attrs.fieldName;filter.fieldType=this.fields[attrs.fieldName].type;if(['date','datetime'].includes(filter.fieldType)){filter.hasOptions=true;filter.defaultOptionId=attrs.defaultInterval||DEFAULT_INTERVAL;}
if(filter.isDefault){filter.defaultRank=attrs.defaultRank;}
break;case'field':{const field=this.fields[attrs.name];filter.fieldName=attrs.name;filter.fieldType=field.type;if(attrs.domain){filter.domain=attrs.domain;}
if(attrs.filter_domain){filter.filterDomain=attrs.filter_domain;}else if(attrs.operator){filter.operator=attrs.operator;}
if(attrs.context){filter.context=attrs.context;}
if(filter.isDefault){let operator=filter.operator;if(!operator){const type=attrs.widget||filter.fieldType;if(["char","html","many2many","one2many","text"].includes(type)){operator="ilike";}else{operator="=";}}
filter.defaultRank=-10;filter.defaultAutocompleteValue={operator,value:attrs.defaultValue,};}
break;}}
if(filter.fieldName&&!attrs.string){const{string}=this.fields[filter.fieldName];filter.description=string;}}
_favoriteToIrFilter(favorite){const irFilter={action_id:this.config.actionId,model_id:this.config.modelName,};if('description'in favorite){irFilter.name=favorite.description;}
if('domain'in favorite){irFilter.domain=favorite.domain;}
if('isDefault'in favorite){irFilter.is_default=favorite.isDefault;}
if('orderedBy'in favorite){const sort=favorite.orderedBy.map(ob=>ob.name+(ob.asc===false?" desc":""));irFilter.sort=JSON.stringify(sort);}
if('serverSideId'in favorite){irFilter.id=favorite.serverSideId;}
if('userId'in favorite){irFilter.user_id=favorite.userId;}
const context=Object.assign({},favorite.context);if('groupBys'in favorite){context.group_by=favorite.groupBys;}
if('comparison'in favorite){context.comparison=favorite.comparison;}
if(Object.keys(context).length){irFilter.context=context;}
return irFilter;}
_getAutoCompletionFilterDomain(filter,filterQueryElements){const domains=filterQueryElements.map(({label,value,operator})=>{let domain;if(filter.filterDomain){domain=Domain.prototype.stringToArray(filter.filterDomain,{self:label,raw_value:value,});}else{domain=[[filter.fieldName,operator,value]];}
return Domain.prototype.arrayToString(domain);});return pyUtils.assembleDomains(domains,'OR');}
_getContext(groups){const types=['filter','favorite','field'];const contexts=groups.reduce((contexts,group)=>{if(types.includes(group.type)){contexts.push(...this._getGroupContexts(group));}
return contexts;},[]);const evaluationContext=this.env.session.user_context;try{return pyUtils.eval('contexts',contexts,evaluationContext);}catch(err){throw new Error(this.env._t("Failed to evaluate search context")+":\n"+
JSON.stringify(err));}}
_getDateFilterDomain(filter,filterQueryElements,key='domain'){const{fieldName,fieldType}=filter;const selectedOptionIds=filterQueryElements.map(queryElem=>queryElem.optionId);const dateFilterRange=constructDateDomain(this.referenceMoment,fieldName,fieldType,selectedOptionIds,);return dateFilterRange[key];}
_getDomain(groups){const types=['filter','favorite','field'];const domains=[];for(const group of groups){if(types.includes(group.type)){domains.push(this._getGroupDomain(group));}}
return pyUtils.assembleDomains(domains,'AND');}
_getFacetDescriptions(activities,type){const facetDescriptions=[];if(type==='field'){for(const queryElem of activities[0].filterQueryElements){facetDescriptions.push(queryElem.label);}}else if(type==='groupBy'){for(const{filter,filterQueryElements}of activities){if(filter.hasOptions){for(const queryElem of filterQueryElements){const option=this.intervalOptions.find(o=>o.id===queryElem.optionId);facetDescriptions.push(filter.description+': '+option.description);}}else{facetDescriptions.push(filter.description);}}}else{let facetDescription;for(const{filter,filterQueryElements}of activities){facetDescription=filter.description;if(filter.isDateFilter){const description=this._getDateFilterDomain(filter,filterQueryElements,'description');facetDescription+=`: ${description}`;}
facetDescriptions.push(facetDescription);}}
return facetDescriptions;}
_getFacets(){const facets=this._getGroups().map(({activities,type,id})=>{const values=this._getFacetDescriptions(activities,type);const title=activities[0].filter.description;return{groupId:id,title,type,values};});return facets;}
_getFilters(predicate){const filters=[];Object.values(this.state.filters).forEach(filter=>{if((!predicate||predicate(filter))&&!filter.invisible){const filterQueryElements=this.state.query.filter(queryElem=>queryElem.filterId===filter.id);const enrichedFilter=this._enrichFilterCopy(filter,filterQueryElements);if(enrichedFilter){filters.push(enrichedFilter);}}});if(filters.some(f=>f.type==='favorite')){filters.sort((f1,f2)=>f1.groupNumber-f2.groupNumber);}
return filters;}
_getFilterContext(filter,filterQueryElements){let context=filter.context||{};if(filter.type==='field'&&filter.context){context=pyUtils.eval('context',filter.context,{self:filterQueryElements.map(({value})=>value)},);}
if(filter.type==='field'&&filter.isDefault&&filter.fieldType==='many2one'){context[`default_${filter.fieldName}`]=filter.defaultAutocompleteValue.value;}
return context;}
_getFilterDomain(filter,filterQueryElements){if(filter.type==='filter'&&filter.hasOptions){const{dateFilterId}=this.activeComparison||{};if(this.searchMenuTypes.includes('comparison')&&dateFilterId===filter.id){return"[]";}
return this._getDateFilterDomain(filter,filterQueryElements);}else if(filter.type==='field'){return this._getAutoCompletionFilterDomain(filter,filterQueryElements);}
return filter.domain;}
_getFilterGroupBys(filter,filterQueryElements){if(filter.type==='groupBy'){const fieldName=filter.fieldName;if(filter.hasOptions){return filterQueryElements.map(({optionId})=>`${fieldName}:${optionId}`);}else{return[fieldName];}}else{return filter.groupBys;}}
_getGroupBy(groups){const groupBys=groups.reduce((groupBys,group)=>{if(['groupBy','favorite'].includes(group.type)){groupBys.push(...this._getGroupGroupBys(group));}
return groupBys;},[]);const groupBy=groupBys.length?groupBys:(this.actionContext.group_by||[]);return typeof groupBy==='string'?[groupBy]:groupBy;}
_getGroupContexts(group){const contexts=group.activities.reduce((ctx,qe)=>[...ctx,this._getFilterContext(qe.filter,qe.filterQueryElements)],[]);return contexts;}
_getGroupDomain(group){const domains=group.activities.map(({filter,filterQueryElements})=>{return this._getFilterDomain(filter,filterQueryElements);});return pyUtils.assembleDomains(domains,'OR');}
_getGroupGroupBys(group){const groupBys=group.activities.reduce((gb,qe)=>[...gb,...this._getFilterGroupBys(qe.filter,qe.filterQueryElements)],[]);return groupBys;}
_getGroups(){const groups=this.state.query.reduce((groups,queryElem)=>{const{groupId,filterId}=queryElem;let group=groups.find(group=>group.id===groupId);const filter=this.state.filters[filterId];if(!group){const{type}=filter;group={id:groupId,type,activities:[]};groups.push(group);}
group.activities.push(queryElem);return groups;},[]);groups.forEach(g=>this._mergeActivities(g));return groups;}
_getOrderedBy(groups){return groups.reduce((orderedBy,group)=>{if(group.type==='favorite'){const favoriteOrderedBy=group.activities[0].filter.orderedBy;if(favoriteOrderedBy){orderedBy=[...favoriteOrderedBy,...orderedBy];}}
return orderedBy;},[]);}
_getSelectedOptionIds(dateFilterId){const selectedOptionIds=[];for(const queryElem of this.state.query){if(queryElem.filterId===dateFilterId){selectedOptionIds.push(queryElem.optionId);}}
return selectedOptionIds;}
_getTimeRanges(evaluation){let timeRanges;for(const queryElem of this.state.query.slice().reverse()){const filter=this.state.filters[queryElem.filterId];if(filter.type==='comparison'){timeRanges=this._computeTimeRanges(filter);break;}else if(filter.type==='favorite'&&filter.comparison){timeRanges=filter.comparison;break;}}
if(timeRanges){if(evaluation){timeRanges.range=Domain.prototype.stringToArray(timeRanges.range);timeRanges.comparisonRange=Domain.prototype.stringToArray(timeRanges.comparisonRange);}
return timeRanges;}
return null;}
_irFilterToFavorite(irFilter){let userId=irFilter.user_id||false;if(Array.isArray(userId)){userId=userId[0];}
const groupNumber=userId?FAVORITE_PRIVATE_GROUP:FAVORITE_SHARED_GROUP;const context=pyUtils.eval('context',irFilter.context,this.env.session.user_context);let groupBys=[];if(context.group_by){groupBys=context.group_by;delete context.group_by;}
let comparison;if(context.comparison){comparison=context.comparison;delete context.comparison;}
let sort;try{sort=JSON.parse(irFilter.sort);}catch(err){if(err instanceof SyntaxError){sort=[];}else{throw err;}}
const orderedBy=sort.map(order=>{let fieldName;let asc;const sqlNotation=order.split(' ');if(sqlNotation.length>1){fieldName=sqlNotation[0];asc=sqlNotation[1]==='asc';}else{fieldName=order[0]==='-'?order.slice(1):order;asc=order[0]==='-'?false:true;}
return{asc:asc,name:fieldName,};});const favorite={context,description:irFilter.name,domain:irFilter.domain,groupBys,groupNumber,orderedBy,removable:true,serverSideId:irFilter.id,type:'favorite',userId,};if(irFilter.is_default){favorite.isDefault=irFilter.is_default;}
if(comparison){favorite.comparison=comparison;}
return favorite;}
_mergeActivities(group){const{activities,type}=group;let res=[];switch(type){case'filter':case'groupBy':{for(const activity of activities){const{filterId}=activity;let a=res.find(({filter})=>filter.id===filterId);if(!a){a={filter:this.state.filters[filterId],filterQueryElements:[]};res.push(a);}
a.filterQueryElements.push(activity);}
break;}
case'favorite':case'field':case'comparison':{const{filterId}=group.activities[0];const filter=this.state.filters[filterId];res.push({filter,filterQueryElements:group.activities});break;}}
if(type==='groupBy'){res.forEach(activity=>{activity.filterQueryElements.sort((qe1,qe2)=>rankInterval(qe1.optionId)-rankInterval(qe2.optionId));});}
group.activities=res;}
_prepareDefaultLabel(filter){const{id,fieldType,fieldName,defaultAutocompleteValue}=filter;const{selection,context,relation}=this.fields[fieldName];if(fieldType==='selection'){defaultAutocompleteValue.label=selection.find(sel=>sel[0]===defaultAutocompleteValue.value)[1];}else if(fieldType==='many2one'){const updateLabel=label=>{const queryElem=this.state.query.find(({filterId})=>filterId===id);if(queryElem){queryElem.label=label;defaultAutocompleteValue.label=label;}};const promise=this.env.services.rpc({args:[defaultAutocompleteValue.value],context:context,method:'name_get',model:relation,}).then(results=>updateLabel(results[0][1])).guardedCatch(()=>updateLabel(defaultAutocompleteValue.value));this.labelPromises.push(promise);}else{defaultAutocompleteValue.label=defaultAutocompleteValue.value;}}
async _saveQuery(preFilter){const groups=this._getGroups();const userContext=this.env.session.user_context;let controllerQueryParams;this.config.trigger("get-controller-query-params",params=>{controllerQueryParams=params;});controllerQueryParams=controllerQueryParams||{};controllerQueryParams.context=controllerQueryParams.context||{};const queryContext=this._getContext(groups);const context=pyUtils.eval('contexts',[userContext,controllerQueryParams.context,queryContext]);for(const key in userContext){delete context[key];}
const requireEvaluation=false;const domain=this._getDomain(groups);const groupBys=this._getGroupBy(groups);const timeRanges=this._getTimeRanges(requireEvaluation);const orderedBy=controllerQueryParams.orderedBy?controllerQueryParams.orderedBy:(this._getOrderedBy(groups)||[]);const userId=preFilter.isShared?false:this.env.session.uid;delete preFilter.isShared;Object.assign(preFilter,{context,domain,groupBys,groupNumber:userId?FAVORITE_PRIVATE_GROUP:FAVORITE_SHARED_GROUP,orderedBy,removable:true,userId,});if(timeRanges){preFilter.comparison=timeRanges;}
const irFilter=this._favoriteToIrFilter(preFilter);const serverSideId=await this.env.dataManager.create_filter(irFilter);preFilter.serverSideId=serverSideId;return preFilter;}
static extractArchInfo(archs){const{attrs,children}=archs.search;const controlPanelInfo={attrs,children:[],};for(const child of children){if(child.tag!=="searchpanel"){controlPanelInfo.children.push(child);}}
return controlPanelInfo;}}
ActionModel.registry.add("ControlPanel",ControlPanelModelExtension,10);return ControlPanelModelExtension;});;

/* /web/static/src/js/control_panel/control_panel_x2many.js defined in bundle 'web.assets_backend' */
odoo.define('web.ControlPanelX2Many',function(require){const ControlPanel=require('web.ControlPanel');class ControlPanelX2Many extends ControlPanel{_shouldShowPager(){if(!this.props.pager||!this.props.pager.limit){return false;}
const{currentMinimum,limit,size}=this.props.pager;const maximum=Math.min(currentMinimum+limit-1,size);const singlePage=(1===currentMinimum)&&(maximum===size);return!singlePage;}}
ControlPanelX2Many.defaultProps={};ControlPanelX2Many.props={cp_content:{type:Object,optional:1},pager:Object,};ControlPanelX2Many.template='web.ControlPanelX2Many';return ControlPanelX2Many;});;

/* /web/static/src/js/control_panel/custom_favorite_item.js defined in bundle 'web.assets_backend' */
odoo.define('web.CustomFavoriteItem',function(require){"use strict";const DropdownMenuItem=require('web.DropdownMenuItem');const FavoriteMenu=require('web.FavoriteMenu');const{useAutofocus}=require('web.custom_hooks');const{useModel}=require('web/static/src/js/model.js');const{useRef}=owl.hooks;let favoriteId=0;class CustomFavoriteItem extends DropdownMenuItem{constructor(){super(...arguments);const favId=favoriteId++;this.useByDefaultId=`o_favorite_use_by_default_${favId}`;this.shareAllUsersId=`o_favorite_share_all_users_${favId}`;this.descriptionRef=useRef('description');this.model=useModel('searchModel');this.interactive=true;Object.assign(this.state,{description:this.env.action.name||"",isDefault:false,isShared:false,});useAutofocus();}
_saveFavorite(){if(!this.state.description.length){this.env.services.notification.notify({message:this.env._t("A name for your favorite filter is required."),type:'danger',});return this.descriptionRef.el.focus();}
const favorites=this.model.get('filters',f=>f.type==='favorite');if(favorites.some(f=>f.description===this.state.description)){this.env.services.notification.notify({message:this.env._t("Filter with same name already exists."),type:'danger',});return this.descriptionRef.el.focus();}
this.model.dispatch('createNewFavorite',{type:'favorite',description:this.state.description,isDefault:this.state.isDefault,isShared:this.state.isShared,});Object.assign(this.state,{description:this.env.action.name||"",isDefault:false,isShared:false,open:false,});}
_onCheckboxChange(ev){const{checked,id}=ev.target;if(this.useByDefaultId===id){this.state.isDefault=checked;if(checked){this.state.isShared=false;}}else{this.state.isShared=checked;if(checked){this.state.isDefault=false;}}}
_onInputKeydown(ev){switch(ev.key){case'Enter':ev.preventDefault();this._saveFavorite();break;case'Escape':ev.preventDefault();ev.target.blur();break;}}
static shouldBeDisplayed(env){return true;}}
CustomFavoriteItem.props={};CustomFavoriteItem.template='web.CustomFavoriteItem';CustomFavoriteItem.groupNumber=3;FavoriteMenu.registry.add('favorite-generator-menu',CustomFavoriteItem,0);return CustomFavoriteItem;});;

/* /web/static/src/js/control_panel/favorite_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.FavoriteMenu',function(require){"use strict";const Dialog=require('web.OwlDialog');const DropdownMenu=require('web.DropdownMenu');const{FACET_ICONS}=require("web.searchUtils");const Registry=require('web.Registry');const{useModel}=require('web/static/src/js/model.js');class FavoriteMenu extends DropdownMenu{constructor(){super(...arguments);this.model=useModel('searchModel');this.state.deletedFavorite=false;}
get icon(){return FACET_ICONS.favorite;}
get items(){const favorites=this.model.get('filters',f=>f.type==='favorite');const registryMenus=this.constructor.registry.values().reduce((menus,Component)=>{if(Component.shouldBeDisplayed(this.env)){menus.push({key:Component.name,groupNumber:Component.groupNumber,Component,});}
return menus;},[]);return[...favorites,...registryMenus];}
get title(){return this.env._t("Favorites");}
_onItemRemoved(ev){const favorite=this.items.find(fav=>fav.id===ev.detail.item.id);this.state.deletedFavorite=favorite;}
_onItemSelected(ev){ev.stopPropagation();this.model.dispatch('toggleFilter',ev.detail.item.id);}
async _onRemoveFavorite(){this.model.dispatch('deleteFavorite',this.state.deletedFavorite.id);this.state.deletedFavorite=false;}}
FavoriteMenu.registry=new Registry();FavoriteMenu.components=Object.assign({},DropdownMenu.components,{Dialog,});FavoriteMenu.template='web.FavoriteMenu';return FavoriteMenu;});;

/* /web/static/src/js/control_panel/custom_filter_item.js defined in bundle 'web.assets_backend' */
odoo.define('web.CustomFilterItem',function(require){"use strict";const{DatePicker,DateTimePicker}=require('web.DatePickerOwl');const Domain=require('web.Domain');const DropdownMenuItem=require('web.DropdownMenuItem');const{FIELD_OPERATORS,FIELD_TYPES}=require('web.searchUtils');const field_utils=require('web.field_utils');const patchMixin=require('web.patchMixin');const{useModel}=require('web/static/src/js/model.js');class CustomFilterItem extends DropdownMenuItem{constructor(){super(...arguments);this.model=useModel('searchModel');this.canBeOpened=true;this.state.conditions=[];this.fields=Object.values(this.props.fields).filter(field=>this._validateField(field)).concat({string:'ID',type:'id',name:'id'}).sort(({string:a},{string:b})=>a>b?1:a<b?-1:0);this.DECIMAL_POINT=this.env._t.database.parameters.decimal_point;this.OPERATORS=FIELD_OPERATORS;this.FIELD_TYPES=FIELD_TYPES;this._addDefaultCondition();}
_addDefaultCondition(){const condition={field:0,operator:0,};this._setDefaultValue(condition);this.state.conditions.push(condition);}
_validateField(field){return!field.deprecated&&field.searchable&&FIELD_TYPES[field.type]&&field.name!=='id';}
_setDefaultValue(condition){const fieldType=this.fields[condition.field].type;const genericType=FIELD_TYPES[fieldType];const operator=FIELD_OPERATORS[genericType][condition.operator];switch(genericType){case'id':case'number':condition.value=0;break;case'date':condition.value=[moment()];if(operator.symbol==='between'){condition.value.push(moment());}
break;case'datetime':condition.value=[moment('00:00:00','hh:mm:ss').utcOffset(0,true)];if(operator.symbol==='between'){condition.value.push(moment('23:59:59','hh:mm:ss').utcOffset(0,true));}
break;case'selection':const[firstValue]=this.fields[condition.field].selection[0];condition.value=firstValue;break;default:condition.value="";}
if(["float","monetary"].includes(fieldType)){condition.displayedValue=`0${this.DECIMAL_POINT}0`;}else{condition.displayedValue=String(condition.value);}}
_onApply(){const preFilters=this.state.conditions.map(condition=>{const field=this.fields[condition.field];const type=this.FIELD_TYPES[field.type];const operator=this.OPERATORS[type][condition.operator];const descriptionArray=[field.string,operator.description];const domainArray=[];let domainValue;if('value'in operator){domainValue=[operator.value];}else if(['date','datetime'].includes(type)){domainValue=condition.value.map(val=>field_utils.parse[type](val,{type},{timezone:true}));const dateValue=condition.value.map(val=>field_utils.format[type](val,{type},{timezone:false}));descriptionArray.push(`"${dateValue.join(" " + this.env._t("and") + " ")}"`);}else if(type==="selection"){domainValue=[condition.value];const formattedValue=field_utils.format[type](condition.value,field);descriptionArray.push(`"${formattedValue}"`);}else{domainValue=[condition.value];descriptionArray.push(`"${condition.value}"`);}
if(operator.symbol==='between'){domainArray.push([field.name,'>=',domainValue[0]],[field.name,'<=',domainValue[1]]);}else{domainArray.push([field.name,operator.symbol,domainValue[0]]);}
const preFilter={description:descriptionArray.join(" "),domain:Domain.prototype.arrayToString(domainArray),type:'filter',};return preFilter;});this.model.dispatch('createNewFilters',preFilters);this.state.open=false;this.state.conditions=[];this._addDefaultCondition();}
_onDateChanged(condition,valueIndex,ev){condition.value[valueIndex]=ev.detail.date;}
_onFieldSelect(condition,ev){Object.assign(condition,{field:ev.target.selectedIndex,operator:0,});this._setDefaultValue(condition);}
_onOperatorSelect(condition,ev){condition.operator=ev.target.selectedIndex;this._setDefaultValue(condition);}
_onRemoveCondition(conditionIndex){this.state.conditions.splice(conditionIndex,1);}
_onValueInput(condition,ev){if(!ev.target.value){return this._setDefaultValue(condition);}
let{type}=this.fields[condition.field];if(type==="id"){type="integer";}
if(FIELD_TYPES[type]==="number"){try{condition.value=field_utils.parse[type](ev.target.value);condition.displayedValue=ev.target.value;}catch(err){ev.target.value=condition.displayedValue;}}else{condition.value=condition.displayedValue=ev.target.value;}}}
CustomFilterItem.components={DatePicker,DateTimePicker};CustomFilterItem.props={fields:Object,};CustomFilterItem.template='web.CustomFilterItem';return patchMixin(CustomFilterItem);});;

/* /web/static/src/js/control_panel/filter_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.FilterMenu',function(require){"use strict";const CustomFilterItem=require('web.CustomFilterItem');const DropdownMenu=require('web.DropdownMenu');const{FACET_ICONS}=require("web.searchUtils");const{useModel}=require('web/static/src/js/model.js');class FilterMenu extends DropdownMenu{constructor(){super(...arguments);this.model=useModel('searchModel');}
get icon(){return FACET_ICONS.filter;}
get items(){return this.model.get('filters',f=>f.type==='filter');}
get title(){return this.env._t("Filters");}
_onItemSelected(ev){ev.stopPropagation();const{item,option}=ev.detail;if(option){this.model.dispatch('toggleFilterWithOptions',item.id,option.id);}else{this.model.dispatch('toggleFilter',item.id);}}}
FilterMenu.components=Object.assign({},DropdownMenu.components,{CustomFilterItem,});FilterMenu.props=Object.assign({},DropdownMenu.props,{fields:Object,});FilterMenu.template='web.FilterMenu';return FilterMenu;});;

/* /web/static/src/js/control_panel/groupby_menu.js defined in bundle 'web.assets_backend' */
odoo.define('web.GroupByMenu',function(require){"use strict";const CustomGroupByItem=require('web.CustomGroupByItem');const DropdownMenu=require('web.DropdownMenu');const{FACET_ICONS,GROUPABLE_TYPES}=require('web.searchUtils');const{useModel}=require('web/static/src/js/model.js');class GroupByMenu extends DropdownMenu{constructor(){super(...arguments);this.fields=Object.values(this.props.fields).filter(field=>this._validateField(field)).sort(({string:a},{string:b})=>a>b?1:a<b?-1:0);this.model=useModel('searchModel');}
get icon(){return FACET_ICONS.groupBy;}
get items(){return this.model.get('filters',f=>f.type==='groupBy');}
get title(){return this.env._t("Group By");}
_validateField(field){return field.sortable&&field.name!=="id"&&GROUPABLE_TYPES.includes(field.type);}
_onItemSelected(ev){ev.stopPropagation();const{item,option}=ev.detail;if(option){this.model.dispatch('toggleFilterWithOptions',item.id,option.id);}else{this.model.dispatch('toggleFilter',item.id);}}}
GroupByMenu.components=Object.assign({},DropdownMenu.components,{CustomGroupByItem,});GroupByMenu.props=Object.assign({},DropdownMenu.props,{fields:Object,});GroupByMenu.template='web.GroupByMenu';return GroupByMenu;});;

/* /web/static/src/js/control_panel/custom_group_by_item.js defined in bundle 'web.assets_backend' */
odoo.define('web.CustomGroupByItem',function(require){"use strict";const DropdownMenuItem=require('web.DropdownMenuItem');const{useModel}=require('web/static/src/js/model.js');class CustomGroupByItem extends DropdownMenuItem{constructor(){super(...arguments);this.canBeOpened=true;this.state.fieldName=this.props.fields[0].name;this.model=useModel('searchModel');}
_onApply(){const field=this.props.fields.find(f=>f.name===this.state.fieldName);this.model.dispatch('createNewGroupBy',field);this.state.open=false;}}
CustomGroupByItem.template='web.CustomGroupByItem';CustomGroupByItem.props={fields:Array,};return CustomGroupByItem;});;

/* /web/static/src/js/control_panel/search_bar.js defined in bundle 'web.assets_backend' */
odoo.define('web.SearchBar',function(require){"use strict";const Domain=require('web.Domain');const field_utils=require('web.field_utils');const{useAutofocus}=require('web.custom_hooks');const{useModel}=require('web/static/src/js/model.js');const CHAR_FIELDS=['char','html','many2many','many2one','one2many','text'];const{Component,hooks}=owl;const{useExternalListener,useRef,useState}=hooks;let sourceId=0;class SearchBar extends Component{constructor(){super(...arguments);this.focusOnUpdate=useAutofocus();this.inputRef=useRef('search-input');this.model=useModel('searchModel');this.state=useState({sources:[],focusedItem:0,inputValue:"",});this.autoCompleteSources=this.model.get('filters',f=>f.type==='field').map(filter=>this._createSource(filter));this.noResultItem=[null,this.env._t("(no result)")];useExternalListener(window,'click',this._onWindowClick);useExternalListener(window,'keydown',this._onWindowKeydown);}
mounted(){this.env.searchModel.on('search',this,this.focusOnUpdate);this.env.searchModel.on('focus-control-panel',this,()=>{this.inputRef.el.focus();});}
willUnmount(){this.env.searchModel.off('search',this);this.env.searchModel.off('focus-control-panel',this);}
_closeAutoComplete(){this.state.sources=[];this.state.focusedItem=0;this.state.inputValue="";this.inputRef.el.value="";this.focusOnUpdate();}
_createSource(filter){const field=this.props.fields[filter.fieldName];const type=field.type==="reference"?"char":field.type;const source={active:true,description:filter.description,filterId:filter.id,filterOperator:filter.operator,id:sourceId++,operator:CHAR_FIELDS.includes(type)?'ilike':'=',parent:false,type,};switch(type){case'selection':{source.active=false;source.selection=field.selection||[];break;}
case'boolean':{source.active=false;source.selection=[[true,this.env._t("Yes")],[false,this.env._t("No")],];break;}
case'many2one':{source.expand=true;source.expanded=false;source.context=field.context;source.relation=field.relation;if(filter.domain){source.domain=filter.domain;}}}
return source;}
_createSubSource(source,[value,label],active=true){const subSource={active,filterId:source.filterId,filterOperator:source.filterOperator,id:sourceId++,label,operator:'=',parent:source,value,};return subSource;}
async _expandSource(source,shouldExpand){source.expanded=shouldExpand;if(shouldExpand){let args=source.domain;if(typeof args==='string'){try{args=Domain.prototype.stringToArray(args);}catch(err){args=[];}}
const results=await this.rpc({kwargs:{args,context:source.context,limit:8,name:this.state.inputValue.trim(),},method:'name_search',model:source.relation,});const options=results.map(result=>this._createSubSource(source,result));const parentIndex=this.state.sources.indexOf(source);if(!options.length){options.push(this._createSubSource(source,this.noResultItem,false));}
this.state.sources.splice(parentIndex+1,0,...options);}else{this.state.sources=this.state.sources.filter(src=>src.parent!==source);}}
_filterSources(query){return this.autoCompleteSources.reduce((sources,source)=>{if(source.selection){const options=[];source.selection.forEach(result=>{if(fuzzy.test(query,result[1].toLowerCase())){options.push(this._createSubSource(source,result));}});if(options.length){sources.push(source,...options);}}else if(this._validateSource(query,source)){sources.push(source);}
if(source.expanded){source.expanded=false;}
return sources;},[]);}
_focusFacet(index){const facets=this.el.getElementsByClassName('o_searchview_facet');if(facets.length){facets[index].focus();}}
_parseWithSource(rawValue,{type}){const parser=field_utils.parse[type];let parsedValue;switch(type){case'date':case'datetime':{const parsedDate=parser(rawValue,{type},{timezone:true});const dateFormat=type==='datetime'?'YYYY-MM-DD HH:mm:ss':'YYYY-MM-DD';const momentValue=moment(parsedDate,dateFormat);if(!momentValue.isValid()){throw new Error('Invalid date');}
parsedValue=parsedDate.toJSON();break;}
case'many2one':{parsedValue=rawValue;break;}
default:{parsedValue=parser(rawValue);}}
return parsedValue;}
_selectSource(source){if(source.active){const labelValue=source.label||this.state.inputValue;this.model.dispatch('addAutoCompletionValues',{filterId:source.filterId,value:"value"in source?source.value:this._parseWithSource(labelValue,source),label:labelValue,operator:source.filterOperator||source.operator,});}
this._closeAutoComplete();}
_validateSource(query,source){try{this._parseWithSource(query,source);}catch(err){return false;}
return true;}
_onFacetKeydown(facet,facetIndex,ev){switch(ev.key){case'ArrowLeft':if(facetIndex===0){this.inputRef.el.focus();}else{this._focusFacet(facetIndex-1);}
break;case'ArrowRight':const facets=this.el.getElementsByClassName('o_searchview_facet');if(facetIndex===facets.length-1){this.inputRef.el.focus();}else{this._focusFacet(facetIndex+1);}
break;case'Backspace':this._onFacetRemove(facet);break;}}
_onFacetRemove(facet){this.model.dispatch('deactivateGroup',facet.groupId);}
_onSearchKeydown(ev){if(ev.isComposing){return;}
const currentItem=this.state.sources[this.state.focusedItem]||{};switch(ev.key){case'ArrowDown':ev.preventDefault();if(Object.keys(this.state.sources).length){let nextIndex=this.state.focusedItem+1;if(nextIndex>=this.state.sources.length){nextIndex=0;}
this.state.focusedItem=nextIndex;}else{this.env.bus.trigger('focus-view');}
break;case'ArrowLeft':if(currentItem.expanded){ev.preventDefault();this._expandSource(currentItem,false);}else if(currentItem.parent){ev.preventDefault();this.state.focusedItem=this.state.sources.indexOf(currentItem.parent);}else if(ev.target.selectionStart===0){this._focusFacet(this.model.get("facets").length-1);}
break;case'ArrowRight':if(ev.target.selectionStart===this.state.inputValue.length){if(currentItem.expand){ev.preventDefault();if(currentItem.expanded){this.state.focusedItem++;}else{this._expandSource(currentItem,true);}}else if(ev.target.selectionStart===this.state.inputValue.length){this._focusFacet(0);}}
break;case'ArrowUp':ev.preventDefault();let previousIndex=this.state.focusedItem-1;if(previousIndex<0){previousIndex=this.state.sources.length-1;}
this.state.focusedItem=previousIndex;break;case'Backspace':if(!this.state.inputValue.length){const facets=this.model.get("facets");if(facets.length){this._onFacetRemove(facets[facets.length-1]);}}
break;case'Enter':if(!this.state.inputValue.length){this.model.dispatch('search');break;}
case'Tab':if(this.state.inputValue.length){ev.preventDefault();this._selectSource(currentItem);}
break;case'Escape':if(this.state.sources.length){this._closeAutoComplete();}
break;}}
_onSearchInput(ev){this.state.inputValue=ev.target.value;const wasVisible=this.state.sources.length;const query=this.state.inputValue.trim().toLowerCase();if(query.length){this.state.sources=this._filterSources(query);}else if(wasVisible){this._closeAutoComplete();}}
_onSourceMousemove(resultIndex){this.state.focusedItem=resultIndex;}
_onWindowClick(ev){if(this.state.sources.length&&!this.el.contains(ev.target)){this._closeAutoComplete();}}
_onWindowKeydown(ev){if(ev.key==='Escape'&&this.state.sources.length){ev.preventDefault();ev.stopPropagation();this._closeAutoComplete();}}}
SearchBar.defaultProps={fields:{},};SearchBar.props={fields:Object,};SearchBar.template='web.SearchBar';return SearchBar;});;

/* /web/static/src/js/control_panel/search_utils.js defined in bundle 'web.assets_backend' */
odoo.define('web.searchUtils',function(require){"use strict";const{_lt,_t}=require('web.core');const Domain=require('web.Domain');const pyUtils=require('web.py_utils');const FIELD_OPERATORS={boolean:[{symbol:"=",description:_lt("is true"),value:true},{symbol:"!=",description:_lt("is false"),value:true},],char:[{symbol:"ilike",description:_lt("contains")},{symbol:"not ilike",description:_lt("doesn't contain")},{symbol:"=",description:_lt("is equal to")},{symbol:"!=",description:_lt("is not equal to")},{symbol:"!=",description:_lt("is set"),value:false},{symbol:"=",description:_lt("is not set"),value:false},],date:[{symbol:"=",description:_lt("is equal to")},{symbol:"!=",description:_lt("is not equal to")},{symbol:">",description:_lt("is after")},{symbol:"<",description:_lt("is before")},{symbol:">=",description:_lt("is after or equal to")},{symbol:"<=",description:_lt("is before or equal to")},{symbol:"between",description:_lt("is between")},{symbol:"!=",description:_lt("is set"),value:false},{symbol:"=",description:_lt("is not set"),value:false},],datetime:[{symbol:"between",description:_lt("is between")},{symbol:"=",description:_lt("is equal to")},{symbol:"!=",description:_lt("is not equal to")},{symbol:">",description:_lt("is after")},{symbol:"<",description:_lt("is before")},{symbol:">=",description:_lt("is after or equal to")},{symbol:"<=",description:_lt("is before or equal to")},{symbol:"!=",description:_lt("is set"),value:false},{symbol:"=",description:_lt("is not set"),value:false},],id:[{symbol:"=",description:_lt("is")},{symbol:"<=",description:_lt("less than or equal to")},{symbol:">",description:_lt("greater than")},],number:[{symbol:"=",description:_lt("is equal to")},{symbol:"!=",description:_lt("is not equal to")},{symbol:">",description:_lt("greater than")},{symbol:"<",description:_lt("less than")},{symbol:">=",description:_lt("greater than or equal to")},{symbol:"<=",description:_lt("less than or equal to")},{symbol:"!=",description:_lt("is set"),value:false},{symbol:"=",description:_lt("is not set"),value:false},],selection:[{symbol:"=",description:_lt("is")},{symbol:"!=",description:_lt("is not")},{symbol:"!=",description:_lt("is set"),value:false},{symbol:"=",description:_lt("is not set"),value:false},],};const FIELD_TYPES={boolean:'boolean',char:'char',date:'date',datetime:'datetime',float:'number',id:'id',integer:'number',html:'char',many2many:'char',many2one:'char',monetary:'number',one2many:'char',text:'char',selection:'selection',};const DEFAULT_PERIOD='this_month';const QUARTERS={1:{description:_lt("Q1"),coveredMonths:[0,1,2]},2:{description:_lt("Q2"),coveredMonths:[3,4,5]},3:{description:_lt("Q3"),coveredMonths:[6,7,8]},4:{description:_lt("Q4"),coveredMonths:[9,10,11]},};const MONTH_OPTIONS={this_month:{id:'this_month',groupNumber:1,format:'MMMM',addParam:{},granularity:'month',},last_month:{id:'last_month',groupNumber:1,format:'MMMM',addParam:{months:-1},granularity:'month',},antepenultimate_month:{id:'antepenultimate_month',groupNumber:1,format:'MMMM',addParam:{months:-2},granularity:'month',},};const QUARTER_OPTIONS={fourth_quarter:{id:'fourth_quarter',groupNumber:1,description:QUARTERS[4].description,setParam:{quarter:4},granularity:'quarter',},third_quarter:{id:'third_quarter',groupNumber:1,description:QUARTERS[3].description,setParam:{quarter:3},granularity:'quarter',},second_quarter:{id:'second_quarter',groupNumber:1,description:QUARTERS[2].description,setParam:{quarter:2},granularity:'quarter',},first_quarter:{id:'first_quarter',groupNumber:1,description:QUARTERS[1].description,setParam:{quarter:1},granularity:'quarter',},};const YEAR_OPTIONS={this_year:{id:'this_year',groupNumber:2,format:'YYYY',addParam:{},granularity:'year',},last_year:{id:'last_year',groupNumber:2,format:'YYYY',addParam:{years:-1},granularity:'year',},antepenultimate_year:{id:'antepenultimate_year',groupNumber:2,format:'YYYY',addParam:{years:-2},granularity:'year',},};const PERIOD_OPTIONS=Object.assign({},MONTH_OPTIONS,QUARTER_OPTIONS,YEAR_OPTIONS);const GROUPABLE_TYPES=['boolean','char','date','datetime','integer','many2one','selection',];const DEFAULT_INTERVAL='month';const INTERVAL_OPTIONS={year:{description:_lt("Year"),id:'year',groupNumber:1},quarter:{description:_lt("Quarter"),id:'quarter',groupNumber:1},month:{description:_lt("Month"),id:'month',groupNumber:1},week:{description:_lt("Week"),id:'week',groupNumber:1},day:{description:_lt("Day"),id:'day',groupNumber:1}};const COMPARISON_OPTIONS={previous_period:{description:_lt("Previous Period"),id:'previous_period',},previous_year:{description:_lt("Previous Year"),id:'previous_year',addParam:{years:-1},},};const PER_YEAR={year:1,quarter:4,month:12,};const FACET_ICONS={filter:'fa fa-filter',groupBy:'fa fa-bars',favorite:'fa fa-star',comparison:'fa fa-adjust',};function constructDateDomain(referenceMoment,fieldName,fieldType,selectedOptionIds,comparisonOptionId){let addParam;let selectedOptions;if(comparisonOptionId){[addParam,selectedOptions]=getComparisonParams(referenceMoment,selectedOptionIds,comparisonOptionId);}else{selectedOptions=getSelectedOptions(referenceMoment,selectedOptionIds);}
const yearOptions=selectedOptions.year;const otherOptions=[...(selectedOptions.quarter||[]),...(selectedOptions.month||[])];sortPeriodOptions(yearOptions);sortPeriodOptions(otherOptions);const ranges=[];for(const yearOption of yearOptions){const constructRangeParams={referenceMoment,fieldName,fieldType,addParam,};if(otherOptions.length){for(const option of otherOptions){const setParam=Object.assign({},yearOption.setParam,option?option.setParam:{});const{granularity}=option;const range=constructDateRange(Object.assign({granularity,setParam},constructRangeParams));ranges.push(range);}}else{const{granularity,setParam}=yearOption;const range=constructDateRange(Object.assign({granularity,setParam},constructRangeParams));ranges.push(range);}}
const domain=pyUtils.assembleDomains(ranges.map(range=>range.domain),'OR');const description=ranges.map(range=>range.description).join("/");return{domain,description};}
function constructDateRange({referenceMoment,fieldName,fieldType,granularity,setParam,addParam,}){const date=referenceMoment.clone().set(setParam).add(addParam||{});let leftBound=date.clone().locale('en').startOf(granularity);let rightBound=date.clone().locale('en').endOf(granularity);if(fieldType==='date'){leftBound=leftBound.format('YYYY-MM-DD');rightBound=rightBound.format('YYYY-MM-DD');}else{leftBound=leftBound.utc().format('YYYY-MM-DD HH:mm:ss');rightBound=rightBound.utc().format('YYYY-MM-DD HH:mm:ss');}
const domain=Domain.prototype.arrayToString(['&',[fieldName,'>=',leftBound],[fieldName,'<=',rightBound]]);const descriptions=[date.format("YYYY")];const method=_t.database.parameters.direction==="rtl"?"push":"unshift";if(granularity==="month"){descriptions[method](date.format("MMMM"));}else if(granularity==="quarter"){descriptions[method](QUARTERS[date.quarter()].description);}
const description=descriptions.join(" ");return{domain,description,};}
function getComparisonOptions(){return getOptionsWithDescriptions(COMPARISON_OPTIONS);}
function getComparisonParams(referenceMoment,selectedOptionIds,comparisonOptionId){const comparisonOption=COMPARISON_OPTIONS[comparisonOptionId];const selectedOptions=getSelectedOptions(referenceMoment,selectedOptionIds);let addParam=comparisonOption.addParam;if(addParam){return[addParam,selectedOptions];}
addParam={};let globalGranularity='year';if(selectedOptions.month){globalGranularity='month';}else if(selectedOptions.quarter){globalGranularity='quarter';}
const granularityFactor=PER_YEAR[globalGranularity];const years=selectedOptions.year.map(o=>o.setParam.year);const yearMin=Math.min(...years);const yearMax=Math.max(...years);let optionMin=0;let optionMax=0;if(selectedOptions.quarter){const quarters=selectedOptions.quarter.map(o=>o.setParam.quarter);if(globalGranularity==='month'){delete selectedOptions.quarter;for(const quarter of quarters){for(const month of QUARTERS[quarter].coveredMonths){const monthOption=selectedOptions.month.find(o=>o.setParam.month===month);if(!monthOption){selectedOptions.month.push({setParam:{month,},granularity:'month',});}}}}else{optionMin=Math.min(...quarters);optionMax=Math.max(...quarters);}}
if(selectedOptions.month){const months=selectedOptions.month.map(o=>o.setParam.month);optionMin=Math.min(...months);optionMax=Math.max(...months);}
addParam[globalGranularity]=-1+
granularityFactor*(yearMin-yearMax)+
optionMin-optionMax;return[addParam,selectedOptions];}
function getIntervalOptions(){return getOptionsWithDescriptions(INTERVAL_OPTIONS);}
function getPeriodOptions(referenceMoment){const options=[];for(const option of Object.values(PERIOD_OPTIONS)){const{id,groupNumber,description,}=option;const res={id,groupNumber,};const date=referenceMoment.clone().set(option.setParam).add(option.addParam);if(description){res.description=description.toString();}else{res.description=date.format(option.format.toString());}
res.setParam=getSetParam(option,referenceMoment);res.defaultYear=date.year();options.push(res);}
for(const option of options){const yearOption=options.find(o=>o.setParam&&o.setParam.year===option.defaultYear);option.defaultYearId=yearOption.id;delete option.defaultYear;delete option.setParam;}
return options;}
function getOptionsWithDescriptions(OPTIONS){const options=[];for(const option of Object.values(OPTIONS)){const{id,groupNumber,description,}=option;const res={id,};if(description){res.description=description.toString();}
if(groupNumber){res.groupNumber=groupNumber;}
options.push(res);}
return options;}
function getSelectedOptions(referenceMoment,selectedOptionIds){const selectedOptions={year:[]};for(const optionId of selectedOptionIds){const option=PERIOD_OPTIONS[optionId];const setParam=getSetParam(option,referenceMoment);const granularity=option.granularity;if(!selectedOptions[granularity]){selectedOptions[granularity]=[];}
selectedOptions[granularity].push({granularity,setParam});}
return selectedOptions;}
function getSetParam(periodOption,referenceMoment){if(periodOption.setParam){return periodOption.setParam;}
const date=referenceMoment.clone().add(periodOption.addParam);const setParam={};setParam[periodOption.granularity]=date[periodOption.granularity]();return setParam;}
function rankInterval(intervalOptionId){return Object.keys(INTERVAL_OPTIONS).indexOf(intervalOptionId);}
function sortPeriodOptions(options){options.sort((o1,o2)=>{const granularity1=o1.granularity;const granularity2=o2.granularity;if(granularity1===granularity2){return o1.setParam[granularity1]-o2.setParam[granularity1];}
return granularity1<granularity2?-1:1;});}
function yearSelected(selectedOptionIds){return selectedOptionIds.some(optionId=>!!YEAR_OPTIONS[optionId]);}
return{COMPARISON_OPTIONS,DEFAULT_INTERVAL,DEFAULT_PERIOD,FACET_ICONS,FIELD_OPERATORS,FIELD_TYPES,GROUPABLE_TYPES,INTERVAL_OPTIONS,PERIOD_OPTIONS,constructDateDomain,getComparisonOptions,getIntervalOptions,getPeriodOptions,rankInterval,yearSelected,};});;

/* /web/static/src/js/views/search_panel_model_extension.js defined in bundle 'web.assets_backend' */
odoo.define("web/static/src/js/views/search_panel_model_extension.js",function(require){"use strict";const ActionModel=require("web/static/src/js/views/action_model.js");const{sortBy}=require("web.utils");const Domain=require("web.Domain");const pyUtils=require("web.py_utils");const DEFAULT_VIEW_TYPES=["kanban","tree"];const DEFAULT_LIMIT=200;let nextSectionId=1;function hasDomain(filter){return filter.domain!=="[]";}
function hasValues({errorMsg,groups,type,values}){if(errorMsg){return true;}else if(groups){return[...groups.values()].some((g)=>g.values.size);}else if(type==="category"){return values&&values.size>1;}else{return values&&values.size>0;}}
function serialiseMap(map){return[...map].map(([key,val])=>[key,Object.assign({},val)]);}
class SearchPanelModelExtension extends ActionModel.Extension{constructor(){super(...arguments);this.categoriesToLoad=[];this.defaultValues={};this.filtersToLoad=[];this.initialStateImport=false;this.searchDomain=[];for(const key in this.config.context){const match=/^searchpanel_default_(.*)$/.exec(key);if(match){this.defaultValues[match[1]]=this.config.context[key];}}}
async callLoad(params){const searchDomain=this._getExternalDomain();params.searchDomainChanged=(JSON.stringify(this.searchDomain)!==JSON.stringify(searchDomain));if(!this.shouldLoad&&!this.initialStateImport){const isFetchable=(section)=>section.enableCounters||(params.searchDomainChanged&&!section.expand);this.categoriesToLoad=this.categories.filter(isFetchable);this.filtersToLoad=this.filters.filter(isFetchable);this.shouldLoad=params.searchDomainChanged||Boolean(this.categoriesToLoad.length+this.filtersToLoad.length);}
this.searchDomain=searchDomain;this.initialStateImport=false;await super.callLoad(params);}
exportState(){const state=Object.assign({},super.exportState());state.sections=serialiseMap(state.sections);for(const[id,section]of state.sections){section.values=serialiseMap(section.values);if(section.groups){section.groups=serialiseMap(section.groups);for(const[id,group]of section.groups){group.values=serialiseMap(group.values);}}}
return state;}
get(property,...args){switch(property){case"domain":return this.getDomain();case"sections":return this.getSections(...args);}}
importState(importedState){this.initialStateImport=Boolean(importedState&&!this.state.sections);super.importState(...arguments);if(importedState){this.state.sections=new Map(this.state.sections);for(const section of this.state.sections.values()){section.values=new Map(section.values);if(section.groups){section.groups=new Map(section.groups);for(const group of section.groups.values()){group.values=new Map(group.values);}}}}}
async isReady(){await this.sectionsPromise;}
async load(params){this.sectionsPromise=this._fetchSections(params.isInitialLoad);if(this._shouldWaitForData(params)){await this.sectionsPromise;}}
prepareState(){Object.assign(this.state,{sections:new Map()});this._createSectionsFromArch();}
getDomain(){return Domain.prototype.normalizeArray([...this._getCategoryDomain(),...this._getFilterDomain(),]);}
getSections(predicate){let sections=[...this.state.sections.values()].map((section)=>Object.assign({},section,{empty:!hasValues(section)}));if(predicate){sections=sections.filter(predicate);}
return sections.sort((s1,s2)=>s1.index-s2.index);}
toggleCategoryValue(sectionId,valueId){const category=this.state.sections.get(sectionId);category.activeValueId=valueId;}
toggleFilterValues(sectionId,valueIds,forceTo=null){const section=this.state.sections.get(sectionId);for(const valueId of valueIds){const value=section.values.get(valueId);value.checked=forceTo===null?!value.checked:forceTo;}}
get categories(){return[...this.state.sections.values()].filter(s=>s.type==="category");}
get filters(){return[...this.state.sections.values()].filter(s=>s.type==="filter");}
_applyDefaultFilterValues(){for(const{fieldName,values}of this.filters){const defaultValues=this.defaultValues[fieldName]||[];for(const valueId of defaultValues){const value=values.get(valueId);if(value){value.checked=true;}}}}
_createCategoryTree(sectionId,result){const category=this.state.sections.get(sectionId);let{error_msg,parent_field:parentField,values,}=result;if(error_msg){category.errorMsg=error_msg;values=[];}
if(category.hierarchize){category.parentField=parentField;}
for(const value of values){category.values.set(value.id,Object.assign({},value,{childrenIds:[],parentId:value[parentField]||false,}));}
for(const value of values){const{parentId}=category.values.get(value.id);if(parentId&&category.values.has(parentId)){category.values.get(parentId).childrenIds.push(value.id);}}
category.rootIds=[false];for(const value of values){const{parentId}=category.values.get(value.id);if(!parentId){category.rootIds.push(value.id);}}
const valueIds=[false,...values.map((val)=>val.id)];this._ensureCategoryValue(category,valueIds);}
_createFilterTree(sectionId,result){const filter=this.state.sections.get(sectionId);let{error_msg,values,}=result;if(error_msg){filter.errorMsg=error_msg;values=[];}
values.forEach((value)=>{const oldValue=filter.values.get(value.id);value.checked=oldValue?oldValue.checked:false;});filter.values=new Map();const groupIds=[];if(filter.groupBy){const groups=new Map();for(const value of values){const groupId=value.group_id;if(!groups.has(groupId)){if(groupId){groupIds.push(groupId);}
groups.set(groupId,{id:groupId,name:value.group_name,values:new Map(),tooltip:value.group_tooltip,sequence:value.group_sequence,hex_color:value.group_hex_color,});const oldGroup=filter.groups&&filter.groups.get(groupId);groups.get(groupId).state=(oldGroup&&oldGroup.state)||false;}
groups.get(groupId).values.set(value.id,value);}
filter.groups=groups;filter.sortedGroupIds=sortBy(groupIds,(id)=>groups.get(id).sequence||groups.get(id).name);for(const group of filter.groups.values()){for(const[valueId,value]of group.values){filter.values.set(valueId,value);}}}else{for(const value of values){filter.values.set(value.id,value);}}}
_createSectionsFromArch(){let hasCategoryWithCounters=false;let hasFilterWithDomain=false;this.config.archNodes.forEach(({attrs,tag},index)=>{if(tag!=="field"||attrs.invisible==="1"){return;}
const type=attrs.select==="multi"?"filter":"category";const section={color:attrs.color,description:attrs.string||this.config.fields[attrs.name].string,enableCounters:!!pyUtils.py_eval(attrs.enable_counters||"0"),expand:!!pyUtils.py_eval(attrs.expand||"0"),fieldName:attrs.name,icon:attrs.icon,id:nextSectionId++,index,limit:pyUtils.py_eval(attrs.limit||String(DEFAULT_LIMIT)),type,values:new Map(),};if(type==="category"){section.activeValueId=this.defaultValues[attrs.name];section.icon=section.icon||"fa-folder";section.hierarchize=!!pyUtils.py_eval(attrs.hierarchize||"1");section.values.set(false,{childrenIds:[],display_name:this.env._t("All"),id:false,bold:true,parentId:false,});hasCategoryWithCounters=hasCategoryWithCounters||section.enableCounters;}else{section.domain=attrs.domain||"[]";section.groupBy=attrs.groupby;section.icon=section.icon||"fa-filter";hasFilterWithDomain=hasFilterWithDomain||section.domain!=="[]";}
this.state.sections.set(section.id,section);});if(hasCategoryWithCounters&&hasFilterWithDomain){for(const category of this.categories){category.enableCounters=false;}
console.warn("Warning: categories with counters are incompatible with filters having a domain attribute.","All category counters have been disabled to avoid inconsistencies.",);}}
_ensureCategoryValue(category,valueIds){if(!valueIds.includes(category.activeValueId)){category.activeValueId=valueIds[0];}}
async _fetchCategories(categories){const filterDomain=this._getFilterDomain();await Promise.all(categories.map(async(category)=>{const result=await this.env.services.rpc({method:"search_panel_select_range",model:this.config.modelName,args:[category.fieldName],kwargs:{category_domain:this._getCategoryDomain(category.id),enable_counters:category.enableCounters,expand:category.expand,filter_domain:filterDomain,hierarchize:category.hierarchize,limit:category.limit,search_domain:this.searchDomain,},});this._createCategoryTree(category.id,result);}));}
async _fetchFilters(filters){const evalContext={};for(const category of this.categories){evalContext[category.fieldName]=category.activeValueId;}
const categoryDomain=this._getCategoryDomain();await Promise.all(filters.map(async(filter)=>{const result=await this.env.services.rpc({method:"search_panel_select_multi_range",model:this.config.modelName,args:[filter.fieldName],kwargs:{category_domain:categoryDomain,comodel_domain:Domain.prototype.stringToArray(filter.domain,evalContext),enable_counters:filter.enableCounters,filter_domain:this._getFilterDomain(filter.id),expand:filter.expand,group_by:filter.groupBy||false,group_domain:this._getGroupDomain(filter),limit:filter.limit,search_domain:this.searchDomain,},});this._createFilterTree(filter.id,result);}));}
async _fetchSections(isInitialLoad){await this._fetchCategories(isInitialLoad?this.categories:this.categoriesToLoad);await this._fetchFilters(isInitialLoad?this.filters:this.filtersToLoad);if(isInitialLoad){this._applyDefaultFilterValues();}}
_getCategoryDomain(excludedCategoryId){const domain=[];for(const category of this.categories){if(category.id===excludedCategoryId||!category.activeValueId){continue;}
const field=this.config.fields[category.fieldName];const operator=field.type==="many2one"&&category.parentField?"child_of":"=";domain.push([category.fieldName,operator,category.activeValueId,]);}
return domain;}
_getExternalDomain(){const domains=this.config.get("domain");const domain=domains.reduce((acc,dom)=>[...acc,...dom],[]);return Domain.prototype.normalizeArray(domain);}
_getFilterDomain(excludedFilterId){const domain=[];function addCondition(fieldName,valueMap){const ids=[];for(const[valueId,value]of valueMap){if(value.checked){ids.push(valueId);}}
if(ids.length){domain.push([fieldName,"in",ids]);}}
for(const filter of this.filters){if(filter.id===excludedFilterId){continue;}
const{fieldName,groups,values}=filter;if(groups){for(const group of groups.values()){addCondition(fieldName,group.values);}}else{addCondition(fieldName,values);}}
return domain;}
_getGroupDomain(filter){const{fieldName,groups,enableCounters}=filter;const{type:fieldType}=this.config.fields[fieldName];if(!enableCounters||!groups){return{many2one:[],many2many:{},}[fieldType];}
let groupDomain=null;if(fieldType==="many2one"){for(const group of groups.values()){const valueIds=[];let active=false;for(const[valueId,value]of group.values){const{checked}=value;valueIds.push(valueId);if(checked){active=true;}}
if(active){if(groupDomain){groupDomain=[[0,"=",1]];break;}else{groupDomain=[[fieldName,"in",valueIds]];}}}}else if(fieldType==="many2many"){const checkedValueIds=new Map();groups.forEach(({values},groupId)=>{values.forEach(({checked},valueId)=>{if(checked){if(!checkedValueIds.has(groupId)){checkedValueIds.set(groupId,[]);}
checkedValueIds.get(groupId).push(valueId);}});});groupDomain={};for(const[gId,ids]of checkedValueIds.entries()){for(const groupId of groups.keys()){if(gId!==groupId){const key=JSON.stringify(groupId);if(!groupDomain[key]){groupDomain[key]=[];}
groupDomain[key].push([fieldName,"in",ids]);}}}}
return groupDomain;}
_shouldWaitForData({isInitialLoad,searchDomainChanged}){if(isInitialLoad&&Object.keys(this.defaultValues).length){return true;}
if(this.categories.length&&this.filters.some(hasDomain)){return true;}
if(!this.searchDomain.length){return false;}
return[...this.state.sections.values()].some((section)=>!section.expand&&searchDomainChanged);}
static extractArchInfo(archs,viewType){const{children}=archs.search;const spNode=children.find(c=>c.tag==="searchpanel");const isObject=(obj)=>typeof obj==="object"&&obj!==null;if(spNode){const actualType=viewType==="list"?"tree":viewType;const{view_types}=spNode.attrs;const viewTypes=view_types?view_types.split(","):DEFAULT_VIEW_TYPES;if(viewTypes.includes(actualType)){return{attrs:spNode.attrs,children:spNode.children.filter(isObject),};}}
return null;}}
SearchPanelModelExtension.layer=1;ActionModel.registry.add("SearchPanel",SearchPanelModelExtension,30);return SearchPanelModelExtension;});;

/* /web/static/src/js/views/search_panel.js defined in bundle 'web.assets_backend' */
odoo.define("web/static/src/js/views/search_panel.js",function(require){"use strict";const{Model,useModel}=require("web/static/src/js/model.js");const patchMixin=require("web.patchMixin");const{Component,hooks}=owl;const{useState,useSubEnv}=hooks;class SearchPanel extends Component{constructor(){super(...arguments);useSubEnv({searchModel:this.props.searchModel});this.state=useState({active:{},expanded:{},});this.model=useModel("searchModel");this.scrollTop=0;this.hasImportedState=false;this.importState(this.props.importedState);}
async willStart(){this._expandDefaultValue();this._updateActiveValues();}
mounted(){this._updateGroupHeadersChecked();if(this.hasImportedState){this.el.scroll({top:this.scrollTop});}}
async willUpdateProps(){this._updateActiveValues();}
exportState(){const exported={expanded:this.state.expanded,scrollTop:this.el.scrollTop,};return JSON.stringify(exported);}
importState(stringifiedState){this.hasImportedState=Boolean(stringifiedState);if(this.hasImportedState){const state=JSON.parse(stringifiedState);this.state.expanded=state.expanded;this.scrollTop=state.scrollTop;}}
_expandDefaultValue(){if(this.hasImportedState){return;}
const categories=this.model.get("sections",s=>s.type==="category");for(const category of categories){this.state.expanded[category.id]={};if(category.activeValueId){const ancestorIds=this._getAncestorValueIds(category,category.activeValueId);for(const ancestorId of ancestorIds){this.state.expanded[category.id][ancestorId]=true;}}}}
_getAncestorValueIds(category,categoryValueId){const{parentId}=category.values.get(categoryValueId);return parentId?[...this._getAncestorValueIds(category,parentId),parentId]:[];}
async _toggleCategory(category,value){if(value.childrenIds.length){const categoryState=this.state.expanded[category.id];if(categoryState[value.id]&&category.activeValueId===value.id){delete categoryState[value.id];}else{categoryState[value.id]=true;}}
if(category.activeValueId!==value.id){this.state.active[category.id]=value.id;this.model.dispatch("toggleCategoryValue",category.id,value.id);}}
_toggleFilterGroup(filterId,{values}){const valueIds=[];const checked=[...values.values()].every((value)=>this.state.active[filterId][value.id]);values.forEach(({id})=>{valueIds.push(id);this.state.active[filterId][id]=!checked;});this.model.dispatch("toggleFilterValues",filterId,valueIds,!checked);}
_toggleFilterValue(filterId,valueId,{currentTarget}){this.state.active[filterId][valueId]=currentTarget.checked;this._updateGroupHeadersChecked();this.model.dispatch("toggleFilterValues",filterId,[valueId]);}
_updateActiveValues(){for(const section of this.model.get("sections")){if(section.type==="category"){this.state.active[section.id]=section.activeValueId;}else{this.state.active[section.id]={};if(section.groups){for(const group of section.groups.values()){for(const value of group.values.values()){this.state.active[section.id][value.id]=value.checked;}}}
if(section&&section.values){for(const value of section.values.values()){this.state.active[section.id][value.id]=value.checked;}}}}}
_updateGroupHeadersChecked(){const groups=this.el.querySelectorAll(":scope .o_search_panel_filter_group");for(const group of groups){const header=group.querySelector(":scope .o_search_panel_group_header input");const vals=[...group.querySelectorAll(":scope .o_search_panel_filter_value input")];header.checked=false;header.indeterminate=false;if(vals.every((v)=>v.checked)){header.checked=true;}else if(vals.some((v)=>v.checked)){header.indeterminate=true;}}}}
SearchPanel.modelExtension="SearchPanel";SearchPanel.props={className:{type:String,optional:1},importedState:{type:String,optional:1},searchModel:Model,};SearchPanel.template="web.SearchPanel";return patchMixin(SearchPanel);});;

/* /web/static/src/js/views/action_model.js defined in bundle 'web.assets_backend' */
odoo.define("web/static/src/js/views/action_model.js",function(require){"use strict";const Domain=require("web.Domain");const{FACET_ICONS}=require("web.searchUtils");const{Model}=require("web/static/src/js/model.js");const{parseArch}=require("web.viewUtils");const pyUtils=require("web.py_utils");const Registry=require("web.Registry");const isNotNull=(value)=>value!==null&&value!==undefined;const isObject=(obj)=>typeof obj==="object"&&obj!==null;class ActionModelExtension extends Model.Extension{async callLoad(){this.loadPromise=super.callLoad(...arguments);await this.loadPromise;}
async isReady(){await this.loadPromise;}
static extractArchInfo(){return null;}}
class ActionModel extends Model{get(property){switch(property){case"query":return this.config.searchQuery||this._getQuery();case"facets":return this._getFacets();}
return super.get(...arguments);}
async isReady(){await this._awaitExtensions();}
async _awaitExtensions(){await Promise.all(this.extensions.flat().map((extension)=>extension.isReady()));}
__get(excluded,property){const results=super.__get(...arguments);switch(property){case"domain":return[this.config.domain,...results];case"context":return[this.config.context,...results];}
return results;}
_getFacets(){const types=this.config.searchMenuTypes||[];const isValidType=(type)=>(!['groupBy','comparison'].includes(type)||types.includes(type));const facets=[];for(const extension of this.extensions.flat()){for(const facet of extension.get("facets")||[]){if(!isValidType(facet.type)){continue;}
facet.separator=facet.type==='groupBy'?">":this.env._t("or");if(facet.type in FACET_ICONS){facet.icon=FACET_ICONS[facet.type];}
facets.push(facet);}}
return facets;}
_getQuery(){const evalContext=this.env.session.user_context;const contexts=this.__get(null,"context");const domains=this.__get(null,"domain");const query={context:pyUtils.eval("contexts",contexts,evalContext),domain:Domain.prototype.normalizeArray(pyUtils.eval("domains",domains,evalContext)),orderedBy:this.get("orderedBy")||[],};const searchMenuTypes=this.config.searchMenuTypes||[];if(searchMenuTypes.includes("groupBy")){query.groupBy=this.get("groupBy")||[];}else{query.groupBy=[];}
if(searchMenuTypes.includes("comparison")){query.timeRanges=this.get("timeRanges")||{};}
return query;}
async _loadExtensions({isInitialLoad}){await super._loadExtensions(...arguments);if(!isInitialLoad){this.trigger("search",this.get("query"));await this._awaitExtensions();}}
static extractArchInfo(archs,viewType=null){const parsedArchs={};if(!archs.search){archs.search="<search/>";}
for(const key in archs){const{attrs,children}=parseArch(archs[key]);const objectChildren=children.filter(isObject);parsedArchs[key]={attrs,children:objectChildren,};}
const archInfo={};for(const key of this.registry.keys()){const extension=this.registry.get(key);const result=extension.extractArchInfo(parsedArchs,viewType);if(isNotNull(result)){archInfo[key]=result;}}
return archInfo;}}
ActionModel.Extension=ActionModelExtension;ActionModel.registry=new Registry(null,(value)=>value.prototype instanceof ActionModel.Extension);return ActionModel;});;

/* /web/static/src/js/views/field_manager_mixin.js defined in bundle 'web.assets_backend' */
odoo.define('web.FieldManagerMixin',function(require){"use strict";var BasicModel=require('web.BasicModel');var concurrency=require('web.concurrency');var FieldManagerMixin={custom_events:{field_changed:'_onFieldChanged',load:'_onLoad',mutexify:'_onMutexify',},init:function(model){this.model=model||new BasicModel(this);this.mutex=new concurrency.Mutex();},_applyChanges:function(dataPointID,changes,event){var self=this;var options=_.pick(event.data,'context','doNotSetDirty','notifyChange','viewType','allowWarning');return this.model.notifyChanges(dataPointID,changes,options).then(function(result){if(event.data.force_save){return self.model.save(dataPointID).then(function(){return self._confirmSave(dataPointID);}).guardedCatch(function(){return self._rejectSave(dataPointID);});}else if(options.notifyChange!==false){return self._confirmChange(dataPointID,result,event);}});},_confirmChange:function(id,fields,event){return Promise.resolve();},_confirmSave:function(id){return Promise.resolve();},_rejectSave:function(id){return Promise.resolve();},_onFieldChanged:function(event){event.stopPropagation();return this._applyChanges(event.data.dataPointID,event.data.changes,event).then(event.data.onSuccess||function(){}).guardedCatch(event.data.onFailure||function(){});},_onLoad:function(event){var self=this;event.stopPropagation();var data=event.data;if(!data.on_success){return;}
var params={};if('limit'in data){params.limit=data.limit;}
if('offset'in data){params.offset=data.offset;}
this.mutex.exec(function(){return self.model.reload(data.id,params).then(function(db_id){data.on_success(self.model.get(db_id));});});},_onMutexify:function(ev){ev.stopPropagation();this.mutex.exec(ev.data.action);},};return FieldManagerMixin;});;

/* /web/static/src/js/views/file_upload_mixin.js defined in bundle 'web.assets_backend' */
odoo.define('web.fileUploadMixin',function(require){'use strict';const{csrf_token,_t}=require('web.core');const ProgressBar=require('web.ProgressBar');const ProgressCard=require('web.ProgressCard');const ProgressBarMixin={custom_events:{progress_bar_abort:'_onProgressBarAbort',},init(){this._fileUploads={};},_createXhr(){return new window.XMLHttpRequest();},_getFileUploadRenderOptions(){return{predicate:()=>true,targetCallback:undefined,};},_getFileUploadRoute(){return'/web/binary/upload_attachment';},_makeFileUpload(params){const{files,xhr}=params;const fileUploadId=_.uniqueId('fileUploadId');const formData=new FormData();const formDataKeys=this._makeFileUploadFormDataKeys(Object.assign({fileUploadId},params));formData.append('csrf_token',csrf_token);for(const key in formDataKeys){if(formDataKeys[key]!==undefined){formData.append(key,formDataKeys[key]);}}
for(const file of files){formData.append('ufile',file);}
return{fileUploadId,xhr,title:files.length===1?files[0].name:_.str.sprintf(_t("%s Files"),files.length),type:files.length===1?files[0].type:undefined,formData,};},_makeFileUploadFormDataKeys({fileUploadId}){return{callback:fileUploadId,};},async _removeFileUpload(fileUploadId){const upload=this._fileUploads[fileUploadId];upload.progressCard&&upload.progressCard.destroy();upload.progressBar&&upload.progressBar.destroy();delete this._fileUploads[fileUploadId];await this.reload();},async _renderFileUploads(){const{predicate,targetCallback}=this._getFileUploadRenderOptions();for(const fileUploadId in this._fileUploads){const upload=this._fileUploads[fileUploadId];if(!predicate(upload)){continue;}
if(!upload.progressBar){if(!upload.recordId||this.viewType!=='kanban'){upload.progressCard=new ProgressCard(this,{title:upload.title,type:upload.type,viewType:this.viewType,});}
upload.progressBar=new ProgressBar(this,{xhr:upload.xhr,title:upload.title,fileUploadId,});}
let $targetCard;if(upload.progressCard){await upload.progressCard.prependTo(this.renderer.$el);$targetCard=upload.progressCard.$el;}else if(targetCallback){$targetCard=targetCallback(upload);}
await upload.progressBar.appendTo($targetCard);}},async _uploadFiles(files,params={}){if(!files||!files.length){return;}
await new Promise(resolve=>{const xhr=this._createXhr();xhr.open('POST',this._getFileUploadRoute());const fileUploadData=this._makeFileUpload(Object.assign({files,xhr},params));const{fileUploadId,formData}=fileUploadData;this._fileUploads[fileUploadId]=fileUploadData;xhr.upload.addEventListener("progress",ev=>{this._updateFileUploadProgress(fileUploadId,ev);});const progressPromise=this._onBeforeUpload();xhr.onload=async()=>{await progressPromise;resolve();this._onUploadLoad({fileUploadId,xhr});};xhr.onerror=async()=>{await progressPromise;resolve();this._onUploadError({fileUploadId,xhr});};xhr.send(formData);});},_updateFileUploadProgress(fileUploadId,ev){const{progressCard,progressBar}=this._fileUploads[fileUploadId];progressCard&&progressCard.update(ev.loaded,ev.total);progressBar&&progressBar.update(ev.loaded,ev.total);},async _onBeforeUpload(){await this._renderFileUploads();},_onProgressBarAbort(ev){this._removeFileUpload(ev.data.fileUploadId);},_onUploadLoad({fileUploadId}){this._removeFileUpload(fileUploadId);},_onUploadError({fileUploadId,xhr}){this.do_notify(xhr.status,_.str.sprintf(_t('message: %s'),xhr.reponseText),true);this._removeFileUpload(fileUploadId);},};return ProgressBarMixin;});;

/* /web/static/src/js/views/file_upload_progress_bar.js defined in bundle 'web.assets_backend' */
odoo.define('web.ProgressBar',function(require){'use strict';const{_t}=require('web.core');const Dialog=require('web.Dialog');const Widget=require('web.Widget');const ProgressBar=Widget.extend({template:'web.FileUploadProgressBar',events:{'click .o_upload_cross':'_onClickCross',},init(parent,{title,fileUploadId,xhr}){this._super(...arguments);this.title=title;this.fileUploadId=fileUploadId;this.xhr=xhr;},start(){this.xhr.onabort=()=>this.do_notify(false,_t("Upload cancelled"));return this._super(...arguments);},update(loaded,total){if(!this.$el){return;}
const percent=Math.round((loaded/total)*100);this.$('.o_file_upload_progress_bar_value').css("width",percent+"%");},_onClickCross(ev){ev.stopPropagation();const promptText=_.str.sprintf(_t("Do you really want to cancel the upload of %s?"),_.escape(this.title));Dialog.confirm(this,promptText,{confirm_callback:()=>{this.xhr.abort();this.trigger_up('progress_bar_abort',{fileUploadId:this.fileUploadId});}});},});return ProgressBar;});;

/* /web/static/src/js/views/file_upload_progress_card.js defined in bundle 'web.assets_backend' */
odoo.define('web.ProgressCard',function(require){'use strict';const{_t}=require('web.core');const Widget=require('web.Widget');const ProgressCard=Widget.extend({template:'web.ProgressCard',init(parent,{title,type,viewType}){this._super(...arguments);this.title=title;this.type=type;this.viewType=viewType;},update(loaded,total){if(!this.$el){return;}
const percent=Math.round((loaded/total)*100);const $textDivLeft=this.$('.o_file_upload_progress_text_left');const $textDivRight=this.$('.o_file_upload_progress_text_right');if(percent===100){$textDivLeft.text(_t('Processing...'));}else{const mbLoaded=Math.round(loaded/1000000);const mbTotal=Math.round(total/1000000);$textDivLeft.text(_.str.sprintf(_t("Uploading... (%s%%)"),percent));$textDivRight.text(_.str.sprintf(_t("(%s/%sMb)"),mbLoaded,mbTotal));}},});return ProgressCard;});;

/* /web/static/src/js/views/sample_server.js defined in bundle 'web.assets_backend' */
odoo.define('web.SampleServer',function(require){"use strict";const session=require('web.session');const utils=require('web.utils');const Registry=require('web.Registry');class UnimplementedRouteError extends Error{}
function getSampleFromId(id,sampleTexts){return sampleTexts[(id-1)%sampleTexts.length];}
function fieldNameRegex(...terms){return new RegExp(`\\b((\\w+)?_)?(${terms.join('|')})(_(\\w+)?)?\\b`);}
const DESCRIPTION_REGEX=fieldNameRegex('description','label','title','subject','message');const EMAIL_REGEX=fieldNameRegex('email');const PHONE_REGEX=fieldNameRegex('phone');const URL_REGEX=fieldNameRegex('url');class SampleServer{constructor(modelName,fields){this.mainModel=modelName;this.data={};this.data[modelName]={fields,records:[],};for(const fieldName in fields){const field=fields[fieldName];if(['many2one','one2many','many2many'].includes(field.type)){this.data[field.relation]=this.data[field.relation]||{fields:{display_name:{type:'char'},id:{type:'integer'},color:{type:'integer'},},records:[],};}}
this.existingGroups=null;this.populated=false;this.existingGroupsPopulated=false;}
mockRpc(params){if(!(params.model in this.data)){throw new Error(`SampleServer: unknown model ${params.model}`);}
this._populateModels();switch(params.method||params.route){case'/web/dataset/search_read':return this._mockSearchReadController(params);case'web_read_group':return this._mockWebReadGroup(params);case'read_group':return this._mockReadGroup(params);case'read_progress_bar':return this._mockReadProgressBar(params);case'read':return this._mockRead(params);}
const method=params.method||params.route;const mockFunction=SampleServer.mockRegistry.get(`${params.model}/${method}`)||SampleServer.mockRegistry.get(method);if(mockFunction){return mockFunction.call(this,params);}
console.log(`SampleServer: unimplemented route "${params.method || params.route}"`);throw new SampleServer.UnimplementedRouteError();}
setExistingGroups(groups){this.existingGroups=groups;}
_aggregateFields(measures,records){const values={};for(const{fieldName,type}of measures){if(['float','integer','monetary'].includes(type)){if(records.length){let value=0;for(const record of records){value+=record[fieldName];}
values[fieldName]=this._sanitizeNumber(value);}else{values[fieldName]=null;}}
if(type==='many2one'){const ids=new Set(records.map(r=>r[fieldName]));values.fieldName=ids.size||null;}}
return values;}
_formatValue(value,options){if(!value){return false;}
const{type,interval,relation}=options;if(['date','datetime'].includes(type)){const fmt=SampleServer.FORMATS[interval];return moment(value).format(fmt);}else if(type==='many2one'){const rec=this.data[relation].records.find(({id})=>id===value);return[value,rec.display_name];}else{return value;}}
_generateFieldValue(modelName,fieldName,id){const field=this.data[modelName].fields[fieldName];switch(field.type){case"boolean":return fieldName==='active'?true:this._getRandomBool();case"char":case"text":if(["display_name","name"].includes(fieldName)){if(SampleServer.PEOPLE_MODELS.includes(modelName)){return getSampleFromId(id,SampleServer.SAMPLE_PEOPLE);}else if(modelName==='res.country'){return getSampleFromId(id,SampleServer.SAMPLE_COUNTRIES);}}
if(fieldName==='display_name'){return getSampleFromId(id,SampleServer.SAMPLE_TEXTS);}else if(["name","reference"].includes(fieldName)){return`REF${String(id).padStart(4, '0')}`;}else if(DESCRIPTION_REGEX.test(fieldName)){return getSampleFromId(id,SampleServer.SAMPLE_TEXTS);}else if(EMAIL_REGEX.test(fieldName)){const emailName=getSampleFromId(id,SampleServer.SAMPLE_PEOPLE).replace(/ /,".").toLowerCase();return`${emailName}@sample.demo`;}else if(PHONE_REGEX.test(fieldName)){return`+1 555 754 ${String(id).padStart(4, '0')}`;}else if(URL_REGEX.test(fieldName)){return`http://sample${id}.com`;}
return false;case"date":case"datetime":{const format=field.type==="date"?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss";return this._getRandomDate(format);}
case"float":return this._getRandomFloat(SampleServer.MAX_FLOAT);case"integer":{let max=SampleServer.MAX_INTEGER;if(fieldName.includes('color')){max=this._getRandomBool()?SampleServer.MAX_COLOR_INT:0;}
return this._getRandomInt(max);}
case"monetary":return this._getRandomInt(SampleServer.MAX_MONETARY);case"many2one":if(field.relation==='res.currency'){return session.company_currency_id;}
if(field.relation==='ir.attachment'){return false;}
return this._getRandomSubRecordId();case"one2many":case"many2many":{const ids=[this._getRandomSubRecordId(),this._getRandomSubRecordId()];return[...new Set(ids)];}
case"selection":{if(fieldName==='activity_exception_decoration'){return false;}
if(field.selection.length>0){return this._getRandomArrayEl(field.selection)[0];}
return false;}
default:return false;}}
_getRandomArrayEl(array){return array[Math.floor(Math.random()*array.length)];}
_getRandomBool(){return Math.random()<0.5;}
_getRandomDate(format){const delta=Math.floor((Math.random()-Math.random())*SampleServer.DATE_DELTA);return new moment().add(delta,"hour").format(format);}
_getRandomFloat(max){return this._sanitizeNumber(Math.random()*max);}
_getRandomInt(max){return Math.floor(Math.random()*max);}
_getRandomSubRecordId(){return Math.floor(Math.random()*SampleServer.SUB_RECORDSET_SIZE)+1;}
_mockRead(params){const model=this.data[params.model];const ids=params.args[0];const fieldNames=params.args[1];const records=[];for(const r of model.records){if(!ids.includes(r.id)){continue;}
const record={id:r.id};for(const fieldName of fieldNames){const field=model.fields[fieldName];if(!field){record[fieldName]=false;}else if(field.type==='many2one'){const relModel=this.data[field.relation];const relRecord=relModel.records.find(relR=>r[fieldName]===relR.id);record[fieldName]=relRecord?[relRecord.id,relRecord.display_name]:false;}else{record[fieldName]=r[fieldName];}}
records.push(record);}
return records;}
_mockReadGroup(params){const lazy='lazy'in params?params.lazy:true;const model=params.model;const fields=this.data[model].fields;const records=this.data[model].records;const normalizedGroupBys=[];let groupBy=[];if(params.groupBy.length){groupBy=lazy?[params.groupBy[0]]:params.groupBy;}
for(const groupBySpec of groupBy){let[fieldName,interval]=groupBySpec.split(':');interval=interval||'month';const{type,relation}=fields[fieldName];if(type){const gb={fieldName,type,interval,relation,alias:groupBySpec};normalizedGroupBys.push(gb);}}
const groups=utils.groupBy(records,(record)=>{const vals={};for(const gb of normalizedGroupBys){const{fieldName,type}=gb;let value;if(['date','datetime'].includes(type)){value=this._formatValue(record[fieldName],gb);}else{value=record[fieldName];}
vals[fieldName]=value;}
return JSON.stringify(vals);});const measures=[];for(const measureSpec of(params.fields||Object.keys(fields))){const[fieldName,aggregateFunction]=measureSpec.split(':');const{type}=fields[fieldName];if(!params.groupBy.includes(fieldName)&&type&&(type!=='many2one'||aggregateFunction!=='count_distinct')){measures.push({fieldName,type});}}
let result=[];for(const id in groups){const records=groups[id];const group={__domain:[]};let countKey=`__count`;if(normalizedGroupBys.length&&lazy){countKey=`${normalizedGroupBys[0].fieldName}_count`;}
group[countKey]=records.length;const firstElem=records[0];for(const gb of normalizedGroupBys){const{alias,fieldName}=gb;group[alias]=this._formatValue(firstElem[fieldName],gb);}
Object.assign(group,this._aggregateFields(measures,records));result.push(group);}
if(normalizedGroupBys.length>0){const{alias,interval,type}=normalizedGroupBys[0];result=utils.sortBy(result,(group)=>{const val=group[alias];if(['date','datetime'].includes(type)){return moment(val,SampleServer.FORMATS[interval]);}
return val;});}
return result;}
_mockReadProgressBar(params){const groupBy=params.kwargs.group_by;const progress_bar=params.kwargs.progress_bar;const groupByField=this.data[params.model].fields[groupBy];const data={};for(const record of this.data[params.model].records){let groupByValue=record[groupBy];if(groupByField.type==="many2one"){const relatedRecords=this.data[groupByField.relation].records;const relatedRecord=relatedRecords.find(r=>r.id===groupByValue);groupByValue=relatedRecord.display_name;}
if(!(groupByValue in data)){data[groupByValue]={};for(const key in progress_bar.colors){data[groupByValue][key]=0;}}
const fieldValue=record[progress_bar.field];if(fieldValue in data[groupByValue]){data[groupByValue][fieldValue]++;}}
return data;}
_mockSearchReadController(params){const model=this.data[params.model];const rawRecords=model.records.slice(0,SampleServer.SEARCH_READ_LIMIT);const records=this._mockRead({model:params.model,args:[rawRecords.map(r=>r.id),params.fields],});return{records,length:records.length};}
_mockWebReadGroup(params){let groups;if(this.existingGroups){this._tweakExistingGroups(params);groups=this.existingGroups;}else{groups=this._mockReadGroup(params);}
return{groups,length:groups.length,};}
_populateExistingGroups(params){if(!this.existingGroupsPopulated){const groups=this.existingGroups;this.groupsInfo=groups;const groupBy=params.groupBy[0];const values=groups.map(g=>g[groupBy]);const groupByField=this.data[params.model].fields[groupBy];const groupedByM2O=groupByField.type==='many2one';if(groupedByM2O){this.data[groupByField.relation].records=values.map(v=>{return{id:v[0],display_name:v[1]};});}
for(const r of this.data[params.model].records){const value=getSampleFromId(r.id,values);r[groupBy]=groupedByM2O?value[0]:value;}
this.existingGroupsPopulated=true;}}
_populateModels(){if(!this.populated){for(const modelName in this.data){const model=this.data[modelName];const fieldNames=Object.keys(model.fields).filter(f=>f!=='id');const size=modelName===this.mainModel?SampleServer.MAIN_RECORDSET_SIZE:SampleServer.SUB_RECORDSET_SIZE;for(let id=1;id<=size;id++){const record={id};for(const fieldName of fieldNames){record[fieldName]=this._generateFieldValue(modelName,fieldName,id);}
model.records.push(record);}}
this.populated=true;}}
_sanitizeNumber(value){return parseFloat(value.toFixed(SampleServer.FLOAT_PRECISION));}
_tweakExistingGroups(params){const groups=this.existingGroups;this._populateExistingGroups(params);const groupBy=params.groupBy[0].split(':')[0];const groupByField=this.data[params.model].fields[groupBy];const groupedByM2O=groupByField.type==='many2one';const records=this.data[params.model].records;for(const g of groups){const groupValue=groupedByM2O?g[groupBy][0]:g[groupBy];const recordsInGroup=records.filter(r=>r[groupBy]===groupValue);g[`${groupBy}_count`]=recordsInGroup.length;for(const field of params.fields){const fieldType=this.data[params.model].fields[field].type;if(['integer, float','monetary'].includes(fieldType)){g[field]=recordsInGroup.reduce((acc,r)=>acc+r[field],0);}}
g.__data={records:this._mockRead({model:params.model,args:[recordsInGroup.map(r=>r.id),params.fields],}),length:recordsInGroup.length,};}}}
SampleServer.FORMATS={day:'YYYY-MM-DD',week:'[W]ww YYYY',month:'MMMM YYYY',quarter:'[Q]Q YYYY',year:'Y',};SampleServer.DISPLAY_FORMATS=Object.assign({},SampleServer.FORMATS,{day:'DD MMM YYYY'});SampleServer.MAIN_RECORDSET_SIZE=16;SampleServer.SUB_RECORDSET_SIZE=5;SampleServer.SEARCH_READ_LIMIT=10;SampleServer.MAX_FLOAT=100;SampleServer.MAX_INTEGER=50;SampleServer.MAX_COLOR_INT=7;SampleServer.MAX_MONETARY=100000;SampleServer.DATE_DELTA=24*60;SampleServer.FLOAT_PRECISION=2;SampleServer.SAMPLE_COUNTRIES=["Belgium","France","Portugal","Singapore","Australia"];SampleServer.SAMPLE_PEOPLE=["John Miller","Henry Campbell","Carrie Helle","Wendi Baltz","Thomas Passot",];SampleServer.SAMPLE_TEXTS=["Laoreet id","Volutpat blandit","Integer vitae","Viverra nam","In massa",];SampleServer.PEOPLE_MODELS=['res.users','res.partner','hr.employee','mail.followers','mailing.contact'];SampleServer.UnimplementedRouteError=UnimplementedRouteError;SampleServer.mockRegistry=new Registry();return SampleServer;});;

/* /web/static/src/js/views/select_create_controllers_registry.js defined in bundle 'web.assets_backend' */
odoo.define('web.select_create_controllers_registry',function(require){"use strict";return{};});odoo.define('web._select_create_controllers_registry',function(require){"use strict";var KanbanController=require('web.KanbanController');var ListController=require('web.ListController');var select_create_controllers_registry=require('web.select_create_controllers_registry');var SelectCreateKanbanController=KanbanController.extend({_onOpenRecord:function(ev){var selectedRecord=this.model.get(ev.data.id);this.trigger_up('select_record',{id:selectedRecord.res_id,display_name:selectedRecord.data.display_name,});},});var SelectCreateListController=ListController.extend({_onOpenRecord:function(ev){var selectedRecord=this.model.get(ev.data.id);this.trigger_up('select_record',{id:selectedRecord.res_id,display_name:selectedRecord.data.display_name,});},});_.extend(select_create_controllers_registry,{SelectCreateListController:SelectCreateListController,SelectCreateKanbanController:SelectCreateKanbanController,});});;

/* /web/static/src/js/views/signature_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('web.signature_dialog',function(require){"use strict";var core=require('web.core');var Dialog=require('web.Dialog');var NameAndSignature=require('web.name_and_signature').NameAndSignature;var _t=core._t;var SignatureDialog=Dialog.extend({template:'web.signature_dialog',xmlDependencies:Dialog.prototype.xmlDependencies.concat(['/web/static/src/xml/name_and_signature.xml']),custom_events:{'signature_changed':'_onChangeSignature',},init:function(parent,options){var self=this;options=options||{};options.title=options.title||_t("Adopt Your Signature");options.size=options.size||'medium';options.technical=false;if(!options.buttons){options.buttons=[];options.buttons.push({text:_t("Adopt and Sign"),classes:"btn-primary",disabled:true,click:function(e){self._onConfirm();}});options.buttons.push({text:_t("Cancel"),close:true});}
this._super(parent,options);this.nameAndSignature=new NameAndSignature(this,options.nameAndSignatureOptions);},willStart:function(){return Promise.all([this.nameAndSignature.appendTo($('<div>')),this._super.apply(this,arguments)]);},start:function(){var self=this;this.$primaryButton=this.$footer.find('.btn-primary');this.opened().then(function(){self.$('.o_web_sign_name_and_signature').replaceWith(self.nameAndSignature.$el);self.nameAndSignature.resetSignature();});return this._super.apply(this,arguments);},isSignatureEmpty:function(){return this.nameAndSignature.isSignatureEmpty();},_onChangeSignature:function(){var isEmpty=this.nameAndSignature.isSignatureEmpty();this.$primaryButton.prop('disabled',isEmpty);},_onConfirm:function(fct){this.trigger_up('upload_signature',{name:this.nameAndSignature.getName(),signatureImage:this.nameAndSignature.getSignatureImage(),});},});return SignatureDialog;});;

/* /web/static/src/js/views/standalone_field_manager_mixin.js defined in bundle 'web.assets_backend' */
odoo.define('web.StandaloneFieldManagerMixin',function(require){"use strict";var FieldManagerMixin=require('web.FieldManagerMixin');var StandaloneFieldManagerMixin=_.extend({},FieldManagerMixin,{init:function(){FieldManagerMixin.init.apply(this,arguments);this.registeredWidgets={};},_confirmChange:function(id,fields,event){var result=FieldManagerMixin._confirmChange.apply(this,arguments);var record=this.model.get(id);_.each(this.registeredWidgets[id],function(widget,fieldName){if(_.contains(fields,fieldName)){widget.reset(record,event);}});return result;},_registerWidget:function(datapointID,fieldName,widget){if(!this.registeredWidgets[datapointID]){this.registeredWidgets[datapointID]={};}
this.registeredWidgets[datapointID][fieldName]=widget;},});return StandaloneFieldManagerMixin;});;

/* /web/static/src/js/views/view_registry.js defined in bundle 'web.assets_backend' */
odoo.define('web.view_registry',function(require){"use strict";var Registry=require('web.Registry');return new Registry();});odoo.define('web._view_registry',function(require){"use strict";var FormView=require('web.FormView');var GraphView=require('web.GraphView');var KanbanView=require('web.KanbanView');var ListView=require('web.ListView');var PivotView=require('web.PivotView');var CalendarView=require('web.CalendarView');var view_registry=require('web.view_registry');view_registry.add('form',FormView).add('list',ListView).add('kanban',KanbanView).add('graph',GraphView).add('pivot',PivotView).add('calendar',CalendarView);});;

/* /web/static/src/js/views/view_dialogs.js defined in bundle 'web.assets_backend' */
odoo.define('web.view_dialogs',function(require){"use strict";var config=require('web.config');var core=require('web.core');var Dialog=require('web.Dialog');var dom=require('web.dom');var view_registry=require('web.view_registry');var select_create_controllers_registry=require('web.select_create_controllers_registry');var _t=core._t;var ViewDialog=Dialog.extend({custom_events:_.extend({},Dialog.prototype.custom_events,{push_state:'_onPushState',}),init:function(parent,options){options=options||{};options.fullscreen=config.device.isMobile;options.dialogClass=options.dialogClass||''+' o_act_window';this._super(parent,$.extend(true,{},options));this.res_model=options.res_model||null;this.domain=options.domain||[];this.context=options.context||{};this.options=_.extend(this.options||{},options||{});},_onPushState:function(event){event.stopPropagation();},});var FormViewDialog=ViewDialog.extend({init:function(parent,options){var self=this;options=options||{};this.res_id=options.res_id||null;this.on_saved=options.on_saved||(function(){});this.on_remove=options.on_remove||(function(){});this.context=options.context;this._createContext=options._createContext;this.model=options.model;this.parentID=options.parentID;this.recordID=options.recordID;this.shouldSaveLocally=options.shouldSaveLocally;this.readonly=options.readonly;this.deletable=options.deletable;this.disable_multiple_selection=options.disable_multiple_selection;var oBtnRemove='o_btn_remove';var multi_select=!_.isNumber(options.res_id)&&!options.disable_multiple_selection;var readonly=_.isNumber(options.res_id)&&options.readonly;if(!options.buttons){options.buttons=[{text:options.close_text||(readonly?_t("Close"):_t("Discard")),classes:"btn-secondary o_form_button_cancel",close:true,click:function(){if(!readonly){self.form_view.model.discardChanges(self.form_view.handle,{rollback:self.shouldSaveLocally,});}},}];if(!readonly){options.buttons.unshift({text:options.save_text||(multi_select?_t("Save & Close"):_t("Save")),classes:"btn-primary",click:function(){self._save().then(self.close.bind(self));}});if(multi_select){options.buttons.splice(1,0,{text:_t("Save & New"),classes:"btn-primary",click:function(){self._save().then(function(){const additionalContext=self._createContext&&self._createContext(false);self.form_view.createRecord(self.parentID,additionalContext);}).then(function(){if(!self.deletable){return;}
self.deletable=false;self.buttons=self.buttons.filter(function(button){return button.classes.split(' ').indexOf(oBtnRemove)<0;});self.set_buttons(self.buttons);self.set_title(_t("Create ")+_.str.strRight(self.title,_t("Open: ")));});},});}
var multi=options.disable_multiple_selection;if(!multi&&this.deletable){this._setRemoveButtonOption(options,oBtnRemove);}}}
this._super(parent,options);},open:function(){var self=this;var _super=this._super.bind(this);var FormView=view_registry.get('form');var fields_view_def;if(this.options.fields_view){fields_view_def=Promise.resolve(this.options.fields_view);}else{fields_view_def=this.loadFieldView(this.res_model,this.context,this.options.view_id,'form');}
fields_view_def.then(function(viewInfo){var refinedContext=_.pick(self.context,function(value,key){return key.indexOf('_view_ref')===-1;});var formview=new FormView(viewInfo,{modelName:self.res_model,context:refinedContext,ids:self.res_id?[self.res_id]:[],currentId:self.res_id||undefined,index:0,mode:self.res_id&&self.options.readonly?'readonly':'edit',footerToButtons:true,default_buttons:false,withControlPanel:false,model:self.model,parentID:self.parentID,recordID:self.recordID,isFromFormViewDialog:true,});return formview.getController(self);}).then(function(formView){self.form_view=formView;var fragment=document.createDocumentFragment();if(self.recordID&&self.shouldSaveLocally){self.model.save(self.recordID,{savePoint:true});}
return self.form_view.appendTo(fragment).then(function(){self.opened().then(function(){var $buttons=$('<div>');self.form_view.renderButtons($buttons);if($buttons.children().length){self.$footer.empty().append($buttons.contents());}
dom.append(self.$el,fragment,{callbacks:[{widget:self.form_view}],in_DOM:true,});self.form_view.updateButtons();});return _super();});});return this;},_focusOnClose:function(){var isFocusSet=false;this.trigger_up('form_dialog_discarded',{callback:function(isFocused){isFocusSet=isFocused;},});return isFocusSet;},_remove:function(){return Promise.resolve(this.on_remove());},_save:function(){var self=this;return this.form_view.saveRecord(this.form_view.handle,{stayInEdit:true,reload:false,savePoint:this.shouldSaveLocally,viewType:'form',}).then(function(changedFields){var record=self.form_view.model.get(self.form_view.handle);return self.on_saved(record,!!changedFields.length);});},_setRemoveButtonOption(options,btnClasses){const self=this;options.buttons.push({text:_t("Remove"),classes:'btn-secondary '+btnClasses,click:function(){self._remove().then(self.close.bind(self));}});},});var SelectCreateDialog=ViewDialog.extend({custom_events:_.extend({},ViewDialog.prototype.custom_events,{select_record:function(event){if(!this.options.readonly){this.on_selected([event.data]);this.close();}},selection_changed:function(event){event.stopPropagation();this.$footer.find(".o_select_button").prop('disabled',!event.data.selection.length);},}),init:function(){this._super.apply(this,arguments);_.defaults(this.options,{initial_view:'search'});this.on_selected=this.options.on_selected||(function(){});this.on_closed=this.options.on_closed||(function(){});this.initialIDs=this.options.initial_ids;this.viewType='list';},open:function(){if(this.options.initial_view!=="search"){return this.create_edit_record();}
var self=this;var _super=this._super.bind(this);var viewRefID=this.viewType==='kanban'?(this.options.kanban_view_ref&&JSON.parse(this.options.kanban_view_ref)||false):false;return this.loadViews(this.res_model,this.context,[[viewRefID,this.viewType],[false,'search']],{load_filters:true}).then(this.setup.bind(this)).then(function(fragment){self.opened().then(function(){dom.append(self.$el,fragment,{callbacks:[{widget:self.viewController}],in_DOM:true,});self.set_buttons(self.__buttons);});return _super();});},setup:function(fieldsViews){var self=this;var fragment=document.createDocumentFragment();var domain=this.domain;if(this.initialIDs){domain=domain.concat([['id','in',this.initialIDs]]);}
var ViewClass=view_registry.get(this.viewType);var viewOptions={};var selectCreateController;if(this.viewType==='list'){_.extend(viewOptions,{hasSelectors:!this.options.disable_multiple_selection,readonly:true,},this.options.list_view_options);selectCreateController=select_create_controllers_registry.SelectCreateListController;}
if(this.viewType==='kanban'){_.extend(viewOptions,{noDefaultGroupby:true,selectionMode:this.options.selectionMode||false,});selectCreateController=select_create_controllers_registry.SelectCreateKanbanController;}
var view=new ViewClass(fieldsViews[this.viewType],_.extend(viewOptions,{action:{controlPanelFieldsView:fieldsViews.search,help:_.str.sprintf("<p>%s</p>",_t("No records found!")),},action_buttons:false,dynamicFilters:this.options.dynamicFilters,context:this.context,domain:domain,modelName:this.res_model,withBreadcrumbs:false,withSearchPanel:false,}));view.setController(selectCreateController);return view.getController(this).then(function(controller){self.viewController=controller;self._prepareButtons();return self.viewController.appendTo(fragment);}).then(function(){return fragment;});},close:function(){this._super.apply(this,arguments);this.on_closed();},create_edit_record:function(){var self=this;var dialog=new FormViewDialog(this,_.extend({},this.options,{on_saved:function(record){var values=[{id:record.res_id,display_name:record.data.display_name||record.data.name,}];self.on_selected(values);},})).open();dialog.on('closed',this,this.close);return dialog;},_focusOnClose:function(){var isFocusSet=false;this.trigger_up('form_dialog_discarded',{callback:function(isFocused){isFocusSet=isFocused;},});return isFocusSet;},_prepareButtons:function(){this.__buttons=[{text:_t("Cancel"),classes:'btn-secondary o_form_button_cancel',close:true,}];if(!this.options.no_create){this.__buttons.unshift({text:_t("Create"),classes:'btn-primary',click:this.create_edit_record.bind(this)});}
if(!this.options.disable_multiple_selection){this.__buttons.unshift({text:_t("Select"),classes:'btn-primary o_select_button',disabled:true,close:true,click:async()=>{const resIds=await this.viewController.getSelectedIdsWithDomain();const values=resIds.map(e=>({id:e}));this.on_selected(values);},});}},});return{FormViewDialog:FormViewDialog,SelectCreateDialog:SelectCreateDialog,};});;

/* /web/static/src/js/views/view_utils.js defined in bundle 'web.assets_backend' */
odoo.define('web.viewUtils',function(require){"use strict";var dom=require('web.dom');var utils=require('web.utils');var viewUtils={getGroupValue:function(group,groupByField){var groupedByField=group.fields[groupByField];switch(groupedByField.type){case'many2one':return group.res_id||false;case'selection':var descriptor=_.find(groupedByField.selection,function(option){return option[1]===group.value;});return descriptor&&descriptor[0];case'char':case'boolean':return group.value;default:return false;}},isQuickCreateEnabled:function(list){var groupByField=list.groupedBy[0]&&list.groupedBy[0].split(':')[0];if(!groupByField){return false;}
var availableTypes=['char','boolean','many2one','selection'];if(!_.contains(availableTypes,list.fields[groupByField].type)){return false;}
return true;},parseArch:function(arch){var doc=$.parseXML(arch).documentElement;var stripWhitespaces=doc.nodeName.toLowerCase()!=='kanban';return utils.xml_to_json(doc,stripWhitespaces);},renderButtonFromNode:function(node,options){var btnOptions={attrs:_.omit(node.attrs,'icon','string','type','attrs','modifiers','options','effect'),icon:node.attrs.icon,};if(options&&options.extraClass){var classes=btnOptions.attrs.class?btnOptions.attrs.class.split(' '):[];btnOptions.attrs.class=_.uniq(classes.concat(options.extraClass.split(' '))).join(' ');}
var str=(node.attrs.string||'').replace(/_/g,'');if(str){if(options&&options.textAsTitle){btnOptions.attrs.title=str;}else{btnOptions.text=str;}}
return dom.renderButton(btnOptions);},};return viewUtils;});;

/* /web/static/src/js/views/form/form_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.FormRenderer',function(require){"use strict";var BasicRenderer=require('web.BasicRenderer');var config=require('web.config');var core=require('web.core');var dom=require('web.dom');var viewUtils=require('web.viewUtils');var _t=core._t;var qweb=core.qweb;const symbol=Symbol('form');var FormRenderer=BasicRenderer.extend({className:"o_form_view",events:_.extend({},BasicRenderer.prototype.events,{'click .o_notification_box .oe_field_translate':'_onTranslate','click .o_notification_box .close':'_onTranslateNotificationClose','shown.bs.tab a[data-toggle="tab"]':'_onNotebookTabChanged',}),custom_events:_.extend({},BasicRenderer.prototype.custom_events,{'navigation_move':'_onNavigationMove','activate_next_widget':'_onActivateNextWidget',}),INNER_GROUP_COL:2,OUTER_GROUP_COL:2,init:function(parent,state,params){this._super.apply(this,arguments);this.fieldIdsToNames=params.fieldIdsToNames;this.idsForLabels={};this.lastActivatedFieldIndex=-1;this.alertFields={};this.renderInvisible=false;},start:function(){this._applyFormSizeClass();return this._super.apply(this,arguments);},autofocus:function(){if(this.mode==='readonly'){var firstPrimaryFormButton=this.$el.find('button.btn-primary:enabled:visible:first()');if(firstPrimaryFormButton.length>0){return firstPrimaryFormButton.focus();}else{return;}}
var focusWidget=this.defaultFocusField;if(!focusWidget||!focusWidget.isFocusable()){var widgets=this.allFieldWidgets[this.state.id];for(var i=0;i<(widgets?widgets.length:0);i++){var widget=widgets[i];if(widget.isFocusable()){focusWidget=widget;break;}}}
if(focusWidget){return focusWidget.activate({noselect:true,noAutomaticCreate:true});}},canBeSaved:function(){var fieldNames=this._super.apply(this,arguments);var $labels=this.$('label');$labels.removeClass('o_field_invalid');const allWidgets=this.allFieldWidgets[this.state.id]||[];const widgets=allWidgets.filter(w=>fieldNames.includes(w.name));for(const widget of widgets){const idForLabel=this.idsForLabels[widget[symbol]];if(idForLabel){$labels.filter('[for='+idForLabel+']').addClass('o_field_invalid');}}
return fieldNames;},updateAlertFields:function(alertFields){this.alertFields[this.state.res_id]=_.extend(this.alertFields[this.state.res_id]||{},alertFields);this.displayTranslationAlert();},displayTranslationAlert:function(){this.$('.o_notification_box').remove();if(this.alertFields[this.state.res_id]){var $notification=$(qweb.render('notification-box',{type:'info'})).append(qweb.render('translation-alert',{fields:this.alertFields[this.state.res_id],lang:_t.database.parameters.name}));if(this.$('.o_form_statusbar').length){this.$('.o_form_statusbar').after($notification);}else if(this.$('.o_form_sheet_bg').length){this.$('.o_form_sheet_bg').prepend($notification);}else{this.$el.prepend($notification);}}},confirmChange:function(){var self=this;return this._super.apply(this,arguments).then(function(resetWidgets){_.each(resetWidgets,function(widget){self._setIDForLabel(widget,self.idsForLabels[widget[symbol]]);});if(self.$('.o_field_invalid').length){self.canBeSaved(self.state.id);}
return resetWidgets;});},disableButtons:function(){this.$('.o_statusbar_buttons button, .oe_button_box button').attr('disabled',true);},enableButtons:function(){this.$('.o_statusbar_buttons button, .oe_button_box button').removeAttr('disabled');},focusLastActivatedWidget:function(){if(this.lastActivatedFieldIndex!==-1){return this._activateNextFieldWidget(this.state,this.lastActivatedFieldIndex-1,{noAutomaticCreate:true});}
return false;},getLocalState:function(){const state={};for(const notebook of this.el.querySelectorAll(':scope div.o_notebook')){const name=notebook.dataset.name;const navs=notebook.querySelectorAll(':scope .o_notebook_headers .nav-item > .nav-link');state[name]=Math.max([...navs].findIndex(nav=>nav.classList.contains('active')),0);}
return state;},resetLastActivatedField:function(){this.lastActivatedFieldIndex=-1;},resetLocalState(){for(const notebook of this.el.querySelectorAll(':scope div.o_notebook')){[...notebook.querySelectorAll(':scope .o_notebook_headers .nav-item .nav-link')].map(nav=>nav.classList.remove('active'));[...notebook.querySelectorAll(':scope .tab-content > .tab-pane')].map(tab=>tab.classList.remove('active'));}},setLocalState:function(state){for(const notebook of this.el.querySelectorAll(':scope div.o_notebook')){if(notebook.closest(".o_field_widget")){continue;}
const name=notebook.dataset.name;if(name in state){const navs=notebook.querySelectorAll(':scope .o_notebook_headers .nav-item');const pages=notebook.querySelectorAll(':scope > .tab-content > .tab-pane');const validTabsAmount=pages.length;if(!validTabsAmount){continue;}
let activeIndex=state[name];if(navs[activeIndex].classList.contains('o_invisible_modifier')){activeIndex=[...navs].findIndex(nav=>!nav.classList.contains('o_invisible_modifier'));}
if(activeIndex<=0){continue;}
for(let i=0;i<validTabsAmount;i++){navs[i].querySelector('.nav-link').classList.toggle('active',activeIndex===i);pages[i].classList.toggle('active',activeIndex===i);}
core.bus.trigger('DOM_updated');}}},updateState:function(state,params){this._setState(state);this.mode=(params&&'mode'in params)?params.mode:this.mode;if(params.fieldNames){return this.confirmChange(this.state,this.state.id,params.fieldNames);}
return this._super.apply(this,arguments);},_activateFirstVisibleTab(tabs){const visibleTabs=tabs.filter((tab)=>!tab.$header.hasClass("o_invisible_modifier"));const autofocusTab=visibleTabs.findIndex((tab)=>tab.node.attrs.autofocus==="autofocus");const tabToFocus=visibleTabs[Math.max(0,autofocusTab)];if(tabToFocus){tabToFocus.$header.find('.nav-link').addClass('active');tabToFocus.$page.addClass('active');}},_activateNextFieldWidget:function(record,currentIndex){if((currentIndex+1)>=(this.allFieldWidgets[record.id]||[]).length){this.trigger_up('focus_control_button');this.lastActivatedFieldIndex=-1;}else{var activatedIndex=this._super.apply(this,arguments);if(activatedIndex===-1){this.trigger_up('focus_control_button');this.lastActivatedFieldIndex=-1;}
else{this.lastActivatedFieldIndex=activatedIndex;}}
return this.lastActivatedFieldIndex;},_addButtonTooltip:function(node,$button){var self=this;$button.tooltip({title:function(){return qweb.render('WidgetButton.tooltip',{debug:config.isDebug(),state:self.state,node:node,});},});},_addOnClickAction:function($el,node){if(node.attrs.special||node.attrs.confirm||node.attrs.type||$el.hasClass('oe_stat_button')){var self=this;$el.on("click",function(){self.trigger_up('button_clicked',{attrs:node.attrs,record:self.state,});});}},_applyFormSizeClass:function(){const formEl=this.$el[0];if(config.device.size_class<=config.device.SIZES.XS){formEl.classList.add('o_xxs_form_view');}else{formEl.classList.remove('o_xxs_form_view');}
if(config.device.size_class===config.device.SIZES.XXL){formEl.classList.add('o_xxl_form_view');}else{formEl.classList.remove('o_xxl_form_view');}},_getIDForLabel:function(uid){if(!this.idsForLabels[uid]){this.idsForLabels[uid]=_.uniqueId('o_field_input_');}
return this.idsForLabels[uid];},_getRecord:function(recordId){return this.state.id===recordId?this.state:null;},_postProcessField:function(widget,node){this._super.apply(this,arguments);widget[symbol]=node.attrs.id;this._setIDForLabel(widget,this._getIDForLabel(node.attrs.id));if(JSON.parse(node.attrs.default_focus||"0")){this.defaultFocusField=widget;}},_renderButtonBox:function(node){var self=this;var $result=$('<'+node.tag+'>',{class:'o_not_full'});var nextDefIndex=this.defs.length;var buttons=_.map(node.children,function(child){if(child.tag==='button'){return self._renderStatButton(child);}else{return self._renderNode(child);}});var $tempWrapper=$('<div>');_.each(buttons,function($button){$button.appendTo($tempWrapper);});var defs=this.defs.slice(nextDefIndex);Promise.all(defs).then(function(){buttons=$tempWrapper.children();var buttons_partition=_.partition(buttons,function(button){return $(button).is('.o_invisible_modifier');});var invisible_buttons=buttons_partition[0];var visible_buttons=buttons_partition[1];var nb_buttons=self._renderButtonBoxNbButtons();var unfolded_buttons=visible_buttons.slice(0,nb_buttons).concat(invisible_buttons);var folded_buttons=visible_buttons.slice(nb_buttons);if(folded_buttons.length===1){unfolded_buttons=buttons;folded_buttons=[];}
var full=(visible_buttons.length>nb_buttons);$result.toggleClass('o_full',full).toggleClass('o_not_full',!full);_.each(unfolded_buttons,function(button){$(button).appendTo($result);});if(folded_buttons.length){$result.append(dom.renderButton({attrs:{'class':'oe_stat_button o_button_more dropdown-toggle','data-toggle':'dropdown',},text:_t("More"),}));var $dropdown=$("<div>",{class:"dropdown-menu o_dropdown_more",role:"menu"});_.each(folded_buttons,function(button){$(button).addClass('dropdown-item').appendTo($dropdown);});$dropdown.appendTo($result);}});this._handleAttributes($result,node);this._registerModifiers(node,this.state,$result);return $result;},_renderButtonBoxNbButtons:function(){return[2,2,2,4][config.device.size_class]||7;},_renderFieldWidget(node){if(!this.renderInvisible&&node.attrs.modifiers.invisible===true){return $();}
return this._super(...arguments);},_renderGenericTag:function(node){var $result=$('<'+node.tag+'>',_.omit(node.attrs,'modifiers'));this._handleAttributes($result,node);this._registerModifiers(node,this.state,$result);$result.append(_.map(node.children,this._renderNode.bind(this)));return $result;},_renderHeaderButton:function(node){var $button=viewUtils.renderButtonFromNode(node);if($button.not('.btn-primary, .btn-secondary, .btn-link, .btn-success, .btn-info, .btn-warning, .btn-danger').length){$button.addClass('btn-secondary');}
this._addOnClickAction($button,node);this._handleAttributes($button,node);this._registerModifiers(node,this.state,$button);if(config.isDebug()||node.attrs.help){this._addButtonTooltip(node,$button);}
return $button;},_renderHeaderButtons:function(node){var self=this;var buttons=[];_.each(node.children,function(child){if(child.tag==='button'){buttons.push(self._renderHeaderButton(child));}
if(child.tag==='widget'){buttons.push(self._renderTagWidget(child));}});return this._renderStatusbarButtons(buttons);},_renderInnerGroup:function(node){var self=this;var $result=$('<table/>',{class:'o_group o_inner_group'});var $tbody=$('<tbody />').appendTo($result);this._handleAttributes($result,node);this._registerModifiers(node,this.state,$result);var col=parseInt(node.attrs.col,10)||this.INNER_GROUP_COL;if(node.attrs.string){var $sep=$('<tr><td colspan="'+col+'" style="width: 100%;"><div class="o_horizontal_separator">'+node.attrs.string+'</div></td></tr>');$result.append($sep);}
var rows=[];var $currentRow=$('<tr/>');var currentColspan=0;node.children.forEach(function(child){if(child.tag==='newline'){rows.push($currentRow);$currentRow=$('<tr/>');currentColspan=0;return;}
var colspan=parseInt(child.attrs.colspan,10);var isLabeledField=(child.tag==='field'&&child.attrs.nolabel!=='1');if(!colspan){if(isLabeledField){colspan=2;}else{colspan=1;}}
var finalColspan=colspan-(isLabeledField?1:0);currentColspan+=colspan;if(currentColspan>col){rows.push($currentRow);$currentRow=$('<tr/>');currentColspan=colspan;}
var $tds;if(child.tag==='field'){$tds=self._renderInnerGroupField(child);}else if(child.tag==='label'){$tds=self._renderInnerGroupLabel(child);}else{var $td=$('<td/>');var $child=self._renderNode(child);if($child.hasClass('o_td_label')){$td.addClass('o_td_label');$child.removeClass('o_td_label');}
$tds=$td.append($child);}
if(finalColspan>1){$tds.last().attr('colspan',finalColspan);}
$currentRow.append($tds);});rows.push($currentRow);_.each(rows,function($tr){var nonLabelColSize=100/(col-$tr.children('.o_td_label').length);_.each($tr.children(':not(.o_td_label)'),function(el){var $el=$(el);$el.css('width',((parseInt($el.attr('colspan'),10)||1)*nonLabelColSize)+'%');});$tbody.append($tr);});return $result;},_renderInnerGroupField:function(node){var $el=this._renderFieldWidget(node,this.state);var $tds=$('<td/>').append($el);if(node.attrs.nolabel!=='1'){var $labelTd=this._renderInnerGroupLabel(node);$tds=$labelTd.add($tds);if(/\boe_edit_only\b/.test(node.attrs.class)){$tds.addClass('oe_edit_only');}
if(/\boe_read_only\b/.test(node.attrs.class)){$tds.addClass('oe_read_only');}}
return $tds;},_renderInnerGroupLabel:function(node){return $('<td/>',{class:'o_td_label'}).append(this._renderTagLabel(node));},_renderNode:function(node){var renderer=this['_renderTag'+_.str.capitalize(node.tag)];if(renderer){return renderer.call(this,node);}
if(node.tag==='div'&&node.attrs.name==='button_box'){return this._renderButtonBox(node);}
if(_.isString(node)){return node;}
return this._renderGenericTag(node);},_renderOuterGroup:function(node){var self=this;var $result=$('<div/>',{class:'o_group'});var nbCols=parseInt(node.attrs.col,10)||this.OUTER_GROUP_COL;var colSize=Math.max(1,Math.round(12/nbCols));if(node.attrs.string){var $sep=$('<div/>',{class:'o_horizontal_separator'}).text(node.attrs.string);$result.append($sep);}
$result.append(_.map(node.children,function(child){if(child.tag==='newline'){return $('<br/>');}
var $child=self._renderNode(child);$child.addClass('o_group_col_'+(colSize*(parseInt(child.attrs.colspan,10)||1)));return $child;}));this._handleAttributes($result,node);this._registerModifiers(node,this.state,$result);return $result;},_renderStatButton:function(node){var $button=viewUtils.renderButtonFromNode(node,{extraClass:'oe_stat_button',});$button.append(_.map(node.children,this._renderNode.bind(this)));if(node.attrs.help){this._addButtonTooltip(node,$button);}
this._addOnClickAction($button,node);this._handleAttributes($button,node);this._registerModifiers(node,this.state,$button);return $button;},_renderStatusbarButtons:function(buttons){var $statusbarButtons=$('<div>',{class:'o_statusbar_buttons'});buttons.forEach(button=>$statusbarButtons.append(button));return $statusbarButtons;},_renderTabHeader:function(page,page_id){var $a=$('<a>',{'data-toggle':'tab',disable_anchor:'true',href:'#'+page_id,class:'nav-link',role:'tab',text:page.attrs.string,});return $('<li>',{class:'nav-item'}).append($a);},_renderTabPage:function(page,page_id){var $result=$('<div class="tab-pane" id="'+page_id+'">');$result.append(_.map(page.children,this._renderNode.bind(this)));return $result;},_renderTagButton:function(node){var $button=viewUtils.renderButtonFromNode(node);$button.append(_.map(node.children,this._renderNode.bind(this)));this._addOnClickAction($button,node);this._handleAttributes($button,node);this._registerModifiers(node,this.state,$button);if(config.isDebug()||node.attrs.help){this._addButtonTooltip(node,$button);}
return $button;},_renderTagField:function(node){return this._renderFieldWidget(node,this.state);},_renderTagForm:function(node){var $result=$('<div/>');if(node.attrs.class){$result.addClass(node.attrs.class);}
var allNodes=node.children.map(this._renderNode.bind(this));$result.append(allNodes);return $result;},_renderTagGroup:function(node){var isOuterGroup=_.some(node.children,function(child){return child.tag==='group';});if(!isOuterGroup){return this._renderInnerGroup(node);}
return this._renderOuterGroup(node);},_renderTagHeader:function(node){var self=this;var $statusbar=$('<div>',{class:'o_form_statusbar'});$statusbar.append(this._renderHeaderButtons(node));_.each(node.children,function(child){if(child.tag==='field'){var $el=self._renderFieldWidget(child,self.state);$statusbar.append($el);}});this._handleAttributes($statusbar,node);this._registerModifiers(node,this.state,$statusbar);return $statusbar;},_renderTagLabel:function(node){if(!this.renderInvisible&&node.tag==='field'&&node.attrs.modifiers.invisible===true){return $();}
var self=this;var text;let fieldName;if(node.tag==='label'){fieldName=this.fieldIdsToNames[node.attrs.for];}else{fieldName=node.attrs.name;}
if('string'in node.attrs){text=node.attrs.string;}else if(fieldName){text=this.state.fields[fieldName].string;}else{return this._renderGenericTag(node);}
var $result=$('<label>',{class:'o_form_label',for:this._getIDForLabel(node.tag==='label'?node.attrs.for:node.attrs.id),text:text,});if(node.tag==='label'){this._handleAttributes($result,node);}
var modifiersOptions;if(fieldName){modifiersOptions={callback:function(element,modifiers,record){var widgets=self.allFieldWidgets[record.id];var widget=_.findWhere(widgets,{name:fieldName});if(!widget){return;}
element.$el.toggleClass('o_form_label_empty',!!(record.data.id&&(modifiers.readonly||self.mode==='readonly')&&!widget.isSet()));},};}
this._registerModifiers(node,this.state,$result,modifiersOptions);return $result;},_renderTagNotebook:function(node){var self=this;var $headers=$('<ul class="nav nav-tabs">');var $pages=$('<div class="tab-content">');var renderedTabs=_.map(node.children,function(child,index){var pageID=_.uniqueId('notebook_page_');var $header=self._renderTabHeader(child,pageID);var $page=self._renderTabPage(child,pageID);self._handleAttributes($header,child);$headers.append($header);$pages.append($page);return{$header:$header,$page:$page,node:child,};});_.each(renderedTabs,function(tab){self._registerModifiers(tab.node,self.state,tab.$header,{callback:function(element,modifiers){var $link=element.$el.find('.nav-link');if(modifiers.invisible&&$link.hasClass('active')){$link.removeClass('active');tab.$page.removeClass('active');self.inactiveNotebooks.push(renderedTabs);}
if(!modifiers.invisible){var $visibleTabs=$headers.find('li:not(.o_invisible_modifier)');if($visibleTabs.length===1){self.inactiveNotebooks.push(renderedTabs);}}},});});this._activateFirstVisibleTab(renderedTabs);var $notebookHeaders=$('<div class="o_notebook_headers">').append($headers);var $notebook=$('<div class="o_notebook">').append($notebookHeaders,$pages);$notebook[0].dataset.name=node.attrs.name||'_default_';this._registerModifiers(node,this.state,$notebook);this._handleAttributes($notebook,node);return $notebook;},_renderTagSeparator:function(node){var $separator=$('<div/>').addClass('o_horizontal_separator').text(node.attrs.string);this._handleAttributes($separator,node);this._registerModifiers(node,this.state,$separator);return $separator;},_renderTagSheet:function(node){this.has_sheet=true;var $sheet=$('<div>',{class:'clearfix position-relative o_form_sheet'});$sheet.append(node.children.map(this._renderNode.bind(this)));return $sheet;},_renderTagWidget:function(node){return this._renderWidget(this.state,node);},_renderView:function(){var self=this;var defs=[];this.defs=defs;this.inactiveNotebooks=[];var $form=this._renderNode(this.arch).addClass(this.className);delete this.defs;return Promise.all(defs).then(()=>this.__renderView()).then(function(){self._updateView($form.contents());if(self.state.res_id in self.alertFields){self.displayTranslationAlert();}}).then(function(){if(self.lastActivatedFieldIndex>=0){self._activateNextFieldWidget(self.state,self.lastActivatedFieldIndex);}}).guardedCatch(function(){$form.remove();});},async __renderView(){},async _updateAllModifiers(){await this._super(...arguments);for(const tabs of this.inactiveNotebooks){this._activateFirstVisibleTab(tabs);}
this.inactiveNotebooks=[];},_updateView:function($newContent){var self=this;this.$el.html($newContent);this.$el.toggleClass('o_form_nosheet',!this.has_sheet);if(this.has_sheet){this.$el.children().not('.o_FormRenderer_chatterContainer').wrapAll($('<div/>',{class:'o_form_sheet_bg'}));}
this.$el.toggleClass('o_form_editable',this.mode==='edit');this.$el.toggleClass('o_form_readonly',this.mode==='readonly');_.each(this.allFieldWidgets[this.state.id],function(widget){const idForLabel=self.idsForLabels[widget[symbol]];var $label=idForLabel?self.$('.o_form_label[for='+idForLabel+']'):$();self._addFieldTooltip(widget,$label);if(widget.attrs.widget==='upgrade_boolean'){widget.renderWithLabel($label);}});},_setIDForLabel:function(widget,idForLabel){widget.setIDForLabel(idForLabel);},_onActivateNextWidget:function(ev){ev.stopPropagation();var index=this.allFieldWidgets[this.state.id].indexOf(ev.data.target);this._activateNextFieldWidget(this.state,index);},_onNavigationMove:function(ev){ev.stopPropagation();if(ev.data.originalEvent&&['next','previous'].includes(ev.data.direction)){ev.data.originalEvent.preventDefault();ev.data.originalEvent.stopPropagation();}
var index;let target=ev.data.target||ev.target;if(target.__owl__){target=target.__owl__.parent;}
if(ev.data.direction==="next"){index=this.allFieldWidgets[this.state.id].indexOf(target);this._activateNextFieldWidget(this.state,index);}else if(ev.data.direction==="previous"){index=this.allFieldWidgets[this.state.id].indexOf(target);this._activatePreviousFieldWidget(this.state,index);}},_onNotebookTabChanged:function(){core.bus.trigger('DOM_updated');},_onTranslate:function(ev){ev.preventDefault();this.trigger_up('translate',{fieldName:ev.target.name,id:this.state.id,isComingFromTranslationAlert:true,});},_onTranslateNotificationClose:function(ev){delete this.alertFields[this.state.res_id];},});return FormRenderer;});;

/* /web/static/src/js/views/form/form_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.FormController',function(require){"use strict";var BasicController=require('web.BasicController');var core=require('web.core');var Dialog=require('web.Dialog');var dialogs=require('web.view_dialogs');var _t=core._t;var qweb=core.qweb;var FormController=BasicController.extend({custom_events:_.extend({},BasicController.prototype.custom_events,{button_clicked:'_onButtonClicked',edited_list:'_onEditedList',open_one2many_record:'_onOpenOne2ManyRecord',open_record:'_onOpenRecord',toggle_column_order:'_onToggleColumnOrder',focus_control_button:'_onFocusControlButton',form_dialog_discarded:'_onFormDialogDiscarded',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.actionButtons=params.actionButtons;this.disableAutofocus=params.disableAutofocus;this.footerToButtons=params.footerToButtons;this.defaultButtons=params.defaultButtons;this.hasActionMenus=params.hasActionMenus;this.toolbarActions=params.toolbarActions||{};},on_attach_callback:function(){this._super.apply(this,arguments);this.autofocus();},willRestore:function(){this.mode=this.model.isNew(this.handle)?'edit':'readonly';},autofocus:function(){if(!this.disableAutofocus){var isControlActivted=this.renderer.autofocus();if(!isControlActivted){if(this.$buttons&&this.mode==='readonly'){return this.$buttons.find('.o_form_button_edit').focus();}}}},createRecord:async function(parentID,additionalContext){const record=this.model.get(this.handle,{raw:true});const handle=await this.model.load({context:record.getContext({additionalContext:additionalContext}),fields:record.fields,fieldsInfo:record.fieldsInfo,modelName:this.modelName,parentID:parentID,res_ids:record.res_ids,type:'record',viewType:'form',});this.handle=handle;this._updateControlPanel();return this._setMode('edit');},getSelectedIds:function(){var env=this.model.get(this.handle,{env:true});return env.currentId?[env.currentId]:[];},getTitle:function(){return this.model.getName(this.handle);},getState:function(){const state=this._super.apply(this,arguments);const env=this.model.get(this.handle,{env:true});state.id=env.currentId;return state;},renderButtons:function($node){var $footer=this.footerToButtons?this.renderer.$el&&this.renderer.$('footer'):null;var mustRenderFooterButtons=$footer&&$footer.length;if((this.defaultButtons&&!this.$buttons)||mustRenderFooterButtons){this.$buttons=$('<div/>');if(mustRenderFooterButtons){this.$buttons.append($footer);}else{this.$buttons.append(qweb.render("FormView.buttons",{widget:this}));this.$buttons.on('click','.o_form_button_edit',this._onEdit.bind(this));this.$buttons.on('click','.o_form_button_create',this._onCreate.bind(this));this.$buttons.on('click','.o_form_button_save',this._onSave.bind(this));this.$buttons.on('click','.o_form_button_cancel',this._onDiscard.bind(this));this._assignSaveCancelKeyboardBehavior(this.$buttons.find('.o_form_buttons_edit'));this.$buttons.find('.o_form_buttons_edit').tooltip({delay:{show:200,hide:0},title:function(){return qweb.render('SaveCancelButton.tooltip');},trigger:'manual',});}}
if(this.$buttons&&$node){this.$buttons.appendTo($node);}},_getPagingInfo:function(){if(this.model.isNew(this.handle)){return null;}
return Object.assign(this._super(...arguments),{validate:this.canBeDiscarded.bind(this),});},_getActionMenuItems:function(state){if(!this.hasActionMenus||this.mode==='edit'){return null;}
const props=this._super(...arguments);const activeField=this.model.getActiveField(state);const otherActionItems=[];if(this.archiveEnabled&&activeField in state.data){if(state.data[activeField]){otherActionItems.push({description:_t("Archive"),callback:()=>{Dialog.confirm(this,_t("Are you sure that you want to archive this record?"),{confirm_callback:()=>this._toggleArchiveState(true),});},});}else{otherActionItems.push({description:_t("Unarchive"),callback:()=>this._toggleArchiveState(false),});}}
if(this.activeActions.create&&this.activeActions.duplicate){otherActionItems.push({description:_t("Duplicate"),callback:()=>this._onDuplicateRecord(this),});}
if(this.activeActions.delete){otherActionItems.push({description:_t("Delete"),callback:()=>this._onDeleteRecord(this),});}
return Object.assign(props,{items:Object.assign(this.toolbarActions,{other:otherActionItems}),});},saveRecord:async function(){const changedFields=await this._super(...arguments);this._updateControlPanel();if(_t.database.multi_lang&&changedFields.length){var fields=this.renderer.state.fields;var data=this.renderer.state.data;var alertFields={};for(var k=0;k<changedFields.length;k++){var field=fields[changedFields[k]];var fieldData=data[changedFields[k]];if(field.translate&&fieldData&&fieldData!=='<p><br></p>'){alertFields[changedFields[k]]=field;}}
if(!_.isEmpty(alertFields)){this.renderer.updateAlertFields(alertFields);}}
return changedFields;},update:async function(params,options){if('currentId'in params&&!params.currentId){this.mode='edit';}
params=_.extend({viewType:'form',mode:this.mode},params);await this._super(params,options);this.autofocus();},updateButtons:function(){if(!this.$buttons){return;}
if(this.footerToButtons){var $footer=this.renderer.$el&&this.renderer.$('footer');if($footer&&$footer.length){this.$buttons.empty().append($footer);}}
var edit_mode=(this.mode==='edit');this.$buttons.find('.o_form_buttons_edit').toggleClass('o_hidden',!edit_mode);this.$buttons.find('.o_form_buttons_view').toggleClass('o_hidden',edit_mode);},_applyChanges:async function(){const result=await this._super.apply(this,arguments);core.bus.trigger('DOM_updated');return result;},_assignSaveCancelKeyboardBehavior:function($saveCancelButtonContainer){var self=this;$saveCancelButtonContainer.children().on('keydown',function(e){switch(e.which){case $.ui.keyCode.ENTER:e.preventDefault();self.saveRecord();break;case $.ui.keyCode.ESCAPE:e.preventDefault();self._discardChanges();break;case $.ui.keyCode.TAB:if(!e.shiftKey&&e.target.classList.contains('btn-primary')){$saveCancelButtonContainer.tooltip('show');e.preventDefault();}
break;}});},_confirmSave:function(id){if(id===this.handle){if(this.mode==='readonly'){return this.reload();}else{return this._setMode('readonly');}}else{var record=this.model.get(this.handle);var containsChangedRecord=function(value){return _.isObject(value)&&(value.id===id||_.find(value.data,containsChangedRecord));};var changedFields=_.findKey(record.data,containsChangedRecord);return this.renderer.confirmChange(record,record.id,[changedFields]);}},_disableButtons:function(){this._super.apply(this,arguments);this.renderer.disableButtons();},_enableButtons:function(){this._super.apply(this,arguments);this.renderer.enableButtons();},_onDeletedRecords:function(){var state=this.model.get(this.handle,{raw:true});if(!state.res_ids.length){this.trigger_up('history_back');}else{this._super.apply(this,arguments);}},_rejectSave:function(){if(this.mode==='readonly'){return this.reload();}
return this._super.apply(this,arguments);},_setMode:function(mode,recordID){if((recordID||this.handle)===this.handle){this.model.unfreezeOrder(this.handle);}
if(this.mode!==mode){this.renderer.resetLastActivatedField();}
return this._super.apply(this,arguments);},_shouldBounceOnClick(element){return this.mode==='readonly'&&!!element.closest('.oe_title, .o_inner_group');},_onButtonClicked:function(ev){ev.stopPropagation();var self=this;var def;this._disableButtons();function saveAndExecuteAction(){return self.saveRecord(self.handle,{stayInEdit:true,}).then(function(){var record=self.model.get(ev.data.record.id);return self._callButtonAction(attrs,record);});}
var attrs=ev.data.attrs;if(attrs.confirm){def=new Promise(function(resolve,reject){Dialog.confirm(self,attrs.confirm,{confirm_callback:saveAndExecuteAction,}).on("closed",null,resolve);});}else if(attrs.special==='cancel'){def=this._callButtonAction(attrs,ev.data.record);}else if(!attrs.special||attrs.special==='save'){def=saveAndExecuteAction();}else{console.warn('Unhandled button event',ev);return;}
def.then(function(){self._enableButtons();if(attrs.close){self.trigger_up('close_dialog');}}).guardedCatch(this._enableButtons.bind(this));},_onCreate:function(){this.createRecord();},_onDeleteRecord:function(){this._deleteRecords([this.handle]);},_onDiscard:function(){this._disableButtons();this._discardChanges().then(this._enableButtons.bind(this)).guardedCatch(this._enableButtons.bind(this));},_onDuplicateRecord:async function(){const handle=await this.model.duplicateRecord(this.handle);this.handle=handle;this._updateControlPanel();this._setMode('edit');},_onEdit:function(){this._disableButtons();this.mutex.getUnlockedDef().then(this._setMode.bind(this,'edit')).then(this._enableButtons.bind(this)).guardedCatch(this._enableButtons.bind(this));},_onEditedList:function(ev){ev.stopPropagation();if(ev.data.id){this.model.save(ev.data.id,{savePoint:true});}
this.model.freezeOrder(ev.data.id);},_onFocusControlButton:function(e){if(this.$buttons){e.stopPropagation();this.$buttons.find('.btn-primary:visible:first()').focus();}},_onFormDialogDiscarded:function(ev){ev.stopPropagation();var isFocused=this.renderer.focusLastActivatedWidget();if(ev.data.callback){ev.data.callback(_.str.toBool(isFocused));}},_onOpenOne2ManyRecord:async function(ev){ev.stopPropagation();var data=ev.data;var record;if(data.id){record=this.model.get(data.id,{raw:true});}
await this.model.mutex.getUnlockedDef();new dialogs.FormViewDialog(this,{context:data.context,domain:data.domain,fields_view:data.fields_view,model:this.model,on_saved:data.on_saved,on_remove:data.on_remove,parentID:data.parentID,readonly:data.readonly,deletable:record?data.deletable:false,recordID:record&&record.id,res_id:record&&record.res_id,res_model:data.field.relation,shouldSaveLocally:true,title:(record?_t("Open: "):_t("Create "))+(ev.target.string||data.field.string),}).open();},_onOpenRecord:function(ev){ev.stopPropagation();var self=this;var record=this.model.get(ev.data.id,{raw:true});new dialogs.FormViewDialog(self,{context:ev.data.context,fields_view:ev.data.fields_view,on_saved:ev.data.on_saved,on_remove:ev.data.on_remove,readonly:ev.data.readonly,deletable:ev.data.deletable,res_id:record.res_id,res_model:record.model,title:_t("Open: ")+ev.data.string,}).open();},_onSave:function(ev){ev.stopPropagation();this._disableButtons();this.saveRecord().then(this._enableButtons.bind(this)).guardedCatch(this._enableButtons.bind(this));},_onToggleColumnOrder:function(ev){ev.stopPropagation();var self=this;this.model.setSort(ev.data.id,ev.data.name).then(function(){var field=ev.data.field;var state=self.model.get(self.handle);self.renderer.confirmChange(state,state.id,[field]);});},_toggleArchiveState:function(archive){const resIds=this.model.localIdsToResIds([this.handle]);this._archive(resIds,archive);},});return FormController;});;

/* /web/static/src/js/views/form/form_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.FormView',function(require){"use strict";var BasicView=require('web.BasicView');var Context=require('web.Context');var core=require('web.core');var FormController=require('web.FormController');var FormRenderer=require('web.FormRenderer');const{generateID}=require('web.utils');var _lt=core._lt;var FormView=BasicView.extend({config:_.extend({},BasicView.prototype.config,{Renderer:FormRenderer,Controller:FormController,}),display_name:_lt('Form'),icon:'fa-edit',multi_record:false,withSearchBar:false,searchMenuTypes:[],viewType:'form',init:function(viewInfo,params){var hasActionMenus=params.hasActionMenus;this._super.apply(this,arguments);var mode=params.mode||(params.currentId?'readonly':'edit');this.loadParams.type='record';if(hasActionMenus===undefined){hasActionMenus=params.hasActionMenus;}
this.controllerParams.hasActionMenus=hasActionMenus;this.controllerParams.disableAutofocus=params.disable_autofocus||this.arch.attrs.disable_autofocus;this.controllerParams.toolbarActions=viewInfo.toolbar;this.controllerParams.footerToButtons=params.footerToButtons;var defaultButtons='default_buttons'in params?params.default_buttons:true;this.controllerParams.defaultButtons=defaultButtons;this.controllerParams.mode=mode;this.rendererParams.mode=mode;this.rendererParams.isFromFormViewDialog=params.isFromFormViewDialog;this.rendererParams.fieldIdsToNames=this.fieldsView.fieldIdsToNames;},getController:function(parent){return this._loadSubviews(parent).then(this._super.bind(this,parent));},_extractParamsFromAction:function(action){var params=this._super.apply(this,arguments);var inDialog=action.target==='new';var inline=action.target==='inline';var fullscreen=action.target==='fullscreen';params.withControlPanel=!(inDialog||inline);params.footerToButtons=inDialog;params.hasSearchView=inDialog?false:params.hasSearchView;params.hasActionMenus=!inDialog&&!inline;params.searchMenuTypes=inDialog?[]:params.searchMenuTypes;if(inDialog||inline||fullscreen){params.mode='edit';}else if(action.context&&action.context.form_view_initial_mode){params.mode=action.context.form_view_initial_mode;}
return params;},_loadSubviews:function(parent){var self=this;var defs=[];if(this.loadParams&&this.loadParams.fieldsInfo){var fields=this.loadParams.fields;_.each(this.loadParams.fieldsInfo.form,function(attrs,fieldName){var field=fields[fieldName];if(!field){return;}
if(field.type!=='one2many'&&field.type!=='many2many'){return;}
if(attrs.Widget.prototype.useSubview&&!attrs.__no_fetch&&!attrs.views[attrs.mode]){var context={};var regex=/'([a-z]*_view_ref)' *: *'(.*?)'/g;var matches;while(matches=regex.exec(attrs.context)){context[matches[1]]=matches[2];}
var refinedContext=_.pick(self.loadParams.context,function(value,key){return key.indexOf('_view_ref')===-1;});refinedContext.base_model_name=self.controllerParams.modelName;defs.push(parent.loadViews(field.relation,new Context(context,self.userContext,refinedContext).eval(),[[null,attrs.mode==='tree'?'list':attrs.mode]]).then(function(views){for(var viewName in views){attrs.views[viewName]=self._processFieldsView(views[viewName],viewName);attrs.views[viewName].fields=attrs.views[viewName].viewFields;self._processSubViewAttrs(attrs.views[viewName],attrs);}
self._setSubViewLimit(attrs);}));}else{self._setSubViewLimit(attrs);}});}
return Promise.all(defs);},_processArch(arch,fv){fv.fieldIdsToNames={};return this._super(...arguments);},_processNode(node,fv){if(node.tag==='field'){const name=node.attrs.name;let uid=node.attrs.id;if(!uid){uid=name in fv.fieldIdsToNames?`${name}__${generateID()}__`:name;node.attrs.id=uid;}
fv.fieldIdsToNames[uid]=name;}
return this._super(...arguments);},_setSubViewLimit:function(attrs){var view=attrs.views&&attrs.views[attrs.mode];var limit=view&&view.arch.attrs.limit&&parseInt(view.arch.attrs.limit,10);attrs.limit=limit||attrs.Widget.prototype.limit||40;},});return FormView;});;

/* /web/static/src/js/views/graph/graph_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.GraphModel',function(require){"use strict";var core=require('web.core');const{DEFAULT_INTERVAL,rankInterval}=require('web.searchUtils');var _t=core._t;var AbstractModel=require('web.AbstractModel');return AbstractModel.extend({init:function(){this._super.apply(this,arguments);this.chart=null;},__get:function(){return Object.assign({isSample:this.isSampleModel},this.chart);},__load:function(params){var groupBys=params.context.graph_groupbys||params.groupBys;this.initialGroupBys=groupBys;this.fields=params.fields;this.modelName=params.modelName;this.chart=Object.assign({context:params.context,dataPoints:[],domain:params.domain,groupBy:params.groupedBy.length?params.groupedBy:groupBys,measure:params.context.graph_measure||params.measure,mode:params.context.graph_mode||params.mode,origins:[],stacked:params.stacked,timeRanges:params.timeRanges,orderBy:params.orderBy});this._computeDerivedParams();return this._loadGraph();},__reload:function(handle,params){if('context'in params){this.chart.context=params.context;this.chart.groupBy=params.context.graph_groupbys||this.chart.groupBy;this.chart.measure=params.context.graph_measure||this.chart.measure;this.chart.mode=params.context.graph_mode||this.chart.mode;}
if('domain'in params){this.chart.domain=params.domain;}
if('groupBy'in params){this.chart.groupBy=params.groupBy.length?params.groupBy:this.initialGroupBys;}
if('measure'in params){this.chart.measure=params.measure;}
if('timeRanges'in params){this.chart.timeRanges=params.timeRanges;}
this._computeDerivedParams();if('mode'in params){this.chart.mode=params.mode;return Promise.resolve();}
if('stacked'in params){this.chart.stacked=params.stacked;return Promise.resolve();}
if('orderBy'in params){this.chart.orderBy=params.orderBy;return Promise.resolve();}
return this._loadGraph();},_computeDerivedParams:function(){this.chart.processedGroupBy=this._processGroupBy(this.chart.groupBy);const{range,rangeDescription,comparisonRange,comparisonRangeDescription,fieldName}=this.chart.timeRanges;if(range){this.chart.domains=[this.chart.domain.concat(range),this.chart.domain.concat(comparisonRange),];this.chart.origins=[rangeDescription,comparisonRangeDescription];const groupBys=this.chart.processedGroupBy.map(function(gb){return gb.split(":")[0];});this.chart.comparisonFieldIndex=groupBys.indexOf(fieldName);}else{this.chart.domains=[this.chart.domain];this.chart.origins=[""];this.chart.comparisonFieldIndex=-1;}},_isEmpty(){return this.chart.dataPoints.length===0;},_loadGraph:function(){var self=this;this.chart.dataPoints=[];var groupBy=this.chart.processedGroupBy;var fields=_.map(groupBy,function(groupBy){return groupBy.split(':')[0];});const loadId=this.loadId?++this.loadId:1;this.loadId=loadId;if(this.chart.measure!=='__count__'){if(this.fields[this.chart.measure].type==='many2one'){fields=fields.concat(this.chart.measure+":count_distinct");}
else{fields=fields.concat(this.chart.measure);}}
var context=_.extend({fill_temporal:true},this.chart.context);var proms=[];this.chart.domains.forEach(function(domain,originIndex){proms.push(self._rpc({model:self.modelName,method:'read_group',context:context,domain:domain,fields:fields,groupBy:groupBy,lazy:false,}).then(self._processData.bind(self,originIndex,loadId)));});return Promise.all(proms);},_processData:function(originIndex,loadId,rawData){if(loadId<this.loadId){return;}
var self=this;var isCount=this.chart.measure==='__count__';var labels;function getLabels(dataPt){return self.chart.processedGroupBy.map(function(field){return self._sanitizeValue(dataPt[field],field.split(":")[0]);});}
rawData.forEach(function(dataPt){labels=getLabels(dataPt);var count=dataPt.__count||dataPt[self.chart.processedGroupBy[0]+'_count']||0;var value=isCount?count:dataPt[self.chart.measure];if(value instanceof Array){value=1;}
self.chart.dataPoints.push({resId:dataPt[self.chart.groupBy[0]]instanceof Array?dataPt[self.chart.groupBy[0]][0]:-1,count:count,domain:dataPt.__domain,value:value,labels:labels,originIndex:originIndex,});});},_processGroupBy:function(groupBy){const groupBysMap=new Map();for(const gb of groupBy){let[fieldName,interval]=gb.split(':');const field=this.fields[fieldName];if(['date','datetime'].includes(field.type)){interval=interval||DEFAULT_INTERVAL;}
if(groupBysMap.has(fieldName)){const registeredInterval=groupBysMap.get(fieldName);if(rankInterval(registeredInterval)<rankInterval(interval)){groupBysMap.set(fieldName,interval);}}else{groupBysMap.set(fieldName,interval);}}
return[...groupBysMap].map(([fieldName,interval])=>{if(interval){return`${fieldName}:${interval}`;}
return fieldName;});},_sanitizeValue:function(value,fieldName){if(value===false&&this.fields[fieldName].type!=='boolean'){return _t("Undefined");}
if(value instanceof Array){return value[1];}
if(fieldName&&(this.fields[fieldName].type==='selection')){var selected=_.where(this.fields[fieldName].selection,{0:value})[0];return selected?selected[1]:value;}
return value;},});});;

/* /web/static/src/js/views/graph/graph_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.GraphController',function(require){"use strict";const AbstractController=require('web.AbstractController');const{ComponentWrapper}=require('web.OwlCompatibility');const DropdownMenu=require('web.DropdownMenu');const{DEFAULT_INTERVAL,INTERVAL_OPTIONS}=require('web.searchUtils');const{qweb}=require('web.core');const{_t}=require('web.core');class CarretDropdownMenu extends DropdownMenu{get displayCaret(){return true;}}
var GraphController=AbstractController.extend({custom_events:_.extend({},AbstractController.prototype.custom_events,{item_selected:'_onItemSelected',open_view:'_onOpenView',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.measures=params.measures;this.isEmbedded=params.isEmbedded;this.withButtons=params.withButtons;this.views=params.views;this.title=params.title;this.groupableFields=params.groupableFields;this.buttonDropdownPromises=[];},start:function(){this.$el.addClass('o_graph_controller');return this._super.apply(this,arguments);},destroy:function(){if(this.$buttons){this.$buttons.find('button').off().tooltip('dispose');}
this._super.apply(this,arguments);},getOwnedQueryParams:function(){var state=this.model.get();return{context:{graph_measure:state.measure,graph_mode:state.mode,graph_groupbys:state.groupBy,}};},reload:async function(){const promises=[this._super(...arguments)];if(this.withButtons){const state=this.model.get();this.measures.forEach(m=>m.isActive=m.fieldName===state.measure);promises.push(this.measureMenu.update({items:this.measures}));}
return Promise.all(promises);},renderButtons:function($node){this.$buttons=$(qweb.render('GraphView.buttons'));this.$buttons.find('button').tooltip();this.$buttons.click(ev=>this._onButtonClick(ev));if(this.withButtons){const state=this.model.get();const fragment=document.createDocumentFragment();this.measures.forEach(m=>m.isActive=m.fieldName===state.measure);this.measureMenu=new ComponentWrapper(this,CarretDropdownMenu,{title:_t("Measures"),items:this.measures,});this.buttonDropdownPromises=[this.measureMenu.mount(fragment)];if($node){if(this.isEmbedded){this.groupByMenu=new ComponentWrapper(this,CarretDropdownMenu,{title:_t("Group By"),icon:'fa fa-bars',items:this._getGroupBys(state.groupBy),});this.buttonDropdownPromises.push(this.groupByMenu.mount(fragment));}
this.$buttons.appendTo($node);}}},updateButtons:function(){if(!this.$buttons){return;}
var state=this.model.get();this.$buttons.find('.o_graph_button').removeClass('active');this.$buttons.find('.o_graph_button[data-mode="'+state.mode+'"]').addClass('active');this.$buttons.find('.o_graph_button[data-mode="stack"]').data('stacked',state.stacked).toggleClass('active',state.stacked).toggleClass('o_hidden',state.mode!=='bar');this.$buttons.find('.o_graph_button[data-order]').toggleClass('o_hidden',state.mode==='pie'||!!Object.keys(state.timeRanges).length).filter('.o_graph_button[data-order="'+state.orderBy+'"]').toggleClass('active',!!state.orderBy);if(this.withButtons){this._attachDropdownComponents();}},async _attachDropdownComponents(){await Promise.all(this.buttonDropdownPromises);const actionsContainer=this.$buttons[0];actionsContainer.appendChild(this.measureMenu.el);this.measureMenu.el.classList.add('o_graph_measures_list');if(this.isEmbedded){actionsContainer.appendChild(this.groupByMenu.el);this.groupByMenu.el.classList.add('o_group_by_menu');}
const buttons=actionsContainer.querySelectorAll('.o_dropdown_toggler_btn');for(const button of buttons){button.classList.remove('o_dropdown_toggler_btn','btn-secondary');if(this.isEmbedded){button.classList.add('btn-outline-secondary');}else{button.classList.add('btn-primary');button.tabIndex=0;}}},_getGroupBys(activeGroupBys){const normalizedGroupBys=this._normalizeActiveGroupBys(activeGroupBys);const groupBys=Object.keys(this.groupableFields).map(fieldName=>{const field=this.groupableFields[fieldName];const groupByActivity=normalizedGroupBys.filter(gb=>gb.fieldName===fieldName);const groupBy={id:fieldName,isActive:Boolean(groupByActivity.length),description:field.string,itemType:'groupBy',};if(['date','datetime'].includes(field.type)){groupBy.hasOptions=true;const activeOptionIds=groupByActivity.map(gb=>gb.interval);groupBy.options=Object.values(INTERVAL_OPTIONS).map(o=>{return Object.assign({},o,{isActive:activeOptionIds.includes(o.id)});});}
return groupBy;}).sort((gb1,gb2)=>{return gb1.description.localeCompare(gb2.description);});return groupBys;},_normalizeActiveGroupBys(activeGroupBys){return activeGroupBys.map(groupBy=>{const fieldName=groupBy.split(':')[0];const field=this.groupableFields[fieldName];const normalizedGroupBy={fieldName};if(['date','datetime'].includes(field.type)){normalizedGroupBy.interval=groupBy.split(':')[1]||DEFAULT_INTERVAL;}
return normalizedGroupBy;});},_onButtonClick:function(ev){var $target=$(ev.target);if($target.hasClass('o_graph_button')){if(_.contains(['bar','line','pie'],$target.data('mode'))){this.update({mode:$target.data('mode')});}else if($target.data('mode')==='stack'){this.update({stacked:!$target.data('stacked')});}else if(['asc','desc'].includes($target.data('order'))){const order=$target.data('order');const state=this.model.get();this.update({orderBy:state.orderBy===order?false:order});}}},_onItemSelected(ev){const item=ev.data.item;if(this.isEmbedded&&item.itemType==='groupBy'){const fieldName=item.id;const optionId=ev.data.option&&ev.data.option.id;const activeGroupBys=this.model.get().groupBy;if(optionId){const normalizedGroupBys=this._normalizeActiveGroupBys(activeGroupBys);const index=normalizedGroupBys.findIndex(ngb=>ngb.fieldName===fieldName&&ngb.interval===optionId);if(index===-1){activeGroupBys.push(fieldName+':'+optionId);}else{activeGroupBys.splice(index,1);}}else{const groupByFieldNames=activeGroupBys.map(gb=>gb.split(':')[0]);const indexOfGroupby=groupByFieldNames.indexOf(fieldName);if(indexOfGroupby===-1){activeGroupBys.push(fieldName);}else{activeGroupBys.splice(indexOfGroupby,1);}}
this.update({groupBy:activeGroupBys});this.groupByMenu.update({items:this._getGroupBys(activeGroupBys),});}else if(item.itemType==='measure'){this.update({measure:item.fieldName});this.measures.forEach(m=>m.isActive=m.fieldName===item.fieldName);this.measureMenu.update({items:this.measures});}},_onOpenView(ev){ev.stopPropagation();const state=this.model.get();const context=Object.assign({},state.context);Object.keys(context).forEach(x=>{if(x==='group_by'||x.startsWith('search_default_')){delete context[x];}});this.do_action({context:context,domain:ev.data.domain,name:this.title,res_model:this.modelName,target:'current',type:'ir.actions.act_window',view_mode:'list',views:this.views,});},});return GraphController;});;

/* /web/static/src/js/views/graph/graph_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.GraphRenderer',function(require){"use strict";var AbstractRenderer=require('web.AbstractRenderer');var config=require('web.config');var core=require('web.core');var dataComparisonUtils=require('web.dataComparisonUtils');var fieldUtils=require('web.field_utils');var _t=core._t;var DateClasses=dataComparisonUtils.DateClasses;var qweb=core.qweb;var CHART_TYPES=['pie','bar','line'];var COLORS=["#1f77b4","#ff7f0e","#aec7e8","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];var COLOR_NB=COLORS.length;function hexToRGBA(hex,opacity){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);var rgb=result.slice(1,4).map(function(n){return parseInt(n,16);}).join(',');return'rgba('+rgb+','+opacity+')';}
var FORMAT_OPTIONS={humanReadable:function(value){return Math.abs(value)>=1000;},minDigits:1,decimals:2,formatterCallback:function(str){return str;},};var NO_DATA=[_t('No data')];NO_DATA.isNoData=true;var FAKE_DATA=[""];FAKE_DATA.isFakeData=true;var MAX_LEGEND_LENGTH=4*(Math.max(1,config.device.size_class));return AbstractRenderer.extend({className:"o_graph_renderer",sampleDataTargets:['.o_graph_canvas_container'],init:function(parent,state,params){this._super.apply(this,arguments);this.isEmbedded=params.isEmbedded||false;this.title=params.title||'';this.fields=params.fields||{};this.disableLinking=params.disableLinking;this.chart=null;this.chartId=_.uniqueId('chart');this.$legendTooltip=null;this.$tooltip=null;},on_attach_callback:function(){this._super.apply(this,arguments);this.isInDOM=true;this._render();},on_detach_callback:function(){this._super.apply(this,arguments);this.isInDOM=false;},_adjustTooltipHeight:function(maxTooltipHeight){var sizeOneLine=this.$tooltip.find('tbody tr')[0].clientHeight;var tbodySize=this.$tooltip.find('tbody')[0].clientHeight;var toKeep=Math.floor((maxTooltipHeight-(this.$tooltip[0].clientHeight-tbodySize))/sizeOneLine)-1;var $lines=this.$tooltip.find('tbody tr');var toRemove=$lines.length-toKeep;if(toRemove>0){$lines.slice(toKeep).remove();var tr=document.createElement('tr');var td=document.createElement('td');tr.classList.add('o_show_more');td.innerHTML=_t("...");tr.appendChild(td);this.$tooltip.find('tbody').append(tr);}},_customTooltip:function(tooltipModel){this.$el.css({cursor:'default'});if(this.$tooltip){this.$tooltip.remove();}
if(tooltipModel.opacity===0){return;}
if(tooltipModel.dataPoints.length===0){return;}
if(this._isRedirectionEnabled()){this.$el.css({cursor:'pointer'});}
const chartArea=this.chart.chartArea;const chartAreaLeft=chartArea.left;const chartAreaRight=chartArea.right;const chartAreaTop=chartArea.top;const rendererTop=this.$el[0].getBoundingClientRect().top;const maxTooltipLabelWidth=Math.floor((chartAreaRight-chartAreaLeft)/1.68)+'px';const tooltipItems=this._getTooltipItems(tooltipModel);this.$tooltip=$(qweb.render('GraphView.CustomTooltip',{measure:this.fields[this.state.measure].string,tooltipItems:tooltipItems,maxWidth:maxTooltipLabelWidth,})).css({top:'2px',left:'2px'});const $container=this.$el.find('.o_graph_canvas_container');$container.append(this.$tooltip);let top;const tooltipHeight=this.$tooltip[0].clientHeight;const minTopAllowed=Math.floor(chartAreaTop);const maxTopAllowed=Math.floor(window.innerHeight-rendererTop-tooltipHeight)-2;const y=Math.floor(tooltipModel.y);if(minTopAllowed<=maxTopAllowed){if(y<=maxTopAllowed){if(y>=minTopAllowed){top=y;}else{top=minTopAllowed;}}else{top=maxTopAllowed;}}else{top=minTopAllowed;const maxTooltipHeight=window.innerHeight-(rendererTop+chartAreaTop)-2;this._adjustTooltipHeight(maxTooltipHeight);}
this.$tooltip[0].style.top=Math.floor(top)+'px';this._fixTooltipLeftPosition(this.$tooltip[0],tooltipModel.x);},_filterDataPoints:function(){var dataPoints=[];if(_.contains(['bar','pie'],this.state.mode)){dataPoints=this.state.dataPoints.filter(function(dataPt){return dataPt.count>0;});}else if(this.state.mode==='line'){var counts=0;this.state.dataPoints.forEach(function(dataPt){if(dataPt.labels[0]!==_t("Undefined")){dataPoints.push(dataPt);}
counts+=dataPt.count;});if(counts===0){dataPoints=[];}}
return dataPoints;},_fixTooltipLeftPosition:function(tooltip,x){let left;const tooltipWidth=tooltip.clientWidth;const minLeftAllowed=Math.floor(this.chart.chartArea.left+2);const maxLeftAllowed=Math.floor(this.chart.chartArea.right-tooltipWidth-2);x=Math.floor(x);if(x<=maxLeftAllowed){if(x>=minLeftAllowed){left=x;}else{left=minLeftAllowed;}}else{left=maxLeftAllowed;}
tooltip.style.left=left+'px';},_formatValue:function(value){var measureField=this.fields[this.state.measure];var formatter=fieldUtils.format.float;var formatedValue=formatter(value,measureField,FORMAT_OPTIONS);return formatedValue;},_getColor:function(index){return COLORS[index%COLOR_NB];},_getDatasetDataLength:function(originIndex,defaultLength){if(_.contains(['bar','line'],this.state.mode)&&this.state.comparisonFieldIndex===0){return this.dateClasses.dateSets[originIndex].length;}
return defaultLength;},_getDatasetLabel:function(dataPt){if(_.contains(['bar','line'],this.state.mode)){var datasetLabel=dataPt.labels.slice(1).join("/");if(this.state.origins.length>1){datasetLabel=this.state.origins[dataPt.originIndex]+
(datasetLabel?('/'+datasetLabel):'');}
datasetLabel=datasetLabel||this.fields[this.state.measure].string;return datasetLabel;}
return this.state.origins[dataPt.originIndex];},_getElementOptions:function(){var elementOptions={};if(this.state.mode==='bar'){elementOptions.rectangle={borderWidth:1};}else if(this.state.mode==='line'){elementOptions.line={tension:0,fill:false,};}
return elementOptions;},_getDateClasses:function(dataPoints){var self=this;var dateSets=this.state.origins.map(function(){return[];});dataPoints.forEach(function(dataPt){dateSets[dataPt.originIndex].push(dataPt.labels[self.state.comparisonFieldIndex]);});dateSets=dateSets.map(function(dateSet){return _.uniq(dateSet);});return new DateClasses(dateSets);},_getLabel:function(dataPt){var i=this.state.comparisonFieldIndex;if(_.contains(['bar','line'],this.state.mode)){if(i===0){return[this.dateClasses.dateClass(dataPt.originIndex,dataPt.labels[i])];}else{return dataPt.labels.slice(0,1);}}else if(i===0){return Array.prototype.concat.apply([],[this.dateClasses.dateClass(dataPt.originIndex,dataPt.labels[i]),dataPt.labels.slice(i+1)]);}else{return dataPt.labels;}},_getLegendOptions:function(datasetsCount){var legendOptions={display:datasetsCount<=MAX_LEGEND_LENGTH,position:'top',onHover:this._onlegendTooltipHover.bind(this),onLeave:this._onLegendTootipLeave.bind(this),};var self=this;if(_.contains(['bar','line'],this.state.mode)){var referenceColor;if(this.state.mode==='bar'){referenceColor='backgroundColor';}else{referenceColor='borderColor';}
legendOptions.labels={generateLabels:function(chart){var data=chart.data;return data.datasets.map(function(dataset,i){return{text:self._shortenLabel(dataset.label),fullText:dataset.label,fillStyle:dataset[referenceColor],hidden:!chart.isDatasetVisible(i),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset[referenceColor],pointStyle:dataset.pointStyle,datasetIndex:i,};});},};}else{legendOptions.labels={generateLabels:function(chart){var data=chart.data;var metaData=data.datasets.map(function(dataset,index){return chart.getDatasetMeta(index).data;});return data.labels.map(function(label,i){var hidden=metaData.reduce(function(hidden,data){if(data[i]){hidden=hidden||data[i].hidden;}
return hidden;},false);var fullText=self._relabelling(label);var text=self._shortenLabel(fullText);return{text:text,fullText:fullText,fillStyle:label.isNoData?'#d3d3d3':self._getColor(i),hidden:hidden,index:i,};});},};}
return legendOptions;},_getScaleOptions:function(){var self=this;if(_.contains(['bar','line'],this.state.mode)){return{xAxes:[{type:'category',scaleLabel:{display:this.state.processedGroupBy.length&&!this.isEmbedded,labelString:this.state.processedGroupBy.length?this.fields[this.state.processedGroupBy[0].split(':')[0]].string:'',},ticks:{callback:function(label){return self._relabelling(label);},},}],yAxes:[{type:'linear',scaleLabel:{display:!this.isEmbedded,labelString:this.fields[this.state.measure].string,},ticks:{callback:this._formatValue.bind(this),suggestedMax:0,suggestedMin:0,}}],};}
return{};},_getTooltipItemContent:function(item,data){var dataset=data.datasets[item.datasetIndex];var label=data.labels[item.index];var value;var boxColor;if(this.state.mode==='bar'){label=this._relabelling(label,dataset.originIndex);if(this.state.processedGroupBy.length>1||this.state.origins.length>1){label=label+"/"+dataset.label;}
value=this._formatValue(item.yLabel);boxColor=dataset.backgroundColor;}else if(this.state.mode==='line'){label=this._relabelling(label,dataset.originIndex);if(this.state.processedGroupBy.length>1||this.state.origins.length>1){label=label+"/"+dataset.label;}
value=this._formatValue(item.yLabel);boxColor=dataset.borderColor;}else{if(label.isNoData){value=this._formatValue(0);}else{value=this._formatValue(dataset.data[item.index]);}
label=this._relabelling(label,dataset.originIndex);if(this.state.origins.length>1){label=dataset.label+"/"+label;}
boxColor=dataset.backgroundColor[item.index];}
return{label:label,value:value,boxColor:boxColor,};},_getTooltipItems:function(tooltipModel){var self=this;var data=this.chart.config.data;var orderedItems=tooltipModel.dataPoints.sort(function(dPt1,dPt2){return dPt2.yLabel-dPt1.yLabel;});return orderedItems.reduce(function(acc,item){acc.push(self._getTooltipItemContent(item,data));return acc;},[]);},_getTooltipOptions:function(){var tooltipOptions={enabled:false,custom:this._customTooltip.bind(this),};if(this.state.mode==='line'){tooltipOptions.mode='index';tooltipOptions.intersect=false;}
return tooltipOptions;},_isRedirectionEnabled:function(){return!this.disableLinking&&(this.state.mode==='bar'||this.state.mode==='pie');},_indexOf:function(list,label){var index=-1;for(var j=0;j<list.length;j++){var otherLabel=list[j];if(label.length===otherLabel.length){var equal=true;for(var i=0;i<label.length;i++){if(label[i]!==otherLabel[i]){equal=false;}}
if(equal){index=j;break;}}}
return index;},_prepareData:function(dataPoints){var self=this;var labelMap={};var labels=dataPoints.reduce(function(acc,dataPt){var label=self._getLabel(dataPt);var labelKey=dataPt.resId+':'+JSON.stringify(label);var index=labelMap[labelKey];if(index===undefined){labelMap[labelKey]=dataPt.labelIndex=acc.length;acc.push(label);}
else{dataPt.labelIndex=index;}
return acc;},[]);var newDataset=function(datasetLabel,originIndex){var data=new Array(self._getDatasetDataLength(originIndex,labels.length)).fill(0);const domain=new Array(self._getDatasetDataLength(originIndex,labels.length)).fill([]);return{label:datasetLabel,data:data,domain:domain,originIndex:originIndex,};};var datasets=_.values(dataPoints.reduce(function(acc,dataPt){var datasetLabel=self._getDatasetLabel(dataPt);if(!(datasetLabel in acc)){acc[datasetLabel]=newDataset(datasetLabel,dataPt.originIndex);}
var labelIndex=dataPt.labelIndex;acc[datasetLabel].data[labelIndex]=dataPt.value;acc[datasetLabel].domain[labelIndex]=dataPt.domain;return acc;},{}));datasets=datasets.sort(function(dataset1,dataset2){return dataset1.originIndex-dataset2.originIndex;});return{datasets:datasets,labels:labels,};},_prepareOptions:function(datasetsCount){const options={maintainAspectRatio:false,scales:this._getScaleOptions(),legend:this._getLegendOptions(datasetsCount),tooltips:this._getTooltipOptions(),elements:this._getElementOptions(),};if(this._isRedirectionEnabled()){options.onClick=this._onGraphClicked.bind(this);}
return options;},_relabelling:function(label,originIndex){if(label.isNoData||label.isFakeData){return label[0];}
var i=this.state.comparisonFieldIndex;if(_.contains(['bar','line'],this.state.mode)&&i===0){return this.dateClasses.representative(label,originIndex)||'';}else if(this.state.mode==='pie'&&i===0){var labelCopy=label.slice(0);if(originIndex!==undefined){labelCopy.splice(i,1,this.dateClasses.representative(label[i],originIndex));}else{labelCopy.splice(i,1,this.dateClasses.dateClassMembers(label[i]));}
return labelCopy.join('/');}
return label.join('/')||_t('Total');},async _renderView(){if(this.chart){this.chart.destroy();}
this.$el.empty();if(!_.contains(CHART_TYPES,this.state.mode)){this.trigger_up('warning',{title:_t('Invalid mode for chart'),message:_t('Cannot render chart with mode : ')+this.state.mode});}
var dataPoints=this._filterDataPoints();dataPoints=this._sortDataPoints(dataPoints);if(this.isInDOM){this._renderTitle();if(this.state.mode==='pie'){const someNegative=dataPoints.some(dataPt=>dataPt.value<0);const somePositive=dataPoints.some(dataPt=>dataPt.value>0);if(someNegative&&somePositive){const context={title:_t("Invalid data"),description:[_t("Pie chart cannot mix positive and negative numbers. "),_t("Try to change your domain to only display positive results")].join("")};this._renderNoContentHelper(context);return;}}
if(this.state.isSample&&!this.isEmbedded){this._renderNoContentHelper();}
var $canvasContainer=$('<div/>',{class:'o_graph_canvas_container'});var $canvas=$('<canvas/>').attr('id',this.chartId);$canvasContainer.append($canvas);this.$el.append($canvasContainer);var i=this.state.comparisonFieldIndex;if(i===0){this.dateClasses=this._getDateClasses(dataPoints);}
if(this.state.mode==='bar'){this._renderBarChart(dataPoints);}else if(this.state.mode==='line'){this._renderLineChart(dataPoints);}else if(this.state.mode==='pie'){this._renderPieChart(dataPoints);}}},_renderBarChart:function(dataPoints){var self=this;var data=this._prepareData(dataPoints);data.datasets.forEach(function(dataset,index){dataset.stack=self.state.stacked?self.state.origins[dataset.originIndex]:undefined;var color=self._getColor(index);dataset.backgroundColor=color;});var options=this._prepareOptions(data.datasets.length);var ctx=document.getElementById(this.chartId);this.chart=new Chart(ctx,{type:'bar',data:data,options:options,});},_renderLineChart:function(dataPoints){var self=this;var data=this._prepareData(dataPoints);data.datasets.forEach(function(dataset,index){if(self.state.processedGroupBy.length<=1&&self.state.origins.length>1){if(dataset.originIndex===0){dataset.fill='origin';dataset.backgroundColor=hexToRGBA(COLORS[0],0.4);dataset.borderColor=hexToRGBA(COLORS[0],1);}else if(dataset.originIndex===1){dataset.borderColor=hexToRGBA(COLORS[1],1);}else{dataset.borderColor=self._getColor(index);}}else{dataset.borderColor=self._getColor(index);}
if(data.labels.length===1){dataset.data.unshift(undefined);}
dataset.pointBackgroundColor=dataset.borderColor;dataset.pointBorderColor='rgba(0,0,0,0.2)';});if(data.datasets.length===1&&data.datasets[0].originIndex===0){const dataset=data.datasets[0];dataset.fill='origin';dataset.backgroundColor=hexToRGBA(COLORS[0],0.4);}
data.labels=data.labels.length>1?data.labels:Array.prototype.concat.apply([],[[FAKE_DATA],data.labels,[FAKE_DATA]]);var options=this._prepareOptions(data.datasets.length);var ctx=document.getElementById(this.chartId);this.chart=new Chart(ctx,{type:'line',data:data,options:options,});},_renderPieChart:function(dataPoints){var self=this;var data={};var colors=[];const allZero=dataPoints.every(dataPt=>dataPt.value===0);if(allZero){data.labels=[NO_DATA];data.datasets=this.state.origins.map(function(origin){return{label:origin,data:[1],backgroundColor:['#d3d3d3'],};});}else{data=this._prepareData(dataPoints);colors=data.labels.map(function(label,index){return self._getColor(index);});data.datasets.forEach(function(dataset){dataset.backgroundColor=colors;dataset.borderColor='rgba(255,255,255,0.6)';});var representedOriginIndexes=data.datasets.map(function(dataset){return dataset.originIndex;});var addNoDataToLegend=false;var fakeData=(new Array(data.labels.length)).concat([1]);this.state.origins.forEach(function(origin,originIndex){if(!_.contains(representedOriginIndexes,originIndex)){data.datasets.splice(originIndex,0,{label:origin,data:fakeData,backgroundColor:colors.concat(['#d3d3d3']),});addNoDataToLegend=true;}});if(addNoDataToLegend){data.labels.push(NO_DATA);}}
var options=this._prepareOptions(data.datasets.length);var ctx=document.getElementById(this.chartId);this.chart=new Chart(ctx,{type:'pie',data:data,options:options,});},_renderTitle:function(){if(this.title){this.$el.prepend($('<label/>',{text:this.title,}));}},_shortenLabel:function(label){var groups=label.split("/");var shortLabel=groups.slice(0,3).join("/");if(shortLabel.length>30){shortLabel=shortLabel.slice(0,30)+'...';}else if(groups.length>3){shortLabel=shortLabel+'/...';}
return shortLabel;},_sortDataPoints(dataPoints){if(!Object.keys(this.state.timeRanges).length&&this.state.orderBy&&['bar','line'].includes(this.state.mode)&&this.state.groupBy.length){const groupByFieldName=this.state.groupBy[0].split(':')[0];const groupedByMany2One=this.fields[groupByFieldName].type==='many2one';const groupedDataPoints={};dataPoints.forEach(function(dataPoint){const key=groupedByMany2One?dataPoint.resId:dataPoint.labels[0];groupedDataPoints[key]=groupedDataPoints[key]||[];groupedDataPoints[key].push(dataPoint);});dataPoints=_.sortBy(groupedDataPoints,function(group){return group.reduce((sum,dataPoint)=>sum+dataPoint.value,0);});dataPoints=dataPoints.flat();if(this.state.orderBy==='desc'){dataPoints=dataPoints.reverse('value');}}
return dataPoints;},_onGraphClicked:function(ev){const activeElement=this.chart.getElementAtEvent(ev);if(activeElement.length===0){return;}
const domain=this.chart.data.datasets[activeElement[0]._datasetIndex].domain;if(!domain){return;}
this.trigger_up('open_view',{domain:domain[activeElement[0]._index],});},_onlegendTooltipHover:function(e,legendItem){e.target.style.cursor='pointer';if(legendItem.text===legendItem.fullText||this.$legendTooltip){return;}
const chartAreaLeft=this.chart.chartArea.left;const chartAreaRight=this.chart.chartArea.right;const rendererTop=this.$el[0].getBoundingClientRect().top;this.$legendTooltip=$('<div>',{class:"o_tooltip_legend",text:legendItem.fullText,css:{maxWidth:Math.floor((chartAreaRight-chartAreaLeft)/1.68)+'px',top:(e.clientY-rendererTop)+'px',}});const $container=this.$el.find('.o_graph_canvas_container');$container.append(this.$legendTooltip);this._fixTooltipLeftPosition(this.$legendTooltip[0],e.clientX);},_onLegendTootipLeave:function(e){e.target.style.cursor="";if(this.$legendTooltip){this.$legendTooltip.remove();this.$legendTooltip=null;}},});});;

/* /web/static/src/js/views/graph/graph_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.GraphView',function(require){"use strict";var AbstractView=require('web.AbstractView');var core=require('web.core');var GraphModel=require('web.GraphModel');var Controller=require('web.GraphController');var GraphRenderer=require('web.GraphRenderer');var _t=core._t;var _lt=core._lt;var searchUtils=require('web.searchUtils');var GROUPABLE_TYPES=searchUtils.GROUPABLE_TYPES;var GraphView=AbstractView.extend({display_name:_lt('Graph'),icon:'fa-bar-chart',jsLibs:['/web/static/lib/Chart/Chart.js',],config:_.extend({},AbstractView.prototype.config,{Model:GraphModel,Controller:Controller,Renderer:GraphRenderer,}),viewType:'graph',searchMenuTypes:['filter','groupBy','comparison','favorite'],init:function(viewInfo,params){this._super.apply(this,arguments);const additionalMeasures=params.additionalMeasures||[];let measure;const measures={};const measureStrings={};let groupBys=[];const groupableFields={};this.fields.__count__={string:_t("Count"),type:'integer'};this.arch.children.forEach(field=>{let fieldName=field.attrs.name;if(fieldName==="id"){return;}
const interval=field.attrs.interval;if(interval){fieldName=fieldName+':'+interval;}
if(field.attrs.type==='measure'){const{string}=this.fields[fieldName];measure=fieldName;measures[fieldName]={description:string,fieldName,groupNumber:0,isActive:false,itemType:'measure',};}else{groupBys.push(fieldName);}
if(field.attrs.string){measureStrings[fieldName]=field.attrs.string;}});for(const name in this.fields){const field=this.fields[name];if(name!=='id'&&field.store===true){if(['integer','float','monetary'].includes(field.type)||additionalMeasures.includes(name)){measures[name]={description:field.string,fieldName:name,groupNumber:0,isActive:false,itemType:'measure',};}
if(GROUPABLE_TYPES.includes(field.type)){groupableFields[name]=field;}}}
for(const name in measureStrings){if(measures[name]){measures[name].description=measureStrings[name];}}
this.arch.children.forEach(field=>{let fieldName=field.attrs.name;if(field.attrs.invisible&&py.eval(field.attrs.invisible)){groupBys=groupBys.filter(groupBy=>groupBy!==fieldName);if(fieldName in groupableFields){delete groupableFields[fieldName];}
if(!additionalMeasures.includes(fieldName)){delete measures[fieldName];}}});const sortedMeasures=Object.values(measures).sort((a,b)=>{const descA=a.description.toLowerCase();const descB=b.description.toLowerCase();return descA>descB?1:descA<descB?-1:0;});const countMeasure={description:_t("Count"),fieldName:'__count__',groupNumber:1,isActive:false,itemType:'measure',};this.controllerParams.withButtons=params.withButtons!==false;this.controllerParams.measures=[...sortedMeasures,countMeasure];this.controllerParams.groupableFields=groupableFields;this.controllerParams.title=params.title||this.arch.attrs.string||_t("Untitled");function _findView(views,viewType){const view=views.find(view=>{return view.type===viewType;});return[view?view.viewID:false,viewType];}
this.controllerParams.views=[_findView(params.actionViews,'list'),_findView(params.actionViews,'form'),];this.rendererParams.fields=this.fields;this.rendererParams.title=this.arch.attrs.title;this.rendererParams.disableLinking=!!JSON.parse(this.arch.attrs.disable_linking||'0');this.loadParams.mode=this.arch.attrs.type||'bar';this.loadParams.orderBy=this.arch.attrs.order;this.loadParams.measure=measure||'__count__';this.loadParams.groupBys=groupBys;this.loadParams.fields=this.fields;this.loadParams.comparisonDomain=params.comparisonDomain;this.loadParams.stacked=this.arch.attrs.stacked!=="False";},});return GraphView;});;

/* /web/static/src/js/views/kanban/kanban_column.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanColumn',function(require){"use strict";var config=require('web.config');var core=require('web.core');var session=require('web.session');var Dialog=require('web.Dialog');var KanbanRecord=require('web.KanbanRecord');var RecordQuickCreate=require('web.kanban_record_quick_create');var view_dialogs=require('web.view_dialogs');var viewUtils=require('web.viewUtils');var Widget=require('web.Widget');var KanbanColumnProgressBar=require('web.KanbanColumnProgressBar');var _t=core._t;var QWeb=core.qweb;var KanbanColumn=Widget.extend({template:'KanbanView.Group',custom_events:{cancel_quick_create:'_onCancelQuickCreate',quick_create_add_record:'_onQuickCreateAddRecord',tweak_column:'_onTweakColumn',tweak_column_records:'_onTweakColumnRecords',},events:{'click .o_column_edit':'_onEditColumn','click .o_column_delete':'_onDeleteColumn','click .o_kanban_quick_add':'_onAddQuickCreate','click .o_kanban_load_more':'_onLoadMore','click .o_kanban_toggle_fold':'_onToggleFold','click .o_column_archive_records':'_onArchiveRecords','click .o_column_unarchive_records':'_onUnarchiveRecords','click .o_kanban_config .dropdown-menu':'_onConfigDropdownClicked',},init:function(parent,data,options,recordOptions){this._super(parent);this.db_id=data.id;this.data_records=data.data;this.data=data;var value=data.value;this.id=data.res_id;this.folded=!data.isOpen;this.has_active_field='active'in data.fields;this.fields=data.fields;this.records=[];this.modelName=data.model;this.quick_create=options.quick_create;this.quickCreateView=options.quickCreateView;this.groupedBy=options.groupedBy;this.grouped_by_m2o=options.grouped_by_m2o;this.editable=options.editable;this.deletable=options.deletable;this.archivable=options.archivable;this.draggable=options.draggable;this.KanbanRecord=options.KanbanRecord||KanbanRecord;this.records_editable=options.records_editable;this.records_deletable=options.records_deletable;this.recordsDraggable=options.recordsDraggable;this.relation=options.relation;this.offset=0;this.remaining=data.count-this.data_records.length;this.canBeFolded=this.folded;if(options.hasProgressBar){this.barOptions={columnID:this.db_id,progressBarStates:options.progressBarStates,};}
this.record_options=_.clone(recordOptions);if(options.grouped_by_m2o||options.grouped_by_date){this.title=value?value:_t('Undefined');}else{this.title=value===undefined?_t('Undefined'):value;}
if(options.group_by_tooltip){this.tooltipInfo=_.compact(_.map(options.group_by_tooltip,function(help,field){help=help?help+"</br>":'';return(data.tooltipData&&data.tooltipData[field]&&"<div>"+help+data.tooltipData[field]+"</div>")||'';}));this.tooltipInfo=this.tooltipInfo.join("<div class='dropdown-divider' role='separator' />");}},start:function(){var self=this;var defs=[this._super.apply(this,arguments)];this.$header=this.$('.o_kanban_header');for(var i=0;i<this.data_records.length;i++){defs.push(this._addRecord(this.data_records[i]));}
if(this.recordsDraggable){this.$el.sortable({connectWith:'.o_kanban_group',containment:this.draggable?false:'parent',revert:0,delay:0,items:'> .o_kanban_record:not(.o_updating)',cursor:'move',over:function(){self.$el.addClass('o_kanban_hover');},out:function(){self.$el.removeClass('o_kanban_hover');},start:function(event,ui){ui.item.addClass('o_currently_dragged');},stop:function(event,ui){var item=ui.item;setTimeout(function(){item.removeClass('o_currently_dragged');});},update:function(event,ui){var record=ui.item.data('record');var index=self.records.indexOf(record);record.$el.removeAttr('style');if(index>=0){if($.contains(self.$el[0],record.$el[0])){self.trigger_up('kanban_column_resequence',{ids:self._getIDs()});}}else{ui.item.addClass('o_updating');self.trigger_up('kanban_column_add_record',{record:record,ids:self._getIDs()});}}});}
this.$el.click(function(event){if(self.folded){self._onToggleFold(event);}});if(this.barOptions){this.$el.addClass('o_kanban_has_progressbar');this.progressBar=new KanbanColumnProgressBar(this,this.barOptions,this.data);defs.push(this.progressBar.appendTo(this.$header));}
var title=this.folded?this.title+' ('+this.data.count+')':this.title;this.$header.find('.o_column_title').text(title);this.$el.toggleClass('o_column_folded',this.canBeFolded);if(this.tooltipInfo){this.$header.find('.o_kanban_header_title').tooltip({}).attr('data-original-title',this.tooltipInfo);}
if(!this.remaining){this.$('.o_kanban_load_more').remove();}else{this.$('.o_kanban_load_more').html(QWeb.render('KanbanView.LoadMore',{widget:this}));}
return Promise.all(defs);},on_attach_callback:function(){_.invoke(this.records,'on_attach_callback');if(this.quickCreateWidget){this.quickCreateWidget.on_attach_callback();}},addQuickCreate:async function(){if(this.folded){this.trigger_up('column_toggle_fold',{openQuickCreate:true,});return;}
if(this.quickCreateWidget){return Promise.reject();}
this.trigger_up('close_quick_create');var context=this.data.getContext();context['default_'+this.groupedBy]=viewUtils.getGroupValue(this.data,this.groupedBy);this.quickCreateWidget=new RecordQuickCreate(this,{context:context,formViewRef:this.quickCreateView,model:this.modelName,});await this.quickCreateWidget.appendTo(document.createDocumentFragment());this.trigger_up('start_quick_create');this.quickCreateWidget.$el.insertAfter(this.$header);this.quickCreateWidget.on_attach_callback();},cancelQuickCreate:function(){if(this.quickCreateWidget){this.quickCreateWidget.cancel();}},isEmpty:function(){return!this.records.length;},_addRecord:function(recordState,options){var record=new this.KanbanRecord(this,recordState,this.record_options);this.records.push(record);if(options&&options.position==='before'){return record.insertAfter(this.quickCreateWidget?this.quickCreateWidget.$el:this.$header);}else{var $load_more=this.$('.o_kanban_load_more');if($load_more.length){return record.insertBefore($load_more);}else{return record.appendTo(this.$el);}}},_cancelQuickCreate:function(){this.quickCreateWidget.destroy();this.quickCreateWidget=undefined;},_getIDs:function(){var ids=[];this.$('.o_kanban_record').each(function(index,r){ids.push($(r).data('record').id);});return ids;},_onAddQuickCreate:function(){this.trigger_up('add_quick_create',{groupId:this.db_id});},_onCancelQuickCreate:function(){this._cancelQuickCreate();},_onConfigDropdownClicked(ev){ev.stopPropagation();},_onDeleteColumn:function(event){event.preventDefault();var buttons=[{text:_t("Ok"),classes:'btn-primary',close:true,click:this.trigger_up.bind(this,'kanban_column_delete'),},{text:_t("Cancel"),close:true}];new Dialog(this,{size:'medium',buttons:buttons,$content:$('<div>',{text:_t("Are you sure that you want to remove this column ?")}),}).open();},_onEditColumn:function(event){event.preventDefault();new view_dialogs.FormViewDialog(this,{res_model:this.relation,res_id:this.id,context:session.user_context,title:_t("Edit Column"),on_saved:this.trigger_up.bind(this,'reload'),}).open();},_onLoadMore:function(event){event.preventDefault();this.trigger_up('kanban_load_more');},_onQuickCreateAddRecord:function(event){this.trigger_up('quick_create_record',event.data);},_onToggleFold:function(event){event.preventDefault();this.trigger_up('column_toggle_fold');},_onTweakColumn:function(ev){ev.data.callback(this.$el);},_onTweakColumnRecords:function(ev){_.each(this.records,function(record){ev.data.callback(record.$el,record.state.data);});},_onArchiveRecords:function(event){event.preventDefault();Dialog.confirm(this,_t("Are you sure that you want to archive all the records from this column?"),{confirm_callback:this.trigger_up.bind(this,'kanban_column_records_toggle_active',{archive:true,}),});},_onUnarchiveRecords:function(event){event.preventDefault();this.trigger_up('kanban_column_records_toggle_active',{archive:false,});}});return KanbanColumn;});;

/* /web/static/src/js/views/kanban/kanban_column_progressbar.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanColumnProgressBar',function(require){'use strict';const core=require('web.core');var session=require('web.session');var utils=require('web.utils');var Widget=require('web.Widget');const _t=core._t;var KanbanColumnProgressBar=Widget.extend({template:'KanbanView.ColumnProgressBar',events:{'click .o_kanban_counter_progress':'_onProgressBarParentClick','click .progress-bar':'_onProgressBarClick',},ANIMATE:true,init:function(parent,options,columnState){this._super.apply(this,arguments);this.columnID=options.columnID;this.columnState=columnState;this.fieldName=columnState.progressBarValues.field;this.colors=_.extend({},columnState.progressBarValues.colors,{__false:'muted',});this.sumField=columnState.progressBarValues.sum_field;var state=options.progressBarStates[this.columnID];if(state){this.groupCount=state.groupCount;this.subgroupCounts=state.subgroupCounts;this.totalCounterValue=state.totalCounterValue;this.activeFilter=state.activeFilter;}
var sumFieldInfo=this.sumField&&columnState.fieldsInfo.kanban[this.sumField];var currencyField=sumFieldInfo&&sumFieldInfo.options&&sumFieldInfo.options.currency_field;if(currencyField&&columnState.data.length){this.currency=session.currencies[columnState.data[0].data[currencyField].res_id];}},start:function(){var self=this;this.$bars={};_.each(this.colors,function(val,key){self.$bars[key]=self.$(`.progress-bar[data-filter=${key}]`);});this.$counter=this.$('.o_kanban_counter_side');this.$number=this.$counter.find('b');if(this.currency){var $currency=$('<span/>',{text:this.currency.symbol,});if(this.currency.position==='before'){$currency.prependTo(this.$counter);}else{$currency.appendTo(this.$counter);}}
return this._super.apply(this,arguments).then(function(){self.computeCounters();self._notifyState();self._render();});},computeCounters(){const subgroupCounts={};let allSubgroupCount=0;for(const key of Object.keys(this.colors)){const subgroupCount=this.columnState.progressBarValues.counts[key]||0;if(this.activeFilter===key&&subgroupCount===0){this.activeFilter=false;}
subgroupCounts[key]=subgroupCount;allSubgroupCount+=subgroupCount;};subgroupCounts.__false=this.columnState.count-allSubgroupCount;this.groupCount=this.columnState.count;this.subgroupCounts=subgroupCounts;this.prevTotalCounterValue=this.totalCounterValue;this.totalCounterValue=this.sumField?(this.columnState.aggregateValues[this.sumField]||0):this.columnState.count;},_render:function(){var self=this;this.trigger_up('tweak_column',{callback:function($el){$el.removeClass('o_kanban_group_show');_.each(self.colors,function(val,key){$el.removeClass('o_kanban_group_show_'+val);});if(self.activeFilter){$el.addClass('o_kanban_group_show o_kanban_group_show_'+self.colors[self.activeFilter]);}},});this.trigger_up('tweak_column_records',{callback:function($el,recordData){var categoryValue=recordData[self.fieldName]?recordData[self.fieldName]:'__false';_.each(self.colors,function(val,key){$el.removeClass('oe_kanban_card_'+val);});if(self.colors[categoryValue]){$el.addClass('oe_kanban_card_'+self.colors[categoryValue]);}},});var barNumber=0;var barMinWidth=6;const selection=self.columnState.fields[self.fieldName].selection;_.each(self.colors,function(val,key){var $bar=self.$bars[key];var count=self.subgroupCounts&&self.subgroupCounts[key]||0;if(!$bar){return;}
let value;if(selection){const option=selection.find(option=>option[0]===key);value=option&&option[1]||_t('Other');}else{value=key;}
$bar.attr('data-original-title',count+' '+value);$bar.tooltip({delay:0,trigger:'hover',});$bar.toggleClass('progress-bar-animated progress-bar-striped',key===self.activeFilter);$bar.removeClass('o_bar_has_records transition-off');window.getComputedStyle($bar[0]).getPropertyValue('width');if(count>0){$bar.addClass('o_bar_has_records');var maxWidth=100-barMinWidth*barNumber;self.$('.progress-bar.o_bar_has_records').css('max-width',maxWidth+'%');$bar.css('width',(count*100/self.groupCount)+'%');barNumber++;$bar.attr('aria-valuemin',0);$bar.attr('aria-valuemax',self.groupCount);$bar.attr('aria-valuenow',count);}else{$bar.css('width','');}});this.$('.progress-bar').css('min-width','');this.$('.progress-bar.o_bar_has_records').css('min-width',barMinWidth+'%');var start=this.prevTotalCounterValue;var end=this.totalCounterValue;if(this.activeFilter){if(this.sumField){end=0;_.each(self.columnState.data,function(record){var recordData=record.data;if(self.activeFilter===recordData[self.fieldName]||(self.activeFilter==='__false'&&!recordData[self.fieldName])){end+=parseFloat(recordData[self.sumField]);}});}else{end=this.subgroupCounts[this.activeFilter];}}
this.prevTotalCounterValue=end;var animationClass=start>999?'o_kanban_grow':'o_kanban_grow_huge';if(start!==undefined&&(end>start||this.activeFilter)&&this.ANIMATE){$({currentValue:start}).animate({currentValue:end},{duration:1000,start:function(){self.$counter.addClass(animationClass);},step:function(){self.$number.html(_getCounterHTML(this.currentValue));},complete:function(){self.$number.html(_getCounterHTML(this.currentValue));self.$counter.removeClass(animationClass);},});}else{this.$number.html(_getCounterHTML(end));}
function _getCounterHTML(value){return utils.human_number(value,0,3);}},_notifyState:function(){this.trigger_up('set_progress_bar_state',{columnID:this.columnID,values:{groupCount:this.groupCount,subgroupCounts:this.subgroupCounts,totalCounterValue:this.totalCounterValue,activeFilter:this.activeFilter,},});},_onProgressBarClick:function(ev){this.$clickedBar=$(ev.currentTarget);var filter=this.$clickedBar.data('filter');this.activeFilter=(this.activeFilter===filter?false:filter);this._notifyState();this._render();},_onProgressBarParentClick:function(ev){if(ev.target!==ev.currentTarget){return;}
this.activeFilter=false;this._notifyState();this._render();},});return KanbanColumnProgressBar;});;

/* /web/static/src/js/views/kanban/kanban_column_quick_create.js defined in bundle 'web.assets_backend' */
odoo.define('web.kanban_column_quick_create',function(require){"use strict";var core=require('web.core');var Dialog=require('web.Dialog');var Widget=require('web.Widget');var _t=core._t;var QWeb=core.qweb;var ColumnQuickCreate=Widget.extend({template:'KanbanView.ColumnQuickCreate',events:{'click .o_quick_create_folded':'_onUnfold','click .o_kanban_add':'_onAddClicked','click .o_kanban_examples':'_onShowExamples','keydown':'_onKeydown','keypress input':'_onKeypress','blur input':'_onInputBlur','focus input':'_onInputFocus',},init:function(parent,options){this._super.apply(this,arguments);this.applyExamplesText=options.applyExampleText||_t("Use This For My Kanban");this.examples=options.examples;this.folded=true;this.isMobile=false;},start:function(){this.$quickCreateFolded=this.$('.o_quick_create_folded');this.$quickCreateUnfolded=this.$('.o_quick_create_unfolded');this.$input=this.$('input');core.bus.on('click',this,this._onWindowClicked);this._update();return this._super.apply(this,arguments);},on_attach_callback:function(){if(!this.folded){this.$input.focus();}},toggleFold:function(){this.folded=!this.folded;this._update();if(!this.folded){this.$input.focus();this.trigger_up('scrollTo',{selector:'.o_column_quick_create'});}},_add:function(){var value=this.$input.val().trim();if(!value.length){this._cancel();return;}
this.$input.val('');this.trigger_up('quick_create_add_column',{value:value});this.$input.focus();},_cancel:function(){if(!this.folded){this.$input.val('');this.folded=true;this._update();}},_update:function(){this.$quickCreateFolded.toggle(this.folded);this.$quickCreateUnfolded.toggle(!this.folded);this.trigger_up('quick_create_column_updated');},_onAddClicked:function(event){event.stopPropagation();this._add();},_onInputBlur:function(){this.$('.o_discard_msg').hide();},_onInputFocus:function(){this.$('.o_discard_msg').show();},_onKeydown:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){this._cancel();}},_onKeypress:function(event){if(event.keyCode===$.ui.keyCode.ENTER){this._add();}},_onShowExamples:function(){var self=this;var dialog=new Dialog(this,{$content:$(QWeb.render('KanbanView.ExamplesDialog',{examples:this.examples,})),buttons:[{classes:'btn-primary float-right',text:this.applyExamplesText,close:true,click:function(){const activeExample=self.examples[this.$('.nav-link.active').data("exampleIndex")];activeExample.columns.forEach(column=>{self.trigger_up('quick_create_add_column',{value:column.toString(),foldQuickCreate:true});});}},{classes:'btn-secondary float-right',close:true,text:_t('Close'),}],size:"large",title:"Kanban Examples",}).open();dialog.on('closed',this,function(){self.$input.focus();});},_onUnfold:function(){if(this.folded){this.toggleFold();}},_onWindowClicked:function(event){if(!document.contains(this.el)){return;}
if($(event.target).closest('.modal').length){return;}
if(this.el.contains(event.target)){return;}
this._cancel();},});return ColumnQuickCreate;});;

/* /web/static/src/js/views/kanban/kanban_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanModel',function(require){"use strict";var BasicModel=require('web.BasicModel');var viewUtils=require('web.viewUtils');var KanbanModel=BasicModel.extend({addRecordToGroup:function(groupID,resId){var self=this;var group=this.localData[groupID];var new_record=this._makeDataPoint({res_id:resId,modelName:group.model,fields:group.fields,fieldsInfo:group.fieldsInfo,viewType:group.viewType,parentID:groupID,});var def=this._fetchRecord(new_record).then(function(result){group.data.unshift(new_record.id);group.res_ids.unshift(resId);group.count++;self.localData[group.parentID].count++;self._updateParentResIDs(group);return result.id;});return this._reloadProgressBarGroupFromRecord(new_record.id,def);},createGroup:function(name,parentID){var self=this;var parent=this.localData[parentID];var groupBy=parent.groupedBy[0];var groupByField=parent.fields[groupBy];if(!groupByField||groupByField.type!=='many2one'){return Promise.reject();}
return this._rpc({model:groupByField.relation,method:'name_create',args:[name],context:parent.context,}).then(function(result){const createGroupDataPoint=(model,parent)=>{const newGroup=model._makeDataPoint({modelName:parent.model,context:parent.context,domain:parent.domain.concat([[groupBy,"=",result[0]]]),fields:parent.fields,fieldsInfo:parent.fieldsInfo,isOpen:true,limit:parent.limit,parentID:parent.id,openGroupByDefault:true,orderedBy:parent.orderedBy,value:result,viewType:parent.viewType,});if(parent.progressBar){newGroup.progressBarValues=_.extend({counts:{},},parent.progressBar);}
return newGroup;};const newGroup=createGroupDataPoint(self,parent);parent.data.push(newGroup.id);if(self.isInSampleMode()){const sampleParent=self.sampleModel.localData[parentID];const newSampleGroup=createGroupDataPoint(self.sampleModel,sampleParent);sampleParent.data.push(newSampleGroup.id);}
return newGroup.id;});},createRecordInGroup:function(groupID,values){var self=this;var group=this.localData[groupID];var context=this._getContext(group);var parent=this.localData[group.parentID];var groupedBy=parent.groupedBy;context['default_'+groupedBy]=viewUtils.getGroupValue(group,groupedBy);var def;if(Object.keys(values).length===1&&'display_name'in values){def=this._rpc({model:parent.model,method:'name_create',args:[values.display_name],context:context,}).then(function(records){return records[0];});}else{def=this._rpc({model:parent.model,method:'create',args:[values],context:context,});}
return def.then(function(resID){return self.addRecordToGroup(group.id,resID);});},__get:function(){var result=this._super.apply(this,arguments);var dp=result&&this.localData[result.id];if(dp){if(dp.tooltipData){result.tooltipData=$.extend(true,{},dp.tooltipData);}
if(dp.progressBarValues){result.progressBarValues=$.extend(true,{},dp.progressBarValues);}
if(dp.fields[dp.groupedBy[0]]){var groupedByM2O=dp.fields[dp.groupedBy[0]].type==='many2one';result.isGroupedByM2ONoColumn=!dp.data.length&&groupedByM2O;}else{result.isGroupedByM2ONoColumn=false;}}
return result;},getColumn:function(id){var element=this.localData[id];if(element){return this.get(element.parentID);}
return null;},__load:function(params){this.defaultGroupedBy=params.groupBy||[];params.groupedBy=(params.groupedBy&&params.groupedBy.length)?params.groupedBy:this.defaultGroupedBy;return this._super(params);},loadMore:function(groupID){var group=this.localData[groupID];var offset=group.loadMoreOffset+group.limit;return this.reload(group.id,{loadMoreOffset:offset,});},moveRecord:function(recordID,groupID,parentID){var self=this;var parent=this.localData[parentID];var new_group=this.localData[groupID];var changes={};var groupedFieldName=parent.groupedBy[0];var groupedField=parent.fields[groupedFieldName];if(groupedField.type==='many2one'){changes[groupedFieldName]={id:new_group.res_id,display_name:new_group.value,};}else if(groupedField.type==='selection'){var value=_.findWhere(groupedField.selection,{1:new_group.value});changes[groupedFieldName]=value&&value[0]||false;}else{changes[groupedFieldName]=new_group.value;}
var record=self.localData[recordID];var resID=record.res_id;var old_group;for(var i=0;i<parent.data.length;i++){old_group=self.localData[parent.data[i]];var index=_.indexOf(old_group.data,recordID);if(index>=0){old_group.data.splice(index,1);old_group.count--;old_group.res_ids=_.without(old_group.res_ids,resID);self._updateParentResIDs(old_group);break;}}
new_group.data.push(recordID);new_group.res_ids.push(resID);new_group.count++;return this.notifyChanges(recordID,changes).then(function(){return self.save(recordID);}).then(function(){record.parentID=new_group.id;return[old_group.id,new_group.id];});},reload:function(id,options){if(options&&options.groupBy&&!options.groupBy.length){options.groupBy=this.defaultGroupedBy;}
return this._super(id,options);},__reload:function(id,options){var def=this._super(id,options);if(options&&options.loadMoreOffset){return def;}
return this._reloadProgressBarGroupFromRecord(id,def);},save:function(recordID){var def=this._super.apply(this,arguments);return this._reloadProgressBarGroupFromRecord(recordID,def);},_makeDataPoint:function(params){var dataPoint=this._super.apply(this,arguments);if(params.progressBar){dataPoint.progressBar=params.progressBar;}
return dataPoint;},_load:function(dataPoint,options){if(dataPoint.groupedBy.length&&dataPoint.progressBar){return this._readProgressBarGroup(dataPoint,options);}
return this._super.apply(this,arguments);},_readGroup:function(list){var self=this;if(list.groupedBy.length>1){list.groupedBy=[list.groupedBy[0]];}
return this._super.apply(this,arguments).then(function(result){return self._readTooltipFields(list).then(_.constant(result));});},_readProgressBarGroup:function(list,options){var self=this;var groupsDef=this._readGroup(list,options);var progressBarDef=this._rpc({model:list.model,method:'read_progress_bar',kwargs:{domain:list.domain,group_by:list.groupedBy[0],progress_bar:list.progressBar,context:list.context,},});return Promise.all([groupsDef,progressBarDef]).then(function(results){var data=results[1];_.each(list.data,function(groupID){var group=self.localData[groupID];group.progressBarValues=_.extend({counts:data[group.value]||{},},list.progressBar);});return list;});},_readTooltipFields:function(list){var self=this;var groupedByField=list.fields[list.groupedBy[0].split(':')[0]];if(groupedByField.type!=='many2one'){return Promise.resolve();}
var groupIds=_.reduce(list.data,function(groupIds,id){var res_id=self.get(id,{raw:true}).res_id;if(res_id){groupIds.push(res_id);}
return groupIds;},[]);var tooltipFields=[];var groupedByFieldInfo=list.fieldsInfo.kanban[list.groupedBy[0]];if(groupedByFieldInfo&&groupedByFieldInfo.options){tooltipFields=Object.keys(groupedByFieldInfo.options.group_by_tooltip||{});}
if(groupIds.length&&tooltipFields.length){var fieldNames=_.union(['display_name'],tooltipFields);return this._rpc({model:groupedByField.relation,method:'read',args:[groupIds,fieldNames],context:list.context,}).then(function(result){_.each(list.data,function(id){var dp=self.localData[id];dp.tooltipData=_.findWhere(result,{id:dp.res_id});});});}
return Promise.resolve();},_reloadProgressBarGroupFromRecord:function(recordID,def){var element=this.localData[recordID];if(element.type==='list'&&!element.parentID){return def;}
var self=this;while(element){if(element.progressBar){return def.then(function(data){return self._load(element,{keepEmptyGroups:true,onlyGroups:true,}).then(function(){return data;});});}
element=this.localData[element.parentID];}
return def;},});return KanbanModel;});;

/* /web/static/src/js/views/kanban/kanban_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanController',function(require){"use strict";var BasicController=require('web.BasicController');var Context=require('web.Context');var core=require('web.core');var Dialog=require('web.Dialog');var Domain=require('web.Domain');var view_dialogs=require('web.view_dialogs');var viewUtils=require('web.viewUtils');var _t=core._t;var qweb=core.qweb;var KanbanController=BasicController.extend({buttons_template:'KanbanView.buttons',custom_events:_.extend({},BasicController.prototype.custom_events,{add_quick_create:'_onAddQuickCreate',quick_create_add_column:'_onAddColumn',quick_create_record:'_onQuickCreateRecord',resequence_columns:'_onResequenceColumn',button_clicked:'_onButtonClicked',kanban_record_delete:'_onRecordDelete',kanban_record_update:'_onUpdateRecord',kanban_column_delete:'_onDeleteColumn',kanban_column_add_record:'_onAddRecordToColumn',kanban_column_resequence:'_onColumnResequence',kanban_load_more:'_onLoadMore',column_toggle_fold:'_onToggleColumn',kanban_column_records_toggle_active:'_onToggleActiveRecords',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.on_create=params.on_create;this.hasButtons=params.hasButtons;this.quickCreateEnabled=params.quickCreateEnabled;},renderButtons:function($node){if(!this.hasButtons||!this.is_action_enabled('create')){return;}
this.$buttons=$(qweb.render(this.buttons_template,{btnClass:'btn-primary',widget:this,}));this.$buttons.on('click','button.o-kanban-button-new',this._onButtonNew.bind(this));this.$buttons.on('keydown',this._onButtonsKeyDown.bind(this));if($node){this.$buttons.appendTo($node);}},updateButtons:function(){if(!this.$buttons){return;}
var state=this.model.get(this.handle,{raw:true});var createHidden=this.is_action_enabled('group_create')&&state.isGroupedByM2ONoColumn;this.$buttons.find('.o-kanban-button-new').toggleClass('o_hidden',createHidden);},_addQuickCreate(groupId){this._removeSampleData(async()=>{await this.update({shouldUpdateSearchComponents:false},{reload:false});return this.renderer.addQuickCreate(groupId);});},_confirmSave:function(id){var data=this.model.get(this.handle,{raw:true});var grouped=data.groupedBy.length;if(grouped){var columnState=this.model.getColumn(id);return this.renderer.updateColumn(columnState.id,columnState);}
return this.renderer.updateRecord(this.model.get(id));},_getPagingInfo:function(state){if(!(state.count&&!state.groupedBy.length)){return null;}
return this._super(...arguments);},_reloadAfterButtonClick:function(kanbanRecord,params){var self=this;var recordModel=this.model.localData[params.record.id];var group=this.model.localData[recordModel.parentID];var parent=this.model.localData[group.parentID];this.model.reload(params.record.id).then(function(db_id){var data=self.model.get(db_id);kanbanRecord.update(data);var domain=(parent?parent.domain:group.domain)||[];var domInData=_.every(domain,function(d){return d[0]in data.data;});var activeInDomain=_.pluck(domain,0).indexOf('active')!==-1;var activeInData='active'in data.data;if(domInData&&!activeInDomain&&activeInData){domain=domain.concat([['active','=',true]]);}else if(!domInData&&!activeInDomain&&activeInData){domain=[['active','=',true]];}
try{var visible=new Domain(domain).compute(data.evalContext);}catch(e){return;}
if(!visible){kanbanRecord.destroy();}});},_resequenceColumns:function(ids){var state=this.model.get(this.handle,{raw:true});var model=state.fields[state.groupedBy[0]].relation;return this.model.resequence(model,ids,this.handle);},_resequenceRecords:function(column_id,ids){var self=this;return this.model.resequence(this.modelName,ids,column_id);},_shouldBounceOnClick(element){const state=this.model.get(this.handle,{raw:true});if(!state.count||state.isSample){const classesList=['o_kanban_view','o_kanban_group','o_kanban_header','o_column_quick_create','o_view_nocontent_smiling_face',];return classesList.some(c=>element.classList.contains(c));}
return false;},_onAddColumn:function(ev){var self=this;this.mutex.exec(function(){return self.model.createGroup(ev.data.value,self.handle).then(function(){var state=self.model.get(self.handle,{raw:true});var ids=_.pluck(state.data,'res_id').filter(_.isNumber);return self._resequenceColumns(ids);}).then(function(){return self.update({},{reload:false});}).then(function(){let quickCreateFolded=self.renderer.quickCreate.folded;if(ev.data.foldQuickCreate?!quickCreateFolded:quickCreateFolded){self.renderer.quickCreateToggleFold();}
self.renderer.trigger_up("quick_create_column_created");});});},_onAddRecordToColumn:function(ev){var self=this;var record=ev.data.record;var column=ev.target;this.alive(this.model.moveRecord(record.db_id,column.db_id,this.handle)).then(function(column_db_ids){return self._resequenceRecords(column.db_id,ev.data.ids).then(function(){_.each(column_db_ids,function(db_id){var data=self.model.get(db_id);self.renderer.updateColumn(db_id,data);});});}).guardedCatch(this.reload.bind(this));},_onAddQuickCreate(ev){ev.stopPropagation();this._addQuickCreate(ev.data.groupId);},_onButtonClicked:function(ev){var self=this;ev.stopPropagation();var attrs=ev.data.attrs;var record=ev.data.record;var def=Promise.resolve();if(attrs.context){attrs.context=new Context(attrs.context).set_eval_context({active_id:record.res_id,active_ids:[record.res_id],active_model:record.model,});}
if(attrs.confirm){def=new Promise(function(resolve,reject){Dialog.confirm(this,attrs.confirm,{confirm_callback:resolve,cancel_callback:reject,}).on("closed",null,reject);});}
def.then(function(){self.trigger_up('execute_action',{action_data:attrs,env:{context:record.getContext(),currentID:record.res_id,model:record.model,resIDs:record.res_ids,},on_closed:self._reloadAfterButtonClick.bind(self,ev.target,ev.data),});});},_onButtonNew:function(){var state=this.model.get(this.handle,{raw:true});var quickCreateEnabled=this.quickCreateEnabled&&viewUtils.isQuickCreateEnabled(state);if(this.on_create==='quick_create'&&quickCreateEnabled&&state.data.length){this.mutex.getUnlockedDef().then(this._addQuickCreate.bind(this,null));}else if(this.on_create&&this.on_create!=='quick_create'){this.do_action(this.on_create,{on_close:this.reload.bind(this,{}),additional_context:state.context,});}else{this.trigger_up('switch_view',{view_type:'form',res_id:undefined});}},_onButtonsKeyDown:function(ev){switch(ev.keyCode){case $.ui.keyCode.DOWN:this._giveFocus();}},_onColumnResequence:function(ev){this._resequenceRecords(ev.target.db_id,ev.data.ids);},_onDeleteColumn:function(ev){var column=ev.target;var state=this.model.get(this.handle,{raw:true});var relatedModelName=state.fields[state.groupedBy[0]].relation;this.model.deleteRecords([column.db_id],relatedModelName).then(this.update.bind(this,{},{}));},_onLoadMore:function(ev){var self=this;var column=ev.target;this.model.loadMore(column.db_id).then(function(db_id){var data=self.model.get(db_id);self.renderer.updateColumn(db_id,data);});},_onQuickCreateRecord:function(ev){var self=this;var values=ev.data.values;var column=ev.target;var onFailure=ev.data.onFailure||function(){};var update=function(db_id){var columnState=self.model.getColumn(db_id);var state=self.model.get(self.handle);return self.renderer.updateColumn(columnState.id,columnState,{openQuickCreate:true,state:state}).then(function(){if(ev.data.openRecord){self.trigger_up('open_record',{id:db_id,mode:'edit'});}});};this.model.createRecordInGroup(column.db_id,values).then(update).guardedCatch(function(reason){reason.event.preventDefault();var columnState=self.model.get(column.db_id,{raw:true});var context=columnState.getContext();var state=self.model.get(self.handle,{raw:true});var groupedBy=state.groupedBy[0];context['default_'+groupedBy]=viewUtils.getGroupValue(columnState,groupedBy);new view_dialogs.FormViewDialog(self,{res_model:state.model,context:_.extend({default_name:values.name||values.display_name},context),title:_t("Create"),disable_multiple_selection:true,on_saved:function(record){self.model.addRecordToGroup(column.db_id,record.res_id).then(update);},}).open().opened(onFailure);});},_onRecordDelete:function(ev){this._deleteRecords([ev.data.id]);},_onResequenceColumn:function(ev){var self=this;this._resequenceColumns(ev.data.ids);},_onToggleColumn:function(ev){var self=this;const columnID=ev.target.db_id||ev.data.db_id;this.model.toggleGroup(columnID).then(function(db_id){var data=self.model.get(db_id);var options={openQuickCreate:!!ev.data.openQuickCreate,};return self.renderer.updateColumn(db_id,data,options);}).then(function(){if(ev.data.onSuccess){ev.data.onSuccess();}});},_onUpdateRecord:function(ev){var onSuccess=ev.data.onSuccess;delete ev.data.onSuccess;var changes=_.clone(ev.data);ev.data.force_save=true;this._applyChanges(ev.target.db_id,changes,ev).then(onSuccess);},_onToggleActiveRecords:function(ev){var self=this;var archive=ev.data.archive;var column=ev.target;var recordIds=_.pluck(column.records,'id');if(recordIds.length){var prom=archive?this.model.actionArchive(recordIds,column.db_id):this.model.actionUnarchive(recordIds,column.db_id);prom.then(function(dbID){var data=self.model.get(dbID);if(data){self.model.reload(self.handle).then(function(){const state=self.model.get(self.handle);self.renderer.updateColumn(dbID,data,{state});});}});}},});return KanbanController;});;

/* /web/static/src/js/views/kanban/kanban_examples_registry.js defined in bundle 'web.assets_backend' */
odoo.define('web.kanban_examples_registry',function(require){"use strict";var Registry=require('web.Registry');return new Registry();});;

/* /web/static/src/js/views/kanban/kanban_record.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanRecord',function(require){"use strict";var config=require('web.config');var core=require('web.core');var Domain=require('web.Domain');var Dialog=require('web.Dialog');var field_utils=require('web.field_utils');const FieldWrapper=require('web.FieldWrapper');var utils=require('web.utils');var Widget=require('web.Widget');var widgetRegistry=require('web.widget_registry');var _t=core._t;var QWeb=core.qweb;var KANBAN_RECORD_COLORS=require('web.basic_fields').FieldColorPicker.prototype.RECORD_COLORS;var NB_KANBAN_RECORD_COLORS=KANBAN_RECORD_COLORS.length;var KanbanRecord=Widget.extend({events:{'click .oe_kanban_action':'_onKanbanActionClicked','click .o_kanban_manage_toggle_button':'_onManageTogglerClicked',},init:function(parent,state,options){this._super(parent);this.fields=state.fields;this.fieldsInfo=state.fieldsInfo.kanban;this.modelName=state.model;this.options=options;this.editable=options.editable;this.deletable=options.deletable;this.read_only_mode=options.read_only_mode;this.selectionMode=options.selectionMode;this.qweb=options.qweb;this.subWidgets={};this._setState(state);this._onKanbanActionClicked=_.debounce(this._onKanbanActionClicked,300,true);},start:function(){return Promise.all([this._super.apply(this,arguments),this._render()]);},on_attach_callback:function(){this.isInDOM=true;_.invoke(this.subWidgets,'on_attach_callback');},on_detach_callback:function(){this.isInDOM=false;_.invoke(this.subWidgets,'on_detach_callback');},update:function(state){_.invoke(_.pluck(this.subWidgets,'$el'),'detach');this._setState(state);return this._render();},_attachTooltip:function(){var self=this;this.$('[tooltip]').each(function(){var $el=$(this);var tooltip=$el.attr('tooltip');if(tooltip){$el.tooltip({title:self.qweb.render(tooltip,self.qweb_context)});}});},_computeDomain:function(d){return new Domain(d).compute(this.state.evalContext);},_getColorClassname:function(variable){var color=this._getColorID(variable);return'oe_kanban_color_'+color;},_getColorID:function(variable){if(typeof variable==='number'){return Math.round(variable)%NB_KANBAN_RECORD_COLORS;}
if(typeof variable==='string'){var index=0;for(var i=0;i<variable.length;i++){index+=variable.charCodeAt(i);}
return index%NB_KANBAN_RECORD_COLORS;}
return 0;},_getColorname:function(variable){var colorID=this._getColorID(variable);return KANBAN_RECORD_COLORS[colorID];},file_type_magic_word:{'/':'jpg','R':'gif','i':'png','P':'svg+xml',},_getImageURL:function(model,field,id,placeholder){id=(_.isArray(id)?id[0]:id)||null;var isCurrentRecord=this.modelName===model&&(this.recordData.id===id||(!this.recordData.id&&!id));var url;if(isCurrentRecord&&this.record[field]&&this.record[field].raw_value&&!utils.is_bin_size(this.record[field].raw_value)){url='data:image/'+this.file_type_magic_word[this.record[field].raw_value[0]]+';base64,'+this.record[field].raw_value;}else if(placeholder&&(!model||!field||!id||(isCurrentRecord&&this.record[field]&&!this.record[field].raw_value))){url=placeholder;}else{var session=this.getSession();var params={model:model,field:field,id:id};if(isCurrentRecord){params.unique=this.record.__last_update&&this.record.__last_update.value.replace(/[^0-9]/g,'');}
url=session.url('/web/image',params);}
return url;},_openRecord:function(){if(this.$el.hasClass('o_currently_dragged')){return;}
var editMode=this.$el.hasClass('oe_kanban_global_click_edit');this.trigger_up('open_record',{id:this.db_id,mode:editMode?'edit':'readonly',});},_processFields:function(){var self=this;this.$("field").each(function(){var $field=$(this);var field_name=$field.attr("name");var field_widget=$field.attr("widget");if(field_widget||self.fields[field_name].type==='many2many'){var widget=self.subWidgets[field_name];if(!widget){var Widget=self.fieldsInfo[field_name].Widget;if(Widget){widget=self._processWidget($field,field_name,Widget);self.subWidgets[field_name]=widget;}else if(config.isDebug()){$field.replaceWith($('<span>',{text:_.str.sprintf(_t('[No widget %s]'),field_widget),}));}}else{widget.reset(self.state);$field.replaceWith(widget.$el);if(self.isInDOM&&widget.on_attach_callback){widget.on_attach_callback();}}}else{self._processField($field,field_name);}});},_processField:function($field,field_name){var field=this.fields[field_name];var value=this.recordData[field_name];var options={data:this.recordData,forceString:true};var formatted_value=field_utils.format[field.type](value,field,options);var $result=$('<span>',{text:formatted_value,});$field.replaceWith($result);this._setFieldDisplay($result,field_name);return $result;},_processWidget:function($field,field_name,Widget){var self=this;var attrs=Object.create(null);_.each(this.fieldsInfo[field_name],function(value,key){if(_.str.startsWith(key,'t-att-')){key=key.slice(6);value=$field.attr(key);}
attrs[key]=value;});var options=_.extend({},this.options,{attrs:attrs});let widget;let def;if(utils.isComponent(Widget)){widget=new FieldWrapper(this,Widget,{fieldName:field_name,record:this.state,options:options,});def=widget.mount(document.createDocumentFragment()).then(()=>{$field.replaceWith(widget.$el);});}else{widget=new Widget(this,field_name,this.state,options);def=widget.replace($field);}
this.defs.push(def);def.then(function(){self._setFieldDisplay(widget.$el,field_name);});return widget;},_processWidgets:function(){var self=this;this.$("widget").each(function(){var $field=$(this);var Widget=widgetRegistry.get($field.attr('name'));var widget=new Widget(self,self.state);var def=widget._widgetRenderAndInsert(function(){});self.defs.push(def);def.then(function(){$field.replaceWith(widget.$el);widget.$el.addClass('o_widget');});});},_render:function(){this.defs=[];_.invoke(this.subWidgets,'on_detach_callback');this._replaceElement(this.qweb.render('kanban-box',this.qweb_context));this.$el.addClass('o_kanban_record').attr("tabindex",0);this.$el.attr('role','article');this.$el.data('record',this);if(this.selectionMode){this.$el.addClass('oe_kanban_global_click');}
if(this.$el.hasClass('oe_kanban_global_click')||this.$el.hasClass('oe_kanban_global_click_edit')){this.$el.on('click',this._onGlobalClick.bind(this));this.$el.on('keydown',this._onKeyDownCard.bind(this));}else{this.$el.on('keydown',this._onKeyDownOpenFirstLink.bind(this));}
this._processFields();this._processWidgets();this._setupColor();this._setupColorPicker();this._attachTooltip();this.$('span.o_tag').tooltip({delay:{'show':50}});return Promise.all(this.defs);},_setCoverImage:function(fieldName,autoOpen){var self=this;this._rpc({model:'ir.attachment',method:'search_read',domain:[['res_model','=',this.modelName],['res_id','=',this.id],['mimetype','ilike','image']],fields:['id','name'],}).then(function(attachmentIds){self.imageUploadID=_.uniqueId('o_cover_image_upload');self.accepted_file_extensions='image/*';self.attachment_count=attachmentIds.length;var coverId=self.record[fieldName]&&self.record[fieldName].raw_value;var $content=$(QWeb.render('KanbanView.SetCoverModal',{coverId:coverId,attachmentIds:attachmentIds,widget:self,}));var $imgs=$content.find('.o_kanban_cover_image');var dialog=new Dialog(self,{title:_t("Set a Cover Image"),$content:$content,buttons:[{text:_t("Select"),classes:attachmentIds.length?'btn-primary':'d-none',close:true,disabled:!coverId,click:function(){var $img=$imgs.filter('.o_selected').find('img');var data={};data[fieldName]={id:$img.data('id'),display_name:$img.data('name')};self.trigger_up('kanban_record_update',data);},},{text:_t('Upload and Set'),classes:attachmentIds.length?'':'btn-primary',close:false,click:function(){$content.find('input.o_input_file').click();},},{text:_t("Remove Cover Image"),classes:coverId?'':'d-none',close:true,click:function(){var data={};data[fieldName]=false;self.trigger_up('kanban_record_update',data);},},{text:_t("Discard"),close:true,}],});dialog.opened().then(function(){var $selectBtn=dialog.$footer.find('.btn-primary');if(autoOpen&&!self.attachment_count){$selectBtn.click();}
$content.on('click','.o_kanban_cover_image',function(ev){$imgs.not(ev.currentTarget).removeClass('o_selected');$selectBtn.prop('disabled',!$(ev.currentTarget).toggleClass('o_selected').hasClass('o_selected'));});$content.on('dblclick','.o_kanban_cover_image',function(ev){var $img=$(ev.currentTarget).find('img');var data={};data[fieldName]={id:$img.data('id'),display_name:$img.data('name')};self.trigger_up('kanban_record_update',data);dialog.close();});$content.on('change','input.o_input_file',function(){$content.find('form.o_form_binary_form').submit();});$(window).on(self.imageUploadID,function(){var images=Array.prototype.slice.call(arguments,1);var data={};data[fieldName]={id:images[0].id,display_name:images[0].filename};self.trigger_up('kanban_record_update',data);dialog.close();});});dialog.open();});},_setFieldDisplay:function($el,fieldName){if(this.fieldsInfo[fieldName].display==='right'){$el.addClass('float-right');}else if(this.fieldsInfo[fieldName].display==='full'){$el.addClass('o_text_block');}
if(this.fieldsInfo[fieldName].bold){$el.addClass('o_text_bold');}},_setState:function(recordState){this.state=recordState;this.id=recordState.res_id;this.db_id=recordState.id;this.recordData=recordState.data;this.record=this._transformRecord(recordState.data);this.qweb_context={context:this.state.getContext(),kanban_image:this._getImageURL.bind(this),kanban_color:this._getColorClassname.bind(this),kanban_getcolor:this._getColorID.bind(this),kanban_getcolorname:this._getColorname.bind(this),kanban_compute_domain:this._computeDomain.bind(this),selection_mode:this.selectionMode,read_only_mode:this.read_only_mode,record:this.record,user_context:this.getSession().user_context,widget:this,};},_setupColor:function(){var color_field=this.$el.attr('color');if(color_field&&color_field in this.fields){var colorHelp=_.str.sprintf(_t("Card color: %s"),this._getColorname(this.recordData[color_field]));var colorClass=this._getColorClassname(this.recordData[color_field]);this.$el.addClass(colorClass);this.$el.prepend('<span title="'+colorHelp+'" aria-label="'+colorHelp+'" role="img" class="oe_kanban_color_help"/>');}},_setupColorPicker:function(){var $colorpicker=this.$('ul.oe_kanban_colorpicker');if(!$colorpicker.length){return;}
$colorpicker.html(QWeb.render('KanbanColorPicker',{colors:KANBAN_RECORD_COLORS}));$colorpicker.on('click','a',this._onColorChanged.bind(this));},_transformRecord:function(recordData){var self=this;var new_record={};_.each(this.state.getFieldNames(),function(name){var value=recordData[name];var r=_.clone(self.fields[name]||{});if((r.type==='date'||r.type==='datetime')&&value){r.raw_value=value.toDate();}else if(r.type==='one2many'||r.type==='many2many'){r.raw_value=value.count?value.res_ids:[];}else if(r.type==='many2one'){r.raw_value=value&&value.res_id||false;}else{r.raw_value=value;}
if(r.type){var formatter=field_utils.format[r.type];r.value=formatter(value,self.fields[name],recordData,self.state);}else{r.value=value;}
new_record[name]=r;});return new_record;},_updateRecord:function(data){this.trigger_up('kanban_record_update',data);},_onColorChanged:function(event){event.preventDefault();var data={};var color_field=$(event.delegateTarget).data('field')||'color';data[color_field]=$(event.currentTarget).data('color');this.trigger_up('kanban_record_update',data);},_onGlobalClick:function(event){if($(event.target).parents('.o_dropdown_kanban').length){return;}
var trigger=true;var elem=event.target;var ischild=true;var children=[];while(elem){var events=$._data(elem,'events');if(elem===event.currentTarget){ischild=false;}
var test_event=events&&events.click&&(events.click.length>1||events.click[0].namespace!=='bs.tooltip');var testLinkWithHref=elem.nodeName.toLowerCase()==='a'&&elem.href;if(ischild){children.push(elem);if(test_event||testLinkWithHref){trigger=false;}}
if(trigger&&test_event){_.each(events.click,function(click_event){if(click_event.selector){_.each(children,function(child){if($(child).is(click_event.selector)){trigger=false;}});}});}
elem=elem.parentElement;}
if(trigger){this._openRecord();}},_onKanbanActionClicked:function(event){event.preventDefault();var $action=$(event.currentTarget);var type=$action.data('type')||'button';switch(type){case'edit':this.trigger_up('open_record',{id:this.db_id,mode:'edit'});break;case'open':this.trigger_up('open_record',{id:this.db_id});break;case'delete':this.trigger_up('kanban_record_delete',{id:this.db_id,record:this});break;case'action':case'object':var attrs=$action.data();attrs.confirm=$action.attr('confirm');this.trigger_up('button_clicked',{attrs:attrs,record:this.state,});break;case'set_cover':var fieldName=$action.data('field');var autoOpen=$action.data('auto-open');if(this.fields[fieldName].type==='many2one'&&this.fields[fieldName].relation==='ir.attachment'&&this.fieldsInfo[fieldName].widget==='attachment_image'){this._setCoverImage(fieldName,autoOpen);}else{var warning=_.str.sprintf(_t('Could not set the cover image: incorrect field ("%s") is provided in the view.'),fieldName);this.do_warn(warning);}
break;default:this.do_warn(false,_t("Kanban: no action for type: ")+type);}},_onKeyDownCard:function(event){switch(event.keyCode){case $.ui.keyCode.ENTER:if($(event.target).hasClass('oe_kanban_global_click')){event.preventDefault();this._onGlobalClick(event);break;}}},_onKeyDownOpenFirstLink:function(event){switch(event.keyCode){case $.ui.keyCode.ENTER:event.preventDefault();$(event.target).find('a, button').first().click();break;}},_onManageTogglerClicked:function(event){event.preventDefault();this.$el.parent().find('.o_kanban_record').not(this.$el).removeClass('o_dropdown_open');this.$el.toggleClass('o_dropdown_open');var colorClass=this._getColorClassname(this.recordData.color||0);this.$('.o_kanban_manage_button_section').toggleClass(colorClass);},});return KanbanRecord;});;

/* /web/static/src/js/views/kanban/kanban_record_quick_create.js defined in bundle 'web.assets_backend' */
odoo.define('web.kanban_record_quick_create',function(require){"use strict";var core=require('web.core');var QuickCreateFormView=require('web.QuickCreateFormView');const session=require('web.session');var Widget=require('web.Widget');var RecordQuickCreate=Widget.extend({className:'o_kanban_quick_create',custom_events:{add:'_onAdd',cancel:'_onCancel',},events:{'click .o_kanban_add':'_onAddClicked','click .o_kanban_edit':'_onEditClicked','click .o_kanban_cancel':'_onCancelClicked','mousedown':'_onMouseDown',},mouseDownInside:false,init:function(parent,options){this._super.apply(this,arguments);this.context=options.context;this.formViewRef=options.formViewRef;this.model=options.model;this._disabled=false;},willStart:function(){var self=this;var superWillStart=this._super.apply(this,arguments);var viewsLoaded;if(this.formViewRef){var views=[[false,'form']];var context=_.extend({},this.context,{form_view_ref:this.formViewRef,});viewsLoaded=this.loadViews(this.model,context,views);}else{var fieldsView={};fieldsView.arch='<form>'+'<field name="display_name" placeholder="Title" modifiers=\'{"required": true}\'/>'+'</form>';var fields={display_name:{string:'Display name',type:'char'},};fieldsView.fields=fields;fieldsView.viewFields=fields;viewsLoaded=Promise.resolve({form:fieldsView});}
viewsLoaded=viewsLoaded.then(function(fieldsViews){var formView=new QuickCreateFormView(fieldsViews.form,{context:self.context,modelName:self.model,userContext:session.user_context,});return formView.getController(self).then(function(controller){self.controller=controller;return self.controller.appendTo(document.createDocumentFragment());});});return Promise.all([superWillStart,viewsLoaded]);},start:function(){this.$el.append(this.controller.$el);this.controller.renderButtons(this.$el);this.controller.autofocus();core.bus.on('click',this,this._onWindowClicked);return this._super.apply(this,arguments);},on_attach_callback:function(){if(this.controller){this.controller.autofocus();}},cancel:function(){var self=this;return this.controller.commitChanges().then(function(){if(!self.controller.isDirty()){self._cancel();}});},_add:function(options){var self=this;if(this._disabled){return;}
this._disableQuickCreate();this.controller.commitChanges().then(function(){var canBeSaved=self.controller.canBeSaved();if(canBeSaved){self.trigger_up('quick_create_add_record',{openRecord:options&&options.openRecord||false,values:self.controller.getChanges(),onFailure:self._enableQuickCreate.bind(self),});}else{self._enableQuickCreate();}}).guardedCatch(this._enableQuickCreate.bind(this));},_cancel:function(){this.trigger_up('cancel_quick_create');},_disableQuickCreate:function(){this._disabled=true;this.$el.addClass('o_disabled');this.$('input:not(:disabled)').addClass('o_temporarily_disabled').attr('disabled','disabled');},_enableQuickCreate:function(){this._disabled=false;this.$el.removeClass('o_disabled');this.$('input.o_temporarily_disabled').removeClass('o_temporarily_disabled').attr('disabled',false);},_onAdd:function(ev){ev.stopPropagation();this._add();},_onAddClicked:function(ev){ev.stopPropagation();this._add();},_onCancel:function(ev){ev.stopPropagation();this._cancel();},_onCancelClicked:function(ev){ev.stopPropagation();this._cancel();},_onEditClicked:function(ev){ev.stopPropagation();this._add({openRecord:true});},_onWindowClicked:function(ev){var mouseDownInside=this.mouseDownInside;this.mouseDownInside=false;if(!document.contains(this.el)){return;}
if($(ev.target).closest('.o-kanban-button-new, .o_kanban_quick_add').length){return;}
if($(ev.target).parents('.ui-autocomplete').length){return;}
if($(ev.target).closest('.modal').length){return;}
if($(document.body).hasClass('modal-open')){return;}
if(!document.contains(ev.target)){return;}
if(this.el.contains(ev.target)||this.el===ev.target||mouseDownInside){return;}
this.cancel();},_onMouseDown:function(ev){this.mouseDownInside=true;}});return RecordQuickCreate;});;

/* /web/static/src/js/views/kanban/kanban_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanRenderer',function(require){"use strict";var BasicRenderer=require('web.BasicRenderer');var ColumnQuickCreate=require('web.kanban_column_quick_create');var config=require('web.config');var core=require('web.core');var KanbanColumn=require('web.KanbanColumn');var KanbanRecord=require('web.KanbanRecord');var QWeb=require('web.QWeb');var session=require('web.session');var utils=require('web.utils');var viewUtils=require('web.viewUtils');var qweb=core.qweb;var _t=core._t;function findInNode(node,predicate){if(predicate(node)){return node;}
if(!node.children){return undefined;}
for(var i=0;i<node.children.length;i++){if(findInNode(node.children[i],predicate)){return node.children[i];}}}
function qwebAddIf(node,condition){if(node.attrs[qweb.prefix+'-if']){condition=_.str.sprintf("(%s) and (%s)",node.attrs[qweb.prefix+'-if'],condition);}
node.attrs[qweb.prefix+'-if']=condition;}
function transformQwebTemplate(node,fields){if(node.tag&&node.attrs.modifiers){var modifiers=node.attrs.modifiers||{};if(modifiers.invisible){qwebAddIf(node,_.str.sprintf("!kanban_compute_domain(%s)",JSON.stringify(modifiers.invisible)));}}
switch(node.tag){case'button':case'a':var type=node.attrs.type||'';if(_.indexOf('action,object,edit,open,delete,url,set_cover'.split(','),type)!==-1){_.each(node.attrs,function(v,k){if(_.indexOf('icon,type,name,args,string,context,states,kanban_states'.split(','),k)!==-1){node.attrs['data-'+k]=v;delete(node.attrs[k]);}});if(node.attrs['data-string']){node.attrs.title=node.attrs['data-string'];}
if(node.tag==='a'&&node.attrs['data-type']!=="url"){node.attrs.href='#';}else{node.attrs.type='button';}
var action_classes=" oe_kanban_action oe_kanban_action_"+node.tag;if(node.attrs['t-attf-class']){node.attrs['t-attf-class']+=action_classes;}else if(node.attrs['t-att-class']){node.attrs['t-att-class']+=" + '"+action_classes+"'";}else{node.attrs['class']=(node.attrs['class']||'')+action_classes;}}
break;}
if(node.children){for(var i=0,ii=node.children.length;i<ii;i++){transformQwebTemplate(node.children[i],fields);}}}
var KanbanRenderer=BasicRenderer.extend({className:'o_kanban_view',config:{KanbanColumn:KanbanColumn,KanbanRecord:KanbanRecord,},custom_events:_.extend({},BasicRenderer.prototype.custom_events||{},{close_quick_create:'_onCloseQuickCreate',cancel_quick_create:'_onCancelQuickCreate',set_progress_bar_state:'_onSetProgressBarState',start_quick_create:'_onStartQuickCreate',quick_create_column_updated:'_onQuickCreateColumnUpdated',}),events:_.extend({},BasicRenderer.prototype.events||{},{'keydown .o_kanban_record':'_onRecordKeyDown'}),sampleDataTargets:['.o_kanban_counter','.o_kanban_record','.o_kanban_toggle_fold','.o_column_folded','.o_column_archive_records','.o_column_unarchive_records',],init:function(parent,state,params){this._super.apply(this,arguments);this.widgets=[];this.qweb=new QWeb(config.isDebug(),{_s:session.origin},false);var templates=findInNode(this.arch,function(n){return n.tag==='templates';});transformQwebTemplate(templates,state.fields);this.qweb.add_template(utils.json_node_to_xml(templates));this.examples=params.examples;this.recordOptions=_.extend({},params.record_options,{qweb:this.qweb,viewType:'kanban',});this.columnOptions=_.extend({KanbanRecord:this.config.KanbanRecord},params.column_options);if(this.columnOptions.hasProgressBar){this.columnOptions.progressBarStates={};}
this.quickCreateEnabled=params.quickCreateEnabled;if(!params.readOnlyMode){var handleField=_.findWhere(this.state.fieldsInfo.kanban,{widget:'handle'});this.handleField=handleField&&handleField.name;}
this._setState(state);},on_attach_callback:function(){this._super(...arguments);if(this.quickCreate){this.quickCreate.on_attach_callback();}},addQuickCreate:function(groupId){let kanbanColumn;if(groupId){kanbanColumn=this.widgets.find(column=>column.db_id===groupId);}
kanbanColumn=kanbanColumn||this.widgets[0];return kanbanColumn.addQuickCreate();},giveFocus:function(){this.$('.o_kanban_record:first').focus();},quickCreateToggleFold:function(){this.quickCreate.toggleFold();this._toggleNoContentHelper();},updateColumn:function(localID,columnState,options){var self=this;var KanbanColumn=this.config.KanbanColumn;var newColumn=new KanbanColumn(this,columnState,this.columnOptions,this.recordOptions);var index=_.findIndex(this.widgets,{db_id:localID});var column=this.widgets[index];this.widgets[index]=newColumn;if(options&&options.state){this._setState(options.state);}
return newColumn.appendTo(document.createDocumentFragment()).then(function(){var def;if(options&&options.openQuickCreate){def=newColumn.addQuickCreate();}
return Promise.resolve(def).then(function(){newColumn.$el.insertAfter(column.$el);self._toggleNoContentHelper();newColumn.on_attach_callback();column.destroy();});});},updateRecord:function(recordState){var isGrouped=!!this.state.groupedBy.length;var record;if(isGrouped){_.each(this.widgets,function(widget){record=record||_.findWhere(widget.records,{db_id:recordState.id,});});}else{record=_.findWhere(this.widgets,{db_id:recordState.id});}
if(record){return record.update(recordState);}
return Promise.resolve();},_focusOnNextCard:function(currentCardElement){var nextCard=currentCardElement.nextElementSibling;if(nextCard){nextCard.focus();}},_focusOnPreviousCard:function(currentCardElement){var previousCard=currentCardElement.previousElementSibling;if(previousCard&&previousCard.classList.contains("o_kanban_record")){previousCard.focus();return true;}},_getGhostColumns:function(){if(this.examples&&this.examples.ghostColumns){return this.examples.ghostColumns;}
return _.map(_.range(1,5),function(num){return _.str.sprintf(_t("Column %s"),num);});},_renderExampleBackground:function(fragment){var $background=$(qweb.render('KanbanView.ExamplesBackground',{ghostColumns:this._getGhostColumns()}));$background.appendTo(fragment);},_renderGhostDivs:function(fragment,nbDivs,options){var ghostDefs=[];for(var $ghost,i=0;i<nbDivs;i++){$ghost=$('<div>').addClass('o_kanban_record o_kanban_ghost');if(options&&options.inlineStyle){$ghost.attr('style',options.inlineStyle);}
var def=$ghost.appendTo(fragment);ghostDefs.push(def);}
return Promise.all(ghostDefs);},_renderGrouped:function(fragment){var self=this;var KanbanColumn=this.config.KanbanColumn;_.each(this.state.data,function(group){var column=new KanbanColumn(self,group,self.columnOptions,self.recordOptions);var def;if(!group.value){def=column.prependTo(fragment);self.widgets.unshift(column);}else{def=column.appendTo(fragment);self.widgets.push(column);}
self.defs.push(def);});if(this.$el.sortable('instance')!==undefined){this.$el.sortable('destroy');}
if(this.groupedByM2O){this.$el.sortable({axis:'x',items:'> .o_kanban_group',handle:'.o_column_title',cursor:'move',revert:150,delay:100,tolerance:'pointer',forcePlaceholderSize:true,stop:function(){var ids=[];self.$('.o_kanban_group').each(function(index,u){if(_.isNumber($(u).data('id'))){ids.push($(u).data('id'));}});self.trigger_up('resequence_columns',{ids:ids});},});if(this.createColumnEnabled){this.quickCreate=new ColumnQuickCreate(this,{applyExamplesText:this.examples&&this.examples.applyExamplesText,examples:this.examples&&this.examples.examples,});this.defs.push(this.quickCreate.appendTo(fragment).then(function(){if(!self.state.data.length){self.quickCreate.toggleFold();self._renderExampleBackground(fragment);}}));}}},_renderUngrouped:function(fragment){var self=this;var KanbanRecord=this.config.KanbanRecord;var kanbanRecord;_.each(this.state.data,function(record){kanbanRecord=new KanbanRecord(self,record,self.recordOptions);self.widgets.push(kanbanRecord);var def=kanbanRecord.appendTo(fragment);self.defs.push(def);});var orderedBy=this.state.orderedBy;var hasHandle=this.handleField&&(orderedBy.length===0||orderedBy[0].name===this.handleField);if(hasHandle){this.$el.sortable({items:'.o_kanban_record:not(.o_kanban_ghost)',cursor:'move',revert:0,delay:0,tolerance:'pointer',forcePlaceholderSize:true,stop:function(event,ui){self._moveRecord(ui.item.data('record').db_id,ui.item.index());},});}
var prom=Promise.all(self.defs).then(function(){var options={};if(kanbanRecord){options.inlineStyle=kanbanRecord.$el.attr('style');}
return self._renderGhostDivs(fragment,6,options);});this.defs.push(prom);},_renderView:function(){var self=this;var isGrouped=!!this.state.groupedBy.length;var fragment=document.createDocumentFragment();var defs=[];this.defs=defs;if(isGrouped){this._renderGrouped(fragment);}else{this._renderUngrouped(fragment);}
delete this.defs;return this._super.apply(this,arguments).then(function(){return Promise.all(defs).then(function(){self.$el.empty();self.$el.toggleClass('o_kanban_grouped',isGrouped);self.$el.toggleClass('o_kanban_ungrouped',!isGrouped);self.$el.append(fragment);self._toggleNoContentHelper();});});},_toggleNoContentHelper:function(remove){var displayNoContentHelper=!remove&&!this._hasContent()&&!!this.noContentHelp&&!(this.quickCreate&&!this.quickCreate.folded)&&!this.state.isGroupedByM2ONoColumn;var $noContentHelper=this.$('.o_view_nocontent');if(displayNoContentHelper&&!$noContentHelper.length){this._renderNoContentHelper();}
if(!displayNoContentHelper&&$noContentHelper.length){$noContentHelper.remove();}},_setState:function(){this._super(...arguments);var groupByField=this.state.groupedBy[0];var cleanGroupByField=this._cleanGroupByField(groupByField);var groupByFieldAttrs=this.state.fields[cleanGroupByField];var groupByFieldInfo=this.state.fieldsInfo.kanban[cleanGroupByField];var draggable=true;var grouped_by_date=false;if(groupByFieldAttrs){if(groupByFieldAttrs.type==="date"||groupByFieldAttrs.type==="datetime"){draggable=false;grouped_by_date=true;}else if(groupByFieldAttrs.readonly!==undefined){draggable=!(groupByFieldAttrs.readonly);}}
if(groupByFieldInfo){if(draggable&&groupByFieldInfo.readonly!==undefined){draggable=!(groupByFieldInfo.readonly);}}
this.groupedByM2O=groupByFieldAttrs&&(groupByFieldAttrs.type==='many2one');var relation=this.groupedByM2O&&groupByFieldAttrs.relation;var groupByTooltip=groupByFieldInfo&&groupByFieldInfo.options.group_by_tooltip;this.columnOptions=_.extend(this.columnOptions,{draggable:draggable,group_by_tooltip:groupByTooltip,groupedBy:groupByField,grouped_by_m2o:this.groupedByM2O,grouped_by_date:grouped_by_date,relation:relation,quick_create:this.quickCreateEnabled&&viewUtils.isQuickCreateEnabled(this.state),});this.createColumnEnabled=this.groupedByM2O&&this.columnOptions.group_creatable;},_cleanGroupByField:function(groupByField){var cleanGroupByField=groupByField;if(cleanGroupByField&&cleanGroupByField.indexOf(':')>-1){cleanGroupByField=cleanGroupByField.substring(0,cleanGroupByField.indexOf(':'));}
return cleanGroupByField;},_focusOnCardInColumn:function(eventTarget,direction){var currentColumn=eventTarget.parentElement;var hasSelectedACard=false;var cannotSelectAColumn=false;while(!hasSelectedACard&&!cannotSelectAColumn){var candidateColumn=direction==='LEFT'?currentColumn.previousElementSibling:currentColumn.nextElementSibling;currentColumn=candidateColumn;if(candidateColumn){var allCardsOfCandidateColumn=candidateColumn.getElementsByClassName('o_kanban_record');if(allCardsOfCandidateColumn.length){allCardsOfCandidateColumn[0].focus();hasSelectedACard=true;}}
else{direction==='LEFT'?this._focusOnPreviousCard(eventTarget):this._focusOnNextCard(eventTarget);cannotSelectAColumn=true;}}},_onCancelQuickCreate:function(){this._toggleNoContentHelper();},_onCloseQuickCreate:function(){if(this.state.groupedBy.length){_.invoke(this.widgets,'cancelQuickCreate');}
this._toggleNoContentHelper();},_onQuickCreateColumnUpdated:function(ev){ev.stopPropagation();this._toggleNoContentHelper();this._updateExampleBackground();},_onRecordKeyDown:function(e){switch(e.which){case $.ui.keyCode.DOWN:this._focusOnNextCard(e.currentTarget);e.stopPropagation();e.preventDefault();break;case $.ui.keyCode.UP:const previousFocused=this._focusOnPreviousCard(e.currentTarget);if(!previousFocused){this.trigger_up('navigation_move',{direction:'up'});}
e.stopPropagation();e.preventDefault();break;case $.ui.keyCode.RIGHT:this._focusOnCardInColumn(e.currentTarget,'RIGHT');e.stopPropagation();e.preventDefault();break;case $.ui.keyCode.LEFT:this._focusOnCardInColumn(e.currentTarget,'LEFT');e.stopPropagation();e.preventDefault();break;}},_onSetProgressBarState:function(ev){if(!this.columnOptions.progressBarStates[ev.data.columnID]){this.columnOptions.progressBarStates[ev.data.columnID]={};}
_.extend(this.columnOptions.progressBarStates[ev.data.columnID],ev.data.values);},_onStartQuickCreate:function(){this._toggleNoContentHelper(true);},_updateExampleBackground:function(){var $elem=this.$('.o_kanban_example_background_container');if(!this.state.data.length&&!$elem.length){this._renderExampleBackground(this.$el);}else{$elem.remove();}},});return KanbanRenderer;});;

/* /web/static/src/js/views/kanban/kanban_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.KanbanView',function(require){"use strict";var BasicView=require('web.BasicView');var core=require('web.core');var KanbanController=require('web.KanbanController');var kanbanExamplesRegistry=require('web.kanban_examples_registry');var KanbanModel=require('web.KanbanModel');var KanbanRenderer=require('web.KanbanRenderer');var utils=require('web.utils');var _lt=core._lt;var KanbanView=BasicView.extend({accesskey:"k",display_name:_lt("Kanban"),icon:'fa-th-large',mobile_friendly:true,config:_.extend({},BasicView.prototype.config,{Model:KanbanModel,Controller:KanbanController,Renderer:KanbanRenderer,}),jsLibs:[],viewType:'kanban',init:function(viewInfo,params){this._super.apply(this,arguments);this.loadParams.limit=this.loadParams.limit||40;this.loadParams.openGroupByDefault=true;this.loadParams.type='list';this.noDefaultGroupby=params.noDefaultGroupby;var progressBar;utils.traverse(this.arch,function(n){var isProgressBar=(n.tag==='progressbar');if(isProgressBar){progressBar=_.clone(n.attrs);progressBar.colors=JSON.parse(progressBar.colors);progressBar.sum_field=progressBar.sum_field||false;}
return!isProgressBar;});if(progressBar){this.loadParams.progressBar=progressBar;}
var activeActions=this.controllerParams.activeActions;var archAttrs=this.arch.attrs;activeActions=_.extend(activeActions,{group_create:this.arch.attrs.group_create?!!JSON.parse(archAttrs.group_create):true,group_edit:archAttrs.group_edit?!!JSON.parse(archAttrs.group_edit):true,group_delete:archAttrs.group_delete?!!JSON.parse(archAttrs.group_delete):true,});this.rendererParams.column_options={editable:activeActions.group_edit,deletable:activeActions.group_delete,archivable:archAttrs.archivable?!!JSON.parse(archAttrs.archivable):true,group_creatable:activeActions.group_create,quickCreateView:archAttrs.quick_create_view||null,recordsDraggable:archAttrs.records_draggable?!!JSON.parse(archAttrs.records_draggable):true,hasProgressBar:!!progressBar,};this.rendererParams.record_options={editable:activeActions.edit,deletable:activeActions.delete,read_only_mode:params.readOnlyMode,selectionMode:params.selectionMode,};this.rendererParams.quickCreateEnabled=this._isQuickCreateEnabled();this.rendererParams.readOnlyMode=params.readOnlyMode;var examples=archAttrs.examples;if(examples){this.rendererParams.examples=kanbanExamplesRegistry.get(examples);}
this.controllerParams.on_create=archAttrs.on_create;this.controllerParams.hasButtons=!params.selectionMode?true:false;this.controllerParams.quickCreateEnabled=this.rendererParams.quickCreateEnabled;},_isQuickCreateEnabled:function(){if(!this.controllerParams.activeActions.create){return false;}
if(this.arch.attrs.quick_create!==undefined){return!!JSON.parse(this.arch.attrs.quick_create);}
return true;},_updateMVCParams:function(){this._super.apply(this,arguments);if(this.searchMenuTypes.includes('groupBy')&&!this.noDefaultGroupby&&this.arch.attrs.default_group_by){this.loadParams.groupBy=[this.arch.attrs.default_group_by];}},});return KanbanView;});;

/* /web/static/src/js/views/kanban/quick_create_form_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.QuickCreateFormView',function(require){"use strict";var BasicModel=require('web.BasicModel');var FormController=require('web.FormController');var FormRenderer=require('web.FormRenderer');var FormView=require('web.FormView');const{qweb}=require("web.core");var QuickCreateFormRenderer=FormRenderer.extend({start:async function(){await this._super.apply(this,arguments);this.$el.addClass('o_xxs_form_view');this.$el.removeClass('o_xxl_form_view');},_applyFormSizeClass(){},_onNavigationMove:function(ev){var direction=ev.data.direction;if(direction==='cancel'||direction==='next_line'){ev.stopPropagation();this.trigger_up(direction==='cancel'?'cancel':'add');}else{this._super.apply(this,arguments);}},});var QuickCreateFormModel=BasicModel.extend({getChanges:function(localID){var record=this.localData[localID];return this._generateChanges(record,{changesOnly:false});},});var QuickCreateFormController=FormController.extend({commitChanges:function(){var mutexDef=this.mutex.getUnlockedDef();return Promise.all([mutexDef,this.renderer.commitChanges(this.handle)]);},getChanges:function(){return this.model.getChanges(this.handle);},renderButtons($node){this.$buttons=$(qweb.render('KanbanView.RecordQuickCreate.buttons'));if($node){this.$buttons.appendTo($node);}},updateButtons(){},});var QuickCreateFormView=FormView.extend({withControlPanel:false,config:_.extend({},FormView.prototype.config,{Model:QuickCreateFormModel,Renderer:QuickCreateFormRenderer,Controller:QuickCreateFormController,}),});return QuickCreateFormView;});;

/* /web/static/src/js/views/list/list_editable_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.EditableListRenderer',function(require){"use strict";var core=require('web.core');var dom=require('web.dom');var ListRenderer=require('web.ListRenderer');var utils=require('web.utils');const{WidgetAdapterMixin}=require('web.OwlCompatibility');var _t=core._t;ListRenderer.include({RESIZE_DELAY:200,custom_events:_.extend({},ListRenderer.prototype.custom_events,{navigation_move:'_onNavigationMove',}),events:_.extend({},ListRenderer.prototype.events,{'click .o_field_x2many_list_row_add a':'_onAddRecord','click .o_group_field_row_add a':'_onAddRecordToGroup','keydown .o_field_x2many_list_row_add a':'_onKeyDownAddRecord','click tbody td.o_data_cell':'_onCellClick','click tbody tr:not(.o_data_row)':'_onEmptyRowClick','click tfoot':'_onFooterClick','click tr .o_list_record_remove':'_onRemoveIconClick',}),init:function(parent,state,params){this._super.apply(this,arguments);this.editable=params.editable;this.isMultiEditable=params.isMultiEditable;this.columnWidths=false;this.addCreateLine=params.addCreateLine;this.addCreateLineInGroups=params.addCreateLineInGroups;this.creates=[];this.arch.children.forEach(child=>{if(child.tag!=='control'){return;}
child.children.forEach(child=>{if(child.tag!=='create'||child.attrs.invisible){return;}
this.creates.push({context:child.attrs.context,string:child.attrs.string,});});});if(this.creates.length===0){this.creates.push({string:_t("Add a line"),});}
this.addTrashIcon=params.addTrashIcon;this.isMany2Many=params.isMany2Many;this.currentRow=null;this.currentFieldIndex=null;this.isResizing=false;this.eventListeners=[];},start:function(){core.bus.on('click',this,this._onWindowClicked.bind(this));core.bus.on('resize',this,_.debounce(this._onResize.bind(this),this.RESIZE_DELAY));core.bus.on('DOM_updated',this,()=>this._freezeColumnWidths());return this._super();},destroy:function(){this.eventListeners.forEach(listener=>{const{type,el,callback,options}=listener;el.removeEventListener(type,callback,options);});return this._super.apply(this,arguments);},on_attach_callback:function(){this.isInDOM=true;this._super();this._freezeColumnWidths();},on_detach_callback:function(){this.isInDOM=false;this._super();},canBeSaved:function(recordID){if((recordID||this.state.id)===this.state.id){recordID=this.getEditableRecordID();if(recordID===null){return[];}}
var fieldNames=this._super(recordID);this.$('.o_selected_row .o_data_cell').removeClass('o_invalid_cell');this.$('.o_selected_row .o_data_cell:has(> .o_field_invalid)').addClass('o_invalid_cell');return fieldNames;},confirmChange:function(state,recordID){var self=this;return this._super.apply(this,arguments).then(function(widgets){if(widgets.length){var $row=self._getRow(recordID);var record=self._getRecord(recordID);self._setDecorationClasses($row,self.rowDecorations,record);self._updateFooter();}
return widgets;});},confirmUpdate:function(state,id,fields,ev){var self=this;var oldData=this.state.data;this._setState(state);return this.confirmChange(state,id,fields,ev).then(function(){var record=self._getRecord(id);if(!record){return;}
_.each(oldData,function(rec){if(rec.id!==id){self._destroyFieldWidgets(rec.id);}});self.defs=[];var $newBody=self._renderBody();var defs=self.defs;delete self.defs;return Promise.all(defs).then(function(){_.each(self.columns,function(node){self._registerModifiers(node,record,null,{mode:'edit'});});var currentRowID;var currentWidget;var focusedElement;var selectionRange;if(self.currentRow!==null){currentRowID=self._getRecordID(self.currentRow);currentWidget=self.allFieldWidgets[currentRowID][self.currentFieldIndex];if(currentWidget){focusedElement=currentWidget.getFocusableElement().get(0);if(currentWidget.formatType!=='boolean'&&focusedElement){selectionRange=dom.getSelectionRange(focusedElement);}}}
var $editedRow=self._getRow(id);$editedRow.nextAll('.o_data_row').remove();$editedRow.prevAll('.o_data_row').remove();var $newRow=$newBody.find('.o_data_row[data-id="'+id+'"]');$newRow.prevAll('.o_data_row').get().reverse().forEach(function(row){$(row).insertBefore($editedRow);});$newRow.nextAll('.o_data_row').get().reverse().forEach(function(row){$(row).insertAfter($editedRow);});if(self.currentRow!==null){var newRowIndex=$editedRow.prop('rowIndex')-1;self.currentRow=newRowIndex;return self._selectCell(newRowIndex,self.currentFieldIndex,{force:true}).then(function(){currentWidget=self.allFieldWidgets[currentRowID][self.currentFieldIndex];if(currentWidget){focusedElement=currentWidget.getFocusableElement().get(0);if(selectionRange){dom.setSelectionRange(focusedElement,selectionRange);}}});}});});},editFirstRecord:function(ev){const $borderRow=this._getBorderRow(ev.data.side||'first');this._selectCell($borderRow.prop('rowIndex')-1,ev.data.cellIndex||0);},editRecord:function(recordID){var $row=this._getRow(recordID);var rowIndex=$row.prop('rowIndex')-1;return this._selectCell(rowIndex,0);},focusCell:function(recordId,column){var $row=this._getRow(recordId);var cellIndex=this.columns.indexOf(column);$row.find('.o_data_cell')[cellIndex].focus();},getEditableRecordID:function(){if(this.currentRow!==null){return this._getRecordID(this.currentRow);}
return null;},isInMultipleRecordEdition:function(recordId){return this.isEditable()&&this.isMultiEditable&&this.selection.includes(recordId);},isEditable:function(){return this.editable||(this.isMultiEditable&&this.selection.length);},removeLine:function(state,recordID){this._setState(state);var $row=this._getRow(recordID);if($row.length===0){return;}
if($row.prop('rowIndex')-1===this.currentRow){this.currentRow=null;this._enableRecordSelectors();}
this._destroyFieldWidgets(recordID);if(this.state.count>=4){$row.remove();}else{var $emptyRow=this._renderEmptyRow();$row.replaceWith($emptyRow);const $lastDataRow=this.$('.o_data_row:last');if($lastDataRow.length){$emptyRow.insertAfter($lastDataRow);}}},setRowMode:function(recordID,mode){var self=this;var record=self._getRecord(recordID);if(!record){return Promise.resolve();}
var editMode=(mode==='edit');var $row=this._getRow(recordID);this.currentRow=editMode?$row.prop('rowIndex')-1:null;var $tds=$row.children('.o_data_cell');var oldWidgets=_.clone(this.allFieldWidgets[record.id]);var options={renderInvisible:editMode,renderWidgets:editMode,};options.mode=editMode?'edit':'readonly';var defs=[];this.defs=defs;_.each(this.columns,function(node,colIndex){var $td=$tds.eq(colIndex);var $newTd=self._renderBodyCell(record,node,colIndex,options);if($td.hasClass('o_list_button')){self._unregisterModifiersElement(node,recordID,$td.children());}
if(editMode){$td.empty().append($newTd.contents());}else{self._unregisterModifiersElement(node,recordID,$td);$td.replaceWith($newTd);}});delete this.defs;_.each(oldWidgets,this._destroyFieldWidget.bind(this,recordID));$row.toggleClass('o_selected_row',editMode);if(editMode){this._disableRecordSelectors();}else{this._enableRecordSelectors();}
return Promise.all(defs).then(function(){WidgetAdapterMixin.on_attach_callback.call(self);core.bus.trigger('DOM_updated');});},unselectRow:function(){if(this.currentRow===null){return Promise.resolve();}
var recordID=this._getRecordID(this.currentRow);var recordWidgets=this.allFieldWidgets[recordID];function toggleWidgets(disabled){_.each(recordWidgets,function(widget){var $el=widget.getFocusableElement();$el.prop('disabled',disabled);});}
toggleWidgets(true);return new Promise((resolve,reject)=>{this.trigger_up('save_line',{recordID:recordID,onSuccess:resolve,onFailure:reject,});}).then(selectNextRow=>{this._enableRecordSelectors();return selectNextRow;}).guardedCatch(()=>{toggleWidgets(false);});},updateState:function(state,params){if(params.keepWidths&&this.$el.is(':visible')){this._storeColumnWidths();}
if(params.noRender){this.allModifiersData=[];}
if('addTrashIcon'in params){if(this.addTrashIcon!==params.addTrashIcon){this.columnWidths=false;}
this.addTrashIcon=params.addTrashIcon;}
if('addCreateLine'in params){this.addCreateLine=params.addCreateLine;}
return this._super.apply(this,arguments);},_addEventListener:function(type,el,callback,options){el.addEventListener(type,callback,options);this.eventListeners.push({type,el,callback,options});},_computeDefaultWidths:function(){const isListEmpty=!this._hasVisibleRecords(this.state);const relativeWidths=[];this.columns.forEach(column=>{const th=this._getColumnHeader(column);if(th.offsetParent===null){relativeWidths.push(false);}else{const width=this._getColumnWidth(column);if(width.match(/[a-zA-Z]/)){if(isListEmpty){th.style.width=width;}else{th.style.minWidth=width;}
relativeWidths.push(false);}else{relativeWidths.push(parseFloat(width,10));}}});if(isListEmpty){const totalWidth=this._getColumnsTotalWidth(relativeWidths);for(let i in this.columns){if(relativeWidths[i]){const th=this._getColumnHeader(this.columns[i]);th.style.width=(relativeWidths[i]/totalWidth*100)+'%';}}
const trashHeader=this.el.getElementsByClassName('o_list_record_remove_header')[0];if(trashHeader){trashHeader.style.width='32px';}}},_destroyFieldWidgets:function(recordID){if(recordID in this.allFieldWidgets){var widgetsToDestroy=this.allFieldWidgets[recordID].slice();_.each(widgetsToDestroy,this._destroyFieldWidget.bind(this,recordID));delete this.allFieldWidgets[recordID];}},_disableRecordSelectors:function(){this.$('.o_list_record_selector input').attr('disabled','disabled');},_enableRecordSelectors:function(){this.$('.o_list_record_selector input').attr('disabled',false);},_freezeColumnWidths:function(){if(!this.columnWidths&&this.el.offsetParent===null){return;}
const thElements=[...this.el.querySelectorAll('table thead th')];if(!thElements.length){return;}
const table=this.el.getElementsByClassName('o_list_table')[0];let columnWidths=this.columnWidths;if(!columnWidths||!columnWidths.length){table.style.tableLayout='auto';thElements.forEach(th=>{th.style.width=null;th.style.maxWidth=null;});this._computeDefaultWidths();columnWidths=this._squeezeTable();}
thElements.forEach((th,index)=>{if(!th.style.width){th.style.width=`${columnWidths[index]}px`;}});table.style.tableLayout='fixed';},_getBorderRow:function(side){let $borderDataRow=this.$(`.o_data_row:${side}`);if(!this._isRecordEditable($borderDataRow.data('id'))){$borderDataRow=this._getNearestEditableRow($borderDataRow,side==='first');}
return $borderDataRow;},_getColumnsTotalWidth(relativeWidths){return relativeWidths.reduce((acc,width)=>acc+width,0);},_getColumnWidth:function(column){if(column.attrs.width){return column.attrs.width;}
const fieldsInfo=this.state.fieldsInfo.list;const name=column.attrs.name;if(!fieldsInfo[name]){return'1';}
const widget=fieldsInfo[name].Widget.prototype;if('widthInList'in widget){return widget.widthInList;}
const field=this.state.fields[name];if(!field){return'1';}
const fixedWidths={boolean:'70px',date:'92px',datetime:'146px',float:'92px',integer:'74px',monetary:'104px',};let type=field.type;if(fieldsInfo[name].widget in fixedWidths){type=fieldsInfo[name].widget;}
return fixedWidths[type]||'1';},_getColumnHeader:function(column){const{icon,name,string}=column.attrs;if(name){return this.el.querySelector(`thead th[data-name="${name}"]`);}else if(string){return this.el.querySelector(`thead th[data-string="${string}"]`);}else if(icon){return this.el.querySelector(`thead th[data-icon="${icon}"]`);}},_getNearestEditableRow:function($row,next){const direction=next?'next':'prev';let $nearestRow;if(this.editable){$nearestRow=$row[direction]();if(!$nearestRow.hasClass('o_data_row')){var $nextBody=$row.closest('tbody')[direction]();while($nextBody.length&&!$nextBody.find('.o_data_row').length){$nextBody=$nextBody[direction]();}
$nearestRow=$nextBody.find(`.o_data_row:${next ? 'first' : 'last'}`);}}else{const recordId=$row.data('id');const rowSelectionIndex=this.selection.indexOf(recordId);let nextRowIndex;if(rowSelectionIndex<0){nextRowIndex=next?0:this.selection.length-1;}else{nextRowIndex=rowSelectionIndex+(next?1:-1);}
$nearestRow=this._getRow(this.selection[nextRowIndex]);}
return $nearestRow;},_getNumberOfCols:function(){var n=this._super();if(this.addTrashIcon){n++;}
return n;},_getRecord:function(recordId){var record;utils.traverse_records(this.state,function(r){if(r.id===recordId){record=r;}});return record;},_getRecordID:function(rowIndex){var $tr=this.$('table.o_list_table > tbody > tr').eq(rowIndex);return $tr.data('id');},_getRow:function(recordId){return this.$('.o_data_row[data-id="'+recordId+'"]');},_hasVisibleRecords:function(list){if(!list.groupedBy.length){return!!list.data.length;}else{var hasVisibleRecords=false;for(var i=0;i<list.data.length;i++){hasVisibleRecords=hasVisibleRecords||this._hasVisibleRecords(list.data[i]);}
return hasVisibleRecords;}},_isRecordEditable:function(recordID){return this.editable||(this.isMultiEditable&&this.selection.includes(recordID));},_moveToNextLine:function(options){this._moveToSideLine(true,options);},_moveToPreviousLine:function(options){this._moveToSideLine(false,options);},_moveToSideLine:function(next,options){options=options||{};const recordID=this._getRecordID(this.currentRow);this.commitChanges(recordID).then(()=>{const record=this._getRecord(recordID);const multiEdit=this.isInMultipleRecordEdition(recordID);if(!multiEdit){const fieldNames=this.canBeSaved(recordID);if(fieldNames.length&&(record.isDirty()||options.forceCreate)){return;}}
const side=next?'first':'last';const borderRowIndex=this._getBorderRow(side).prop('rowIndex')-1;const cellIndex=next?0:this.allFieldWidgets[recordID].length-1;const cellOptions={inc:next?1:-1,force:true};const $currentRow=this._getRow(recordID);const $nextRow=this._getNearestEditableRow($currentRow,next);let nextRowIndex=null;let groupId;if(!this.isGrouped){if($nextRow.length){nextRowIndex=$nextRow.prop('rowIndex')-1;}else if(!this.editable){nextRowIndex=borderRowIndex;}else if(!options.forceCreate&&!record.isDirty()){this.trigger_up('discard_changes',{recordID:recordID,onSuccess:this.trigger_up.bind(this,'activate_next_widget',{side:side}),});return;}}else{var $directNextRow=$currentRow.next();if(next&&this.editable==="bottom"&&$directNextRow.hasClass('o_add_record_row')){if(options.forceCreate||record.isDirty()){groupId=$directNextRow.data('group-id');}else{nextRowIndex=($nextRow.prop('rowIndex')-1)||null;this.trigger_up('discard_changes',{recordID:recordID,onSuccess:()=>{if(nextRowIndex!==null){if(!record.res_id){nextRowIndex--;}
this._selectCell(nextRowIndex,cellIndex,cellOptions);}else{this._selectCell(borderRowIndex,cellIndex,cellOptions);}},});return;}}else{nextRowIndex=$nextRow.length?($nextRow.prop('rowIndex')-1):borderRowIndex;}}
if(nextRowIndex!==null){this._selectCell(nextRowIndex,cellIndex,cellOptions);}else if(this.editable){this.unselectRow().then(this.trigger_up.bind(this,'add_record',{groupId:groupId,onFail:this._selectCell.bind(this,borderRowIndex,cellIndex,cellOptions),}));}});},_processColumns:function(){const oldColumns=this.columns;this._super.apply(this,arguments);if(this.columnWidths&&oldColumns&&oldColumns.length===this.columns.length){for(let i=0;i<oldColumns.length;i++){if(oldColumns[i]!==this.columns[i]){this.columnWidths=false;break;}}}else{this.columnWidths=false;}},_render:function(){this.currentRow=null;this.currentFieldIndex=null;return this._super.apply(this,arguments);},_renderGroup:function(group){var result=this._super.apply(this,arguments);if(!group.groupedBy.length&&this.addCreateLineInGroups){var $groupBody=result[0];var $a=$('<a href="#" role="button">').text(_t("Add a line")).attr('data-group-id',group.id);var $td=$('<td>').attr('colspan',this._getNumberOfCols()).addClass('o_group_field_row_add').attr('tabindex',-1).append($a);var $tr=$('<tr>',{class:'o_add_record_row'}).attr('data-group-id',group.id).append($td);$groupBody.append($tr.prepend($('<td>').html('&nbsp;')));}
return result;},_renderBody:function(){var self=this;var $body=this._super.apply(this,arguments);if(this.hasHandle){$body.sortable({axis:'y',items:'> tr.o_data_row',helper:'clone',handle:'.o_row_handle',stop:function(event,ui){if(self.currentRow!==null){var currentID=self.state.data[self.currentRow].id;self.currentRow=self._getRow(currentID).index();}
self.unselectRow().then(function(){self._moveRecord(ui.item.data('id'),ui.item.index());});},});}
return $body;},_renderFooter:function(){const $footer=this._super.apply(this,arguments);if(this.addTrashIcon){$footer.find('tr').append($('<td>'));}
return $footer;},_renderHeader:function(){var $thead=this._super.apply(this,arguments);if(this.addTrashIcon){$thead.find('tr').append($('<th>',{class:'o_list_record_remove_header'}));}
return $thead;},_renderHeaderCell:function(){const $th=this._super.apply(this,arguments);if($th[0].innerHTML.length&&this._hasVisibleRecords(this.state)){const resizeHandle=document.createElement('span');resizeHandle.classList='o_resize';resizeHandle.onclick=this._onClickResize.bind(this);resizeHandle.onmousedown=this._onStartResize.bind(this);$th.append(resizeHandle);}
return $th;},_renderRow:function(record,index){var $row=this._super.apply(this,arguments);if(this.addTrashIcon){var $icon=this.isMany2Many?$('<button>',{'class':'fa fa-times','name':'unlink','aria-label':_t('Unlink row ')+(index+1)}):$('<button>',{'class':'fa fa-trash-o','name':'delete','aria-label':_t('Delete row ')+(index+1)});var $td=$('<td>',{class:'o_list_record_remove'}).append($icon);$row.append($td);}
return $row;},_renderRows:function(){var $rows=this._super();if(this.addCreateLine){var $tr=$('<tr>');var colspan=this._getNumberOfCols();if(this.handleField){colspan=colspan-1;$tr.append('<td>');}
var $td=$('<td>').attr('colspan',colspan).addClass('o_field_x2many_list_row_add');$tr.append($td);$rows.push($tr);if(this.addCreateLine){_.each(this.creates,function(create,index){var $a=$('<a href="#" role="button">').attr('data-context',create.context).text(create.string);if(index>0){$a.addClass('ml16');}
$td.append($a);});}}
return $rows;},_renderView:function(){this.currentRow=null;return this._super.apply(this,arguments).then(()=>{const table=this.el.getElementsByClassName('o_list_table')[0];if(table){table.classList.toggle('o_empty_list',!this._hasVisibleRecords(this.state));this._freezeColumnWidths();}});},_selectCell:function(rowIndex,fieldIndex,options){options=options||{};if(!options.force&&rowIndex===this.currentRow&&fieldIndex===this.currentFieldIndex){return Promise.resolve();}
var wrap=options.wrap===undefined?true:options.wrap;var recordID=this._getRecordID(rowIndex);var self=this;return this._selectRow(rowIndex).then(function(){var record=self._getRecord(recordID);if(fieldIndex>=(self.allFieldWidgets[record.id]||[]).length){return Promise.reject();}
var oldFieldIndex=self.currentFieldIndex;self.currentFieldIndex=fieldIndex;fieldIndex=self._activateFieldWidget(record,fieldIndex,{inc:options.inc||1,wrap:wrap,event:options&&options.event,});if(fieldIndex<0){self.currentFieldIndex=oldFieldIndex;return Promise.reject();}
self.currentFieldIndex=fieldIndex;});},_selectRow:function(rowIndex){if(rowIndex===this.currentRow){return Promise.resolve();}
if(!this.columnWidths){this._storeColumnWidths();}
var recordId=this._getRecordID(rowIndex);var self=this;return this.unselectRow().then((selectNextRow=true)=>{if(!selectNextRow){return Promise.resolve();}
if(!recordId){return Promise.reject();}
return new Promise(function(resolve){self.trigger_up('edit_line',{recordId:recordId,onSuccess:function(){self._disableRecordSelectors();resolve();},});});});},_squeezeTable:function(){const table=this.el.getElementsByClassName('o_list_table')[0];table.classList.add('o_list_computing_widths');const thead=table.getElementsByTagName('thead')[0];const thElements=[...thead.getElementsByTagName('th')];const columnWidths=thElements.map(th=>th.offsetWidth);const getWidth=th=>columnWidths[thElements.indexOf(th)]||0;const getTotalWidth=()=>thElements.reduce((tot,th,i)=>tot+columnWidths[i],0);const shrinkColumns=(columns,width)=>{let thresholdReached=false;columns.forEach(th=>{const index=thElements.indexOf(th);let maxWidth=columnWidths[index]-Math.ceil(width/columns.length);if(maxWidth<92){maxWidth=92;thresholdReached=true;}
th.style.maxWidth=`${maxWidth}px`;columnWidths[index]=maxWidth;});return thresholdReached;};const sortedThs=[...thead.querySelectorAll('th:not(.o_list_button)')].sort((a,b)=>getWidth(b)-getWidth(a));const allowedWidth=table.parentNode.offsetWidth;let totalWidth=getTotalWidth();let stop=false;let index=0;while(totalWidth>allowedWidth&&!stop){index++;const largests=sortedThs.slice(0,index);while(getWidth(largests[0])===getWidth(sortedThs[index])){largests.push(sortedThs[index]);index++;}
const nextLargest=sortedThs[index];const totalToRemove=totalWidth-allowedWidth;const canRemove=(getWidth(largests[0])-getWidth(nextLargest))*largests.length;stop=shrinkColumns(largests,Math.min(totalToRemove,canRemove));totalWidth=getTotalWidth();}
table.classList.remove('o_list_computing_widths');return columnWidths;},_storeColumnWidths:function(){this.columnWidths=this.$('thead th').toArray().map(function(th){return $(th).outerWidth();});},_onAddRecordToGroup:function(ev){ev.preventDefault();ev.stopPropagation();var self=this;const target=ev.target.tagName!=='A'?ev.target.getElementsByTagName('A')[0]:ev.target;const groupId=target.dataset.groupId;this.currentGroupId=groupId;this.unselectRow().then(function(){self.trigger_up('add_record',{groupId:groupId,});});},_onAddRecord:function(ev){ev.preventDefault();ev.stopPropagation();var self=this;this.unselectRow().then(function(){self.trigger_up('add_record',{context:ev.currentTarget.dataset.context&&[ev.currentTarget.dataset.context]});});},_onCellClick:function(event){var $td=$(event.currentTarget);var $tr=$td.parent();var rowIndex=$tr.prop('rowIndex')-1;if(!this._isRecordEditable($tr.data('id'))||$(event.target).prop('special_click')){return;}
var fieldIndex=Math.max($tr.find('.o_field_cell').index($td),0);this._selectCell(rowIndex,fieldIndex,{event:event});},_onClickResize:function(ev){ev.stopPropagation();ev.preventDefault();},_onEmptyRowClick:function(){this.unselectRow();},_onFooterClick:function(){this.unselectRow();},_onKeyDown:function(ev){const $target=$(ev.currentTarget);const $tr=$target.closest('tr');const recordEditable=this._isRecordEditable($tr.data('id'));if(recordEditable&&ev.keyCode===$.ui.keyCode.ENTER&&$tr.hasClass('o_selected_row')){return;}
if(recordEditable&&ev.keyCode===$.ui.keyCode.ENTER&&!$tr.hasClass('o_selected_row')&&!$tr.hasClass('o_group_header')){ev.stopPropagation();ev.preventDefault();if($target.closest('td').hasClass('o_group_field_row_add')){this._onAddRecordToGroup(ev);}else{this._onCellClick(ev);}}else{this._super.apply(this,arguments);}},_onKeyDownAddRecord:function(e){switch(e.keyCode){case $.ui.keyCode.ENTER:e.stopPropagation();e.preventDefault();this._onAddRecord(e);break;}},_onNavigationMove:function(ev){var self=this;if(this.currentRow===null&&ev.data.direction==='up'){return;}
ev.stopPropagation();if(ev.data.originalEvent&&['next','previous'].includes(ev.data.direction)){ev.data.originalEvent.preventDefault();ev.data.originalEvent.stopPropagation();}
switch(ev.data.direction){case'previous':if(this.currentFieldIndex>0){this._selectCell(this.currentRow,this.currentFieldIndex-1,{inc:-1,wrap:false}).guardedCatch(this._moveToPreviousLine.bind(this));}else{this._moveToPreviousLine();}
break;case'next':if(this.currentFieldIndex+1<this.columns.length){this._selectCell(this.currentRow,this.currentFieldIndex+1,{wrap:false}).guardedCatch(this._moveToNextLine.bind(this));}else{this._moveToNextLine();}
break;case'next_line':if(!this.editable&&this.selection.length===1&&this._getRecordID(this.currentRow)===ev.target.dataPointID){this.unselectRow();}else{this._moveToNextLine({forceCreate:true});}
break;case'cancel':ev.data.originalEvent.stopPropagation();var rowIndex=this.currentRow;var cellIndex=this.currentFieldIndex+1;this.trigger_up('discard_changes',{recordID:ev.target.dataPointID,onSuccess:function(){self._enableRecordSelectors();var recordId=self._getRecordID(rowIndex);if(recordId){var correspondingRow=self._getRow(recordId);correspondingRow.children().eq(cellIndex).focus();}else if(self.currentGroupId){self.$('a[data-group-id="'+self.currentGroupId+'"]').focus();}else{self.$('.o_field_x2many_list_row_add a:first').focus();}}});break;}},_onRemoveIconClick:function(event){event.stopPropagation();var $row=$(event.target).closest('tr');var id=$row.data('id');if($row.hasClass('o_selected_row')){this.trigger_up('list_record_remove',{id:id});}else{var self=this;this.unselectRow().then(function(){self.trigger_up('list_record_remove',{id:id});});}},_onResize:function(){this.columnWidths=false;this._freezeColumnWidths();},_onRowClicked:function(ev){if(!this._isRecordEditable(ev.currentTarget.dataset.id)){if(this.getEditableRecordID()){this.unselectRow();}else{this._super.apply(this,arguments);}}},_onSortColumn:function(){if(this.currentRow===null&&!this.isResizing){this._super.apply(this,arguments);}},_onStartResize:function(ev){if(ev.which!==1){return;}
ev.preventDefault();ev.stopPropagation();this.isResizing=true;const table=this.el.getElementsByClassName('o_list_table')[0];const th=ev.target.closest('th');table.style.width=`${table.offsetWidth}px`;const thPosition=[...th.parentNode.children].indexOf(th);const resizingColumnElements=[...table.getElementsByTagName('tr')].filter(tr=>tr.children.length===th.parentNode.children.length).map(tr=>tr.children[thPosition]);const optionalDropdown=this.el.getElementsByClassName('o_optional_columns')[0];const initialX=ev.pageX;const initialWidth=th.offsetWidth;const initialTableWidth=table.offsetWidth;const initialDropdownX=optionalDropdown?optionalDropdown.offsetLeft:null;const resizeStoppingEvents=['keydown','mousedown','mouseup',];if(!this.el.style.width){this.el.style.width=`${this.el.offsetWidth}px`;}
table.classList.add('o_resizing');resizingColumnElements.forEach(el=>el.classList.add('o_column_resizing'));const resizeHeader=ev=>{ev.preventDefault();ev.stopPropagation();const delta=ev.pageX-initialX;const newWidth=Math.max(10,initialWidth+delta);const tableDelta=newWidth-initialWidth;th.style.width=`${newWidth}px`;th.style.maxWidth=`${newWidth}px`;table.style.width=`${initialTableWidth + tableDelta}px`;if(optionalDropdown){optionalDropdown.style.left=`${initialDropdownX + tableDelta}px`;}};this._addEventListener('mousemove',window,resizeHeader);const stopResize=ev=>{if(ev.type==='mousedown'&&ev.which===1){return;}
ev.preventDefault();ev.stopPropagation();clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(()=>{this.isResizing=false;},100);window.removeEventListener('mousemove',resizeHeader);table.classList.remove('o_resizing');resizingColumnElements.forEach(el=>el.classList.remove('o_column_resizing'));resizeStoppingEvents.forEach(stoppingEvent=>{window.removeEventListener(stoppingEvent,stopResize);});document.activeElement.blur();};resizeStoppingEvents.forEach(stoppingEvent=>{this._addEventListener(stoppingEvent,window,stopResize);});},_onToggleOptionalColumnDropdown:function(ev){this.unselectRow().then(this._super.bind(this,ev));},_onWindowClicked:function(event){if(!this.isEditable()){return;}
if(!document.contains(this.el)){return;}
if(this.currentRow===null){return;}
if($(event.target).closest('.ui-autocomplete').length){return;}
var $modal=$('body > .modal:last');if($modal.length){var $listModal=this.$el.closest('.modal');if($modal.prop('id')!==$listModal.prop('id')){return;}}
if(!document.contains(event.target)){return;}
if(this.el.contains(event.target)&&this.el!==event.target){return;}
if($(event.target).hasClass('o_facet_remove')){return;}
this.unselectRow();},});});;

/* /web/static/src/js/views/list/list_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.ListModel',function(require){"use strict";var BasicModel=require('web.BasicModel');var ListModel=BasicModel.extend({init:function(parent,params){this._super.apply(this,arguments);this.groupbys=params.groupbys;},__get:function(){var result=this._super.apply(this,arguments);var dp=result&&this.localData[result.id];if(dp&&dp.groupData){result.groupData=this.get(dp.groupData);}
return result;},saveRecords:function(listDatapointId,referenceRecordId,recordIds,fieldName){var self=this;var referenceRecord=this.localData[referenceRecordId];var list=this.localData[listDatapointId];var allChanges=this._generateChanges(referenceRecord,{changesOnly:false});var changes=_.pick(allChanges,fieldName);var records=recordIds.map(function(recordId){return self.localData[recordId];});var model=records[0].model;var recordResIds=_.pluck(records,'res_id');var fieldNames=records[0].getFieldNames();var context=records[0].getContext();return this._rpc({model:model,method:'write',args:[recordResIds,changes],context:context,}).then(function(){return self._rpc({model:model,method:'read',args:[recordResIds,fieldNames],context:context,});}).then(function(results){results.forEach(function(data){var record=_.findWhere(records,{res_id:data.id});record.data=_.extend({},record.data,data);record._changes={};record._isDirty=false;self._parseServerData(fieldNames,record,record.data);});}).then(function(){if(!list.groupedBy.length){return Promise.all([self._fetchX2ManysBatched(list),self._fetchReferencesBatched(list)]);}else{return Promise.all([self._fetchX2ManysSingleBatch(list),self._fetchReferencesSingleBatch(list)]);}});},_readGroup:function(list,options){var self=this;options=options||{};options.fetchRecordsWithGroups=true;return this._super(list,options).then(function(result){return self._readGroupExtraFields(list).then(_.constant(result));});},_readGroupExtraFields:function(list){var self=this;var groupByFieldName=list.groupedBy[0].split(':')[0];var groupedByField=list.fields[groupByFieldName];if(groupedByField.type!=='many2one'||!this.groupbys[groupByFieldName]){return Promise.resolve();}
var groupIds=_.reduce(list.data,function(groupIds,id){var resId=self.get(id,{raw:true}).res_id;if(resId){groupIds.push(resId);}
return groupIds;},[]);var groupFields=Object.keys(this.groupbys[groupByFieldName].viewFields);var prom;if(groupIds.length&&groupFields.length){prom=this._rpc({model:groupedByField.relation,method:'read',args:[groupIds,groupFields],context:list.context,});}
return Promise.resolve(prom).then(function(result){var fvg=self.groupbys[groupByFieldName];_.each(list.data,function(id){var dp=self.localData[id];var groupData=result&&_.findWhere(result,{id:dp.res_id,});var groupDp=self._makeDataPoint({context:dp.context,data:groupData,fields:fvg.fields,fieldsInfo:fvg.fieldsInfo,modelName:groupedByField.relation,parentID:dp.id,res_id:dp.res_id,viewType:'groupby',});dp.groupData=groupDp.id;self._parseServerData(groupFields,groupDp,groupDp.data);});});},});return ListModel;});;

/* /web/static/src/js/views/list/list_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.ListRenderer',function(require){"use strict";var BasicRenderer=require('web.BasicRenderer');const{ComponentWrapper}=require('web.OwlCompatibility');var config=require('web.config');var core=require('web.core');var dom=require('web.dom');var field_utils=require('web.field_utils');var Pager=require('web.Pager');var utils=require('web.utils');var viewUtils=require('web.viewUtils');var _t=core._t;var DECORATIONS=['decoration-bf','decoration-it','decoration-danger','decoration-info','decoration-muted','decoration-primary','decoration-success','decoration-warning'];var FIELD_CLASSES={char:'o_list_char',float:'o_list_number',integer:'o_list_number',monetary:'o_list_number',text:'o_list_text',many2one:'o_list_many2one',};var ListRenderer=BasicRenderer.extend({className:'o_list_view',events:{"mousedown":"_onMouseDown","click .o_optional_columns_dropdown .dropdown-item":"_onToggleOptionalColumn","click .o_optional_columns_dropdown_toggle":"_onToggleOptionalColumnDropdown",'click tbody tr':'_onRowClicked','change tbody .o_list_record_selector':'_onSelectRecord','click thead th.o_column_sortable':'_onSortColumn','click .o_list_record_selector':'_onToggleCheckbox','click .o_group_header':'_onToggleGroup','change thead .o_list_record_selector input':'_onToggleSelection','keypress thead tr td':'_onKeyPress','keydown td':'_onKeyDown','keydown th':'_onKeyDown',},sampleDataTargets:['.o_data_row','.o_group_header','.o_list_table > tfoot','.o_list_table > thead .o_list_record_selector',],init:function(parent,state,params){this._super.apply(this,arguments);this._preprocessColumns();this.columnInvisibleFields=params.columnInvisibleFields||{};this.rowDecorations=this._extractDecorationAttrs(this.arch);this.fieldDecorations={};for(const field of this.arch.children.filter(c=>c.tag==='field')){const decorations=this._extractDecorationAttrs(field);this.fieldDecorations[field.attrs.name]=decorations;}
this.hasSelectors=params.hasSelectors;this.selection=params.selectedRecords||[];this.pagers=[];this.isGrouped=this.state.groupedBy.length>0;this.groupbys=params.groupbys;},willStart:function(){this._processColumns(this.columnInvisibleFields);return this._super.apply(this,arguments);},giveFocus:function(){this.$('th:eq(0) input, th:eq(1)').first().focus();},updateState:function(state,params){this._setState(state);this.isGrouped=this.state.groupedBy.length>0;this.columnInvisibleFields=params.columnInvisibleFields||{};this._processColumns(this.columnInvisibleFields);if(params.selectedRecords){this.selection=params.selectedRecords;}
return this._super.apply(this,arguments);},_computeAggregates:function(){var self=this;var data=[];if(this.selection.length){utils.traverse_records(this.state,function(record){if(_.contains(self.selection,record.id)){data.push(record);}});}else{data=this.state.data;}
_.each(this.columns,this._computeColumnAggregates.bind(this,data));},_computeColumnAggregates:function(data,column){var attrs=column.attrs;var field=this.state.fields[attrs.name];if(!field){return;}
var type=field.type;if(type!=='integer'&&type!=='float'&&type!=='monetary'){return;}
var func=(attrs.sum&&'sum')||(attrs.avg&&'avg')||(attrs.max&&'max')||(attrs.min&&'min');if(func){var count=0;var aggregateValue=0;if(func==='max'){aggregateValue=-Infinity;}else if(func==='min'){aggregateValue=Infinity;}
_.each(data,function(d){count+=1;var value=(d.type==='record')?d.data[attrs.name]:d.aggregateValues[attrs.name];if(func==='avg'){aggregateValue+=value;}else if(func==='sum'){aggregateValue+=value;}else if(func==='max'){aggregateValue=Math.max(aggregateValue,value);}else if(func==='min'){aggregateValue=Math.min(aggregateValue,value);}});if(func==='avg'){aggregateValue=count?aggregateValue/count:aggregateValue;}
column.aggregate={help:attrs[func],value:aggregateValue,};}},_extractDecorationAttrs:function(node){const decorations={};for(const[key,expr]of Object.entries(node.attrs)){if(DECORATIONS.includes(key)){const cssClass=key.replace('decoration','text');decorations[cssClass]=py.parse(py.tokenize(expr));}}
return decorations;},_findConnectedCell:function($cell,direction,colIndex){var $connectedRow=$cell.closest('tr')[direction]('tr');if(!$connectedRow.length){var tbody=$cell.closest('tbody, thead');var $connectedGroup=tbody[direction]('tbody, thead');if($connectedGroup.length){var $connectedRows=$connectedGroup.find('tr');var rowIndex;if(direction==='prev'){rowIndex=$connectedRows.length-1;}else{rowIndex=0;}
$connectedRow=$connectedRows.eq(rowIndex);}else{return;}}
var $connectedCell;if($connectedRow.hasClass('o_group_header')){$connectedCell=$connectedRow.children();this.currentColIndex=colIndex;}else if($connectedRow.has('td.o_group_field_row_add').length){$connectedCell=$connectedRow.find('.o_group_field_row_add');this.currentColIndex=colIndex;}else{var connectedRowChildren=$connectedRow.children();if(colIndex===-1){colIndex=connectedRowChildren.length-1;}
$connectedCell=connectedRowChildren.eq(colIndex);}
return $connectedCell;},_getNumberOfCols:function(){var n=this.columns.length;return this.hasSelectors?n+1:n;},_getOptionalColumnsStorageKeyParts:function(){var self=this;return{fields:_.map(this.state.fieldsInfo[this.viewType],function(_,fieldName){return{name:fieldName,type:self.state.fields[fieldName].type};}),};},_groupAdjacentButtons:function(){const children=[];let groupId=0;let buttonGroupNode=null;for(const c of this.arch.children){if(c.tag==='button'){if(!buttonGroupNode){buttonGroupNode={tag:'button_group',children:[c],attrs:{name:`button_group_${groupId++}`,modifiers:{},},};children.push(buttonGroupNode);}else{buttonGroupNode.children.push(c);}}else{buttonGroupNode=null;children.push(c);}}
this.arch.children=children;},_preprocessColumns:function(){this._processModeClassNames();this._groupAdjacentButtons();this.arch.children.filter(c=>c.tag==='button_group').forEach(c=>{c.attrs.editOnly=c.children.every(n=>n.attrs.editOnly);c.attrs.readOnly=c.children.every(n=>n.attrs.readOnly);});},_processColumns:function(columnInvisibleFields){var self=this;this.handleField=null;this.columns=[];this.optionalColumns=[];this.optionalColumnsEnabled=[];var storedOptionalColumns;this.trigger_up('load_optional_fields',{keyParts:this._getOptionalColumnsStorageKeyParts(),callback:function(res){storedOptionalColumns=res;},});_.each(this.arch.children,function(c){if(c.tag!=='control'&&c.tag!=='groupby'&&c.tag!=='header'){var reject=c.attrs.modifiers.column_invisible;if(c.tag==="button_group"){reject=c.children.every(child=>columnInvisibleFields[child.attrs.name]);}else if(c.attrs.name in columnInvisibleFields){reject=columnInvisibleFields[c.attrs.name];}
if(!reject&&c.attrs.widget==='handle'){self.handleField=c.attrs.name;if(self.isGrouped){reject=true;}}
if(!reject&&c.attrs.optional){self.optionalColumns.push(c);var enabled;if(storedOptionalColumns===undefined){enabled=c.attrs.optional==='show';}else{enabled=_.contains(storedOptionalColumns,c.attrs.name);}
if(enabled){self.optionalColumnsEnabled.push(c.attrs.name);}
reject=!enabled;}
if(!reject){self.columns.push(c);}}});},_processModeClassNames:function(){this.arch.children.forEach(c=>{if(c.attrs.class){c.attrs.editOnly=/\boe_edit_only\b/.test(c.attrs.class);c.attrs.readOnly=/\boe_read_only\b/.test(c.attrs.class);}});},_renderAggregateCells:function(aggregateValues){var self=this;return _.map(this.columns,function(column){var $cell=$('<td>');if(config.isDebug()){$cell.addClass(column.attrs.name);}
if(column.attrs.editOnly){$cell.addClass('oe_edit_only');}
if(column.attrs.readOnly){$cell.addClass('oe_read_only');}
if(column.attrs.name in aggregateValues){var field=self.state.fields[column.attrs.name];var value=aggregateValues[column.attrs.name].value;var help=aggregateValues[column.attrs.name].help;var formatFunc=field_utils.format[column.attrs.widget];if(!formatFunc){formatFunc=field_utils.format[field.type];}
var formattedValue=formatFunc(value,field,{escape:true,digits:column.attrs.digits?JSON.parse(column.attrs.digits):undefined,});$cell.addClass('o_list_number').attr('title',help).html(formattedValue);}
return $cell;});},_renderBody:function(){var self=this;var $rows=this._renderRows();while($rows.length<4){$rows.push(self._renderEmptyRow());}
return $('<tbody>').append($rows);},_renderBodyCell:function(record,node,colIndex,options){var tdClassName='o_data_cell';if(node.tag==='button_group'){tdClassName+=' o_list_button';}else if(node.tag==='field'){tdClassName+=' o_field_cell';var typeClass=FIELD_CLASSES[this.state.fields[node.attrs.name].type];if(typeClass){tdClassName+=(' '+typeClass);}
if(node.attrs.widget){tdClassName+=(' o_'+node.attrs.widget+'_cell');}}
if(node.attrs.editOnly){tdClassName+=' oe_edit_only';}
if(node.attrs.readOnly){tdClassName+=' oe_read_only';}
var $td=$('<td>',{class:tdClassName,tabindex:-1});var modifiers=this._registerModifiers(node,record,$td,_.pick(options,'mode'));if(modifiers.invisible&&!(options&&options.renderInvisible)){return $td;}
if(node.tag==='button_group'){for(const buttonNode of node.children){if(!this.columnInvisibleFields[buttonNode.attrs.name]){$td.append(this._renderButton(record,buttonNode));}}
return $td;}else if(node.tag==='widget'){return $td.append(this._renderWidget(record,node));}
if(node.attrs.widget||(options&&options.renderWidgets)){var $el=this._renderFieldWidget(node,record,_.pick(options,'mode'));return $td.append($el);}
this._handleAttributes($td,node);this._setDecorationClasses($td,this.fieldDecorations[node.attrs.name],record);var name=node.attrs.name;var field=this.state.fields[name];var value=record.data[name];var formatter=field_utils.format[field.type];var formatOptions={escape:true,data:record.data,isPassword:'password'in node.attrs,digits:node.attrs.digits&&JSON.parse(node.attrs.digits),};var formattedValue=formatter(value,field,formatOptions);var title='';if(field.type!=='boolean'){title=formatter(value,field,_.extend(formatOptions,{escape:false}));}
return $td.html(formattedValue).attr('title',title);},_renderButton:function(record,node){var self=this;var nodeWithoutWidth=Object.assign({},node);delete nodeWithoutWidth.attrs.width;let extraClass='';if(node.attrs.icon){const btnStyleRegex=/\bbtn-[a-z]+\b/;if(!btnStyleRegex.test(nodeWithoutWidth.attrs.class)){extraClass='btn-link o_icon_button';}}
var $button=viewUtils.renderButtonFromNode(nodeWithoutWidth,{extraClass:extraClass,});this._handleAttributes($button,node);this._registerModifiers(node,record,$button);if(record.res_id){$button.on("click",function(e){e.stopPropagation();self.trigger_up('button_clicked',{attrs:node.attrs,record:record,});});}else{if(node.attrs.options.warn){$button.on("click",function(e){e.stopPropagation();self.do_warn(false,_t('Please click on the "save" button first'));});}else{$button.prop('disabled',true);}}
return $button;},_renderEmptyRow:function(){var $td=$('<td>&nbsp;</td>').attr('colspan',this._getNumberOfCols());return $('<tr>').append($td);},_renderFooter:function(){var aggregates={};_.each(this.columns,function(column){if('aggregate'in column){aggregates[column.attrs.name]=column.aggregate;}});var $cells=this._renderAggregateCells(aggregates);if(this.hasSelectors){$cells.unshift($('<td>'));}
return $('<tfoot>').append($('<tr>').append($cells));},_renderGroupButton:function(list,node){var $button=viewUtils.renderButtonFromNode(node,{extraClass:node.attrs.icon?'o_icon_button':undefined,textAsTitle:!!node.attrs.icon,});this._handleAttributes($button,node);this._registerModifiers(node,list.groupData,$button);$button.on("click",this._onGroupButtonClicked.bind(this,list.groupData,node));$button.on("keydown",this._onGroupButtonKeydown.bind(this));return $button;},_renderGroupButtons:function(list,group){var self=this;var $buttons=$();if(list.value){group.arch.children.forEach(function(child){if(child.tag==='button'){$buttons=$buttons.add(self._renderGroupButton(list,child));}});}
return $buttons;},_renderGroupRow:function(group,groupLevel){var cells=[];var name=group.value===undefined?_t('Undefined'):group.value;var groupBy=this.state.groupedBy[groupLevel];if(group.fields[groupBy.split(':')[0]].type!=='boolean'){name=name||_t('Undefined');}
var $th=$('<th>').addClass('o_group_name').attr('tabindex',-1).text(name+' ('+group.count+')');var $arrow=$('<span>').css('padding-left',2+(groupLevel*20)+'px').css('padding-right','5px').addClass('fa');if(group.count>0){$arrow.toggleClass('fa-caret-right',!group.isOpen).toggleClass('fa-caret-down',group.isOpen);}
$th.prepend($arrow);cells.push($th);var aggregateKeys=Object.keys(group.aggregateValues);var aggregateValues=_.mapObject(group.aggregateValues,function(value){return{value:value};});var aggregateCells=this._renderAggregateCells(aggregateValues);var firstAggregateIndex=_.findIndex(this.columns,function(column){return column.tag==='field'&&_.contains(aggregateKeys,column.attrs.name);});var colspanBeforeAggregate;if(firstAggregateIndex!==-1){colspanBeforeAggregate=firstAggregateIndex;var lastAggregateIndex=_.findLastIndex(this.columns,function(column){return column.tag==='field'&&_.contains(aggregateKeys,column.attrs.name);});cells=cells.concat(aggregateCells.slice(firstAggregateIndex,lastAggregateIndex+1));var colSpan=this.columns.length-1-lastAggregateIndex;if(colSpan>0){cells.push($('<th>').attr('colspan',colSpan));}}else{var colN=this.columns.length;colspanBeforeAggregate=colN>1?colN-1:1;if(colN>1){cells.push($('<th>'));}}
if(this.hasSelectors){colspanBeforeAggregate+=1;}
$th.attr('colspan',colspanBeforeAggregate);if(group.isOpen&&!group.groupedBy.length&&(group.count>group.data.length)){const lastCell=cells[cells.length-1][0];this._renderGroupPager(group,lastCell);}
if(group.isOpen&&this.groupbys[groupBy]){var $buttons=this._renderGroupButtons(group,this.groupbys[groupBy]);if($buttons.length){var $buttonSection=$('<div>',{class:'o_group_buttons',}).append($buttons);$th.append($buttonSection);}}
return $('<tr>').addClass('o_group_header').toggleClass('o_group_open',group.isOpen).toggleClass('o_group_has_content',group.count>0).data('group',group).append(cells);},_renderGroup:function(group,groupLevel){var self=this;if(group.groupedBy.length){return this._renderGroups(group.data,groupLevel+1);}else{var $records=_.map(group.data,function(record){return self._renderRow(record);});return[$('<tbody>').append($records)];}},_renderGroupPager:function(group,target){const currentMinimum=group.offset+1;const limit=group.limit;const size=group.count;if(!this._shouldRenderPager(currentMinimum,limit,size)){return;}
const pager=new ComponentWrapper(this,Pager,{currentMinimum,limit,size});const pagerMounting=pager.mount(target).then(()=>{pager.el.addEventListener('pager-changed',ev=>this._onPagerChanged(ev,group));pager.el.addEventListener('click',ev=>ev.stopPropagation());});this.defs.push(pagerMounting);this.pagers.push(pager);},_renderGroups:function(data,groupLevel){var self=this;groupLevel=groupLevel||0;var result=[];var $tbody=$('<tbody>');_.each(data,function(group){if(!$tbody){$tbody=$('<tbody>');}
$tbody.append(self._renderGroupRow(group,groupLevel));if(group.data.length){result.push($tbody);result=result.concat(self._renderGroup(group,groupLevel));$tbody=null;}});if($tbody){result.push($tbody);}
return result;},_renderHeader:function(){var $tr=$('<tr>').append(_.map(this.columns,this._renderHeaderCell.bind(this)));if(this.hasSelectors){$tr.prepend(this._renderSelector('th'));}
return $('<thead>').append($tr);},_renderHeaderCell:function(node){const{icon,name,string}=node.attrs;var order=this.state.orderedBy;var isNodeSorted=order[0]&&order[0].name===name;var field=this.state.fields[name];var $th=$('<th>');if(name){$th.attr('data-name',name);}else if(string){$th.attr('data-string',string);}else if(icon){$th.attr('data-icon',icon);}
if(node.attrs.editOnly){$th.addClass('oe_edit_only');}
if(node.attrs.readOnly){$th.addClass('oe_read_only');}
if(node.tag==='button_group'){$th.addClass('o_list_button');}
if(!field||node.attrs.nolabel==='1'){return $th;}
var description=string||field.string;if(node.attrs.widget){$th.addClass(' o_'+node.attrs.widget+'_cell');const FieldWidget=this.state.fieldsInfo.list[name].Widget;if(FieldWidget.prototype.noLabel){description='';}else if(FieldWidget.prototype.label){description=FieldWidget.prototype.label;}}
$th.text(description).attr('tabindex',-1).toggleClass('o-sort-down',isNodeSorted?!order[0].asc:false).toggleClass('o-sort-up',isNodeSorted?order[0].asc:false).addClass((field.sortable||this.state.fieldsInfo.list[name].options.allow_order||false)&&'o_column_sortable');if(isNodeSorted){$th.attr('aria-sort',order[0].asc?'ascending':'descending');}
if(field.type==='float'||field.type==='integer'||field.type==='monetary'){$th.addClass('o_list_number_th');}
if(config.isDebug()){var fieldDescr={field:field,name:name,string:description||name,record:this.state,attrs:_.extend({},node.attrs,this.state.fieldsInfo.list[name]),};this._addFieldTooltip(fieldDescr,$th);}else{$th.attr('title',description);}
return $th;},_renderRow:function(record){var self=this;var $cells=this.columns.map(function(node,index){return self._renderBodyCell(record,node,index,{mode:'readonly'});});var $tr=$('<tr/>',{class:'o_data_row'}).attr('data-id',record.id).append($cells);if(this.hasSelectors){$tr.prepend(this._renderSelector('td',!record.res_id));}
this._setDecorationClasses($tr,this.rowDecorations,record);return $tr;},_renderRows:function(){return this.state.data.map(this._renderRow.bind(this));},_renderOptionalColumnsDropdown:function(){var self=this;var $optionalColumnsDropdown=$('<div>',{class:'o_optional_columns text-center dropdown',});var $a=$("<a>",{'class':"dropdown-toggle text-dark o-no-caret",'href':"#",'role':"button",'data-toggle':"dropdown",'data-display':"static",'aria-expanded':false,'aria-label':_t('Optional columns'),});$a.appendTo($optionalColumnsDropdown);var direction=_t.database.parameters.direction;var dropdownMenuClass=direction==='rtl'?'dropdown-menu-left':'dropdown-menu-right';var $dropdown=$("<div>",{class:'dropdown-menu o_optional_columns_dropdown '+dropdownMenuClass,role:'menu',});this.optionalColumns.forEach(function(col){var txt=(col.attrs.string||self.state.fields[col.attrs.name].string)+
(config.isDebug()?(' ('+col.attrs.name+')'):'');var $checkbox=dom.renderCheckbox({text:txt,role:"menuitemcheckbox",prop:{name:col.attrs.name,checked:_.contains(self.optionalColumnsEnabled,col.attrs.name),}});$dropdown.append($("<div>",{class:"dropdown-item",}).append($checkbox));});$dropdown.appendTo($optionalColumnsDropdown);return $optionalColumnsDropdown;},_renderSelector:function(tag,disableInput){var $content=dom.renderCheckbox();if(disableInput){$content.find("input[type='checkbox']").prop('disabled',disableInput);}
return $('<'+tag+'>').addClass('o_list_record_selector').append($content);},async _renderView(){const oldPagers=this.pagers;let prom;let tableWrapper;if(this.state.count>0||!this.noContentHelp){this.pagers=[];const orderedBy=this.state.orderedBy;this.hasHandle=orderedBy.length===0||orderedBy[0].name===this.handleField;this._computeAggregates();const $table=$('<table class="o_list_table table table-sm table-hover table-striped"/>');$table.toggleClass('o_list_table_grouped',this.isGrouped);$table.toggleClass('o_list_table_ungrouped',!this.isGrouped);const defs=[];this.defs=defs;if(this.isGrouped){$table.append(this._renderHeader());$table.append(this._renderGroups(this.state.data));$table.append(this._renderFooter());}else{$table.append(this._renderHeader());$table.append(this._renderBody());$table.append(this._renderFooter());}
tableWrapper=Object.assign(document.createElement('div'),{className:'table-responsive',});tableWrapper.appendChild($table[0]);delete this.defs;prom=Promise.all(defs);}
await Promise.all([this._super.apply(this,arguments),prom]);this.el.innerHTML="";this.el.classList.remove('o_list_optional_columns');oldPagers.forEach(pager=>pager.destroy());if(tableWrapper){this.el.appendChild(tableWrapper);if(document.body.contains(this.el)){this.pagers.forEach(pager=>pager.on_attach_callback());}
if(this.optionalColumns.length){this.el.classList.add('o_list_optional_columns');this.$('table').append($('<i class="o_optional_columns_dropdown_toggle fa fa-ellipsis-v"/>'));this.$el.append(this._renderOptionalColumnsDropdown());}
if(this.selection.length){const $checked_rows=this.$('tr').filter((i,el)=>this.selection.includes(el.dataset.id));$checked_rows.find('.o_list_record_selector input').prop('checked',true);if($checked_rows.length===this.$('.o_data_row').length){this.$('thead .o_list_record_selector input').prop('checked',true);}}}
if(!this._hasContent()&&!!this.noContentHelp){this._renderNoContentHelper();}},_setDecorationClasses:function($el,decorations,record){for(const[cssClass,expr]of Object.entries(decorations)){$el.toggleClass(cssClass,py.PY_isTrue(py.evaluate(expr,record.evalContext)));}},_shouldRenderPager:function(currentMinimum,limit,size){if(!limit||!size){return false;}
const maximum=Math.min(currentMinimum+limit-1,size);const singlePage=(1===currentMinimum)&&(maximum===size);return!singlePage;},_updateFooter:function(){this._computeAggregates();this.$('tfoot').replaceWith(this._renderFooter());},_updateSelection:function(){const previousSelection=JSON.stringify(this.selection);this.selection=[];var self=this;var $inputs=this.$('tbody .o_list_record_selector input:visible:not(:disabled)');var allChecked=$inputs.length>0;$inputs.each(function(index,input){if(input.checked){self.selection.push($(input).closest('tr').data('id'));}else{allChecked=false;}});this.$('thead .o_list_record_selector input').prop('checked',allChecked);if(JSON.stringify(this.selection)!==previousSelection){this.trigger_up('selection_changed',{allChecked,selection:this.selection});}
this._updateFooter();},_onGroupButtonClicked:function(record,node,ev){ev.stopPropagation();if(node.attrs.type==='edit'){this.trigger_up('group_edit_button_clicked',{record:record,});}else{this.trigger_up('button_clicked',{attrs:node.attrs,record:record,});}},_onGroupButtonKeydown:function(ev){if(ev.keyCode===$.ui.keyCode.ENTER){ev.stopPropagation();}},_onToggleOptionalColumn:function(ev){var self=this;ev.stopPropagation();ev.preventDefault();var input=ev.currentTarget.querySelector('input');var fieldIndex=this.optionalColumnsEnabled.indexOf(input.name);if(fieldIndex>=0){this.optionalColumnsEnabled.splice(fieldIndex,1);}else{this.optionalColumnsEnabled.push(input.name);}
this.trigger_up('save_optional_fields',{keyParts:this._getOptionalColumnsStorageKeyParts(),optionalColumnsEnabled:this.optionalColumnsEnabled,});this._processColumns(this.columnInvisibleFields);this._render().then(function(){self._onToggleOptionalColumnDropdown(ev);});},_onToggleOptionalColumnDropdown:function(ev){ev.stopPropagation();this.$('.o_optional_columns .dropdown-toggle').dropdown('toggle');var position=(this.$(".table-responsive").css('overflow')==="auto"?this.$el.width():this.$('table').width());var direction="left";if(_t.database.parameters.direction==='rtl'){position=position-this.$('.o_optional_columns .o_optional_columns_dropdown').width();direction="right";}
this.$('.o_optional_columns').css(direction,position);},_onKeyDown:function(ev){var $cell=$(ev.currentTarget);var $tr;var $futureCell;var colIndex;if(this.state.isSample){return;}
switch(ev.keyCode){case $.ui.keyCode.LEFT:ev.preventDefault();$tr=$cell.closest('tr');$tr.closest('tbody').addClass('o_keyboard_navigation');if($tr.hasClass('o_group_header')&&$tr.hasClass('o_group_open')){this._onToggleGroup(ev);}else{$futureCell=$cell.prev();}
break;case $.ui.keyCode.RIGHT:ev.preventDefault();$tr=$cell.closest('tr');$tr.closest('tbody').addClass('o_keyboard_navigation');if($tr.hasClass('o_group_header')&&!$tr.hasClass('o_group_open')){this._onToggleGroup(ev);}else{$futureCell=$cell.next();}
break;case $.ui.keyCode.UP:ev.preventDefault();$cell.closest('tbody').addClass('o_keyboard_navigation');colIndex=this.currentColIndex||$cell.index();$futureCell=this._findConnectedCell($cell,'prev',colIndex);if(!$futureCell){this.trigger_up('navigation_move',{direction:'up'});}
break;case $.ui.keyCode.DOWN:ev.preventDefault();$cell.closest('tbody').addClass('o_keyboard_navigation');colIndex=this.currentColIndex||$cell.index();$futureCell=this._findConnectedCell($cell,'next',colIndex);break;case $.ui.keyCode.ENTER:ev.preventDefault();$tr=$cell.closest('tr');if($tr.hasClass('o_group_header')){this._onToggleGroup(ev);}else{var id=$tr.data('id');if(id){this.trigger_up('open_record',{id:id,target:ev.target});}}
break;}
if($futureCell){var isInGroupHeader=$futureCell.closest('tr').hasClass('o_group_header');var $activables=!isInGroupHeader&&$futureCell.find(':focusable');if($activables.length){$activables[0].focus();}else{$futureCell.focus();}}},_onMouseDown:function(){$('.o_keyboard_navigation').removeClass('o_keyboard_navigation');},_onPagerChanged:async function(ev,group){ev.stopPropagation();const{currentMinimum,limit}=ev.detail;this.trigger_up('load',{id:group.id,limit:limit,offset:currentMinimum-1,on_success:reloadedGroup=>{Object.assign(group,reloadedGroup);this._render();},});},_onRowClicked:function(ev){if(!ev.target.closest('.o_list_record_selector')&&!$(ev.target).prop('special_click')){var id=$(ev.currentTarget).data('id');if(id){this.trigger_up('open_record',{id:id,target:ev.target});}}},_onSelectRecord:function(ev){ev.stopPropagation();this._updateSelection();},_onSortColumn:function(ev){var name=$(ev.currentTarget).data('name');this.trigger_up('toggle_column_order',{id:this.state.id,name:name});},_onToggleCheckbox:function(ev){const $recordSelector=$(ev.target).find('input[type=checkbox]:not(":disabled")');$recordSelector.prop('checked',!$recordSelector.prop("checked"));$recordSelector.change();},_onToggleGroup:function(ev){ev.preventDefault();var group=$(ev.currentTarget).closest('tr').data('group');if(group.count){this.trigger_up('toggle_group',{group:group,onSuccess:()=>{this._updateSelection();if(document.activeElement.tagName==='BODY'){var groupHeaders=$('tr.o_group_header:data("group")');var header=groupHeaders.filter(function(){return $(this).data('group').id===group.id;});header.find('.o_group_name').focus();}},});}},_onToggleSelection:function(ev){var checked=$(ev.currentTarget).prop('checked')||false;this.$('tbody .o_list_record_selector input:not(":disabled")').prop('checked',checked);this._updateSelection();},});return ListRenderer;});;

/* /web/static/src/js/views/list/list_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.ListView',function(require){"use strict";var BasicView=require('web.BasicView');var core=require('web.core');var ListModel=require('web.ListModel');var ListRenderer=require('web.ListRenderer');var ListController=require('web.ListController');var pyUtils=require('web.py_utils');var _lt=core._lt;var ListView=BasicView.extend({accesskey:"l",display_name:_lt('List'),icon:'fa-list-ul',config:_.extend({},BasicView.prototype.config,{Model:ListModel,Renderer:ListRenderer,Controller:ListController,}),viewType:'list',init:function(viewInfo,params){var self=this;this._super.apply(this,arguments);var selectedRecords=[];var pyevalContext=py.dict.fromJSON(_.pick(params.context,function(value,key,object){return!_.isUndefined(value)})||{});var expandGroups=!!JSON.parse(pyUtils.py_eval(this.arch.attrs.expand||"0",{'context':pyevalContext}));this.groupbys={};this.headerButtons=[];this.arch.children.forEach(function(child){if(child.tag==='groupby'){self._extractGroup(child);}
if(child.tag==='header'){self._extractHeaderButtons(child);}});let editable=false;if((!this.arch.attrs.edit||!!JSON.parse(this.arch.attrs.edit))&&!params.readonly){editable=this.arch.attrs.editable;}
this.controllerParams.activeActions.export_xlsx=this.arch.attrs.export_xlsx?!!JSON.parse(this.arch.attrs.export_xlsx):true;this.controllerParams.editable=editable;this.controllerParams.hasActionMenus=params.hasActionMenus;this.controllerParams.headerButtons=this.headerButtons;this.controllerParams.toolbarActions=viewInfo.toolbar;this.controllerParams.mode='readonly';this.controllerParams.selectedRecords=selectedRecords;this.rendererParams.arch=this.arch;this.rendererParams.groupbys=this.groupbys;this.rendererParams.hasSelectors='hasSelectors'in params?params.hasSelectors:true;this.rendererParams.editable=editable;this.rendererParams.selectedRecords=selectedRecords;this.rendererParams.addCreateLine=false;this.rendererParams.addCreateLineInGroups=editable&&this.controllerParams.activeActions.create;this.rendererParams.isMultiEditable=this.arch.attrs.multi_edit&&!!JSON.parse(this.arch.attrs.multi_edit);this.modelParams.groupbys=this.groupbys;this.loadParams.limit=this.loadParams.limit||80;this.loadParams.openGroupByDefault=expandGroups;this.loadParams.type='list';var groupsLimit=parseInt(this.arch.attrs.groups_limit,10);this.loadParams.groupsLimit=groupsLimit||(expandGroups?10:80);},_extractGroup:function(node){var innerView=this.fields[node.attrs.name].views.groupby;this.groupbys[node.attrs.name]=this._processFieldsView(innerView,'groupby');},_extractHeaderButtons(node){node.children.forEach(child=>{if(child.tag==='button'&&!child.attrs.modifiers.invisible){this.headerButtons.push(child);}});},_extractParamsFromAction:function(action){var params=this._super.apply(this,arguments);var inDialog=action.target==='new';var inline=action.target==='inline';params.hasActionMenus=!inDialog&&!inline;return params;},_updateMVCParams:function(){this._super.apply(this,arguments);this.controllerParams.noLeaf=!!this.loadParams.context.group_by_no_leaf;},});return ListView;});;

/* /web/static/src/js/views/list/list_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.ListController',function(require){"use strict";var core=require('web.core');var BasicController=require('web.BasicController');var DataExport=require('web.DataExport');var Dialog=require('web.Dialog');var ListConfirmDialog=require('web.ListConfirmDialog');var session=require('web.session');const viewUtils=require('web.viewUtils');var _t=core._t;var qweb=core.qweb;var ListController=BasicController.extend({buttons_template:'ListView.buttons',events:_.extend({},BasicController.prototype.events,{'click .o_list_export_xlsx':'_onDirectExportData','click .o_list_select_domain':'_onSelectDomain',}),custom_events:_.extend({},BasicController.prototype.custom_events,{activate_next_widget:'_onActivateNextWidget',add_record:'_onAddRecord',button_clicked:'_onButtonClicked',group_edit_button_clicked:'_onEditGroupClicked',edit_line:'_onEditLine',save_line:'_onSaveLine',selection_changed:'_onSelectionChanged',toggle_column_order:'_onToggleColumnOrder',toggle_group:'_onToggleGroup',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.hasActionMenus=params.hasActionMenus;this.headerButtons=params.headerButtons||[];this.toolbarActions=params.toolbarActions||{};this.editable=params.editable;this.noLeaf=params.noLeaf;this.selectedRecords=params.selectedRecords||[];this.multipleRecordsSavingPromise=null;this.fieldChangedPrevented=false;this.lastFieldChangedEvent=null;this.isPageSelected=false;this.isDomainSelected=false;this.isExportEnable=false;},willStart(){const sup=this._super(...arguments);const acl=session.user_has_group('base.group_allow_export').then(hasGroup=>{this.isExportEnable=hasGroup;});return Promise.all([sup,acl]);},getOwnedQueryParams:function(){var state=this._super.apply(this,arguments);var orderedBy=this.model.get(this.handle,{raw:true}).orderedBy||[];return _.extend({},state,{orderedBy:orderedBy});},getSelectedIds:function(){return _.map(this.getSelectedRecords(),function(record){return record.res_id;});},getSelectedIdsWithDomain:async function(){if(this.isDomainSelected){const state=this.model.get(this.handle,{raw:true});return await this._domainToResIds(state.getDomain(),session.active_ids_limit);}else{return Promise.resolve(this.model.localIdsToResIds(this.selectedRecords));}},getSelectedRecords:function(){var self=this;return _.map(this.selectedRecords,function(db_id){return self.model.get(db_id,{raw:true});});},renderButtons:function($node){if(this.noLeaf||!this.hasButtons){this.hasButtons=false;this.$buttons=$('<div>');}else{this.$buttons=$(qweb.render(this.buttons_template,{widget:this}));this.$buttons.on('click','.o_list_button_add',this._onCreateRecord.bind(this));this._assignCreateKeyboardBehavior(this.$buttons.find('.o_list_button_add'));this.$buttons.find('.o_list_button_add').tooltip({delay:{show:200,hide:0},title:function(){return qweb.render('CreateButton.tooltip');},trigger:'manual',});this.$buttons.on('mousedown','.o_list_button_discard',this._onDiscardMousedown.bind(this));this.$buttons.on('click','.o_list_button_discard',this._onDiscard.bind(this));}
if($node){this.$buttons.appendTo($node);}},_renderHeaderButtons(){if(this.$headerButtons){this.$headerButtons.remove();this.$headerButtons=null;}
if(!this.headerButtons.length||!this.selectedRecords.length){return;}
const btnClasses='btn-primary btn-secondary btn-link btn-success btn-info btn-warning btn-danger'.split(' ');let $elms=$();this.headerButtons.forEach(node=>{const $btn=viewUtils.renderButtonFromNode(node);$btn.addClass('btn');if(!btnClasses.some(cls=>$btn.hasClass(cls))){$btn.addClass('btn-secondary');}
$btn.on("click",this._onHeaderButtonClicked.bind(this,node));$elms=$elms.add($btn);});this.$headerButtons=$elms;this.$headerButtons.appendTo(this.$buttons);},update:function(params,options){var self=this;let res_ids;if(options&&options.keepSelection){res_ids=this.model.get(this.handle).res_ids;this.selectedRecords=_.filter(this.selectedRecords,function(id){return _.contains(res_ids,self.model.get(id).res_id);});}else{this.selectedRecords=[];}
if(this.selectedRecords.length===0||this.selectedRecords.length<res_ids.length){this.isDomainSelected=false;this.isPageSelected=false;}
params.selectedRecords=this.selectedRecords;return this._super.apply(this,arguments);},updateButtons:function(mode){if(this.hasButtons){this.$buttons.toggleClass('o-editing',mode==='edit');const state=this.model.get(this.handle,{raw:true});if(state.count){this.$buttons.find('.o_list_export_xlsx').show();}else{this.$buttons.find('.o_list_export_xlsx').hide();}}
this._updateSelectionBox();},_abandonRecord:function(recordID){this._super.apply(this,arguments);if((recordID||this.handle)!==this.handle){var state=this.model.get(this.handle);this.renderer.removeLine(state,recordID);this._updatePaging(state);}},_addRecord:function(dataPointId){var self=this;this._disableButtons();return this._removeSampleData(()=>{return this.renderer.unselectRow().then(function(){return self.model.addDefaultRecord(dataPointId,{position:self.editable,});}).then(function(recordID){var state=self.model.get(self.handle);self._updateRendererState(state,{keepWidths:true}).then(function(){self.renderer.editRecord(recordID);}).then(()=>{self._updatePaging(state);});}).then(this._enableButtons.bind(this)).guardedCatch(this._enableButtons.bind(this));});},_assignCreateKeyboardBehavior:function($createButton){var self=this;$createButton.on('keydown',function(e){$createButton.tooltip('hide');switch(e.which){case $.ui.keyCode.ENTER:e.preventDefault();self._onCreateRecord.apply(self);break;case $.ui.keyCode.DOWN:e.preventDefault();self._giveFocus();break;case $.ui.keyCode.TAB:if(!e.shiftKey&&e.target.classList.contains("btn-primary")&&!self.model.isInSampleMode()){e.preventDefault();$createButton.tooltip('show');}
break;}});},_confirmSave:function(id){var state=this.model.get(this.handle);return this._updateRendererState(state,{noRender:true}).then(this._setMode.bind(this,'readonly',id));},_deleteRecordsInCurrentDomain:function(){const doIt=async()=>{const state=this.model.get(this.handle,{raw:true});const resIds=await this._domainToResIds(state.getDomain(),session.active_ids_limit);await this._rpc({model:this.modelName,method:'unlink',args:[resIds],context:state.getContext(),});if(resIds.length===session.active_ids_limit){const msg=_.str.sprintf(_t("Only the first %d records have been deleted (out of %d selected)"),resIds.length,state.count);this.do_notify(false,msg);}
this.reload();};if(this.confirmOnDelete){Dialog.confirm(this,_t("Are you sure you want to delete these records ?"),{confirm_callback:doIt,});}else{doIt();}},_discardChanges:function(recordID){if((recordID||this.handle)===this.handle){recordID=this.renderer.getEditableRecordID();if(recordID===null){return Promise.resolve();}}
var self=this;return this._super(recordID).then(function(){self.updateButtons('readonly');});},_domainToResIds:function(domain,limit){return this._rpc({model:this.modelName,method:'search',args:[domain],kwargs:{limit:limit,},});},_getExportDialogWidget(){let state=this.model.get(this.handle);let defaultExportFields=this.renderer.columns.filter(field=>field.tag==='field'&&state.fields[field.attrs.name].exportable!==false).map(field=>field.attrs.name);let groupedBy=this.renderer.state.groupedBy;const domain=this.isDomainSelected&&state.getDomain();return new DataExport(this,state,defaultExportFields,groupedBy,domain,this.getSelectedIds());},_getPagingInfo:function(state){if(!state.count){return null;}
return this._super(...arguments);},_getActionMenuItems:function(state){if(!this.hasActionMenus||!this.selectedRecords.length){return null;}
const props=this._super(...arguments);const otherActionItems=[];if(this.isExportEnable){otherActionItems.push({description:_t("Export"),callback:()=>this._onExportData()});}
if(this.archiveEnabled){otherActionItems.push({description:_t("Archive"),callback:()=>{Dialog.confirm(this,_t("Are you sure that you want to archive all the selected records?"),{confirm_callback:()=>this._toggleArchiveState(true),});}},{description:_t("Unarchive"),callback:()=>this._toggleArchiveState(false)});}
if(this.activeActions.delete){otherActionItems.push({description:_t("Delete"),callback:()=>this._onDeleteSelectedRecords()});}
return Object.assign(props,{items:Object.assign({},this.toolbarActions,{other:otherActionItems}),context:state.getContext(),domain:state.getDomain(),isDomainSelected:this.isDomainSelected,});},_saveMultipleRecords:function(recordId,node,changes){var fieldName=Object.keys(changes)[0];var value=Object.values(changes)[0];var recordIds=_.union([recordId],this.selectedRecords);var validRecordIds=recordIds.reduce((result,nextRecordId)=>{var record=this.model.get(nextRecordId);var modifiers=this.renderer._registerModifiers(node,record);if(!modifiers.readonly&&(!modifiers.required||value)){result.push(nextRecordId);}
return result;},[]);return new Promise((resolve,reject)=>{const saveRecords=()=>{this.model.saveRecords(this.handle,recordId,validRecordIds,fieldName).then(async()=>{this.updateButtons('readonly');const state=this.model.get(this.handle);this.selectedRecords=[];await this._updateRendererState(state,{keepWidths:true,selectedRecords:[],});this._updateSelectionBox();this.renderer.focusCell(recordId,node);resolve(!Object.keys(changes).length);}).guardedCatch(discardAndReject);};const discardAndReject=()=>{this.model.discardChanges(recordId);this._confirmSave(recordId).then(()=>{this.renderer.focusCell(recordId,node);reject();});};if(validRecordIds.length>0){if(recordIds.length===1){return saveRecords();}
const dialogOptions={confirm_callback:saveRecords,cancel_callback:discardAndReject,};const record=this.model.get(recordId);const dialogChanges={isDomainSelected:this.isDomainSelected,fieldLabel:node.attrs.string||record.fields[fieldName].string,fieldName:node.attrs.name,nbRecords:recordIds.length,nbValidRecords:validRecordIds.length,};new ListConfirmDialog(this,record,dialogChanges,dialogOptions).open({shouldFocusButtons:true});}else{Dialog.alert(this,_t("No valid record to save"),{confirm_callback:discardAndReject,});}});},_saveRecord:function(recordId){var record=this.model.get(recordId,{raw:true});if(record.isDirty()&&this.renderer.isInMultipleRecordEdition(recordId)){if(!this.multipleRecordsSavingPromise&&this.lastFieldChangedEvent){this._onFieldChanged(this.lastFieldChangedEvent);this.lastFieldChangedEvent=null;}
const prom=this.multipleRecordsSavingPromise||Promise.reject();this.multipleRecordsSavingPromise=null;return prom;}
return this._super.apply(this,arguments);},_setMode:function(mode,recordID){if((recordID||this.handle)!==this.handle){this.mode=mode;this.updateButtons(mode);return this.renderer.setRowMode(recordID,mode);}else{return this._super.apply(this,arguments);}},_shouldBounceOnClick(){const state=this.model.get(this.handle,{raw:true});return!state.count||state.isSample;},_toggleArchiveState:async function(archive){const resIds=await this.getSelectedIdsWithDomain()
const notif=this.isDomainSelected;await this._archive(resIds,archive);const total=this.model.get(this.handle,{raw:true}).count;if(notif&&resIds.length===session.active_ids_limit&&resIds.length<total){const msg=_.str.sprintf(_t("Of the %d records selected, only the first %d have been archived/unarchived."),total,resIds.length);this.do_notify(_t('Warning'),msg);}},_toggleCreateButton:function(){if(this.hasButtons){var state=this.model.get(this.handle);var createHidden=this.editable&&state.groupedBy.length&&state.data.length;this.$buttons.find('.o_list_button_add').toggleClass('o_hidden',!!createHidden);}},_update:async function(){await this._super(...arguments);this._toggleCreateButton();this.updateButtons('readonly');},_updateSelectionBox(){if(this.$selectionBox){this.$selectionBox.remove();this.$selectionBox=null;}
if(this.selectedRecords.length){const state=this.model.get(this.handle,{raw:true});this.$selectionBox=$(qweb.render('ListView.selection',{isDomainSelected:this.isDomainSelected,isPageSelected:this.isPageSelected,nbSelected:this.selectedRecords.length,nbTotal:state.count,}));this.$selectionBox.appendTo(this.$buttons);}
this._renderHeaderButtons();},_onActivateNextWidget:function(ev){ev.stopPropagation();this.renderer.editFirstRecord(ev);},_onAddRecord:function(ev){ev.stopPropagation();var dataPointId=ev.data.groupId||this.handle;if(this.activeActions.create){this._addRecord(dataPointId);}else if(ev.data.onFail){ev.data.onFail();}},_onButtonClicked:function(ev){ev.stopPropagation();this._callButtonAction(ev.data.attrs,ev.data.record);},_onCreateRecord:function(ev){if(ev){ev.stopPropagation();}
var state=this.model.get(this.handle,{raw:true});if(this.editable&&!state.groupedBy.length){this._addRecord(this.handle);}else{this.trigger_up('switch_view',{view_type:'form',res_id:undefined});}},_onDeleteSelectedRecords:async function(){if(this.isDomainSelected){this._deleteRecordsInCurrentDomain();}else{this._deleteRecords(this.selectedRecords);}},_onDiscard:function(ev){ev.stopPropagation();this._discardChanges().then(()=>{this.lastFieldChangedEvent=null;});},_onDiscardMousedown:function(ev){var self=this;this.fieldChangedPrevented=true;window.addEventListener('mouseup',function(mouseupEvent){var preventedEvent=self.fieldChangedPrevented;self.fieldChangedPrevented=false;if(ev.target!==mouseupEvent.target&&preventedEvent.constructor.name==='OdooEvent'){self._onFieldChanged(preventedEvent);}},{capture:true,once:true});},_onEditLine:function(ev){var self=this;ev.stopPropagation();this.trigger_up('mutexify',{action:function(){self._setMode('edit',ev.data.recordId).then(ev.data.onSuccess);},});},_onExportData:function(){this._getExportDialogWidget().open();},_onDirectExportData(){return this._rpc({model:'ir.exports',method:'search_read',args:[[],['id']],limit:1,}).then(()=>this._getExportDialogWidget().export())},_onEditGroupClicked:function(ev){ev.stopPropagation();this.do_action({context:{create:false},type:'ir.actions.act_window',views:[[false,'form']],res_model:ev.data.record.model,res_id:ev.data.record.res_id,flags:{mode:'edit'},});},_onFieldChanged:function(ev){ev.stopPropagation();const recordId=ev.data.dataPointID;this.lastFieldChangedEvent=ev;if(this.fieldChangedPrevented){this.fieldChangedPrevented=ev;}else if(this.renderer.isInMultipleRecordEdition(recordId)){const saveMulti=()=>{const target=ev.data.__originalComponent||ev.target;this.multipleRecordsSavingPromise=this._saveMultipleRecords(ev.data.dataPointID,target.__node,ev.data.changes);};ev.data.onSuccess=saveMulti;ev.data.onFailure=saveMulti;ev.data.notifyChange=false;ev.data.force_save=false;}
this._super.apply(this,arguments);},async _onHeaderButtonClicked(node){this._disableButtons();const state=this.model.get(this.handle);try{const resIds=await this.getSelectedIdsWithDomain();const actionData=Object.assign({},node.attrs,{context:state.getContext({additionalContext:node.attrs.context}),});Object.assign(actionData.context,{active_domain:state.getDomain(),active_id:resIds[0],active_ids:resIds,active_model:state.model,});const recordData={context:state.getContext(),model:state.model,resIDs:resIds,};await this._executeButtonAction(actionData,recordData);}finally{this._enableButtons();}},_onSaveLine:function(ev){this.saveRecord(ev.data.recordID).then(ev.data.onSuccess).guardedCatch(ev.data.onFailure);},_onSelectDomain:function(ev){ev.preventDefault();this.isDomainSelected=true;this._updateSelectionBox();this._updateControlPanel();},_onSelectionChanged:function(ev){this.selectedRecords=ev.data.selection;this.isPageSelected=ev.data.allChecked;this.isDomainSelected=false;this.$('.o_list_export_xlsx').toggle(!this.selectedRecords.length);this._updateSelectionBox();this._updateControlPanel();},_onSetDirty:function(ev){var recordId=ev.data.dataPointID;if(this.renderer.isInMultipleRecordEdition(recordId)){ev.stopPropagation();Dialog.alert(this,_t("No valid record to save"),{confirm_callback:async()=>{this.model.discardChanges(recordId);await this._confirmSave(recordId);this.renderer.focusCell(recordId,ev.target.__node);},});}else{this._super.apply(this,arguments);}},_onToggleColumnOrder:function(ev){ev.stopPropagation();var state=this.model.get(this.handle);if(!state.groupedBy){this._updatePaging(state,{currentMinimum:1});}
var self=this;this.model.setSort(state.id,ev.data.name).then(function(){self.update({});});},_onToggleGroup:function(ev){ev.stopPropagation();var self=this;this.model.toggleGroup(ev.data.group.id).then(function(){self.update({},{keepSelection:true,reload:false}).then(function(){if(ev.data.onSuccess){ev.data.onSuccess();}});});},});return ListController;});;

/* /web/static/src/js/views/list/list_confirm_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('web.ListConfirmDialog',function(require){"use strict";const core=require('web.core');const Dialog=require('web.Dialog');const FieldWrapper=require('web.FieldWrapper');const{WidgetAdapterMixin}=require('web.OwlCompatibility');const utils=require('web.utils');const _t=core._t;const qweb=core.qweb;const ListConfirmDialog=Dialog.extend(WidgetAdapterMixin,{init:function(parent,record,changes,options){options=Object.assign({},options,{$content:$(qweb.render('ListView.confirmModal',{changes})),buttons:options.buttons||[{text:_t("Ok"),classes:'btn-primary',close:true,click:options.confirm_callback,},{text:_t("Cancel"),close:true,click:options.cancel_callback,}],onForceClose:options.cancel_callback,size:options.size||'medium',title:options.title||_t("Confirmation"),});this._super(parent,options);const Widget=record.fieldsInfo.list[changes.fieldName].Widget;const widgetOptions={mode:'readonly',viewType:'list',noOpen:true,};this.isLegacyWidget=!utils.isComponent(Widget);if(this.isLegacyWidget){this.fieldWidget=new Widget(this,changes.fieldName,record,widgetOptions);}else{this.fieldWidget=new FieldWrapper(this,Widget,{fieldName:changes.fieldName,record,options:widgetOptions,});}},willStart:function(){let widgetProm;if(this.isLegacyWidget){widgetProm=this.fieldWidget._widgetRenderAndInsert(function(){});}else{widgetProm=this.fieldWidget.mount(document.createDocumentFragment());}
return Promise.all([widgetProm,this._super.apply(this,arguments)]);},start:function(){this.$content.find('.o_changes_widget').replaceWith(this.fieldWidget.$el);this.fieldWidget.el.style.pointerEvents='none';return this._super.apply(this,arguments);},destroy:function(){WidgetAdapterMixin.destroy.call(this);this._super();},});return ListConfirmDialog;});;

/* /web/static/src/js/views/pivot/pivot_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.PivotModel',function(require){"use strict";var AbstractModel=require('web.AbstractModel');var concurrency=require('web.concurrency');var core=require('web.core');var dataComparisonUtils=require('web.dataComparisonUtils');const Domain=require('web.Domain');var mathUtils=require('web.mathUtils');var session=require('web.session');var _t=core._t;var cartesian=mathUtils.cartesian;var computeVariation=dataComparisonUtils.computeVariation;var sections=mathUtils.sections;var PivotModel=AbstractModel.extend({init:function(){this._super.apply(this,arguments);this.numbering={};this.data=null;this._loadDataDropPrevious=new concurrency.DropPrevious();},addGroupBy:function(groupBy,type){if(type==='row'){this.data.expandedRowGroupBys.push(groupBy);}else{this.data.expandedColGroupBys.push(groupBy);}},closeGroup:function(groupId,type){var groupBys;var expandedGroupBys;let keyPart;var group;var tree;if(type==='row'){groupBys=this.data.rowGroupBys;expandedGroupBys=this.data.expandedRowGroupBys;tree=this.rowGroupTree;group=this._findGroup(this.rowGroupTree,groupId[0]);keyPart=0;}else{groupBys=this.data.colGroupBys;expandedGroupBys=this.data.expandedColGroupBys;tree=this.colGroupTree;group=this._findGroup(this.colGroupTree,groupId[1]);keyPart=1;}
const groupIdPart=groupId[keyPart];const range=groupIdPart.map((_,index)=>index);function keep(key){const idPart=JSON.parse(key)[keyPart];return range.some(index=>groupIdPart[index]!==idPart[index])||idPart.length===groupIdPart.length;}
function omitKeys(object){const newObject={};for(const key in object){if(keep(key)){newObject[key]=object[key];}}
return newObject;}
this.measurements=omitKeys(this.measurements);this.counts=omitKeys(this.counts);this.groupDomains=omitKeys(this.groupDomains);group.directSubTrees.clear();delete group.sortedKeys;var newGroupBysLength=this._getTreeHeight(tree)-1;if(newGroupBysLength<=groupBys.length){expandedGroupBys.splice(0);groupBys.splice(newGroupBysLength);}else{expandedGroupBys.splice(newGroupBysLength-groupBys.length);}},expandAll:function(){return this._loadData();},expandGroup:async function(group,groupBy){var leftDivisors;var rightDivisors;if(group.type==='row'){leftDivisors=[[groupBy]];rightDivisors=sections(this._getGroupBys().colGroupBys);}else{leftDivisors=sections(this._getGroupBys().rowGroupBys);rightDivisors=[[groupBy]];}
var divisors=cartesian(leftDivisors,rightDivisors);delete group.type;return this._subdivideGroup(group,divisors);},exportData:function(){var measureCount=this.data.measures.length;var originCount=this.data.origins.length;var table=this._getTable();var headers=table.headers;var colGroupHeaderRows;var measureRow=[];var originRow=[];function processHeader(header){var inTotalColumn=header.groupId[1].length===0;return{title:header.title,width:header.width,height:header.height,is_bold:!!header.measure&&inTotalColumn};}
if(originCount>1){colGroupHeaderRows=headers.slice(0,headers.length-2);measureRow=headers[headers.length-2].map(processHeader);originRow=headers[headers.length-1].map(processHeader);}else{colGroupHeaderRows=headers.slice(0,headers.length-1);measureRow=headers[headers.length-1].map(processHeader);}
colGroupHeaderRows[0].splice(0,1);colGroupHeaderRows=colGroupHeaderRows.map(function(headerRow){return headerRow.map(processHeader);});var tableRows=table.rows.map(function(row){return{title:row.title,indent:row.indent,values:row.subGroupMeasurements.map(function(measurement){var value=measurement.value;if(value===undefined){value="";}else if(measurement.originIndexes.length>1){value=value*100;}
return{is_bold:measurement.isBold,value:value,};}),};});return{col_group_headers:colGroupHeaderRows,measure_headers:measureRow,origin_headers:originRow,rows:tableRows,measure_count:measureCount,origin_count:originCount,};},flip:function(){var temp=this.rowGroupTree;this.rowGroupTree=this.colGroupTree;this.colGroupTree=temp;temp=this.data.rowGroupBys;this.data.groupedBy=this.data.colGroupBys;this.data.rowGroupBys=this.data.colGroupBys;this.data.colGroupBys=temp;temp=this.data.expandedColGroupBys;this.data.expandedColGroupBys=this.data.expandedRowGroupBys;this.data.expandedRowGroupBys=temp;function twistKey(key){return JSON.stringify(JSON.parse(key).reverse());}
function twist(object){var newObject={};Object.keys(object).forEach(function(key){var value=object[key];newObject[twistKey(key)]=value;});return newObject;}
this.measurements=twist(this.measurements);this.counts=twist(this.counts);this.groupDomains=twist(this.groupDomains);},__get:function(options){options=options||{};var raw=options.raw||false;var groupBys=this._getGroupBys();var state={colGroupBys:groupBys.colGroupBys,context:this.data.context,domain:this.data.domain,fields:this.fields,hasData:this._hasData(),isSample:this.isSampleModel,measures:this.data.measures,origins:this.data.origins,rowGroupBys:groupBys.rowGroupBys,selectionGroupBys:this._getSelectionGroupBy(groupBys),modelName:this.modelName};if(!raw&&state.hasData){state.table=this._getTable();state.tree=this.rowGroupTree;}
return state;},getTableWidth:function(){var leafCounts=this._getLeafCounts(this.colGroupTree);return leafCounts[JSON.stringify(this.colGroupTree.root.values)]+2;},__load:function(params){this.initialDomain=params.domain;this.initialRowGroupBys=params.context.pivot_row_groupby||params.rowGroupBys;this.defaultGroupedBy=params.groupedBy;this.fields=params.fields;this.modelName=params.modelName;this.groupableFields=params.groupableFields;const measures=this._processMeasures(params.context.pivot_measures)||params.measures.map(m=>m);this.data={expandedRowGroupBys:[],expandedColGroupBys:[],domain:this.initialDomain,context:_.extend({},session.user_context,params.context),groupedBy:params.context.pivot_row_groupby||params.groupedBy,colGroupBys:params.context.pivot_column_groupby||params.colGroupBys,measures,timeRanges:params.timeRanges,};this._computeDerivedParams();this.data.groupedBy=this.data.groupedBy.slice();this.data.rowGroupBys=!_.isEmpty(this.data.groupedBy)?this.data.groupedBy:this.initialRowGroupBys.slice();var defaultOrder=params.default_order&&params.default_order.split(' ');if(defaultOrder){this.data.sortedColumn={groupId:[[],[]],measure:defaultOrder[0],order:defaultOrder[1]?defaultOrder[1]:'asc',};}
return this._loadData();},__reload:function(handle,params){var self=this;var oldColGroupBys=this.data.colGroupBys;var oldRowGroupBys=this.data.rowGroupBys;if('context'in params){this.data.context=params.context;this.data.colGroupBys=params.context.pivot_column_groupby||this.data.colGroupBys;this.data.groupedBy=params.context.pivot_row_groupby||this.data.groupedBy;this.data.measures=this._processMeasures(params.context.pivot_measures)||this.data.measures;this.defaultGroupedBy=this.data.groupedBy.length?this.data.groupedBy:this.defaultGroupedBy;}
if('domain'in params){this.data.domain=params.domain;this.initialDomain=params.domain;}else{this.data.domain=this.initialDomain;}
if('groupBy'in params){this.data.groupedBy=params.groupBy.length?params.groupBy:this.defaultGroupedBy;}
if('timeRanges'in params){this.data.timeRanges=params.timeRanges;}
this._computeDerivedParams();this.data.groupedBy=this.data.groupedBy.slice();this.data.rowGroupBys=!_.isEmpty(this.data.groupedBy)?this.data.groupedBy:this.initialRowGroupBys.slice();if(!_.isEqual(oldRowGroupBys,self.data.rowGroupBys)){this.data.expandedRowGroupBys=[];}
if(!_.isEqual(oldColGroupBys,self.data.colGroupBys)){this.data.expandedColGroupBys=[];}
if('measure'in params){return this._toggleMeasure(params.measure);}
if(!this._hasData()){return this._loadData();}
var oldRowGroupTree=this.rowGroupTree;var oldColGroupTree=this.colGroupTree;return this._loadData().then(function(){if(_.isEqual(oldRowGroupBys,self.data.rowGroupBys)){self._pruneTree(self.rowGroupTree,oldRowGroupTree);}
if(_.isEqual(oldColGroupBys,self.data.colGroupBys)){self._pruneTree(self.colGroupTree,oldColGroupTree);}});},sortRows:function(sortedColumn){var self=this;var colGroupValues=sortedColumn.groupId[1];sortedColumn.originIndexes=sortedColumn.originIndexes||[0];this.data.sortedColumn=sortedColumn;var sortFunction=function(tree){return function(subTreeKey){var subTree=tree.directSubTrees.get(subTreeKey);var groupIntersectionId=[subTree.root.values,colGroupValues];var value=self._getCellValue(groupIntersectionId,sortedColumn.measure,sortedColumn.originIndexes)||0;return sortedColumn.order==='asc'?value:-value;};};this._sortTree(sortFunction,this.rowGroupTree);},_addGroup:function(groupTree,labels,values){var tree=groupTree;values.slice(0,values.length-1).forEach(function(value){tree=tree.directSubTrees.get(value);});const value=values[values.length-1];if(tree.directSubTrees.has(value)){return;}
tree.directSubTrees.set(value,{root:{labels:labels,values:values,},directSubTrees:new Map(),});},_computeRowGroupBys:function(){return!_.isEmpty(this.data.groupedBy)?this.data.groupedBy:this.initialRowGroupBys;},_findGroup:function(groupTree,values){var tree=groupTree;values.slice(0,values.length).forEach(function(value){tree=tree.directSubTrees.get(value);});return tree;},_getCellValue:function(groupId,measure,originIndexes){var self=this;var key=JSON.stringify(groupId);if(!self.measurements[key]){return;}
var values=originIndexes.map(function(originIndex){return self.measurements[key][originIndex][measure];});if(originIndexes.length>1){return computeVariation(values[1],values[0]);}else{return values[0];}},_getGroupBys:function(){return{colGroupBys:this.data.colGroupBys.concat(this.data.expandedColGroupBys),rowGroupBys:this.data.rowGroupBys.concat(this.data.expandedRowGroupBys),};},_getGroupDomain:function(group){var key=JSON.stringify([group.rowValues,group.colValues]);return this.groupDomains[key][group.originIndex];},_getGroupLabels:function(group,groupBys){var self=this;return groupBys.map(function(groupBy){return self._sanitizeLabel(group[groupBy],groupBy);});},_getGroupSubdivision:function(group,rowGroupBy,colGroupBy){var groupDomain=this._getGroupDomain(group);var measureSpecs=this._getMeasureSpecs();var groupBy=rowGroupBy.concat(colGroupBy);return this._rpc({model:this.modelName,method:'read_group',context:this.data.context,domain:groupDomain,fields:measureSpecs,groupBy:groupBy,lazy:false,}).then(function(subGroups){return{group:group,subGroups:subGroups,rowGroupBy:rowGroupBy,colGroupBy:colGroupBy};});},_getGroupValues:function(group,groupBys){var self=this;return groupBys.map(function(groupBy){return self._sanitizeValue(group[groupBy]);});},_getLeafCounts:function(tree){var self=this;var leafCounts={};var leafCount;if(!tree.directSubTrees.size){leafCount=1;}else{leafCount=[...tree.directSubTrees.values()].reduce(function(acc,subTree){var subLeafCounts=self._getLeafCounts(subTree);_.extend(leafCounts,subLeafCounts);return acc+leafCounts[JSON.stringify(subTree.root.values)];},0);}
leafCounts[JSON.stringify(tree.root.values)]=leafCount;return leafCounts;},_getMeasurements:function(group){var self=this;return this.data.measures.reduce(function(measurements,fieldName){var measurement=group[fieldName];if(measurement instanceof Array){measurement=1;}
if(self.fields[fieldName].type==='boolean'&&measurement instanceof Boolean){measurement=measurement?1:0;}
if(self.data.origins.length>1&&!measurement){measurement=0;}
measurements[fieldName]=measurement;return measurements;},{});},_getMeasuresRow:function(columns){var self=this;var sortedColumn=this.data.sortedColumn||{};var measureRow=[];columns.forEach(function(column){self.data.measures.forEach(function(measure){var measureCell={groupId:column.groupId,height:1,measure:measure,title:self.fields[measure].string,width:2*self.data.origins.length-1,};if(sortedColumn.measure===measure&&_.isEqual(sortedColumn.groupId,column.groupId)){measureCell.order=sortedColumn.order;}
measureRow.push(measureCell);});});return measureRow;},_getMeasureSpecs:function(){var self=this;return this.data.measures.reduce(function(acc,measure){if(measure==='__count'){acc.push(measure);return acc;}
var type=self.fields[measure].type;var groupOperator=self.fields[measure].group_operator;if(type==='many2one'){groupOperator='count_distinct';}
if(groupOperator===undefined){throw new Error("No aggregate function has been provided for the measure '"+measure+"'");}
acc.push(measure+':'+groupOperator);return acc;},[]);},_getNumberedLabel:function(label,fieldName){var id=label[0];var name=label[1];this.numbering[fieldName]=this.numbering[fieldName]||{};this.numbering[fieldName][name]=this.numbering[fieldName][name]||{};var numbers=this.numbering[fieldName][name];numbers[id]=numbers[id]||_.size(numbers)+1;return name+(numbers[id]>1?"  ("+numbers[id]+")":"");},_getOriginsRow:function(columns){var self=this;var sortedColumn=this.data.sortedColumn||{};var originRow=[];columns.forEach(function(column){var groupId=column.groupId;var measure=column.measure;var isSorted=sortedColumn.measure===measure&&_.isEqual(sortedColumn.groupId,groupId);var isSortedByOrigin=isSorted&&!sortedColumn.originIndexes[1];var isSortedByVariation=isSorted&&sortedColumn.originIndexes[1];self.data.origins.forEach(function(origin,originIndex){var originCell={groupId:groupId,height:1,measure:measure,originIndexes:[originIndex],title:origin,width:1,};if(isSortedByOrigin&&sortedColumn.originIndexes[0]===originIndex){originCell.order=sortedColumn.order;}
originRow.push(originCell);if(originIndex>0){var variationCell={groupId:groupId,height:1,measure:measure,originIndexes:[originIndex-1,originIndex],title:_t('Variation'),width:1,};if(isSortedByVariation&&sortedColumn.originIndexes[1]===originIndex){variationCell.order=sortedColumn.order;}
originRow.push(variationCell);}});});return originRow;},_getSelectionGroupBy:function(groupBys){let groupedFieldNames=groupBys.rowGroupBys.concat(groupBys.colGroupBys).map(function(g){return g.split(':')[0];});var fields=Object.keys(this.groupableFields).map((fieldName,index)=>{return{name:fieldName,field:this.groupableFields[fieldName],active:groupedFieldNames.includes(fieldName)}}).sort((left,right)=>left.field.string<right.field.string?-1:1);return fields;},_getTable:function(){var headers=this._getTableHeaders();return{headers:headers,rows:this._getTableRows(this.rowGroupTree,headers[headers.length-1]),};},_getTableHeaders:function(){var colGroupBys=this._getGroupBys().colGroupBys;var height=colGroupBys.length+1;var measureCount=this.data.measures.length;var originCount=this.data.origins.length;var leafCounts=this._getLeafCounts(this.colGroupTree);var headers=[];var measureColumns=[];var colGroupRows=(new Array(height)).fill(0).map(function(){return[];});colGroupRows[0].push({height:height+1+(originCount>1?1:0),title:"",width:1,});function generateTreeHeaders(tree,fields){var group=tree.root;var rowIndex=group.values.length;var row=colGroupRows[rowIndex];var groupId=[[],group.values];var isLeaf=!tree.directSubTrees.size;var leafCount=leafCounts[JSON.stringify(tree.root.values)];var cell={groupId:groupId,height:isLeaf?(colGroupBys.length+1-rowIndex):1,isLeaf:isLeaf,label:rowIndex===0?undefined:fields[colGroupBys[rowIndex-1].split(':')[0]].string,title:group.labels[group.labels.length-1]||_t('Total'),width:leafCount*measureCount*(2*originCount-1),};row.push(cell);if(isLeaf){measureColumns.push(cell);}
[...tree.directSubTrees.values()].forEach(function(subTree){generateTreeHeaders(subTree,fields);});}
generateTreeHeaders(this.colGroupTree,this.fields);if(leafCounts[JSON.stringify(this.colGroupTree.root.values)]>1){var groupId=[[],[]];var totalTopRightCell={groupId:groupId,height:height,title:"",width:measureCount*(2*originCount-1),};colGroupRows[0].push(totalTopRightCell);measureColumns.push(totalTopRightCell);}
headers=headers.concat(colGroupRows);var measuresRow=this._getMeasuresRow(measureColumns);headers.push(measuresRow);if(originCount>1){headers.push(this._getOriginsRow(measuresRow));}
return headers;},_getTableRows:function(tree,columns){var self=this;var rows=[];var group=tree.root;var rowGroupId=[group.values,[]];var title=group.labels[group.labels.length-1]||_t('Total');var indent=group.labels.length;var isLeaf=!tree.directSubTrees.size;var rowGroupBys=this._getGroupBys().rowGroupBys;var subGroupMeasurements=columns.map(function(column){var colGroupId=column.groupId;var groupIntersectionId=[rowGroupId[0],colGroupId[1]];var measure=column.measure;var originIndexes=column.originIndexes||[0];var value=self._getCellValue(groupIntersectionId,measure,originIndexes);var measurement={groupId:groupIntersectionId,originIndexes:originIndexes,measure:measure,value:value,isBold:!groupIntersectionId[0].length||!groupIntersectionId[1].length,};return measurement;});rows.push({title:title,label:indent===0?undefined:this.fields[rowGroupBys[indent-1].split(':')[0]].string,groupId:rowGroupId,indent:indent,isLeaf:isLeaf,subGroupMeasurements:subGroupMeasurements});var subTreeKeys=tree.sortedKeys||[...tree.directSubTrees.keys()];subTreeKeys.forEach(function(subTreeKey){var subTree=tree.directSubTrees.get(subTreeKey);rows=rows.concat(self._getTableRows(subTree,columns));});return rows;},_getTreeHeight:function(tree){var subTreeHeights=[...tree.directSubTrees.values()].map(this._getTreeHeight.bind(this));return Math.max(0,Math.max.apply(null,subTreeHeights))+1;},_hasData:function(){return(this.counts[JSON.stringify([[],[]])]||[]).some(function(count){return count>0;});},_isEmpty(){return!this._hasData();},_loadData:function(){var self=this;this.rowGroupTree={root:{labels:[],values:[]},directSubTrees:new Map()};this.colGroupTree={root:{labels:[],values:[]},directSubTrees:new Map()};this.measurements={};this.counts={};var key=JSON.stringify([[],[]]);this.groupDomains={};this.groupDomains[key]=this.data.domains.slice(0);var group={rowValues:[],colValues:[]};var groupBys=this._getGroupBys();var leftDivisors=sections(groupBys.rowGroupBys);var rightDivisors=sections(groupBys.colGroupBys);var divisors=cartesian(leftDivisors,rightDivisors);return this._subdivideGroup(group,divisors.slice(0,1)).then(function(){return self._subdivideGroup(group,divisors.slice(1));});},_prepareData:function(group,groupSubdivisions){var self=this;var groupRowValues=group.rowValues;var groupRowLabels=[];var rowSubTree=this.rowGroupTree;var root;if(groupRowValues.length){rowSubTree=this._findGroup(this.rowGroupTree,groupRowValues);root=rowSubTree.root;groupRowLabels=root.labels;}
var groupColValues=group.colValues;var groupColLabels=[];if(groupColValues.length){root=this._findGroup(this.colGroupTree,groupColValues).root;groupColLabels=root.labels;}
groupSubdivisions.forEach(function(groupSubdivision){groupSubdivision.subGroups.forEach(function(subGroup){var rowValues=groupRowValues.concat(self._getGroupValues(subGroup,groupSubdivision.rowGroupBy));var rowLabels=groupRowLabels.concat(self._getGroupLabels(subGroup,groupSubdivision.rowGroupBy));var colValues=groupColValues.concat(self._getGroupValues(subGroup,groupSubdivision.colGroupBy));var colLabels=groupColLabels.concat(self._getGroupLabels(subGroup,groupSubdivision.colGroupBy));if(!colValues.length&&rowValues.length){self._addGroup(self.rowGroupTree,rowLabels,rowValues);}
if(colValues.length&&!rowValues.length){self._addGroup(self.colGroupTree,colLabels,colValues);}
var key=JSON.stringify([rowValues,colValues]);var originIndex=groupSubdivision.group.originIndex;if(!(key in self.measurements)){self.measurements[key]=self.data.origins.map(function(){return self._getMeasurements({});});}
self.measurements[key][originIndex]=self._getMeasurements(subGroup);if(!(key in self.counts)){self.counts[key]=self.data.origins.map(function(){return 0;});}
self.counts[key][originIndex]=subGroup.__count;if(!(key in self.groupDomains)){self.groupDomains[key]=self.data.origins.map(function(){return Domain.FALSE_DOMAIN;});}
if(subGroup.__domain){self.groupDomains[key][originIndex]=subGroup.__domain;}});});if(this.data.sortedColumn){this.sortRows(this.data.sortedColumn,rowSubTree);}},_processMeasures:function(measures){if(measures){return _.map(measures,function(measure){return measure==='__count__'?'__count':measure;});}},_computeDerivedParams:function(){const{range,rangeDescription,comparisonRange,comparisonRangeDescription}=this.data.timeRanges;if(range){this.data.domains=[this.data.domain.concat(comparisonRange),this.data.domain.concat(range)];this.data.origins=[comparisonRangeDescription,rangeDescription];}else{this.data.domains=[this.data.domain];this.data.origins=[""];}},_pruneTree:function(tree,oldTree){if(!oldTree.directSubTrees.size){tree.directSubTrees.clear();delete tree.sortedKeys;return;}
var self=this;[...tree.directSubTrees.keys()].forEach(function(subTreeKey){var subTree=tree.directSubTrees.get(subTreeKey);if(!oldTree.directSubTrees.has(subTreeKey)){subTree.directSubTrees.clear();delete subTreeKey.sortedKeys;}else{var oldSubTree=oldTree.directSubTrees.get(subTreeKey);self._pruneTree(subTree,oldSubTree);}});},_toggleMeasure:function(fieldName){var index=this.data.measures.indexOf(fieldName);if(index!==-1){this.data.measures.splice(index,1);return Promise.resolve();}else{this.data.measures.push(fieldName);}
return this._loadData();},_sanitizeLabel:function(value,groupBy){var fieldName=groupBy.split(':')[0];if(value===false){return _t("Undefined");}
if(value instanceof Array){return this._getNumberedLabel(value,fieldName);}
if(fieldName&&this.fields[fieldName]&&(this.fields[fieldName].type==='selection')){var selected=_.where(this.fields[fieldName].selection,{0:value})[0];return selected?selected[1]:value;}
return value;},_sanitizeValue:function(value){if(value instanceof Array){return value[0];}
return value;},_subdivideGroup:function(group,divisors){var self=this;var key=JSON.stringify([group.rowValues,group.colValues]);var proms=this.data.origins.reduce(function(acc,origin,originIndex){if(!self.counts[key]||self.counts[key][originIndex]>0){var subGroup={rowValues:group.rowValues,colValues:group.colValues,originIndex:originIndex};divisors.forEach(function(divisor){acc.push(self._getGroupSubdivision(subGroup,divisor[0],divisor[1]));});}
return acc;},[]);return this._loadDataDropPrevious.add(Promise.all(proms)).then(function(groupSubdivisions){if(groupSubdivisions.length){self._prepareData(group,groupSubdivisions);}});},_sortTree:function(sortFunction,tree){var self=this;tree.sortedKeys=_.sortBy([...tree.directSubTrees.keys()],sortFunction(tree));[...tree.directSubTrees.values()].forEach(function(subTree){self._sortTree(sortFunction,subTree);});},});return PivotModel;});;

/* /web/static/src/js/views/pivot/pivot_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.PivotController',function(require){"use strict";const AbstractController=require('web.AbstractController');const core=require('web.core');const framework=require('web.framework');const session=require('web.session');const _t=core._t;const QWeb=core.qweb;const PivotController=AbstractController.extend({custom_events:Object.assign({},AbstractController.prototype.custom_events,{closed_header_click:'_onClosedHeaderClicked',open_view:'_onOpenView',opened_header_click:'_onOpenedHeaderClicked',sort_rows:'_onSortRows',groupby_menu_selection:'_onGroupByMenuSelection',}),init:function(parent,model,renderer,params){this._super(...arguments);this.disableLinking=params.disableLinking;this.measures=params.measures;this.title=params.title;this.views=params.views;this.groupSelected=null;},destroy:function(){if(this.$buttons){this.$buttons.find('button').off();}
return this._super(...arguments);},getOwnedQueryParams:function(){const state=this.model.get({raw:true});return{context:{pivot_measures:state.measures,pivot_column_groupby:state.colGroupBys,pivot_row_groupby:state.rowGroupBys,}};},renderButtons:function($node){const context=this._getRenderButtonContext();this.$buttons=$(QWeb.render('PivotView.buttons',context));this.$buttons.click(this._onButtonClick.bind(this));this.$buttons.find('button').tooltip();if($node){this.$buttons.appendTo($node);}},updateButtons:function(){if(!this.$buttons){return;}
const state=this.model.get({raw:true});Object.entries(this.measures).forEach(elt=>{const name=elt[0];const isSelected=state.measures.includes(name);this.$buttons.find('.dropdown-item[data-field="'+name+'"]').toggleClass('selected',isSelected);});const noDataDisplayed=!state.hasData||!state.measures.length;this.$buttons.find('.o_pivot_flip_button').prop('disabled',noDataDisplayed);this.$buttons.find('.o_pivot_expand_button').prop('disabled',noDataDisplayed);this.$buttons.find('.o_pivot_download').prop('disabled',noDataDisplayed);},_downloadTable:function(){if(this.model.getTableWidth()>16384){this.call('crash_manager','show_message',_t("For Excel compatibility, data cannot be exported if there are more than 16384 columns.\n\nTip: try to flip axis, filter further or reduce the number of measures."));framework.unblockUI();return;}
const table=this.model.exportData();table.title=this.title;session.get_file({url:'/web/pivot/export_xlsx',data:{data:JSON.stringify(table)},complete:framework.unblockUI,error:(error)=>this.call('crash_manager','rpc_error',error),});},_onButtonClick:async function(ev){const $target=$(ev.target);if($target.hasClass('o_pivot_flip_button')){this.model.flip();this.update({},{reload:false});}
if($target.hasClass('o_pivot_expand_button')){await this.model.expandAll();this.update({},{reload:false});}
if(ev.target.closest('.o_pivot_measures_list')){ev.preventDefault();ev.stopPropagation();const field=ev.target.dataset.field;if(field){this.update({measure:field});}}
if($target.hasClass('o_pivot_download')){this._downloadTable();}
await this._addIncludedButtons(ev);},_addIncludedButtons:async function(ev){},_getRenderButtonContext:function(){return{measures:Object.entries(this.measures).filter(x=>x[0]!=='__count').sort((a,b)=>a[1].string.toLowerCase()>b[1].string.toLowerCase()?1:-1),};},_onCloseGroup:function(ev){this.model.closeGroup(ev.data.groupId,ev.data.type);this.update({},{reload:false});},_onOpenedHeaderClicked:function(ev){this.model.closeGroup(ev.data.cell.groupId,ev.data.type);this.update({},{reload:false});},_onClosedHeaderClicked:async function(ev){const cell=ev.data.cell;const groupId=cell.groupId;const type=ev.data.type;const group={rowValues:groupId[0],colValues:groupId[1],type:type};const state=this.model.get({raw:true});const groupValues=type==='row'?groupId[0]:groupId[1];const groupBys=type==='row'?state.rowGroupBys:state.colGroupBys;this.selectedGroup=group;if(groupValues.length<groupBys.length){const groupBy=groupBys[groupValues.length];await this.model.expandGroup(this.selectedGroup,groupBy);this.update({},{reload:false});}},_onGroupByMenuSelection:async function(ev){ev.stopPropagation();let groupBy=ev.data.field.name;const interval=ev.data.interval;if(interval){groupBy=groupBy+':'+interval;}
this.model.addGroupBy(groupBy,this.selectedGroup.type);await this.model.expandGroup(this.selectedGroup,groupBy);this.update({},{reload:false});},_onOpenView:function(ev){ev.stopPropagation();const cell=ev.data;if(cell.value===undefined||this.disableLinking){return;}
const context=Object.assign({},this.model.data.context);Object.keys(context).forEach(x=>{if(x==='group_by'||x.startsWith('search_default_')){delete context[x];}});const group={rowValues:cell.groupId[0],colValues:cell.groupId[1],originIndex:cell.originIndexes[0]};const domain=this.model._getGroupDomain(group);this.do_action({type:'ir.actions.act_window',name:this.title,res_model:this.modelName,views:this.views,view_mode:'list',target:'current',context:context,domain:domain,});},_onSortRows:function(ev){this.model.sortRows({groupId:ev.data.groupId,measure:ev.data.measure,order:(ev.data.order||'desc')==='asc'?'desc':'asc',originIndexes:ev.data.originIndexes,});this.update({},{reload:false});},});return PivotController;});;

/* /web/static/src/js/views/pivot/pivot_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.PivotRenderer',function(require){"use strict";const OwlAbstractRenderer=require('web.AbstractRendererOwl');const field_utils=require('web.field_utils');const patchMixin=require('web.patchMixin');const{useExternalListener,useState,onMounted,onPatched}=owl.hooks;class PivotRenderer extends OwlAbstractRenderer{constructor(){super(...arguments);this.sampleDataTargets=['table'];this.state=useState({activeNodeHeader:{groupId:false,isXAxis:false,click:false},});onMounted(()=>this._updateTooltip());onPatched(()=>this._updateTooltip());useExternalListener(window,'click',this._resetState);}
_getFormattedValue(cell){const type=this.props.widgets[cell.measure]||(this.props.fields[cell.measure].type==='many2one'?'integer':this.props.fields[cell.measure].type);const formatter=field_utils.format[type];return formatter(cell.value,this.props.fields[cell.measure]);}
_getFormattedVariation(cell){const value=cell.value;return isNaN(value)?'-':field_utils.format.percentage(value,this.props.fields[cell.measure]);}
_getPadding(cell){return 5+cell.indent*30;}
_isClicked(groupId,isXAxis){return _.isEqual(groupId,this.state.activeNodeHeader.groupId)&&this.state.activeNodeHeader.isXAxis===isXAxis;}
_resetState(){if(this.isHeaderClicked){this.isHeaderClicked=false;return;}
this.state.activeNodeHeader={groupId:false,isXAxis:false,click:false};}
_updateTooltip(){$(this.el).find('.o_pivot_header_cell_opened, .o_pivot_header_cell_closed').tooltip();}
_onClickMenuGroupBy(field,interval){this.trigger('groupby_menu_selection',{field,interval});}
_onHeaderClick(cell,type){const groupValues=cell.groupId[type==='col'?1:0];const groupByLength=type==='col'?this.props.colGroupBys.length:this.props.rowGroupBys.length;if(cell.isLeaf&&groupValues.length>=groupByLength){this.isHeaderClicked=true;this.state.activeNodeHeader={groupId:cell.groupId,isXAxis:type==='col',click:'leftClick'};}
this.trigger(cell.isLeaf?'closed_header_click':'opened_header_click',{cell,type});}
_onMouseEnter(ev){var index=[...ev.currentTarget.parentNode.children].indexOf(ev.currentTarget);if(ev.currentTarget.tagName==='TH'){index+=1;}
this.el.querySelectorAll('td:nth-child('+(index+1)+')').forEach(elt=>elt.classList.add('o_cell_hover'));}
_onMouseLeave(){this.el.querySelectorAll('.o_cell_hover').forEach(elt=>elt.classList.remove('o_cell_hover'));}}
PivotRenderer.template='web.PivotRenderer';return patchMixin(PivotRenderer);});;

/* /web/static/src/js/views/pivot/pivot_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.PivotView',function(require){"use strict";const AbstractView=require('web.AbstractView');const config=require('web.config');const core=require('web.core');const PivotModel=require('web.PivotModel');const PivotController=require('web.PivotController');const PivotRenderer=require('web.PivotRenderer');const RendererWrapper=require('web.RendererWrapper');const _t=core._t;const _lt=core._lt;const searchUtils=require('web.searchUtils');const GROUPABLE_TYPES=searchUtils.GROUPABLE_TYPES;const PivotView=AbstractView.extend({display_name:_lt('Pivot'),icon:'fa-table',config:Object.assign({},AbstractView.prototype.config,{Model:PivotModel,Controller:PivotController,Renderer:PivotRenderer,}),viewType:'pivot',searchMenuTypes:['filter','groupBy','comparison','favorite'],init:function(viewInfo,params){this._super.apply(this,arguments);const activeMeasures=[];const colGroupBys=[];const rowGroupBys=[];const measures={};const groupableFields={};const widgets={};const additionalMeasures=params.additionalMeasures||[];this.fields.__count={string:_t("Count"),type:"integer"};Object.keys(this.fields).forEach(name=>{const field=this.fields[name];if(name!=='id'&&field.store===true){if(['integer','float','monetary'].includes(field.type)||additionalMeasures.includes(name)){measures[name]=field;}
if(GROUPABLE_TYPES.includes(field.type)){groupableFields[name]=field;}}});measures.__count={string:_t("Count"),type:"integer"};this.arch.children.forEach(field=>{let name=field.attrs.name;if(field.attrs.invisible&&py.eval(field.attrs.invisible)){if(name in groupableFields){delete groupableFields[name];}
if(!additionalMeasures.includes(name)){delete measures[name];return;}}
if(field.attrs.interval){name+=':'+field.attrs.interval;}
if(field.attrs.widget){widgets[name]=field.attrs.widget;}
if(field.attrs.type==='measure'&&!(name in measures)){measures[name]=this.fields[name];}
if(field.attrs.string&&name in measures){measures[name].string=field.attrs.string;}
if(field.attrs.type==='measure'||'operator'in field.attrs){activeMeasures.push(name);measures[name]=this.fields[name];}
if(field.attrs.type==='col'){colGroupBys.push(name);}
if(field.attrs.type==='row'){rowGroupBys.push(name);}});if((!activeMeasures.length)||this.arch.attrs.display_quantity){activeMeasures.splice(0,0,'__count');}
this.loadParams.measures=activeMeasures;this.loadParams.colGroupBys=config.device.isMobile?[]:colGroupBys;this.loadParams.rowGroupBys=rowGroupBys;this.loadParams.fields=this.fields;this.loadParams.default_order=params.default_order||this.arch.attrs.default_order;this.loadParams.groupableFields=groupableFields;const disableLinking=!!(this.arch.attrs.disable_linking&&JSON.stringify(this.arch.attrs.disable_linking));this.rendererParams.widgets=widgets;this.rendererParams.disableLinking=disableLinking;this.controllerParams.disableLinking=disableLinking;this.controllerParams.title=params.title||this.arch.attrs.string||_t("Untitled");this.controllerParams.measures=measures;this.controllerParams.views=[_findView(params.actionViews,'list'),_findView(params.actionViews,'form'),];function _findView(views,viewType){const view=views.find(view=>{return view.type===viewType;});return[view?view.viewID:false,viewType];}},getRenderer(parent,state){state=Object.assign(state||{},this.rendererParams);return new RendererWrapper(parent,this.config.Renderer,state);},});return PivotView;});;

/* /web/static/src/js/views/calendar/calendar_controller.js defined in bundle 'web.assets_backend' */
odoo.define('web.CalendarController',function(require){"use strict";var AbstractController=require('web.AbstractController');var core=require('web.core');var Dialog=require('web.Dialog');var dialogs=require('web.view_dialogs');var QuickCreate=require('web.CalendarQuickCreate');var _t=core._t;var QWeb=core.qweb;function dateToServer(date,fieldType){date=date.clone().locale('en');if(fieldType==="date"){return date.local().format('YYYY-MM-DD');}
return date.utc().format('YYYY-MM-DD HH:mm:ss');}
var CalendarController=AbstractController.extend({custom_events:_.extend({},AbstractController.prototype.custom_events,{changeDate:'_onChangeDate',changeFilter:'_onChangeFilter',deleteRecord:'_onDeleteRecord',dropRecord:'_onDropRecord',next:'_onNext',openCreate:'_onOpenCreate',openEvent:'_onOpenEvent',prev:'_onPrev',quickCreate:'_onQuickCreate',updateRecord:'_onUpdateRecord',viewUpdated:'_onViewUpdated',}),events:_.extend({},AbstractController.prototype.events,{'click button.o_calendar_button_new':'_onButtonNew','click button.o_calendar_button_prev':'_onButtonNavigation','click button.o_calendar_button_today':'_onButtonNavigation','click button.o_calendar_button_next':'_onButtonNavigation','click button.o_calendar_button_day':'_onButtonScale','click button.o_calendar_button_week':'_onButtonScale','click button.o_calendar_button_month':'_onButtonScale','click button.o_calendar_button_year':'_onButtonScale',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.current_start=null;this.displayName=params.displayName;this.quickAddPop=params.quickAddPop;this.disableQuickCreate=params.disableQuickCreate;this.eventOpenPopup=params.eventOpenPopup;this.showUnusualDays=params.showUnusualDays;this.formViewId=params.formViewId;this.readonlyFormViewId=params.readonlyFormViewId;this.mapping=params.mapping;this.context=params.context;this.previousOpen=null;this.quickCreating=false;this.scales=params.scales;},renderButtons:function($node){this.$buttons=$(QWeb.render('CalendarView.buttons',this._renderButtonsParameters()));this.$buttons.find('.o_calendar_button_'+this.mode).addClass('active');if($node){this.$buttons.appendTo($node);}else{this.$('.o_calendar_buttons').replaceWith(this.$buttons);}},_extractLastPartOfClassName(startClassName,classList){var result;classList.forEach(function(value){if(value&&value.indexOf(startClassName)===0){result=value.substring(startClassName.length);}});return result;},_move:function(to){this.model[to]();return this.reload();},_renderButtonsParameters(){return{scales:this.scales,};},_update:function(){var self=this;if(!this.showUnusualDays){return this._super.apply(this,arguments);}
return this._super.apply(this,arguments).then(function(){self._rpc({model:self.modelName,method:'get_unusual_days',args:[dateToServer(self.model.data.start_date,'date'),dateToServer(self.model.data.end_date,'date')],context:self.context,}).then(function(data){_.each(self.$el.find('td.fc-day'),function(td){var $td=$(td);if(data[$td.data('date')]){$td.addClass('o_calendar_disabled');}});});});},_updateRecord:function(record){var reload=this.reload.bind(this,{});return this.model.updateRecord(record).then(reload,reload);},_onButtonNew(){this.trigger_up('switch_view',{view_type:'form'});},_onButtonNavigation(jsEvent){const action=this._extractLastPartOfClassName('o_calendar_button_',jsEvent.currentTarget.classList);if(action){this._move(action);}},_onButtonScale(jsEvent){const scale=this._extractLastPartOfClassName('o_calendar_button_',jsEvent.currentTarget.classList);if(scale){this.model.setScale(scale);this.reload();}},_onChangeDate:function(event){var modelData=this.model.get();if(modelData.target_date.format('YYYY-MM-DD')===event.data.date.format('YYYY-MM-DD')){switch(modelData.scale){case'month':this.model.setScale('week');break;case'week':this.model.setScale('day');break;case'day':this.model.setScale('month');break;}}else if(modelData.target_date.week()===event.data.date.week()){this.model.setScale('day');}else{this.model.setScale('week');}
this.model.setDate(event.data.date);this.reload();},_onChangeFilter:function(event){if(this.model.changeFilter(event.data)&&!event.data.no_reload){this.reload();}},_onDeleteRecord:function(event){var self=this;Dialog.confirm(this,_t("Are you sure you want to delete this record ?"),{confirm_callback:function(){self.model.deleteRecords([event.data.id],self.modelName).then(function(){self.reload();});}});},_onDropRecord:function(event){this._updateRecord(_.extend({},event.data,{'drop':true,}));},_onNext:function(event){event.stopPropagation();this._move('next');},_onOpenCreate:function(event){var self=this;if(["year","month"].includes(this.model.get().scale)){event.data.allDay=true;}
var data=this.model.calendarEventToRecord(event.data);var context=_.extend({},this.context,event.options&&event.options.context);if(data.name){context.default_name=data.name;}
context['default_'+this.mapping.date_start]=data[this.mapping.date_start]||null;if(this.mapping.date_stop){context['default_'+this.mapping.date_stop]=data[this.mapping.date_stop]||null;}
if(this.mapping.date_delay){context['default_'+this.mapping.date_delay]=data[this.mapping.date_delay]||null;}
if(this.mapping.all_day){context['default_'+this.mapping.all_day]=data[this.mapping.all_day]||null;}
for(var k in context){if(context[k]&&context[k]._isAMomentObject){context[k]=dateToServer(context[k]);}}
var options=_.extend({},this.options,event.options,{context:context,title:_.str.sprintf(_t('Create: %s'),(this.displayName||this.renderer.arch.attrs.string))});if(this.quick!=null){this.quick.destroy();this.quick=null;}
if(!options.disableQuickCreate&&!event.data.disableQuickCreate&&this.quickAddPop){this.quick=new QuickCreate(this,true,options,data,event.data);this.quick.open();this.quick.opened(function(){self.quick.focus();});return;}
var title=_t("Create");if(this.renderer.arch.attrs.string){title+=': '+this.renderer.arch.attrs.string;}
if(this.eventOpenPopup){if(this.previousOpen){this.previousOpen.close();}
this.previousOpen=new dialogs.FormViewDialog(self,{res_model:this.modelName,context:context,title:title,view_id:this.formViewId||false,disable_multiple_selection:true,on_saved:function(){if(event.data.on_save){event.data.on_save();}
self.reload();},});this.previousOpen.open();}else{this.do_action({type:'ir.actions.act_window',res_model:this.modelName,views:[[this.formViewId||false,'form']],target:'current',context:context,});}},_onOpenEvent:function(event){var self=this;var id=event.data._id;id=id&&parseInt(id).toString()===id?parseInt(id):id;if(!this.eventOpenPopup){this._rpc({model:self.modelName,method:'get_formview_id',args:[[id]],context:event.context||self.context,}).then(function(viewId){self.do_action({type:'ir.actions.act_window',res_id:id,res_model:self.modelName,views:[[viewId||false,'form']],target:'current',context:event.context||self.context,});});return;}
var options={res_model:self.modelName,res_id:id||null,context:event.context||self.context,title:_t("Open: ")+_.escape(event.data.title),on_saved:function(){if(event.data.on_save){event.data.on_save();}
self.reload();},};if(this.formViewId){options.view_id=parseInt(this.formViewId);}
new dialogs.FormViewDialog(this,options).open();},_onPrev:function(){event.stopPropagation();this._move('prev');},_onQuickCreate:function(event){var self=this;if(this.quickCreating){return;}
this.quickCreating=true;this.model.createRecord(event).then(function(){self.quick.destroy();self.quick=null;self.reload();self.quickCreating=false;}).guardedCatch(function(result){var errorEvent=result.event;errorEvent.preventDefault();event.data.options.disableQuickCreate=true;event.data.data.on_save=self.quick.destroy.bind(self.quick);self._onOpenCreate(event.data);self.quickCreating=false;});},_onUpdateRecord:function(event){this._updateRecord(event.data);},_onViewUpdated:function(event){this.mode=event.data.mode;if(this.$buttons){this.$buttons.find('.active').removeClass('active');this.$buttons.find('.o_calendar_button_'+this.mode).addClass('active');}
const title=`${this.displayName} (${event.data.title})`;return this.updateControlPanel({title});},});return CalendarController;});;

/* /web/static/src/js/views/calendar/calendar_model.js defined in bundle 'web.assets_backend' */
odoo.define('web.CalendarModel',function(require){"use strict";var AbstractModel=require('web.AbstractModel');var Context=require('web.Context');var core=require('web.core');var fieldUtils=require('web.field_utils');var session=require('web.session');var _t=core._t;function dateToServer(date){return date.clone().utc().locale('en').format('YYYY-MM-DD HH:mm:ss');}
return AbstractModel.extend({init:function(){this._super.apply(this,arguments);this.end_date=null;var week_start=_t.database.parameters.week_start;this.week_start=week_start!==undefined&&week_start!==false?week_start%7:moment().startOf('week').day();this.week_stop=this.week_start+6;},calendarEventToRecord:function(event){var data={'name':event.title};var start=event.start.clone();var end=event.end&&event.end.clone();if(!end||end.diff(start)<0){if(event.allDay){end=start.clone();}else{end=start.clone().add(2,'h');}}else if(event.allDay){end.add(-1,'days');}
var isDateEvent=this.fields[this.mapping.date_start].type==='date';if(event.allDay){if(!this.mapping.all_day&&!isDateEvent){if(event.r_start){start.hours(event.r_start.hours()).minutes(event.r_start.minutes()).seconds(event.r_start.seconds()).utc();end.hours(event.r_end.hours()).minutes(event.r_end.minutes()).seconds(event.r_end.seconds()).utc();}else{start.hours(7);end.hours(19);}
start.add(-this.getSession().getTZOffset(start),'minutes');end.add(-this.getSession().getTZOffset(end),'minutes');}}else{start.add(-this.getSession().getTZOffset(start),'minutes');end.add(-this.getSession().getTZOffset(end),'minutes');}
if(this.mapping.all_day){if(event.record){data[this.mapping.all_day]=(this.data.scale!=='month'&&event.allDay)||event.record[this.mapping.all_day]&&end.diff(start)<10||false;}else{data[this.mapping.all_day]=event.allDay;}}
data[this.mapping.date_start]=start;if(this.mapping.date_stop){data[this.mapping.date_stop]=end;}
if(this.mapping.date_delay){if(this.data.scale!=='month'||(this.data.scale==='month'&&!event.drop)){data[this.mapping.date_delay]=(end.diff(start)<=0?end.endOf('day').diff(start):end.diff(start))/1000/3600;}}
return data;},changeFilter:function(filter){var Filter=this.data.filters[filter.fieldName];if(filter.value==='all'){Filter.all=filter.active;}
var f=_.find(Filter.filters,function(f){return f.value===filter.value;});if(f){if(f.active!==filter.active){f.active=filter.active;}else{return false;}}else if(filter.active){Filter.filters.push({value:filter.value,active:true,});}
return true;},createRecord:function(event){var data=this.calendarEventToRecord(event.data.data);for(var k in data){if(data[k]&&data[k]._isAMomentObject){data[k]=dateToServer(data[k]);}}
return this._rpc({model:this.modelName,method:'create',args:[data],context:event.data.options.context,});},deleteRecords:function(ids,model){return this._rpc({model:model,method:'unlink',args:[ids],context:session.user_context,});},__get:function(){return _.extend({},this.data,{fields:this.fields});},__load:function(params){var self=this;this.modelName=params.modelName;this.fields=params.fields;this.fieldNames=params.fieldNames;this.fieldsInfo=params.fieldsInfo;this.mapping=params.mapping;this.mode=params.mode;this.scales=params.scales;this.scalesInfo=params.scalesInfo;this.editable=params.editable;this.creatable=params.creatable;this.eventLimit=params.eventLimit;this.fieldColor=params.fieldColor;if(!this.preloadPromise){this.preloadPromise=new Promise(function(resolve,reject){Promise.all([self._rpc({model:self.modelName,method:'check_access_rights',args:["write",false]}),self._rpc({model:self.modelName,method:'check_access_rights',args:["create",false]})]).then(function(result){var write=result[0];var create=result[1];self.write_right=write;self.create_right=create;resolve();}).guardedCatch(reject);});}
this.data={domain:params.domain,context:params.context,filters:params.filters,};this.setDate(params.initialDate);this.setScale(params.mode);_.each(this.data.filters,function(filter){if(filter.avatar_field&&!filter.avatar_model){filter.avatar_model=self.modelName;}});return this.preloadPromise.then(this._loadCalendar.bind(this));},next:function(){this.setDate(this.data.target_date.clone().add(1,this.data.scale));},prev:function(){this.setDate(this.data.target_date.clone().add(-1,this.data.scale));},__reload:function(handle,params){if(params.domain){this.data.domain=params.domain;}
if(params.context){this.data.context=params.context;}
return this._loadCalendar();},setDate:function(start){this.data.highlight_date=this.data.target_date=start.clone();this.data.start_date=this.data.end_date=start;switch(this.data.scale){case'year':{const yearStart=this.data.start_date.clone().startOf('year');let yearStartDay=this.week_start;if(yearStart.day()<yearStartDay){yearStartDay-=7;}
this.data.start_date=yearStart.day(yearStartDay).startOf('day');this.data.end_date=this.data.end_date.clone().endOf('year').day(this.week_stop).endOf('day');break;}
case'month':var monthStart=this.data.start_date.clone().startOf('month');var monthStartDay;if(monthStart.day()>=this.week_start){monthStartDay=this.week_start;}else{monthStartDay=this.week_start-7;}
this.data.start_date=monthStart.day(monthStartDay).startOf('day');this.data.end_date=this.data.start_date.clone().add(5,'week').day(this.week_stop).endOf('day');break;case'week':var weekStart=this.data.start_date.clone().startOf('week');var weekStartDay=this.week_start;if(this.data.start_date.day()<this.week_start){weekStartDay-=7;}
this.data.start_date=this.data.start_date.clone().day(weekStartDay).startOf('day');this.data.end_date=this.data.end_date.clone().day(weekStartDay+6).endOf('day');break;default:this.data.start_date=this.data.start_date.clone().startOf('day');this.data.end_date=this.data.end_date.clone().endOf('day');}
var manualUtcDateStart=this.data.start_date.clone().add(-this.getSession().getTZOffset(this.data.start_date),'minutes');var formattedUtcDateStart=manualUtcDateStart.format('YYYY-MM-DDTHH:mm:ss')+'Z';this.data.start_date=moment.utc(formattedUtcDateStart);var manualUtcDateEnd=this.data.end_date.clone().add(-this.getSession().getTZOffset(this.data.start_date),'minutes');var formattedUtcDateEnd=manualUtcDateEnd.format('YYYY-MM-DDTHH:mm:ss')+'Z';this.data.end_date=moment.utc(formattedUtcDateEnd);},setScale:function(scale){if(!_.contains(this.scales,scale)){scale="week";}
this.data.scale=scale;this.setDate(this.data.target_date);},today:function(){this.setDate(moment(new Date()));},updateRecord:function(record){var data=_.omit(this.calendarEventToRecord(record),'name');for(var k in data){if(data[k]&&data[k]._isAMomentObject){data[k]=dateToServer(data[k]);}}
var context=new Context(this.data.context,{from_ui:true});return this._rpc({model:this.modelName,method:'write',args:[[parseInt(record.id,10)],data],context:context});},_getFilterDomain:function(){var authorizedValues={};var avoidValues={};_.each(this.data.filters,function(filter){if(filter.all)return;_.each(filter.filters,function(f){if(filter.write_model){if(!authorizedValues[filter.fieldName])
authorizedValues[filter.fieldName]=[];if(f.active){authorizedValues[filter.fieldName].push(f.value);}}else{if(!f.active){if(!avoidValues[filter.fieldName])
avoidValues[filter.fieldName]=[];avoidValues[filter.fieldName].push(f.value);}}});});var domain=[];for(var field in authorizedValues){domain.push([field,'in',authorizedValues[field]]);}
for(var field in avoidValues){if(avoidValues[field].length>0){domain.push([field,'not in',avoidValues[field]]);}}
return domain;},_getFullCalendarOptions:function(){var format12Hour={hour:'numeric',minute:'2-digit',omitZeroMinute:true,meridiem:'short'};var format24Hour={hour:'numeric',minute:'2-digit',hour12:false,};return{defaultView:this.scalesInfo[this.mode||'week'],header:false,selectable:this.creatable&&this.create_right,selectMirror:true,editable:this.editable,droppable:true,navLinks:false,eventLimit:this.eventLimit,snapMinutes:15,longPressDelay:500,eventResizableFromStart:true,nowIndicator:true,weekNumbers:true,weekNumbersWithinDays:true,weekNumberCalculation:function(date){return moment(date).week();},weekLabel:_t("Week"),allDayText:_t("All day"),monthNames:moment.months(),monthNamesShort:moment.monthsShort(),dayNames:moment.weekdays(),dayNamesShort:moment.weekdaysShort(),dayNamesMin:moment.weekdaysMin(),firstDay:this.week_start,slotLabelFormat:_t.database.parameters.time_format.search("%H")!==-1?format24Hour:format12Hour,allDaySlot:this.mapping.all_day||this.fields[this.mapping.date_start].type==='date',};},_getRangeDomain:function(){var domain=[[this.mapping.date_start,'<=',dateToServer(this.data.end_date)]];if(this.mapping.date_stop){domain.push([this.mapping.date_stop,'>=',dateToServer(this.data.start_date)]);}else if(!this.mapping.date_delay){domain.push([this.mapping.date_start,'>=',dateToServer(this.data.start_date)]);}
return domain;},_loadCalendar:function(){var self=this;this.data.fc_options=this._getFullCalendarOptions();var defs=_.map(this.data.filters,this._loadFilter.bind(this));return Promise.all(defs).then(function(){return self._rpc({model:self.modelName,method:'search_read',context:self.data.context,fields:self.fieldNames,domain:self.data.domain.concat(self._getRangeDomain()).concat(self._getFilterDomain())}).then(function(events){self._parseServerData(events);self.data.data=_.map(events,self._recordToCalendarEvent.bind(self));return Promise.all([self._loadColors(self.data,self.data.data),self._loadRecordsToFilters(self.data,self.data.data)]);});});},_loadColors:function(element,events){if(this.fieldColor){var fieldName=this.fieldColor;_.each(events,function(event){var value=event.record[fieldName];event.color_index=_.isArray(value)?value[0]%30:value%30;});this.model_color=this.fields[fieldName].relation||element.model;}
return Promise.resolve();},_loadFilter:function(filter){if(!filter.write_model){return Promise.resolve();}
var field=this.fields[filter.fieldName];return this._rpc({model:filter.write_model,method:'search_read',domain:[["user_id","=",session.uid]],fields:[filter.write_field],}).then(function(res){var records=_.map(res,function(record){var _value=record[filter.write_field];var value=_.isArray(_value)?_value[0]:_value;var f=_.find(filter.filters,function(f){return f.value===value;});var formater=fieldUtils.format[_.contains(['many2many','one2many'],field.type)?'many2one':field.type];return{'id':record.id,'value':value,'label':formater(_value,field),'active':!f||f.active,};});records.sort(function(f1,f2){return _.string.naturalCmp(f2.label,f1.label);});if(field.relation==='res.partner'||field.relation==='res.users'){var value=field.relation==='res.partner'?session.partner_id:session.uid;var me=_.find(records,function(record){return record.value===value;});if(me){records.splice(records.indexOf(me),1);}else{var f=_.find(filter.filters,function(f){return f.value===value;});me={'value':value,'label':session.name+_t(" [Me]"),'active':!f||f.active,};}
records.unshift(me);}
records.push({'value':'all','label':field.relation==='res.partner'||field.relation==='res.users'?_t("Everybody's calendars"):_t("Everything"),'active':filter.all,});filter.filters=records;});},_loadRecordsToFilters:function(element,events){var self=this;var new_filters={};var to_read={};var defs=[];var color_filter={};_.each(this.data.filters,function(filter,fieldName){var field=self.fields[fieldName];new_filters[fieldName]=filter;if(filter.write_model){if(field.relation===self.model_color){_.each(filter.filters,function(f){f.color_index=f.value;});}
return;}
_.each(filter.filters,function(filter){filter.display=!filter.active;});var fs=[];var undefined_fs=[];_.each(events,function(event){var data=event.record[fieldName];if(!_.contains(['many2many','one2many'],field.type)){data=[data];}else{to_read[field.relation]=(to_read[field.relation]||[]).concat(data);}
_.each(data,function(_value){var value=_.isArray(_value)?_value[0]:_value;var f={'color_index':self.model_color===(field.relation||element.model)?value%30:false,'value':value,'label':fieldUtils.format[field.type](_value,field)||_t("Undefined"),'avatar_model':field.relation||element.model,};value?fs.push(f):undefined_fs.push(f);});});_.each(_.union(fs,undefined_fs),function(f){var f1=_.findWhere(filter.filters,_.omit(f,'color_index'));if(f1){f1.display=true;}else{f.display=f.active=true;filter.filters.push(f);}});if(filter.color_model&&filter.field_color){var ids=filter.filters.reduce((acc,f)=>{if(!f.color_index&&f.value){acc.push(f.value);}
return acc;},[]);if(!color_filter[filter.color_model]){color_filter[filter.color_model]={};}
if(ids.length){defs.push(self._rpc({model:filter.color_model,method:'read',args:[_.uniq(ids),[filter.field_color]],}).then(function(res){_.each(res,function(c){color_filter[filter.color_model][c.id]=c[filter.field_color];});}));}}});_.each(to_read,function(ids,model){defs.push(self._rpc({model:model,method:'name_get',args:[_.uniq(ids)],}).then(function(res){to_read[model]=_.object(res);}));});return Promise.all(defs).then(function(){_.each(self.data.filters,function(filter){if(filter.write_model){return;}
if(filter.filters.length&&(filter.filters[0].avatar_model in to_read)){_.each(filter.filters,function(f){f.label=to_read[f.avatar_model][f.value];});}
if(filter.color_model&&filter.field_color){_.each(filter.filters,function(f){if(!f.color_index){f.color_index=color_filter[filter.color_model]&&color_filter[filter.color_model][f.value];}});}});});},_parseServerData:function(data){var self=this;_.each(data,function(event){_.each(self.fieldNames,function(fieldName){event[fieldName]=self._parseServerValue(self.fields[fieldName],event[fieldName]);});});},_recordToCalendarEvent:function(evt){var date_start;var date_stop;var date_delay=evt[this.mapping.date_delay]||1.0,all_day=this.fields[this.mapping.date_start].type==='date'||this.mapping.all_day&&evt[this.mapping.all_day]||false,the_title='',attendees=[];if(!all_day){date_start=evt[this.mapping.date_start].clone();date_stop=this.mapping.date_stop?evt[this.mapping.date_stop].clone():null;}else{date_start=evt[this.mapping.date_start].clone().startOf('day');date_stop=this.mapping.date_stop?evt[this.mapping.date_stop].clone().startOf('day'):null;}
if(!date_stop&&date_delay){date_stop=date_start.clone().add(date_delay,'hours');}
if(!all_day){date_start.add(this.getSession().getTZOffset(date_start),'minutes');date_stop.add(this.getSession().getTZOffset(date_stop),'minutes');}
if(this.mapping.all_day&&evt[this.mapping.all_day]){date_stop.add(1,'days');}
var r={'record':evt,'start':date_start.local(true).toDate(),'end':date_stop.local(true).toDate(),'r_start':date_start.clone().local(true).toDate(),'r_end':date_stop.clone().local(true).toDate(),'title':the_title,'allDay':all_day,'id':evt.id,'attendees':attendees,};if(!(this.mapping.all_day&&evt[this.mapping.all_day])&&this.data.scale==='month'&&this.fields[this.mapping.date_start].type!=='date'){r.showTime=true;}
return r;},});});;

/* /web/static/src/js/views/calendar/calendar_popover.js defined in bundle 'web.assets_backend' */
odoo.define('web.CalendarPopover',function(require){"use strict";var fieldRegistry=require('web.field_registry');const fieldRegistryOwl=require('web.field_registry_owl');const FieldWrapper=require('web.FieldWrapper');var StandaloneFieldManagerMixin=require('web.StandaloneFieldManagerMixin');var Widget=require('web.Widget');const{WidgetAdapterMixin}=require('web.OwlCompatibility');var CalendarPopover=Widget.extend(WidgetAdapterMixin,StandaloneFieldManagerMixin,{template:'CalendarView.event.popover',events:{'click .o_cw_popover_edit':'_onClickPopoverEdit','click .o_cw_popover_delete':'_onClickPopoverDelete',},init:function(parent,eventInfo){this._super.apply(this,arguments);StandaloneFieldManagerMixin.init.call(this);this.hideDate=eventInfo.hideDate;this.hideTime=eventInfo.hideTime;this.eventTime=eventInfo.eventTime;this.eventDate=eventInfo.eventDate;this.displayFields=eventInfo.displayFields;this.fields=eventInfo.fields;this.event=eventInfo.event;this.modelName=eventInfo.modelName;this._canDelete=eventInfo.canDelete;},willStart:function(){return Promise.all([this._super.apply(this,arguments),this._processFields()]);},start:function(){var self=this;_.each(this.$fieldsList,function($field){$field.appendTo(self.$('.o_cw_popover_fields_secondary'));});return this._super.apply(this,arguments);},destroy:function(){this._super.apply(this,arguments);WidgetAdapterMixin.destroy.call(this);},on_attach_callback:function(){WidgetAdapterMixin.on_attach_callback.call(this);},on_detach_callback:function(){WidgetAdapterMixin.on_detach_callback.call(this);},isEventDeletable(){return this._canDelete;;},isEventDetailsVisible(){return true;},isEventEditable(){return true;},_processFields:function(){var self=this;var fieldsToGenerate=[];var fields=_.keys(this.displayFields);for(var i=0;i<fields.length;i++){var fieldName=fields[i];var displayFieldInfo=self.displayFields[fieldName]||{attrs:{invisible:1}};var fieldInfo=self.fields[fieldName];var field={name:fieldName,string:displayFieldInfo.attrs.string||fieldInfo.string,value:self.event.extendedProps.record[fieldName],type:fieldInfo.type,invisible:displayFieldInfo.attrs.invisible,};if(field.type==='selection'){field.selection=fieldInfo.selection;}
if(field.type==='monetary'){var currencyField=field.currency_field||'currency_id';if(!fields.includes(currencyField)&&_.has(self.event.extendedProps.record,currencyField)){fields.push(currencyField);}}
if(fieldInfo.relation){field.relation=fieldInfo.relation;}
if(displayFieldInfo.attrs.widget){field.widget=displayFieldInfo.attrs.widget;}else if(_.contains(['many2many','one2many'],field.type)){field.widget='many2many_tags';}
if(_.contains(['many2many','one2many'],field.type)){field.fields=[{name:'id',type:'integer',},{name:'display_name',type:'char',}];}
fieldsToGenerate.push(field);};this.$fieldsList=[];return this.model.makeRecord(this.modelName,fieldsToGenerate).then(function(recordID){var defs=[];var record=self.model.get(recordID);_.each(fieldsToGenerate,function(field){if(field.invisible)return;let isLegacy=true;let fieldWidget;let FieldClass=fieldRegistryOwl.getAny([field.widget,field.type]);if(FieldClass){isLegacy=false;fieldWidget=new FieldWrapper(this,FieldClass,{fieldName:field.name,record,options:self.displayFields[field.name],});}else{FieldClass=fieldRegistry.getAny([field.widget,field.type]);fieldWidget=new FieldClass(self,field.name,record,self.displayFields[field.name]);}
if(fieldWidget.attrs&&!_.isObject(fieldWidget.attrs.modifiers)){fieldWidget.attrs.modifiers=fieldWidget.attrs.modifiers?JSON.parse(fieldWidget.attrs.modifiers):{};}
self._registerWidget(recordID,field.name,fieldWidget);var $field=$('<li>',{class:'list-group-item flex-shrink-0 d-flex flex-wrap'});var $fieldLabel=$('<strong>',{class:'mr-2',text:_.str.sprintf('%s : ',field.string)});$fieldLabel.appendTo($field);var $fieldContainer=$('<div>',{class:'flex-grow-1'});$fieldContainer.appendTo($field);let def;if(isLegacy){def=fieldWidget.appendTo($fieldContainer);}else{def=fieldWidget.mount($fieldContainer[0]);}
self.$fieldsList.push($field);defs.push(def);});return Promise.all(defs);});},_onClickPopoverEdit:function(ev){ev.preventDefault();this.trigger_up('edit_event',{id:this.event.id,title:this.event.extendedProps.record.display_name,});},_onClickPopoverDelete:function(ev){ev.preventDefault();this.trigger_up('delete_event',{id:this.event.id});},});return CalendarPopover;});;

/* /web/static/src/js/views/calendar/calendar_quick_create.js defined in bundle 'web.assets_backend' */
odoo.define('web.CalendarQuickCreate',function(require){"use strict";var core=require('web.core');var Dialog=require('web.Dialog');var _t=core._t;var QWeb=core.qweb;var QuickCreate=Dialog.extend({events:_.extend({},Dialog.events,{'keyup input':'_onkeyup',}),init:function(parent,buttons,options,dataTemplate,dataCalendar){this._buttons=buttons||false;this.options=options;this.dataTemplate=dataTemplate||{};this.dataCalendar=dataCalendar;var self=this;this._super(parent,{title:options.title,size:'small',buttons:this._buttons?[{text:_t("Create"),classes:'btn-primary',click:function(){if(!self._quickAdd(dataCalendar)){self.focus();}}},{text:_t("Edit"),click:function(){dataCalendar.disableQuickCreate=true;dataCalendar.title=self.$('input').val().trim();dataCalendar.on_save=self.destroy.bind(self);self.trigger_up('openCreate',dataCalendar);}},{text:_t("Cancel"),close:true},]:[],$content:QWeb.render('CalendarView.quick_create',{widget:this})});},focus:function(){this.$('input').focus();},_quickAdd:function(dataCalendar){dataCalendar=$.extend({},this.dataTemplate,dataCalendar);var val=this.$('input').val().trim();if(!val){this.$('label, input').addClass('o_field_invalid');var warnings=_.str.sprintf('<ul><li>%s</li></ul>',_t("Summary"));this.do_warn(_t("Invalid fields:"),warnings);}
dataCalendar.title=val;return(val)?this.trigger_up('quickCreate',{data:dataCalendar,options:this.options}):false;},_onkeyup:function(event){if(this._flagEnter){return;}
if(event.keyCode===$.ui.keyCode.ENTER){this._flagEnter=true;if(!this._quickAdd(this.dataCalendar)){this._flagEnter=false;}}else if(event.keyCode===$.ui.keyCode.ESCAPE&&this._buttons){this.close();}},});return QuickCreate;});;

/* /web/static/src/js/views/calendar/calendar_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('web.CalendarRenderer',function(require){"use strict";var AbstractRenderer=require('web.AbstractRenderer');var CalendarPopover=require('web.CalendarPopover');var core=require('web.core');var Dialog=require('web.Dialog');var field_utils=require('web.field_utils');var FieldManagerMixin=require('web.FieldManagerMixin');var relational_fields=require('web.relational_fields');var session=require('web.session');var Widget=require('web.Widget');const{createYearCalendarView}=require('/web/static/src/js/libs/fullcalendar.js');var _t=core._t;var qweb=core.qweb;var SidebarFilterM2O=relational_fields.FieldMany2One.extend({_getSearchBlacklist:function(){return this._super.apply(this,arguments).concat(this.filter_ids||[]);},});var SidebarFilter=Widget.extend(FieldManagerMixin,{template:'CalendarView.sidebar.filter',custom_events:_.extend({},FieldManagerMixin.custom_events,{field_changed:'_onFieldChanged',}),init:function(parent,options){this._super.apply(this,arguments);FieldManagerMixin.init.call(this);this.title=options.title;this.fields=options.fields;this.fieldName=options.fieldName;this.write_model=options.write_model;this.write_field=options.write_field;this.avatar_field=options.avatar_field;this.avatar_model=options.avatar_model;this.filters=options.filters;this.label=options.label;this.getColor=options.getColor;},willStart:function(){var self=this;var defs=[this._super.apply(this,arguments)];if(this.write_model||this.write_field){var def=this.model.makeRecord(this.write_model,[{name:this.write_field,relation:this.fields[this.fieldName].relation,type:'many2one',}]).then(function(recordID){self.many2one=new SidebarFilterM2O(self,self.write_field,self.model.get(recordID),{mode:'edit',attrs:{string:_t(self.fields[self.fieldName].string),placeholder:"+ "+_.str.sprintf(_t("Add %s"),self.title),can_create:false},});});defs.push(def);}
return Promise.all(defs);},start:function(){this._super();if(this.many2one){this.many2one.appendTo(this.$el);this.many2one.filter_ids=_.without(_.pluck(this.filters,'value'),'all');}
this.$el.on('click','.o_remove',this._onFilterRemove.bind(this));this.$el.on('click','.o_calendar_filter_items input',this._onFilterActive.bind(this));},_onFieldChanged:function(event){var self=this;event.stopPropagation();var createValues={'user_id':session.uid};var value=event.data.changes[this.write_field].id;createValues[this.write_field]=value;this._rpc({model:this.write_model,method:'create',args:[createValues],}).then(function(){self.trigger_up('changeFilter',{'fieldName':self.fieldName,'value':value,'active':true,});});},_onFilterActive:function(e){var $input=$(e.currentTarget);this.trigger_up('changeFilter',{'fieldName':this.fieldName,'value':$input.closest('.o_calendar_filter_item').data('value'),'active':$input.prop('checked'),});},_onFilterRemove:function(e){var self=this;var $filter=$(e.currentTarget).closest('.o_calendar_filter_item');Dialog.confirm(this,_t("Do you really want to delete this filter from favorites ?"),{confirm_callback:function(){self._rpc({model:self.write_model,method:'unlink',args:[[$filter.data('id')]],}).then(function(){self.trigger_up('changeFilter',{'fieldName':self.fieldName,'id':$filter.data('id'),'active':false,'value':$filter.data('value'),});});},});},});return AbstractRenderer.extend({template:"CalendarView",config:{CalendarPopover:CalendarPopover,},custom_events:_.extend({},AbstractRenderer.prototype.custom_events||{},{edit_event:'_onEditEvent',delete_event:'_onDeleteEvent',}),init:function(parent,state,params){this._super.apply(this,arguments);this.displayFields=params.displayFields;this.model=params.model;this.filters=[];this.color_map={};this.hideDate=params.hideDate;this.hideTime=params.hideTime;this.canDelete=params.canDelete;this.canCreate=params.canCreate;this.scalesInfo=params.scalesInfo;this._isInDOM=false;},start:function(){this._initSidebar();this._initCalendar();return this._super();},on_attach_callback:function(){this._super(...arguments);this._isInDOM=true;this.calendar.render();this._renderCalendar();window.addEventListener('click',this._onWindowClick.bind(this));},on_detach_callback:function(){this._super(...arguments);this._isInDOM=false;window.removeEventListener('click',this._onWindowClick);},destroy:function(){if(this.calendar){this.calendar.destroy();}
if(this.$small_calendar){this.$small_calendar.datepicker('destroy');$('#ui-datepicker-div:empty').remove();}
this._super.apply(this,arguments);},getAvatars:function(record,fieldName,imageField){var field=this.state.fields[fieldName];if(!record[fieldName]){return[];}
if(field.type==='one2many'||field.type==='many2many'){return _.map(record[fieldName],function(id){return'<img src="/web/image/'+field.relation+'/'+id+'/'+imageField+'" />';});}else if(field.type==='many2one'){return['<img src="/web/image/'+field.relation+'/'+record[fieldName][0]+'/'+imageField+'" />'];}else{var value=this._format(record,fieldName);var color=this.getColor(value);if(isNaN(color)){return['<span class="o_avatar_square" style="background-color:'+color+';"/>'];}
else{return['<span class="o_avatar_square o_calendar_color_'+color+'"/>'];}}},getColor:function(key){if(!key){return;}
if(this.color_map[key]){return this.color_map[key];}
if(typeof key==='string'&&key.match(/^((#[A-F0-9]{3})|(#[A-F0-9]{6})|((hsl|rgb)a?\(\s*(?:(\s*\d{1,3}%?\s*),?){3}(\s*,[0-9.]{1,4})?\))|)$/i)){return this.color_map[key]=key;}
if(typeof key==='number'&&!(key in this.color_map)){return this.color_map[key]=key;}
var index=(((_.keys(this.color_map).length+1)*5)%24)+1;this.color_map[key]=index;return index;},getLocalState:function(){var fcScroller=this.calendarElement.querySelector('.fc-scroller');return{scrollPosition:fcScroller.scrollTop,};},setLocalState:function(localState){if(localState.scrollPosition){var fcScroller=this.calendarElement.querySelector('.fc-scroller');fcScroller.scrollTop=localState.scrollPosition;}},_convertEventToFC3Event:function(fc4Event){var event=fc4Event;if(!moment.isMoment(fc4Event.start)){event={id:fc4Event.id,title:fc4Event.title,start:moment(fc4Event.start).utcOffset(0,true),end:fc4Event.end&&moment(fc4Event.end).utcOffset(0,true),allDay:fc4Event.allDay,color:fc4Event.color,};if(fc4Event.extendedProps){event=Object.assign({},event,{r_start:fc4Event.extendedProps.r_start&&moment(fc4Event.extendedProps.r_start).utcOffset(0,true),r_end:fc4Event.extendedProps.r_end&&moment(fc4Event.extendedProps.r_end).utcOffset(0,true),record:fc4Event.extendedProps.record,attendees:fc4Event.extendedProps.attendees,});}}
return event;},_eventRender:function(event){var qweb_context={event:event,record:event.extendedProps.record,color:this.getColor(event.extendedProps.color_index),showTime:!self.hideTime&&event.extendedProps.showTime,};this.qweb_context=qweb_context;if(_.isEmpty(qweb_context.record)){return'';}else{return qweb.render("calendar-box",qweb_context);}},_format:function(record,fieldName){var field=this.state.fields[fieldName];if(field.type==="one2many"||field.type==="many2many"){return field_utils.format[field.type]({data:record[fieldName]},field);}else{return field_utils.format[field.type](record[fieldName],field,{forceString:true});}},_getFullCalendarOptions:function(fcOptions){var self=this;const options=Object.assign({},this.state.fc_options,{plugins:['moment','interaction','dayGrid','timeGrid'],eventDrop:function(eventDropInfo){var event=self._convertEventToFC3Event(eventDropInfo.event);self.trigger_up('dropRecord',event);},eventResize:function(eventResizeInfo){self._unselectEvent();var event=self._convertEventToFC3Event(eventResizeInfo.event);self.trigger_up('updateRecord',event);},eventClick:function(eventClickInfo){eventClickInfo.jsEvent.preventDefault();eventClickInfo.jsEvent.stopPropagation();var eventData=eventClickInfo.event;self._unselectEvent();$(self.calendarElement).find(_.str.sprintf('[data-event-id=%s]',eventData.id)).addClass('o_cw_custom_highlight');self._renderEventPopover(eventData,$(eventClickInfo.el));},yearDateClick:function(info){self._unselectEvent();info.view.unselect();if(!info.events.length){if(info.selectable){const data={start:info.date,allDay:true,};if(self.state.context.default_name){data.title=self.state.context.default_name;}
self.trigger_up('openCreate',self._convertEventToFC3Event(data));}}else{self._renderYearEventPopover(info.date,info.events,$(info.dayEl));}},select:function(selectionInfo){if(self.$('.o_cw_popover').length){self._unselectEvent();}
var data={start:selectionInfo.start,end:selectionInfo.end,allDay:selectionInfo.allDay};if(self.state.context.default_name){data.title=self.state.context.default_name;}
self.trigger_up('openCreate',self._convertEventToFC3Event(data));if(self.state.scale==='year'){self.calendar.view.unselect();}else{self.calendar.unselect();}},eventRender:function(info){var event=info.event;var element=$(info.el);var view=info.view;element.attr('data-event-id',event.id);if(view.type==='dayGridYear'){const color=this.getColor(event.extendedProps.color_index);if(typeof color==='string'){element.css({backgroundColor:color,});}else if(typeof color==='number'){element.addClass(`o_calendar_color_${color}`);}else{element.addClass('o_calendar_color_1');}}else{var $render=$(self._eventRender(event));element.find('.fc-content').html($render.html());element.addClass($render.attr('class'));if(!element.find('.fc-bg').length){element.find('.fc-content').after($('<div/>',{class:'fc-bg'}));}
if(view.type==='dayGridMonth'&&event.extendedProps.record){var start=event.extendedProps.r_start||event.start;var end=event.extendedProps.r_end||event.end;var isSameDayEvent=moment(start).clone().add(1,'minute').isSame(moment(end).clone().subtract(1,'minute'),'day');if(!event.extendedProps.record.allday&&isSameDayEvent){element.addClass('o_cw_nobg');if(event.extendedProps.showTime&&!self.hideTime){const displayTime=moment(start).clone().format(self._getDbTimeFormat());element.find('.fc-content .fc-time').text(displayTime);}}}
element.on('dblclick',function(){self.trigger_up('edit_event',{id:event.id});});}},datesRender:function(info){const viewToMode=Object.fromEntries(Object.entries(self.scalesInfo).map(([k,v])=>[v,k]));self.trigger_up('viewUpdated',{mode:viewToMode[info.view.type],title:info.view.title,});},eventMouseEnter:function(mouseEnterInfo){$(self.calendarElement).find(_.str.sprintf('[data-event-id=%s]',mouseEnterInfo.event.id)).addClass('o_cw_custom_hover');},eventMouseLeave:function(mouseLeaveInfo){if(!mouseLeaveInfo.event.id){return;}
$(self.calendarElement).find(_.str.sprintf('[data-event-id=%s]',mouseLeaveInfo.event.id)).removeClass('o_cw_custom_hover');},eventDragStart:function(mouseDragInfo){mouseDragInfo.el.classList.add(mouseDragInfo.view.type);$(self.calendarElement).find(_.str.sprintf('[data-event-id=%s]',mouseDragInfo.event.id)).addClass('o_cw_custom_hover');self._unselectEvent();},eventResizeStart:function(mouseResizeInfo){$(self.calendarElement).find(_.str.sprintf('[data-event-id=%s]',mouseResizeInfo.event.id)).addClass('o_cw_custom_hover');self._unselectEvent();},eventLimitClick:function(){self._unselectEvent();return'popover';},windowResize:function(){self._render();},views:{timeGridDay:{columnHeaderFormat:'LL'},timeGridWeek:{columnHeaderFormat:'ddd D'},dayGridMonth:{columnHeaderFormat:'dddd'}},height:'parent',unselectAuto:false,dir:_t.database.parameters.direction,events:(info,successCB)=>{successCB(self.state.data);},},fcOptions);options.plugins.push(createYearCalendarView(FullCalendar,options));return options;},_initCalendar:function(){this.calendarElement=this.$(".o_calendar_widget")[0];var locale=moment.locale();var fcOptions=this._getFullCalendarOptions({locale:locale,});this.calendar=new FullCalendar.Calendar(this.calendarElement,fcOptions);},_initCalendarMini:function(){var self=this;this.$small_calendar=this.$(".o_calendar_mini");this.$small_calendar.datepicker({'onSelect':function(datum,obj){self.trigger_up('changeDate',{date:moment(new Date(+obj.currentYear,+obj.currentMonth,+obj.currentDay))});},'showOtherMonths':true,'dayNamesMin':this.state.fc_options.dayNamesMin.map(x=>x[0]),'monthNames':this.state.fc_options.monthNamesShort,'firstDay':this.state.fc_options.firstDay,});},_initSidebar:function(){this.$sidebar=this.$('.o_calendar_sidebar');this.$sidebar_container=this.$(".o_calendar_sidebar_container");this._initCalendarMini();},_onPopoverShown:function($popoverElement,calendarPopover){var $popover=$($popoverElement.data('bs.popover').tip);$popover.find('.o_cw_popover_close').on('click',this._unselectEvent.bind(this));$popover.find('.o_cw_body').replaceWith(calendarPopover.$el);},async _renderView(){this.$('.o_calendar_view')[0].prepend(this.calendarElement);if(this._isInDOM){this._renderCalendar();}
this.$small_calendar.datepicker("setDate",this.state.highlight_date.toDate()).find('.o_selected_range').removeClass('o_color o_selected_range');var $a;switch(this.state.scale){case'year':$a=this.$small_calendar.find('td');break;case'month':$a=this.$small_calendar.find('td');break;case'week':$a=this.$small_calendar.find('tr:has(.ui-state-active)');break;case'day':$a=this.$small_calendar.find('a.ui-state-active');break;}
$a.addClass('o_selected_range');setTimeout(function(){$a.not('.ui-state-active').addClass('o_color');});await this._renderFilters();},_renderCalendar(){this.calendar.unselect();if(this.scalesInfo[this.state.scale]!==this.calendar.view.type){this.calendar.changeView(this.scalesInfo[this.state.scale]);}
if(this.target_date!==this.state.target_date.toString()){this.calendar.gotoDate(moment(this.state.target_date).toDate());this.target_date=this.state.target_date.toString();}else{this._renderEvents();}
this._unselectEvent();},_renderEvents:function(){this.calendar.refetchEvents();},_renderFilters:function(){this.$('.o_calendar_filter_item').popover('dispose');_.each(this.filters||(this.filters=[]),function(filter){filter.destroy();});if(this.state.fullWidth){return Promise.resolve();}
return this._renderFiltersOneByOne();},_renderFiltersOneByOne:function(filterIndex){filterIndex=filterIndex||0;var arrFilters=_.toArray(this.state.filters);var prom;if(filterIndex<arrFilters.length){var options=arrFilters[filterIndex];if(!_.find(options.filters,function(f){return f.display==null||f.display;})){return this._renderFiltersOneByOne(filterIndex+1);}
var self=this;options.getColor=this.getColor.bind(this);options.fields=this.state.fields;var sidebarFilter=new SidebarFilter(self,options);prom=sidebarFilter.appendTo(this.$sidebar).then(function(){if(options.avatar_field){_.each(options.filters,function(filter){if(!['all',false].includes(filter.value)){var selector=_.str.sprintf('.o_calendar_filter_item[data-value=%s]',filter.value);sidebarFilter.$el.find(selector).popover({animation:false,trigger:'hover',html:true,placement:'top',title:filter.label,delay:{show:300,hide:0},content:function(){return $('<img>',{src:_.str.sprintf('/web/image/%s/%s/%s',options.avatar_model,filter.value,options.avatar_field),class:'mx-auto',});},});}});}
return self._renderFiltersOneByOne(filterIndex+1);});this.filters.push(sidebarFilter);}
return Promise.resolve(prom);},_getDbTimeFormat:function(){return _t.database.parameters.time_format.search('%H')!==-1?'HH:mm':'hh:mm a';},_getFormattedDate:function(start,end,showDayName,allDay){const isSameDayEvent=start.clone().add(1,'minute').isSame(end.clone().subtract(1,'minute'),'day');if(allDay){end=end.clone().subtract(1,'day');}
if(!isSameDayEvent&&start.isSame(end,'month')){return start.clone().format('MMMM D')+'-'+end.clone().format('D, YYYY');}else{return isSameDayEvent?start.clone().format(showDayName?'dddd, LL':'LL'):start.clone().format('LL')+' - '+end.clone().format('LL');}},_getPopoverContext:function(eventData){var context={hideDate:this.hideDate,hideTime:this.hideTime,eventTime:{},eventDate:{},fields:this.state.fields,displayFields:this.displayFields,event:eventData,modelName:this.model,canDelete:this.canDelete,};var start=moment((eventData.extendedProps&&eventData.extendedProps.r_start)||eventData.start);var end=moment((eventData.extendedProps&&eventData.extendedProps.r_end)||eventData.end);var isSameDayEvent=start.clone().add(1,'minute').isSame(end.clone().subtract(1,'minute'),'day');if(!this.hideTime&&!eventData.extendedProps.record.allday&&isSameDayEvent){var dbTimeFormat=this._getDbTimeFormat();context.eventTime.time=start.clone().format(dbTimeFormat)+' - '+end.clone().format(dbTimeFormat);var durationHours=moment.duration(end.diff(start)).hours();var durationHoursKey=(durationHours===1)?'h':'hh';var durationMinutes=moment.duration(end.diff(start)).minutes();var durationMinutesKey=(durationMinutes===1)?'m':'mm';var localeData=moment.localeData();context.eventTime.duration=(durationHours>0?localeData.relativeTime(durationHours,true,durationHoursKey):'')
+(durationHours>0&&durationMinutes>0?', ':'')
+(durationMinutes>0?localeData.relativeTime(durationMinutes,true,durationMinutesKey):'');}
if(!this.hideDate){if(eventData.extendedProps.record.allday&&isSameDayEvent){context.eventDate.duration=_t("All day");}else if(eventData.extendedProps.record.allday&&!isSameDayEvent){var daysLocaleData=moment.localeData();var days=moment.duration(end.diff(start)).days();context.eventDate.duration=daysLocaleData.relativeTime(days,true,'dd');}
context.eventDate.date=this._getFormattedDate(start,end,true,eventData.extendedProps.record.allday);}
return context;},_getPopoverParams:function(eventData){return{animation:false,delay:{show:50,hide:100},trigger:'manual',html:true,title:eventData.extendedProps.record.display_name,template:qweb.render('CalendarView.event.popover.placeholder',{color:this.getColor(eventData.extendedProps.color_index)}),container:eventData.allDay?'.fc-view':'.fc-scroller',}},_renderEventPopover:function(eventData,$eventElement){var self=this;var calendarPopover=new self.config.CalendarPopover(self,self._getPopoverContext(eventData));calendarPopover.appendTo($('<div>')).then(()=>{$eventElement.popover(self._getPopoverParams(eventData)).on('shown.bs.popover',function(){self._onPopoverShown($(this),calendarPopover);}).popover('show');});},_renderYearEventPopover:function(date,events,$el){const groupKeys=[];const groupedEvents={};for(const event of events){const start=moment(event.extendedProps.r_start);const end=moment(event.extendedProps.r_end);const key=this._getFormattedDate(start,end,false,event.extendedProps.record.allday);if(!(key in groupedEvents)){groupedEvents[key]=[];groupKeys.push({key:key,start:event.extendedProps.r_start,end:event.extendedProps.r_end,isSameDayEvent:start.clone().add(1,'minute').isSame(end.clone().subtract(1,'minute'),'day'),});}
groupedEvents[key].push(event);}
const popoverContent=qweb.render('CalendarView.yearEvent.popover',{groupedEvents,groupKeys:groupKeys.sort((a,b)=>{if(a.isSameDayEvent){return Number.MIN_SAFE_INTEGER;}else if(b.isSameDayEvent){return Number.MAX_SAFE_INTEGER;}else if(a.start.getTime()-b.start.getTime()===0){return a.end.getTime()-b.end.getTime();}
return a.start.getTime()-b.start.getTime();}).map(x=>x.key),canCreate:this.canCreate,});$el.popover({animation:false,delay:{show:50,hide:100},trigger:'manual',html:true,content:popoverContent,template:qweb.render('CalendarView.yearEvent.popover.placeholder'),container:'.fc-dayGridYear-view',}).on('shown.bs.popover',()=>{$('.o_cw_popover .o_cw_popover_close').on('click',()=>this._unselectEvent());$('.o_cw_popover .o_cw_popover_create').on('click',(e)=>{e.preventDefault();e.stopPropagation();this._unselectEvent();const data={start:date,allDay:true,};if(this.state.context.default_name){data.title=this.state.context.default_name;}
this.trigger_up('openCreate',this._convertEventToFC3Event(data));});$('.o_cw_popover .o_cw_popover_link').on('click',(e)=>{e.preventDefault();e.stopPropagation();this._unselectEvent();this.trigger_up('openEvent',{_id:parseInt(e.target.dataset.id,10),title:e.target.dataset.title,});});}).popover('show');},_scrollToScrollTime:function(){var scrollTime=this.calendar.getOption('scrollTime');this.calendar.scrollToTime(scrollTime);},_unselectEvent:function(){this.$('.fc-event').removeClass('o_cw_custom_highlight');this.$('.o_cw_popover').popover('dispose');},_onWindowClick:function(e){const popover=this.el.querySelector('.o_cw_popover');if(popover&&!popover.contains(e.target)){this._unselectEvent();}},_onEditEvent:function(event){this._unselectEvent();this.trigger_up('openEvent',{_id:event.data.id,title:event.data.title,});},_onDeleteEvent:function(event){this._unselectEvent();this.trigger_up('deleteRecord',{id:parseInt(event.data.id,10)});},});});;

/* /web/static/src/js/views/calendar/calendar_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.CalendarView',function(require){"use strict";var AbstractView=require('web.AbstractView');var CalendarModel=require('web.CalendarModel');var CalendarController=require('web.CalendarController');var CalendarRenderer=require('web.CalendarRenderer');var core=require('web.core');var pyUtils=require('web.py_utils');var utils=require('web.utils');var _lt=core._lt;var fieldsToGather=["date_start","date_delay","date_stop","all_day","recurrence_update"];const scalesInfo={day:'timeGridDay',week:'timeGridWeek',month:'dayGridMonth',year:'dayGridYear',};var CalendarView=AbstractView.extend({display_name:_lt('Calendar'),icon:'fa-calendar',jsLibs:['/web/static/lib/fullcalendar/core/main.js','/web/static/lib/fullcalendar/interaction/main.js','/web/static/lib/fullcalendar/moment/main.js','/web/static/lib/fullcalendar/daygrid/main.js','/web/static/lib/fullcalendar/timegrid/main.js','/web/static/lib/fullcalendar/list/main.js'],cssLibs:['/web/static/lib/fullcalendar/core/main.css','/web/static/lib/fullcalendar/daygrid/main.css','/web/static/lib/fullcalendar/timegrid/main.css','/web/static/lib/fullcalendar/list/main.css'],config:_.extend({},AbstractView.prototype.config,{Model:CalendarModel,Controller:CalendarController,Renderer:CalendarRenderer,}),viewType:'calendar',searchMenuTypes:['filter','favorite'],init:function(viewInfo,params){this._super.apply(this,arguments);var arch=this.arch;var fields=this.fields;var attrs=arch.attrs;if(!attrs.date_start){throw new Error(_lt("Calendar view has not defined 'date_start' attribute."));}
var mapping={};var fieldNames=fields.display_name?['display_name']:[];var displayFields={};_.each(fieldsToGather,function(field){if(arch.attrs[field]){var fieldName=attrs[field];mapping[field]=fieldName;fieldNames.push(fieldName);}});var filters={};var eventLimit=attrs.event_limit!==null&&(isNaN(+attrs.event_limit)?_.str.toBool(attrs.event_limit):+attrs.event_limit);var modelFilters=[];_.each(arch.children,function(child){if(child.tag!=='field')return;var fieldName=child.attrs.name;fieldNames.push(fieldName);if(!child.attrs.invisible||child.attrs.filters){child.attrs.options=child.attrs.options?pyUtils.py_eval(child.attrs.options):{};if(!child.attrs.invisible){displayFields[fieldName]={attrs:child.attrs};}
if(params.sidebar===false)return;if(child.attrs.avatar_field){filters[fieldName]=filters[fieldName]||{'title':fields[fieldName].string,'fieldName':fieldName,'filters':[],};filters[fieldName].avatar_field=child.attrs.avatar_field;filters[fieldName].avatar_model=fields[fieldName].relation;}
if(child.attrs.write_model){filters[fieldName]=filters[fieldName]||{'title':fields[fieldName].string,'fieldName':fieldName,'filters':[],};filters[fieldName].write_model=child.attrs.write_model;filters[fieldName].write_field=child.attrs.write_field;modelFilters.push(fields[fieldName].relation);}
if(child.attrs.filters){filters[fieldName]=filters[fieldName]||{'title':fields[fieldName].string,'fieldName':fieldName,'filters':[],};if(child.attrs.color){filters[fieldName].field_color=child.attrs.color;filters[fieldName].color_model=fields[fieldName].relation;}
if(!child.attrs.avatar_field&&fields[fieldName].relation){if(fields[fieldName].relation.includes(['res.users','res.partner','hr.employee'])){filters[fieldName].avatar_field='image_128';}
filters[fieldName].avatar_model=fields[fieldName].relation;}}}});if(attrs.color){var fieldName=attrs.color;fieldNames.push(fieldName);}
this.controllerParams.quickAddPop=(!('quick_add'in attrs)||utils.toBoolElse(attrs.quick_add+'',true));this.controllerParams.disableQuickCreate=params.disable_quick_create||!this.controllerParams.quickAddPop;this.controllerParams.formViewId=attrs.form_view_id?parseInt(attrs.form_view_id,10):false;if(!this.controllerParams.formViewId&&params.action){var formViewDescr=_.find(params.action.views,function(v){return v.type==='form';});if(formViewDescr){this.controllerParams.formViewId=formViewDescr.viewID;}}
let scales;const allowedScales=Object.keys(scalesInfo);if(arch.attrs.scales){scales=arch.attrs.scales.split(',').filter(x=>allowedScales.includes(x));}else{scales=allowedScales;}
this.controllerParams.eventOpenPopup=utils.toBoolElse(attrs.event_open_popup||'',false);this.controllerParams.showUnusualDays=utils.toBoolElse(attrs.show_unusual_days||'',false);this.controllerParams.mapping=mapping;this.controllerParams.context=params.context||{};this.controllerParams.displayName=params.action&&params.action.name;this.controllerParams.scales=scales;this.rendererParams.displayFields=displayFields;this.rendererParams.model=viewInfo.model;this.rendererParams.hideDate=utils.toBoolElse(attrs.hide_date||'',false);this.rendererParams.hideTime=utils.toBoolElse(attrs.hide_time||'',false);this.rendererParams.canDelete=this.controllerParams.activeActions.delete;this.rendererParams.canCreate=this.controllerParams.activeActions.create;this.rendererParams.scalesInfo=scalesInfo;this.loadParams.fieldNames=_.uniq(fieldNames);this.loadParams.mapping=mapping;this.loadParams.fields=fields;this.loadParams.fieldsInfo=viewInfo.fieldsInfo;this.loadParams.editable=!fields[mapping.date_start].readonly;this.loadParams.creatable=this.controllerParams.activeActions.create;this.loadParams.eventLimit=eventLimit;this.loadParams.fieldColor=attrs.color;this.loadParams.filters=filters;this.loadParams.mode=(params.context&&params.context.default_mode)||attrs.mode;this.loadParams.scales=scales;this.loadParams.initialDate=moment(params.initialDate||new Date());this.loadParams.scalesInfo=scalesInfo;},});return CalendarView;});;

/* /web/static/src/js/views/qweb/qweb_view.js defined in bundle 'web.assets_backend' */
odoo.define('web.qweb',function(require){"use strict";var core=require('web.core');var AbstractView=require('web.AbstractView');var AbstractModel=require('web.AbstractModel');var AbstractRenderer=require('web.AbstractRenderer');var AbstractController=require('web.AbstractController');var registry=require('web.view_registry');var _lt=core._lt;var Model=AbstractModel.extend({init:function(){this._super.apply(this,arguments);this._state={viewId:false,modelName:false,body:'',context:{},domain:[],};},_fetch:function(){var state=this._state;return this._rpc({model:state.modelName,method:'qweb_render_view',kwargs:{view_id:state.viewId,domain:state.domain,context:state.context}}).then(function(r){state.body=r;return state.viewId;});},__get:function(){return this._state;},__load:function(params){_.extend(this._state,_.pick(params,['viewId','modelName','domain','context']));return this._fetch();},__reload:function(_id,params){_.extend(this._state,_.pick(params,['domain','context']));return this._fetch();}});var Renderer=AbstractRenderer.extend({_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){self.$el.html(self.state.body);});}});var Controller=AbstractController.extend({events:_.extend({},AbstractController.prototype.events,{'click [type="toggle"]':'_onLazyToggle','click [type="action"]':'_onActionClicked',}),init:function(){this._super.apply(this,arguments);},renderButtons:function($node){this.$buttons=$('<nav/>');if($node){$node.append(this.$buttons);}},_update:function(){var self=this;return this._super.apply(this,arguments).then(function(){var $cp_buttons=self.renderer.$('nav.o_qweb_cp_buttons');$cp_buttons.children().appendTo(self.$buttons.empty());$cp_buttons.remove();});},_onLazyToggle:function(e){var $target=$(e.target);var $t=$target.closest('[data-model]');if(!($target.hasClass('fa-caret-down')||$target.hasClass('fa-caret-right'))){$target=$t.find('.fa-caret-down, .fa-caret-right');}
var data=$t.data();if(this._fold($t)){$target.removeClass('fa-caret-down').addClass('fa-caret-right');return;}
var args=data.args||_.omit(data,'model','method','id');return this._rpc({model:data.model,method:data.method,args:data.id?[data.id]:undefined,kwargs:args}).then(function(s){return $(s);}).then(function($newcontent){$t.data('children',$newcontent).after($newcontent);$target.removeClass('fa-caret-right').addClass('fa-caret-down');});},_fold:function($el){var $children=$el.data('children');if(!$children){return false;}
var self=this;$children.each(function(_i,e){self._fold($(e));}).remove();$el.removeData('children');return true;}});var QWebView=AbstractView.extend({display_name:_lt('Freedom View'),icon:'fa-file-picture-o',viewType:'qweb',enableTimeRangeMenu:true,config:_.extend({},AbstractView.prototype.config,{Model:Model,Renderer:Renderer,Controller:Controller,}),init:function(viewInfo,params){this._super.apply(this,arguments);this.loadParams.viewId=viewInfo.view_id;}});registry.add('qweb',QWebView);return{View:QWebView,Controller:Controller,Renderer:Renderer,Model:Model};});;

/* /web/static/src/js/widgets/attach_document.js defined in bundle 'web.assets_backend' */
odoo.define('web.AttachDocument',function(require){"use static";var core=require('web.core');var framework=require('web.framework');var widgetRegistry=require('web.widget_registry');var Widget=require('web.Widget');var _t=core._t;var AttachDocument=Widget.extend({template:'AttachDocument',events:{'click':'_onClickAttachDocument','change input.o_input_file':'_onFileChanged',},init:function(parent,record,nodeInfo){this._super.apply(this,arguments);this.res_id=record.res_id;this.res_model=record.model;this.state=record;this.node=nodeInfo;this.fileuploadID=_.uniqueId('o_fileupload');},start:function(){$(window).on(this.fileuploadID,this._onFileLoaded.bind(this));return this._super.apply(this,arguments);},destroy:function(){$(window).off(this.fileuploadID);this._super.apply(this,arguments);},_notifyInvalidFields:function(invalidFields){var fields=this.state.fields;var warnings=invalidFields.map(function(fieldName){var fieldStr=fields[fieldName].string;return _.str.sprintf('<li>%s</li>',_.escape(fieldStr));});warnings.unshift('<ul>');warnings.push('</ul>');this.do_warn(_t("Invalid fields:"),warnings.join(''));},_onClickAttachDocument:function(ev){if($(ev.target).is('input.o_input_file')){return;}
var fieldNames=this.getParent().canBeSaved(this.state.id);if(fieldNames.length){return this._notifyInvalidFields(fieldNames);}
if(!this.res_id){return this.do_warn(false,_t('Please save before attaching a file'));}
this.$('input.o_input_file').trigger('click');},_onFileChanged:function(ev){ev.stopPropagation();this.$('form.o_form_binary_form').trigger('submit');framework.blockUI();},_onFileLoaded:function(){var self=this;var files=Array.prototype.slice.call(arguments,1);return new Promise(function(resolve){if(self.node.attrs.action){self._rpc({model:self.res_model,method:self.node.attrs.action,args:[self.res_id],kwargs:{attachment_ids:_.map(files,function(file){return file.id;}),}}).then(function(){resolve();});}else{resolve();}}).then(function(){self.trigger_up('reload');framework.unblockUI();});},});widgetRegistry.add('attach_document',AttachDocument);});;

/* /web/static/src/js/fields/signature.js defined in bundle 'web.assets_backend' */
odoo.define('web.Signature',function(require){"use strict";var AbstractFieldBinary=require('web.basic_fields').AbstractFieldBinary;var core=require('web.core');var field_utils=require('web.field_utils');var registry=require('web.field_registry');var session=require('web.session');const SignatureDialog=require('web.signature_dialog');var utils=require('web.utils');var qweb=core.qweb;var _t=core._t;var _lt=core._lt;var FieldBinarySignature=AbstractFieldBinary.extend({description:_lt("Signature"),fieldDependencies:_.extend({},AbstractFieldBinary.prototype.fieldDependencies,{__last_update:{type:'datetime'},}),resetOnAnyFieldChange:true,custom_events:_.extend({},AbstractFieldBinary.prototype.custom_events,{upload_signature:'_onUploadSignature',}),events:_.extend({},AbstractFieldBinary.prototype.events,{'click .o_signature':'_onClickSignature',}),template:null,supportedFieldTypes:['binary'],file_type_magic_word:{'/':'jpg','R':'gif','i':'png','P':'svg+xml',},isSet:function(){if(this.mode==='edit'){return this.value;}
return true;},_render:function(){var self=this;var displaySignatureRatio=3;var url;var $img;var width=this.nodeOptions.size?this.nodeOptions.size[0]:this.attrs.width;var height=this.nodeOptions.size?this.nodeOptions.size[1]:this.attrs.height;if(this.value){if(!utils.is_bin_size(this.value)){url='data:image/'+(this.file_type_magic_word[this.value[0]]||'png')+';base64,'+this.value;}else{url=session.url('/web/image',{model:this.model,id:JSON.stringify(this.res_id),field:this.nodeOptions.preview_image||this.name,unique:field_utils.format.datetime(this.recordData.__last_update).replace(/[^0-9]/g,''),});}
$img=$(qweb.render("FieldBinarySignature-img",{widget:this,url:url}));}else{$img=$('<div class="o_signature o_signature_empty"><svg></svg><p>'+_t('SIGNATURE')+'</p></div>');if(width&&height){width=Math.min(width,displaySignatureRatio*height);height=width/displaySignatureRatio;}else if(width){height=width/displaySignatureRatio;}else if(height){width=height*displaySignatureRatio;}}
if(width){$img.attr('width',width);$img.css('max-width',width+'px');}
if(height){$img.attr('height',height);$img.css('max-height',height+'px');}
this.$('> div').remove();this.$('> img').remove();this.$el.prepend($img);$img.on('error',function(){self._clearFile();$img.attr('src',self.placeholder);self.do_warn(false,_t("Could not display the selected image"));});},_onClickSignature:function(){var self=this;if(this.mode==='edit'){var nameAndSignatureOptions={mode:'draw',displaySignatureRatio:3,signatureType:'signature',noInputName:true,};if(this.nodeOptions.full_name){var signName;if(this.fields[this.nodeOptions.full_name].type==='many2one'){signName=this.recordData[this.nodeOptions.full_name]&&this.recordData[this.nodeOptions.full_name].data.display_name;}else{signName=this.recordData[this.nodeOptions.full_name];}
nameAndSignatureOptions.defaultName=(signName==='')?undefined:signName;}
nameAndSignatureOptions.defaultFont=this.nodeOptions.default_font||'';this.signDialog=new SignatureDialog(self,{nameAndSignatureOptions:nameAndSignatureOptions});this.signDialog.open();}},_onUploadSignature:function(ev){var signatureImage=ev.data.signatureImage;if(signatureImage!==this.signDialog.emptySignature){var data=signatureImage[1];var type=signatureImage[0].split('/')[1];this.on_file_uploaded(data.length,ev.data.name,type,data);}
this.signDialog.close();}});registry.add('signature',FieldBinarySignature);});;

/* /web/static/src/js/owl_compatibility.js defined in bundle 'web.assets_backend' */
odoo.define('web.OwlCompatibility',function(){"use strict";const{Component,hooks,tags}=owl;const{useRef,useSubEnv}=hooks;const{xml}=tags;const widgetSymbol=odoo.widgetSymbol;const children=new WeakMap();class ComponentAdapter extends Component{constructor(parent,props){if(!props.Component){throw Error(`ComponentAdapter: 'Component' prop is missing.`);}
let template;if(!(props.Component.prototype instanceof Component)){template=tags.xml`<div/>`;}else{let propsStr='';for(let p in props){if(p!=='Component'){propsStr+=` ${p}="props.${p}"`;}}
template=tags.xml`<t t-component="props.Component"${propsStr}/>`;}
ComponentAdapter.template=template;super(...arguments);this.template=template;ComponentAdapter.template=null;this.widget=null;}
willStart(){if(!(this.props.Component.prototype instanceof Component)){this.widget=new this.props.Component(this,...this.widgetArgs);return this.widget._widgetRenderAndInsert(()=>{});}}
willUpdateProps(nextProps){if(this.widget){return this.updateWidget(nextProps);}}
__patch(target,vnode){if(this.widget){if(this.__owl__.vnode){this.renderWidget();}
vnode.elm=this.widget.el;}
const result=super.__patch(...arguments);if(this.widget&&this.el!==this.widget.el){this.__owl__.vnode.elm=this.widget.el;}
return result;}
mounted(){if(this.widget&&this.widget.on_attach_callback){this.widget.on_attach_callback();}}
willUnmount(){if(this.widget&&this.widget.on_detach_callback){this.widget.on_detach_callback();}}
__destroy(){super.__destroy(...arguments);if(this.widget){this.widget.destroy();}}
get widgetArgs(){if(this.props.widgetArgs){return this.props.widgetArgs;}
const args=Object.keys(this.props);args.splice(args.indexOf('Component'),1);if(args.length>1){throw new Error(`ComponentAdapter has more than 1 argument, 'widgetArgs' must be overriden.`);}
return args.map(a=>this.props[a]);}
updateWidget(){if(this.env.isDebug('assets')){console.warn(`ComponentAdapter: Widget could not be updated, maybe override 'updateWidget' function?`);}}
renderWidget(){if(this.env.isDebug('assets')){console.warn(`ComponentAdapter: Widget could not be re-rendered, maybe override 'renderWidget' function?`);}}
_trigger_up(ev){const evType=ev.name;const payload=ev.data;if(evType==='call_service'){let args=payload.args||[];if(payload.service==='ajax'&&payload.method==='rpc'){args=args.concat(ev.target);}
const service=this.env.services[payload.service];const result=service[payload.method].apply(service,args);payload.callback(result);}else if(evType==='get_session'){if(payload.callback){payload.callback(this.env.session);}}else if(evType==='load_views'){const params={model:payload.modelName,context:payload.context,views_descr:payload.views,};this.env.dataManager.load_views(params,payload.options||{}).then(payload.on_success);}else if(evType==='load_filters'){return this.env.dataManager.load_filters(payload).then(payload.on_success);}else{payload.__targetWidget=ev.target;this.trigger(evType.replace(/_/g,'-'),payload);}}}
const WidgetAdapterMixin={on_attach_callback(){for(const component of children.get(this)||[]){component.on_attach_callback();}},on_detach_callback(){for(const component of children.get(this)||[]){component.on_detach_callback();}},destroy(){for(const component of children.get(this)||[]){component.__destroy();}
children.delete(this);},};class ComponentWrapper extends Component{constructor(parent,Component,props){if(parent instanceof Component){throw new Error('ComponentWrapper must be used with a legacy Widget as parent');}
super(null,props);if(parent){this._register(parent);}
useSubEnv({[widgetSymbol]:this._addListener.bind(this)});this.parentWidget=parent;this.Component=Component;this.props=props||{};this._handledEvents=new Set();this.componentRef=useRef("component");}
on_attach_callback(){function recursiveCallMounted(component){const{status,currentFiber}=component.__owl__;if(status===2&&currentFiber&&!currentFiber.isCompleted){return;}
if(status!==2&&status!==3&&status!==4){return;}
for(const key in component.__owl__.children){recursiveCallMounted(component.__owl__.children[key]);}
component.__callMounted();}
recursiveCallMounted(this);}
on_detach_callback(){this.__callWillUnmount();}
destroy(){if(this.parentWidget){const parentChildren=children.get(this.parentWidget);if(parentChildren){const index=parentChildren.indexOf(this);children.get(this.parentWidget).splice(index,1);}}
super.destroy();}
setParent(parent){if(parent instanceof Component){throw new Error('ComponentWrapper must be used with a legacy Widget as parent');}
this._register(parent);if(this.parentWidget){const parentChildren=children.get(this.parentWidget);parentChildren.splice(parentChildren.indexOf(this),1);}
this.parentWidget=parent;}
async update(props={}){if(this.__owl__.status===5){return new Promise(()=>{});}
Object.assign(this.props,props);let prom;if(this.__owl__.status===3){prom=this.render();}else{prom=this.mount(...this._mountArgs);}
return prom;}
_addListener(evType){if(this.parentWidget&&!this._handledEvents.has(evType)){this._handledEvents.add(evType);this.el.addEventListener(evType,ev=>{if(!ev.cancelBubble){ev.stopPropagation();const detail=Object.assign({},ev.detail,{__originalComponent:ev.originalComponent,});this.parentWidget.trigger_up(ev.type.replace(/-/g,'_'),detail);}});}}
_register(parent){let parentChildren=children.get(parent);if(!parentChildren){parentChildren=[];children.set(parent,parentChildren);}
parentChildren.push(this);}
async mount(target,options){if(options&&options.position==='self'){throw new Error('Unsupported position: "self" is not allowed for wrapper components. '+'Contact the JS Framework team or open an issue if your use case is relevant.');}
this._mountArgs=arguments;return super.mount(...arguments);}}
ComponentWrapper.template=xml`<t t-component="Component" t-props="props" t-ref="component"/>`;return{ComponentAdapter,ComponentWrapper,WidgetAdapterMixin,};});;

/* /web/static/src/js/report/utils.js defined in bundle 'web.assets_backend' */
odoo.define('report.utils',function(require){'use strict';function get_protocol_from_url(url){var a=document.createElement('a');a.href=url;return a.protocol;}
function get_host_from_url(url){var a=document.createElement('a');a.href=url;return a.host;}
function build_origin(protocol,host){return protocol+'//'+host;}
return{'get_protocol_from_url':get_protocol_from_url,'get_host_from_url':get_host_from_url,'build_origin':build_origin,};});;

/* /web/static/src/js/report/client_action.js defined in bundle 'web.assets_backend' */
odoo.define('report.client_action',function(require){'use strict';var AbstractAction=require('web.AbstractAction');var core=require('web.core');var session=require('web.session');var utils=require('report.utils');var QWeb=core.qweb;var AUTHORIZED_MESSAGES=['report:do_action',];var ReportAction=AbstractAction.extend({hasControlPanel:true,contentTemplate:'report.client_action',init:function(parent,action,options){this._super.apply(this,arguments);options=options||{};this.action_manager=parent;this._title=options.display_name||options.name;this.report_url=options.report_url;this.report_name=options.report_name;this.report_file=options.report_file;this.data=options.data||{};this.context=options.context||{};},start:function(){var self=this;this.iframe=this.$('iframe')[0];this.$buttons=$(QWeb.render('report.client_action.ControlButtons',{}));this.$buttons.on('click','.o_report_print',this.on_click_print);this.controlPanelProps.cp_content={$buttons:this.$buttons,};return Promise.all([this._super.apply(this,arguments),session.is_bound]).then(async function(){var web_base_url=window.origin;var trusted_host=utils.get_host_from_url(web_base_url);var trusted_protocol=utils.get_protocol_from_url(web_base_url);self.trusted_origin=utils.build_origin(trusted_protocol,trusted_host);self.iframe.src=self.report_url;});},on_attach_callback:function(){$(window).on('message',this,this.on_message_received);this._super();},on_detach_callback:function(){$(window).off('message',this.on_message_received);this._super();},on_message_received:function(ev){var message_origin=utils.build_origin(ev.originalEvent.source.location.protocol,ev.originalEvent.source.location.host);if(message_origin===this.trusted_origin){var message=ev.originalEvent.data;if(_.isObject(message)){message=message.message;}
if(!_.isString(message)||(_.isString(message)&&!_.contains(AUTHORIZED_MESSAGES,message))){return;}
switch(message){case'report:do_action':return this.do_action(ev.originalEvent.data.action);default:}}},_post_message:function(message){this.iframe.contentWindow.postMessage(message,this.trusted_origin);},on_click_print:function(){var action={'type':'ir.actions.report','report_type':'qweb-pdf','report_name':this.report_name,'report_file':this.report_file,'data':this.data,'context':this.context,'display_name':this.title,};return this.do_action(action);},});core.action_registry.add('report.client_action',ReportAction);return ReportAction;});;

/* /base_import/static/lib/javascript-state-machine/state-machine.js defined in bundle 'web.assets_backend' */
(function(window){StateMachine={VERSION:"2.1.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,ASYNC:4,},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300,},WILDCARD:'*',ASYNC:'async',create:function(cfg,target){var initial=(typeof cfg.initial=='string')?{state:cfg.initial}:cfg.initial;var fsm=target||cfg.target||{};var events=cfg.events||[];var callbacks=cfg.callbacks||{};var map={};var add=function(e){var from=(e.from instanceof Array)?e.from:(e.from?[e.from]:[StateMachine.WILDCARD]);map[e.name]=map[e.name]||{};for(var n=0;n<from.length;n++)
map[e.name][from[n]]=e.to||from[n];};if(initial){initial.event=initial.event||'startup';add({name:initial.event,from:'none',to:initial.state});}
for(var n=0;n<events.length;n++)
add(events[n]);for(var name in map){if(map.hasOwnProperty(name))
fsm[name]=StateMachine.buildEvent(name,map[name]);}
for(var name in callbacks){if(callbacks.hasOwnProperty(name))
fsm[name]=callbacks[name]}
fsm.current='none';fsm.is=function(state){return this.current==state;};fsm.can=function(event){return!this.transition&&(map[event].hasOwnProperty(this.current)||map[event].hasOwnProperty(StateMachine.WILDCARD));}
fsm.cannot=function(event){return!this.can(event);};fsm.error=cfg.error||function(name,from,to,args,error,msg){throw msg;};if(initial&&!initial.defer)
fsm[initial.event]();return fsm;},doCallback:function(fsm,func,name,from,to,args){if(func){try{return func.apply(fsm,[name,from,to].concat(args));}
catch(e){return fsm.error(name,from,to,args,StateMachine.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function");}}},beforeEvent:function(fsm,name,from,to,args){return StateMachine.doCallback(fsm,fsm['onbefore'+name],name,from,to,args);},afterEvent:function(fsm,name,from,to,args){return StateMachine.doCallback(fsm,fsm['onafter'+name]||fsm['on'+name],name,from,to,args);},leaveState:function(fsm,name,from,to,args){return StateMachine.doCallback(fsm,fsm['onleave'+from],name,from,to,args);},enterState:function(fsm,name,from,to,args){return StateMachine.doCallback(fsm,fsm['onenter'+to]||fsm['on'+to],name,from,to,args);},changeState:function(fsm,name,from,to,args){return StateMachine.doCallback(fsm,fsm['onchangestate'],name,from,to,args);},buildEvent:function(name,map){return function(){var from=this.current;var to=map[from]||map[StateMachine.WILDCARD]||from;var args=Array.prototype.slice.call(arguments);if(this.transition)
return this.error(name,from,to,args,StateMachine.Error.PENDING_TRANSITION,"event "+name+" inappropriate because previous transition did not complete");if(this.cannot(name))
return this.error(name,from,to,args,StateMachine.Error.INVALID_TRANSITION,"event "+name+" inappropriate in current state "+this.current);if(false===StateMachine.beforeEvent(this,name,from,to,args))
return StateMachine.CANCELLED;if(from===to){StateMachine.afterEvent(this,name,from,to,args);return StateMachine.NOTRANSITION;}
var fsm=this;this.transition=function(){fsm.transition=null;fsm.current=to;StateMachine.enterState(fsm,name,from,to,args);StateMachine.changeState(fsm,name,from,to,args);StateMachine.afterEvent(fsm,name,from,to,args);};var leave=StateMachine.leaveState(this,name,from,to,args);if(false===leave){this.transition=null;return StateMachine.CANCELLED;}
else if("async"===leave){return StateMachine.ASYNC;}
else{if(this.transition)
this.transition();return StateMachine.SUCCEEDED;}};}};if("function"===typeof define){define("statemachine",[],function(){return StateMachine;});}
else{window.StateMachine=StateMachine;}}(this));;

/* /base_import/static/src/js/import_action.js defined in bundle 'web.assets_backend' */
odoo.define('base_import.import',function(require){"use strict";var AbstractAction=require('web.AbstractAction');var config=require('web.config');var core=require('web.core');var session=require('web.session');var time=require('web.time');var AbstractWebClient=require('web.AbstractWebClient');var Loading=require('web.Loading');var QWeb=core.qweb;var _t=core._t;var _lt=core._lt;var StateMachine=window.StateMachine;function jsonp(form,attributes,callback){attributes=attributes||{};var options={jsonp:_.uniqueId('import_callback_')};window[options.jsonp]=function(){delete window[options.jsonp];callback.apply(null,arguments);};if('data'in attributes){_.extend(attributes.data,options);}else{_.extend(attributes,{data:options});}
_.extend(attributes,{dataType:'script',});$(form).ajaxSubmit(attributes);}
function _make_option(term){return{id:term,text:term};}
function _from_data(data,term){return _.findWhere(data,{id:term})||_make_option(term);}
function dataFilteredQuery(q){var suggestions=_.clone(this.data);if(q.term){var exact=_.filter(suggestions,function(s){return s.id===q.term||s.text===q.term;});if(exact.length){suggestions=exact;}else{suggestions=[_make_option(q.term)].concat(_.filter(suggestions,function(s){return s.id.indexOf(q.term)!==-1||s.text.indexOf(q.term)!==-1}));}}
q.callback({results:suggestions});}
var DataImport=AbstractAction.extend({hasControlPanel:true,contentTemplate:'ImportView',opts:[{name:'encoding',label:_lt("Encoding:"),value:''},{name:'separator',label:_lt("Separator:"),value:''},{name:'quoting',label:_lt("Text Delimiter:"),value:'"'}],spreadsheet_opts:[{name:'sheet',label:_lt("Selected Sheet:"),value:''},],parse_opts_formats:[{name:'date_format',label:_lt("Date Format:"),value:''},{name:'datetime_format',label:_lt("Datetime Format:"),value:''},],parse_opts_separators:[{name:'float_thousand_separator',label:_lt("Thousands Separator:"),value:','},{name:'float_decimal_separator',label:_lt("Decimal Separator:"),value:'.'}],events:{'change .oe_import_file':'loaded_file','change input.oe_import_has_header, .js_import_options input':'settings_changed','change input.oe_import_advanced_mode':function(e){this.do_not_change_match=true;this['settings_changed']();},'click a.oe_import_toggle':function(e){e.preventDefault();this.$('.oe_import_options').toggle();},'click .oe_import_report a.oe_import_report_count':function(e){e.preventDefault();$(e.target).parent().parent().toggleClass('oe_import_report_showmore');},'click .oe_import_report_see_possible_value':function(e){e.preventDefault();$(e.target).parent().toggleClass('oe_import_report_showmore');},'click .oe_import_moreinfo_action a':function(e){e.preventDefault();var action=JSON.parse($(e.target).attr('data-action'));action.views=_(action.views).map(function(view){var id=view[0],type=view[1];return[id,type!=='tree'?type:action.view_type==='form'?'list':'tree'];});this.do_action(_.extend(action,{target:'new',flags:{search_view:true,display_title:true,pager:true,list:{selectable:false}}}));},},init:function(parent,action){this._super.apply(this,arguments);this.action_manager=parent;this.res_model=action.params.model;this.parent_context=action.params.context||{};this.id=null;this.session=session;this._title=_t('Import a File');this.do_not_change_match=false;this.sheets=[];},willStart:function(){var self=this;var def=this._rpc({model:this.res_model,method:'get_import_templates',context:this.parent_context,}).then(function(result){self.importTemplates=result;});return Promise.all([this._super.apply(this,arguments),def]);},start:function(){var self=this;this.$form=this.$('form');this.setup_encoding_picker();this.setup_separator_picker();this.setup_float_format_picker();this.setup_date_format_picker();this.setup_sheets_picker();return Promise.all([this._super(),self.create_model().then(function(id){self.id=id;self.$('input[name=import_id]').val(id);self.renderButtons();var status={cp_content:{$buttons:self.$buttons},};self.updateControlPanel(status);}),]);},create_model:function(){return this._rpc({model:'base_import.import',method:'create',args:[{res_model:this.res_model}],kwargs:{context:session.user_context},});},renderButtons:function(){var self=this;this.$buttons=$(QWeb.render("ImportView.buttons",this));this.$buttons.filter('.o_import_validate').on('click',this.validate.bind(this));this.$buttons.filter('.o_import_import').on('click',this.import.bind(this));this.$buttons.filter('.oe_import_file').on('click',function(){self.$('.o_content .oe_import_file').click();});this.$buttons.filter('.o_import_cancel').on('click',function(e){e.preventDefault();self.exit();});},setup_encoding_picker:function(){this.$('input.oe_import_encoding').select2({width:'50%',data:_.map(('utf-8 utf-16 windows-1252 latin1 latin2 big5 gb18030 shift_jis windows-1251 koir8_r').split(/\s+/),_make_option),query:dataFilteredQuery,initSelection:function($e,c){return c(_make_option($e.val()));}});},setup_separator_picker:function(){var data=[{id:',',text:_t("Comma")},{id:';',text:_t("Semicolon")},{id:'\t',text:_t("Tab")},{id:' ',text:_t("Space")}];this.$('input.oe_import_separator').select2({width:'50%',data:data,query:dataFilteredQuery,initSelection:function($e,c){c(_from_data(data,$e.val())||_make_option($e.val()))}});},setup_float_format_picker:function(){var data_decimal=[{id:',',text:_t("Comma")},{id:'.',text:_t("Dot")},];var data_digits=data_decimal.concat([{id:'',text:_t("No Separator")}]);this.$('input.oe_import_float_thousand_separator').select2({width:'50%',data:data_digits,query:dataFilteredQuery,initSelection:function($e,c){c(_from_data(data_digits,$e.val())||_make_option($e.val()))}});this.$('input.oe_import_float_decimal_separator').select2({width:'50%',data:data_decimal,query:dataFilteredQuery,initSelection:function($e,c){c(_from_data(data_decimal,$e.val())||_make_option($e.val()))}});},setup_date_format_picker:function(){var data=_(['YYYY-MM-DD','DD/MM/YY','DD/MM/YYYY','DD-MM-YYYY','DD-MMM-YY','DD-MMM-YYYY','MM/DD/YY','MM/DD/YYYY','MM-DD-YY','MM-DD-YYYY','DDMMYY','DDMMYYYY','YYMMDD','YYYYMMDD','YY/MM/DD','YYYY/MM/DD','MMDDYY','MMDDYYYY',]).map(_make_option);this.$('input.oe_import_date_format').select2({width:'50%',data:data,query:dataFilteredQuery,initSelection:function($e,c){c(_from_data(data,$e.val())||_make_option($e.val()));}})},setup_sheets_picker:function(){var data=this.sheets.map(_make_option);this.$('input.oe_import_sheet').select2({width:'50%',data:data,query:dataFilteredQuery,initSelection:function($e,c){c(_from_data(data,$e.val())||_make_option($e.val()))},minimumResultsForSearch:10,});},import_options:function(){var self=this;var options={headers:this.$('input.oe_import_has_header').prop('checked'),advanced:this.$('input.oe_import_advanced_mode').prop('checked'),keep_matches:this.do_not_change_match,name_create_enabled_fields:{},skip:Number(this.$('#oe_import_row_start').val())-1||0,limit:Number(this.$('#oe_import_batch_limit').val())||null,};_.each(_.union(this.opts,this.spreadsheet_opts),function(opt){options[opt.name]=self.$('input.oe_import_'+opt.name).val();});_(this.parse_opts_formats).each(function(opt){options[opt.name]=time.moment_to_strftime_format(self.$('input.oe_import_'+opt.name).val());});_(this.parse_opts_separators).each(function(opt){options[opt.name]=self.$('input.oe_import_'+opt.name).val();});options['fields']=[];if(this.do_not_change_match){options['fields']=this.$('.oe_import_fields input.oe_import_match_field').map(function(index,el){return $(el).select2('val')||false;}).get();}
this.do_not_change_match=false;this.$('input.o_import_create_option').each(function(){var field=this.getAttribute('field');if(field){options.name_create_enabled_fields[field]=this.checked;}});return options;},onfile_loaded:function(event,from,to,arg){if(arg!=null){this.toggle_partial(null);}
this.$buttons.filter('.o_import_import, .o_import_validate').addClass('d-none');if(!this.$('input.oe_import_file').val()){return this['settings_changed']();}
this.$('.oe_import_date_format').select2('val','');this.$('.oe_import_datetime_format').val('');this.$('.oe_import_sheet').val('');this.$form.removeClass('oe_import_preview oe_import_error');var import_toggle=false;var file=this.$('input.oe_import_file')[0].files[0];if((file.type&&_.last(file.type.split('/'))==="csv")||(_.last(file.name.split('.'))==="csv")){import_toggle=true;}
this.$form.find('.oe_import_box').toggle(import_toggle);jsonp(this.$form,{url:'/base_import/set_file'},this.proxy('settings_changed'));},onpreviewing:function(){var self=this;this.$buttons.filter('.o_import_import, .o_import_validate').addClass('d-none');this.$form.addClass('oe_import_with_file');this.$form.removeClass('oe_import_preview_error oe_import_error');this.$form.toggleClass('oe_import_noheaders text-muted',!this.$('input.oe_import_has_header').prop('checked'));self.$('input.oe_import_file').val('');this._rpc({model:'base_import.import',method:'parse_preview',args:[this.id,this.import_options()],kwargs:{context:session.user_context},}).then(function(result){var signal=result.error?'preview_failed':'preview_succeeded';self[signal](result);});},onpreview_error:function(event,from,to,result){this.$('.oe_import_options').show();this.$form.addClass('oe_import_preview_error oe_import_error');this.$form.find('.oe_import_box, .oe_import_with_file').removeClass('d-none');this.$form.find('.o_view_nocontent').addClass('d-none');this.$('.oe_import_error_report').html(QWeb.render('ImportView.preview.error',result));},onpreview_success:function(event,from,to,result){var self=this;this.$buttons.filter('.oe_import_file').text(_t('Load New File')).removeClass('btn-primary').addClass('btn-secondary').blur();this.$buttons.filter('.o_import_import, .o_import_validate').removeClass('d-none');this.$form.find('.oe_import_box, .oe_import_with_file').removeClass('d-none');this.$form.find('.o_view_nocontent').addClass('d-none');this.$form.addClass('oe_import_preview');this.$('input.oe_import_advanced_mode').prop('checked',result.advanced_mode);this.$('.oe_import_grid').html(QWeb.render('ImportView.preview',result));this.$('.o_import_batch_alert').toggleClass('d-none',!result.batch);var messages=[];if(result.headers.length===1){messages.push({type:'warning',message:_t("A single column was found in the file, this often means the file separator is incorrect")});}
if(!_.isEmpty(messages)){this.$('.oe_import_options').show();this.onresults(null,null,null,{'messages':messages});}
if(!_.isEqual(this.sheets,result.options.sheets)){this.sheets=result.options.sheets||[];this.setup_sheets_picker();}
this.$('div.oe_import_has_multiple_sheets').toggle(this.sheets.length>1);_.each(['encoding','separator','float_thousand_separator','float_decimal_separator','sheet'],function(id){self.$('.oe_import_'+id).select2('val',result.options[id])});this.$('.oe_import_date_format').select2('val',time.strftime_to_moment_format(result.options.date_format));this.$('.oe_import_datetime_format').val(time.strftime_to_moment_format(result.options.datetime_format));this.$('.oe_import_debug_option').toggleClass('d-none',!result.debug);var $fields=this.$('.oe_import_fields input');this.render_fields_matches(result,$fields);var data=this.generate_fields_completion(result);var item_finder=function(id,items){items=items||data;for(var i=0;i<items.length;++i){var item=items[i];if(item.id===id){return item;}
var val;if(item.children&&(val=item_finder(id,item.children))){return val;}}
return'';};$fields.each(function(k,v){var filtered_data=self.generate_fields_completion(result,k);var $thing=$();var bind=function(d){};if(config.isDebug()){$thing=$(QWeb.render('ImportView.create_record_option')).insertAfter(v).hide();bind=function(data){switch(data.type){case'many2one':case'many2many':$thing.find('input').attr('field',data.id);$thing.show();break;default:$thing.find('input').attr('field','').prop('checked',false);$thing.hide();}}}
$(v).select2({allowClear:true,minimumInputLength:0,data:filtered_data,initSelection:function(element,callback){var default_value=element.val();if(!default_value){callback('');return;}
var data=item_finder(default_value);bind(data);callback(data);},placeholder:_t('Don\'t import'),width:'resolve',dropdownCssClass:'oe_import_selector'}).on('change',function(e){bind(item_finder(e.currentTarget.value));});});},generate_fields_completion:function(root,index){var self=this;var basic=[];var regulars=[];var o2m=[];var headers_type=root.headers_type;function traverse(field,ancestors,collection,type){var subfields=field.fields;var advanced_mode=self.$('input.oe_import_advanced_mode').prop('checked');var field_path=ancestors.concat(field);var label=_(field_path).pluck('string').join(' / ');var id=_(field_path).pluck('name').join('/');if(type===undefined||(type!==undefined&&(type.indexOf('all')!==-1||type.indexOf(field['type'])!==-1))){if(!collection){if(field.name==='id'){collection=basic;}else if(_.isEmpty(subfields)||_.isEqual(_.pluck(subfields,'name'),['id','.id'])){collection=regulars;}else{collection=o2m;}}
collection.push({id:id,text:label,required:field.required,type:field.type});}
if(advanced_mode){for(var i=0,end=subfields.length;i<end;++i){traverse(subfields[i],field_path,collection,type);}}}
_(root.fields).each(function(field){if(index===undefined){traverse(field,[]);}
else{if(self.$('input.oe_import_advanced_mode').prop('checked')){traverse(field,[],undefined,['all']);}
else{traverse(field,[],undefined,headers_type[index]);}}});var cmp=function(field1,field2){return field1.text.localeCompare(field2.text);};regulars.sort(cmp);o2m.sort(cmp);if(!_.isEmpty(regulars)&&!_.isEmpty(o2m)){basic=basic.concat([{text:_t("Normal Fields"),children:regulars},{text:_t("Relation Fields"),children:o2m},]);}
else if(!_.isEmpty(regulars)){basic=basic.concat(regulars);}
else if(!_.isEmpty(o2m)){basic=basic.concat(o2m);}
return basic;},render_fields_matches:function(result,$fields){if(_(result.matches).isEmpty()){return;}
$fields.each(function(index,input){var match=result.matches[index];if(!match){return;}
var current_field=result;input.value=_(match).chain().map(function(name){return current_field=_(current_field.fields).find(function(subfield){return subfield.name===name;});}).pluck('name').value().join('/');});},call_import:function(kwargs){var fields=this.$('.oe_import_fields input.oe_import_match_field').map(function(index,el){return $(el).select2('val')||false;}).get();var columns=this.$('.oe_import_grid-header .oe_import_grid-cell .o_import_header_name').map(function(){return $(this).text().trim().toLowerCase()||false;}).get();var tracking_disable='tracking_disable'in kwargs?kwargs.tracking_disable:!this.$('#oe_import_tracking').prop('checked')
delete kwargs.tracking_disable;kwargs.context=_.extend({},this.parent_context,{tracking_disable:tracking_disable});var self=this;this.trigger_up('with_client',{callback:function(){this.loading.ignore_events=true;}});$.blockUI({message:QWeb.render('Throbber')});$(document.body).addClass('o_ui_blocked');var opts=this.import_options();var $el=$('.oe_throbber_message');var msg=kwargs.dryrun?_t("%d records tested..."):_t("%d records successfully imported...");opts.callback=function(count){$el.text(_.str.sprintf(msg,count));};return this._batchedImport(opts,[this.id,fields,columns],kwargs,{done:0,prev:0}).then(null,function(reason){var error=reason.message;var event=reason.event;if(event){event.preventDefault();}
var msg;var errordata=error.data||{};if(errordata.type==='xhrerror'){var xhr=errordata.objects[0];switch(xhr.status){case 504:msg=_t("Import timed out. Please retry. If you still encounter this issue, the file may be too big for the system's configuration, try to split it (import less records per file).");break;default:msg=_t("An unknown issue occurred during import (possibly lost connection, data limit exceeded or memory limits exceeded). Please retry in case the issue is transient. If the issue still occurs, try to split the file rather than import it at once.");}}else{msg=errordata.arguments&&(errordata.arguments[1]||errordata.arguments[0])||error.message;}
return Promise.resolve({'messages':[{type:'error',record:false,message:msg,}]});}).finally(function(){$(document.body).removeClass('o_ui_blocked');$.unblockUI();self.trigger_up('with_client',{callback:function(){delete this.loading.ignore_events;}});});},_batchedImport:function(opts,args,kwargs,rec){opts.callback&&opts.callback(rec.done||0);var self=this;return this._rpc({model:'base_import.import',method:'do',args:args.concat([opts]),kwargs:kwargs}).then(function(results){_.each(results.messages,offset_by(opts.skip));if(!kwargs.dryrun&&!results.ids){self.$('#oe_import_row_start').val(opts.skip+1);if(opts.skip){results.messages.push({type:'info',priority:true,message:_.str.sprintf(_t("This file has been successfully imported up to line %d."),opts.skip)});}
return results;}
if(!results.nextrow){return results;}
return self._batchedImport(_.defaults({skip:results.nextrow},opts),args,kwargs,{done:rec.done+(results.ids||[]).length,prev:results.nextrow}).then(function(r2){return{name:_.zip(results.name,r2.name).map(function(names){return names[0]||names[1];}),ids:(results.ids||[]).concat(r2.ids||[]),messages:results.messages.concat(r2.messages),skip:r2.skip||results.nextrow,nextrow:r2.nextrow}});});},onvalidate:function(){var prom=this.call_import({dryrun:true,tracking_disable:true});prom.then(this.proxy('validated'));return prom;},onimport:function(){var self=this;var prom=this.call_import({dryrun:false});prom.then(function(results){var message=results.messages;if(!_.any(message,function(message){return message.type==='error';})){self['import_succeeded'](results);return;}
self['import_failed'](results);});return prom;},onimported:function(event,from,to,results){this.do_notify(false,_.str.sprintf(_t("%d records successfully imported"),results.ids.length));this.exit();},exit:function(){this.trigger_up('history_back');},onresults:function(event,from,to,results){var fields=this.$('.oe_import_fields input.oe_import_match_field').map(function(index,el){return $(el).select2('val')||false;}).get();var message=results.messages;var no_messages=_.isEmpty(message);if(no_messages){message.push({type:'info',message:_t("Everything seems valid.")});}else if(event==='import_failed'&&results.ids){this.toggle_partial(results);}
var offset=1;if(this.import_options().headers){offset+=1;}
var messagesSorted=_.sortBy(_(message).groupBy('message'),function(group){if(group[0].priority){return-2;}
var order=0;switch(group[0].type){case'error':order=0;break;case'warning':order=fields.length+1;break;case'info':order=2*(fields.length+1);break;default:order=3*(fields.length+1);break;}
return order+_.indexOf(fields,group[0].field);});this.$form.addClass('oe_import_error');this.$('.oe_import_error_report').html(QWeb.render('ImportView.error',{errors:messagesSorted,at:function(rows){var from=rows.from+offset;var to=rows.to+offset;var rowName='';if(results.name.length>rows.from&&results.name[rows.from]!==''){rowName=_.str.sprintf(' (%s)',results.name[rows.from]);}
if(from===to){return _.str.sprintf(_t("at row %d%s"),from,rowName);}
return _.str.sprintf(_t("between rows %d and %d"),from,to);},at_multi:function(rows){var from=rows.from+offset;var to=rows.to+offset;var rowName='';if(results.name.length>rows.from&&results.name[rows.from]!==''){rowName=_.str.sprintf(' (%s)',results.name[rows.from]);}
if(from===to){return _.str.sprintf(_t("Row %d%s"),from,rowName);}
return _.str.sprintf(_t("Between rows %d and %d"),from,to);},at_multi_header:function(numberLines){return _.str.sprintf(_t("at %d different rows:"),numberLines);},more:function(n){return _.str.sprintf(_t("(%d more)"),n);},info:function(msg){if(typeof msg==='string'){return _.str.sprintf('<div class="oe_import_moreinfo oe_import_moreinfo_message">%s</div>',_.str.escapeHTML(msg));}
if(msg instanceof Array){return _.str.sprintf('<div class="oe_import_moreinfo oe_import_moreinfo_choices"><a href="#" class="oe_import_report_see_possible_value oe_import_see_all"><i class="fa fa-arrow-right"/> %s </a><ul class="oe_import_report_more">%s</ul></div>',_.str.escapeHTML(_t("See possible values")),_(msg).map(function(msg){return'<li>'
+_.str.escapeHTML(msg)
+'</li>';}).join(''));}
return['<div class="oe_import_moreinfo oe_import_moreinfo_action">',_.str.sprintf('<a href="#" data-action="%s" class="oe_import_see_all"><i class="fa fa-arrow-right"/> ',_.str.escapeHTML(JSON.stringify(msg))),_.str.escapeHTML(_t("See possible values")),'</a>','</div>'].join('');},}));},toggle_partial:function(result){var $form=this.$('.oe_import');var $partial_warning=this.$('.o_import_partial_alert');var $partial_count=this.$('.o_import_partial_count');if(result==null){$partial_warning.addClass('d-none');$form.add(this.$buttons).removeClass('o_import_partial_mode');var $skip=this.$('#oe_import_row_start');$skip.val($skip.attr('value'));$partial_count.text('');return;}
this.$('.o_import_batch_alert').addClass('d-none');$partial_warning.removeClass('d-none');$form.add(this.$buttons).addClass('o_import_partial_mode');$partial_count.text((result.skip||0)+1);}});core.action_registry.add('import',DataImport);StateMachine.create({target:DataImport.prototype,events:[{name:'loaded_file',from:['none','file_loaded','preview_error','preview_success','results'],to:'file_loaded'},{name:'settings_changed',from:['file_loaded','preview_error','preview_success','results'],to:'previewing'},{name:'preview_failed',from:'previewing',to:'preview_error'},{name:'preview_succeeded',from:'previewing',to:'preview_success'},{name:'validate',from:'preview_success',to:'validating'},{name:'validate',from:'results',to:'validating'},{name:'validated',from:'validating',to:'results'},{name:'import',from:['preview_success','results'],to:'importing'},{name:'import_succeeded',from:'importing',to:'imported'},{name:'import_failed',from:'importing',to:'results'}],});Loading.include({on_rpc_event:function(){if(this.ignore_events){return}
this._super.apply(this,arguments);}});AbstractWebClient.prototype.custom_events['with_client']=function(ev){ev.data.callback.call(this);};function offset_by(by){return function offset_message(msg){if(msg.rows){msg.rows.from+=by;msg.rows.to+=by;}}}
return{DataImport:DataImport,};});;

/* /base_import/static/src/js/import_menu.js defined in bundle 'web.assets_backend' */
odoo.define('base_import.ImportMenu',function(require){"use strict";const DropdownMenuItem=require('web.DropdownMenuItem');const FavoriteMenu=require('web.FavoriteMenu');const{useModel}=require('web/static/src/js/model.js');class ImportMenu extends DropdownMenuItem{constructor(){super(...arguments);this.model=useModel('searchModel');}
_onImportClick(){const action={type:'ir.actions.client',tag:'import',params:{model:this.model.config.modelName,context:this.model.config.context,}};this.trigger('do-action',{action:action});}
static shouldBeDisplayed(env){return env.view&&['kanban','list'].includes(env.view.type)&&!env.device.isMobile&&!!JSON.parse(env.view.arch.attrs.import||'1')&&!!JSON.parse(env.view.arch.attrs.create||'1');}}
ImportMenu.props={};ImportMenu.template='base_import.ImportMenu';FavoriteMenu.registry.add('import-menu',ImportMenu,1);return ImportMenu;});;

/* /web_editor/static/src/js/frontend/loader.js defined in bundle 'web.assets_backend' */
odoo.define('web_editor.loader',function(require){'use strict';var Wysiwyg=require('web_editor.wysiwyg.root');function load(parent,textarea,options){var loading=textarea.nextElementSibling;if(loading&&!loading.classList.contains('o_wysiwyg_loading')){loading=null;}
if(!textarea.value.match(/\S/)){textarea.value='<p><br/></p>';}
var wysiwyg=new Wysiwyg(parent,options);return wysiwyg.attachTo(textarea).then(()=>{if(loading){loading.parentNode.removeChild(loading);}
return wysiwyg;});}
return{load:load,};});;

/* /web_editor/static/src/js/backend/field_html.js defined in bundle 'web.assets_backend' */
odoo.define('web_editor.field.html',function(require){'use strict';var ajax=require('web.ajax');var basic_fields=require('web.basic_fields');var config=require('web.config');var core=require('web.core');var Wysiwyg=require('web_editor.wysiwyg.root');var field_registry=require('web.field_registry');require('web._field_registry');var _lt=core._lt;var TranslatableFieldMixin=basic_fields.TranslatableFieldMixin;var QWeb=core.qweb;var assetsLoaded;var jinjaRegex=/(^|\n)\s*%\s(end|set\s)/;var FieldHtml=basic_fields.DebouncedField.extend(TranslatableFieldMixin,{description:_lt("Html"),className:'oe_form_field oe_form_field_html',supportedFieldTypes:['html'],custom_events:{wysiwyg_focus:'_onWysiwygFocus',wysiwyg_blur:'_onWysiwygBlur',wysiwyg_change:'_onChange',wysiwyg_attachment:'_onAttachmentChange',},willStart:function(){var self=this;this.isRendered=false;this._onUpdateIframeId='onLoad_'+_.uniqueId('FieldHtml');var defAsset;if(this.nodeOptions.cssReadonly){defAsset=ajax.loadAsset(this.nodeOptions.cssReadonly);}
if(!assetsLoaded){assetsLoaded=new Promise(function(resolve){var wysiwyg=new Wysiwyg(self,{});wysiwyg.attachTo($('<textarea>')).then(function(){wysiwyg.destroy();resolve();});});}
return Promise.all([this._super(),assetsLoaded,defAsset]);},destroy:function(){delete window.top[this._onUpdateIframeId];if(this.$iframe){this.$iframe.remove();}
this._super();},activate:function(options){if(this.wysiwyg){this.wysiwyg.focus();return true;}},commitChanges:function(){var self=this;if(config.isDebug()&&this.mode==='edit'){var layoutInfo=$.summernote.core.dom.makeLayoutInfo(this.wysiwyg.$editor);$.summernote.pluginEvents.codeview(undefined,undefined,layoutInfo,false);}
if(this.mode=="readonly"||!this.isRendered){return this._super();}
var _super=this._super.bind(this);return this.wysiwyg.saveModifiedImages(this.$content).then(function(){return self.wysiwyg.save(self.nodeOptions).then(function(result){self._isDirty=result.isDirty;_super();});});},isSet:function(){var value=this.value&&this.value.split('&nbsp;').join('').replace(/\s/g,'');return value&&value!=="<p></p>"&&value!=="<p><br></p>"&&value.match(/\S/);},getFocusableElement:function(){return this.$target||$();},reset:function(record,event){this._reset(record,event);var value=this.value;if(this.nodeOptions.wrapper){value=this._wrap(value);}
value=this._textToHtml(value);if(!event||event.target!==this){if(this.mode==='edit'){this.wysiwyg.setValue(value);}else{this.$content.html(value);}}
return Promise.resolve();},_getValue:function(){var value=this.$target.val();if(this.nodeOptions.wrapper){return this._unWrap(value);}
return value;},_createWysiwygIntance:function(){var self=this;this.wysiwyg=new Wysiwyg(this,this._getWysiwygOptions());this.wysiwyg.__extraAssetsForIframe=this.__extraAssetsForIframe||[];return this.wysiwyg.attachTo(this.$target).then(function(){self.$content=self.wysiwyg.$editor.closest('body, odoo-wysiwyg-container');self._onLoadWysiwyg();self.isRendered=true;});},_getWysiwygOptions:function(){var self=this;return Object.assign({},this.nodeOptions,{recordInfo:{context:this.record.getContext(this.recordParams),res_model:this.model,res_id:this.res_id,},noAttachment:this.nodeOptions['no-attachment'],inIframe:!!this.nodeOptions.cssEdit,iframeCssAssets:this.nodeOptions.cssEdit,snippets:this.nodeOptions.snippets,tabsize:0,height:180,generateOptions:function(options){var toolbar=options.toolbar||options.airPopover||{};var para=_.find(toolbar,function(item){return item[0]==='para';});if(para&&para[1]&&para[1].indexOf('checklist')===-1){para[1].splice(2,0,'checklist');}
if(config.isDebug()){options.codeview=true;var view=_.find(toolbar,function(item){return item[0]==='view';});if(view){if(!view[1].includes('codeview')){view[1].splice(-1,0,'codeview');}}else{toolbar.splice(-1,0,['view',['codeview']]);}}
if(self.model==="mail.compose.message"||self.model==="mailing.mailing"){options.noVideos=true;}
options.prettifyHtml=false;return options;},});},_onAttachmentChange:function(attachments){if(!this.fieldNameAttachment){return;}
this.trigger_up('field_changed',{dataPointID:this.dataPointID,changes:_.object([this.fieldNameAttachment],[{operation:'ADD_M2M',ids:attachments}])});},_renderEdit:function(){var value=this._textToHtml(this.value);if(this.nodeOptions.wrapper){value=this._wrap(value);}
this.$target=$('<textarea>').val(value).hide();this.$target.appendTo(this.$el);var fieldNameAttachment=_.chain(this.recordData).pairs().find(function(value){return _.isObject(value[1])&&value[1].model==="ir.attachment";}).first().value();if(fieldNameAttachment){this.fieldNameAttachment=fieldNameAttachment;}
if(this.nodeOptions.cssEdit){this._createWysiwygIntance();}else{return this._createWysiwygIntance();}},_renderReadonly:function(){var self=this;var value=this._textToHtml(this.value);if(this.nodeOptions.wrapper){value=this._wrap(value);}
this.$el.empty();var resolver;var def=new Promise(function(resolve){resolver=resolve;});if(this.nodeOptions.cssReadonly){this.$iframe=$('<iframe class="o_readonly"/>');this.$iframe.appendTo(this.$el);var avoidDoubleLoad=0;this.$iframe.data('loadDef',def);window.top[this._onUpdateIframeId]=function(_avoidDoubleLoad){if(_avoidDoubleLoad!==avoidDoubleLoad){console.warn('Wysiwyg iframe double load detected');return;}
self.$content=$('#iframe_target',self.$iframe[0].contentWindow.document.body);resolver();};this.$iframe.on('load',function onLoad(){var _avoidDoubleLoad=++avoidDoubleLoad;ajax.loadAsset(self.nodeOptions.cssReadonly).then(function(asset){if(_avoidDoubleLoad!==avoidDoubleLoad){console.warn('Wysiwyg immediate iframe double load detected');return;}
var cwindow=self.$iframe[0].contentWindow;try{cwindow.document;}catch(e){return;}
cwindow.document.open("text/html","replace").write('<head>'+'<meta charset="utf-8"/>'+'<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>\n'+'<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>\n'+
_.map(asset.cssLibs,function(cssLib){return'<link type="text/css" rel="stylesheet" href="'+cssLib+'"/>';}).join('\n')+'\n'+
_.map(asset.cssContents,function(cssContent){return'<style type="text/css">'+cssContent+'</style>';}).join('\n')+'\n'+'</head>\n'+'<body class="o_in_iframe o_readonly">\n'+'<div id="iframe_target">'+value+'</div>\n'+'<script type="text/javascript">'+'if (window.top.'+self._onUpdateIframeId+') {'+'window.top.'+self._onUpdateIframeId+'('+_avoidDoubleLoad+')'+'}'+'</script>\n'+'</body>');var height=cwindow.document.body.scrollHeight;self.$iframe.css('height',Math.max(30,Math.min(height,500))+'px');});});}else{this.$content=$('<div class="o_readonly"/>').html(value);this.$content.appendTo(this.$el);resolver();}
def.then(function(){self.$content.on('click','ul.o_checklist > li',self._onReadonlyClickChecklist.bind(self));});},_textToHtml:function(text){var value=text||"";if(jinjaRegex.test(value)){return value;}
try{$(text)[0].innerHTML;}catch(e){if(value.match(/^\s*$/)){value='<p><br/></p>';}else{value="<p>"+value.split(/<br\/?>/).join("<br/></p><p>")+"</p>";value=value.replace(/<p><\/p>/g,'').replace('<p><p>','<p>').replace('<p><p ','<p ').replace('</p></p>','</p>');}}
return value;},_unWrap:function(html){var $wrapper=$(html).find('#wrapper');return $wrapper.length?$wrapper.html():html;},_wrap:function(html){return $(QWeb.render(this.nodeOptions.wrapper)).find('#wrapper').html(html).end().prop('outerHTML');},_onChange:function(ev){this._doDebouncedAction.apply(this,arguments);var $lis=this.$content.find('.note-editable ul.o_checklist > li:not(:has(> ul.o_checklist))');if(!$lis.length){return;}
var max=0;var ids=[];$lis.map(function(){var checklistId=parseInt(($(this).attr('id')||'0').replace(/^checklist-id-/,''));if(ids.indexOf(checklistId)===-1){if(checklistId>max){max=checklistId;}
ids.push(checklistId);}else{$(this).removeAttr('id');}});$lis.not('[id]').each(function(){$(this).attr('id','checklist-id-'+(++max));});},_onKeydown:function(ev){if(ev.which===$.ui.keyCode.ENTER){ev.stopPropagation();return;}
this._super.apply(this,arguments);},_onReadonlyClickChecklist:function(ev){var self=this;if(ev.offsetX>0){return;}
ev.stopPropagation();ev.preventDefault();var checked=$(ev.target).hasClass('o_checked');var checklistId=parseInt(($(ev.target).attr('id')||'0').replace(/^checklist-id-/,''));this._rpc({route:'/web_editor/checklist',params:{res_model:this.model,res_id:this.res_id,filename:this.name,checklistId:checklistId,checked:!checked,},}).then(function(value){self._setValue(value);});},_onLoadWysiwyg:function(){var $button=this._renderTranslateButton();$button.css({'font-size':'15px',position:'absolute',right:'+5px',top:'+5px',});this.$el.append($button);},_onWysiwygBlur:function(ev){ev.stopPropagation();this._doAction();if(ev.data.key==='TAB'){this.trigger_up('navigation_move',{direction:ev.data.shiftKey?'left':'right',});}},_onWysiwygFocus:function(ev){},});field_registry.add('html',FieldHtml);return FieldHtml;});;

/* /web_editor/static/src/js/backend/convert_inline.js defined in bundle 'web.assets_backend' */
odoo.define('web_editor.convertInline',function(require){'use strict';var FieldHtml=require('web_editor.field.html');function getMatchedCSSRules(a){var i,r,k;var doc=a.ownerDocument;var rulesCache=a.ownerDocument._rulesCache||(a.ownerDocument._rulesCache=[]);if(!rulesCache.length){var sheets=doc.styleSheets;for(i=sheets.length-1;i>=0;i--){var rules;try{rules=sheets[i].rules||sheets[i].cssRules;}catch(e){console.warn("Can't read the css rules of: "+sheets[i].href,e);continue;}
if(rules){for(r=rules.length-1;r>=0;r--){var selectorText=rules[r].selectorText;if(selectorText&&rules[r].cssText&&selectorText!=='*'&&selectorText.indexOf(':hover')===-1&&selectorText.indexOf(':before')===-1&&selectorText.indexOf(':after')===-1&&selectorText.indexOf(':active')===-1&&selectorText.indexOf(':link')===-1&&selectorText.indexOf('::')===-1&&selectorText.indexOf("'")===-1){var st=selectorText.split(/\s*,\s*/);for(k=0;k<st.length;k++){rulesCache.push({'selector':st[k],'style':rules[r].style});}}}}}
rulesCache.reverse();}
var css=[];var style;a.matches=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;for(r=0;r<rulesCache.length;r++){if(a.matches(rulesCache[r].selector)){style=rulesCache[r].style;if(style.parentRule){var style_obj={};var len;for(k=0,len=style.length;k<len;k++){if(style[k].indexOf('animation')!==-1){continue;}
style_obj[style[k]]=style[style[k].replace(/-(.)/g,function(a,b){return b.toUpperCase();})];if(new RegExp(style[k]+'\s*:[^:;]+!important').test(style.cssText)){style_obj[style[k]]+=' !important';}}
rulesCache[r].style=style=style_obj;}
css.push([rulesCache[r].selector,style]);}}
function specificity(selector){var a=0;selector=selector.replace(/#[a-z0-9_-]+/gi,function(){a++;return'';});var b=0;selector=selector.replace(/(\.[a-z0-9_-]+)|(\[.*?\])/gi,function(){b++;return'';});var c=0;selector=selector.replace(/(^|\s+|:+)[a-z0-9_-]+/gi,function(a){if(a.indexOf(':not(')===-1)c++;return'';});return a*100+b*10+c;}
css.sort(function(a,b){return specificity(a[0])-specificity(b[0]);});style={};_.each(css,function(v,k){_.each(v[1],function(v,k){if(v&&_.isString(v)&&k.indexOf('-webkit')===-1&&(!style[k]||style[k].indexOf('important')===-1||v.indexOf('important')!==-1)){style[k]=v;}});});_.each(style,function(v,k){if(v.indexOf('important')!==-1){style[k]=v.slice(0,v.length-11);}});if(style.display==='block'){delete style.display;}
_.each([{property:'margin'},{property:'padding'},{property:'border',propertyEnd:'-style',defaultValue:'none'},],function(propertyInfo){var p=propertyInfo.property;var e=propertyInfo.propertyEnd||'';var defVal=propertyInfo.defaultValue||0;if(style[p+'-top'+e]||style[p+'-right'+e]||style[p+'-bottom'+e]||style[p+'-left'+e]){if(style[p+'-top'+e]===style[p+'-right'+e]&&style[p+'-top'+e]===style[p+'-bottom'+e]&&style[p+'-top'+e]===style[p+'-left'+e]){style[p+e]=style[p+'-top'+e];}
else{style[p+e]=(style[p+'-top'+e]||defVal)+' '+(style[p+'-right'+e]||defVal)+' '+(style[p+'-bottom'+e]||defVal)+' '+(style[p+'-left'+e]||defVal);if(style[p+e].indexOf('inherit')!==-1||style[p+e].indexOf('initial')!==-1){delete style[p+e];return;}}
delete style[p+'-top'+e];delete style[p+'-right'+e];delete style[p+'-bottom'+e];delete style[p+'-left'+e];}});if(style['border-bottom-left-radius']){style['border-radius']=style['border-bottom-left-radius'];delete style['border-bottom-left-radius'];delete style['border-bottom-right-radius'];delete style['border-top-left-radius'];delete style['border-top-right-radius'];}
_.each(_.keys(style),function(k){if(k.indexOf('border')!==-1&&style[k]==='initial'){delete style[k];}});if(style['text-decoration-line']){style['text-decoration']=style['text-decoration-line'];delete style['text-decoration-line'];delete style['text-decoration-color'];delete style['text-decoration-style'];delete style['text-decoration-thickness'];}
if(style['text-align']==='inherit'){var $el=$(a).parent();do{var align=$el.css('text-align');if(_.indexOf(['left','right','center','justify'],align)>=0){style['text-align']=align;break;}
$el=$el.parent();}while($el.length&&!$el.is('html'));}
return style;}
function fontToImg($editable){var fonts=odoo.__DEBUG__.services["wysiwyg.fonts"];$editable.find('.fa').each(function(){var $font=$(this);var icon,content;_.find(fonts.fontIcons,function(font){return _.find(fonts.getCssSelectors(font.parser),function(data){if($font.is(data.selector.replace(/::?before/g,''))){icon=data.names[0].split('-').shift();content=data.css.match(/content:\s*['"]?(.)['"]?/)[1];return true;}});});if(content){var color=$font.css('color').replace(/\s/g,'');$font.replaceWith($('<img/>',{src:_.str.sprintf('/web_editor/font_to_img/%s/%s/%s',content.charCodeAt(0),window.encodeURI(color),Math.max(1,Math.round($font.height()))),'data-class':$font.attr('class'),'data-style':$font.attr('style'),class:$font.attr('class').replace(new RegExp('(^|\\s+)'+icon+'(-[^\\s]+)?','gi'),''),style:$font.attr('style'),}).css({height:'auto',width:'auto'}));}else{$font.remove();}});}
function imgToFont($editable){$editable.find('img[src*="/web_editor/font_to_img/"]').each(function(){var $img=$(this);$img.replaceWith($('<span/>',{class:$img.data('class'),style:$img.data('style')}));});}
function applyOverDescendants(node,func){node=node.firstChild;while(node){if(node.nodeType===1){func(node);applyOverDescendants(node,func);}
var $node=$(node);if(node.nodeName==='A'&&$node.hasClass('btn')&&!$node.children().length&&$(node).parents('.o_outlook_hack').length){node=$(node).parents('.o_outlook_hack')[0];}
else if(node.nodeName==='IMG'&&$node.parent('p').hasClass('o_outlook_hack')){node=$node.parent()[0];}
node=node.nextSibling;}}
function classToStyle($editable){applyOverDescendants($editable[0],function(node){var $target=$(node);var css=getMatchedCSSRules(node);var style=$target.attr('style')||'';_.each(css,function(v,k){if(!(new RegExp('(^|;)\s*'+k).test(style))){style=k+':'+v+';'+style;}});if(_.isEmpty(style)){$target.removeAttr('style');}else{$target.attr('style',style);}
if(node.nodeName==='TD'&&!node.childNodes.length){node.innerHTML='&nbsp;';}
if(node.nodeName==='A'&&$target.hasClass('btn')&&!$target.hasClass('btn-link')&&!$target.children().length){var $hack=$('<table class="o_outlook_hack" style="display: inline-table;vertical-align:middle"><tr><td></td></tr></table>');$hack.find('td').attr('height',$target.outerHeight()).css({'text-align':$target.parent().css('text-align'),'margin':$target.css('padding'),'border-radius':$target.css('border-radius'),'background-color':$target.css('background-color'),});$target.after($hack);$target.appendTo($hack.find('td'));node=$hack[0].previousSibling;if(node&&node.nodeType===Node.TEXT_NODE&&!node.textContent.match(/\S/)){$(node).remove();}
node=$hack[0].nextSibling;if(node&&node.nodeType===Node.TEXT_NODE&&!node.textContent.match(/\S/)){$(node).remove();}}
else if(node.nodeName==='IMG'&&$target.is('.mx-auto.d-block')){$target.wrap('<p class="o_outlook_hack" style="text-align:center;margin:0"/>');}});}
function styleToClass($editable){$editable.find('.o_outlook_hack').each(function(){$(this).after($('a,img',this));}).remove();var $c=$('<span/>').appendTo($editable[0].ownerDocument.body);applyOverDescendants($editable[0],function(node){var $target=$(node);var css=getMatchedCSSRules(node);var style='';_.each(css,function(v,k){if(!(new RegExp('(^|;)\s*'+k).test(style))){style=k+':'+v+';'+style;}});css=($c.attr('style',style).attr('style')||'').split(/\s*;\s*/);style=($target.attr('style')||'').replace(/\s*:\s*/,':').replace(/\s*;\s*/,';');_.each(css,function(v){style=style.replace(v,'');});style=style.replace(/;+(\s;)*/g,';').replace(/^;/g,'');if(style!==''){$target.attr('style',style);}else{$target.removeAttr('style');}});$c.remove();}
function attachmentThumbnailToLinkImg($editable){$editable.find('a[href*="/web/content/"][data-mimetype]').filter(':empty, :containsExact( )').each(function(){var $link=$(this);var $img=$('<img/>').attr('src',$link.css('background-image').replace(/(^url\(['"])|(['"]\)$)/g,'')).css('height',Math.max(1,$link.height())+'px').css('width',Math.max(1,$link.width())+'px');$link.prepend($img);});}
function linkImgToAttachmentThumbnail($editable){$editable.find('a[href*="/web/content/"][data-mimetype] > img').remove();}
FieldHtml.include({commitChanges:function(){if(this.nodeOptions['style-inline']&&this.mode==="edit"){this._toInline();}
return this._super();},_toInline:function(){var $editable=this.wysiwyg.getEditable();var html=this.wysiwyg.getValue({'style-inline':true});$editable.html(html);attachmentThumbnailToLinkImg($editable);fontToImg($editable);classToStyle($editable);_.each(['width','height'],function(attribute){$editable.find('img[style*="width"], img[style*="height"]').attr(attribute,function(){return $(this)[attribute]();}).css(attribute,function(){return $(this).get(0).style[attribute]||'auto';});});this.wysiwyg.setValue($editable.html(),{notifyChange:false,});},_fromInline:function(){var $editable=this.wysiwyg.getEditable();var html=this.wysiwyg.getValue();$editable.html(html);styleToClass($editable);imgToFont($editable);linkImgToAttachmentThumbnail($editable);$editable.find('img[style*="width"], img[style*="height"]').removeAttr('height width');this.wysiwyg.setValue($editable.html(),{notifyChange:false,});},_onLoadWysiwyg:function(){if(this.nodeOptions['style-inline']&&this.mode==="edit"){this._fromInline();}
this._super();},});return{fontToImg:fontToImg,imgToFont:imgToFont,classToStyle:classToStyle,styleToClass:styleToClass,attachmentThumbnailToLinkImg:attachmentThumbnailToLinkImg,linkImgToAttachmentThumbnail:linkImgToAttachmentThumbnail,};});;

/* /web_kanban_gauge/static/src/js/kanban_gauge.js defined in bundle 'web.assets_backend' */
odoo.define('web_kanban_gauge.widget',function(require){"use strict";var AbstractField=require('web.AbstractField');var core=require('web.core');var field_registry=require('web.field_registry');var utils=require('web.utils');var _t=core._t;var GaugeWidget=AbstractField.extend({className:"oe_gauge",jsLibs:['/web/static/lib/Chart/Chart.js',],_render:function(){var val=this.value;if(_.isArray(JSON.parse(val))){val=JSON.parse(val);}
var gauge_value=_.isArray(val)&&val.length?val[val.length-1].value:val;if(this.nodeOptions.gauge_value_field){gauge_value=this.recordData[this.nodeOptions.gauge_value_field];}
var max_value=this.nodeOptions.max_value||100;if(this.nodeOptions.max_field){max_value=this.recordData[this.nodeOptions.max_field];}
max_value=Math.max(gauge_value,max_value);var label=this.nodeOptions.label||"";if(this.nodeOptions.label_field){label=this.recordData[this.nodeOptions.label_field];}
var title=this.nodeOptions.title||this.field.string;var maxLabel=max_value;if(gauge_value===0&&max_value===0){max_value=1;maxLabel=0;}
var config={type:'doughnut',data:{datasets:[{data:[gauge_value,max_value-gauge_value],backgroundColor:["#1f77b4","#dddddd"],label:title}],},options:{circumference:Math.PI,rotation:-Math.PI,responsive:true,tooltips:{displayColors:false,callbacks:{label:function(tooltipItems){if(tooltipItems.index===0){return _t('Value: ')+gauge_value;}
return _t('Max: ')+maxLabel;},},},title:{display:true,text:title,padding:4,},layout:{padding:{bottom:5}},maintainAspectRatio:false,cutoutPercentage:70,}};this.$canvas=$('<canvas/>');this.$el.empty();this.$el.append(this.$canvas);this.$el.attr('style',this.nodeOptions.style);this.$el.css({position:'relative'});var context=this.$canvas[0].getContext('2d');this.chart=new Chart(context,config);var humanValue=utils.human_number(gauge_value,1);var $value=$('<span class="o_gauge_value">').text(humanValue);$value.css({'text-align':'center',position:'absolute',left:0,right:0,bottom:'6px','font-weight':'bold'});this.$el.append($value);},});field_registry.add("gauge",GaugeWidget);return GaugeWidget;});;

/* /web_tour/static/src/js/debug_manager.js defined in bundle 'web.assets_backend' */
odoo.define('web_tour.DebugManager.Backend',function(require){"use strict";var core=require("web.core");var DebugManager=require('web.DebugManager.Backend');var Dialog=require("web.Dialog");var local_storage=require('web.local_storage');var tour=require('web_tour.tour');var utils=require('web_tour.utils');var get_debugging_key=utils.get_debugging_key;function get_active_tours(){return _.difference(_.keys(tour.tours),tour.consumed_tours);}
DebugManager.include({start:function(){this.consume_tours_enabled=get_active_tours().length>0;return this._super.apply(this,arguments);},consume_tours:function(){var active_tours=get_active_tours();if(active_tours.length>0){this._rpc({model:'web_tour.tour',method:'consume',args:[active_tours],}).then(function(){for(const tourName of active_tours){local_storage.removeItem(get_debugging_key(tourName));}
window.location.reload();});}},start_tour:async function(){const tours=Object.values(tour.tours).sort((t1,t2)=>{return(t1.sequence-t2.sequence)||(t1.name<t2.name?-1:1);});const dialog=new Dialog(this,{title:'Tours',$content:core.qweb.render('web_tour.ToursDialog',{onboardingTours:tours.filter(t=>!t.test),testingTours:tours.filter(t=>t.test),}),});await dialog.open().opened();dialog.$('.o_start_tour').on('click',this._onStartTour.bind(this));dialog.$('.o_test_tour').on('click',this._onTestTour.bind(this));},_onStartTour(ev){ev.preventDefault();tour.reset($(ev.target).data('name'));},_onTestTour(ev){ev.preventDefault();tour.run($(ev.target).data('name'));},});});;

/* /base_setup/static/src/js/res_config_dev_tool.js defined in bundle 'web.assets_backend' */
odoo.define('base_setup.ResConfigDevTool',function(require){"use strict";var config=require('web.config');var Widget=require('web.Widget');var widget_registry=require('web.widget_registry');var ResConfigDevTool=Widget.extend({template:'res_config_dev_tool',events:{'click .o_web_settings_force_demo':'_onClickForceDemo',},init:function(){this._super.apply(this,arguments);this.isDebug=config.isDebug();this.isAssets=config.isDebug("assets");this.isTests=config.isDebug("tests");},willStart:function(){var self=this;return this._super.apply(this,arguments).then(function(){return self._rpc({route:'/base_setup/demo_active',}).then(function(demo_active){self.demo_active=demo_active;});});},_onClickForceDemo:function(ev){ev.preventDefault();this.do_action('base.demo_force_install_action');},});widget_registry.add('res_config_dev_tool',ResConfigDevTool);});;

/* /base_setup/static/src/js/res_config_edition.js defined in bundle 'web.assets_backend' */
odoo.define('base_setup.ResConfigEdition',function(require){"use strict";var Widget=require('web.Widget');var widget_registry=require('web.widget_registry');var session=require('web.session');var ResConfigEdition=Widget.extend({template:'res_config_edition',init:function(){this._super.apply(this,arguments);this.server_version=session.server_version;this.expiration_date=session.expiration_date?moment(session.expiration_date):moment().add(30,'d');},});widget_registry.add('res_config_edition',ResConfigEdition);return ResConfigEdition;});;

/* /base_setup/static/src/js/res_config_invite_users.js defined in bundle 'web.assets_backend' */
odoo.define('base_setup.ResConfigInviteUsers',function(require){"use strict";var Widget=require('web.Widget');var widget_registry=require('web.widget_registry');var core=require('web.core');var _t=core._t;var ResConfigInviteUsers=Widget.extend({template:'res_config_invite_users',events:{'click .o_web_settings_invite':'_onClickInvite','click .o_web_settings_user':'_onClickUser','click .o_web_settings_more':'_onClickMore','keydown .o_user_emails':'_onKeydownUserEmails',},init:function(){this._super.apply(this,arguments);this.emails=[];},willStart:function(){var self=this;return this._super.apply(this,arguments).then(function(){return self.load();});},load:function(){var self=this;return this._rpc({route:'/base_setup/data',}).then(function(data){self.active_users=data.active_users;self.pending_users=data.pending_users;self.pending_count=data.pending_count;self.resend_invitation=data.resend_invitation||false;});},_validateEmail:function(email){var re=/^([a-z0-9][-a-z0-9_\+\.]*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,63}(?:\.[a-z]{2})?)$/i;return re.test(email);},_invite:function(){var self=this;var $userEmails=this.$('.o_user_emails');$userEmails.prop('disabled',true);this.$('.o_web_settings_invite').prop('disabled',true);var value=$userEmails.val().trim();if(value){var emails=_.uniq(value.split(/[ ,;\n]+/));var invalidEmails=_.reject(emails,this._validateEmail);if(invalidEmails.length){this.do_warn(false,_.str.sprintf(_t('Invalid email addresses: %s.'),invalidEmails.join(', ')));}
emails=_.difference(emails,invalidEmails);if(!this.resend_invitation){var pendingEmails=_.map(this.pending_users,function(info){return info[1];});var existingEmails=_.intersection(emails,this.emails.concat(pendingEmails));if(existingEmails.length){this.do_warn(false,_.str.sprintf(_t('Email addresses already existing: %s.'),existingEmails.join(', ')));}
emails=_.difference(emails,existingEmails);}
if(emails.length){$userEmails.val('');this._rpc({model:'res.users',method:'web_create_users',args:[emails],}).then(function(){return self.load().then(function(){self.renderElement();self.$('.o_user_emails').focus();});});}else{$userEmails.prop('disabled',false);this.$('.o_web_settings_invite').prop('disabled',false);self.$('.o_user_emails').focus();}}},_onClickInvite:function(ev){if(this.$('.o_user_emails').val().length){var $button=$(ev.target);$button.button('loading');return this._invite();}},_onClickMore:function(ev){var self=this;ev.preventDefault();this._rpc({model:'ir.model.data',method:'xmlid_to_res_model_res_id',args:["base.view_users_form"],}).then(function(data){self.do_action({name:_t('Users'),type:'ir.actions.act_window',view_mode:'tree,form',res_model:'res.users',domain:[['log_ids','=',false]],context:{search_default_no_share:true,},views:[[false,'list'],[data[1],'form']],});});},_onClickUser:function(ev){var self=this;ev.preventDefault();var user_id=$(ev.currentTarget).data('user-id');this._rpc({model:'ir.model.data',method:'xmlid_to_res_model_res_id',args:["base.view_users_form"],}).then(function(data){self.do_action({type:'ir.actions.act_window',res_model:'res.users',view_mode:'form',res_id:user_id,views:[[data[1],'form']],});});},_onKeydownUserEmails:function(ev){var keyCodes=[$.ui.keyCode.TAB,$.ui.keyCode.COMMA,$.ui.keyCode.ENTER];if(_.contains(keyCodes,ev.which)){ev.preventDefault();this._invite();}},});widget_registry.add('res_config_invite_users',ResConfigInviteUsers);});;

/* /bus/static/src/js/longpolling_bus.js defined in bundle 'web.assets_backend' */
odoo.define('bus.Longpolling',function(require){"use strict";var Bus=require('web.Bus');var ServicesMixin=require('web.ServicesMixin');var LongpollingBus=Bus.extend(ServicesMixin,{PARTNERS_PRESENCE_CHECK_PERIOD:30000,ERROR_RETRY_DELAY:10000,POLL_ROUTE:'/longpolling/poll',_isActive:null,_lastNotificationID:0,_isOdooFocused:true,_pollRetryTimeout:null,init:function(parent,params){this._super.apply(this,arguments);this._id=_.uniqueId('bus');this._longPollingBusId=this._id;this._options={};this._channels=[];this._lastPresenceTime=new Date().getTime();$(window).on("focus."+this._longPollingBusId,this._onFocusChange.bind(this,{focus:true}));$(window).on("blur."+this._longPollingBusId,this._onFocusChange.bind(this,{focus:false}));$(window).on("unload."+this._longPollingBusId,this._onFocusChange.bind(this,{focus:false}));$(window).on("click."+this._longPollingBusId,this._onPresence.bind(this));$(window).on("keydown."+this._longPollingBusId,this._onPresence.bind(this));$(window).on("keyup."+this._longPollingBusId,this._onPresence.bind(this));},destroy:function(){this.stopPolling();$(window).off("focus."+this._longPollingBusId);$(window).off("blur."+this._longPollingBusId);$(window).off("unload."+this._longPollingBusId);$(window).off("click."+this._longPollingBusId);$(window).off("keydown."+this._longPollingBusId);$(window).off("keyup."+this._longPollingBusId);this._super();},addChannel:function(channel){if(this._channels.indexOf(channel)===-1){this._channels.push(channel);if(this._pollRpc){this._pollRpc.abort();}else{this.startPolling();}}},deleteChannel:function(channel){var index=this._channels.indexOf(channel);if(index!==-1){this._channels.splice(index,1);if(this._pollRpc){this._pollRpc.abort();}}},isOdooFocused:function(){return this._isOdooFocused;},startPolling:function(){if(this._isActive===null){this._poll=this._poll.bind(this);}
if(!this._isActive){this._isActive=true;this._poll();}},stopPolling:function(){this._isActive=false;this._channels=[];clearTimeout(this._pollRetryTimeout);if(this._pollRpc){this._pollRpc.abort();}},updateOption:function(key,value){this._options[key]=value;},_getLastPresence:function(){return this._lastPresenceTime;},_poll:function(){var self=this;if(!this._isActive){return;}
var now=new Date().getTime();var options=_.extend({},this._options,{bus_inactivity:now-this._getLastPresence(),});var data={channels:this._channels,last:this._lastNotificationID,options:options};this._pollRpc=this._makePoll(data);this._pollRpc.then(function(result){self._pollRpc=false;self._onPoll(result);self._poll();}).guardedCatch(function(result){self._pollRpc=false;result.event.preventDefault();if(result.message==="XmlHttpRequestError abort"){self._poll();}else{self._pollRetryTimeout=setTimeout(self._poll,self.ERROR_RETRY_DELAY+(Math.floor((Math.random()*20)+1)*1000));}});},_makePoll:function(data){return this._rpc({route:this.POLL_ROUTE,params:data},{shadow:true,timeout:60000});},_onFocusChange:function(params){this._isOdooFocused=params.focus;if(params.focus){this._lastPresenceTime=new Date().getTime();this.trigger('window_focus',this._isOdooFocused);}},_onPoll:function(notifications){var self=this;var notifs=_.map(notifications,function(notif){if(notif.id>self._lastNotificationID){self._lastNotificationID=notif.id;}
return[notif.channel,notif.message];});this.trigger("notification",notifs);return notifs;},_onPresence:function(){this._lastPresenceTime=new Date().getTime();},});return LongpollingBus;});;

/* /bus/static/src/js/crosstab_bus.js defined in bundle 'web.assets_backend' */
odoo.define('bus.CrossTab',function(require){"use strict";var Longpolling=require('bus.Longpolling');var session=require('web.session');var CrossTabBus=Longpolling.extend({TAB_HEARTBEAT_PERIOD:10000,MASTER_TAB_HEARTBEAT_PERIOD:1500,HEARTBEAT_OUT_OF_DATE_PERIOD:5000,HEARTBEAT_KILL_OLD_PERIOD:15000,LOCAL_STORAGE_PREFIX:'bus',_isMasterTab:false,_isRegistered:false,init:function(){this._super.apply(this,arguments);var now=new Date().getTime();this._sanitizedOrigin=session.origin.replace(/:\/{0,2}/g,'_');this._id=_.uniqueId(this.LOCAL_STORAGE_PREFIX)+':'+now;if(this._callLocalStorage('getItem','last_ts',0)+50000<now){this._callLocalStorage('removeItem','last');}
this._lastNotificationID=this._callLocalStorage('getItem','last',0);this.call('local_storage','onStorage',this,this._onStorage);},destroy:function(){this._super();clearTimeout(this._heartbeatTimeout);},addChannel:function(){this._super.apply(this,arguments);this._callLocalStorage('setItem','channels',this._channels);},deleteChannel:function(){this._super.apply(this,arguments);this._callLocalStorage('setItem','channels',this._channels);},getTabId:function(){return this._id;},isMasterTab:function(){return this._isMasterTab;},startPolling:function(){if(this._isActive===null){this._heartbeat=this._heartbeat.bind(this);}
if(!this._isRegistered){this._isRegistered=true;var peers=this._callLocalStorage('getItem','peers',{});peers[this._id]=new Date().getTime();this._callLocalStorage('setItem','peers',peers);this._registerWindowUnload();if(!this._callLocalStorage('getItem','master')){this._startElection();}
this._heartbeat();if(this._isMasterTab){this._callLocalStorage('setItem','channels',this._channels);this._callLocalStorage('setItem','options',this._options);}else{this._channels=this._callLocalStorage('getItem','channels',this._channels);this._options=this._callLocalStorage('getItem','options',this._options);}
return;}
if(this._isMasterTab){this._super.apply(this,arguments);}},updateOption:function(){this._super.apply(this,arguments);this._callLocalStorage('setItem','options',this._options);},_callLocalStorage:function(method,key,param){return this.call('local_storage',method,this._generateKey(key),param);},_generateKey:function(key){return this.LOCAL_STORAGE_PREFIX+'.'+this._sanitizedOrigin+'.'+key;},_getLastPresence:function(){return this._callLocalStorage('getItem','lastPresence')||this._super();},_heartbeat:function(){var now=new Date().getTime();var heartbeatValue=parseInt(this._callLocalStorage('getItem','heartbeat',0));var peers=this._callLocalStorage('getItem','peers',{});if((heartbeatValue+this.HEARTBEAT_OUT_OF_DATE_PERIOD)<now){this._startElection();heartbeatValue=parseInt(this._callLocalStorage('getItem','heartbeat',0));}
if(this._isMasterTab){var cleanedPeers={};for(var peerName in peers){if(peers[peerName]+this.HEARTBEAT_KILL_OLD_PERIOD>now){cleanedPeers[peerName]=peers[peerName];}}
if(heartbeatValue!==this.lastHeartbeat){this._isMasterTab=false;this.lastHeartbeat=0;peers[this._id]=now;this._callLocalStorage('setItem','peers',peers);this.stopPolling();this.trigger('no_longer_master');}else{this.lastHeartbeat=now;this._callLocalStorage('setItem','heartbeat',now);this._callLocalStorage('setItem','peers',cleanedPeers);}}else{peers[this._id]=now;this._callLocalStorage('setItem','peers',peers);}
var hbPeriod=this._isMasterTab?this.MASTER_TAB_HEARTBEAT_PERIOD:this.TAB_HEARTBEAT_PERIOD;if(this._lastPresenceTime+hbPeriod>now){this._callLocalStorage('setItem','lastPresence',this._lastPresenceTime);}
this._heartbeatTimeout=setTimeout(this._heartbeat.bind(this),hbPeriod);},_registerWindowUnload:function(){$(window).on('unload.'+this._id,this._onUnload.bind(this));},_startElection:function(){if(this._isMasterTab){return;}
var now=new Date().getTime();var peers=this._callLocalStorage('getItem','peers',{});var heartbeatKillOld=now-this.HEARTBEAT_KILL_OLD_PERIOD;var newMaster;for(var peerName in peers){if(peers[peerName]<heartbeatKillOld){continue;}
newMaster=peerName;break;}
if(newMaster===this._id){this.lastHeartbeat=now;this._callLocalStorage('setItem','heartbeat',this.lastHeartbeat);this._callLocalStorage('setItem','master',true);this._isMasterTab=true;this.startPolling();this.trigger('become_master');delete peers[newMaster];this._callLocalStorage('setItem','peers',peers);}},_onFocusChange:function(params){this._super.apply(this,arguments);this._callLocalStorage('setItem','focus',params.focus);},_onPoll:function(notifications){var notifs=this._super(notifications);if(this._isMasterTab&&notifs.length){this._callLocalStorage('setItem','last',this._lastNotificationID);this._callLocalStorage('setItem','last_ts',new Date().getTime());this._callLocalStorage('setItem','notification',notifs);}},_onStorage:function(e){var value=JSON.parse(e.newValue);var key=e.key;if(this._isRegistered&&key===this._generateKey('master')&&!value){this._startElection();}
if(key===this._generateKey('last')){this._lastNotificationID=value||0;}
else if(key===this._generateKey('notification')){if(!this._isMasterTab){this.trigger("notification",value);}}
else if(key===this._generateKey('channels')){this._channels=value;}
else if(key===this._generateKey('options')){this._options=value;}
else if(key===this._generateKey('focus')){this._isOdooFocused=value;this.trigger('window_focus',this._isOdooFocused);}},_onUnload:function(){var peers=this._callLocalStorage('getItem','peers')||{};delete peers[this._id];this._callLocalStorage('setItem','peers',peers);if(this._isMasterTab){this._callLocalStorage('removeItem','master');}},});return CrossTabBus;});;

/* /bus/static/src/js/services/bus_service.js defined in bundle 'web.assets_backend' */
odoo.define('bus.BusService',function(require){"use strict";var CrossTab=require('bus.CrossTab');var core=require('web.core');var ServicesMixin=require('web.ServicesMixin');const session=require('web.session');var BusService=CrossTab.extend(ServicesMixin,{dependencies:['local_storage'],_audio:null,init:function(env){this.env=env;this._super();},_trigger_up:function(ev){if(ev.name==='call_service'){const payload=ev.data;let args=payload.args||[];if(payload.service==='ajax'&&payload.method==='rpc'){args=args.concat(ev.target);}
const service=this.env.services[payload.service];const result=service[payload.method].apply(service,args);payload.callback(result);}},start:function(){},sendNotification:function(title,content,callback){if(window.Notification&&Notification.permission==="granted"){if(this.isMasterTab()){try{this._sendNativeNotification(title,content,callback);}catch(error){if(error.message.indexOf('ServiceWorkerRegistration')>-1){this.do_notify(title,content);this._beep();}else{throw error;}}}}else{this.do_notify(title,content);if(this.isMasterTab()){this._beep();}}},onNotification:function(){this.on.apply(this,["notification"].concat(Array.prototype.slice.call(arguments)));},_beep:function(){if(typeof(Audio)!=="undefined"){if(!this._audio){this._audio=new Audio();var ext=this._audio.canPlayType("audio/ogg; codecs=vorbis")?".ogg":".mp3";this._audio.src=session.url("/mail/static/src/audio/ting"+ext);}
Promise.resolve(this._audio.play()).catch(_.noop);}},_sendNativeNotification:function(title,content,callback){var notification=new Notification(_.unescape(title),{body:_.unescape(content),icon:"/mail/static/src/img/odoobot_transparent.png"});notification.onclick=function(){window.focus();if(this.cancel){this.cancel();}else if(this.close){this.close();}
if(callback){callback();}};},});core.serviceRegistry.add('bus_service',BusService);return BusService;});;

/* /bus/static/src/js/web_client_bus.js defined in bundle 'web.assets_backend' */
odoo.define('bus.WebClient',function(require){"use strict";const core=require('web.core');const WebClient=require('web.WebClient');const _t=core._t;WebClient.include({async start(){this._assetsChangedNotificationId=null;this._assets={};await this._super(...arguments);},show_application(){const shown=this._super(...arguments);document.querySelectorAll('*[data-asset-xmlid]').forEach(el=>{this._assets[el.getAttribute('data-asset-xmlid')]=el.getAttribute('data-asset-version');});this.call('bus_service','onNotification',this,this._onNotification);this.call('bus_service','addChannel','bundle_changed');return shown;},_displayBundleChangedNotification(){if(!this._assetsChangedNotificationId){clearTimeout(this._bundleNotifTimerID);this._bundleNotifTimerID=setTimeout(()=>{this._assetsChangedNotificationId=this.call('notification','notify',{title:_t('Refresh'),message:_t('The page appears to be out of date.'),sticky:true,onClose:()=>{this._assetsChangedNotificationId=null;},buttons:[{text:_t('Refresh'),primary:true,click:()=>{window.location.reload(true);}}],});},this._getBundleNotificationDelay());}},_getBundleNotificationDelay(){return 10000+Math.floor(Math.random()*50)*1000;},_onNotification(notifications){for(const notif of notifications){if(notif[0][1]==='bundle_changed'){const bundleXmlId=notif[1][0];const bundleVersion=notif[1][1];if(bundleXmlId in this._assets&&bundleVersion!==this._assets[bundleXmlId]){this._displayBundleChangedNotification();break;}}}}});});;

/* /resource/static/src/js/section_fields_backend.js defined in bundle 'web.assets_backend' */
odoo.define('resource.section_backend',function(require){"use strict";var FieldOne2Many=require('web.relational_fields').FieldOne2Many;var fieldRegistry=require('web.field_registry');var ListRenderer=require('web.ListRenderer');var SectionListRenderer=ListRenderer.extend({_renderBodyCell:function(record,node,index,options){var $cell=this._super.apply(this,arguments);var isSection=record.data.display_type==='line_section';if(isSection){if(node.attrs.widget==="handle"){return $cell;}else if(node.attrs.name==="name"){var nbrColumns=this._getNumberOfCols();if(this.handleField){nbrColumns--;}
if(this.addTrashIcon){nbrColumns--;}
$cell.attr('colspan',nbrColumns);}else{return $cell.addClass('o_hidden');}}
return $cell;},_renderRow:function(record,index){var $row=this._super.apply(this,arguments);if(record.data.display_type){$row.addClass('o_is_'+record.data.display_type);}
return $row;},_renderView:function(){var self=this;return this._super.apply(this,arguments).then(function(){self.$('.o_list_table').addClass('o_section_list_view');});},});var SectionFieldOne2Many=FieldOne2Many.extend({_getRenderer:function(){if(this.view.arch.tag==='tree'){return SectionListRenderer;}
return this._super.apply(this,arguments);},});fieldRegistry.add('section_one2many',SectionFieldOne2Many);});;

/* /utm/static/src/js/utm_campaign_kanban_examples.js defined in bundle 'web.assets_backend' */
odoo.define('utm.campaing_kanban_examples',function(require){'use strict';var core=require('web.core');var kanbanExamplesRegistry=require('web.kanban_examples_registry');var _lt=core._lt;kanbanExamplesRegistry.add('utm_campaign',{ghostColumns:[_lt('Ideas'),_lt('Design'),_lt('Review'),_lt('Send'),_lt('Done')],applyExamplesText:_lt("Use This For My Campaigns"),examples:[{name:_lt('Creative Flow'),columns:[_lt('Ideas'),_lt('Design'),_lt('Review'),_lt('Send'),_lt('Done')],description:_lt("Collect ideas, design creative content and publish it once reviewed."),},{name:_lt('Event-driven Flow'),columns:[_lt('Later'),_lt('This Month'),_lt('This Week'),_lt('Running'),_lt('Sent')],description:_lt("Track incoming events (e.g. : Christmas, Black Friday, ...) and publish timely content."),},{name:_lt('Soft-Launch Flow'),columns:[_lt('Pre-Launch'),_lt('Soft-Launch'),_lt('Deploy'),_lt('Report'),_lt('Done')],description:_lt("Prepare your Campaign, test it with part of your audience and deploy it fully afterwards."),},{name:_lt('Audience-driven Flow'),columns:[_lt('Gather Data'),_lt('List-Building'),_lt('Copywriting'),_lt('Sent')],description:_lt("Gather data, build a recipient list and write content based on your Marketing target."),},{name:_lt('Approval-based Flow'),columns:[_lt('To be Approved'),_lt('Approved'),_lt('Deployed')],description:_lt("Prepare Campaigns and get them approved before making them go live."),}],});});;

/* /iap/static/src/js/iap_credit.js defined in bundle 'web.assets_backend' */
odoo.define('iap.redirect_odoo_credit_widget',function(require){"use strict";var AbstractAction=require('web.AbstractAction');var core=require('web.core');var IapOdooCreditRedirect=AbstractAction.extend({template:'iap.redirect_to_odoo_credit',events:{"click .redirect_confirm":"odoo_redirect",},init:function(parent,action){this._super(parent,action);this.url=action.params.url;},odoo_redirect:function(){window.open(this.url,'_blank');this.do_action({type:'ir.actions.act_window_close'});},});core.action_registry.add('iap_odoo_credit_redirect',IapOdooCreditRedirect);});;

/* /iap/static/src/js/crash_manager.js defined in bundle 'web.assets_backend' */
odoo.define('iap.CrashManager',function(require){"use strict";var ajax=require('web.ajax');var core=require('web.core');var CrashManager=require('web.CrashManager').CrashManager;var Dialog=require('web.Dialog');var _t=core._t;var QWeb=core.qweb;CrashManager.include({_getButtonMessage:function(isTrial){var isEnterprise=_.last(odoo.session_info.server_version_info)==='e';return isTrial&&isEnterprise?_t('Start a Trial at Odoo'):_t('Buy credits');},rpc_error:function(error){var self=this;if(error.data.name==="odoo.addons.iap.tools.iap_tools.InsufficientCreditError"){var error_data=JSON.parse(error.data.message);ajax.jsonRpc('/web/dataset/call_kw','call',{model:'iap.account',method:'get_credits_url',args:[],kwargs:{base_url:error_data.base_url,service_name:error_data.service_name,credit:error_data.credit,trial:error_data.trial}}).then(function(url){var content=$(QWeb.render('iap.redirect_to_odoo_credit',{data:error_data,}));if(error_data.body){content.css('padding',0);}
new Dialog(this,{size:'large',title:error_data.title||_t("Insufficient Balance"),$content:content,buttons:[{text:self._getButtonMessage(error_data.trial),classes:"btn-primary",click:function(){window.open(url,'_blank');},close:true,},{text:_t("Cancel"),close:true,}],}).open();});}else{this._super.apply(this,arguments);}},});});;

/* /iap/static/src/js/iap_buy_more_credits.js defined in bundle 'web.assets_backend' */
odoo.define('iap.buy_more_credits',function(require){'use strict';var widgetRegistry=require('web.widget_registry');var Widget=require('web.Widget');var core=require('web.core');var rpc=require('web.rpc');var QWeb=core.qweb;var IAPBuyMoreCreditsWidget=Widget.extend({className:'o_field_iap_buy_more_credits',init:function(parent,data,options){this._super.apply(this,arguments);this.service_name=options.attrs.service_name;},start:function(){this.$widget=$(QWeb.render('iap.buy_more_credits'));this.$buyLink=this.$widget.find('.buy_credits');this.$widget.appendTo(this.$el);this.$buyLink.click(this._getLink.bind(this));},_getLink:function(){var self=this;return rpc.query({model:'iap.account',method:'get_credits_url',args:[this.service_name],},{shadow:true,}).then(function(url){return self.do_action({type:'ir.actions.act_url',url:url,});});},});widgetRegistry.add('iap_buy_more_credits',IAPBuyMoreCreditsWidget);return IAPBuyMoreCreditsWidget;});;

/* /mail/static/src/js/core/translation.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/js/core/translation.js',function(require){'use strict';const{TranslationDataBase}=require('web.translation');const{Component}=owl;TranslationDataBase.include({set_bundle(){const res=this._super(...arguments);if(Component.env.messaging){Component.env.messaging.locale.update({language:this.parameters.code,textDirection:this.parameters.direction,});}
return res;},});});;

/* /mail/static/src/js/many2many_tags_email.js defined in bundle 'web.assets_backend' */
odoo.define('mail.many2manytags',function(require){"use strict";var BasicModel=require('web.BasicModel');var core=require('web.core');var form_common=require('web.view_dialogs');var field_registry=require('web.field_registry');var relational_fields=require('web.relational_fields');var M2MTags=relational_fields.FieldMany2ManyTags;var _t=core._t;BasicModel.include({_setInvalidMany2ManyTagsEmail:function(record,fieldName){var self=this;var localID=(record._changes&&fieldName in record._changes)?record._changes[fieldName]:record.data[fieldName];var list=this._applyX2ManyOperations(this.localData[localID]);var invalidPartnerIds=[];_.each(list.data,function(id){var record=self.localData[id];if(!record.data.email){invalidPartnerIds.push(record);}});var def;if(invalidPartnerIds.length){var changes={operation:'DELETE',ids:_.pluck(invalidPartnerIds,'id')};def=this._applyX2ManyChange(record,fieldName,changes);}
return Promise.resolve(def).then(function(){return{invalidPartnerIds:_.pluck(invalidPartnerIds,'res_id'),};});},});var FieldMany2ManyTagsEmail=M2MTags.extend({tag_template:"FieldMany2ManyTagsEmail",fieldsToFetch:_.extend({},M2MTags.prototype.fieldsToFetch,{email:{type:'char'},}),specialData:"_setInvalidMany2ManyTagsEmail",_checkEmailPopup:function(){var self=this;var popupDefs=[];var validPartners=[];_.each(this.record.specialData[this.name].invalidPartnerIds,function(resID){var def=new Promise(function(resolve,reject){var pop=new form_common.FormViewDialog(self,{res_model:self.field.relation,res_id:resID,context:self.record.context,title:"",on_saved:function(record){if(record.data.email){validPartners.push(record.res_id);}},}).open();pop.on('closed',self,function(){resolve();});});popupDefs.push(def);});return Promise.all(popupDefs).then(function(){validPartners=_.uniq(validPartners);if(validPartners.length){var values=_.map(validPartners,function(id){return{id:id};});self._setValue({operation:'ADD_M2M',ids:values,});}});},_render:function(){var self=this;var _super=this._super.bind(this);return new Promise(function(resolve,reject){if(self.record.specialData[self.name].invalidPartnerIds.length){resolve(self._checkEmailPopup());}else{resolve();}}).then(function(){return _super.apply(self,arguments);});},});field_registry.add('many2many_tags_email',FieldMany2ManyTagsEmail);});;

/* /mail/static/src/js/many2one_avatar_user.js defined in bundle 'web.assets_backend' */
odoo.define('mail.Many2OneAvatarUser',function(require){"use strict";const fieldRegistry=require('web.field_registry');const{Many2OneAvatar}=require('web.relational_fields');const{Component}=owl;const Many2OneAvatarUser=Many2OneAvatar.extend({events:Object.assign({},Many2OneAvatar.prototype.events,{'click .o_m2o_avatar':'_onAvatarClicked',}),supportedModels:['res.users'],init(){this._super(...arguments);if(!this.supportedModels.includes(this.field.relation)){throw new Error(`This widget is only supported on many2one fields pointing to ${JSON.stringify(this.supportedModels)}`);}
if(this.mode==='readonly'){this.className+=' o_clickable_m2o_avatar';}},async _onAvatarClicked(ev){ev.stopPropagation();const env=Component.env;await env.messaging.openChat({userId:this.value.res_id});}});const KanbanMany2OneAvatarUser=Many2OneAvatarUser.extend({_template:'mail.KanbanMany2OneAvatarUser',});fieldRegistry.add('many2one_avatar_user',Many2OneAvatarUser);fieldRegistry.add('kanban.many2one_avatar_user',KanbanMany2OneAvatarUser);return{Many2OneAvatarUser,KanbanMany2OneAvatarUser,};});;

/* /mail/static/src/js/field_char.js defined in bundle 'web.assets_backend' */
odoo.define('sms.onchange_in_keyup',function(require){"use strict";var FieldChar=require('web.basic_fields').FieldChar;FieldChar.include({init:function(){this._super.apply(this,arguments);this._triggerOnchange=_.throttle(this._triggerOnchange,1000,{leading:false});},_onKeydown:function(){this._super.apply(this,arguments);if(this.nodeOptions.onchange_on_keydown){this._triggerOnchange();}},_triggerOnchange:function(){this.$input.trigger('change');},});});;

/* /mail/static/src/js/document_viewer.js defined in bundle 'web.assets_backend' */
odoo.define('mail.DocumentViewer',function(require){"use strict";var core=require('web.core');var Widget=require('web.Widget');var QWeb=core.qweb;var SCROLL_ZOOM_STEP=0.1;var ZOOM_STEP=0.5;var DocumentViewer=Widget.extend({template:"DocumentViewer",events:{'click .o_download_btn':'_onDownload','click .o_viewer_img':'_onImageClicked','click .o_viewer_video':'_onVideoClicked','click .move_next':'_onNext','click .move_previous':'_onPrevious','click .o_rotate':'_onRotate','click .o_zoom_in':'_onZoomIn','click .o_zoom_out':'_onZoomOut','click .o_zoom_reset':'_onZoomReset','click .o_close_btn, .o_viewer_img_wrapper':'_onClose','click .o_print_btn':'_onPrint','DOMMouseScroll .o_viewer_content':'_onScroll','mousewheel .o_viewer_content':'_onScroll','keydown':'_onKeydown','keyup':'_onKeyUp','mousedown .o_viewer_img':'_onStartDrag','mousemove .o_viewer_content':'_onDrag','mouseup .o_viewer_content':'_onEndDrag'},init:function(parent,attachments,activeAttachmentID){this._super.apply(this,arguments);this.attachment=_.filter(attachments,function(attachment){var match=attachment.type==='url'?attachment.url.match("(youtu|.png|.jpg|.gif)"):attachment.mimetype.match("(image|video|application/pdf|text)");if(match){attachment.fileType=match[1];if(match[1].match("(.png|.jpg|.gif)")){attachment.fileType='image';}
if(match[1]==='youtu'){var youtube_array=attachment.url.split('/');var youtube_token=youtube_array[youtube_array.length-1];if(youtube_token.indexOf('watch')!==-1){youtube_token=youtube_token.split('v=')[1];var amp=youtube_token.indexOf('&')
if(amp!==-1){youtube_token=youtube_token.substring(0,amp);}}
attachment.youtube=youtube_token;}
return true;}});this.activeAttachment=_.findWhere(attachments,{id:activeAttachmentID});this.modelName='ir.attachment';this._reset();},start:function(){this.$el.modal('show');this.$el.on('hidden.bs.modal',_.bind(this._onDestroy,this));this.$('.o_viewer_img').on("load",_.bind(this._onImageLoaded,this));this.$('[data-toggle="tooltip"]').tooltip({delay:0});return this._super.apply(this,arguments);},destroy:function(){if(this.isDestroyed()){return;}
this.$el.modal('hide');this.$el.remove();this._super.apply(this,arguments);},_next:function(){var index=_.findIndex(this.attachment,this.activeAttachment);index=(index+1)%this.attachment.length;this.activeAttachment=this.attachment[index];this._updateContent();},_previous:function(){var index=_.findIndex(this.attachment,this.activeAttachment);index=index===0?this.attachment.length-1:index-1;this.activeAttachment=this.attachment[index];this._updateContent();},_reset:function(){this.scale=1;this.dragStartX=this.dragstopX=0;this.dragStartY=this.dragstopY=0;},_updateContent:function(){this.$('.o_viewer_content').html(QWeb.render('DocumentViewer.Content',{widget:this}));this.$('.o_viewer_img').on("load",_.bind(this._onImageLoaded,this));this.$('[data-toggle="tooltip"]').tooltip({delay:0});this._reset();},_getTransform:function(scale,angle){return'scale3d('+scale+', '+scale+', 1) rotate('+angle+'deg)';},_rotate:function(angle){this._reset();var new_angle=(this.angle||0)+angle;this.$('.o_viewer_img').css('transform',this._getTransform(this.scale,new_angle));this.$('.o_viewer_img').css('max-width',new_angle%180!==0?$(document).height():'100%');this.$('.o_viewer_img').css('max-height',new_angle%180!==0?$(document).width():'100%');this.angle=new_angle;},_zoom:function(scale){if(scale>0.5){this.$('.o_viewer_img').css('transform',this._getTransform(scale,this.angle||0));this.scale=scale;}
this.$('.o_zoom_reset').add('.o_zoom_out').toggleClass('disabled',scale===1);},_onClose:function(e){e.preventDefault();this.destroy();},_onDestroy:function(){this.destroy();},_onDownload:function(e){e.preventDefault();window.location='/web/content/'+this.modelName+'/'+this.activeAttachment.id+'/'+'datas'+'?download=true';},_onDrag:function(e){e.preventDefault();if(this.enableDrag){var $image=this.$('.o_viewer_img');var $zoomer=this.$('.o_viewer_zoomer');var top=$image.prop('offsetHeight')*this.scale>$zoomer.height()?e.clientY-this.dragStartY:0;var left=$image.prop('offsetWidth')*this.scale>$zoomer.width()?e.clientX-this.dragStartX:0;$zoomer.css("transform","translate3d("+left+"px, "+top+"px, 0)");$image.css('cursor','move');}},_onEndDrag:function(e){e.preventDefault();if(this.enableDrag){this.enableDrag=false;this.dragstopX=e.clientX-this.dragStartX;this.dragstopY=e.clientY-this.dragStartY;this.$('.o_viewer_img').css('cursor','');}},_onImageClicked:function(e){e.stopPropagation();},_onImageLoaded:function(){this.$('.o_loading_img').hide();},_onKeydown:function(e){switch(e.which){case $.ui.keyCode.RIGHT:e.preventDefault();this._next();break;case $.ui.keyCode.LEFT:e.preventDefault();this._previous();break;}},_onKeyUp:function(e){switch(e.which){case $.ui.keyCode.ESCAPE:e.preventDefault();this._onClose(e);break;}},_onNext:function(e){e.preventDefault();this._next();},_onPrevious:function(e){e.preventDefault();this._previous();},_onPrint:function(e){e.preventDefault();var src=this.$('.o_viewer_img').prop('src');var script=QWeb.render('PrintImage',{src:src});var printWindow=window.open('about:blank',"_new");printWindow.document.open();printWindow.document.write(script);printWindow.document.close();},_onScroll:function(e){var scale;if(e.originalEvent.wheelDelta>0||e.originalEvent.detail<0){scale=this.scale+SCROLL_ZOOM_STEP;this._zoom(scale);}else{scale=this.scale-SCROLL_ZOOM_STEP;this._zoom(scale);}},_onStartDrag:function(e){e.preventDefault();this.enableDrag=true;this.dragStartX=e.clientX-(this.dragstopX||0);this.dragStartY=e.clientY-(this.dragstopY||0);},_onVideoClicked:function(e){e.stopPropagation();var videoElement=e.target;if(videoElement.paused){videoElement.play();}else{videoElement.pause();}},_onRotate:function(e){e.preventDefault();this._rotate(90);},_onZoomIn:function(e){e.preventDefault();var scale=this.scale+ZOOM_STEP;this._zoom(scale);},_onZoomOut:function(e){e.preventDefault();var scale=this.scale-ZOOM_STEP;this._zoom(scale);},_onZoomReset:function(e){e.preventDefault();this.$('.o_viewer_zoomer').css("transform","");this._zoom(1);},});return DocumentViewer;});;

/* /mail/static/src/js/basic_view.js defined in bundle 'web.assets_backend' */
odoo.define('mail.BasicView',function(require){"use strict";const BasicView=require('web.BasicView');const mailWidgets=['kanban_activity'];BasicView.include({init:function(){this._super.apply(this,arguments);const post_refresh=this._getFieldOption('message_ids','post_refresh',false);const followers_post_refresh=this._getFieldOption('message_follower_ids','post_refresh',false);this.chatterFields={hasActivityIds:this._hasField('activity_ids'),hasMessageFollowerIds:this._hasField('message_follower_ids'),hasMessageIds:this._hasField('message_ids'),hasRecordReloadOnAttachmentsChanged:post_refresh==='always',hasRecordReloadOnMessagePosted:!!post_refresh,hasRecordReloadOnFollowersUpdate:!!followers_post_refresh,isAttachmentBoxVisibleInitially:(this._getFieldOption('message_ids','open_attachments',false)||this._getFieldOption('message_follower_ids','open_attachments',false)),};const fieldsInfo=this.fieldsInfo[this.viewType];this.rendererParams.chatterFields=this.chatterFields;this.mailFields={};for(const fieldName in fieldsInfo){const fieldInfo=fieldsInfo[fieldName];if(_.contains(mailWidgets,fieldInfo.widget)){this.mailFields[fieldInfo.widget]=fieldName;fieldInfo.__no_fetch=true;}}
this.rendererParams.activeActions=this.controllerParams.activeActions;this.rendererParams.mailFields=this.mailFields;},_getFieldOption(fieldName,optionName,defaultValue){const field=this.fieldsInfo[this.viewType][fieldName];if(field&&field.options&&field.options[optionName]!==undefined){return field.options[optionName];}
return defaultValue;},_hasField(fieldName){return!!this.fieldsInfo[this.viewType][fieldName];},});});;

/* /mail/static/src/js/systray/systray_activity_menu.js defined in bundle 'web.assets_backend' */
odoo.define('mail.systray.ActivityMenu',function(require){"use strict";var core=require('web.core');var session=require('web.session');var SystrayMenu=require('web.SystrayMenu');var Widget=require('web.Widget');var Time=require('web.time');var QWeb=core.qweb;const{Component}=owl;var ActivityMenu=Widget.extend({name:'activity_menu',template:'mail.systray.ActivityMenu',events:{'click .o_mail_activity_action':'_onActivityActionClick','click .o_mail_preview':'_onActivityFilterClick','show.bs.dropdown':'_onActivityMenuShow','hide.bs.dropdown':'_onActivityMenuHide',},start:function(){this._$activitiesPreview=this.$('.o_mail_systray_dropdown_items');Component.env.bus.on('activity_updated',this,this._updateCounter);this._updateCounter();this._updateActivityPreview();return this._super();},_getActivityData:function(){var self=this;return self._rpc({model:'res.users',method:'systray_get_activities',args:[],kwargs:{context:session.user_context},}).then(function(data){self._activities=data;self.activityCounter=_.reduce(data,function(total_count,p_data){return total_count+p_data.total_count||0;},0);self.$('.o_notification_counter').text(self.activityCounter);self.$el.toggleClass('o_no_notification',!self.activityCounter);});},_getActivityModelViewID:function(model){return this._rpc({model:model,method:'get_activity_view_id'});},_getViewsList(model){return[[false,'kanban'],[false,'list'],[false,'form']];},_updateActivityPreview:function(){var self=this;self._getActivityData().then(function(){self._$activitiesPreview.html(QWeb.render('mail.systray.ActivityMenu.Previews',{widget:self,Time:Time}));});},_updateCounter:function(data){if(data){if(data.activity_created){this.activityCounter++;}
if(data.activity_deleted&&this.activityCounter>0){this.activityCounter--;}
this.$('.o_notification_counter').text(this.activityCounter);this.$el.toggleClass('o_no_notification',!this.activityCounter);}},_onActivityActionClick:function(ev){ev.stopPropagation();this.$('.dropdown-toggle').dropdown('toggle');var targetAction=$(ev.currentTarget);var actionXmlid=targetAction.data('action_xmlid');if(actionXmlid){this.do_action(actionXmlid);}else{var domain=[['activity_ids.user_id','=',session.uid]]
if(targetAction.data('domain')){domain=domain.concat(targetAction.data('domain'))}
this.do_action({type:'ir.actions.act_window',name:targetAction.data('model_name'),views:[[false,'activity'],[false,'kanban'],[false,'list'],[false,'form']],view_mode:'activity',res_model:targetAction.data('res_model'),domain:domain,},{clear_breadcrumbs:true,});}},_onActivityFilterClick:function(event){var data=_.extend({},$(event.currentTarget).data(),$(event.target).data());var context={};if(data.filter==='my'){context['search_default_activities_overdue']=1;context['search_default_activities_today']=1;}else{context['search_default_activities_'+data.filter]=1;}
context['force_search_count']=1;var domain=[['activity_ids.user_id','=',session.uid]]
if(data.domain){domain=domain.concat(data.domain)}
this.do_action({type:'ir.actions.act_window',name:data.model_name,res_model:data.res_model,views:this._getViewsList(data.res_model),search_view_id:[false],domain:domain,context:context,},{clear_breadcrumbs:true,});},_onActivityMenuShow:function(){document.body.classList.add('modal-open');this._updateActivityPreview();},_onActivityMenuHide:function(){document.body.classList.remove('modal-open');},});SystrayMenu.Items.push(ActivityMenu);return ActivityMenu;});;

/* /mail/static/src/js/tours/mail.js defined in bundle 'web.assets_backend' */
odoo.define('mail.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;tour.register('mail_tour',{url:"/web#action=mail.widgets.discuss",sequence:80,},[{trigger:'.o_DiscussSidebar_groupChannel .o_DiscussSidebar_groupHeaderItemAdd',content:_t("<p>Channels make it easy to organize information across different topics and groups.</p> <p>Try to <b>create your first channel</b> (e.g. sales, marketing, product XYZ, after work party, etc).</p>"),position:'bottom',},{trigger:'.o_DiscussSidebar_itemNewInput',content:_t("<p>Create a channel here.</p>"),position:'bottom',auto:true,run:function(actions){var t=new Date().getTime();actions.text("SomeChannel_"+t,this.$anchor);},},{trigger:".o_DiscussSidebar_newChannelAutocompleteSuggestions",content:_t("<p>Create a public or private channel.</p>"),position:'right',run(){this.$consumeEventAnchors.find('li:first').click();},},{trigger:'.o_Discuss_thread .o_ComposerTextInput_textarea',content:_t("<p><b>Write a message</b> to the members of the channel here.</p> <p>You can notify someone with <i>'@'</i> or link another channel with <i>'#'</i>. Start your message with <i>'/'</i> to get the list of possible commands.</p>"),position:"top",width:350,run:function(actions){var t=new Date().getTime();actions.text("SomeText_"+t,this.$anchor);},},{trigger:'.o_Discuss_thread .o_Composer_buttonSend',content:_t("Post your message on the thread"),position:"top",},{trigger:'.o_Discuss_thread .o_Message_commandStar',content:_t("Messages can be <b>starred</b> to remind you to check back later."),position:"bottom",},{trigger:'.o_DiscussSidebarItem.o-starred-box',content:_t("Once a message has been starred, you can come back and review it at any time here."),position:"bottom",},{trigger:'.o_DiscussSidebar_groupChat .o_DiscussSidebar_groupHeaderItemAdd',content:_t("<p><b>Chat with coworkers</b> in real-time using direct messages.</p><p><i>You might need to invite users from the Settings app first.</i></p>"),position:'bottom',}]);});;

/* /mail/static/src/js/tools/debug_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail.DebugManager.Backend',function(require){"use strict";var core=require('web.core');var DebugManager=require('web.DebugManager.Backend');var _t=core._t;DebugManager.include({getMailMessages:function(){var selectedIDs=this._controller.getSelectedIds();if(!selectedIDs.length){console.warn(_t("No message available"));return;}
this.do_action({res_model:'mail.message',name:_t('Manage Messages'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['res_id','=',selectedIDs[0]],['model','=',this._controller.modelName]],context:{default_res_model:this._controller.modelName,default_res_id:selectedIDs[0],},});},});});;

/* /mail/static/src/js/custom_filter_item.js defined in bundle 'web.assets_backend' */
odoo.define('mail.CustomFilterItem',function(require){"use strict";const CustomFilterItem=require('web.CustomFilterItem');CustomFilterItem.patch('mail.CustomFilterItem',T=>class extends T{_validateField(field){return super._validateField(...arguments)&&field.relation!=='mail.message'&&field.name!=='message_ids';}});return CustomFilterItem;});;

/* /mail/static/src/js/utils.js defined in bundle 'web.assets_backend' */
odoo.define('mail.utils',function(require){"use strict";var core=require('web.core');var _t=core._t;function parseAndTransform(htmlString,transformFunction){var openToken="OPEN"+Date.now();var string=htmlString.replace(/&lt;/g,openToken);var children;try{children=$('<div>').html(string).contents();}catch(e){children=$('<div>').html('<pre>'+string+'</pre>').contents();}
return _parseAndTransform(children,transformFunction).replace(new RegExp(openToken,"g"),"&lt;");}
function _parseAndTransform(nodes,transformFunction){return _.map(nodes,function(node){return transformFunction(node,function(){return _parseAndTransform(node.childNodes,transformFunction);});}).join("");}
var urlRegexp=/\b(?:https?:\/\/\d{1,3}(?:\.\d{1,3}){3}|(?:https?:\/\/|(?:www\.))[-a-z0-9@:%._+~#=\u00C0-\u024F\u1E00-\u1EFF]{2,256}\.[a-z]{2,13})\b(?:[-a-z0-9@:%_+.~#?&'$//=;\u00C0-\u024F\u1E00-\u1EFF]*)/gi;function linkify(text,attrs){attrs=attrs||{};if(attrs.target===undefined){attrs.target='_blank';}
if(attrs.target==='_blank'){attrs.rel='noreferrer noopener';}
attrs=_.map(attrs,function(value,key){return key+'="'+_.escape(value)+'"';}).join(' ');return text.replace(urlRegexp,function(url){var href=(!/^https?:\/\//i.test(url))?"http://"+url:url;return'<a '+attrs+' href="'+href+'">'+url+'</a>';});}
function addLink(node,transformChildren){if(node.nodeType===3){const linkified=linkify(node.data);if(linkified!==node.data){const div=document.createElement('div');div.innerHTML=linkified;for(const childNode of[...div.childNodes]){node.parentNode.insertBefore(childNode,node);}
node.parentNode.removeChild(node);return linkified;}
return node.textContent;}
if(node.tagName==="A")return node.outerHTML;transformChildren();return node.outerHTML;}
function htmlToTextContentInline(htmlString){const fragment=document.createDocumentFragment();const div=document.createElement('div');fragment.appendChild(div);htmlString=htmlString.replace(/<br\s*\/?>/gi,' ');try{div.innerHTML=htmlString;}catch(e){div.innerHTML=`<pre>${htmlString}</pre>`;}
return div.textContent.trim().replace(/[\n\r]/g,'').replace(/\s\s+/g,' ');}
function stripHTML(node,transformChildren){if(node.nodeType===3)return node.data;if(node.tagName==="BR")return"\n";return transformChildren();}
function inline(node,transform_children){if(node.nodeType===3)return node.data;if(node.nodeType===8)return"";if(node.tagName==="BR")return" ";if(node.tagName.match(/^(A|P|DIV|PRE|BLOCKQUOTE)$/))return transform_children();node.innerHTML=transform_children();return node.outerHTML;}
function parseEmail(text){if(text){var result=text.match(/(.*)<(.*@.*)>/);if(result){return[_.str.trim(result[1]),_.str.trim(result[2])];}
result=text.match(/(.*@.*)/);if(result){return[_.str.trim(result[1]),_.str.trim(result[1])];}
return[text,false];}}
function escapeAndCompactTextContent(content){let value=owl.utils.escape(content).trim();value=value.replace(/(\r|\n){2,}/g,'<br/><br/>');value=value.replace(/(\r|\n)/g,'<br/>');value=value.replace(/ /g,'&nbsp;').replace(/([^>])&nbsp;([^<])/g,'$1 $2');return value;}
function getTextToHTML(text){return text.replace(/((?:https?|ftp):\/\/[\S]+)/g,'<a href="$1">$1</a> ').replace(/[\n\r]/g,'<br/>');}
function timeFromNow(date){if(moment().diff(date,'seconds')<45){return _t("now");}
return date.fromNow();}
return{addLink:addLink,getTextToHTML:getTextToHTML,htmlToTextContentInline,inline:inline,linkify:linkify,parseAndTransform:parseAndTransform,parseEmail:parseEmail,stripHTML:stripHTML,timeFromNow:timeFromNow,escapeAndCompactTextContent,};});;

/* /mail/static/src/js/activity.js defined in bundle 'web.assets_backend' */
odoo.define('mail.Activity',function(require){"use strict";var mailUtils=require('mail.utils');var AbstractField=require('web.AbstractField');var BasicModel=require('web.BasicModel');var config=require('web.config');var core=require('web.core');var field_registry=require('web.field_registry');var session=require('web.session');var framework=require('web.framework');var time=require('web.time');var QWeb=core.qweb;var _t=core._t;const _lt=core._lt;function _readActivities(self,ids){if(!ids.length){return Promise.resolve([]);}
var context=self.getSession().user_context;if(self.record&&!_.isEmpty(self.record.getContext())){context=self.record.getContext();}
return self._rpc({model:'mail.activity',method:'activity_format',args:[ids],context:context,}).then(function(activities){_.each(activities,function(activity){activity.create_date=moment(time.auto_str_to_date(activity.create_date));activity.date_deadline=moment(time.auto_str_to_date(activity.date_deadline));});activities=_.sortBy(activities,'date_deadline');return activities;});}
BasicModel.include({_fetchSpecialActivity:function(record,fieldName){var localID=(record._changes&&fieldName in record._changes)?record._changes[fieldName]:record.data[fieldName];return _readActivities(this,this.localData[localID].res_ids);},});var setDelayLabel=function(activities){var today=moment().startOf('day');_.each(activities,function(activity){var toDisplay='';var diff=activity.date_deadline.diff(today,'days',true);if(diff===0){toDisplay=_t("Today");}else{if(diff<0){if(diff===-1){toDisplay=_t("Yesterday");}else{toDisplay=_.str.sprintf(_t("%d days overdue"),Math.abs(diff));}}else{if(diff===1){toDisplay=_t("Tomorrow");}else{toDisplay=_.str.sprintf(_t("Due in %d days"),Math.abs(diff));}}}
activity.label_delay=toDisplay;});return activities;};var setFileUploadID=function(activities){_.each(activities,function(activity){if(activity.activity_category==='upload_file'){activity.fileuploadID=_.uniqueId('o_fileupload');}});return activities;};var BasicActivity=AbstractField.extend({events:{'click .o_edit_activity':'_onEditActivity','change input.o_input_file':'_onFileChanged','click .o_mark_as_done':'_onMarkActivityDone','click .o_mark_as_done_upload_file':'_onMarkActivityDoneUploadFile','click .o_activity_template_preview':'_onPreviewMailTemplate','click .o_schedule_activity':'_onScheduleActivity','click .o_activity_template_send':'_onSendMailTemplate','click .o_unlink_activity':'_onUnlinkActivity',},init:function(){this._super.apply(this,arguments);this._draftFeedback={};},scheduleActivity:function(){var callback=this._reload.bind(this,{activity:true,thread:true});return this._openActivityForm(false,callback);},_markActivityDone:function(params){var activityID=params.activityID;var feedback=params.feedback||false;var attachmentIds=params.attachmentIds||[];return this._sendActivityFeedback(activityID,feedback,attachmentIds).then(this._reload.bind(this,{activity:true,thread:true}));},_markActivityDoneAndScheduleNext:function(params){var activityID=params.activityID;var feedback=params.feedback;var self=this;this._rpc({model:'mail.activity',method:'action_feedback_schedule_next',args:[[activityID]],kwargs:{feedback:feedback},context:this.record.getContext(),}).then(function(rslt_action){if(rslt_action){self.do_action(rslt_action,{on_close:function(){self.trigger_up('reload',{keepChanges:true});},});}else{self.trigger_up('reload',{keepChanges:true});}});},_openActivityForm:function(id,callback){var action={type:'ir.actions.act_window',name:_t("Schedule Activity"),res_model:'mail.activity',view_mode:'form',views:[[false,'form']],target:'new',context:{default_res_id:this.res_id,default_res_model:this.model,},res_id:id||false,};return this.do_action(action,{on_close:callback});},_sendActivityFeedback:function(activityID,feedback,attachmentIds){return this._rpc({model:'mail.activity',method:'action_feedback',args:[[activityID]],kwargs:{feedback:feedback,attachment_ids:attachmentIds||[],},context:this.record.getContext(),});},_bindOnUploadAction:function(activities){var self=this;_.each(activities,function(activity){if(activity.fileuploadID){$(window).on(activity.fileuploadID,function(){framework.unblockUI();var files=Array.prototype.slice.call(arguments,1);self._markActivityDone({activityID:activity.id,attachmentIds:_.pluck(files,'id')}).then(function(){self.trigger_up('reload',{keepChanges:true});});});}});},_bindPopoverFocusout:function($popover_el){var self=this;var $popover=$($popover_el.data("bs.popover").tip);var activityID=$popover_el.data('activity-id');$popover.off('focusout');$popover.focusout(function(e){if(!$popover.is(e.relatedTarget)&&!$popover.find(e.relatedTarget).length){self._draftFeedback[activityID]=$popover.find('#activity_feedback').val();$popover.popover('hide');}});},_onEditActivity:function(ev){ev.preventDefault();var activityID=$(ev.currentTarget).data('activity-id');return this._openActivityForm(activityID,this._reload.bind(this,{activity:true,thread:true}));},_onFileChanged:function(ev){ev.stopPropagation();ev.preventDefault();var $form=$(ev.currentTarget).closest('form');$form.submit();framework.blockUI();},_onMarkActivityDone:function(ev){ev.stopPropagation();ev.preventDefault();var self=this;var $markDoneBtn=$(ev.currentTarget);var activityID=$markDoneBtn.data('activity-id');var previousActivityTypeID=$markDoneBtn.data('previous-activity-type-id')||false;var forceNextActivity=$markDoneBtn.data('force-next-activity');if($markDoneBtn.data('toggle')==='collapse'){var $actLi=$markDoneBtn.parents('.o_log_activity');var $panel=self.$('#o_activity_form_'+activityID);if(!$panel.data('bs.collapse')){var $form=$(QWeb.render('mail.activity_feedback_form',{previous_activity_type_id:previousActivityTypeID,force_next:forceNextActivity}));$panel.append($form);self._onMarkActivityDoneActions($markDoneBtn,$form,activityID);_.each($panel.siblings('.o_activity_form'),function(el){if($(el).data('bs.collapse')){$(el).empty().collapse('dispose').removeClass('show');}});$markDoneBtn.parents('.o_activity_log_container').scrollTo($actLi.position().top,100);}
$panel.on('hidden.bs.collapse',function(){if($panel.data('bs.collapse')){$actLi.removeClass('o_activity_selected');$panel.collapse('dispose');$panel.empty();}});this.$('.o_activity_selected').removeClass('o_activity_selected');$actLi.toggleClass('o_activity_selected');$panel.collapse('toggle');}else if(!$markDoneBtn.data('bs.popover')){$markDoneBtn.popover({template:$(Popover.Default.template).addClass('o_mail_activity_feedback')[0].outerHTML,container:$markDoneBtn,title:_t("Feedback"),html:true,trigger:'manual',placement:'right',content:function(){var $popover=$(QWeb.render('mail.activity_feedback_form',{previous_activity_type_id:previousActivityTypeID,force_next:forceNextActivity}));self._onMarkActivityDoneActions($markDoneBtn,$popover,activityID);return $popover;},}).on('shown.bs.popover',function(){var $popover=$($(this).data("bs.popover").tip);$(".o_mail_activity_feedback.popover").not($popover).popover("hide");$popover.addClass('o_mail_activity_feedback').attr('tabindex',0);$popover.find('#activity_feedback').focus();self._bindPopoverFocusout($(this));}).popover('show');}else{var popover=$markDoneBtn.data('bs.popover');if($('#'+popover.tip.id).length===0){popover.show();}}},_onMarkActivityDoneActions:function($btn,$form,activityID){var self=this;$form.find('#activity_feedback').val(self._draftFeedback[activityID]);$form.on('click','.o_activity_popover_done',function(ev){ev.stopPropagation();self._markActivityDone({activityID:activityID,feedback:$form.find('#activity_feedback').val(),});});$form.on('click','.o_activity_popover_done_next',function(ev){ev.stopPropagation();self._markActivityDoneAndScheduleNext({activityID:activityID,feedback:$form.find('#activity_feedback').val(),});});$form.on('click','.o_activity_popover_discard',function(ev){ev.stopPropagation();if($btn.data('bs.popover')){$btn.popover('hide');}else if($btn.data('toggle')==='collapse'){self.$('#o_activity_form_'+activityID).collapse('hide');}});},_onMarkActivityDoneUploadFile:function(ev){ev.preventDefault();ev.stopPropagation();var fileuploadID=$(ev.currentTarget).data('fileupload-id');var $input=this.$("[target='"+fileuploadID+"'] > input.o_input_file");$input.click();},_onPreviewMailTemplate:function(ev){ev.stopPropagation();ev.preventDefault();var self=this;var templateID=$(ev.currentTarget).data('template-id');var action={name:_t('Compose Email'),type:'ir.actions.act_window',res_model:'mail.compose.message',views:[[false,'form']],target:'new',context:{default_res_id:this.res_id,default_model:this.model,default_use_template:true,default_template_id:templateID,force_email:true,},};return this.do_action(action,{on_close:function(){self.trigger_up('reload',{keepChanges:true});}});},_onSendMailTemplate:function(ev){ev.stopPropagation();ev.preventDefault();var templateID=$(ev.currentTarget).data('template-id');return this._rpc({model:this.model,method:'activity_send_mail',args:[[this.res_id],templateID],}).then(this._reload.bind(this,{activity:true,thread:true,followers:true}));},_onScheduleActivity:function(ev){ev.preventDefault();return this._openActivityForm(false,this._reload.bind(this));},_onUnlinkActivity:function(ev,options){ev.preventDefault();var activityID=$(ev.currentTarget).data('activity-id');options=_.defaults(options||{},{model:'mail.activity',args:[[activityID]],});return this._rpc({model:options.model,method:'unlink',args:options.args,}).then(this._reload.bind(this,{activity:true}));},_unbindOnUploadAction:function(activities){_.each(activities,function(activity){if(activity.fileuploadID){$(window).off(activity.fileuploadID);}});},});var Activity=BasicActivity.extend({className:'o_mail_activity',events:_.extend({},BasicActivity.prototype.events,{'click a':'_onClickRedirect',}),specialData:'_fetchSpecialActivity',init:function(){this._super.apply(this,arguments);this._activities=this.record.specialData[this.name];},destroy:function(){this._unbindOnUploadAction();return this._super.apply(this,arguments);},_reload:function(fieldsToReload){this.trigger_up('reload_mail_fields',fieldsToReload);},_render:function(){_.each(this._activities,function(activity){var note=mailUtils.parseAndTransform(activity.note||'',mailUtils.inline);var is_blank=(/^\s*$/).test(note);if(!is_blank){activity.note=mailUtils.parseAndTransform(activity.note,mailUtils.addLink);}else{activity.note='';}});var activities=setFileUploadID(setDelayLabel(this._activities));if(activities.length){var nbActivities=_.countBy(activities,'state');this.$el.html(QWeb.render('mail.activity_items',{uid:session.uid,activities:activities,nbPlannedActivities:nbActivities.planned,nbTodayActivities:nbActivities.today,nbOverdueActivities:nbActivities.overdue,dateFormat:time.getLangDateFormat(),datetimeFormat:time.getLangDatetimeFormat(),session:session,widget:this,}));this._bindOnUploadAction(this._activities);}else{this._unbindOnUploadAction(this._activities);this.$el.empty();}},_reset:function(record){this._super.apply(this,arguments);this._activities=this.record.specialData[this.name];this.res_id=record.res_id;},_onClickRedirect:function(ev){var id=$(ev.currentTarget).data('oe-id');if(id){ev.preventDefault();var model=$(ev.currentTarget).data('oe-model');this.trigger_up('redirect',{res_id:id,res_model:model,});}},});var KanbanActivity=BasicActivity.extend({template:'mail.KanbanActivity',events:_.extend({},BasicActivity.prototype.events,{'show.bs.dropdown':'_onDropdownShow',}),fieldDependencies:_.extend({},BasicActivity.prototype.fieldDependencies,{activity_exception_decoration:{type:'selection'},activity_exception_icon:{type:'char'},activity_state:{type:'selection'},}),init:function(parent,name,record){this._super.apply(this,arguments);var selection={};_.each(record.fields.activity_state.selection,function(value){selection[value[0]]=value[1];});this.selection=selection;this._setState(record);},destroy:function(){this._unbindOnUploadAction();return this._super.apply(this,arguments);},_reload:function(){this.trigger_up('reload',{db_id:this.record_id,keepChanges:true});},_render:function(){const spanClasses=['fa','fa-lg','fa-fw'];spanClasses.push('o_activity_color_'+(this.activityState||'default'));if(this.recordData.activity_exception_decoration){spanClasses.push('text-'+this.recordData.activity_exception_decoration);spanClasses.push(this.recordData.activity_exception_icon);}else{spanClasses.push('fa-clock-o');}
this.$('.o_activity_btn > span').removeClass().addClass(spanClasses.join(' '));if(this.$el.hasClass('show')){this._renderDropdown();}},_renderDropdown:function(){var self=this;this.$('.o_activity').toggleClass('dropdown-menu-right',config.device.isMobile).html(QWeb.render('mail.KanbanActivityLoading'));return _readActivities(this,this.value.res_ids).then(function(activities){activities=setFileUploadID(activities);self.$('.o_activity').html(QWeb.render('mail.KanbanActivityDropdown',{selection:self.selection,records:_.groupBy(setDelayLabel(activities),'state'),session:session,widget:self,}));self._bindOnUploadAction(activities);});},_reset:function(record){this._super.apply(this,arguments);this._setState(record);},_setState:function(record){this.record_id=record.id;this.activityState=this.recordData.activity_state;},_onDropdownShow:function(){this._renderDropdown();},});const ListActivity=KanbanActivity.extend({template:'mail.ListActivity',events:Object.assign({},KanbanActivity.prototype.events,{'click .dropdown-menu.o_activity':'_onDropdownClicked',}),fieldDependencies:_.extend({},KanbanActivity.prototype.fieldDependencies,{activity_summary:{type:'char'},activity_type_id:{type:'many2one',relation:'mail.activity.type'},activity_type_icon:{type:'char'},}),label:_lt('Next Activity'),_render:async function(){await this._super(...arguments);this.$('.o_activity_btn > span').prop('special_click',true);if(this.value.count){let text;if(this.recordData.activity_exception_decoration){text=_t('Warning');}else{text=this.recordData.activity_summary||this.recordData.activity_type_id.data.display_name;}
this.$('.o_activity_summary').text(text);}
if(this.recordData.activity_type_icon){this.el.querySelector('.o_activity_btn > span').classList.replace('fa-clock-o',this.recordData.activity_type_icon);}},_onDropdownClicked:function(ev){ev.stopPropagation();},});var ActivityException=AbstractField.extend({noLabel:true,fieldDependencies:_.extend({},AbstractField.prototype.fieldDependencies,{activity_exception_icon:{type:'char'}}),_renderEdit:function(){return this._renderReadonly();},_renderReadonly:function(){this.$el.empty();if(this.value){this.$el.attr({title:_t('This record has an exception activity.'),class:"pull-right mt-1 text-"+this.value+" fa "+this.recordData.activity_exception_icon});}}});field_registry.add('kanban_activity',KanbanActivity).add('list_activity',ListActivity).add('activity_exception',ActivityException);return Activity;});;

/* /mail/static/src/js/views/activity/activity_view.js defined in bundle 'web.assets_backend' */
odoo.define('mail.ActivityView',function(require){"use strict";const ActivityController=require('mail.ActivityController');const ActivityModel=require('mail.ActivityModel');const ActivityRenderer=require('mail.ActivityRenderer');const BasicView=require('web.BasicView');const core=require('web.core');const RendererWrapper=require('web.RendererWrapper');const view_registry=require('web.view_registry');const _lt=core._lt;const ActivityView=BasicView.extend({accesskey:"a",display_name:_lt('Activity'),icon:'fa-clock-o',config:_.extend({},BasicView.prototype.config,{Controller:ActivityController,Model:ActivityModel,Renderer:ActivityRenderer,}),viewType:'activity',searchMenuTypes:['filter','favorite'],init:function(){this._super.apply(this,arguments);this.loadParams.type='list';this.loadParams.limit=false;this.rendererParams.templates=_.findWhere(this.arch.children,{'tag':'templates'});this.controllerParams.title=this.arch.attrs.string;},getRenderer(parent,state){state=Object.assign({},state,this.rendererParams);return new RendererWrapper(null,this.config.Renderer,state);},});view_registry.add('activity',ActivityView);return ActivityView;});;

/* /mail/static/src/js/views/activity/activity_model.js defined in bundle 'web.assets_backend' */
odoo.define('mail.ActivityModel',function(require){'use strict';const BasicModel=require('web.BasicModel');const session=require('web.session');const ActivityModel=BasicModel.extend({__get:function(){var result=this._super.apply(this,arguments);if(result&&result.model===this.modelName&&result.type==='list'){_.extend(result,this.additionalData,{getKanbanActivityData:this.getKanbanActivityData});}
return result;},getKanbanActivityData(activityGroup,resId){return{data:{activity_ids:{model:'mail.activity',res_ids:activityGroup.ids,},activity_state:activityGroup.state,closest_deadline:activityGroup.o_closest_deadline,},fields:{activity_ids:{},activity_state:{selection:[['overdue',"Overdue"],['today',"Today"],['planned',"Planned"],],},},fieldsInfo:{},model:this.model,type:'record',res_id:resId,getContext:function(){return{};},};},__load:function(params){this.originalDomain=_.extend([],params.domain);params.domain.push(['activity_ids','!=',false]);this.domain=params.domain;this.modelName=params.modelName;params.groupedBy=[];var def=this._super.apply(this,arguments);return Promise.all([def,this._fetchData()]).then(function(result){return result[0];});},__reload:function(handle,params){if(params&&'domain'in params){this.originalDomain=_.extend([],params.domain);params.domain.push(['activity_ids','!=',false]);this.domain=params.domain;}
if(params&&'groupBy'in params){params.groupBy=[];}
var def=this._super.apply(this,arguments);return Promise.all([def,this._fetchData()]).then(function(result){return result[0];});},_fetchData:function(){var self=this;return this._rpc({model:"mail.activity",method:'get_activity_data',kwargs:{res_model:this.modelName,domain:this.domain,context:session.user_context,}}).then(function(result){self.additionalData=result;});},});return ActivityModel;});;

/* /mail/static/src/js/views/activity/activity_controller.js defined in bundle 'web.assets_backend' */
odoo.define('mail.ActivityController',function(require){"use strict";require('mail.Activity');var BasicController=require('web.BasicController');var core=require('web.core');var field_registry=require('web.field_registry');var ViewDialogs=require('web.view_dialogs');var KanbanActivity=field_registry.get('kanban_activity');var _t=core._t;var ActivityController=BasicController.extend({custom_events:_.extend({},BasicController.prototype.custom_events,{empty_cell_clicked:'_onEmptyCell',send_mail_template:'_onSendMailTemplate',schedule_activity:'_onScheduleActivity',}),init:function(parent,model,renderer,params){this._super.apply(this,arguments);this.title=params.title;},_getPagingInfo:function(){return null;},_onScheduleActivity:function(){var self=this;var state=this.model.get(this.handle);new ViewDialogs.SelectCreateDialog(this,{res_model:state.model,domain:this.model.originalDomain,title:_.str.sprintf(_t("Search: %s"),this.title),no_create:!this.activeActions.create,disable_multiple_selection:true,context:state.context,on_selected:function(record){var fakeRecord=state.getKanbanActivityData({},record[0]);var widget=new KanbanActivity(self,'activity_ids',fakeRecord,{});widget.scheduleActivity();},}).open();},_onEmptyCell:function(ev){var state=this.model.get(this.handle);this.do_action({type:'ir.actions.act_window',res_model:'mail.activity',view_mode:'form',view_type:'form',views:[[false,'form']],target:'new',context:{default_res_id:ev.data.resId,default_res_model:state.model,default_activity_type_id:ev.data.activityTypeId,},res_id:false,},{on_close:this.reload.bind(this),});},_onSendMailTemplate:function(ev){var templateID=ev.data.templateID;var activityTypeID=ev.data.activityTypeID;var state=this.model.get(this.handle);var groupedActivities=state.grouped_activities;var resIDS=[];Object.keys(groupedActivities).forEach(function(resID){var activityByType=groupedActivities[resID];var activity=activityByType[activityTypeID];if(activity){resIDS.push(parseInt(resID));}});this._rpc({model:this.model.modelName,method:'activity_send_mail',args:[resIDS,templateID],});},});return ActivityController;});;

/* /mail/static/src/js/views/activity/activity_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('mail.ActivityRenderer',function(require){"use strict";const AbstractRendererOwl=require('web.AbstractRendererOwl');const ActivityCell=require('mail.ActivityCell');const ActivityRecord=require('mail.ActivityRecord');const{ComponentAdapter}=require('web.OwlCompatibility');const core=require('web.core');const KanbanColumnProgressBar=require('web.KanbanColumnProgressBar');const patchMixin=require('web.patchMixin');const QWeb=require('web.QWeb');const session=require('web.session');const utils=require('web.utils');const _t=core._t;const{useState}=owl.hooks;class ActivityRecordAdapter extends ComponentAdapter{renderWidget(){_.invoke(_.pluck(this.widget.subWidgets,'$el'),'detach');this.widget._render();}
updateWidget(nextProps){const state=nextProps.widgetArgs[0];this.widget._setState(state);}}
class ActivityCellAdapter extends ComponentAdapter{renderWidget(){this.widget._render();}
updateWidget(nextProps){const record=nextProps.widgetArgs[1];this.widget._reset(record);}}
class KanbanColumnProgressBarAdapter extends ComponentAdapter{renderWidget(){this.widget._render();}
updateWidget(nextProps){const options=nextProps.widgetArgs[0];const columnState=nextProps.widgetArgs[1];const columnId=options.columnID;const nextActiveFilter=options.progressBarStates[columnId].activeFilter;this.widget.activeFilter=nextActiveFilter?this.widget.activeFilter:false;this.widget.columnState=columnState;this.widget.computeCounters();}
_trigger_up(ev){if(this.el){super._trigger_up(ev);}}}
class ActivityRenderer extends AbstractRendererOwl{constructor(parent,props){super(...arguments);this.qweb=new QWeb(this.env.isDebug(),{_s:session.origin});this.qweb.add_template(utils.json_node_to_xml(props.templates));this.activeFilter=useState({state:null,activityTypeId:null,resIds:[]});this.widgetComponents={ActivityRecord,ActivityCell,KanbanColumnProgressBar,};}
get activityResIds(){const copiedActivityResIds=Array.from(this.props.activity_res_ids)
return copiedActivityResIds.sort((a,b)=>this.activeFilter.resIds.includes(a)?-1:0);}
get activityTypeIds(){const activities=Object.values(this.props.grouped_activities);const activityIds=activities.flatMap(Object.keys);const uniqueIds=Array.from(new Set(activityIds));return uniqueIds.map(Number);}
getProgressBarOptions(typeId){return{columnID:typeId,progressBarStates:{[typeId]:{activeFilter:this.activeFilter.activityTypeId===typeId,},},};}
getProgressBarColumnState(typeId){const counts={planned:0,today:0,overdue:0};for(let activities of Object.values(this.props.grouped_activities)){if(typeId in activities){counts[activities[typeId].state]+=1;}}
return{count:Object.values(counts).reduce((x,y)=>x+y),fields:{activity_state:{type:'selection',selection:[['planned',_t('Planned')],['today',_t('Today')],['overdue',_t('Overdue')],],},},progressBarValues:{field:'activity_state',colors:{planned:'success',today:'warning',overdue:'danger'},counts:counts,},};}
_onEmptyCellClicked(ev){this.trigger('empty_cell_clicked',{resId:parseInt(ev.currentTarget.dataset.resId,10),activityTypeId:parseInt(ev.currentTarget.dataset.activityTypeId,10),});}
_onSendMailTemplateClicked(ev){this.trigger('send_mail_template',{activityTypeID:parseInt(ev.currentTarget.dataset.activityTypeId,10),templateID:parseInt(ev.currentTarget.dataset.templateId,10),});}
_onSetProgressBarState(ev){if(ev.detail.values.activeFilter){this.activeFilter.state=ev.detail.values.activeFilter;this.activeFilter.activityTypeId=ev.detail.columnID;this.activeFilter.resIds=Object.entries(this.props.grouped_activities).filter(([,resIds])=>ev.detail.columnID in resIds&&resIds[ev.detail.columnID].state===ev.detail.values.activeFilter).map(([key])=>parseInt(key));}else{this.activeFilter.state=null;this.activeFilter.activityTypeId=null;this.activeFilter.resIds=[];}}}
ActivityRenderer.components={ActivityRecordAdapter,ActivityCellAdapter,KanbanColumnProgressBarAdapter,};ActivityRenderer.template='mail.ActivityRenderer';return patchMixin(ActivityRenderer);});;

/* /mail/static/src/js/views/activity/activity_record.js defined in bundle 'web.assets_backend' */
odoo.define('mail.ActivityRecord',function(require){"use strict";var KanbanRecord=require('web.KanbanRecord');var ActivityRecord=KanbanRecord.extend({init:function(parent,state){this._super.apply(this,arguments);this.fieldsInfo=state.fieldsInfo.activity;},_render:function(){this.defs=[];this._replaceElement(this.qweb.render('activity-box',this.qweb_context));this.$el.on('click',this._onGlobalClick.bind(this));this.$el.addClass('o_activity_record');this._processFields();this._setupColor();return Promise.all(this.defs);},_setFieldDisplay:function($el,fieldName){this._super.apply(this,arguments);if(this.fieldsInfo[fieldName].muted){$el.addClass('text-muted');}},_setState:function(){this._super.apply(this,arguments);this.qweb_context={activity_image:this._getImageURL.bind(this),record:this.record,user_context:this.getSession().user_context,widget:this,};},});return ActivityRecord;});;

/* /mail/static/src/js/views/activity/activity_cell.js defined in bundle 'web.assets_backend' */
odoo.define("mail.ActivityCell",function(require){"use strict";require("mail.Activity");const field_registry=require('web.field_registry');const KanbanActivity=field_registry.get('kanban_activity');const ActivityCell=KanbanActivity.extend({_render(){const $date=$('<div class="o_closest_deadline">');const date=moment(this.record.data.closest_deadline).toDate();if(moment().year()===moment(date).year()){$date.text(date.toLocaleDateString(moment().locale(),{day:'numeric',month:'short'}));}else{$date.text(moment(date).format('ll'));}
this.$('a').html($date);if(this.record.data.activity_ids.res_ids.length>1){this.$('a').append($('<span>',{class:'badge badge-light badge-pill border-0 '+this.record.data.activity_state,text:this.record.data.activity_ids.res_ids.length,}));}
if(this.$el.hasClass('show')){this._renderDropdown();}}});return ActivityCell;});;

/* /mail/static/src/js/emojis.js defined in bundle 'web.assets_backend' */
odoo.define('mail.emojis',function(require){"use strict";var data={":)":"",":-)":"","=)":"",":]":"",":D":"",":-D":"","=D":"","xD":"","XD":"","x'D":"",";)":"",";-)":"","B)":"","8)":"","B-)":"","8-)":"",";p":"",";P":"",":p":"",":P":"",":-p":"",":-P":"","=P":"","xp":"","xP":"","o_o":"",":|":"",":-|":"",":/":"",":-/":"",":(":"",":@":"",":O":"",":-O":"",":o":"",":-o":"",":'o":"","3:(":"",">:(":"","3:)":"",">:)":"",":*":"",":-*":"","o:)":"",":'(":"",":'-(":"",":\"(":"","<3":"","&lt;3":"",":heart":"","</3":"","&lt;/3":"",":heart_eyes":"",":turban":"",":+1":"",":-1":"",":ok":"",":poop":"",":no_see":"",":no_hear":"",":no_speak":"",":bug":"",":kitten":"",":bear":"",":snail":"",":boar":"",":clover":"",":sunflower":"",":fire":"",":sun":"",":partly_sunny:":"",":rainbow":"",":cloud":"",":zap":"",":star":"",":cookie":"",":pizza":"",":hamburger":"",":fries":"",":cake":"",":cake_part":"",":coffee":"",":banana":"",":sushi":"",":rice_ball":"",":beer":"",":wine":"",":cocktail":"",":tropical":"",":beers":"",":ghost":"",":skull":"",":et":"",":alien":"",":party":"",":trophy":"",":key":"",":pin":"",":postal_horn":"",":music":"",":trumpet":"",":guitar":"",":run":"",":bike":"",":soccer":"",":football":"",":8ball":"",":clapper":"",":microphone":"",":cheese":"",};var emojiDict={};_.each(data,function(unicode,source){if(!emojiDict[unicode]){emojiDict[unicode]={sources:[source],unicode:unicode,description:source,};}else{emojiDict[unicode].sources.push(source);}});var emojis=_.values(emojiDict);return emojis;});;

/* /mail/static/src/js/emojis_mixin.js defined in bundle 'web.assets_backend' */
odoo.define('mail.emoji_mixin',function(require){"use strict";var emojis=require('mail.emojis');return{_onEmojiClick:function(ev){var unicode=ev.currentTarget.textContent.trim();var textInput=this._getTargetTextElement($(ev.currentTarget))[0];var selectionStart=textInput.selectionStart;textInput.value=textInput.value.slice(0,selectionStart)+unicode+textInput.value.slice(selectionStart);textInput.focus();textInput.setSelectionRange(selectionStart+unicode.length,selectionStart+unicode.length);},_formatText:function(message){message=this._htmlEscape(message);message=this._wrapEmojis(message);message=message.replace(/(?:\r\n|\r|\n)/g,'<br>');return message;},_htmlEscape:function(s){if(s==null){return'';}
return String(s).replace(/</g,'&lt;').replace(/>/g,'&gt;');},_wrapEmojis:function(message){emojis.forEach(function(emoji){message=message.replace(new RegExp(emoji.unicode.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'g'),'<span class="o_mail_emoji">'+emoji.unicode+'</span>');});return message;}};});;

/* /mail/static/src/js/field_emojis_common.js defined in bundle 'web.assets_backend' */
odoo.define('mail.field_emojis_common',function(require){"use strict";var basicFields=require('web.basic_fields');var core=require('web.core');var emojis=require('mail.emojis');var MailEmojisMixin=require('mail.emoji_mixin');var _onEmojiClickMixin=MailEmojisMixin._onEmojiClick;var QWeb=core.qweb;var FieldEmojiCommon={init:function(){this._super.apply(this,arguments);this._triggerOnchange=_.throttle(this._triggerOnchange,1000,{leading:false});this.emojis=emojis;},on_attach_callback:function(){this._attachEmojisDropdown();},_render:function(){this._super.apply(this,arguments);if(this.mode!=='edit'){this.$el.html(this._formatText(this.$el.text()));}},_onEmojiClick:function(){_onEmojiClickMixin.apply(this,arguments);this._isDirty=true;this.$input.trigger('change');},_onKeydown:function(){this._super.apply(this,arguments);if(this.nodeOptions.onchange_on_keydown){this._triggerOnchange();}},_getTargetTextElement(){return this.$el;},_triggerOnchange:function(){this.$input.trigger('change');},_attachEmojisDropdown:function(){if(!this.$emojisIcon){this.$emojisIcon=$(QWeb.render('mail.EmojisDropdown',{widget:this}));this.$emojisIcon.find('.o_mail_emoji').on('click',this._onEmojiClick.bind(this));if(this.$el.filter('span.o_field_translate').length){this.$emojisIcon.addClass('o_mail_emojis_dropdown_translation');}
if(this.$el.filter('textarea').length){this.$emojisIcon.addClass('o_mail_emojis_dropdown_textarea');}
this.$el.last().after(this.$emojisIcon);}
if(this.mode==='edit'){this.$emojisIcon.show();}else{this.$emojisIcon.hide();}}};return FieldEmojiCommon;});;

/* /mail/static/src/js/field_char_emojis.js defined in bundle 'web.assets_backend' */
odoo.define('mail.field_char_emojis',function(require){"use strict";var basicFields=require('web.basic_fields');var registry=require('web.field_registry');var FieldEmojiCommon=require('mail.field_emojis_common');var MailEmojisMixin=require('mail.emoji_mixin');var FieldCharEmojis=basicFields.FieldChar.extend(MailEmojisMixin,FieldEmojiCommon);registry.add('char_emojis',FieldCharEmojis);return FieldCharEmojis;});;

/* /mail/static/src/js/field_text_emojis.js defined in bundle 'web.assets_backend' */
odoo.define('mail.field_text_emojis',function(require){"use strict";var basicFields=require('web.basic_fields');var registry=require('web.field_registry');var FieldEmojiCommon=require('mail.field_emojis_common');var MailEmojisMixin=require('mail.emoji_mixin');var FieldTextEmojis=basicFields.FieldText.extend(MailEmojisMixin,FieldEmojiCommon);registry.add('text_emojis',FieldTextEmojis);return FieldTextEmojis;});;

/* /mail/static/src/bugfix/bugfix.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/bugfix/bugfix.js',function(require){'use strict';});odoo.define('mail/static/src/component_hooks/use_rendered_values/use_rendered_values.js',function(require){'use strict';const{Component}=owl;const{onMounted,onPatched}=owl.hooks;function useRenderedValues(selector){const component=Component.current;let renderedValues;let patchedValues;const __render=component.__render.bind(component);component.__render=function(){renderedValues=selector();return __render(...arguments);};onMounted(onUpdate);onPatched(onUpdate);function onUpdate(){patchedValues=renderedValues;}
return()=>patchedValues;}
return useRenderedValues;});odoo.define('mail/static/src/component_hooks/use_update/use_update.js',function(require){'use strict';const{Component}=owl;const{onMounted,onPatched}=owl.hooks;const executionQueue=[];function executeNextInQueue(){if(executionQueue.length===0){return;}
const{component,func}=executionQueue.shift();if(component.__owl__.status!==5){func();}
executeNextInQueue();}
async function addFunctionToQueue({component,func,priority}){const index=executionQueue.findIndex(item=>item.priority>priority);const item={component,func,priority};if(index===-1){executionQueue.push(item);}else{executionQueue.splice(index,0,item);}
await new Promise(resolve=>setTimeout(resolve));executeNextInQueue();}
function useUpdate({func,priority}){const component=Component.current;onMounted(onUpdate);onPatched(onUpdate);function onUpdate(){if(priority===undefined){func();return;}
addFunctionToQueue({component,func,priority});}}
return useUpdate;});odoo.define('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js',function(require){'use strict';const{Component}=owl;const{onPatched}=owl.hooks;function isEqual(a,b,compareDepth){const keys=Object.keys(a);if(Object.keys(b).length!==keys.length){return false;}
for(const key of keys){let depth;if(typeof compareDepth==='number'){depth=compareDepth;}else{depth=compareDepth[key]||0;}
if(depth===0&&a[key]!==b[key]){return false;}
if(depth!==0){let nextDepth;if(typeof depth==='number'){nextDepth=depth-1;}else{nextDepth=depth;}
if(!isEqual(a[key],b[key],nextDepth)){return false;}}}
return true;}
function useShouldUpdateBasedOnProps({compareDepth={}}={}){const component=Component.current;let forceRender=false;component.shouldUpdate=nextProps=>{if(forceRender){return true;}
const allNewProps=Object.assign({},nextProps);const defaultProps=component.constructor.defaultProps;for(const key in defaultProps){if(allNewProps[key]===undefined){allNewProps[key]=defaultProps[key];}}
forceRender=!isEqual(component.props,allNewProps,compareDepth);return forceRender;};onPatched(()=>forceRender=false);}
return useShouldUpdateBasedOnProps;});;

/* /mail/static/src/component_hooks/use_drag_visible_dropzone/use_drag_visible_dropzone.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/component_hooks/use_drag_visible_dropzone/use_drag_visible_dropzone.js',function(require){'use strict';const{useState,onMounted,onWillUnmount}=owl.hooks;function useDragVisibleDropZone(){const isVisible=useState({value:false});let dragCount=0;onMounted(()=>{document.addEventListener('dragenter',_onDragenterListener,true);document.addEventListener('dragleave',_onDragleaveListener,true);document.addEventListener('drop',_onDropListener,true);window.addEventListener('dragover',ev=>ev.preventDefault());window.addEventListener('drop',ev=>ev.preventDefault());});onWillUnmount(()=>{document.removeEventListener('dragenter',_onDragenterListener,true);document.removeEventListener('dragleave',_onDragleaveListener,true);document.removeEventListener('drop',_onDropListener,true);window.removeEventListener('dragover',ev=>ev.preventDefault());window.removeEventListener('drop',ev=>ev.preventDefault());});function _onDragenterListener(ev){if(dragCount===0&&ev.dataTransfer&&ev.dataTransfer.types.includes('Files')){isVisible.value=true;}
dragCount++;}
function _onDragleaveListener(ev){dragCount--;if(dragCount===0){isVisible.value=false;}}
function _onDropListener(ev){dragCount=0;isVisible.value=false;}
return isVisible;}
return useDragVisibleDropZone;});;

/* /mail/static/src/component_hooks/use_refs/use_refs.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/component_hooks/use_refs/use_refs.js',function(require){'use strict';const{Component}=owl;function useRefs(){const component=Component.current;return function(){return component.__owl__.refs||{};};}
return useRefs;});;

/* /mail/static/src/component_hooks/use_store/use_store.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/component_hooks/use_store/use_store.js',function(require){'use strict';function useStore(selector,options={}){const store=options.store||owl.Component.current.env.store;const hashFn=store.observer.revNumber.bind(store.observer);const isEqual=options.isEqual||((a,b)=>a===b);function proxyComparator(){let oldRevNumber;function compare(a,b){let ok=true;const newRevNumber=hashFn(b);if(a===b&&newRevNumber>0){ok=oldRevNumber===newRevNumber;}else{ok=isEqual(a,b);}
oldRevNumber=newRevNumber;return ok;}
return compare;}
function proxyComparatorDeep(compareDepth=0){const comparator=proxyComparator();const comparators={};function compare(a,b){if(a===b&&hashFn(b)>0){return comparator(a,b);}
let ok=true;const newKeys=Object.keys(b);if(!a||(Object.keys(a).length!==newKeys.length)){ok=false;}
for(const key of newKeys){let depth;if(typeof compareDepth==='number'){depth=compareDepth;}else{depth=compareDepth[key]||0;}
if(!(key in comparators)){if(depth>0){comparators[key]=proxyComparatorDeep(depth-1);}else{comparators[key]=proxyComparator();}}
if(!comparators[key](a?a[key]:a,b[key])){ok=false;}}
return ok;}
return compare;}
const extendedSelector=(state,props)=>selector(props);return owl.hooks.useStore(extendedSelector,Object.assign({},options,{isEqual:proxyComparatorDeep(options.compareDepth),}));}
return useStore;});;

/* /mail/static/src/components/activity/activity.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/activity/activity.js',function(require){'use strict';const components={ActivityMarkDonePopover:require('mail/static/src/components/activity_mark_done_popover/activity_mark_done_popover.js'),FileUploader:require('mail/static/src/components/file_uploader/file_uploader.js'),MailTemplate:require('mail/static/src/components/mail_template/mail_template.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{auto_str_to_date,getLangDateFormat,getLangDatetimeFormat,}=require('web.time');const{Component,useState}=owl;const{useRef}=owl.hooks;class Activity extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();this.state=useState({areDetailsVisible:false,});useStore(props=>{const activity=this.env.models['mail.activity'].get(props.activityLocalId);return{activity:activity?activity.__state:undefined,assigneeNameOrDisplayName:(activity&&activity.assignee&&activity.assignee.nameOrDisplayName),};});this._fileUploaderRef=useRef('fileUploader');}
get activity(){return this.env.models['mail.activity'].get(this.props.activityLocalId);}
get assignedUserText(){return _.str.sprintf(this.env._t("for %s"),this.activity.assignee.nameOrDisplayName);}
get delayLabel(){const today=moment().startOf('day');const momentDeadlineDate=moment(auto_str_to_date(this.activity.dateDeadline));const diff=momentDeadlineDate.diff(today,'days',true);if(diff===0){return this.env._t("Today:");}else if(diff===-1){return this.env._t("Yesterday:");}else if(diff<0){return _.str.sprintf(this.env._t("%d days overdue:"),Math.abs(diff));}else if(diff===1){return this.env._t("Tomorrow:");}else{return _.str.sprintf(this.env._t("Due in %d days:"),Math.abs(diff));}}
get formattedCreateDatetime(){const momentCreateDate=moment(auto_str_to_date(this.activity.dateCreate));const datetimeFormat=getLangDatetimeFormat();return momentCreateDate.format(datetimeFormat);}
get formattedDeadlineDate(){const momentDeadlineDate=moment(auto_str_to_date(this.activity.dateDeadline));const datetimeFormat=getLangDateFormat();return momentDeadlineDate.format(datetimeFormat);}
get MARK_DONE(){return this.env._t("Mark Done");}
get summary(){return _.str.sprintf(this.env._t("%s"),this.activity.summary);}
_onAttachmentCreated(ev){this.activity.markAsDone({attachments:[ev.detail.attachment]});}
_onClick(ev){if(ev.target.tagName==='A'&&ev.target.dataset.oeId&&ev.target.dataset.oeModel){this.env.messaging.openProfile({id:Number(ev.target.dataset.oeId),model:ev.target.dataset.oeModel,});ev.preventDefault();}}
async _onClickCancel(ev){ev.preventDefault();await this.activity.deleteServerRecord();this.trigger('reload',{keepChanges:true});}
_onClickDetailsButton(){this.state.areDetailsVisible=!this.state.areDetailsVisible;}
_onClickEdit(ev){this.activity.edit();}
_onClickUploadDocument(ev){this._fileUploaderRef.comp.openBrowserFileUploader();}}
Object.assign(Activity,{components,props:{activityLocalId:String,},template:'mail.Activity',});return Activity;});;

/* /mail/static/src/components/activity_box/activity_box.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/activity_box/activity_box.js',function(require){'use strict';const components={Activity:require('mail/static/src/components/activity/activity.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ActivityBox extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const chatter=this.env.models['mail.chatter'].get(props.chatterLocalId);const thread=chatter&&chatter.thread;return{chatter:chatter?chatter.__state:undefined,thread:thread&&thread.__state,};});}
get chatter(){return this.env.models['mail.chatter'].get(this.props.chatterLocalId);}
_onClickTitle(){this.chatter.toggleActivityBoxVisibility();}}
Object.assign(ActivityBox,{components,props:{chatterLocalId:String,},template:'mail.ActivityBox',});return ActivityBox;});;

/* /mail/static/src/components/activity_mark_done_popover/activity_mark_done_popover.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/activity_mark_done_popover/activity_mark_done_popover.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useRef}=owl.hooks;class ActivityMarkDonePopover extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const activity=this.env.models['mail.activity'].get(props.activityLocalId);return{activity:activity?activity.__state:undefined,};});this._feedbackTextareaRef=useRef('feedbackTextarea');}
mounted(){this._feedbackTextareaRef.el.focus();if(this.activity.feedbackBackup){this._feedbackTextareaRef.el.value=this.activity.feedbackBackup;}}
get activity(){return this.env.models['mail.activity'].get(this.props.activityLocalId);}
get DONE_AND_SCHEDULE_NEXT(){return this.env._t("Done & Schedule Next");}
_close(){this.trigger('o-popover-close');}
_onBlur(){this.activity.update({feedbackBackup:this._feedbackTextareaRef.el.value,});}
_onClickDiscard(){this._close();}
async _onClickDone(){await this.activity.markAsDone({feedback:this._feedbackTextareaRef.el.value,});this.trigger('reload',{keepChanges:true});}
_onClickDoneAndScheduleNext(){this.activity.markAsDoneAndScheduleNext({feedback:this._feedbackTextareaRef.el.value,});}
_onKeydown(ev){if(ev.key==='Escape'){this._close();}}}
Object.assign(ActivityMarkDonePopover,{props:{activityLocalId:String,},template:'mail.ActivityMarkDonePopover',});return ActivityMarkDonePopover;});;

/* /mail/static/src/components/attachment/attachment.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/attachment/attachment.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const components={AttachmentDeleteConfirmDialog:require('mail/static/src/components/attachment_delete_confirm_dialog/attachment_delete_confirm_dialog.js'),};const{Component,useState}=owl;class Attachment extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{attachmentLocalIds:1,},});useStore(props=>{const attachment=this.env.models['mail.attachment'].get(props.attachmentLocalId);return{attachment:attachment?attachment.__state:undefined,};});this.state=useState({hasDeleteConfirmDialog:false,});}
get attachment(){return this.env.models['mail.attachment'].get(this.props.attachmentLocalId);}
get attachmentUrl(){if(this.attachment.isTemporary){return'';}
return this.env.session.url('/web/content',{id:this.attachment.id,download:true,});}
get detailsMode(){if(this.props.detailsMode!=='auto'){return this.props.detailsMode;}
if(this.attachment.fileType!=='image'){return'card';}
return'hover';}
get imageStyle(){if(this.attachment.fileType!=='image'){return'';}
if(this.env.isQUnitTest){return'';}
let size;if(this.detailsMode==='card'){size='38x38';}else{if(this.props.imageSize==="large"){size='400x400';}else if(this.props.imageSize==="medium"){size='200x200';}else if(this.props.imageSize==="small"){size='100x100';}}
return`background-image:url(/web/image/${this.attachment.id}/${size}); background-size: auto;`;}
_onClickDownload(ev){ev.stopPropagation();window.location=`/web/content/ir.attachment/${this.attachment.id}/datas?download=true`;}
_onClickImage(ev){if(!this.attachment.isViewable){return;}
this.env.models['mail.attachment'].view({attachment:this.attachment,attachments:this.props.attachmentLocalIds.map(attachmentLocalId=>this.env.models['mail.attachment'].get(attachmentLocalId)),});}
_onClickUnlink(ev){ev.stopPropagation();if(!this.attachment){return;}
if(this.attachment.isLinkedToComposer){this.attachment.remove();this.trigger('o-attachment-removed',{attachmentLocalId:this.props.attachmentLocalId});}else{this.state.hasDeleteConfirmDialog=true;}}
_onDeleteConfirmDialogClosed(){this.state.hasDeleteConfirmDialog=false;}}
Object.assign(Attachment,{components,defaultProps:{attachmentLocalIds:[],detailsMode:'auto',imageSize:'medium',isDownloadable:false,isEditable:true,showExtension:true,showFilename:true,},props:{attachmentLocalId:String,attachmentLocalIds:{type:Array,element:String,},detailsMode:{type:String,validate:prop=>['auto','card','hover','none'].includes(prop),},imageSize:{type:String,validate:prop=>['small','medium','large'].includes(prop),},isDownloadable:Boolean,isEditable:Boolean,showExtension:Boolean,showFilename:Boolean,},template:'mail.Attachment',});return Attachment;});;

/* /mail/static/src/components/attachment_box/attachment_box.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/attachment_box/attachment_box.js',function(require){'use strict';const components={AttachmentList:require('mail/static/src/components/attachment_list/attachment_list.js'),DropZone:require('mail/static/src/components/drop_zone/drop_zone.js'),FileUploader:require('mail/static/src/components/file_uploader/file_uploader.js'),};const useDragVisibleDropZone=require('mail/static/src/component_hooks/use_drag_visible_dropzone/use_drag_visible_dropzone.js');const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useRef}=owl.hooks;class AttachmentBox extends Component{constructor(...args){super(...args);this.isDropZoneVisible=useDragVisibleDropZone();useShouldUpdateBasedOnProps();useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);return{thread,threadAllAttachments:thread?thread.allAttachments:[],threadId:thread&&thread.id,threadModel:thread&&thread.model,};},{compareDepth:{threadAllAttachments:1,},});this._fileUploaderRef=useRef('fileUploader');}
get newAttachmentExtraData(){return{originThread:[['link',this.thread]],};}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_onAttachmentCreated(ev){this.trigger('o-attachments-changed');}
_onAttachmentRemoved(ev){this.trigger('o-attachments-changed');}
_onClickAdd(ev){ev.preventDefault();ev.stopPropagation();this._fileUploaderRef.comp.openBrowserFileUploader();}
async _onDropZoneFilesDropped(ev){ev.stopPropagation();await this._fileUploaderRef.comp.uploadFiles(ev.detail.files);this.isDropZoneVisible.value=false;}}
Object.assign(AttachmentBox,{components,props:{threadLocalId:String,},template:'mail.AttachmentBox',});return AttachmentBox;});;

/* /mail/static/src/components/attachment_delete_confirm_dialog/attachment_delete_confirm_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/attachment_delete_confirm_dialog/attachment_delete_confirm_dialog.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const components={Dialog:require('web.OwlDialog'),};const{Component}=owl;const{useRef}=owl.hooks;class AttachmentDeleteConfirmDialog extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const attachment=this.env.models['mail.attachment'].get(props.attachmentLocalId);return{attachment:attachment?attachment.__state:undefined,};});this._dialogRef=useRef('dialog');}
get attachment(){return this.env.models['mail.attachment'].get(this.props.attachmentLocalId);}
getBody(){return _.str.sprintf(this.env._t(`Do you really want to delete "%s"?`),owl.utils.escape(this.attachment.displayName));}
getTitle(){return this.env._t("Confirmation");}
_onClickCancel(){this._dialogRef.comp._close();}
_onClickOk(){this._dialogRef.comp._close();this.attachment.remove();this.trigger('o-attachment-removed',{attachmentLocalId:this.props.attachmentLocalId});}}
Object.assign(AttachmentDeleteConfirmDialog,{components,props:{attachmentLocalId:String,},template:'mail.AttachmentDeleteConfirmDialog',});return AttachmentDeleteConfirmDialog;});;

/* /mail/static/src/components/attachment_list/attachment_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/attachment_list/attachment_list.js',function(require){'use strict';const components={Attachment:require('mail/static/src/components/attachment/attachment.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class AttachmentList extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{attachmentLocalIds:1,},});useStore(props=>{const attachments=this.env.models['mail.attachment'].all().filter(attachment=>props.attachmentLocalIds.includes(attachment.localId));return{attachments:attachments?attachments.map(attachment=>attachment.__state):undefined,};},{compareDepth:{attachments:1,},});}
get attachments(){return this.env.models['mail.attachment'].all().filter(attachment=>this.props.attachmentLocalIds.includes(attachment.localId));}
get imageAttachments(){return this.attachments.filter(attachment=>attachment.fileType==='image');}
get nonImageAttachments(){return this.attachments.filter(attachment=>attachment.fileType!=='image');}
get viewableAttachments(){return this.attachments.filter(attachment=>attachment.isViewable);}}
Object.assign(AttachmentList,{components,defaultProps:{attachmentLocalIds:[],},props:{areAttachmentsDownloadable:{type:Boolean,optional:true,},areAttachmentsEditable:{type:Boolean,optional:true,},attachmentLocalIds:{type:Array,element:String,},attachmentsDetailsMode:{type:String,optional:true,validate:prop=>['auto','card','hover','none'].includes(prop),},attachmentsImageSize:{type:String,optional:true,validate:prop=>['small','medium','large'].includes(prop),},showAttachmentsExtensions:{type:Boolean,optional:true,},showAttachmentsFilenames:{type:Boolean,optional:true,},},template:'mail.AttachmentList',});return AttachmentList;});;

/* /mail/static/src/components/attachment_viewer/attachment_viewer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/attachment_viewer/attachment_viewer.js',function(require){'use strict';const useRefs=require('mail/static/src/component_hooks/use_refs/use_refs.js');const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component,QWeb}=owl;const{useRef}=owl.hooks;const MIN_SCALE=0.5;const SCROLL_ZOOM_STEP=0.1;const ZOOM_STEP=0.5;class AttachmentViewer extends Component{constructor(...args){super(...args);this.MIN_SCALE=MIN_SCALE;useShouldUpdateBasedOnProps();useStore(props=>{const attachmentViewer=this.env.models['mail.attachment_viewer'].get(props.localId);return{attachment:attachmentViewer&&attachmentViewer.attachment?attachmentViewer.attachment.__state:undefined,attachments:attachmentViewer?attachmentViewer.attachments.map(attachment=>attachment.__state):[],attachmentViewer:attachmentViewer?attachmentViewer.__state:undefined,};});this._getRefs=useRefs();this._isDragging=false;this._zoomerRef=useRef('zoomer');this._translate={x:0,y:0,dx:0,dy:0};this._onClickGlobal=this._onClickGlobal.bind(this);}
mounted(){this.el.focus();this._handleImageLoad();document.addEventListener('click',this._onClickGlobal);}
patched(){this._handleImageLoad();}
willUnmount(){document.removeEventListener('click',this._onClickGlobal);}
get attachmentViewer(){return this.env.models['mail.attachment_viewer'].get(this.props.localId);}
get imageStyle(){const attachmentViewer=this.attachmentViewer;let style=`transform: `+`scale3d(${attachmentViewer.scale}, ${attachmentViewer.scale}, 1) `+`rotate(${attachmentViewer.angle}deg);`;if(attachmentViewer.angle%180!==0){style+=``+`max-height: ${window.innerWidth}px; `+`max-width: ${window.innerHeight}px;`;}else{style+=``+`max-height: 100%; `+`max-width: 100%;`;}
return style;}
isCloseable(){return!this._isDragging;}
_close(){this.attachmentViewer.close();}
_download(){const id=this.attachmentViewer.attachment.id;this.env.services.navigate(`/web/content/ir.attachment/${id}/datas`,{download:true});}
_handleImageLoad(){if(!this.attachmentViewer||!this.attachmentViewer.attachment){return;}
const refs=this._getRefs();const image=refs[`image_${this.attachmentViewer.attachment.id}`];if(this.attachmentViewer.attachment.fileType==='image'&&(!image||!image.complete)){this.attachmentViewer.update({isImageLoading:true});}}
_next(){const attachmentViewer=this.attachmentViewer;const index=attachmentViewer.attachments.findIndex(attachment=>attachment===attachmentViewer.attachment);const nextIndex=(index+1)%attachmentViewer.attachments.length;attachmentViewer.update({attachment:[['link',attachmentViewer.attachments[nextIndex]]],});}
_previous(){const attachmentViewer=this.attachmentViewer;const index=attachmentViewer.attachments.findIndex(attachment=>attachment===attachmentViewer.attachment);const nextIndex=index===0?attachmentViewer.attachments.length-1:index-1;attachmentViewer.update({attachment:[['link',attachmentViewer.attachments[nextIndex]]],});}
_print(){const printWindow=window.open('about:blank','_new');printWindow.document.open();printWindow.document.write(`
            <html>
                <head>
                    <script>
                        function onloadImage() {
                            setTimeout('printImage()', 10);
                        }
                        function printImage() {
                            window.print();
                            window.close();
                        }
                    </script>
                </head>
                <body onload='onloadImage()'>
                    <img src="${this.attachmentViewer.attachment.defaultSource}" alt=""/>
                </body>
            </html>`);printWindow.document.close();}
_rotate(){this.attachmentViewer.update({angle:this.attachmentViewer.angle+90});}
_stopDragging(){this._isDragging=false;this._translate.x+=this._translate.dx;this._translate.y+=this._translate.dy;this._translate.dx=0;this._translate.dy=0;this._updateZoomerStyle();}
_updateZoomerStyle(){const attachmentViewer=this.attachmentViewer;const refs=this._getRefs();const image=refs[`image_${this.attachmentViewer.attachment.id}`];const tx=image.offsetWidth*attachmentViewer.scale>this._zoomerRef.el.offsetWidth?this._translate.x+this._translate.dx:0;const ty=image.offsetHeight*attachmentViewer.scale>this._zoomerRef.el.offsetHeight?this._translate.y+this._translate.dy:0;if(tx===0){this._translate.x=0;}
if(ty===0){this._translate.y=0;}
this._zoomerRef.el.style=`transform: `+`translate(${tx}px, ${ty}px)`;}
_zoomIn({scroll=false}={}){this.attachmentViewer.update({scale:this.attachmentViewer.scale+(scroll?SCROLL_ZOOM_STEP:ZOOM_STEP),});this._updateZoomerStyle();}
_zoomOut({scroll=false}={}){if(this.attachmentViewer.scale===MIN_SCALE){return;}
const unflooredAdaptedScale=(this.attachmentViewer.scale-
(scroll?SCROLL_ZOOM_STEP:ZOOM_STEP));this.attachmentViewer.update({scale:Math.max(MIN_SCALE,unflooredAdaptedScale),});this._updateZoomerStyle();}
_zoomReset(){this.attachmentViewer.update({scale:1});this._updateZoomerStyle();}
_onClick(ev){if(this._isDragging){return;}
this._close();}
_onClickClose(ev){this._close();}
_onClickDownload(ev){ev.stopPropagation();this._download();}
_onClickGlobal(ev){if(!this._isDragging){return;}
ev.stopPropagation();this._stopDragging();}
_onClickHeader(ev){ev.stopPropagation();}
_onClickImage(ev){if(this._isDragging){return;}
ev.stopPropagation();}
_onClickNext(ev){ev.stopPropagation();this._next();}
_onClickPrevious(ev){ev.stopPropagation();this._previous();}
_onClickPrint(ev){ev.stopPropagation();this._print();}
_onClickRotate(ev){ev.stopPropagation();this._rotate();}
_onClickVideo(ev){ev.stopPropagation();}
_onClickZoomIn(ev){ev.stopPropagation();this._zoomIn();}
_onClickZoomOut(ev){ev.stopPropagation();this._zoomOut();}
_onClickZoomReset(ev){ev.stopPropagation();this._zoomReset();}
_onKeydown(ev){switch(ev.key){case'ArrowRight':this._next();break;case'ArrowLeft':this._previous();break;case'Escape':this._close();break;case'q':this._close();break;case'r':this._rotate();break;case'+':this._zoomIn();break;case'-':this._zoomOut();break;case'0':this._zoomReset();break;default:return;}
ev.stopPropagation();}
_onLoadImage(ev){ev.stopPropagation();this.attachmentViewer.update({isImageLoading:false});}
_onMousedownImage(ev){if(this._isDragging){return;}
if(ev.button!==0){return;}
ev.stopPropagation();this._isDragging=true;this._dragstartX=ev.clientX;this._dragstartY=ev.clientY;}
_onMousemoveView(ev){if(!this._isDragging){return;}
this._translate.dx=ev.clientX-this._dragstartX;this._translate.dy=ev.clientY-this._dragstartY;this._updateZoomerStyle();}
_onWheelImage(ev){ev.stopPropagation();if(!this.el){return;}
if(ev.deltaY>0){this._zoomOut({scroll:true});}else{this._zoomIn({scroll:true});}}}
Object.assign(AttachmentViewer,{props:{localId:String,},template:'mail.AttachmentViewer',});QWeb.registerComponent('AttachmentViewer',AttachmentViewer);return AttachmentViewer;});;

/* /mail/static/src/components/autocomplete_input/autocomplete_input.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/autocomplete_input/autocomplete_input.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const{Component}=owl;class AutocompleteInput extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();}
mounted(){if(this.props.isFocusOnMount){this.el.focus();}
let args={autoFocus:true,select:(ev,ui)=>this._onAutocompleteSelect(ev,ui),source:(req,res)=>this._onAutocompleteSource(req,res),focus:ev=>this._onAutocompleteFocus(ev),html:this.props.isHtml||false,};if(this.props.customClass){args.classes={'ui-autocomplete':this.props.customClass};}
const autoCompleteElem=$(this.el).autocomplete(args);autoCompleteElem.data("ui-autocomplete")._resizeMenu=function(){const ul=this.menu.element;ul.outerWidth(this.element.outerWidth());};}
willUnmount(){$(this.el).autocomplete('destroy');}
contains(node){if(this.el.contains(node)){return true;}
if(!this.props.customClass){return false;}
const element=document.querySelector(`.${this.props.customClass}`);if(!element){return false;}
return element.contains(node);}
focus(){if(!this.el){return;}
this.el.focus();}
focusout(){if(!this.el){return;}
this.el.blur();}
_onAutocompleteFocus(ev){if(this.props.focus){this.props.focus(ev);}else{ev.preventDefault();}}
_onAutocompleteSelect(ev,ui){if(this.props.select){this.props.select(ev,ui);}}
_onAutocompleteSource(req,res){if(this.props.source){this.props.source(req,res);}}
_onBlur(ev){this.trigger('o-hide');}
_onKeydown(ev){if(ev.key==='Escape'){this.trigger('o-hide');}}}
Object.assign(AutocompleteInput,{defaultProps:{isFocusOnMount:false,isHtml:false,placeholder:'',},props:{customClass:{type:String,optional:true,},focus:{type:Function,optional:true,},isFocusOnMount:Boolean,isHtml:Boolean,placeholder:String,select:{type:Function,optional:true,},source:{type:Function,optional:true,},},template:'mail.AutocompleteInput',});return AutocompleteInput;});;

/* /mail/static/src/components/chat_window/chat_window.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chat_window/chat_window.js',function(require){'use strict';const components={AutocompleteInput:require('mail/static/src/components/autocomplete_input/autocomplete_input.js'),ChatWindowHeader:require('mail/static/src/components/chat_window_header/chat_window_header.js'),ThreadView:require('mail/static/src/components/thread_view/thread_view.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{isEventHandled}=require('mail/static/src/utils/utils.js');const patchMixin=require('web.patchMixin');const{Component}=owl;const{useRef}=owl.hooks;class ChatWindow extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const chatWindow=this.env.models['mail.chat_window'].get(props.chatWindowLocalId);const thread=chatWindow?chatWindow.thread:undefined;return{chatWindow,chatWindowHasNewMessageForm:chatWindow&&chatWindow.hasNewMessageForm,chatWindowIsDoFocus:chatWindow&&chatWindow.isDoFocus,chatWindowIsFocused:chatWindow&&chatWindow.isFocused,chatWindowIsFolded:chatWindow&&chatWindow.isFolded,chatWindowThreadView:chatWindow&&chatWindow.threadView,chatWindowVisibleIndex:chatWindow&&chatWindow.visibleIndex,chatWindowVisibleOffset:chatWindow&&chatWindow.visibleOffset,isDeviceMobile:this.env.messaging.device.isMobile,localeTextDirection:this.env.messaging.locale.textDirection,thread,threadMassMailing:thread&&thread.mass_mailing,threadModel:thread&&thread.model,};});useUpdate({func:()=>this._update()});this._chatWindowHeaderRef=useRef('header');this._inputRef=useRef('input');this._threadRef=useRef('thread');this._onWillHideHomeMenu=this._onWillHideHomeMenu.bind(this);this._onWillShowHomeMenu=this._onWillShowHomeMenu.bind(this);this._onAutocompleteSelect=this._onAutocompleteSelect.bind(this);this._onAutocompleteSource=this._onAutocompleteSource.bind(this);this._constructor(...args);}
_constructor(){}
mounted(){this.env.messagingBus.on('will_hide_home_menu',this,this._onWillHideHomeMenu);this.env.messagingBus.on('will_show_home_menu',this,this._onWillShowHomeMenu);}
willUnmount(){this.env.messagingBus.off('will_hide_home_menu',this,this._onWillHideHomeMenu);this.env.messagingBus.off('will_show_home_menu',this,this._onWillShowHomeMenu);}
get chatWindow(){return this.env.models['mail.chat_window'].get(this.props.chatWindowLocalId);}
get newMessageFormInputPlaceholder(){return this.env._t("Search user...");}
_applyVisibleOffset(){const textDirection=this.env.messaging.locale.textDirection;const offsetFrom=textDirection==='rtl'?'left':'right';const oppositeFrom=offsetFrom==='right'?'left':'right';this.el.style[offsetFrom]=this.chatWindow.visibleOffset+'px';this.el.style[oppositeFrom]='auto';}
_focus(){this.chatWindow.update({isDoFocus:false,isFocused:true,});if(this._inputRef.comp){this._inputRef.comp.focus();}
if(this._threadRef.comp){this._threadRef.comp.focus();}}
_saveThreadScrollTop(){if(!this._threadRef.comp||!this.chatWindow.threadViewer||!this.chatWindow.threadViewer.threadView){return;}
if(this.chatWindow.threadViewer.threadView.componentHintList.length>0){return;}
this.chatWindow.threadViewer.saveThreadCacheScrollHeightAsInitial(this._threadRef.comp.getScrollHeight());this.chatWindow.threadViewer.saveThreadCacheScrollPositionsAsInitial(this._threadRef.comp.getScrollTop());}
_update(){if(!this.chatWindow){return;}
if(this.chatWindow.isDoFocus){this._focus();}
this._applyVisibleOffset();}
async _onAutocompleteSelect(ev,ui){const chat=await this.env.messaging.getChat({partnerId:ui.item.id});if(!chat){return;}
this.env.messaging.chatWindowManager.openThread(chat,{makeActive:true,replaceNewMessage:true,});}
_onAutocompleteSource(req,res){this.env.models['mail.partner'].imSearch({callback:(partners)=>{const suggestions=partners.map(partner=>{return{id:partner.id,value:partner.nameOrDisplayName,label:partner.nameOrDisplayName,};});res(_.sortBy(suggestions,'label'));},keyword:_.escape(req.term),limit:10,});}
_onClickedHeader(ev){ev.stopPropagation();if(this.env.messaging.device.isMobile){return;}
if(this.chatWindow.isFolded){this.chatWindow.unfold();this.chatWindow.focus();}else{this._saveThreadScrollTop();this.chatWindow.fold();}}
_onFocusinThread(ev){ev.stopPropagation();if(!this.chatWindow){return;}
this.chatWindow.update({isFocused:true});}
_onFocusout(){if(!this.chatWindow){return;}
this.chatWindow.update({isFocused:false});}
_onKeydown(ev){if(!this.chatWindow){return;}
switch(ev.key){case'Tab':ev.preventDefault();if(ev.shiftKey){this.chatWindow.focusPreviousVisibleUnfoldedChatWindow();}else{this.chatWindow.focusNextVisibleUnfoldedChatWindow();}
break;case'Escape':if(isEventHandled(ev,'ComposerTextInput.closeSuggestions')){break;}
if(isEventHandled(ev,'Composer.closeEmojisPopover')){break;}
ev.preventDefault();this.chatWindow.focusNextVisibleUnfoldedChatWindow();this.chatWindow.close();break;}}
async _onWillHideHomeMenu(){this._saveThreadScrollTop();}
async _onWillShowHomeMenu(){this._saveThreadScrollTop();}}
Object.assign(ChatWindow,{components,defaultProps:{hasCloseAsBackButton:false,isExpandable:false,isFullscreen:false,},props:{chatWindowLocalId:String,hasCloseAsBackButton:Boolean,isExpandable:Boolean,isFullscreen:Boolean,},template:'mail.ChatWindow',});return patchMixin(ChatWindow);});;

/* /mail/static/src/components/chat_window_header/chat_window_header.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chat_window_header/chat_window_header.js',function(require){'use strict';const components={ThreadIcon:require('mail/static/src/components/thread_icon/thread_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ChatWindowHeader extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const chatWindow=this.env.models['mail.chat_window'].get(props.chatWindowLocalId);const thread=chatWindow&&chatWindow.thread;return{chatWindow,chatWindowHasShiftLeft:chatWindow&&chatWindow.hasShiftLeft,chatWindowHasShiftRight:chatWindow&&chatWindow.hasShiftRight,chatWindowName:chatWindow&&chatWindow.name,isDeviceMobile:this.env.messaging.device.isMobile,thread,threadLocalMessageUnreadCounter:thread&&thread.localMessageUnreadCounter,threadMassMailing:thread&&thread.mass_mailing,threadModel:thread&&thread.model,};});}
get chatWindow(){return this.env.models['mail.chat_window'].get(this.props.chatWindowLocalId);}
_onClick(ev){const chatWindow=this.chatWindow;this.trigger('o-clicked',{chatWindow});}
_onClickClose(ev){ev.stopPropagation();if(!this.chatWindow){return;}
this.chatWindow.close();}
_onClickExpand(ev){ev.stopPropagation();this.chatWindow.expand();}
_onClickShiftLeft(ev){ev.stopPropagation();this.chatWindow.shiftLeft();}
_onClickShiftRight(ev){ev.stopPropagation();this.chatWindow.shiftRight();}}
Object.assign(ChatWindowHeader,{components,defaultProps:{hasCloseAsBackButton:false,isExpandable:false,},props:{chatWindowLocalId:String,hasCloseAsBackButton:Boolean,isExpandable:Boolean,},template:'mail.ChatWindowHeader',});return ChatWindowHeader;});;

/* /mail/static/src/components/chat_window_hidden_menu/chat_window_hidden_menu.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chat_window_hidden_menu/chat_window_hidden_menu.js',function(require){'use strict';const components={ChatWindowHeader:require('mail/static/src/components/chat_window_header/chat_window_header.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useRef}=owl.hooks;class ChatWindowHiddenMenu extends Component{constructor(...args){super(...args);useStore(props=>{const chatWindowManager=this.env.messaging.chatWindowManager;const device=this.env.messaging.device;const locale=this.env.messaging.locale;return{chatWindowManager:chatWindowManager?chatWindowManager.__state:undefined,device:device?device.__state:undefined,localeTextDirection:locale?locale.textDirection:undefined,};});this._onClickCaptureGlobal=this._onClickCaptureGlobal.bind(this);this._listRef=useRef('list');this._wasMenuOpen;}
mounted(){this._apply();document.addEventListener('click',this._onClickCaptureGlobal,true);}
patched(){this._apply();}
willUnmount(){document.removeEventListener('click',this._onClickCaptureGlobal,true);}
_apply(){this._applyListHeight();this._applyOffset();this._wasMenuOpen=this.env.messaging.chatWindowManager.isHiddenMenuOpen;}
_applyListHeight(){const device=this.env.messaging.device;const height=device.globalWindowInnerHeight/2;this._listRef.el.style['max-height']=`${height}px`;}
_applyOffset(){const textDirection=this.env.messaging.locale.textDirection;const offsetFrom=textDirection==='rtl'?'left':'right';const oppositeFrom=offsetFrom==='right'?'left':'right';const offset=this.env.messaging.chatWindowManager.visual.hidden.offset;this.el.style[offsetFrom]=`${offset}px`;this.el.style[oppositeFrom]='auto';}
_onClickCaptureGlobal(ev){if(this.el.contains(ev.target)){return;}
this.env.messaging.chatWindowManager.closeHiddenMenu();}
_onClickToggle(ev){if(this._wasMenuOpen){this.env.messaging.chatWindowManager.closeHiddenMenu();}else{this.env.messaging.chatWindowManager.openHiddenMenu();}}
_onClickedChatWindow(ev){const chatWindow=ev.detail.chatWindow;chatWindow.makeActive();this.env.messaging.chatWindowManager.closeHiddenMenu();}}
Object.assign(ChatWindowHiddenMenu,{components,props:{},template:'mail.ChatWindowHiddenMenu',});return ChatWindowHiddenMenu;});;

/* /mail/static/src/components/chat_window_manager/chat_window_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chat_window_manager/chat_window_manager.js',function(require){'use strict';const components={ChatWindow:require('mail/static/src/components/chat_window/chat_window.js'),ChatWindowHiddenMenu:require('mail/static/src/components/chat_window_hidden_menu/chat_window_hidden_menu.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ChatWindowManager extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const chatWindowManager=this.env.messaging&&this.env.messaging.chatWindowManager;const allOrderedVisible=chatWindowManager?chatWindowManager.allOrderedVisible:[];return{allOrderedVisible,allOrderedVisibleThread:allOrderedVisible.map(chatWindow=>chatWindow.thread),chatWindowManager,chatWindowManagerHasHiddenChatWindows:chatWindowManager&&chatWindowManager.hasHiddenChatWindows,isMessagingInitialized:this.env.isMessagingInitialized(),};},{compareDepth:{allOrderedVisible:1,allOrderedVisibleThread:1,},});}}
Object.assign(ChatWindowManager,{components,props:{},template:'mail.ChatWindowManager',});return ChatWindowManager;});;

/* /mail/static/src/components/chatter/chatter.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chatter/chatter.js',function(require){'use strict';const components={ActivityBox:require('mail/static/src/components/activity_box/activity_box.js'),AttachmentBox:require('mail/static/src/components/attachment_box/attachment_box.js'),ChatterTopbar:require('mail/static/src/components/chatter_topbar/chatter_topbar.js'),Composer:require('mail/static/src/components/composer/composer.js'),ThreadView:require('mail/static/src/components/thread_view/thread_view.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{Component}=owl;const{useRef}=owl.hooks;class Chatter extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const chatter=this.env.models['mail.chatter'].get(props.chatterLocalId);const thread=chatter?chatter.thread:undefined;let attachments=[];if(thread){attachments=thread.allAttachments;}
return{attachments:attachments.map(attachment=>attachment.__state),chatter:chatter?chatter.__state:undefined,composer:thread&&thread.composer,thread,threadActivitiesLength:thread&&thread.activities.length,};},{compareDepth:{attachments:1,},});useUpdate({func:()=>this._update()});this._composerRef=useRef('composer');this._scrollPanelRef=useRef('scrollPanel');this._threadRef=useRef('thread');this.getScrollableElement=this.getScrollableElement.bind(this);}
get chatter(){return this.env.models['mail.chatter'].get(this.props.chatterLocalId);}
getScrollableElement(){if(!this._scrollPanelRef.el){return;}
return this._scrollPanelRef.el;}
_notifyRendered(){this.trigger('o-chatter-rendered',{attachments:this.chatter.thread.allAttachments,thread:this.chatter.thread.localId,});}
_update(){if(!this.chatter){return;}
if(this.chatter.thread){this._notifyRendered();}
if(this.chatter.isDoFocus){this.chatter.update({isDoFocus:false});const composer=this._composerRef.comp;if(composer){composer.focus();}}}
_onComposerMessagePosted(){this.chatter.update({isComposerVisible:false});}
_onScrollPanelScroll(ev){if(!this._threadRef.comp){return;}
this._threadRef.comp.onScroll(ev);}}
Object.assign(Chatter,{components,props:{chatterLocalId:String,},template:'mail.Chatter',});return Chatter;});;

/* /mail/static/src/components/chatter_container/chatter_container.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chatter_container/chatter_container.js',function(require){'use strict';const components={Chatter:require('mail/static/src/components/chatter/chatter.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{clear}=require('mail/static/src/model/model_field_command.js');const{Component}=owl;class ChatterContainer extends Component{constructor(...args){super(...args);this.chatter=undefined;this._wasMessagingInitialized=false;useShouldUpdateBasedOnProps();useStore(props=>{const isMessagingInitialized=this.env.isMessagingInitialized();if(!this._wasMessagingInitialized&&isMessagingInitialized){this._wasMessagingInitialized=true;this._insertFromProps(props);}
return{chatter:this.chatter};});useUpdate({func:()=>this._update()});}
willUpdateProps(nextProps){if(this.env.isMessagingInitialized()){this._insertFromProps(nextProps);}
return super.willUpdateProps(...arguments);}
destroy(){super.destroy();if(this.chatter){this.chatter.delete();}}
_insertFromProps(props){const values=Object.assign({},props);if(values.threadId===undefined){values.threadId=clear();}
if(!this.chatter){this.chatter=this.env.models['mail.chatter'].create(values);}else{this.chatter.update(values);}}
_update(){if(this.chatter){this.chatter.refresh();}}}
Object.assign(ChatterContainer,{components,props:{hasActivities:{type:Boolean,optional:true,},hasExternalBorder:{type:Boolean,optional:true,},hasFollowers:{type:Boolean,optional:true,},hasMessageList:{type:Boolean,optional:true,},hasMessageListScrollAdjust:{type:Boolean,optional:true,},hasTopbarCloseButton:{type:Boolean,optional:true,},isAttachmentBoxVisibleInitially:{type:Boolean,optional:true,},threadId:{type:Number,optional:true,},threadModel:String,},template:'mail.ChatterContainer',});return ChatterContainer;});;

/* /mail/static/src/components/chatter_topbar/chatter_topbar.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/chatter_topbar/chatter_topbar.js',function(require){'use strict';const components={FollowButton:require('mail/static/src/components/follow_button/follow_button.js'),FollowerListMenu:require('mail/static/src/components/follower_list_menu/follower_list_menu.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ChatterTopbar extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const chatter=this.env.models['mail.chatter'].get(props.chatterLocalId);const thread=chatter?chatter.thread:undefined;const threadAttachments=thread?thread.allAttachments:[];return{areThreadAttachmentsLoaded:thread&&thread.areAttachmentsLoaded,chatter:chatter?chatter.__state:undefined,composerIsLog:chatter&&chatter.composer&&chatter.composer.isLog,threadAttachmentsAmount:threadAttachments.length,};});}
get chatter(){return this.env.models['mail.chatter'].get(this.props.chatterLocalId);}
_onClickAttachments(ev){this.chatter.update({isAttachmentBoxVisible:!this.chatter.isAttachmentBoxVisible,});}
_onClickClose(ev){this.trigger('o-close-chatter');}
_onClickLogNote(ev){if(!this.chatter.composer){return;}
if(this.chatter.isComposerVisible&&this.chatter.composer.isLog){this.chatter.update({isComposerVisible:false});}else{this.chatter.showLogNote();}}
_onClickScheduleActivity(ev){const action={type:'ir.actions.act_window',name:this.env._t("Schedule Activity"),res_model:'mail.activity',view_mode:'form',views:[[false,'form']],target:'new',context:{default_res_id:this.chatter.thread.id,default_res_model:this.chatter.thread.model,},res_id:false,};return this.env.bus.trigger('do-action',{action,options:{on_close:()=>{this.trigger('reload',{keepChanges:true});},},});}
_onClickSendMessage(ev){if(!this.chatter.composer){return;}
if(this.chatter.isComposerVisible&&!this.chatter.composer.isLog){this.chatter.update({isComposerVisible:false});}else{this.chatter.showSendMessage();}}}
Object.assign(ChatterTopbar,{components,props:{chatterLocalId:String,},template:'mail.ChatterTopbar',});return ChatterTopbar;});;

/* /mail/static/src/components/composer/composer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/composer/composer.js',function(require){'use strict';const components={AttachmentList:require('mail/static/src/components/attachment_list/attachment_list.js'),ComposerSuggestedRecipientList:require('mail/static/src/components/composer_suggested_recipient_list/composer_suggested_recipient_list.js'),DropZone:require('mail/static/src/components/drop_zone/drop_zone.js'),EmojisPopover:require('mail/static/src/components/emojis_popover/emojis_popover.js'),FileUploader:require('mail/static/src/components/file_uploader/file_uploader.js'),TextInput:require('mail/static/src/components/composer_text_input/composer_text_input.js'),ThreadTextualTypingStatus:require('mail/static/src/components/thread_textual_typing_status/thread_textual_typing_status.js'),};const useDragVisibleDropZone=require('mail/static/src/component_hooks/use_drag_visible_dropzone/use_drag_visible_dropzone.js');const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{isEventHandled,markEventHandled,}=require('mail/static/src/utils/utils.js');const{Component}=owl;const{useRef}=owl.hooks;class Composer extends Component{constructor(...args){super(...args);this.isDropZoneVisible=useDragVisibleDropZone();useShouldUpdateBasedOnProps({compareDepth:{textInputSendShortcuts:1,},});useStore(props=>{const composer=this.env.models['mail.composer'].get(props.composerLocalId);const thread=composer&&composer.thread;return{composer,composerAttachments:composer?composer.attachments:[],composerCanPostMessage:composer&&composer.canPostMessage,composerHasFocus:composer&&composer.hasFocus,composerIsLog:composer&&composer.isLog,composerSubjectContent:composer&&composer.subjectContent,isDeviceMobile:this.env.messaging.device.isMobile,thread,threadChannelType:thread&&thread.channel_type,threadDisplayName:thread&&thread.displayName,threadMassMailing:thread&&thread.mass_mailing,threadModel:thread&&thread.model,threadName:thread&&thread.name,};},{compareDepth:{composerAttachments:1,},});useUpdate({func:()=>this._update()});this._emojisPopoverRef=useRef('emojisPopover');this._fileUploaderRef=useRef('fileUploader');this._textInputRef=useRef('textInput');this._subjectRef=useRef('subject');this._onClickCaptureGlobal=this._onClickCaptureGlobal.bind(this);}
mounted(){document.addEventListener('click',this._onClickCaptureGlobal,true);}
willUnmount(){document.removeEventListener('click',this._onClickCaptureGlobal,true);}
get composer(){return this.env.models['mail.composer'].get(this.props.composerLocalId);}
contains(node){const emojisPopover=this._emojisPopoverRef.comp;if(emojisPopover&&emojisPopover.contains(node)){return true;}
return this.el.contains(node);}
get currentPartnerAvatar(){const avatar=this.env.messaging.currentUser?this.env.session.url('/web/image',{field:'image_128',id:this.env.messaging.currentUser.id,model:'res.users',}):'/web/static/src/img/user_menu_avatar.png';return avatar;}
focus(){if(this.env.messaging.device.isMobile){this.el.scrollIntoView();}
this._textInputRef.comp.focus();}
focusout(){this._textInputRef.comp.focusout();}
get hasFooter(){return(this.props.hasThreadTyping||this.composer.attachments.length>0||!this.props.isCompact);}
get hasHeader(){return((this.props.hasThreadName&&this.composer.thread)||(this.props.hasFollowers&&!this.composer.isLog));}
get newAttachmentExtraData(){return{composers:[['replace',this.composer]],};}
async _postMessage(){if(!this.composer.canPostMessage){if(this.composer.hasUploadingAttachment){this.env.services['notification'].notify({message:this.env._t("Please wait while the file is uploading."),type:'warning',});}
return;}
await this.composer.postMessage();this.trigger('o-message-posted');}
_update(){if(this.props.isDoFocus){this.focus();}
if(!this.composer){return;}
if(this._subjectRef.el){this._subjectRef.el.value=this.composer.subjectContent;}}
_onClickAddAttachment(){this._fileUploaderRef.comp.openBrowserFileUploader();if(!this.env.device.isMobile){this.focus();}}
_onClickCaptureGlobal(ev){if(this.contains(ev.target)){return;}
this.composer.discard();}
_onClickFullComposer(){this.composer.openFullComposer();}
_onClickDiscard(ev){this.composer.discard();}
_onClickSend(){this._postMessage();this.focus();}
_onComposerSuggestionClicked(){this.focus();}
_onComposerTextInputSendShortcut(){this._postMessage();}
async _onDropZoneFilesDropped(ev){ev.stopPropagation();await this._fileUploaderRef.comp.uploadFiles(ev.detail.files);this.isDropZoneVisible.value=false;}
_onEmojiSelection(ev){ev.stopPropagation();this._textInputRef.comp.saveStateInStore();this.composer.insertIntoTextInput(ev.detail.unicode);if(!this.env.device.isMobile){this.focus();}}
_onInputSubject(){this.composer.update({subjectContent:this._subjectRef.el.value});}
_onKeydown(ev){if(ev.key==='Escape'){if(isEventHandled(ev,'ComposerTextInput.closeSuggestions')){return;}
if(isEventHandled(ev,'Composer.closeEmojisPopover')){return;}
ev.preventDefault();this.composer.discard();}}
_onKeydownEmojiButton(ev){if(ev.key==='Escape'){if(this._emojisPopoverRef.comp){this._emojisPopoverRef.comp.close();this.focus();markEventHandled(ev,'Composer.closeEmojisPopover');}}}
async _onPasteTextInput(ev){if(!ev.clipboardData||!ev.clipboardData.files){return;}
await this._fileUploaderRef.comp.uploadFiles(ev.clipboardData.files);}}
Object.assign(Composer,{components,defaultProps:{hasCurrentPartnerAvatar:true,hasDiscardButton:false,hasFollowers:false,hasSendButton:true,hasThreadName:false,hasThreadTyping:false,isCompact:true,isDoFocus:false,isExpandable:false,},props:{attachmentsDetailsMode:{type:String,optional:true,},composerLocalId:String,hasCurrentPartnerAvatar:Boolean,hasDiscardButton:Boolean,hasFollowers:Boolean,hasMentionSuggestionsBelowPosition:{type:Boolean,optional:true,},hasSendButton:Boolean,hasThreadName:Boolean,hasThreadTyping:Boolean,isDoFocus:Boolean,showAttachmentsExtensions:{type:Boolean,optional:true,},showAttachmentsFilenames:{type:Boolean,optional:true,},isCompact:Boolean,isExpandable:Boolean,textInputSendShortcuts:{type:Array,element:String,optional:true,},},template:'mail.Composer',});return Composer;});;

/* /mail/static/src/components/composer_suggested_recipient/composer_suggested_recipient.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/composer_suggested_recipient/composer_suggested_recipient.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{FormViewDialog}=require('web.view_dialogs');const{ComponentAdapter}=require('web.OwlCompatibility');const{Component}=owl;const{useRef}=owl.hooks;class FormViewDialogComponentAdapter extends ComponentAdapter{renderWidget(){return this.willStart();}}
const components={FormViewDialogComponentAdapter,};class ComposerSuggestedRecipient extends Component{constructor(...args){super(...args);this.id=_.uniqueId('o_ComposerSuggestedRecipient_');useShouldUpdateBasedOnProps();useStore(props=>{const suggestedRecipientInfo=this.env.models['mail.suggested_recipient_info'].get(props.suggestedRecipientLocalId);const partner=suggestedRecipientInfo&&suggestedRecipientInfo.partner;return{partner:partner&&partner.__state,suggestedRecipientInfo:suggestedRecipientInfo&&suggestedRecipientInfo.__state,};});useUpdate({func:()=>this._update()});this.FormViewDialog=FormViewDialog;this._checkboxRef=useRef('checkbox');this._dialogRef=useRef('dialog');this._isDialogOpen=false;this._onDialogSaved=this._onDialogSaved.bind(this);}
get ADD_AS_RECIPIENT_AND_FOLLOWER_REASON(){if(!this.suggestedRecipientInfo){return undefined;}
return this.env._t(_.str.sprintf("Add as recipient and follower (reason: %s)",this.suggestedRecipientInfo.reason));}
get PLEASE_COMPLETE_CUSTOMER_S_INFORMATION(){return this.env._t("Please complete customer's information");}
get suggestedRecipientInfo(){return this.env.models['mail.suggested_recipient_info'].get(this.props.suggestedRecipientInfoLocalId);}
_update(){if(this._checkboxRef.el&&this.suggestedRecipientInfo){this._checkboxRef.el.checked=this.suggestedRecipientInfo.isSelected;}}
_onChangeCheckbox(){const isChecked=this._checkboxRef.el.checked;this.suggestedRecipientInfo.update({isSelected:isChecked});if(!this.suggestedRecipientInfo.partner){if(isChecked&&this._dialogRef&&!this._isDialogOpen){this._isDialogOpen=true;this._dialogRef.comp.widget.on('closed',this,()=>{this._isDialogOpen=false;});this._dialogRef.comp.widget.open();}}}
_onDialogSaved(){const thread=this.suggestedRecipientInfo&&this.suggestedRecipientInfo.thread;if(!thread){return;}
thread.fetchAndUpdateSuggestedRecipients();}}
Object.assign(ComposerSuggestedRecipient,{components,props:{suggestedRecipientInfoLocalId:String,},template:'mail.ComposerSuggestedRecipient',});return ComposerSuggestedRecipient;});;

/* /mail/static/src/components/composer_suggested_recipient_list/composer_suggested_recipient_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/composer_suggested_recipient_list/composer_suggested_recipient_list.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useState}=owl.hooks;const components={ComposerSuggestedRecipient:require('mail/static/src/components/composer_suggested_recipient/composer_suggested_recipient.js'),};class ComposerSuggestedRecipientList extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();this.state=useState({hasShowMoreButton:false,});useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);return{threadSuggestedRecipientInfoList:thread?thread.suggestedRecipientInfoList:[],};},{compareDepth:{threadSuggestedRecipientInfoList:1,},});}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_onClickShowLess(ev){this.state.hasShowMoreButton=false;}
_onClickShowMore(ev){this.state.hasShowMoreButton=true;}}
Object.assign(ComposerSuggestedRecipientList,{components,props:{threadLocalId:String,},template:'mail.ComposerSuggestedRecipientList',});return ComposerSuggestedRecipientList;});;

/* /mail/static/src/components/composer_suggestion/composer_suggestion.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/composer_suggestion/composer_suggestion.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const components={PartnerImStatusIcon:require('mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js'),};const{Component}=owl;class ComposerSuggestion extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const composer=this.env.models['mail.composer'].get(this.props.composerLocalId);const record=this.env.models[props.modelName].get(props.recordLocalId);return{composerHasToScrollToActiveSuggestion:composer&&composer.hasToScrollToActiveSuggestion,record:record?record.__state:undefined,};});useUpdate({func:()=>this._update()});}
get composer(){return this.env.models['mail.composer'].get(this.props.composerLocalId);}
get isCannedResponse(){return this.props.modelName==="mail.canned_response";}
get isChannel(){return this.props.modelName==="mail.thread";}
get isCommand(){return this.props.modelName==="mail.channel_command";}
get isPartner(){return this.props.modelName==="mail.partner";}
get record(){return this.env.models[this.props.modelName].get(this.props.recordLocalId);}
title(){if(this.isCannedResponse){return _.str.sprintf("%s: %s",this.record.source,this.record.substitution);}
if(this.isChannel){return this.record.name;}
if(this.isCommand){return _.str.sprintf("%s: %s",this.record.name,this.record.help);}
if(this.isPartner){if(this.record.email){return _.str.sprintf("%s (%s)",this.record.nameOrDisplayName,this.record.email);}
return this.record.nameOrDisplayName;}
return"";}
_update(){if(this.composer&&this.composer.hasToScrollToActiveSuggestion&&this.props.isActive){this.el.scrollIntoView({block:'center',});this.composer.update({hasToScrollToActiveSuggestion:false});}}
_onClick(ev){ev.preventDefault();this.composer.update({activeSuggestedRecord:[['link',this.record]]});this.composer.insertSuggestion();this.composer.closeSuggestions();this.trigger('o-composer-suggestion-clicked');}}
Object.assign(ComposerSuggestion,{components,defaultProps:{isActive:false,},props:{composerLocalId:String,isActive:Boolean,modelName:String,recordLocalId:String,},template:'mail.ComposerSuggestion',});return ComposerSuggestion;});;

/* /mail/static/src/components/composer_suggestion_list/composer_suggestion_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/composer_suggestion_list/composer_suggestion_list.js',function(require){'use strict';const components={ComposerSuggestion:require('mail/static/src/components/composer_suggestion/composer_suggestion.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ComposerSuggestionList extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const composer=this.env.models['mail.composer'].get(props.composerLocalId);const activeSuggestedRecord=composer?composer.activeSuggestedRecord:undefined;const extraSuggestedRecords=composer?composer.extraSuggestedRecords:[];const mainSuggestedRecords=composer?composer.mainSuggestedRecords:[];return{activeSuggestedRecord,composer,composerSuggestionModelName:composer&&composer.suggestionModelName,extraSuggestedRecords,mainSuggestedRecords,};},{compareDepth:{extraSuggestedRecords:1,mainSuggestedRecords:1,},});}
get composer(){return this.env.models['mail.composer'].get(this.props.composerLocalId);}}
Object.assign(ComposerSuggestionList,{components,defaultProps:{isBelow:false,},props:{composerLocalId:String,isBelow:Boolean,},template:'mail.ComposerSuggestionList',});return ComposerSuggestionList;});;

/* /mail/static/src/components/composer_text_input/composer_text_input.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/composer_text_input/composer_text_input.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const components={ComposerSuggestionList:require('mail/static/src/components/composer_suggestion_list/composer_suggestion_list.js'),};const{markEventHandled}=require('mail/static/src/utils/utils.js');const{Component}=owl;const{useRef}=owl.hooks;class ComposerTextInput extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{sendShortcuts:1,},});useStore(props=>{const composer=this.env.models['mail.composer'].get(props.composerLocalId);const thread=composer&&composer.thread;return{composerHasFocus:composer&&composer.hasFocus,composerHasSuggestions:composer&&composer.hasSuggestions,composerIsLog:composer&&composer.isLog,composerTextInputContent:composer&&composer.textInputContent,composerTextInputCursorEnd:composer&&composer.textInputCursorEnd,composerTextInputCursorStart:composer&&composer.textInputCursorStart,composerTextInputSelectionDirection:composer&&composer.textInputSelectionDirection,isDeviceMobile:this.env.messaging.device.isMobile,threadModel:thread&&thread.model,};});useUpdate({func:()=>this._update()});this._textareaLastInputValue="";this._textareaRef=useRef('textarea');this._mirroredTextareaRef=useRef('mirroredTextarea');}
get composer(){return this.env.models['mail.composer'].get(this.props.composerLocalId);}
get textareaPlaceholder(){if(!this.composer){return"";}
if(this.composer.thread&&this.composer.thread.model!=='mail.channel'){if(this.composer.isLog){return this.env._t("Log an internal note...");}
return this.env._t("Send a message to followers...");}
return this.env._t("Write something...");}
focus(){this._textareaRef.el.focus();}
focusout(){this.saveStateInStore();this._textareaRef.el.blur();}
saveStateInStore(){this.composer.update({textInputContent:this._getContent(),textInputCursorEnd:this._getSelectionEnd(),textInputCursorStart:this._getSelectionStart(),textInputSelectionDirection:this._textareaRef.el.selectionDirection,});}
_getContent(){return this._textareaRef.el.value;}
_getSelectionEnd(){return this._textareaRef.el.selectionEnd;}
_getSelectionStart(){return this._textareaRef.el.selectionStart;}
_isEmpty(){return this._getContent()==="";}
_update(){if(!this.composer){return;}
if(this.composer.isLastStateChangeProgrammatic){this._textareaRef.el.value=this.composer.textInputContent;if(this.composer.hasFocus){this._textareaRef.el.setSelectionRange(this.composer.textInputCursorStart,this.composer.textInputCursorEnd,this.composer.textInputSelectionDirection,);}
this.composer.update({isLastStateChangeProgrammatic:false});}
this._updateHeight();}
_updateHeight(){this._mirroredTextareaRef.el.value=this.composer.textInputContent;this._textareaRef.el.style.height=(this._mirroredTextareaRef.el.scrollHeight)+"px";}
_onClickTextarea(){this.saveStateInStore();}
_onFocusinTextarea(){this.composer.focus();this.trigger('o-focusin-composer');}
_onFocusoutTextarea(){this.saveStateInStore();this.composer.update({hasFocus:false});}
_onInputTextarea(){this.saveStateInStore();if(this._textareaLastInputValue!==this._textareaRef.el.value){this.composer.handleCurrentPartnerIsTyping();}
this._textareaLastInputValue=this._textareaRef.el.value;this._updateHeight();}
_onKeydownTextarea(ev){switch(ev.key){case'Escape':if(this.composer.hasSuggestions){ev.preventDefault();this.composer.closeSuggestions();markEventHandled(ev,'ComposerTextInput.closeSuggestions');}
break;case'ArrowUp':case'PageUp':case'ArrowDown':case'PageDown':case'Home':case'End':case'Tab':if(this.composer.hasSuggestions){ev.preventDefault();}
break;case'Enter':this._onKeydownTextareaEnter(ev);break;}}
_onKeydownTextareaEnter(ev){if(this.composer.hasSuggestions){ev.preventDefault();return;}
if(this.props.sendShortcuts.includes('ctrl-enter')&&!ev.altKey&&ev.ctrlKey&&!ev.metaKey&&!ev.shiftKey){this.trigger('o-composer-text-input-send-shortcut');ev.preventDefault();return;}
if(this.props.sendShortcuts.includes('enter')&&!ev.altKey&&!ev.ctrlKey&&!ev.metaKey&&!ev.shiftKey){this.trigger('o-composer-text-input-send-shortcut');ev.preventDefault();return;}
if(this.props.sendShortcuts.includes('meta-enter')&&!ev.altKey&&!ev.ctrlKey&&ev.metaKey&&!ev.shiftKey){this.trigger('o-composer-text-input-send-shortcut');ev.preventDefault();return;}}
_onKeyupTextarea(ev){switch(ev.key){case'Escape':break;case'Enter':if(this.composer.hasSuggestions){this.composer.insertSuggestion();this.composer.closeSuggestions();this.focus();}
break;case'ArrowUp':case'PageUp':if(this.composer.hasSuggestions){this.composer.setPreviousSuggestionActive();this.composer.update({hasToScrollToActiveSuggestion:true});}
break;case'ArrowDown':case'PageDown':if(this.composer.hasSuggestions){this.composer.setNextSuggestionActive();this.composer.update({hasToScrollToActiveSuggestion:true});}
break;case'Home':if(this.composer.hasSuggestions){this.composer.setFirstSuggestionActive();this.composer.update({hasToScrollToActiveSuggestion:true});}
break;case'End':if(this.composer.hasSuggestions){this.composer.setLastSuggestionActive();this.composer.update({hasToScrollToActiveSuggestion:true});}
break;case'Tab':if(this.composer.hasSuggestions){if(ev.shiftKey){this.composer.setPreviousSuggestionActive();this.composer.update({hasToScrollToActiveSuggestion:true});}else{this.composer.setNextSuggestionActive();this.composer.update({hasToScrollToActiveSuggestion:true});}}
break;case'Alt':case'AltGraph':case'CapsLock':case'Control':case'Fn':case'FnLock':case'Hyper':case'Meta':case'NumLock':case'ScrollLock':case'Shift':case'ShiftSuper':case'Symbol':case'SymbolLock':break;default:this.saveStateInStore();}}}
Object.assign(ComposerTextInput,{components,defaultProps:{hasMentionSuggestionsBelowPosition:false,sendShortcuts:[],},props:{composerLocalId:String,hasMentionSuggestionsBelowPosition:Boolean,isCompact:Boolean,sendShortcuts:{type:Array,element:String,validate:prop=>{for(const shortcut of prop){if(!['ctrl-enter','enter','meta-enter'].includes(shortcut)){return false;}}
return true;},},},template:'mail.ComposerTextInput',});return ComposerTextInput;});;

/* /mail/static/src/components/dialog/dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/dialog/dialog.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const patchMixin=require('web.patchMixin');const{Component}=owl;const{useRef}=owl.hooks;class Dialog extends Component{constructor(...args){super(...args);this._componentRef=useRef('component');this._onClickGlobal=this._onClickGlobal.bind(this);this._onKeydownDocument=this._onKeydownDocument.bind(this);useShouldUpdateBasedOnProps();useStore(props=>{const dialog=this.env.models['mail.dialog'].get(props.dialogLocalId);return{dialog:dialog?dialog.__state:undefined,};});this._constructor();}
_constructor(){}
mounted(){document.addEventListener('click',this._onClickGlobal,true);document.addEventListener('keydown',this._onKeydownDocument);}
willUnmount(){document.removeEventListener('click',this._onClickGlobal,true);document.removeEventListener('keydown',this._onKeydownDocument);}
get dialog(){return this.env.models['mail.dialog'].get(this.props.dialogLocalId);}
_onClick(ev){ev.stopPropagation();}
_onClickGlobal(ev){if(this._componentRef.el&&this._componentRef.el.contains(ev.target)){return;}
if(this._componentRef.comp&&this._componentRef.comp.isCloseable&&!this._componentRef.comp.isCloseable()){return;}
this.dialog.delete();}
_onKeydownDocument(ev){if(ev.key==='Escape'){this.dialog.delete();}}}
Object.assign(Dialog,{props:{dialogLocalId:String,},template:'mail.Dialog',});return patchMixin(Dialog);});;

/* /mail/static/src/components/dialog_manager/dialog_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/dialog_manager/dialog_manager.js',function(require){'use strict';const components={Dialog:require('mail/static/src/components/dialog/dialog.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class DialogManager extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const dialogManager=this.env.messaging&&this.env.messaging.dialogManager;return{dialogManager:dialogManager?dialogManager.__state:undefined,};});}
mounted(){this._checkDialogOpen();}
patched(){this._checkDialogOpen();}
_checkDialogOpen(){if(!this.env.messaging){return;}
if(this.env.messaging.dialogManager.dialogs.length>0){document.body.classList.add('modal-open');}else{document.body.classList.remove('modal-open');}}}
Object.assign(DialogManager,{components,props:{},template:'mail.DialogManager',});return DialogManager;});;

/* /mail/static/src/components/discuss/discuss.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/discuss/discuss.js',function(require){'use strict';const components={AutocompleteInput:require('mail/static/src/components/autocomplete_input/autocomplete_input.js'),Composer:require('mail/static/src/components/composer/composer.js'),DiscussMobileMailboxSelection:require('mail/static/src/components/discuss_mobile_mailbox_selection/discuss_mobile_mailbox_selection.js'),DiscussSidebar:require('mail/static/src/components/discuss_sidebar/discuss_sidebar.js'),MobileMessagingNavbar:require('mail/static/src/components/mobile_messaging_navbar/mobile_messaging_navbar.js'),ModerationDiscardDialog:require('mail/static/src/components/moderation_discard_dialog/moderation_discard_dialog.js'),ModerationRejectDialog:require('mail/static/src/components/moderation_reject_dialog/moderation_reject_dialog.js'),NotificationList:require('mail/static/src/components/notification_list/notification_list.js'),ThreadView:require('mail/static/src/components/thread_view/thread_view.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const patchMixin=require('web.patchMixin');const{Component}=owl;const{useRef}=owl.hooks;class Discuss extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore((...args)=>this._useStoreSelector(...args),{compareDepth:{checkedMessages:1,uncheckedMessages:1,},});this._updateLocalStoreProps();this._composerRef=useRef('composer');this._threadViewRef=useRef('threadView');this._onMobileAddItemHeaderInputSelect=this._onMobileAddItemHeaderInputSelect.bind(this);this._onMobileAddItemHeaderInputSource=this._onMobileAddItemHeaderInputSource.bind(this);}
mounted(){this.discuss.update({isOpen:true});if(this.discuss.thread){this.trigger('o-push-state-action-manager');}else if(this.env.isMessagingInitialized()){this.discuss.openInitThread();}
this._updateLocalStoreProps();}
patched(){this.trigger('o-update-control-panel');if(this.discuss.thread){this.trigger('o-push-state-action-manager');}
if(this.discuss.thread&&this.discuss.thread===this.env.messaging.inbox&&this.discuss.threadView&&this._lastThreadCache===this.discuss.threadView.threadCache.localId&&this._lastThreadCounter>0&&this.discuss.thread.counter===0){this.trigger('o-show-rainbow-man');}
this._activeThreadCache=this.discuss.threadView&&this.discuss.threadView.threadCache;this._updateLocalStoreProps();}
willUnmount(){if(this.discuss){this.discuss.close();}}
get addChannelInputPlaceholder(){return this.env._t("Create or search channel...");}
get addChatInputPlaceholder(){return this.env._t("Search user...");}
get discuss(){return this.env.messaging&&this.env.messaging.discuss;}
mobileNavbarTabs(){return[{icon:'fa fa-inbox',id:'mailbox',label:this.env._t("Mailboxes"),},{icon:'fa fa-user',id:'chat',label:this.env._t("Chat"),},{icon:'fa fa-users',id:'channel',label:this.env._t("Channel"),}];}
_updateLocalStoreProps(){this._lastThreadCache=(this.discuss.threadView&&this.discuss.threadView.threadCache&&this.discuss.threadView.threadCache.localId);this._lastThreadCounter=(this.discuss.thread&&this.discuss.thread.counter);}
_useStoreSelector(props){const discuss=this.env.messaging&&this.env.messaging.discuss;const thread=discuss&&discuss.thread;const threadView=discuss&&discuss.threadView;const replyingToMessage=discuss&&discuss.replyingToMessage;const replyingToMessageOriginThread=replyingToMessage&&replyingToMessage.originThread;const checkedMessages=threadView?threadView.checkedMessages:[];return{checkedMessages,checkedMessagesIsModeratedByCurrentPartner:checkedMessages&&checkedMessages.some(message=>message.isModeratedByCurrentPartner),discuss,discussActiveId:discuss&&discuss.activeId,discussActiveMobileNavbarTabId:discuss&&discuss.activeMobileNavbarTabId,discussHasModerationDiscardDialog:discuss&&discuss.hasModerationDiscardDialog,discussHasModerationRejectDialog:discuss&&discuss.hasModerationRejectDialog,discussIsAddingChannel:discuss&&discuss.isAddingChannel,discussIsAddingChat:discuss&&discuss.isAddingChat,discussIsDoFocus:discuss&&discuss.isDoFocus,discussReplyingToMessageOriginThreadComposer:replyingToMessageOriginThread&&replyingToMessageOriginThread.composer,inbox:this.env.messaging.inbox,isDeviceMobile:this.env.messaging&&this.env.messaging.device.isMobile,isMessagingInitialized:this.env.isMessagingInitialized(),replyingToMessage,starred:this.env.messaging.starred,thread,threadCache:threadView&&threadView.threadCache,threadChannelType:thread&&thread.channel_type,threadDisplayName:thread&&thread.displayName,threadCounter:thread&&thread.counter,threadModel:thread&&thread.model,threadPublic:thread&&thread.public,threadView,threadViewMessagesLength:threadView&&threadView.messages.length,uncheckedMessages:threadView?threadView.uncheckedMessages:[],};}
_onDialogClosedModerationDiscard(){this.discuss.update({hasModerationDiscardDialog:false});}
_onDialogClosedModerationReject(){this.discuss.update({hasModerationRejectDialog:false});}
_onFocusinComposer(ev){this.discuss.update({isDoFocus:false});}
_onHideMobileAddItemHeader(ev){ev.stopPropagation();this.discuss.clearIsAddingItem();}
_onMobileAddItemHeaderInputSelect(ev,ui){const discuss=this.discuss;if(discuss.isAddingChannel){discuss.handleAddChannelAutocompleteSelect(ev,ui);}else{discuss.handleAddChatAutocompleteSelect(ev,ui);}}
_onMobileAddItemHeaderInputSource(req,res){if(this.discuss.isAddingChannel){this.discuss.handleAddChannelAutocompleteSource(req,res);}else{this.discuss.handleAddChatAutocompleteSource(req,res);}}
_onReplyingToMessageMessagePosted(){this.env.services['notification'].notify({message:_.str.sprintf(this.env._t(`Message posted on "%s"`),owl.utils.escape(this.discuss.replyingToMessage.originThread.displayName)),type:'warning',});this.discuss.clearReplyingToMessage();}
_onSelectMobileNavbarTab(ev){ev.stopPropagation();if(this.discuss.activeMobileNavbarTabId===ev.detail.tabId){return;}
this.discuss.clearReplyingToMessage();this.discuss.update({activeMobileNavbarTabId:ev.detail.tabId});}
_onThreadRendered(ev){this.trigger('o-update-control-panel');}}
Object.assign(Discuss,{components,props:{},template:'mail.Discuss',});return patchMixin(Discuss);});;

/* /mail/static/src/components/discuss_mobile_mailbox_selection/discuss_mobile_mailbox_selection.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/discuss_mobile_mailbox_selection/discuss_mobile_mailbox_selection.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class DiscussMobileMailboxSelection extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{return{allOrderedAndPinnedMailboxes:this.orderedMailboxes.map(mailbox=>mailbox.__state),discussThread:this.env.messaging.discuss.thread?this.env.messaging.discuss.thread.__state:undefined,};},{compareDepth:{allOrderedAndPinnedMailboxes:1,},});}
get orderedMailboxes(){return this.env.models['mail.thread'].all(thread=>thread.isPinned&&thread.model==='mail.box').sort((mailbox1,mailbox2)=>{if(mailbox1===this.env.messaging.inbox){return-1;}
if(mailbox2===this.env.messaging.inbox){return 1;}
if(mailbox1===this.env.messaging.starred){return-1;}
if(mailbox2===this.env.messaging.starred){return 1;}
const mailbox1Name=mailbox1.displayName;const mailbox2Name=mailbox2.displayName;mailbox1Name<mailbox2Name?-1:1;});}
get discuss(){return this.env.messaging&&this.env.messaging.discuss;}
_onClick(ev){const{mailboxLocalId}=ev.currentTarget.dataset;const mailbox=this.env.models['mail.thread'].get(mailboxLocalId);if(!mailbox){return;}
mailbox.open();}}
Object.assign(DiscussMobileMailboxSelection,{props:{},template:'mail.DiscussMobileMailboxSelection',});return DiscussMobileMailboxSelection;});;

/* /mail/static/src/components/discuss_sidebar/discuss_sidebar.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/discuss_sidebar/discuss_sidebar.js',function(require){'use strict';const components={AutocompleteInput:require('mail/static/src/components/autocomplete_input/autocomplete_input.js'),DiscussSidebarItem:require('mail/static/src/components/discuss_sidebar_item/discuss_sidebar_item.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{Component}=owl;const{useRef}=owl.hooks;class DiscussSidebar extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore((...args)=>this._useStoreSelector(...args),{compareDepth:this._useStoreCompareDepth()});useUpdate({func:()=>this._update()});this._quickSearchInputRef=useRef('quickSearchInput');this._onAddChannelAutocompleteSelect=this._onAddChannelAutocompleteSelect.bind(this);this._onAddChannelAutocompleteSource=this._onAddChannelAutocompleteSource.bind(this);this._onAddChatAutocompleteSelect=this._onAddChatAutocompleteSelect.bind(this);this._onAddChatAutocompleteSource=this._onAddChatAutocompleteSource.bind(this);}
get discuss(){return this.env.messaging&&this.env.messaging.discuss;}
get FIND_OR_CREATE_CHANNEL(){return this.env._t("Find or create a channel...");}
get orderedMailboxes(){return this.env.models['mail.thread'].all(thread=>thread.isPinned&&thread.model==='mail.box').sort((mailbox1,mailbox2)=>{if(mailbox1===this.env.messaging.inbox){return-1;}
if(mailbox2===this.env.messaging.inbox){return 1;}
if(mailbox1===this.env.messaging.starred){return-1;}
if(mailbox2===this.env.messaging.starred){return 1;}
const mailbox1Name=mailbox1.displayName;const mailbox2Name=mailbox2.displayName;mailbox1Name<mailbox2Name?-1:1;});}
get quickSearchPinnedAndOrderedChats(){const allOrderedAndPinnedChats=this.env.models['mail.thread'].all(thread=>thread.channel_type==='chat'&&thread.isPinned&&thread.model==='mail.channel').sort((c1,c2)=>c1.displayName<c2.displayName?-1:1);if(!this.discuss.sidebarQuickSearchValue){return allOrderedAndPinnedChats;}
const qsVal=this.discuss.sidebarQuickSearchValue.toLowerCase();return allOrderedAndPinnedChats.filter(chat=>{const nameVal=chat.displayName.toLowerCase();return nameVal.includes(qsVal);});}
get quickSearchOrderedAndPinnedMultiUserChannels(){const allOrderedAndPinnedMultiUserChannels=this.env.models['mail.thread'].all(thread=>thread.channel_type==='channel'&&thread.isPinned&&thread.model==='mail.channel').sort((c1,c2)=>{if(c1.displayName&&!c2.displayName){return-1;}else if(!c1.displayName&&c2.displayName){return 1;}else if(c1.displayName&&c2.displayName&&c1.displayName!==c2.displayName){return c1.displayName.toLowerCase()<c2.displayName.toLowerCase()?-1:1;}else{return c1.id-c2.id;}});if(!this.discuss.sidebarQuickSearchValue){return allOrderedAndPinnedMultiUserChannels;}
const qsVal=this.discuss.sidebarQuickSearchValue.toLowerCase();return allOrderedAndPinnedMultiUserChannels.filter(channel=>{const nameVal=channel.displayName.toLowerCase();return nameVal.includes(qsVal);});}
_update(){if(!this.discuss){return;}
if(this._quickSearchInputRef.el){this._quickSearchInputRef.el.value=this.discuss.sidebarQuickSearchValue;}}
_useStoreCompareDepth(){return{allOrderedAndPinnedChats:1,allOrderedAndPinnedMailboxes:1,allOrderedAndPinnedMultiUserChannels:1,};}
_useStoreSelector(props){const discuss=this.env.messaging.discuss;return{allOrderedAndPinnedChats:this.quickSearchPinnedAndOrderedChats,allOrderedAndPinnedMailboxes:this.orderedMailboxes,allOrderedAndPinnedMultiUserChannels:this.quickSearchOrderedAndPinnedMultiUserChannels,allPinnedChannelAmount:this.env.models['mail.thread'].all(thread=>thread.isPinned&&thread.model==='mail.channel').length,discussIsAddingChannel:discuss&&discuss.isAddingChannel,discussIsAddingChat:discuss&&discuss.isAddingChat,discussSidebarQuickSearchValue:discuss&&discuss.sidebarQuickSearchValue,};}
_onAddChannelAutocompleteSelect(ev,ui){this.discuss.handleAddChannelAutocompleteSelect(ev,ui);}
_onAddChannelAutocompleteSource(req,res){this.discuss.handleAddChannelAutocompleteSource(req,res);}
_onAddChatAutocompleteSelect(ev,ui){this.discuss.handleAddChatAutocompleteSelect(ev,ui);}
_onAddChatAutocompleteSource(req,res){this.discuss.handleAddChatAutocompleteSource(req,res);}
_onClickChannelAdd(ev){ev.stopPropagation();this.discuss.update({isAddingChannel:true});}
_onClickChannelTitle(ev){ev.stopPropagation();return this.env.bus.trigger('do-action',{action:{name:this.env._t("Public Channels"),type:'ir.actions.act_window',res_model:'mail.channel',views:[[false,'kanban'],[false,'form']],domain:[['public','!=','private']]},});}
_onClickChatAdd(ev){ev.stopPropagation();this.discuss.update({isAddingChat:true});}
_onHideAddingItem(ev){ev.stopPropagation();this.discuss.clearIsAddingItem();}
_onInputQuickSearch(ev){ev.stopPropagation();this.discuss.update({sidebarQuickSearchValue:this._quickSearchInputRef.el.value,});}}
Object.assign(DiscussSidebar,{components,props:{},template:'mail.DiscussSidebar',});return DiscussSidebar;});;

/* /mail/static/src/components/discuss_sidebar_item/discuss_sidebar_item.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/discuss_sidebar_item/discuss_sidebar_item.js',function(require){'use strict';const components={EditableText:require('mail/static/src/components/editable_text/editable_text.js'),ThreadIcon:require('mail/static/src/components/thread_icon/thread_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{isEventHandled}=require('mail/static/src/utils/utils.js');const Dialog=require('web.Dialog');const{Component}=owl;class DiscussSidebarItem extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const discuss=this.env.messaging.discuss;const thread=this.env.models['mail.thread'].get(props.threadLocalId);const correspondent=thread?thread.correspondent:undefined;return{correspondentName:correspondent&&correspondent.name,discussIsRenamingThread:discuss&&discuss.renamingThreads.includes(thread),isDiscussThread:discuss&&discuss.thread===thread,starred:this.env.messaging.starred,thread,threadChannelType:thread&&thread.channel_type,threadCounter:thread&&thread.counter,threadDisplayName:thread&&thread.displayName,threadGroupBasedSubscription:thread&&thread.group_based_subscription,threadLocalMessageUnreadCounter:thread&&thread.localMessageUnreadCounter,threadMassMailing:thread&&thread.mass_mailing,threadMessageNeedactionCounter:thread&&thread.message_needaction_counter,threadModel:thread&&thread.model,};});}
get counter(){if(this.thread.model==='mail.box'){return this.thread.counter;}else if(this.thread.channel_type==='channel'){return this.thread.message_needaction_counter;}else if(this.thread.channel_type==='chat'){return this.thread.localMessageUnreadCounter;}
return 0;}
get discuss(){return this.env.messaging&&this.env.messaging.discuss;}
hasUnpin(){return this.thread.channel_type==='chat';}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_askAdminConfirmation(){return new Promise(resolve=>{Dialog.confirm(this,this.env._t("You are the administrator of this channel. Are you sure you want to leave?"),{buttons:[{text:this.env._t("Leave"),classes:'btn-primary',close:true,click:resolve},{text:this.env._t("Discard"),close:true}]});});}
_onCancelRenaming(ev){this.discuss.cancelThreadRenaming(this.thread);}
_onClick(ev){if(isEventHandled(ev,'EditableText.click')){return;}
this.thread.open();}
_onClickedEditableText(ev){ev.stopPropagation();}
async _onClickLeave(ev){ev.stopPropagation();if(this.thread.creator===this.env.messaging.currentUser){await this._askAdminConfirmation();}
this.thread.unsubscribe();}
_onClickRename(ev){ev.stopPropagation();this.discuss.setThreadRenaming(this.thread);}
_onClickSettings(ev){ev.stopPropagation();return this.env.bus.trigger('do-action',{action:{type:'ir.actions.act_window',res_model:this.thread.model,res_id:this.thread.id,views:[[false,'form']],target:'current'},});}
_onClickUnpin(ev){ev.stopPropagation();this.thread.unsubscribe();}
_onValidateEditableText(ev){ev.stopPropagation();this.discuss.renameThread(this.thread,ev.detail.newName);}}
Object.assign(DiscussSidebarItem,{components,props:{threadLocalId:String,},template:'mail.DiscussSidebarItem',});return DiscussSidebarItem;});;

/* /mail/static/src/components/drop_zone/drop_zone.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/drop_zone/drop_zone.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const{Component,useState}=owl;class DropZone extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();this.state=useState({isDraggingInside:false,});this._dragCount=0;}
contains(node){return this.el.contains(node);}
_isDragSourceExternalFile(dataTransfer){const dragDataType=dataTransfer.types;if(dragDataType.constructor===window.DOMStringList){return dragDataType.contains('Files');}
if(dragDataType.constructor===Array){return dragDataType.includes('Files');}
return false;}
_onDragenter(ev){ev.preventDefault();if(this._dragCount===0){this.state.isDraggingInside=true;}
this._dragCount++;}
_onDragleave(ev){this._dragCount--;if(this._dragCount===0){this.state.isDraggingInside=false;}}
_onDragover(ev){ev.preventDefault();ev.dataTransfer.dropEffect='copy';}
_onDrop(ev){ev.preventDefault();if(this._isDragSourceExternalFile(ev.dataTransfer)){this.trigger('o-dropzone-files-dropped',{files:ev.dataTransfer.files,});}
this.state.isDraggingInside=false;}}
Object.assign(DropZone,{props:{},template:'mail.DropZone',});return DropZone;});;

/* /mail/static/src/components/editable_text/editable_text.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/editable_text/editable_text.js',function(require){'use strict';const{markEventHandled}=require('mail/static/src/utils/utils.js');const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const{Component}=owl;class EditableText extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();}
mounted(){this.el.focus();this.el.setSelectionRange(0,(this.el.value&&this.el.value.length)||0);}
willUnmount(){this.trigger('o-cancel');}
_onBlur(ev){this.trigger('o-cancel');}
_onClick(ev){markEventHandled(ev,'EditableText.click');this.trigger('o-clicked');}
_onKeydown(ev){switch(ev.key){case'Enter':this._onKeydownEnter(ev);break;case'Escape':this.trigger('o-cancel');break;}}
_onKeydownEnter(ev){const value=this.el.value;const newName=value||this.props.placeholder;if(this.props.value!==newName){this.trigger('o-validate',{newName});}else{this.trigger('o-cancel');}}}
Object.assign(EditableText,{defaultProps:{placeholder:"",value:"",},props:{placeholder:String,value:String,},template:'mail.EditableText',});return EditableText;});;

/* /mail/static/src/components/emojis_popover/emojis_popover.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/emojis_popover/emojis_popover.js',function(require){'use strict';const emojis=require('mail.emojis');const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{Component}=owl;class EmojisPopover extends Component{constructor(...args){super(...args);this.emojis=emojis;useShouldUpdateBasedOnProps();useUpdate({func:()=>this._update()});}
_update(){this.trigger('o-popover-compute');}
close(){this.trigger('o-popover-close');}
contains(node){if(!this.el){return false;}
return this.el.contains(node);}
_onClickEmoji(ev){this.close();this.trigger('o-emoji-selection',{unicode:ev.currentTarget.dataset.unicode,});}}
Object.assign(EmojisPopover,{props:{},template:'mail.EmojisPopover',});return EmojisPopover;});;

/* /mail/static/src/components/file_uploader/file_uploader.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/file_uploader/file_uploader.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const core=require('web.core');const{Component}=owl;const{useRef}=owl.hooks;class FileUploader extends Component{constructor(...args){super(...args);this._fileInputRef=useRef('fileInput');this._fileUploadId=_.uniqueId('o_FileUploader_fileupload');this._onAttachmentUploaded=this._onAttachmentUploaded.bind(this);useShouldUpdateBasedOnProps({compareDepth:{attachmentLocalIds:1,newAttachmentExtraData:3,},});}
mounted(){$(window).on(this._fileUploadId,this._onAttachmentUploaded);}
willUnmount(){$(window).off(this._fileUploadId);}
async uploadFiles(files){await this._unlinkExistingAttachments(files);this._createTemporaryAttachments(files);await this._performUpload(files);this._fileInputRef.el.value='';}
openBrowserFileUploader(){this._fileInputRef.el.click();}
_createAttachment(fileData){return this.env.models['mail.attachment'].create(Object.assign({},fileData,this.props.newAttachmentExtraData));}
_createFormData(file){let formData=new window.FormData();formData.append('callback',this._fileUploadId);formData.append('csrf_token',core.csrf_token);formData.append('id',this.props.uploadId);formData.append('model',this.props.uploadModel);formData.append('ufile',file,file.name);return formData;}
_createTemporaryAttachments(files){for(const file of files){this.env.models['mail.attachment'].create(Object.assign({filename:file.name,isTemporary:true,name:file.name},this.props.newAttachmentExtraData),);}}
async _performUpload(files){for(const file of files){const uploadingAttachment=this.env.models['mail.attachment'].find(attachment=>attachment.isTemporary&&attachment.filename===file.name);if(!uploadingAttachment){continue;}
try{const response=await this.env.browser.fetch('/web/binary/upload_attachment',{method:'POST',body:this._createFormData(file),signal:uploadingAttachment.uploadingAbortController.signal,});let html=await response.text();const template=document.createElement('template');template.innerHTML=html.trim();window.eval(template.content.firstChild.textContent);}catch(e){if(e.name!=='AbortError'){throw e;}}}}
async _unlinkExistingAttachments(files){for(const file of files){const attachment=this.props.attachmentLocalIds.map(attachmentLocalId=>this.env.models['mail.attachment'].get(attachmentLocalId)).find(attachment=>attachment.name===file.name&&attachment.size===file.size);if(attachment){attachment.remove();}}}
async _onAttachmentUploaded(ev,...filesData){for(const fileData of filesData){const{error,filename,id,mimetype,name,size}=fileData;if(error||!id){this.env.services['notification'].notify({type:'danger',message:owl.utils.escape(error),});const relatedTemporaryAttachments=this.env.models['mail.attachment'].find(attachment=>attachment.filename===filename&&attachment.isTemporary);for(const attachment of relatedTemporaryAttachments){attachment.delete();}
return;}
await new Promise(resolve=>setTimeout(resolve));const attachment=this.env.models['mail.attachment'].insert(Object.assign({filename,id,mimetype,name,size,},this.props.newAttachmentExtraData),);this.trigger('o-attachment-created',{attachment});}}
async _onChangeAttachment(ev){await this.uploadFiles(ev.target.files);}}
Object.assign(FileUploader,{defaultProps:{uploadId:0,uploadModel:'mail.compose.message'},props:{attachmentLocalIds:{type:Array,element:String,},newAttachmentExtraData:{type:Object,optional:true,},uploadId:Number,uploadModel:String,},template:'mail.FileUploader',});return FileUploader;});;

/* /mail/static/src/components/follow_button/follow_button.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/follow_button/follow_button.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useState}=owl.hooks;class FollowButton extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();this.state=useState({isUnfollowButtonHighlighted:false,});useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);return{threadIsCurrentPartnerFollowing:thread&&thread.isCurrentPartnerFollowing,};});}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_onClickFollow(ev){this.thread.follow();}
_onClickUnfollow(ev){this.thread.unfollow();}
_onMouseLeaveUnfollow(ev){this.state.isUnfollowButtonHighlighted=false;}
_onMouseEnterUnfollow(ev){this.state.isUnfollowButtonHighlighted=true;}}
Object.assign(FollowButton,{defaultProps:{isDisabled:false,},props:{isDisabled:Boolean,threadLocalId:String,},template:'mail.FollowButton',});return FollowButton;});;

/* /mail/static/src/components/follower/follower.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/follower/follower.js',function(require){'use strict';const components={FollowerSubtypeList:require('mail/static/src/components/follower_subtype_list/follower_subtype_list.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class Follower extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const follower=this.env.models['mail.follower'].get(props.followerLocalId);return[follower?follower.__state:undefined];});}
get follower(){return this.env.models['mail.follower'].get(this.props.followerLocalId);}
_onClickDetails(ev){ev.preventDefault();ev.stopPropagation();this.follower.openProfile();}
_onClickEdit(ev){ev.preventDefault();this.follower.showSubtypes();}
_onClickRemove(ev){this.follower.remove();}}
Object.assign(Follower,{components,props:{followerLocalId:String,},template:'mail.Follower',});return Follower;});;

/* /mail/static/src/components/follower_list_menu/follower_list_menu.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/follower_list_menu/follower_list_menu.js',function(require){'use strict';const components={Follower:require('mail/static/src/components/follower/follower.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useRef,useState}=owl.hooks;class FollowerListMenu extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();this.state=useState({isDropdownOpen:false,});useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);const followers=thread?thread.followers:[];return{followers,threadChannelType:thread&&thread.channel_type,};},{compareDepth:{followers:1,},});this._dropdownRef=useRef('dropdown');this._onClickCaptureGlobal=this._onClickCaptureGlobal.bind(this);}
mounted(){document.addEventListener('click',this._onClickCaptureGlobal,true);}
willUnmount(){document.removeEventListener('click',this._onClickCaptureGlobal,true);}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_hide(){this.state.isDropdownOpen=false;}
_onKeydown(ev){ev.stopPropagation();switch(ev.key){case'Escape':ev.preventDefault();this._hide();break;}}
_onClickAddChannels(ev){ev.preventDefault();this._hide();this.thread.promptAddChannelFollower();}
_onClickAddFollowers(ev){ev.preventDefault();this._hide();this.thread.promptAddPartnerFollower();}
_onClickCaptureGlobal(ev){if(this._dropdownRef.el&&!this._dropdownRef.el.contains(ev.target)){this._hide();}}
_onClickFollowersButton(ev){this.state.isDropdownOpen=!this.state.isDropdownOpen;}
_onClickFollower(ev){this._hide();}}
Object.assign(FollowerListMenu,{components,defaultProps:{isDisabled:false,},props:{isDisabled:Boolean,threadLocalId:String,},template:'mail.FollowerListMenu',});return FollowerListMenu;});;

/* /mail/static/src/components/follower_subtype/follower_subtype.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/follower_subtype/follower_subtype.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class FollowerSubtype extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const followerSubtype=this.env.models['mail.follower_subtype'].get(props.followerSubtypeLocalId);return[followerSubtype?followerSubtype.__state:undefined];});}
get follower(){return this.env.models['mail.follower'].get(this.props.followerLocalId);}
get followerSubtype(){return this.env.models['mail.follower_subtype'].get(this.props.followerSubtypeLocalId);}
_onChangeCheckbox(ev){if(ev.target.checked){this.follower.selectSubtype(this.followerSubtype);}else{this.follower.unselectSubtype(this.followerSubtype);}}}
Object.assign(FollowerSubtype,{props:{followerLocalId:String,followerSubtypeLocalId:String,},template:'mail.FollowerSubtype',});return FollowerSubtype;});;

/* /mail/static/src/components/follower_subtype_list/follower_subtype_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/follower_subtype_list/follower_subtype_list.js',function(require){'use strict';const components={FollowerSubtype:require('mail/static/src/components/follower_subtype/follower_subtype.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component,QWeb}=owl;class FollowerSubtypeList extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const followerSubtypeList=this.env.models['mail.follower_subtype_list'].get(props.localId);const follower=followerSubtypeList?followerSubtypeList.follower:undefined;const followerSubtypes=follower?follower.subtypes:[];return{follower:follower?follower.__state:undefined,followerSubtypeList:followerSubtypeList?followerSubtypeList.__state:undefined,followerSubtypes:followerSubtypes.map(subtype=>subtype.__state),};},{compareDepth:{followerSubtypes:1,},});}
get followerSubtypeList(){return this.env.models['mail.follower_subtype_list'].get(this.props.localId);}
_onClickCancel(ev){this.followerSubtypeList.follower.closeSubtypes();}
_onClickApply(ev){this.followerSubtypeList.follower.updateSubtypes();}}
Object.assign(FollowerSubtypeList,{components,props:{localId:String,},template:'mail.FollowerSubtypeList',});QWeb.registerComponent('FollowerSubtypeList',FollowerSubtypeList);return FollowerSubtypeList;});;

/* /mail/static/src/components/mail_template/mail_template.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/mail_template/mail_template.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class MailTemplate extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const activity=this.env.models['mail.activity'].get(props.activityLocalId);const mailTemplate=this.env.models['mail.mail_template'].get(props.mailTemplateLocalId);return{activity:activity?activity.__state:undefined,mailTemplate:mailTemplate?mailTemplate.__state:undefined,};});}
get activity(){return this.env.models['mail.activity'].get(this.props.activityLocalId);}
get mailTemplate(){return this.env.models['mail.mail_template'].get(this.props.mailTemplateLocalId);}
_onClickPreview(ev){ev.stopPropagation();ev.preventDefault();this.mailTemplate.preview(this.activity);}
_onClickSend(ev){ev.stopPropagation();ev.preventDefault();this.mailTemplate.send(this.activity);}}
Object.assign(MailTemplate,{props:{activityLocalId:String,mailTemplateLocalId:String,},template:'mail.MailTemplate',});return MailTemplate;});;

/* /mail/static/src/components/message/message.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/message/message.js',function(require){'use strict';const components={AttachmentList:require('mail/static/src/components/attachment_list/attachment_list.js'),MessageSeenIndicator:require('mail/static/src/components/message_seen_indicator/message_seen_indicator.js'),ModerationBanDialog:require('mail/static/src/components/moderation_ban_dialog/moderation_ban_dialog.js'),ModerationDiscardDialog:require('mail/static/src/components/moderation_discard_dialog/moderation_discard_dialog.js'),ModerationRejectDialog:require('mail/static/src/components/moderation_reject_dialog/moderation_reject_dialog.js'),NotificationPopover:require('mail/static/src/components/notification_popover/notification_popover.js'),PartnerImStatusIcon:require('mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{_lt}=require('web.core');const{format}=require('web.field_utils');const{getLangDatetimeFormat}=require('web.time');const{Component,useState}=owl;const{useRef}=owl.hooks;const READ_MORE=_lt("read more");const READ_LESS=_lt("read less");const{isEventHandled,markEventHandled}=require('mail/static/src/utils/utils.js');class Message extends Component{constructor(...args){super(...args);this.state=useState({hasModerationBanDialog:false,hasModerationDiscardDialog:false,hasModerationRejectDialog:false,isClicked:false,});useShouldUpdateBasedOnProps();useStore(props=>{const message=this.env.models['mail.message'].get(props.messageLocalId);const author=message?message.author:undefined;const partnerRoot=this.env.messaging.partnerRoot;const originThread=message?message.originThread:undefined;const threadView=this.env.models['mail.thread_view'].get(props.threadViewLocalId);const thread=threadView?threadView.thread:undefined;return{attachments:message?message.attachments.map(attachment=>attachment.__state):[],author,authorAvatarUrl:author&&author.avatarUrl,authorImStatus:author&&author.im_status,authorNameOrDisplayName:author&&author.nameOrDisplayName,correspondent:thread&&thread.correspondent,hasMessageCheckbox:message?message.hasCheckbox:false,isDeviceMobile:this.env.messaging.device.isMobile,isMessageChecked:message&&threadView?message.isChecked(thread,threadView.stringifiedDomain):false,message:message?message.__state:undefined,notifications:message?message.notifications.map(notif=>notif.__state):[],originThread,originThreadModel:originThread&&originThread.model,originThreadName:originThread&&originThread.name,originThreadUrl:originThread&&originThread.url,partnerRoot,thread,threadHasSeenIndicators:thread&&thread.hasSeenIndicators,threadMassMailing:thread&&thread.mass_mailing,};},{compareDepth:{attachments:1,notifications:1,},});useUpdate({func:()=>this._update()});this._wasSelected;this._lastPrettyBody;this._prettyBodyRef=useRef('prettyBody');this._contentRef=useRef('content');this._checkboxRef=useRef('checkbox');this._intervalId=undefined;this._lastReadMoreIndex=0;this._isReadMoreByIndex=new Map();this._constructor();}
_constructor(){}
willUnmount(){clearInterval(this._intervalId);}
get avatar(){if(this.message.author&&this.message.author===this.env.messaging.partnerRoot){return'/mail/static/src/img/odoobot.png';}else if(this.message.author){return this.message.author.avatarUrl;}else if(this.message.message_type==='email'){return'/mail/static/src/img/email_icon.png';}
return'/mail/static/src/img/smiley/avatar.jpg';}
get datetime(){return this.message.date.format(getLangDatetimeFormat());}
get hasAuthorOpenChat(){if(!this.message.author){return false;}
if(this.threadView&&this.threadView.thread&&this.threadView.thread.correspondent===this.message.author){return false;}
return true;}
isBottomVisible({offset=0}={}){if(!this.el){return false;}
const elRect=this.el.getBoundingClientRect();if(!this.el.parentNode){return false;}
const parentRect=this.el.parentNode.getBoundingClientRect();return(elRect.bottom<parentRect.bottom+offset&&parentRect.top<elRect.bottom+offset);}
isPartiallyVisible(){const elRect=this.el.getBoundingClientRect();if(!this.el.parentNode){return false;}
const parentRect=this.el.parentNode.getBoundingClientRect();return(elRect.top<parentRect.bottom+5&&parentRect.top<elRect.bottom+5);}
get message(){return this.env.models['mail.message'].get(this.props.messageLocalId);}
get OPEN_CHAT(){return this.env._t("Open chat");}
async scrollIntoView({behavior='auto',block='end'}={}){this.el.scrollIntoView({behavior,block,inline:'nearest',});if(behavior==='smooth'){return new Promise(resolve=>setTimeout(resolve,500));}else{return Promise.resolve();}}
get shortTime(){return this.message.date.format('hh:mm');}
get threadView(){return this.env.models['mail.thread_view'].get(this.props.threadViewLocalId);}
get trackingValues(){return this.message.tracking_value_ids.map(trackingValue=>{const value=Object.assign({},trackingValue);value.changed_field=_.str.sprintf(this.env._t("%s:"),value.changed_field);switch(value.field_type){case'boolean':value.old_value=format.boolean(value.old_value,undefined,{forceString:true});value.new_value=format.boolean(value.new_value,undefined,{forceString:true});break;case'char':case'many2one':case'selection':value.old_value=format.char(value.old_value);value.new_value=format.char(value.new_value);break;case'date':if(value.old_value){value.old_value=moment.utc(value.old_value);}
if(value.new_value){value.new_value=moment.utc(value.new_value);}
value.old_value=format.date(value.old_value);value.new_value=format.date(value.new_value);break;case'datetime':if(value.old_value){value.old_value=moment.utc(value.old_value);}
if(value.new_value){value.new_value=moment.utc(value.new_value);}
value.old_value=format.datetime(value.old_value);value.new_value=format.datetime(value.new_value);break;case'float':value.old_value=format.float(value.old_value);value.new_value=format.float(value.new_value);break;case'integer':value.old_value=format.integer(value.old_value);value.new_value=format.integer(value.new_value);break;case'monetary':value.old_value=format.monetary(value.old_value,undefined,{forceString:true});value.new_value=format.monetary(value.new_value,undefined,{forceString:true});break;case'text':value.old_value=format.text(value.old_value);value.new_value=format.text(value.new_value);break;}
return value;});}
_insertReadMoreLess($element){const groups=[];let readMoreNodes;const $children=$element.contents().filter((index,content)=>content.nodeType===1||(content.nodeType===3&&content.nodeValue.trim()));for(const child of $children){let $child=$(child);if(child.nodeType===3&&$child.prevAll('[id*="stopSpelling"]').length>0){$child=$('<span>',{text:child.textContent,'data-o-mail-quote':'1',});child.parentNode.replaceChild($child[0],child);}
if($child.attr('data-o-mail-quote')||($child.get(0).nodeName==='BR'&&$child.prev('[data-o-mail-quote="1"]').length>0)){if(!readMoreNodes){readMoreNodes=[];groups.push(readMoreNodes);}
$child.hide();readMoreNodes.push($child);}else{readMoreNodes=undefined;this._insertReadMoreLess($child);}}
for(const group of groups){const index=this._lastReadMoreIndex++;const $readMoreLess=$('<a>',{class:'o_Message_readMoreLess',href:'#',text:READ_MORE,}).insertBefore(group[0]);if(!this._isReadMoreByIndex.has(index)){this._isReadMoreByIndex.set(index,true);}
const updateFromState=()=>{const isReadMore=this._isReadMoreByIndex.get(index);for(const $child of group){$child.hide();$child.toggle(!isReadMore);}
$readMoreLess.text(isReadMore?READ_MORE:READ_LESS);};$readMoreLess.click(e=>{e.preventDefault();this._isReadMoreByIndex.set(index,!this._isReadMoreByIndex.get(index));updateFromState();});updateFromState();}}
_update(){if(!this.message){return;}
if(this._prettyBodyRef.el&&this.message.prettyBody!==this._lastPrettyBody){this._prettyBodyRef.el.innerHTML=this.message.prettyBody;this._lastPrettyBody=this.message.prettyBody;}
if(this._contentRef.el){for(const el of[...this._contentRef.el.querySelectorAll(':scope .o_Message_readMoreLess')]){el.remove();}
this._lastReadMoreIndex=0;this._insertReadMoreLess($(this._contentRef.el));this.env.messagingBus.trigger('o-component-message-read-more-less-inserted',{message:this.message,});}
this._wasSelected=this.props.isSelected;this.message.refreshDateFromNow();clearInterval(this._intervalId);this._intervalId=setInterval(()=>{this.message.refreshDateFromNow();},60*1000);}
_onChangeCheckbox(){this.message.toggleCheck(this.threadView.thread,this.threadView.stringifiedDomain);}
_onClick(ev){if(ev.target.closest('.o_channel_redirect')){this.env.messaging.openProfile({id:Number(ev.target.dataset.oeId),model:'mail.channel',});ev.preventDefault();return;}
if(ev.target.tagName==='A'){if(ev.target.dataset.oeId&&ev.target.dataset.oeModel){this.env.messaging.openProfile({id:Number(ev.target.dataset.oeId),model:ev.target.dataset.oeModel,});ev.preventDefault();}
return;}
if(!isEventHandled(ev,'Message.ClickAuthorAvatar')&&!isEventHandled(ev,'Message.ClickAuthorName')&&!isEventHandled(ev,'Message.ClickFailure')){this.state.isClicked=!this.state.isClicked;}}
_onClickAuthorAvatar(ev){markEventHandled(ev,'Message.ClickAuthorAvatar');if(!this.hasAuthorOpenChat){return;}
this.message.author.openChat();}
_onClickAuthorName(ev){markEventHandled(ev,'Message.ClickAuthorName');if(!this.message.author){return;}
this.message.author.openProfile();}
_onClickFailure(ev){markEventHandled(ev,'Message.ClickFailure');this.message.openResendAction();}
_onClickModerationAccept(ev){ev.preventDefault();this.message.moderate('accept');}
_onClickModerationAllow(ev){ev.preventDefault();this.message.moderate('allow');}
_onClickModerationBan(ev){ev.preventDefault();this.state.hasModerationBanDialog=true;}
_onClickModerationDiscard(ev){ev.preventDefault();this.state.hasModerationDiscardDialog=true;}
_onClickModerationReject(ev){ev.preventDefault();this.state.hasModerationRejectDialog=true;}
_onClickOriginThread(ev){ev.preventDefault();this.message.originThread.open();}
_onClickStar(ev){ev.stopPropagation();this.message.toggleStar();}
_onClickMarkAsRead(ev){ev.stopPropagation();this.message.markAsRead();}
_onClickReply(ev){if(this._wasSelected){this.env.messaging.discuss.clearReplyingToMessage();}else{this.message.replyTo();}}
_onDialogClosedModerationBan(){this.state.hasModerationBanDialog=false;}
_onDialogClosedModerationDiscard(){this.state.hasModerationDiscardDialog=false;}
_onDialogClosedModerationReject(){this.state.hasModerationRejectDialog=false;}}
Object.assign(Message,{components,defaultProps:{hasCheckbox:false,hasMarkAsReadIcon:false,hasReplyIcon:false,isSelected:false,isSquashed:false,},props:{attachmentsDetailsMode:{type:String,optional:true,validate:prop=>['auto','card','hover','none'].includes(prop),},hasCheckbox:Boolean,hasMarkAsReadIcon:Boolean,hasReplyIcon:Boolean,isSelected:Boolean,isSquashed:Boolean,messageLocalId:String,threadViewLocalId:{type:String,optional:true,},},template:'mail.Message',});return Message;});;

/* /mail/static/src/components/message_author_prefix/message_author_prefix.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/message_author_prefix/message_author_prefix.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class MessageAuthorPrefix extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const message=this.env.models['mail.message'].get(props.messageLocalId);const author=message?message.author:undefined;const thread=props.threadLocalId?this.env.models['mail.thread'].get(props.threadLocalId):undefined;return{author:author?author.__state:undefined,currentPartner:this.env.messaging.currentPartner?this.env.messaging.currentPartner.__state:undefined,message:message?message.__state:undefined,thread:thread?thread.__state:undefined,};});}
get message(){return this.env.models['mail.message'].get(this.props.messageLocalId);}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}}
Object.assign(MessageAuthorPrefix,{props:{messageLocalId:String,threadLocalId:{type:String,optional:true,},},template:'mail.MessageAuthorPrefix',});return MessageAuthorPrefix;});;

/* /mail/static/src/components/message_list/message_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/message_list/message_list.js',function(require){'use strict';const components={Message:require('mail/static/src/components/message/message.js'),};const useRefs=require('mail/static/src/component_hooks/use_refs/use_refs.js');const useRenderedValues=require('mail/static/src/component_hooks/use_rendered_values/use_rendered_values.js');const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{Component}=owl;const{useRef}=owl.hooks;class MessageList extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const threadView=this.env.models['mail.thread_view'].get(props.threadViewLocalId);const thread=threadView?threadView.thread:undefined;const threadCache=threadView?threadView.threadCache:undefined;return{isDeviceMobile:this.env.messaging.device.isMobile,thread,threadCache,threadCacheIsAllHistoryLoaded:threadCache&&threadCache.isAllHistoryLoaded,threadCacheIsLoaded:threadCache&&threadCache.isLoaded,threadCacheIsLoadingMore:threadCache&&threadCache.isLoadingMore,threadCacheLastMessage:threadCache&&threadCache.lastMessage,threadCacheOrderedMessages:threadCache?threadCache.orderedMessages:[],threadIsTemporary:thread&&thread.isTemporary,threadMainCache:thread&&thread.mainCache,threadMessageAfterNewMessageSeparator:thread&&thread.messageAfterNewMessageSeparator,threadViewComponentHintList:threadView?threadView.componentHintList:[],threadViewNonEmptyMessagesLength:threadView&&threadView.nonEmptyMessages.length,};},{compareDepth:{threadCacheOrderedMessages:1,threadViewComponentHintList:1,},});this._getRefs=useRefs();this._isLastScrollProgrammatic=false;this._loadMoreRef=useRef('loadMore');this._willPatchSnapshot=undefined;this._onScrollThrottled=_.throttle(this._onScrollThrottled.bind(this),100);this._lastRenderedValues=useRenderedValues(()=>{const threadView=this.threadView;const thread=threadView&&threadView.thread;const threadCache=threadView&&threadView.threadCache;return{componentHintList:threadView?[...threadView.componentHintList]:[],hasAutoScrollOnMessageReceived:threadView&&threadView.hasAutoScrollOnMessageReceived,hasScrollAdjust:this.props.hasScrollAdjust,mainCache:thread&&thread.mainCache,order:this.props.order,orderedMessages:threadCache?[...threadCache.orderedMessages]:[],thread,threadCache,threadCacheInitialScrollHeight:threadView&&threadView.threadCacheInitialScrollHeight,threadCacheInitialScrollPosition:threadView&&threadView.threadCacheInitialScrollPosition,threadView,threadViewer:threadView&&threadView.threadViewer,};});useUpdate({func:()=>this._update()});}
willPatch(){const lastMessageRef=this.lastMessageRef;this._willPatchSnapshot={isLastMessageVisible:lastMessageRef&&lastMessageRef.isBottomVisible({offset:10}),scrollHeight:this._getScrollableElement().scrollHeight,scrollTop:this._getScrollableElement().scrollTop,};}
adjustFromComponentHints(){const{componentHintList,threadView}=this._lastRenderedValues();for(const hint of componentHintList){switch(hint.type){case'change-of-thread-cache':case'home-menu-hidden':case'home-menu-shown':this._adjustScrollFromModel();break;case'message-received':case'messages-loaded':case'new-messages-loaded':this._adjustScrollForExtraMessagesAtTheEnd();break;case'more-messages-loaded':this._adjustScrollForExtraMessagesAtTheStart();break;}
if(threadView&&threadView.exists()){threadView.markComponentHintProcessed(hint);}}
this._willPatchSnapshot=undefined;}
getDateDay(message){if(!message.date){return this.env._t("Today");}
const date=message.date.format('YYYY-MM-DD');if(date===moment().format('YYYY-MM-DD')){return this.env._t("Today");}else if(date===moment().subtract(1,'days').format('YYYY-MM-DD')){return this.env._t("Yesterday");}
return message.date.format('LL');}
getScrollHeight(){return this._getScrollableElement().scrollHeight;}
getScrollTop(){return this._getScrollableElement().scrollTop;}
get mostRecentMessageRef(){const{order}=this._lastRenderedValues();if(order==='desc'){return this.messageRefs[0];}
const{length:l,[l-1]:mostRecentMessageRef}=this.messageRefs;return mostRecentMessageRef;}
messageRefFromId(messageId){return this.messageRefs.find(ref=>ref.message.id===messageId);}
get messageRefs(){const{order}=this._lastRenderedValues();const refs=this._getRefs();const ascOrderedMessageRefs=Object.entries(refs).filter(([refId,ref])=>(refId.includes(this.env.models['mail.message'].modelName)&&ref.message)).map(([refId,ref])=>ref).sort((ref1,ref2)=>(ref1.message.id<ref2.message.id?-1:1));if(order==='desc'){return ascOrderedMessageRefs.reverse();}
return ascOrderedMessageRefs;}
get orderedMessages(){const threadCache=this.threadView.threadCache;if(this.props.order==='desc'){return[...threadCache.orderedMessages].reverse();}
return threadCache.orderedMessages;}
setScrollTop(value){if(this._getScrollableElement().scrollTop===value){return;}
this._isLastScrollProgrammatic=true;this._getScrollableElement().scrollTop=value;}
shouldMessageBeSquashed(prevMessage,message){if(!this.props.hasSquashCloseMessages){return false;}
if(!prevMessage.date&&message.date){return false;}
if(message.date&&prevMessage.date&&Math.abs(message.date.diff(prevMessage.date))>60000){return false;}
if(prevMessage.message_type!=='comment'||message.message_type!=='comment'){return false;}
if(prevMessage.author!==message.author){return false;}
if(prevMessage.originThread!==message.originThread){return false;}
if(prevMessage.moderation_status==='pending_moderation'||message.moderation_status==='pending_moderation'){return false;}
if(prevMessage.notifications.length>0||message.notifications.length>0){return false;}
const prevOriginThread=prevMessage.originThread;const originThread=message.originThread;if(prevOriginThread&&originThread&&prevOriginThread.model===originThread.model&&originThread.model!=='mail.channel'&&prevOriginThread.id!==originThread.id){return false;}
return true;}
get threadView(){return this.env.models['mail.thread_view'].get(this.props.threadViewLocalId);}
_adjustScrollForExtraMessagesAtTheEnd(){const{hasAutoScrollOnMessageReceived,hasScrollAdjust,order,}=this._lastRenderedValues();if(!this._getScrollableElement()||!hasScrollAdjust){return;}
if(!hasAutoScrollOnMessageReceived){if(order==='desc'&&this._willPatchSnapshot){const{scrollHeight,scrollTop}=this._willPatchSnapshot;this.setScrollTop(this._getScrollableElement().scrollHeight-scrollHeight+scrollTop);}
return;}
this._scrollToEnd();}
_adjustScrollForExtraMessagesAtTheStart(){const{hasScrollAdjust,order,}=this._lastRenderedValues();if(!this._getScrollableElement()||!hasScrollAdjust||!this._willPatchSnapshot||order==='desc'){return;}
const{scrollHeight,scrollTop}=this._willPatchSnapshot;this.setScrollTop(this._getScrollableElement().scrollHeight-scrollHeight+scrollTop);}
_adjustScrollFromModel(){const{hasScrollAdjust,threadCacheInitialScrollHeight,threadCacheInitialScrollPosition,}=this._lastRenderedValues();if(!this._getScrollableElement()||!hasScrollAdjust){return;}
if(threadCacheInitialScrollPosition!==undefined&&this._getScrollableElement().scrollHeight===threadCacheInitialScrollHeight){this.setScrollTop(threadCacheInitialScrollPosition);return;}
this._scrollToEnd();return;}
_checkMostRecentMessageIsVisible(){const{mainCache,threadCache,threadView,}=this._lastRenderedValues();if(!threadView||!threadView.exists()){return;}
const lastMessageIsVisible=threadCache&&this.mostRecentMessageRef&&threadCache===mainCache&&this.mostRecentMessageRef.isPartiallyVisible();if(lastMessageIsVisible){threadView.handleVisibleMessage(this.mostRecentMessageRef.message);}}
_getScrollableElement(){if(this.props.getScrollableElement){return this.props.getScrollableElement();}else{return this.el;}}
_isLoadMoreVisible(){const loadMore=this._loadMoreRef.el;if(!loadMore){return false;}
const loadMoreRect=loadMore.getBoundingClientRect();const elRect=this._getScrollableElement().getBoundingClientRect();const isInvisible=loadMoreRect.top>elRect.bottom||loadMoreRect.bottom<elRect.top;return!isInvisible;}
_loadMore(){const{threadCache}=this._lastRenderedValues();if(!threadCache||!threadCache.exists()){return;}
threadCache.loadMoreMessages();}
_scrollToEnd(){const{order}=this._lastRenderedValues();this.setScrollTop(order==='asc'?this._getScrollableElement().scrollHeight-this._getScrollableElement().clientHeight:0);}
_update(){this._checkMostRecentMessageIsVisible();this.adjustFromComponentHints();}
_onClickLoadMore(ev){ev.preventDefault();this._loadMore();}
onScroll(ev){this._onScrollThrottled(ev);}
_onScrollThrottled(ev){const{order,orderedMessages,thread,threadCache,threadView,threadViewer,}=this._lastRenderedValues();if(!this._getScrollableElement()){return;}
const scrollTop=this._getScrollableElement().scrollTop;this.env.messagingBus.trigger('o-component-message-list-scrolled',{orderedMessages,scrollTop,thread,threadViewer,});if(!this._isLastScrollProgrammatic&&threadView&&threadView.exists()){const margin=30;const hasAutoScrollOnMessageReceived=(order==='asc')?scrollTop>=this._getScrollableElement().scrollHeight-this._getScrollableElement().clientHeight-margin:scrollTop<=margin;threadView.update({hasAutoScrollOnMessageReceived});}
if(threadViewer&&threadViewer.exists()){threadViewer.saveThreadCacheScrollHeightAsInitial(this._getScrollableElement().scrollHeight,threadCache);threadViewer.saveThreadCacheScrollPositionsAsInitial(scrollTop,threadCache);}
if(!this._isLastScrollProgrammatic&&this._isLoadMoreVisible()){this._loadMore();}
this._checkMostRecentMessageIsVisible();this._isLastScrollProgrammatic=false;}}
Object.assign(MessageList,{components,defaultProps:{hasMessageCheckbox:false,hasScrollAdjust:true,hasSquashCloseMessages:false,haveMessagesMarkAsReadIcon:false,haveMessagesReplyIcon:false,order:'asc',},props:{hasMessageCheckbox:Boolean,hasSquashCloseMessages:Boolean,haveMessagesMarkAsReadIcon:Boolean,haveMessagesReplyIcon:Boolean,hasScrollAdjust:Boolean,getScrollableElement:{type:Function,optional:true,},order:{type:String,validate:prop=>['asc','desc'].includes(prop),},selectedMessageLocalId:{type:String,optional:true,},threadViewLocalId:String,},template:'mail.MessageList',});return MessageList;});;

/* /mail/static/src/components/message_seen_indicator/message_seen_indicator.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/message_seen_indicator/message_seen_indicator.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class MessageSeenIndicator extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const message=this.env.models['mail.message'].get(props.messageLocalId);const thread=this.env.models['mail.thread'].get(props.threadLocalId);const messageSeenIndicator=thread&&thread.model==='mail.channel'?this.env.models['mail.message_seen_indicator'].findFromIdentifyingData({channelId:thread.id,messageId:message.id,}):undefined;return{messageSeenIndicator:messageSeenIndicator?messageSeenIndicator.__state:undefined,};});}
get indicatorTitle(){if(!this.messageSeenIndicator){return'';}
if(this.messageSeenIndicator.hasEveryoneSeen){return this.env._t("Seen by Everyone");}
if(this.messageSeenIndicator.hasSomeoneSeen){const partnersThatHaveSeen=this.messageSeenIndicator.partnersThatHaveSeen.map(partner=>partner.name);if(partnersThatHaveSeen.length===1){return _.str.sprintf(this.env._t("Seen by %s"),partnersThatHaveSeen[0]);}
if(partnersThatHaveSeen.length===2){return _.str.sprintf(this.env._t("Seen by %s and %s"),partnersThatHaveSeen[0],partnersThatHaveSeen[1]);}
return _.str.sprintf(this.env._t("Seen by %s, %s and more"),partnersThatHaveSeen[0],partnersThatHaveSeen[1]);}
if(this.messageSeenIndicator.hasEveryoneFetched){return this.env._t("Received by Everyone");}
if(this.messageSeenIndicator.hasSomeoneFetched){const partnersThatHaveFetched=this.messageSeenIndicator.partnersThatHaveFetched.map(partner=>partner.name);if(partnersThatHaveFetched.length===1){return _.str.sprintf(this.env._t("Received by %s"),partnersThatHaveFetched[0]);}
if(partnersThatHaveFetched.length===2){return _.str.sprintf(this.env._t("Received by %s and %s"),partnersThatHaveFetched[0],partnersThatHaveFetched[1]);}
return _.str.sprintf(this.env._t("Received by %s, %s and more"),partnersThatHaveFetched[0],partnersThatHaveFetched[1]);}
return'';}
get message(){return this.env.models['mail.message'].get(this.props.messageLocalId);}
get messageSeenIndicator(){if(!this.thread||this.thread.model!=='mail.channel'){return undefined;}
return this.env.models['mail.message_seen_indicator'].findFromIdentifyingData({channelId:this.thread.id,messageId:this.message.id,});}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}}
Object.assign(MessageSeenIndicator,{props:{messageLocalId:String,threadLocalId:String,},template:'mail.MessageSeenIndicator',});return MessageSeenIndicator;});;

/* /mail/static/src/components/messaging_menu/messaging_menu.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/messaging_menu/messaging_menu.js',function(require){'use strict';const components={AutocompleteInput:require('mail/static/src/components/autocomplete_input/autocomplete_input.js'),MobileMessagingNavbar:require('mail/static/src/components/mobile_messaging_navbar/mobile_messaging_navbar.js'),NotificationList:require('mail/static/src/components/notification_list/notification_list.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const patchMixin=require('web.patchMixin');const{Component}=owl;class MessagingMenu extends Component{constructor(...args){super(...args);this.id=_.uniqueId('o_messagingMenu_');useShouldUpdateBasedOnProps();useStore(props=>{return{isDeviceMobile:this.env.messaging&&this.env.messaging.device.isMobile,isDiscussOpen:this.env.messaging&&this.env.messaging.discuss.isOpen,isMessagingInitialized:this.env.isMessagingInitialized(),messagingMenu:this.env.messaging&&this.env.messaging.messagingMenu.__state,};});this._onMobileNewMessageInputSelect=this._onMobileNewMessageInputSelect.bind(this);this._onMobileNewMessageInputSource=this._onMobileNewMessageInputSource.bind(this);this._onClickCaptureGlobal=this._onClickCaptureGlobal.bind(this);this._constructor(...args);}
_constructor(){}
mounted(){document.addEventListener('click',this._onClickCaptureGlobal,true);}
willUnmount(){document.removeEventListener('click',this._onClickCaptureGlobal,true);}
get discuss(){return this.env.messaging&&this.env.messaging.discuss;}
get messagingMenu(){return this.env.messaging&&this.env.messaging.messagingMenu;}
get mobileNewMessageInputPlaceholder(){return this.env._t("Search user...");}
get tabs(){return[{icon:'fa fa-envelope',id:'all',label:this.env._t("All"),},{icon:'fa fa-user',id:'chat',label:this.env._t("Chat"),},{icon:'fa fa-users',id:'channel',label:this.env._t("Channel"),}];}
_onClickCaptureGlobal(ev){if(!this.env.messaging){return;}
if(this.el.contains(ev.target)){return;}
this.messagingMenu.close();}
_onClickDesktopTabButton(ev){this.messagingMenu.update({activeTabId:ev.currentTarget.dataset.tabId});}
_onClickNewMessage(ev){if(!this.env.messaging.device.isMobile){this.env.messaging.chatWindowManager.openNewMessage();this.messagingMenu.close();}else{this.messagingMenu.toggleMobileNewMessage();}}
_onClickToggler(ev){ev.preventDefault();if(!this.env.messaging){return;}
this.messagingMenu.toggleOpen();}
_onHideMobileNewMessage(ev){ev.stopPropagation();this.messagingMenu.toggleMobileNewMessage();}
_onMobileNewMessageInputSelect(ev,ui){this.env.messaging.openChat({partnerId:ui.item.id});}
_onMobileNewMessageInputSource(req,res){const value=_.escape(req.term);this.env.models['mail.partner'].imSearch({callback:partners=>{const suggestions=partners.map(partner=>{return{id:partner.id,value:partner.nameOrDisplayName,label:partner.nameOrDisplayName,};});res(_.sortBy(suggestions,'label'));},keyword:value,limit:10,});}
_onSelectMobileNavbarTab(ev){ev.stopPropagation();this.messagingMenu.update({activeTabId:ev.detail.tabId});}}
Object.assign(MessagingMenu,{components,props:{},template:'mail.MessagingMenu',});return patchMixin(MessagingMenu);});;

/* /mail/static/src/components/mobile_messaging_navbar/mobile_messaging_navbar.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/mobile_messaging_navbar/mobile_messaging_navbar.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const{Component}=owl;class MobileMessagingNavbar extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{tabs:2,},});}
_onClick(ev){this.trigger('o-select-mobile-messaging-navbar-tab',{tabId:ev.currentTarget.dataset.tabId,});}}
Object.assign(MobileMessagingNavbar,{defaultProps:{tabs:[],},props:{activeTabId:String,tabs:{type:Array,element:{type:Object,shape:{icon:{type:String,optional:true,},id:String,label:String,},},},},template:'mail.MobileMessagingNavbar',});return MobileMessagingNavbar;});;

/* /mail/static/src/components/moderation_ban_dialog/moderation_ban_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/moderation_ban_dialog/moderation_ban_dialog.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const components={Dialog:require('web.OwlDialog'),};const{Component}=owl;const{useRef}=owl.hooks;class ModerationBanDialog extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{messageLocalIds:1,},});useStore(props=>{const messages=props.messageLocalIds.map(localId=>this.env.models['mail.message'].get(localId));return{messages:messages.map(message=>message?message.__state:undefined),};},{compareDepth:{messages:1,},});this._dialogRef=useRef('dialog');}
get messages(){return this.props.messageLocalIds.map(localId=>this.env.models['mail.message'].get(localId));}
get CONFIRMATION(){return this.env._t("Confirmation");}
_onClickBan(){this._dialogRef.comp._close();this.env.models['mail.message'].moderate(this.messages,'ban');}
_onClickCancel(){this._dialogRef.comp._close();}}
Object.assign(ModerationBanDialog,{components,props:{messageLocalIds:{type:Array,element:String,},},template:'mail.ModerationBanDialog',});return ModerationBanDialog;});;

/* /mail/static/src/components/moderation_discard_dialog/moderation_discard_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/moderation_discard_dialog/moderation_discard_dialog.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const components={Dialog:require('web.OwlDialog'),};const{Component}=owl;const{useRef}=owl.hooks;class ModerationDiscardDialog extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{messageLocalIds:1,},});useStore(props=>{const messages=props.messageLocalIds.map(localId=>this.env.models['mail.message'].get(localId));return{messages:messages.map(message=>message?message.__state:undefined),};},{compareDepth:{messages:1,},});this._dialogRef=useRef('dialog');}
getBody(){if(this.messages.length===1){return this.env._t("You are going to discard 1 message.");}
return _.str.sprintf(this.env._t("You are going to discard %s messages."),this.messages.length);}
get messages(){return this.props.messageLocalIds.map(localId=>this.env.models['mail.message'].get(localId));}
getTitle(){return this.env._t("Confirmation");}
_onClickCancel(){this._dialogRef.comp._close();}
_onClickDiscard(){this._dialogRef.comp._close();this.env.models['mail.message'].moderate(this.messages,'discard');}}
Object.assign(ModerationDiscardDialog,{components,props:{messageLocalIds:{type:Array,element:String,},},template:'mail.ModerationDiscardDialog',});return ModerationDiscardDialog;});;

/* /mail/static/src/components/moderation_reject_dialog/moderation_reject_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/moderation_reject_dialog/moderation_reject_dialog.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const components={Dialog:require('web.OwlDialog'),};const{Component,useState}=owl;const{useRef}=owl.hooks;class ModerationRejectDialog extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{messageLocalIds:1,},});this.state=useState({title:this.env._t("Message Rejected"),comment:this.env._t("Your message was rejected by moderator."),});useStore(props=>{const messages=props.messageLocalIds.map(localId=>this.env.models['mail.message'].get(localId));return{messages:messages.map(message=>message?message.__state:undefined),};},{compareDepth:{messages:1,},});this._dialogRef=useRef('dialog');}
get messages(){return this.props.messageLocalIds.map(localId=>this.env.models['mail.message'].get(localId));}
get SEND_EXPLANATION_TO_AUTHOR(){return this.env._t("Send explanation to author");}
_onClickCancel(){this._dialogRef.comp._close();}
_onClickReject(){this._dialogRef.comp._close();const kwargs={title:this.state.title,comment:this.state.comment,};this.env.models['mail.message'].moderate(this.messages,'reject',kwargs);}}
Object.assign(ModerationRejectDialog,{components,props:{messageLocalIds:{type:Array,element:String,},},template:'mail.ModerationRejectDialog',});return ModerationRejectDialog;});;

/* /mail/static/src/components/notification_alert/notification_alert.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/notification_alert/notification_alert.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class NotificationAlert extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const isMessagingInitialized=this.env.isMessagingInitialized();return{isMessagingInitialized,isNotificationBlocked:this.isNotificationBlocked,};});}
get isNotificationBlocked(){if(!this.env.isMessagingInitialized()){return false;}
const windowNotification=this.env.browser.Notification;return(windowNotification&&windowNotification.permission!=="granted"&&!this.env.messaging.isNotificationPermissionDefault());}}
Object.assign(NotificationAlert,{props:{},template:'mail.NotificationAlert',});return NotificationAlert;});;

/* /mail/static/src/components/notification_group/notification_group.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/notification_group/notification_group.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;const{useRef}=owl.hooks;class NotificationGroup extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const group=this.env.models['mail.notification_group'].get(props.notificationGroupLocalId);return{group:group?group.__state:undefined,};});this._markAsReadRef=useRef('markAsRead');}
get group(){return this.env.models['mail.notification_group'].get(this.props.notificationGroupLocalId);}
image(){if(this.group.notification_type==='email'){return'/mail/static/src/img/smiley/mailfailure.jpg';}}
_onClick(ev){const markAsRead=this._markAsReadRef.el;if(markAsRead&&markAsRead.contains(ev.target)){return;}
this.group.openDocuments();if(!this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}
_onClickMarkAsRead(ev){this.group.openCancelAction();if(!this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}}
Object.assign(NotificationGroup,{props:{notificationGroupLocalId:String,},template:'mail.NotificationGroup',});return NotificationGroup;});;

/* /mail/static/src/components/notification_list/notification_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/notification_list/notification_list.js',function(require){'use strict';const components={NotificationGroup:require('mail/static/src/components/notification_group/notification_group.js'),NotificationRequest:require('mail/static/src/components/notification_request/notification_request.js'),ThreadNeedactionPreview:require('mail/static/src/components/thread_needaction_preview/thread_needaction_preview.js'),ThreadPreview:require('mail/static/src/components/thread_preview/thread_preview.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class NotificationList extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();this.storeProps=useStore((...args)=>this._useStoreSelector(...args),{compareDepth:{notifications:2,},});}
mounted(){this._loadPreviews();}
get notifications(){const{notifications}=this.storeProps;return notifications;}
async _loadPreviews(){const threads=this.notifications.filter(notification=>notification.thread&&notification.thread.exists()).map(notification=>notification.thread);this.env.models['mail.thread'].loadPreviews(threads);}
_useStoreSelector(props){const threads=this._useStoreSelectorThreads(props);let threadNeedactionNotifications=[];if(props.filter==='all'){threadNeedactionNotifications=this.env.models['mail.thread'].all(t=>t.model!=='mail.box'&&t.needactionMessagesAsOriginThread.length>0).sort((t1,t2)=>{if(t1.needactionMessagesAsOriginThread.length>0&&t2.needactionMessagesAsOriginThread.length===0){return-1;}
if(t1.needactionMessagesAsOriginThread.length===0&&t2.needactionMessagesAsOriginThread.length>0){return 1;}
if(t1.lastNeedactionMessageAsOriginThread&&t2.lastNeedactionMessageAsOriginThread){return t1.lastNeedactionMessageAsOriginThread.id<t2.lastNeedactionMessageAsOriginThread.id?1:-1;}
if(t1.lastNeedactionMessageAsOriginThread){return-1;}
if(t2.lastNeedactionMessageAsOriginThread){return 1;}
return t1.id<t2.id?-1:1;}).map(thread=>{return{thread,type:'thread_needaction',uniqueId:thread.localId+'_needaction',};});}
const threadNotifications=threads.sort((t1,t2)=>{if(t1.localMessageUnreadCounter>0&&t2.localMessageUnreadCounter===0){return-1;}
if(t1.localMessageUnreadCounter===0&&t2.localMessageUnreadCounter>0){return 1;}
if(t1.lastMessage&&t2.lastMessage){return t1.lastMessage.id<t2.lastMessage.id?1:-1;}
if(t1.lastMessage){return-1;}
if(t2.lastMessage){return 1;}
return t1.id<t2.id?-1:1;}).map(thread=>{return{thread,type:'thread',uniqueId:thread.localId,};});let notifications=threadNeedactionNotifications.concat(threadNotifications);if(props.filter==='all'){const notificationGroups=this.env.messaging.notificationGroupManager.groups;notifications=Object.values(notificationGroups).sort((group1,group2)=>group1.sequence-group2.sequence).map(notificationGroup=>{return{notificationGroup,uniqueId:notificationGroup.localId,};}).concat(notifications);}
if(props.filter==='all'&&this.env.messaging.isNotificationPermissionDefault()){notifications.unshift({type:'odoobotRequest',uniqueId:'odoobotRequest',});}
return{isDeviceMobile:this.env.messaging.device.isMobile,notifications,};}
_useStoreSelectorThreads(props){if(props.filter==='mailbox'){return this.env.models['mail.thread'].all(thread=>thread.isPinned&&thread.model==='mail.box').sort((mailbox1,mailbox2)=>{if(mailbox1===this.env.messaging.inbox){return-1;}
if(mailbox2===this.env.messaging.inbox){return 1;}
if(mailbox1===this.env.messaging.starred){return-1;}
if(mailbox2===this.env.messaging.starred){return 1;}
const mailbox1Name=mailbox1.displayName;const mailbox2Name=mailbox2.displayName;mailbox1Name<mailbox2Name?-1:1;});}else if(props.filter==='channel'){return this.env.models['mail.thread'].all(thread=>thread.channel_type==='channel'&&thread.isPinned&&thread.model==='mail.channel').sort((c1,c2)=>c1.displayName<c2.displayName?-1:1);}else if(props.filter==='chat'){return this.env.models['mail.thread'].all(thread=>thread.isChatChannel&&thread.isPinned&&thread.model==='mail.channel').sort((c1,c2)=>c1.displayName<c2.displayName?-1:1);}else if(props.filter==='all'){return this.env.models['mail.thread'].all(thread=>thread.isPinned&&thread.model==='mail.channel').sort((c1,c2)=>c1.displayName<c2.displayName?-1:1);}else{throw new Error(`Unsupported filter ${props.filter}`);}}}
Object.assign(NotificationList,{_allowedFilters:['all','mailbox','channel','chat'],components,defaultProps:{filter:'all',},props:{filter:{type:String,validate:prop=>NotificationList._allowedFilters.includes(prop),},},template:'mail.NotificationList',});return NotificationList;});;

/* /mail/static/src/components/notification_popover/notification_popover.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/notification_popover/notification_popover.js',function(require){'use strict';const{Component}=owl;const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');class NotificationPopover extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps({compareDepth:{notificationLocalIds:1,},});useStore(props=>{const notifications=props.notificationLocalIds.map(notificationLocalId=>this.env.models['mail.notification'].get(notificationLocalId));return{notifications:notifications.map(notification=>notification?notification.__state:undefined),};},{compareDepth:{notifications:1,},});}
get iconClass(){switch(this.notification.notification_status){case'sent':return'fa fa-check';case'bounce':return'fa fa-exclamation';case'exception':return'fa fa-exclamation';case'ready':return'fa fa-send-o';case'canceled':return'fa fa-trash-o';}
return'';}
get iconTitle(){switch(this.notification.notification_status){case'sent':return this.env._t("Sent");case'bounce':return this.env._t("Bounced");case'exception':return this.env._t("Error");case'ready':return this.env._t("Ready");case'canceled':return this.env._t("Canceled");}
return'';}
get notifications(){return this.props.notificationLocalIds.map(notificationLocalId=>this.env.models['mail.notification'].get(notificationLocalId));}}
Object.assign(NotificationPopover,{props:{notificationLocalIds:{type:Array,element:String,},},template:'mail.NotificationPopover',});return NotificationPopover;});;

/* /mail/static/src/components/notification_request/notification_request.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/notification_request/notification_request.js',function(require){'use strict';const components={PartnerImStatusIcon:require('mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class NotificationRequest extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{return{isDeviceMobile:this.env.messaging.device.isMobile,partnerRoot:this.env.messaging.partnerRoot?this.env.messaging.partnerRoot.__state:undefined,};});}
getHeaderText(){return _.str.sprintf(this.env._t("%s has a request"),this.env.messaging.partnerRoot.nameOrDisplayName);}
_handleResponseNotificationPermission(value){this.env.messaging.messagingMenu.update();if(value!=='granted'){this.env.services['bus_service'].sendNotification(this.env._t("Permission denied"),this.env._t("Odoo will not have the permission to send native notifications on this device."));}}
_onClick(){const windowNotification=this.env.browser.Notification;const def=windowNotification&&windowNotification.requestPermission();if(def){def.then(this._handleResponseNotificationPermission.bind(this));}
if(!this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}}
Object.assign(NotificationRequest,{components,props:{},template:'mail.NotificationRequest',});return NotificationRequest;});;

/* /mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class PartnerImStatusIcon extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const partner=this.env.models['mail.partner'].get(props.partnerLocalId);return{partner,partnerImStatus:partner&&partner.im_status,partnerRoot:this.env.messaging.partnerRoot,};});}
get partner(){return this.env.models['mail.partner'].get(this.props.partnerLocalId);}
_onClick(ev){if(!this.props.hasOpenChat){return;}
this.partner.openChat();}}
Object.assign(PartnerImStatusIcon,{defaultProps:{hasBackground:true,hasOpenChat:false,},props:{partnerLocalId:String,hasBackground:Boolean,hasOpenChat:Boolean,},template:'mail.PartnerImStatusIcon',});return PartnerImStatusIcon;});;

/* /mail/static/src/components/thread_icon/thread_icon.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/thread_icon/thread_icon.js',function(require){'use strict';const components={ThreadTypingIcon:require('mail/static/src/components/thread_typing_icon/thread_typing_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ThreadIcon extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);const correspondent=thread?thread.correspondent:undefined;return{correspondent,correspondentImStatus:correspondent&&correspondent.im_status,history:this.env.messaging.history,inbox:this.env.messaging.inbox,moderation:this.env.messaging.moderation,partnerRoot:this.env.messaging.partnerRoot,starred:this.env.messaging.starred,thread,threadChannelType:thread&&thread.channel_type,threadModel:thread&&thread.model,threadOrderedOtherTypingMembersLength:thread&&thread.orderedOtherTypingMembers.length,threadPublic:thread&&thread.public,threadTypingStatusText:thread&&thread.typingStatusText,};});}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}}
Object.assign(ThreadIcon,{components,props:{threadLocalId:String,},template:'mail.ThreadIcon',});return ThreadIcon;});;

/* /mail/static/src/components/thread_needaction_preview/thread_needaction_preview.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/thread_needaction_preview/thread_needaction_preview.js',function(require){'use strict';const components={MessageAuthorPrefix:require('mail/static/src/components/message_author_prefix/message_author_prefix.js'),PartnerImStatusIcon:require('mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const mailUtils=require('mail.utils');const{Component}=owl;const{useRef}=owl.hooks;class ThreadNeedactionPreview extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);const mainThreadCache=thread?thread.mainCache:undefined;let lastNeedactionMessageAsOriginThreadAuthor;let lastNeedactionMessageAsOriginThread;let threadCorrespondent;if(thread){lastNeedactionMessageAsOriginThread=mainThreadCache.lastNeedactionMessageAsOriginThread;threadCorrespondent=thread.correspondent;}
if(lastNeedactionMessageAsOriginThread){lastNeedactionMessageAsOriginThreadAuthor=lastNeedactionMessageAsOriginThread.author;}
return{isDeviceMobile:this.env.messaging.device.isMobile,lastNeedactionMessageAsOriginThread:lastNeedactionMessageAsOriginThread?lastNeedactionMessageAsOriginThread.__state:undefined,lastNeedactionMessageAsOriginThreadAuthor:lastNeedactionMessageAsOriginThreadAuthor?lastNeedactionMessageAsOriginThreadAuthor.__state:undefined,thread:thread?thread.__state:undefined,threadCorrespondent:threadCorrespondent?threadCorrespondent.__state:undefined,};});this._markAsReadRef=useRef('markAsRead');}
image(){if(this.thread.moduleIcon){return this.thread.moduleIcon;}
if(this.thread.correspondent){return this.thread.correspondent.avatarUrl;}
if(this.thread.model==='mail.channel'){return`/web/image/mail.channel/${this.thread.id}/image_128`;}
return'/mail/static/src/img/smiley/avatar.jpg';}
get inlineLastNeedactionMessageBody(){if(!this.thread.lastNeedactionMessage){return'';}
return mailUtils.htmlToTextContentInline(this.thread.lastNeedactionMessage.prettyBody);}
get inlineLastNeedactionMessageAsOriginThreadBody(){if(!this.thread.lastNeedactionMessageAsOriginThread){return'';}
return mailUtils.htmlToTextContentInline(this.thread.lastNeedactionMessageAsOriginThread.prettyBody);}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_onClick(ev){const markAsRead=this._markAsReadRef.el;if(markAsRead&&markAsRead.contains(ev.target)){return;}
this.thread.open();if(!this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}
_onClickMarkAsRead(ev){this.env.models['mail.message'].markAllAsRead([['model','=',this.thread.model],['res_id','=',this.thread.id],]);}}
Object.assign(ThreadNeedactionPreview,{components,props:{threadLocalId:String,},template:'mail.ThreadNeedactionPreview',});return ThreadNeedactionPreview;});;

/* /mail/static/src/components/thread_preview/thread_preview.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/thread_preview/thread_preview.js',function(require){'use strict';const components={MessageAuthorPrefix:require('mail/static/src/components/message_author_prefix/message_author_prefix.js'),PartnerImStatusIcon:require('mail/static/src/components/partner_im_status_icon/partner_im_status_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const mailUtils=require('mail.utils');const{Component}=owl;const{useRef}=owl.hooks;class ThreadPreview extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);let lastMessageAuthor;let lastMessage;if(thread){const orderedMessages=thread.orderedMessages;lastMessage=orderedMessages[orderedMessages.length-1];}
if(lastMessage){lastMessageAuthor=lastMessage.author;}
return{isDeviceMobile:this.env.messaging.device.isMobile,lastMessage:lastMessage?lastMessage.__state:undefined,lastMessageAuthor:lastMessageAuthor?lastMessageAuthor.__state:undefined,thread:thread?thread.__state:undefined,threadCorrespondent:thread&&thread.correspondent?thread.correspondent.__state:undefined,};});this._markAsReadRef=useRef('markAsRead');}
image(){if(this.thread.correspondent){return this.thread.correspondent.avatarUrl;}
return`/web/image/mail.channel/${this.thread.id}/image_128`;}
get inlineLastMessageBody(){if(!this.thread.lastMessage){return'';}
return mailUtils.htmlToTextContentInline(this.thread.lastMessage.prettyBody);}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}
_onClick(ev){const markAsRead=this._markAsReadRef.el;if(markAsRead&&markAsRead.contains(ev.target)){return;}
this.thread.open();if(!this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}
_onClickMarkAsRead(ev){if(this.thread.lastNonTransientMessage){this.thread.markAsSeen(this.thread.lastNonTransientMessage);}}}
Object.assign(ThreadPreview,{components,props:{threadLocalId:String,},template:'mail.ThreadPreview',});return ThreadPreview;});;

/* /mail/static/src/components/thread_textual_typing_status/thread_textual_typing_status.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/thread_textual_typing_status/thread_textual_typing_status.js',function(require){'use strict';const components={ThreadTypingIcon:require('mail/static/src/components/thread_typing_icon/thread_typing_icon.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const{Component}=owl;class ThreadTextualTypingStatus extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore(props=>{const thread=this.env.models['mail.thread'].get(props.threadLocalId);return{threadOrderedOtherTypingMembersLength:thread&&thread.orderedOtherTypingMembersLength,threadTypingStatusText:thread&&thread.typingStatusText,};});}
get thread(){return this.env.models['mail.thread'].get(this.props.threadLocalId);}}
Object.assign(ThreadTextualTypingStatus,{components,props:{threadLocalId:String,},template:'mail.ThreadTextualTypingStatus',});return ThreadTextualTypingStatus;});;

/* /mail/static/src/components/thread_typing_icon/thread_typing_icon.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/thread_typing_icon/thread_typing_icon.js',function(require){'use strict';const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const{Component}=owl;class ThreadTypingIcon extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();}}
Object.assign(ThreadTypingIcon,{defaultProps:{animation:'none',size:'small',},props:{animation:{type:String,validate:prop=>['bounce','none','pulse'].includes(prop),},size:{type:String,validate:prop=>['small','medium'].includes(prop),},title:{type:String,optional:true,}},template:'mail.ThreadTypingIcon',});return ThreadTypingIcon;});;

/* /mail/static/src/components/thread_view/thread_view.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/components/thread_view/thread_view.js',function(require){'use strict';const components={Composer:require('mail/static/src/components/composer/composer.js'),MessageList:require('mail/static/src/components/message_list/message_list.js'),};const useShouldUpdateBasedOnProps=require('mail/static/src/component_hooks/use_should_update_based_on_props/use_should_update_based_on_props.js');const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const useUpdate=require('mail/static/src/component_hooks/use_update/use_update.js');const{Component}=owl;const{useRef}=owl.hooks;class ThreadView extends Component{constructor(...args){super(...args);useShouldUpdateBasedOnProps();useStore((...args)=>this._useStoreSelector(...args),{compareDepth:{threadTextInputSendShortcuts:1,},});useUpdate({func:()=>this._update()});this._composerRef=useRef('composer');this._messageListRef=useRef('messageList');}
focus(){if(!this._composerRef.comp){return;}
this._composerRef.comp.focus();}
focusout(){if(!this._composerRef.comp){return;}
this._composerRef.comp.focusout();}
getScrollHeight(){if(!this._messageListRef.comp){return undefined;}
return this._messageListRef.comp.getScrollHeight();}
getScrollTop(){if(!this._messageListRef.comp){return undefined;}
return this._messageListRef.comp.getScrollTop();}
onScroll(ev){if(!this._messageListRef.comp){return;}
this._messageListRef.comp.onScroll(ev);}
get threadView(){return this.env.models['mail.thread_view'].get(this.props.threadViewLocalId);}
_update(){this.trigger('o-rendered');}
_useStoreSelector(props){const threadView=this.env.models['mail.thread_view'].get(props.threadViewLocalId);const thread=threadView?threadView.thread:undefined;const threadCache=threadView?threadView.threadCache:undefined;const correspondent=thread&&thread.correspondent;return{composer:thread&&thread.composer,correspondentId:correspondent&&correspondent.id,isDeviceMobile:this.env.messaging.device.isMobile,thread,threadCacheIsLoaded:threadCache&&threadCache.isLoaded,threadIsTemporary:thread&&thread.isTemporary,threadMassMailing:thread&&thread.mass_mailing,threadModel:thread&&thread.model,threadTextInputSendShortcuts:thread&&thread.textInputSendShortcuts||[],threadView,threadViewIsLoading:threadView&&threadView.isLoading,};}}
Object.assign(ThreadView,{components,defaultProps:{composerAttachmentsDetailsMode:'auto',hasComposer:false,hasMessageCheckbox:false,hasSquashCloseMessages:false,haveMessagesMarkAsReadIcon:false,haveMessagesReplyIcon:false,isDoFocus:false,order:'asc',showComposerAttachmentsExtensions:true,showComposerAttachmentsFilenames:true,},props:{composerAttachmentsDetailsMode:{type:String,validate:prop=>['auto','card','hover','none'].includes(prop),},hasComposer:Boolean,hasComposerCurrentPartnerAvatar:{type:Boolean,optional:true,},hasComposerSendButton:{type:Boolean,optional:true,},hasComposerThreadTyping:{type:Boolean,optional:true,},hasMessageCheckbox:Boolean,hasScrollAdjust:{type:Boolean,optional:true,},hasSquashCloseMessages:Boolean,haveMessagesMarkAsReadIcon:Boolean,haveMessagesReplyIcon:Boolean,isDoFocus:Boolean,order:{type:String,validate:prop=>['asc','desc'].includes(prop),},selectedMessageLocalId:{type:String,optional:true,},getScrollableElement:{type:Function,optional:true,},showComposerAttachmentsExtensions:Boolean,showComposerAttachmentsFilenames:Boolean,threadViewLocalId:String,},template:'mail.ThreadView',});return ThreadView;});;

/* /mail/static/src/model/model_core.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/model/model_core.js',function(require){'use strict';const registry={};function _getEntryFromModelName(modelName){if(!registry[modelName]){registry[modelName]={dependencies:[],factory:undefined,name:modelName,patches:[],};}
return registry[modelName];}
function _registerPatchModel(modelName,patchName,patch,{type='instance'}={}){const entry=_getEntryFromModelName(modelName);Object.assign(entry,{patches:(entry.patches||[]).concat([{name:patchName,patch,type,}]),});}
function registerClassPatchModel(modelName,patchName,patch){_registerPatchModel(modelName,patchName,patch,{type:'class'});}
function registerFieldPatchModel(modelName,patchName,patch){_registerPatchModel(modelName,patchName,patch,{type:'field'});}
function registerInstancePatchModel(modelName,patchName,patch){_registerPatchModel(modelName,patchName,patch,{type:'instance'});}
function registerNewModel(name,factory,dependencies=[]){const entry=_getEntryFromModelName(name);let entryDependencies=[...dependencies];if(name!=='mail.model'){entryDependencies=[...new Set(entryDependencies.concat(['mail.model']))];}
if(entry.factory){throw new Error(`Model "${name}" has already been registered!`);}
Object.assign(entry,{dependencies:entryDependencies,factory,name,});}
return{registerClassPatchModel,registerFieldPatchModel,registerInstancePatchModel,registerNewModel,registry,};});;

/* /mail/static/src/model/model_errors.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/model/model_errors.js',function(require){'use strict';class RecordDeletedError extends Error{constructor(recordLocalId,...args){super(...args);this.recordLocalId=recordLocalId;this.name='RecordDeletedError';}}
return{RecordDeletedError,};});;

/* /mail/static/src/model/model_field.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/model/model_field.js',function(require){'use strict';const{clear,FieldCommand}=require('mail/static/src/model/model_field_command.js');class ModelField{constructor({compute,default:def,dependencies=[],dependents=[],env,fieldName,fieldType,hashes:extraHashes=[],inverse,isCausal=false,related,relationType,to,}={}){const id=_.uniqueId('field_');this.compute=compute;this.default=def;this.dependencies=dependencies;this.dependents=dependents;this.env=env;this.fieldName=fieldName;this.fieldType=fieldType;this.hashes=extraHashes.concat([id]);this.id=id;this.inverse=inverse;this.isCausal=isCausal;this.related=related;this.relationType=relationType;this.to=to;if(!this.default&&this.fieldType==='relation'){this.default=[];}}
static attr(options){return Object.assign({fieldType:'attribute'},options);}
static many2many(modelName,options){return ModelField._relation(modelName,Object.assign({},options,{relationType:'many2many'}));}
static many2one(modelName,options){return ModelField._relation(modelName,Object.assign({},options,{relationType:'many2one'}));}
static one2many(modelName,options){return ModelField._relation(modelName,Object.assign({},options,{relationType:'one2many'}));}
static one2one(modelName,options){return ModelField._relation(modelName,Object.assign({},options,{relationType:'one2one'}));}
clear(record,options){let hasChanged=false;if(this.fieldType==='relation'){if(this.parseAndExecuteCommands(record,[['unlink-all']],options)){hasChanged=true;}}
if(this.parseAndExecuteCommands(record,this.default,options)){hasChanged=true;}
return hasChanged;}
combine(field){return new ModelField(Object.assign({},this,{dependencies:this.dependencies.concat(field.dependencies),hashes:this.hashes.concat(field.hashes),}));}
computeRelated(record){const[relationName,relatedFieldName]=this.related.split('.');const Model=record.constructor;const relationField=Model.__fieldMap[relationName];if(['one2many','many2many'].includes(relationField.relationType)){const newVal=[];for(const otherRecord of record[relationName]){const OtherModel=otherRecord.constructor;const otherField=OtherModel.__fieldMap[relatedFieldName];const otherValue=otherField.get(otherRecord);if(otherValue){if(otherValue instanceof Array){for(const v of otherValue){newVal.push(v);}}else{newVal.push(otherValue);}}}
if(this.fieldType==='relation'){return[['replace',newVal]];}
return newVal;}
const otherRecord=record[relationName];if(otherRecord){const OtherModel=otherRecord.constructor;const otherField=OtherModel.__fieldMap[relatedFieldName];const newVal=otherField.get(otherRecord);if(newVal===undefined){return clear();}
if(this.fieldType==='relation'){return[['replace',newVal]];}
return newVal;}
return clear();}
get(record){if(this.fieldType==='attribute'){return this.read(record);}
if(this.fieldType==='relation'){if(['one2one','many2one'].includes(this.relationType)){return this.read(record);}
return[...this.read(record)];}
throw new Error(`cannot get field with unsupported type ${this.fieldType}.`);}
parseAndExecuteCommands(record,newVal,options){if(newVal instanceof FieldCommand){return newVal.execute(this,record,options);}
if(newVal instanceof Array&&newVal[0]instanceof FieldCommand){let hasChanged=false;for(const command of newVal){if(command.execute(this,record,options)){hasChanged=true;}}
return hasChanged;}
return this.set(record,newVal,options);}
read(record){return record.__values[this.fieldName];}
set(record,newVal,options){const currentValue=this.read(record);if(this.fieldType==='attribute'){if(currentValue===newVal){return false;}
record.__values[this.fieldName]=newVal;return true;}
if(this.fieldType==='relation'){let hasChanged=false;for(const val of newVal){switch(val[0]){case'create':if(this._setRelationCreate(record,val[1],options)){hasChanged=true;}
break;case'insert':if(this._setRelationInsert(record,val[1],options)){hasChanged=true;}
break;case'insert-and-replace':if(this._setRelationInsertAndReplace(record,val[1],options)){hasChanged=true;}
break;case'link':if(this._setRelationLink(record,val[1],options)){hasChanged=true;}
break;case'replace':if(this._setRelationReplace(record,val[1],options)){hasChanged=true;}
break;case'unlink':if(this._setRelationUnlink(record,val[1],options)){hasChanged=true;}
break;case'unlink-all':if(this._setRelationUnlink(record,this.get(record),options)){hasChanged=true;}
break;}}
return hasChanged;}}
static _relation(modelName,options){return Object.assign({fieldType:'relation',to:modelName,},options);}
_convertX2ManyValue(newValue,{hasToVerify=true}={}){if(typeof newValue[Symbol.iterator]==='function'){if(hasToVerify){for(const value of newValue){this._verifyRelationalValue(value);}}
return newValue;}
if(hasToVerify){this._verifyRelationalValue(newValue);}
return[newValue];}
_setRelationCreate(record,data,options){const OtherModel=this.env.models[this.to];const other=this.env.modelManager._create(OtherModel,data);return this._setRelationLink(record,other,options);}
_setRelationInsert(record,data,options){const OtherModel=this.env.models[this.to];const other=this.env.modelManager._insert(OtherModel,data);return this._setRelationLink(record,other,options);}
_setRelationInsertAndReplace(record,data,options){const OtherModel=this.env.models[this.to];const newValue=this.env.modelManager._insert(OtherModel,data);return this._setRelationReplace(record,newValue,options);}
_setRelationLink(record,newValue,options){switch(this.relationType){case'many2many':case'one2many':return this._setRelationLinkX2Many(record,newValue,options);case'many2one':case'one2one':return this._setRelationLinkX2One(record,newValue,options);}}
_setRelationLinkX2Many(record,newValue,{hasToUpdateInverse=true}={}){const recordsToLink=this._convertX2ManyValue(newValue);const otherRecords=this.read(record);let hasChanged=false;for(const recordToLink of recordsToLink){if(otherRecords.has(recordToLink)){continue;}
hasChanged=true;otherRecords.add(recordToLink);if(hasToUpdateInverse){this.env.modelManager._update(recordToLink,{[this.inverse]:[['link',record]]},{hasToUpdateInverse:false});}}
return hasChanged;}
_setRelationLinkX2One(record,recordToLink,{hasToUpdateInverse=true}={}){this._verifyRelationalValue(recordToLink);const prevOtherRecord=this.read(record);if(prevOtherRecord===recordToLink){return false;}
this._setRelationUnlinkX2One(record,{hasToUpdateInverse});record.__values[this.fieldName]=recordToLink;if(hasToUpdateInverse){this.env.modelManager._update(recordToLink,{[this.inverse]:[['link',record]]},{hasToUpdateInverse:false});}
return true;}
_setRelationReplace(record,newValue,options){if(['one2one','many2one'].includes(this.relationType)){return this._setRelationLinkX2One(record,newValue,options);}
let hasChanged=false;let hasToReorder=false;const otherRecordsSet=this.read(record);const otherRecordsList=[...otherRecordsSet];const recordsToReplaceList=[...this._convertX2ManyValue(newValue)];const recordsToReplaceSet=new Set(recordsToReplaceList);const recordsToLink=[];for(let i=0;i<recordsToReplaceList.length;i++){const recordToReplace=recordsToReplaceList[i];if(!otherRecordsSet.has(recordToReplace)){recordsToLink.push(recordToReplace);}
if(otherRecordsList[i]!==recordToReplace){hasToReorder=true;}}
if(this._setRelationLinkX2Many(record,recordsToLink,options)){hasChanged=true;}
const recordsToUnlink=[];for(let i=0;i<otherRecordsList.length;i++){const otherRecord=otherRecordsList[i];if(!recordsToReplaceSet.has(otherRecord)){recordsToUnlink.push(otherRecord);}
if(recordsToReplaceList[i]!==otherRecord){hasToReorder=true;}}
if(this._setRelationUnlinkX2Many(record,recordsToUnlink,options)){hasChanged=true;}
if(hasToReorder){otherRecordsSet.clear();for(const record of recordsToReplaceList){otherRecordsSet.add(record);}
hasChanged=true;}
return hasChanged;}
_setRelationUnlink(record,newValue,options){switch(this.relationType){case'many2many':case'one2many':return this._setRelationUnlinkX2Many(record,newValue,options);case'many2one':case'one2one':return this._setRelationUnlinkX2One(record,options);}}
_setRelationUnlinkX2Many(record,newValue,{hasToUpdateInverse=true}={}){const recordsToUnlink=this._convertX2ManyValue(newValue,{hasToVerify:false});const otherRecords=this.read(record);let hasChanged=false;for(const recordToUnlink of recordsToUnlink){const wasLinked=otherRecords.delete(recordToUnlink);if(!wasLinked){continue;}
hasChanged=true;if(hasToUpdateInverse){if(!recordToUnlink.exists()){continue;}
if(this.isCausal){this.env.modelManager._delete(recordToUnlink);}else{this.env.modelManager._update(recordToUnlink,{[this.inverse]:[['unlink',record]]},{hasToUpdateInverse:false});}}}
return hasChanged;}
_setRelationUnlinkX2One(record,{hasToUpdateInverse=true}={}){const otherRecord=this.read(record);if(!otherRecord){return false;}
record.__values[this.fieldName]=undefined;if(hasToUpdateInverse){if(!otherRecord.exists()){return;}
if(this.isCausal){this.env.modelManager._delete(otherRecord);}else{this.env.modelManager._update(otherRecord,{[this.inverse]:[['unlink',record]]},{hasToUpdateInverse:false});}}
return true;}
_verifyRelationalValue(record){const OtherModel=this.env.models[this.to];if(!OtherModel.get(record.localId,{isCheckingInheritance:true})){throw Error(`Record ${record.localId} is not valid for relational field ${this.fieldName}.`);}}}
return ModelField;});;

/* /mail/static/src/model/model_field_command.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/model/model_field_command.js',function(require){'use strict';class FieldCommand{constructor(func){this.func=func;}
execute(field,record,options){return this.func(field,record,options);}}
function clear(){return new FieldCommand((field,record,options)=>field.clear(record,options));}
function decrement(amount=1){return new FieldCommand((field,record,options)=>{const oldValue=field.get(record);return field.set(record,oldValue-amount,options);});}
function increment(amount=1){return new FieldCommand((field,record,options)=>{const oldValue=field.get(record);return field.set(record,oldValue+amount,options);});}
return{FieldCommand,clear,decrement,increment,};});;

/* /mail/static/src/model/model_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/model/model_manager.js',function(require){'use strict';const{registry}=require('mail/static/src/model/model_core.js');const ModelField=require('mail/static/src/model/model_field.js');const{patchClassMethods,patchInstanceMethods}=require('mail/static/src/utils/utils.js');const DEPENDENT_INNER_SEPARATOR="--//--//--";class ModelManager{constructor(env){this.DEPENDENT_INNER_SEPARATOR=DEPENDENT_INNER_SEPARATOR;this.env=env;this._createdRecords=new Set();this._hasAnyChangeDuringCycle=false;this._updatedRecords=new Set();this._toComputeFields=new Map();this._toUpdateAfters=new Map();}
start(){Object.assign(this.env.models,this._generateModels());}
all(Model,filterFunc){const allRecords=Object.values(Model.__records);if(filterFunc){return allRecords.filter(filterFunc);}
return allRecords;}
create(Model,data={}){const res=this._create(Model,data);this._flushUpdateCycle();return res;}
delete(record){this._delete(record);this._flushUpdateCycle();}
deleteAll(){for(const Model of Object.values(this.env.models)){for(const record of Object.values(Model.__records)){this._delete(record);}}
this._flushUpdateCycle();}
exists(Model,record){return Model.__records[record.localId]?true:false;}
find(Model,findFunc){return this.all(Model).find(findFunc);}
findFromIdentifyingData(Model,data){const localId=Model._createRecordLocalId(data);return Model.get(localId);}
get(Model,localId,{isCheckingInheritance=false}={}){if(!localId){return;}
const record=Model.__records[localId];if(record){return record;}
if(!isCheckingInheritance){return;}
for(const SubModel of Object.values(this.env.models)){if(!(SubModel.prototype instanceof Model)){continue;}
const record=SubModel.__records[localId];if(record){return record;}}
return;}
insert(Model,data){const res=this._insert(Model,data);this._flushUpdateCycle();return res;}
update(record,data){const res=this._update(record,data);this._flushUpdateCycle();return res;}
_applyModelPatchFields(Model,patch){for(const[fieldName,field]of Object.entries(patch)){if(!Model.fields[fieldName]){Model.fields[fieldName]=field;}else{Object.assign(Model.fields[fieldName].dependencies,field.dependencies);}}}
_checkDeclaredFieldsOnModels(Models){for(const Model of Object.values(Models)){for(const fieldName in Model.fields){const field=Model.fields[fieldName];const parentedMatchingFields=[];let TargetModel=Model.__proto__;while(Models[TargetModel.modelName]){if(TargetModel.fields){const matchingField=TargetModel.fields[fieldName];if(matchingField){parentedMatchingFields.push(matchingField);}}
TargetModel=TargetModel.__proto__;}
if(!(['attribute','relation'].includes(field.fieldType))){throw new Error(`Field "${Model.modelName}/${fieldName}" has unsupported type ${field.fieldType}.`);}
if(field.fieldType==='attribute'){const invalidKeys=Object.keys(field).filter(key=>!['compute','default','dependencies','fieldType','related',].includes(key));if(invalidKeys.length>0){throw new Error(`Field "${Model.modelName}/${fieldName}" contains some invalid keys: "${invalidKeys.join(", ")}".`);}}
if(field.fieldType==='relation'){const invalidKeys=Object.keys(field).filter(key=>!['compute','default','dependencies','fieldType','inverse','isCausal','related','relationType','to',].includes(key));if(invalidKeys.length>0){throw new Error(`Field "${Model.modelName}/${fieldName}" contains some invalid keys: "${invalidKeys.join(", ")}".`);}
if(!Models[field.to]){throw new Error(`Relational field "${Model.modelName}/${fieldName}" targets to unknown model name "${field.to}".`);}
if(field.isCausal&&!(['one2many','one2one'].includes(field.relationType))){throw new Error(`Relational field "${Model.modelName}/${fieldName}" has "isCausal" true with a relation of type "${field.relationType}" but "isCausal" is only supported for "one2many" and "one2one".`);}}
if(field.compute&&!(typeof field.compute==='string')){throw new Error(`Field "${Model.modelName}/${fieldName}" property "compute" must be a string (instance method name).`);}
if(field.compute&&!(Model.prototype[field.compute])){throw new Error(`Field "${Model.modelName}/${fieldName}" property "compute" does not refer to an instance method of this Model.`);}
if(field.dependencies&&(!field.compute&&!parentedMatchingFields.some(field=>field.compute))){throw new Error(`Field "${Model.modelName}/${fieldName} contains dependendencies but no compute method in itself or parented matching fields (dependencies only make sense for compute fields)."`);}
if((field.compute||parentedMatchingFields.some(field=>field.compute))&&(field.dependencies||parentedMatchingFields.some(field=>field.dependencies))){if(!(field.dependencies instanceof Array)){throw new Error(`Compute field "${Model.modelName}/${fieldName}" dependencies must be an array of field names.`);}
const unknownDependencies=field.dependencies.every(dependency=>!(Model.fields[dependency]));if(unknownDependencies.length>0){throw new Error(`Compute field "${Model.modelName}/${fieldName}" contains some unknown dependencies: "${unknownDependencies.join(", ")}".`);}}
if(field.compute&&field.related){throw new Error(`Field "${Model.modelName}/${fieldName}" cannot be a related and compute field at the same time.`);}
if(field.related){if(!(typeof field.related==='string')){throw new Error(`Field "${Model.modelName}/${fieldName}" property "related" has invalid format.`);}
const[relationName,relatedFieldName,other]=field.related.split('.');if(!relationName||!relatedFieldName||other){throw new Error(`Field "${Model.modelName}/${fieldName}" property "related" has invalid format.`);}
let relatedRelation;let TargetModel=Model;while(Models[TargetModel.modelName]&&!relatedRelation){if(TargetModel.fields){relatedRelation=TargetModel.fields[relationName];}
TargetModel=TargetModel.__proto__;}
if(!relatedRelation){throw new Error(`Related field "${Model.modelName}/${fieldName}" relates to unknown relation name "${relationName}".`);}
if(relatedRelation.fieldType!=='relation'){throw new Error(`Related field "${Model.modelName}/${fieldName}" relates to non-relational field "${relationName}".`);}
const RelatedModel=Models[relatedRelation.to];let relatedField;TargetModel=RelatedModel;while(Models[TargetModel.modelName]&&!relatedField){if(TargetModel.fields){relatedField=TargetModel.fields[relatedFieldName];}
TargetModel=TargetModel.__proto__;}
if(!relatedField){throw new Error(`Related field "${Model.modelName}/${fieldName}" relates to unknown related model field "${relatedFieldName}".`);}
if(relatedField.fieldType!==field.fieldType){throw new Error(`Related field "${Model.modelName}/${fieldName}" has mismatch type with its related model field.`);}
if(relatedField.fieldType==='relation'&&relatedField.to!==field.to){throw new Error(`Related field "${Model.modelName}/${fieldName}" has mismatch target model name with its related model field.`);}}}}}
_checkProcessedFieldsOnModels(Models){for(const Model of Object.values(Models)){for(const fieldName in Model.fields){const field=Model.fields[fieldName];if(!(['attribute','relation'].includes(field.fieldType))){throw new Error(`Field "${Model.modelName}/${fieldName}" has unsupported type ${field.fieldType}.`);}
if(field.compute&&field.related){throw new Error(`Field "${Model.modelName}/${fieldName}" cannot be a related and compute field at the same time.`);}
if(field.fieldType==='attribute'){continue;}
if(!field.relationType){throw new Error(`Field "${Model.modelName}/${fieldName}" must define a relation type in "relationType".`);}
if(!(['one2one','one2many','many2one','many2many'].includes(field.relationType))){throw new Error(`Field "${Model.modelName}/${fieldName}" has invalid relation type "${field.relationType}".`);}
if(!field.inverse){throw new Error(`Field "${
                            Model.modelName
                        }/${
                            fieldName
                        }" must define an inverse relation name in "inverse".`);}
if(!field.to){throw new Error(`Relation "${
                            Model.modelNames
                        }/${
                            fieldName
                        }" must define a model name in "to" (1st positional parameter of relation field helpers).`);}
const RelatedModel=Models[field.to];if(!RelatedModel){throw new Error(`Model name of relation "${Model.modelName}/${fieldName}" does not exist.`);}
const inverseField=RelatedModel.fields[field.inverse];if(!inverseField){throw new Error(`Relation "${
                            Model.modelName
                        }/${
                            fieldName
                        }" has no inverse field "${RelatedModel.modelName}/${field.inverse}".`);}
if(inverseField.inverse!==fieldName){throw new Error(`Inverse field name of relation "${
                            Model.modelName
                        }/${
                            fieldName
                        }" does not match with field name of relation "${
                            RelatedModel.modelName
                        }/${
                            inverseField.inverse
                        }".`);}
const allSelfAndParentNames=[];let TargetModel=Model;while(TargetModel){allSelfAndParentNames.push(TargetModel.modelName);TargetModel=TargetModel.__proto__;}
if(!allSelfAndParentNames.includes(inverseField.to)){throw new Error(`Relation "${
                            Model.modelName
                        }/${
                            fieldName
                        }" has inverse relation "${
                            RelatedModel.modelName
                        }/${
                            field.inverse
                        }" misconfigured (currently "${
                            inverseField.to
                        }", should instead refer to this model or parented models: ${
                            allSelfAndParentNames.map(name => `"${name}"`).join(', ')
                        }?)`);}
if((field.relationType==='many2many'&&inverseField.relationType!=='many2many')||(field.relationType==='one2one'&&inverseField.relationType!=='one2one')||(field.relationType==='one2many'&&inverseField.relationType!=='many2one')||(field.relationType==='many2one'&&inverseField.relationType!=='one2many')){throw new Error(`Mismatch relations types "${
                            Model.modelName
                        }/${
                            fieldName
                        }" (${
                            field.relationType
                        }) and "${
                            RelatedModel.modelName
                        }/${
                            field.inverse
                        }" (${
                            inverseField.relationType
                        }).`);}}}}
_create(Model,data={}){const isMulti=typeof data[Symbol.iterator]==='function';const dataList=isMulti?data:[data];const records=[];for(const data of dataList){const localId=Model._createRecordLocalId(data);if(Model.get(localId)){throw Error(`A record already exists for model "${Model.modelName}" with localId "${localId}".`);}
const record=new Model({valid:true});Object.assign(record,{env:this.env,localId,__values:{},__state:0,});for(const field of Model.__fieldList){if(field.fieldType==='relation'){if(['one2many','many2many'].includes(field.relationType)){record.__values[field.fieldName]=new Set();}}}
Model.__records[record.localId]=record;record._willCreate();const data2={};for(const field of Model.__fieldList){if(data[field.fieldName]!==undefined){data2[field.fieldName]=data[field.fieldName];}else{data2[field.fieldName]=field.default;}
if(field.compute||field.related){this._registerToComputeField(record,field);}}
this._update(record,data2);this._createdRecords.add(record);this._hasAnyChangeDuringCycle=true;records.push(record);}
return isMulti?records:records[0];}
_delete(record){const Model=record.constructor;if(!record.exists()){throw Error(`Cannot delete already deleted record ${record.localId}.`);}
record._willDelete();for(const field of Model.__fieldList){if(field.fieldType==='relation'){field.parseAndExecuteCommands(record,[['unlink-all']]);}}
this._hasAnyChangeDuringCycle=true;this._createdRecords.delete(record);this._toComputeFields.delete(record);this._toUpdateAfters.delete(record);delete Model.__records[record.localId];}
_flushUpdateCycle(func){while(this._toComputeFields.size>0){for(const[record,fields]of this._toComputeFields){this._toComputeFields.delete(record);if(!record.exists()){throw Error(`Cannot execute computes for already deleted record ${record.localId}.`);}
while(fields.size>0){for(const field of fields){fields.delete(field);if(field.compute){this._update(record,{[field.fieldName]:record[field.compute]()});continue;}
if(field.related){this._update(record,{[field.fieldName]:field.computeRelated(record)});continue;}
throw new Error("No compute method defined on this field definition");}}}}
while(this._toUpdateAfters.size>0){for(const[record,previous]of this._toUpdateAfters){this._toUpdateAfters.delete(record);if(!record.exists()){throw Error(`Cannot _updateAfter for already deleted record ${record.localId}.`);}
record._updateAfter(previous);}}
while(this._createdRecords.size>0){for(const record of this._createdRecords){this._createdRecords.delete(record);if(!record.exists()){throw Error(`Cannot call _created for already deleted record ${record.localId}.`);}
record._created();}}
for(const record of this._updatedRecords){record.__state++;}
this._updatedRecords.clear();if(this._hasAnyChangeDuringCycle){this.env.store.state.messagingRevNumber++;this._hasAnyChangeDuringCycle=false;}}
_generateModels(){const allNames=Object.keys(registry);const Models={};const generatedNames=[];let toGenerateNames=[...allNames];while(toGenerateNames.length>0){const generatable=toGenerateNames.map(name=>registry[name]).find(entry=>{let isGenerateable=true;for(const dependencyName of entry.dependencies){if(!generatedNames.includes(dependencyName)){isGenerateable=false;}}
return isGenerateable;});if(!generatable){throw new Error(`Cannot generate following Model: ${toGenerateNames.join(', ')}`);}
if(!generatable.factory){throw new Error(`Missing factory for the following Model: ${generatable.name} (maybe check for typo in name?)`);}
const Model=generatable.factory(Models);Model.env=this.env;Model.__records={};for(const patch of generatable.patches){switch(patch.type){case'class':patchClassMethods(Model,patch.name,patch.patch);break;case'instance':patchInstanceMethods(Model,patch.name,patch.patch);break;case'field':this._applyModelPatchFields(Model,patch.patch);break;}}
if(!Object.prototype.hasOwnProperty.call(Model,'modelName')){throw new Error(`Missing static property "modelName" on Model class "${Model.name}".`);}
if(generatedNames.includes(Model.modelName)){throw new Error(`Duplicate model name "${Model.modelName}" shared on 2 distinct Model classes.`);}
Models[Model.modelName]=Model;generatedNames.push(Model.modelName);toGenerateNames=toGenerateNames.filter(name=>name!==Model.modelName);}
this._checkDeclaredFieldsOnModels(Models);this._processDeclaredFieldsOnModels(Models);this._checkProcessedFieldsOnModels(Models);return Models;}
_insert(Model,data){const isMulti=typeof data[Symbol.iterator]==='function';const dataList=isMulti?data:[data];const records=[];for(const data of dataList){let record=Model.findFromIdentifyingData(data);if(!record){record=this._create(Model,data);}else{this._update(record,data);}
records.push(record);}
return isMulti?records:records[0];}
_makeInverseRelationField(Model,field){const relFunc=field.relationType==='many2many'?ModelField.many2many:field.relationType==='many2one'?ModelField.one2many:field.relationType==='one2many'?ModelField.many2one:field.relationType==='one2one'?ModelField.one2one:undefined;if(!relFunc){throw new Error(`Cannot compute inverse Relation of "${Model.modelName}/${field.fieldName}".`);}
const inverseField=new ModelField(Object.assign({},relFunc(Model.modelName,{inverse:field.fieldName}),{env:this.env,fieldName:`_inverse_${Model.modelName}/${field.fieldName}`,modelManager:this,}));return inverseField;}
_processDeclaredFieldsOnModels(Models){for(const Model of Object.values(Models)){if(!Object.prototype.hasOwnProperty.call(Model,'fields')){Model.fields={};}
Model.inverseRelations=[];for(const[fieldName,fieldData]of Object.entries(Model.fields)){Model.fields[fieldName]=new ModelField(Object.assign({},fieldData,{env:this.env,fieldName,modelManager:this,}));}}
for(const Model of Object.values(Models)){for(const field of Object.values(Model.fields)){if(field.fieldType!=='relation'){continue;}
if(field.inverse){continue;}
const RelatedModel=Models[field.to];const inverseField=this._makeInverseRelationField(Model,field);field.inverse=inverseField.fieldName;RelatedModel.fields[inverseField.fieldName]=inverseField;}}
for(const Model of Object.values(Models)){for(const field of Object.values(Model.fields)){for(const dependencyFieldName of field.dependencies){let TargetModel=Model;let dependencyField=TargetModel.fields[dependencyFieldName];while(!dependencyField){TargetModel=TargetModel.__proto__;dependencyField=TargetModel.fields[dependencyFieldName];}
const dependent=[field.id,field.fieldName].join(DEPENDENT_INNER_SEPARATOR);dependencyField.dependents=[...new Set(dependencyField.dependents.concat([dependent]))];}
if(field.related){const[relationName,relatedFieldName]=field.related.split('.');let TargetModel=Model;let relationField=TargetModel.fields[relationName];while(!relationField){TargetModel=TargetModel.__proto__;relationField=TargetModel.fields[relationName];}
const relationFieldDependent=[field.id,field.fieldName,].join(DEPENDENT_INNER_SEPARATOR);relationField.dependents=[...new Set(relationField.dependents.concat([relationFieldDependent]))];const OtherModel=Models[relationField.to];let OtherTargetModel=OtherModel;let relatedField=OtherTargetModel.fields[relatedFieldName];while(!relatedField){OtherTargetModel=OtherTargetModel.__proto__;relatedField=OtherTargetModel.fields[relatedFieldName];}
const relatedFieldDependent=[field.id,relationField.inverse,field.fieldName,].join(DEPENDENT_INNER_SEPARATOR);relatedField.dependents=[...new Set(relatedField.dependents.concat([relatedFieldDependent]))];}}}
for(const Model of Object.values(Models)){Model.__combinedFields={};for(const field of Object.values(Model.fields)){Model.__combinedFields[field.fieldName]=field;}
let TargetModel=Model.__proto__;while(TargetModel&&TargetModel.fields){for(const targetField of Object.values(TargetModel.fields)){const field=Model.__combinedFields[targetField.fieldName];if(field){Model.__combinedFields[targetField.fieldName]=field.combine(targetField);}else{Model.__combinedFields[targetField.fieldName]=targetField;}}
TargetModel=TargetModel.__proto__;}}
for(const Model of Object.values(Models)){Model.__fieldMap=Model.__combinedFields;Model.__fieldList=Object.values(Model.__fieldMap);for(const field of Model.__fieldList){Object.defineProperty(Model.prototype,field.fieldName,{get(){return field.get(this);},});}
delete Model.__combinedFields;}}
_registerComputeOfDependents(record,field){const Model=record.constructor;for(const dependent of field.dependents){const[hash,fieldName1,fieldName2]=dependent.split(this.DEPENDENT_INNER_SEPARATOR);const field1=Model.__fieldMap[fieldName1];if(fieldName2){if(['one2many','many2many'].includes(field1.relationType)){for(const otherRecord of record[fieldName1]){const OtherModel=otherRecord.constructor;const field2=OtherModel.__fieldMap[fieldName2];if(field2&&field2.hashes.includes(hash)){this._registerToComputeField(otherRecord,field2);}}}else{const otherRecord=record[fieldName1];if(!otherRecord){continue;}
const OtherModel=otherRecord.constructor;const field2=OtherModel.__fieldMap[fieldName2];if(field2&&field2.hashes.includes(hash)){this._registerToComputeField(otherRecord,field2);}}}else{if(field1&&field1.hashes.includes(hash)){this._registerToComputeField(record,field1);}}}}
_registerToComputeField(record,field){if(!this._toComputeFields.has(record)){this._toComputeFields.set(record,new Set());}
this._toComputeFields.get(record).add(field);}
_update(record,data,options){if(!record.exists()){throw Error(`Cannot update already deleted record ${record.localId}.`);}
if(!this._toUpdateAfters.has(record)){this._toUpdateAfters.set(record,record._updateBefore());}
const Model=record.constructor;let hasChanged=false;for(const fieldName of Object.keys(data)){if(data[fieldName]===undefined){continue;}
const field=Model.__fieldMap[fieldName];if(!field){throw new Error(`Cannot create/update record with data unrelated to a field. (model: "${Model.modelName}", non-field attempted update: "${fieldName}")`);}
const newVal=data[fieldName];if(!field.parseAndExecuteCommands(record,newVal,options)){continue;}
hasChanged=true;this._registerComputeOfDependents(record,field);}
if(hasChanged){this._updatedRecords.add(record);this._hasAnyChangeDuringCycle=true;}
return hasChanged;}}
return ModelManager;});;

/* /mail/static/src/models/activity/activity.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/activity/activity/js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');function factory(dependencies){class Activity extends dependencies['mail.model']{async deleteServerRecord(){await this.async(()=>this.env.services.rpc({model:'mail.activity',method:'unlink',args:[[this.id]],}));this.delete();}
static convertData(data){const data2={};if('activity_category'in data){data2.category=data.activity_category;}
if('can_write'in data){data2.canWrite=data.can_write;}
if('create_date'in data){data2.dateCreate=data.create_date;}
if('date_deadline'in data){data2.dateDeadline=data.date_deadline;}
if('force_next'in data){data2.force_next=data.force_next;}
if('icon'in data){data2.icon=data.icon;}
if('id'in data){data2.id=data.id;}
if('note'in data){data2.note=data.note;}
if('state'in data){data2.state=data.state;}
if('summary'in data){data2.summary=data.summary;}
if('activity_type_id'in data){if(!data.activity_type_id){data2.type=[['unlink-all']];}else{data2.type=[['insert',{displayName:data.activity_type_id[1],id:data.activity_type_id[0],}],];}}
if('create_uid'in data){if(!data.create_uid){data2.creator=[['unlink-all']];}else{data2.creator=[['insert',{id:data.create_uid[0],display_name:data.create_uid[1],}],];}}
if('mail_template_ids'in data){data2.mailTemplates=[['insert',data.mail_template_ids]];}
if('res_id'in data&&'res_model'in data){data2.thread=[['insert',{id:data.res_id,model:data.res_model,}]];}
if('user_id'in data){if(!data.user_id){data2.assignee=[['unlink-all']];}else{data2.assignee=[['insert',{id:data.user_id[0],display_name:data.user_id[1],}],];}}
if('request_partner_id'in data){if(!data.request_partner_id){data2.requestingPartner=[['unlink']];}else{data2.requestingPartner=[['insert',{id:data.request_partner_id[0],display_name:data.request_partner_id[1],}],];}}
return data2;}
edit(){const action={type:'ir.actions.act_window',name:this.env._t("Schedule Activity"),res_model:'mail.activity',view_mode:'form',views:[[false,'form']],target:'new',context:{default_res_id:this.thread.id,default_res_model:this.thread.model,},res_id:this.id,};this.env.bus.trigger('do-action',{action,options:{on_close:()=>this.fetchAndUpdate()},});}
async fetchAndUpdate(){const[data]=await this.async(()=>this.env.services.rpc({model:'mail.activity',method:'activity_format',args:[this.id],},{shadow:true}));let shouldDelete=false;if(data){this.update(this.constructor.convertData(data));}else{shouldDelete=true;}
this.thread.refreshActivities();this.thread.refresh();if(shouldDelete){this.delete();}}
async markAsDone({attachments=[],feedback=false}){const attachmentIds=attachments.map(attachment=>attachment.id);await this.async(()=>this.env.services.rpc({model:'mail.activity',method:'action_feedback',args:[[this.id]],kwargs:{attachment_ids:attachmentIds,feedback,},}));this.thread.refresh();this.delete();}
async markAsDoneAndScheduleNext({feedback}){const action=await this.async(()=>this.env.services.rpc({model:'mail.activity',method:'action_feedback_schedule_next',args:[[this.id]],kwargs:{feedback},}));this.thread.refresh();const thread=this.thread;this.delete();if(!action){thread.refreshActivities();return;}
this.env.bus.trigger('do-action',{action,options:{on_close:()=>{thread.refreshActivities();},},});}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeIsCurrentPartnerAssignee(){if(!this.assigneePartner||!this.messagingCurrentPartner){return false;}
return this.assigneePartner===this.messagingCurrentPartner;}
_computeMessaging(){return[['link',this.env.messaging]];}
_computeNote(){if(this.note==='<p><br></p>'){return clear();}
return this.note;}}
Activity.fields={assignee:many2one('mail.user'),assigneePartner:many2one('mail.partner',{related:'assignee.partner',}),attachments:many2many('mail.attachment',{inverse:'activities',}),canWrite:attr({default:false,}),category:attr(),creator:many2one('mail.user'),dateCreate:attr(),dateDeadline:attr(),feedbackBackup:attr(),force_next:attr({default:false,}),icon:attr(),id:attr(),isCurrentPartnerAssignee:attr({compute:'_computeIsCurrentPartnerAssignee',default:false,dependencies:['assigneePartner','messagingCurrentPartner',],}),mailTemplates:many2many('mail.mail_template',{inverse:'activities',}),messaging:many2one('mail.messaging',{compute:'_computeMessaging',}),messagingCurrentPartner:many2one('mail.partner',{related:'messaging.currentPartner',}),note:attr({compute:'_computeNote',dependencies:['note',],}),requestingPartner:many2one('mail.partner'),state:attr(),summary:attr(),thread:many2one('mail.thread',{inverse:'activities',}),type:many2one('mail.activity_type',{inverse:'activities',}),};Activity.modelName='mail.activity';return Activity;}
registerNewModel('mail.activity',factory);});;

/* /mail/static/src/models/activity_type/activity_type.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/activity_type/activity_type.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,one2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class ActivityType extends dependencies['mail.model']{static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}}
ActivityType.fields={activities:one2many('mail.activity',{inverse:'type',}),displayName:attr(),id:attr(),};ActivityType.modelName='mail.activity_type';return ActivityType;}
registerNewModel('mail.activity_type',factory);});;

/* /mail/static/src/models/attachment/attachment.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/attachment/attachment.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');function factory(dependencies){let nextTemporaryId=-1;function getAttachmentNextTemporaryId(){const id=nextTemporaryId;nextTemporaryId-=1;return id;}
class Attachment extends dependencies['mail.model']{static convertData(data){const data2={};if('filename'in data){data2.filename=data.filename;}
if('id'in data){data2.id=data.id;}
if('mimetype'in data){data2.mimetype=data.mimetype;}
if('name'in data){data2.name=data.name;}
if('res_id'in data&&'res_model'in data){data2.originThread=[['insert',{id:data.res_id,model:data.res_model,}]];}
return data2;}
static create(data){const isMulti=typeof data[Symbol.iterator]==='function';const dataList=isMulti?data:[data];for(const data of dataList){if(!data.id){data.id=getAttachmentNextTemporaryId();}}
return super.create(...arguments);}
static view({attachment,attachments}){const hasOtherAttachments=attachments&&attachments.length>0;if(!attachment&&!hasOtherAttachments){return;}
if(!attachment&&hasOtherAttachments){attachment=attachments[0];}else if(attachment&&!hasOtherAttachments){attachments=[attachment];}
if(!attachments.includes(attachment)){return;}
this.env.messaging.dialogManager.open('mail.attachment_viewer',{attachment:[['link',attachment]],attachments:[['replace',attachments]],});}
async remove(){if(this.isUnlinkPending){return;}
if(!this.isTemporary){this.update({isUnlinkPending:true});try{await this.async(()=>this.env.services.rpc({model:'ir.attachment',method:'unlink',args:[this.id],},{shadow:true}));}finally{this.update({isUnlinkPending:false});}}else if(this.uploadingAbortController){this.uploadingAbortController.abort();}
this.delete();}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeComposers(){if(this.isTemporary){return[];}
const relatedTemporaryAttachment=this.env.models['mail.attachment'].find(attachment=>attachment.filename===this.filename&&attachment.isTemporary);if(relatedTemporaryAttachment){const composers=relatedTemporaryAttachment.composers;relatedTemporaryAttachment.delete();return[['replace',composers]];}
return[];}
_computeDefaultSource(){if(this.fileType==='image'){return`/web/image/${this.id}?unique=1&amp;signature=${this.checksum}&amp;model=ir.attachment`;}
if(this.fileType==='application/pdf'){return`/web/static/lib/pdfjs/web/viewer.html?file=/web/content/${this.id}?model%3Dir.attachment`;}
if(this.fileType&&this.fileType.includes('text')){return`/web/content/${this.id}?model%3Dir.attachment`;}
if(this.fileType==='youtu'){const urlArr=this.url.split('/');let token=urlArr[urlArr.length-1];if(token.includes('watch')){token=token.split('v=')[1];const amp=token.indexOf('&');if(amp!==-1){token=token.substring(0,amp);}}
return`https://www.youtube.com/embed/${token}`;}
if(this.fileType==='video'){return`/web/content/${this.id}?model=ir.attachment`;}
return clear();}
_computeDisplayName(){const displayName=this.name||this.filename;if(displayName){return displayName;}
return clear();}
_computeExtension(){const extension=this.filename&&this.filename.split('.').pop();if(extension){return extension;}
return clear();}
_computeFileType(){if(this.type==='url'&&!this.url){return clear();}else if(!this.mimetype){return clear();}
switch(this.mimetype){case'application/pdf':return'application/pdf';case'image/bmp':case'image/gif':case'image/jpeg':case'image/png':case'image/svg+xml':case'image/tiff':case'image/x-icon':return'image';case'application/javascript':case'application/json':case'text/css':case'text/html':case'text/plain':return'text';case'audio/mpeg':case'video/x-matroska':case'video/mp4':case'video/webm':return'video';}
if(!this.url){return clear();}
if(this.url.match('(.png|.jpg|.gif)')){return'image';}
if(this.url.includes('youtu')){return'youtu';}
return clear();}
_computeIsLinkedToComposer(){return this.composers.length>0;}
_computeIsTextFile(){if(!this.fileType){return false;}
return this.fileType==='text';}
_computeIsViewable(){switch(this.mimetype){case'application/javascript':case'application/json':case'application/pdf':case'audio/mpeg':case'image/bmp':case'image/gif':case'image/jpeg':case'image/png':case'image/svg+xml':case'image/tiff':case'image/x-icon':case'text/css':case'text/html':case'text/plain':case'video/x-matroska':case'video/mp4':case'video/webm':return true;default:return false;}}
_computeMediaType(){return this.mimetype&&this.mimetype.split('/').shift();}
_computeUploadingAbortController(){if(this.isTemporary){if(!this.uploadingAbortController){const abortController=new AbortController();abortController.signal.onabort=()=>{this.env.messagingBus.trigger('o-attachment-upload-abort',{attachment:this});};return abortController;}
return this.uploadingAbortController;}
return undefined;}}
Attachment.fields={activities:many2many('mail.activity',{inverse:'attachments',}),attachmentViewer:many2many('mail.attachment_viewer',{inverse:'attachments',}),checkSum:attr(),composers:many2many('mail.composer',{compute:'_computeComposers',inverse:'attachments',}),defaultSource:attr({compute:'_computeDefaultSource',dependencies:['checkSum','fileType','id','url',],}),displayName:attr({compute:'_computeDisplayName',dependencies:['filename','name',],}),extension:attr({compute:'_computeExtension',dependencies:['filename'],}),filename:attr(),fileType:attr({compute:'_computeFileType',dependencies:['mimetype','type','url',],}),id:attr(),isLinkedToComposer:attr({compute:'_computeIsLinkedToComposer',dependencies:['composers'],}),isTemporary:attr({default:false,}),isTextFile:attr({compute:'_computeIsTextFile',dependencies:['fileType'],}),isUnlinkPending:attr({default:false,}),isViewable:attr({compute:'_computeIsViewable',dependencies:['mimetype',],}),mediaType:attr({compute:'_computeMediaType',dependencies:['mimetype'],}),messages:many2many('mail.message',{inverse:'attachments',}),mimetype:attr({default:'',}),name:attr(),originThread:many2one('mail.thread',{inverse:'originThreadAttachments',}),size:attr(),threads:many2many('mail.thread',{inverse:'attachments',}),type:attr(),uploadingAbortController:attr({compute:'_computeUploadingAbortController',dependencies:['isTemporary','uploadingAbortController',],}),url:attr(),};Attachment.modelName='mail.attachment';return Attachment;}
registerNewModel('mail.attachment',factory);});;

/* /mail/static/src/models/attachment_viewer/attachment_viewer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/attachment_viewer/attachment_viewer.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class AttachmentViewer extends dependencies['mail.model']{close(){const dialog=this.env.models['mail.dialog'].find(dialog=>dialog.record===this);if(dialog){dialog.delete();}}}
AttachmentViewer.fields={angle:attr({default:0,}),attachment:many2one('mail.attachment'),attachments:many2many('mail.attachment',{inverse:'attachmentViewer',}),isImageLoading:attr({default:false,}),scale:attr({default:1,}),};AttachmentViewer.modelName='mail.attachment_viewer';return AttachmentViewer;}
registerNewModel('mail.attachment_viewer',factory);});;

/* /mail/static/src/models/canned_response/canned_response.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/canned_response/canned_response.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');const{cleanSearchTerm}=require('mail/static/src/utils/utils.js');function factory(dependencies){class CannedResponse extends dependencies['mail.model']{static fetchSuggestions(searchTerm,{thread}={}){}
static getSuggestionSortFunction(searchTerm,{thread}={}){const cleanedSearchTerm=cleanSearchTerm(searchTerm);return(a,b)=>{const cleanedAName=cleanSearchTerm(a.source||'');const cleanedBName=cleanSearchTerm(b.source||'');if(cleanedAName.startsWith(cleanedSearchTerm)&&!cleanedBName.startsWith(cleanedSearchTerm)){return-1;}
if(!cleanedAName.startsWith(cleanedSearchTerm)&&cleanedBName.startsWith(cleanedSearchTerm)){return 1;}
if(cleanedAName<cleanedBName){return-1;}
if(cleanedAName>cleanedBName){return 1;}
return a.id-b.id;};}
static searchSuggestions(searchTerm,{thread}={}){const cleanedSearchTerm=cleanSearchTerm(searchTerm);return[this.env.messaging.cannedResponses.filter(cannedResponse=>cleanSearchTerm(cannedResponse.source).includes(cleanedSearchTerm))];}
getMentionText(){return this.substitution;}}
CannedResponse.fields={id:attr(),source:attr(),substitution:attr(),};CannedResponse.modelName='mail.canned_response';return CannedResponse;}
registerNewModel('mail.canned_response',factory);});;

/* /mail/static/src/models/channel_command/channel_command.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/channel_command/channel_command.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');const{cleanSearchTerm}=require('mail/static/src/utils/utils.js');function factory(dependencies){class ChannelCommand extends dependencies['mail.model']{static fetchSuggestions(searchTerm,{thread}={}){}
static getSuggestionSortFunction(searchTerm,{thread}={}){const cleanedSearchTerm=cleanSearchTerm(searchTerm);return(a,b)=>{const isATypeSpecific=a.channel_types;const isBTypeSpecific=b.channel_types;if(isATypeSpecific&&!isBTypeSpecific){return-1;}
if(!isATypeSpecific&&isBTypeSpecific){return 1;}
const cleanedAName=cleanSearchTerm(a.name||'');const cleanedBName=cleanSearchTerm(b.name||'');if(cleanedAName.startsWith(cleanedSearchTerm)&&!cleanedBName.startsWith(cleanedSearchTerm)){return-1;}
if(!cleanedAName.startsWith(cleanedSearchTerm)&&cleanedBName.startsWith(cleanedSearchTerm)){return 1;}
if(cleanedAName<cleanedBName){return-1;}
if(cleanedAName>cleanedBName){return 1;}
return a.id-b.id;};}
static searchSuggestions(searchTerm,{thread}={}){if(thread.model!=='mail.channel'){return[[]];}
const cleanedSearchTerm=cleanSearchTerm(searchTerm);return[this.env.messaging.commands.filter(command=>{if(!cleanSearchTerm(command.name).includes(cleanedSearchTerm)){return false;}
if(command.channel_types){return command.channel_types.includes(thread.channel_type);}
return true;})];}
getMentionText(){return this.name;}}
ChannelCommand.fields={channel_types:attr(),help:attr(),name:attr(),};ChannelCommand.modelName='mail.channel_command';return ChannelCommand;}
registerNewModel('mail.channel_command',factory);});;

/* /mail/static/src/models/chat_window/chat_window.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/chat_window/chat_window.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one,one2many,one2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');function factory(dependencies){class ChatWindow extends dependencies['mail.model']{_created(){const res=super._created(...arguments);this._onShowHomeMenu.bind(this);this._onHideHomeMenu.bind(this);this.env.messagingBus.on('hide_home_menu',this,this._onHideHomeMenu);this.env.messagingBus.on('show_home_menu',this,this._onShowHomeMenu);return res;}
_willDelete(){this.env.messagingBus.off('hide_home_menu',this,this._onHideHomeMenu);this.env.messagingBus.off('show_home_menu',this,this._onShowHomeMenu);return super._willDelete(...arguments);}
close({notifyServer}={}){if(notifyServer===undefined){notifyServer=!this.env.messaging.device.isMobile;}
const thread=this.thread;this.delete();if(thread&&notifyServer){thread.notifyFoldStateToServer('closed');}
if(this.env.device.isMobile&&!this.env.messaging.discuss.isOpen){this.env.messaging.messagingMenu.update({isOpen:true});}}
expand(){if(this.thread){this.thread.open({expanded:true});}}
focus(){this.update({isDoFocus:true});}
focusNextVisibleUnfoldedChatWindow(){const nextVisibleUnfoldedChatWindow=this._getNextVisibleUnfoldedChatWindow();if(nextVisibleUnfoldedChatWindow){nextVisibleUnfoldedChatWindow.focus();}}
focusPreviousVisibleUnfoldedChatWindow(){const previousVisibleUnfoldedChatWindow=this._getNextVisibleUnfoldedChatWindow({reverse:true});if(previousVisibleUnfoldedChatWindow){previousVisibleUnfoldedChatWindow.focus();}}
fold({notifyServer}={}){if(notifyServer===undefined){notifyServer=!this.env.messaging.device.isMobile;}
this.update({isFolded:true});if(this.thread&&notifyServer){this.thread.notifyFoldStateToServer('folded');}}
makeActive(options){this.makeVisible();this.unfold(options);this.focus();}
makeVisible(){if(this.isVisible){return;}
const lastVisible=this.manager.lastVisible;this.manager.swap(this,lastVisible);}
shiftLeft(){this.manager.shiftLeft(this);}
shiftRight(){this.manager.shiftRight(this);}
unfold({notifyServer}={}){if(notifyServer===undefined){notifyServer=!this.env.messaging.device.isMobile;}
this.update({isFolded:false});if(this.thread&&notifyServer){this.thread.notifyFoldStateToServer('open');}}
_computeHasNewMessageForm(){return this.isVisible&&!this.isFolded&&!this.thread;}
_computeHasShiftLeft(){if(!this.manager){return false;}
const allVisible=this.manager.allOrderedVisible;const index=allVisible.findIndex(visible=>visible===this);if(index===-1){return false;}
return index<allVisible.length-1;}
_computeHasShiftRight(){if(!this.manager){return false;}
const index=this.manager.allOrderedVisible.findIndex(visible=>visible===this);if(index===-1){return false;}
return index>0;}
_computeHasThreadView(){return this.isVisible&&!this.isFolded&&this.thread;}
_computeIsFolded(){const thread=this.thread;if(thread){return thread.foldState==='folded';}
return this.isFolded;}
_computeIsVisible(){if(!this.manager){return false;}
return this.manager.allOrderedVisible.includes(this);}
_computeName(){if(this.thread){return this.thread.displayName;}
return this.env._t("New message");}
_computeVisibleIndex(){if(!this.manager){return clear();}
const visible=this.manager.visual.visible;const index=visible.findIndex(visible=>visible.chatWindowLocalId===this.localId);if(index===-1){return clear();}
return index;}
_computeVisibleOffset(){if(!this.manager){return 0;}
const visible=this.manager.visual.visible;const index=visible.findIndex(visible=>visible.chatWindowLocalId===this.localId);if(index===-1){return 0;}
return visible[index].offset;}
_getNextVisibleUnfoldedChatWindow({reverse=false}={}){const orderedVisible=this.manager.allOrderedVisible;const _getNextIndex=index=>{const directionOffset=reverse?1:-1;let nextIndex=index+directionOffset;if(nextIndex>orderedVisible.length-1){nextIndex=0;}
if(nextIndex<0){nextIndex=orderedVisible.length-1;}
return nextIndex;};const currentIndex=orderedVisible.findIndex(visible=>visible===this);let nextIndex=_getNextIndex(currentIndex);let nextToFocus=orderedVisible[nextIndex];while(nextToFocus.isFolded){nextIndex=_getNextIndex(nextIndex);nextToFocus=orderedVisible[nextIndex];}
return nextToFocus;}
async _onHideHomeMenu(){if(!this.threadView){return;}
this.threadView.addComponentHint('home-menu-hidden');}
async _onShowHomeMenu(){if(!this.threadView){return;}
this.threadView.addComponentHint('home-menu-shown');}}
ChatWindow.fields={hasNewMessageForm:attr({compute:'_computeHasNewMessageForm',dependencies:['isFolded','isVisible','thread',],}),hasShiftLeft:attr({compute:'_computeHasShiftLeft',dependencies:['managerAllOrderedVisible'],default:false,}),hasShiftRight:attr({compute:'_computeHasShiftRight',dependencies:['managerAllOrderedVisible'],default:false,}),hasThreadView:attr({compute:'_computeHasThreadView',dependencies:['isFolded','isVisible','thread',],}),isDoFocus:attr({default:false,}),isFocused:attr({default:false,}),isFolded:attr({default:false,}),isVisible:attr({compute:'_computeIsVisible',dependencies:['managerAllOrderedVisible',],}),manager:many2one('mail.chat_window_manager',{inverse:'chatWindows',}),managerAllOrderedVisible:one2many('mail.chat_window',{related:'manager.allOrderedVisible',}),managerVisual:attr({related:'manager.visual',}),name:attr({compute:'_computeName',dependencies:['thread','threadDisplayName',],}),thread:one2one('mail.thread',{inverse:'chatWindow',}),threadDisplayName:attr({related:'thread.displayName',}),threadView:one2one('mail.thread_view',{related:'threadViewer.threadView',}),threadViewer:one2one('mail.thread_viewer',{default:[['create']],inverse:'chatWindow',isCausal:true,}),visibleIndex:attr({compute:'_computeVisibleIndex',dependencies:['manager','managerVisual',],}),visibleOffset:attr({compute:'_computeVisibleOffset',dependencies:['managerVisual'],}),};ChatWindow.modelName='mail.chat_window';return ChatWindow;}
registerNewModel('mail.chat_window',factory);});;

/* /mail/static/src/models/chat_window_manager/chat_window_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/chat_window_manager/chat_window_manager.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one,one2many,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){const BASE_VISUAL={availableVisibleSlots:0,hidden:{chatWindowLocalIds:[],isVisible:false,offset:0,},visible:[],};class ChatWindowManager extends dependencies['mail.model']{closeAll(){const chatWindows=this.allOrdered;for(const chatWindow of chatWindows){chatWindow.close();}}
closeHiddenMenu(){this.update({isHiddenMenuOpen:false});}
closeThread(thread,options){for(const chatWindow of this.chatWindows){if(chatWindow.thread===thread){chatWindow.close(options);}}}
openHiddenMenu(){this.update({isHiddenMenuOpen:true});}
openNewMessage(){let newMessageChatWindow=this.newMessageChatWindow;if(!newMessageChatWindow){newMessageChatWindow=this.env.models['mail.chat_window'].create({manager:[['link',this]],});}
newMessageChatWindow.makeActive();}
openThread(thread,{isFolded=false,makeActive=false,notifyServer,replaceNewMessage=false}={}){if(notifyServer===undefined){notifyServer=!this.env.messaging.device.isMobile;}
let chatWindow=this.chatWindows.find(chatWindow=>chatWindow.thread===thread);if(!chatWindow){chatWindow=this.env.models['mail.chat_window'].create({isFolded,manager:[['link',this]],thread:[['link',thread]],});}else{chatWindow.update({isFolded});}
if(replaceNewMessage&&this.newMessageChatWindow){this.swap(chatWindow,this.newMessageChatWindow);this.newMessageChatWindow.close();}
if(makeActive){chatWindow.makeActive({notifyServer:false});}
if(notifyServer){const foldState=chatWindow.isFolded?'folded':'open';thread.notifyFoldStateToServer(foldState);}}
shiftLeft(chatWindow){const chatWindows=this.allOrdered;const index=chatWindows.findIndex(cw=>cw===chatWindow);if(index===chatWindows.length-1){return;}
const otherChatWindow=chatWindows[index+1];const _newOrdered=[...this._ordered];_newOrdered[index]=otherChatWindow.localId;_newOrdered[index+1]=chatWindow.localId;this.update({_ordered:_newOrdered});chatWindow.focus();}
shiftRight(chatWindow){const chatWindows=this.allOrdered;const index=chatWindows.findIndex(cw=>cw===chatWindow);if(index===0){return;}
const otherChatWindow=chatWindows[index-1];const _newOrdered=[...this._ordered];_newOrdered[index]=otherChatWindow.localId;_newOrdered[index-1]=chatWindow.localId;this.update({_ordered:_newOrdered});chatWindow.focus();}
swap(chatWindow1,chatWindow2){const ordered=this.allOrdered;const index1=ordered.findIndex(chatWindow=>chatWindow===chatWindow1);const index2=ordered.findIndex(chatWindow=>chatWindow===chatWindow2);if(index1===-1||index2===-1){return;}
const _newOrdered=[...this._ordered];_newOrdered[index1]=chatWindow2.localId;_newOrdered[index2]=chatWindow1.localId;this.update({_ordered:_newOrdered});}
_compute_ordered(){const _ordered=this._ordered.filter(chatWindowLocalId=>this.chatWindows.includes(this.env.models['mail.chat_window'].get(chatWindowLocalId)));for(const chatWindow of this.chatWindows){if(!_ordered.includes(chatWindow.localId)){_ordered.push(chatWindow.localId);}}
return _ordered;}
_computeAllOrdered(){return[['replace',this._ordered.map(chatWindowLocalId=>this.env.models['mail.chat_window'].get(chatWindowLocalId))]];}
_computeAllOrderedHidden(){return[['replace',this.visual.hidden.chatWindowLocalIds.map(chatWindowLocalId=>this.env.models['mail.chat_window'].get(chatWindowLocalId))]];}
_computeAllOrderedVisible(){return[['replace',this.visual.visible.map(({chatWindowLocalId})=>this.env.models['mail.chat_window'].get(chatWindowLocalId))]];}
_computeHasHiddenChatWindows(){return this.allOrderedHidden.length>0;}
_computeHasVisibleChatWindows(){return this.allOrderedVisible.length>0;}
_computeLastVisible(){const{length:l,[l-1]:lastVisible}=this.allOrderedVisible;if(!lastVisible){return[['unlink']];}
return[['link',lastVisible]];}
_computeNewMessageChatWindow(){const chatWindow=this.allOrdered.find(chatWindow=>!chatWindow.thread);if(!chatWindow){return[['unlink']];}
return[['link',chatWindow]];}
_computeUnreadHiddenConversationAmount(){const allHiddenWithThread=this.allOrderedHidden.filter(chatWindow=>chatWindow.thread);let amount=0;for(const chatWindow of allHiddenWithThread){if(chatWindow.thread.localMessageUnreadCounter>0){amount++;}}
return amount;}
_computeVisual(){let visual=JSON.parse(JSON.stringify(BASE_VISUAL));if(!this.env.messaging){return visual;}
const device=this.env.messaging.device;const discuss=this.env.messaging.discuss;const BETWEEN_GAP_WIDTH=5;const CHAT_WINDOW_WIDTH=325;const END_GAP_WIDTH=device.isMobile?0:10;const GLOBAL_WINDOW_WIDTH=device.globalWindowInnerWidth;const HIDDEN_MENU_WIDTH=200;const START_GAP_WIDTH=device.isMobile?0:10;const chatWindows=this.allOrdered;if(!device.isMobile&&discuss.isOpen){return visual;}
if(!chatWindows.length){return visual;}
const relativeGlobalWindowWidth=GLOBAL_WINDOW_WIDTH-START_GAP_WIDTH-END_GAP_WIDTH;let maxAmountWithoutHidden=Math.floor(relativeGlobalWindowWidth/(CHAT_WINDOW_WIDTH+BETWEEN_GAP_WIDTH));let maxAmountWithHidden=Math.floor((relativeGlobalWindowWidth-HIDDEN_MENU_WIDTH-BETWEEN_GAP_WIDTH)/(CHAT_WINDOW_WIDTH+BETWEEN_GAP_WIDTH));if(device.isMobile){maxAmountWithoutHidden=1;maxAmountWithHidden=1;}
if(chatWindows.length<=maxAmountWithoutHidden){for(let i=0;i<chatWindows.length;i++){const chatWindowLocalId=chatWindows[i].localId;const offset=START_GAP_WIDTH+i*(CHAT_WINDOW_WIDTH+BETWEEN_GAP_WIDTH);visual.visible.push({chatWindowLocalId,offset});}
visual.availableVisibleSlots=maxAmountWithoutHidden;}else if(maxAmountWithHidden>0){for(let i=0;i<maxAmountWithHidden;i++){const chatWindowLocalId=chatWindows[i].localId;const offset=START_GAP_WIDTH+i*(CHAT_WINDOW_WIDTH+BETWEEN_GAP_WIDTH);visual.visible.push({chatWindowLocalId,offset});}
if(chatWindows.length>maxAmountWithHidden){visual.hidden.isVisible=!device.isMobile;visual.hidden.offset=visual.visible[maxAmountWithHidden-1].offset
+CHAT_WINDOW_WIDTH+BETWEEN_GAP_WIDTH;}
for(let j=maxAmountWithHidden;j<chatWindows.length;j++){visual.hidden.chatWindowLocalIds.push(chatWindows[j].localId);}
visual.availableVisibleSlots=maxAmountWithHidden;}else{visual.hidden.isVisible=!device.isMobile;visual.hidden.offset=START_GAP_WIDTH;visual.hidden.chatWindowLocalIds.concat(chatWindows.map(chatWindow=>chatWindow.localId));console.warn('cannot display any visible chat windows (screen is too small)');visual.availableVisibleSlots=0;}
return visual;}}
ChatWindowManager.fields={_ordered:attr({compute:'_compute_ordered',default:[],dependencies:['chatWindows',],}),allOrdered:one2many('mail.chat_window',{compute:'_computeAllOrdered',dependencies:['_ordered',],}),allOrderedThread:one2many('mail.thread',{related:'allOrdered.thread',}),allOrderedHidden:one2many('mail.chat_window',{compute:'_computeAllOrderedHidden',dependencies:['visual'],}),allOrderedHiddenThread:one2many('mail.thread',{related:'allOrderedHidden.thread',}),allOrderedHiddenThreadMessageUnreadCounter:attr({related:'allOrderedHiddenThread.localMessageUnreadCounter',}),allOrderedVisible:one2many('mail.chat_window',{compute:'_computeAllOrderedVisible',dependencies:['visual'],}),chatWindows:one2many('mail.chat_window',{inverse:'manager',isCausal:true,}),device:one2one('mail.device',{related:'messaging.device',}),deviceGlobalWindowInnerWidth:attr({related:'device.globalWindowInnerWidth',}),deviceIsMobile:attr({related:'device.isMobile',}),discuss:one2one('mail.discuss',{related:'messaging.discuss',}),discussIsOpen:attr({related:'discuss.isOpen',}),hasHiddenChatWindows:attr({compute:'_computeHasHiddenChatWindows',dependencies:['allOrderedHidden'],}),hasVisibleChatWindows:attr({compute:'_computeHasVisibleChatWindows',dependencies:['allOrderedVisible'],}),isHiddenMenuOpen:attr({default:false,}),lastVisible:many2one('mail.chat_window',{compute:'_computeLastVisible',dependencies:['allOrderedVisible'],}),messaging:one2one('mail.messaging',{inverse:'chatWindowManager',}),newMessageChatWindow:one2one('mail.chat_window',{compute:'_computeNewMessageChatWindow',dependencies:['allOrdered','allOrderedThread',],}),unreadHiddenConversationAmount:attr({compute:'_computeUnreadHiddenConversationAmount',dependencies:['allOrderedHiddenThreadMessageUnreadCounter'],}),visual:attr({compute:'_computeVisual',default:BASE_VISUAL,dependencies:['allOrdered','deviceGlobalWindowInnerWidth','deviceIsMobile','discussIsOpen',],}),};ChatWindowManager.modelName='mail.chat_window_manager';return ChatWindowManager;}
registerNewModel('mail.chat_window_manager',factory);});;

/* /mail/static/src/models/chatter/chatter.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/chatter/chatter.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){const getThreadNextTemporaryId=(function(){let tmpId=0;return()=>{tmpId-=1;return tmpId;};})();const getMessageNextTemporaryId=(function(){let tmpId=0;return()=>{tmpId-=1;return tmpId;};})();class Chatter extends dependencies['mail.model']{_willDelete(){this._stopAttachmentsLoading();return super._willDelete(...arguments);}
focus(){this.update({isDoFocus:true});}
async refresh(){if(this.hasActivities){this.thread.refreshActivities();}
if(this.hasFollowers){this.thread.refreshFollowers();this.thread.fetchAndUpdateSuggestedRecipients();}
if(this.hasMessageList){this.thread.refresh();}}
showLogNote(){this.update({isComposerVisible:true});this.thread.composer.update({isLog:true});this.focus();}
showSendMessage(){this.update({isComposerVisible:true});this.thread.composer.update({isLog:false});this.focus();}
toggleActivityBoxVisibility(){this.update({isActivityBoxVisible:!this.isActivityBoxVisible});}
_computeHasThreadView(){return this.thread&&this.hasMessageList;}
_computeIsDisabled(){return!this.thread||this.thread.isTemporary;}
_onThreadIdOrThreadModelChanged(){if(this.threadId){if(this.thread&&this.thread.isTemporary){this.thread.delete();}
this.update({isAttachmentBoxVisible:this.isAttachmentBoxVisibleInitially,thread:[['insert',{hasActivities:this.hasActivities?true:undefined,id:this.threadId,model:this.threadModel,}]],});if(this.hasActivities){this.thread.refreshActivities();}
if(this.hasFollowers){this.thread.refreshFollowers();this.thread.fetchAndUpdateSuggestedRecipients();}
if(this.hasMessageList){this.thread.refresh();}}else if(!this.thread||!this.thread.isTemporary){const currentPartner=this.env.messaging.currentPartner;const message=this.env.models['mail.message'].create({author:[['link',currentPartner]],body:this.env._t("Creating a new record..."),id:getMessageNextTemporaryId(),isTemporary:true,});const nextId=getThreadNextTemporaryId();this.update({isAttachmentBoxVisible:false,thread:[['insert',{areAttachmentsLoaded:true,id:nextId,isTemporary:true,model:this.threadModel,}]],});for(const cache of this.thread.caches){cache.update({messages:[['link',message]]});}}}
_onThreadIsLoadingAttachmentsChanged(){if(!this.thread||!this.thread.isLoadingAttachments){this._stopAttachmentsLoading();return;}
if(this._isPreparingAttachmentsLoading||this.isShowingAttachmentsLoading){return;}
this._prepareAttachmentsLoading();}
_prepareAttachmentsLoading(){this._isPreparingAttachmentsLoading=true;this._attachmentsLoaderTimeout=this.env.browser.setTimeout(()=>{this.update({isShowingAttachmentsLoading:true});this._isPreparingAttachmentsLoading=false;},this.env.loadingBaseDelayDuration);}
_stopAttachmentsLoading(){this.env.browser.clearTimeout(this._attachmentsLoaderTimeout);this._attachmentsLoaderTimeout=null;this.update({isShowingAttachmentsLoading:false});this._isPreparingAttachmentsLoading=false;}}
Chatter.fields={composer:many2one('mail.composer',{related:'thread.composer',}),context:attr({default:{},}),hasActivities:attr({default:true,}),hasExternalBorder:attr({default:true,}),hasFollowers:attr({default:true,}),hasMessageList:attr({default:true,}),hasMessageListScrollAdjust:attr({default:false,}),hasThreadView:attr({compute:'_computeHasThreadView',dependencies:['hasMessageList','thread',],}),hasTopbarCloseButton:attr({default:false,}),isActivityBoxVisible:attr({default:true,}),isAttachmentBoxVisible:attr({default:false,}),isAttachmentBoxVisibleInitially:attr({default:false,}),isComposerVisible:attr({default:false,}),isDisabled:attr({compute:'_computeIsDisabled',default:false,dependencies:['threadIsTemporary',],}),isDoFocus:attr({default:false,}),isShowingAttachmentsLoading:attr({default:false,}),onThreadIdOrThreadModelChanged:attr({compute:'_onThreadIdOrThreadModelChanged',dependencies:['threadId','threadModel',],}),onThreadIsLoadingAttachmentsChanged:attr({compute:'_onThreadIsLoadingAttachmentsChanged',dependencies:['threadIsLoadingAttachments',],}),thread:many2one('mail.thread'),threadId:attr(),threadIsLoadingAttachments:attr({related:'thread.isLoadingAttachments',}),threadIsTemporary:attr({related:'thread.isTemporary',}),threadModel:attr(),threadView:one2one('mail.thread_view',{related:'threadViewer.threadView',}),threadViewer:one2one('mail.thread_viewer',{default:[['create']],inverse:'chatter',isCausal:true,}),};Chatter.modelName='mail.chatter';return Chatter;}
registerNewModel('mail.chatter',factory);});;

/* /mail/static/src/models/composer/composer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/composer/composer.js',function(require){'use strict';const emojis=require('mail.emojis');const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');const mailUtils=require('mail.utils');const{addLink,escapeAndCompactTextContent,parseAndTransform,}=require('mail.utils');function factory(dependencies){class Composer extends dependencies['mail.model']{_willCreate(){const res=super._willCreate(...arguments);this._hasMentionRpcInProgress=false;this._nextMentionRpcFunction=undefined;return res;}
_willDelete(){this._nextMentionRpcFunction=undefined;return super._willDelete(...arguments);}
closeSuggestions(){this.update({suggestionDelimiterPosition:clear()});}
async detectSuggestionDelimiter(){}
discard(){if(this.discussAsReplying){this.discussAsReplying.clearReplyingToMessage();}}
focus(){const allComposers=this.env.models['mail.composer'].all();for(const otherComposer of allComposers){if(otherComposer!==this&&otherComposer.hasFocus){otherComposer.update({hasFocus:false});}}
this.update({hasFocus:true});}
insertIntoTextInput(content){const partA=this.textInputContent.slice(0,this.textInputCursorStart);const partB=this.textInputContent.slice(this.textInputCursorEnd,this.textInputContent.length);let suggestionDelimiterPosition=this.suggestionDelimiterPosition;if(suggestionDelimiterPosition!==undefined&&suggestionDelimiterPosition>=this.textInputCursorStart){suggestionDelimiterPosition=suggestionDelimiterPosition+content.length;}
this.update({isLastStateChangeProgrammatic:true,suggestionDelimiterPosition,textInputContent:partA+content+partB,textInputCursorEnd:this.textInputCursorStart+content.length,textInputCursorStart:this.textInputCursorStart+content.length,});}
insertSuggestion(){const cursorPosition=this.textInputCursorStart;let textLeft=this.textInputContent.substring(0,this.suggestionDelimiterPosition+1);let textRight=this.textInputContent.substring(cursorPosition,this.textInputContent.length);if(this.suggestionDelimiter===':'){textLeft=this.textInputContent.substring(0,this.suggestionDelimiterPosition);textRight=this.textInputContent.substring(cursorPosition,this.textInputContent.length);}
const recordReplacement=this.activeSuggestedRecord.getMentionText();const updateData={isLastStateChangeProgrammatic:true,textInputContent:textLeft+recordReplacement+' '+textRight,textInputCursorEnd:textLeft.length+recordReplacement.length+1,textInputCursorStart:textLeft.length+recordReplacement.length+1,};switch(this.activeSuggestedRecord.constructor.modelName){case'mail.thread':Object.assign(updateData,{mentionedChannels:[['link',this.activeSuggestedRecord]]});break;case'mail.partner':Object.assign(updateData,{mentionedPartners:[['link',this.activeSuggestedRecord]]});break;}
this.update(updateData);}
_computeRecipients(){const recipients=[...this.mentionedPartners];if(this.thread&&!this.isLog){for(const recipient of this.thread.suggestedRecipientInfoList){if(recipient.partner&&recipient.isSelected){recipients.push(recipient.partner);}}}
return[['replace',recipients]];}
async openFullComposer(){const attachmentIds=this.attachments.map(attachment=>attachment.id);const context={default_attachment_ids:attachmentIds,default_body:mailUtils.escapeAndCompactTextContent(this.textInputContent),default_is_log:this.isLog,default_model:this.thread.model,default_partner_ids:this.recipients.map(partner=>partner.id),default_res_id:this.thread.id,mail_post_autofollow:true,};const action={type:'ir.actions.act_window',res_model:'mail.compose.message',view_mode:'form',views:[[false,'form']],target:'new',context:context,};const options={on_close:()=>{if(!this.exists()){return;}
this._reset();this.thread.loadNewMessages();},};await this.env.bus.trigger('do-action',{action,options});}
async postMessage(){const thread=this.thread;this.thread.unregisterCurrentPartnerIsTyping({immediateNotify:true});const escapedAndCompactContent=escapeAndCompactTextContent(this.textInputContent);let body=escapedAndCompactContent.replace(/&nbsp;/g,' ').trim();body=this._generateMentionsLinks(body);body=parseAndTransform(body,addLink);body=this._generateEmojisOnHtml(body);let postData={attachment_ids:this.attachments.map(attachment=>attachment.id),body,channel_ids:this.mentionedChannels.map(channel=>channel.id),message_type:'comment',partner_ids:this.recipients.map(partner=>partner.id),};if(this.subjectContent){postData.subject=this.subjectContent;}
try{let messageId;this.update({isPostingMessage:true});if(thread.model==='mail.channel'){const command=this._getCommandFromText(body);Object.assign(postData,{subtype_xmlid:'mail.mt_comment',});if(command){messageId=await this.async(()=>this.env.models['mail.thread'].performRpcExecuteCommand({channelId:thread.id,command:command.name,postData,}));}else{messageId=await this.async(()=>this.env.models['mail.thread'].performRpcMessagePost({postData,threadId:thread.id,threadModel:thread.model,}));}}else{Object.assign(postData,{subtype_xmlid:this.isLog?'mail.mt_note':'mail.mt_comment',});if(!this.isLog){postData.context={mail_post_autofollow:true,};}
messageId=await this.async(()=>this.env.models['mail.thread'].performRpcMessagePost({postData,threadId:thread.id,threadModel:thread.model,}));const[messageData]=await this.async(()=>this.env.services.rpc({model:'mail.message',method:'message_format',args:[[messageId]],},{shadow:true}));this.env.models['mail.message'].insert(Object.assign({},this.env.models['mail.message'].convertData(messageData),{originThread:[['insert',{id:thread.id,model:thread.model,}]],}));thread.loadNewMessages();}
for(const threadView of this.thread.threadViews){threadView.update({hasAutoScrollOnMessageReceived:true});}
thread.refreshFollowers();thread.fetchAndUpdateSuggestedRecipients();this._reset();}finally{this.update({isPostingMessage:false});}}
handleCurrentPartnerIsTyping(){if(!this.thread){return;}
if(this.suggestionModelName==='mail.channel_command'||this._getCommandFromText(this.textInputContent)){return;}
if(this.thread.typingMembers.includes(this.env.messaging.currentPartner)){this.thread.refreshCurrentPartnerIsTyping();}else{this.thread.registerCurrentPartnerIsTyping();}}
setFirstSuggestionActive(){const suggestedRecords=this.mainSuggestedRecords.concat(this.extraSuggestedRecords);const firstRecord=suggestedRecords[0];this.update({activeSuggestedRecord:[['link',firstRecord]]});}
setLastSuggestionActive(){const suggestedRecords=this.mainSuggestedRecords.concat(this.extraSuggestedRecords);const{length,[length-1]:lastRecord}=suggestedRecords;this.update({activeSuggestedRecord:[['link',lastRecord]]});}
setNextSuggestionActive(){const suggestedRecords=this.mainSuggestedRecords.concat(this.extraSuggestedRecords);const activeElementIndex=suggestedRecords.findIndex(suggestion=>suggestion===this.activeSuggestedRecord);if(activeElementIndex===suggestedRecords.length-1){this.setFirstSuggestionActive();return;}
const nextRecord=suggestedRecords[activeElementIndex+1];this.update({activeSuggestedRecord:[['link',nextRecord]]});}
setPreviousSuggestionActive(){const suggestedRecords=this.mainSuggestedRecords.concat(this.extraSuggestedRecords);const activeElementIndex=suggestedRecords.findIndex(suggestion=>suggestion===this.activeSuggestedRecord);if(activeElementIndex===0){this.setLastSuggestionActive();return;}
const previousRecord=suggestedRecords[activeElementIndex-1];this.update({activeSuggestedRecord:[['link',previousRecord]]});}
_computeActiveSuggestedCannedResponse(){if(this.suggestionDelimiter===':'&&this.activeSuggestedRecord){return[['link',this.activeSuggestedRecord]];}
return[['unlink']];}
_computeActiveSuggestedChannel(){if(this.suggestionDelimiter==='#'&&this.activeSuggestedRecord){return[['link',this.activeSuggestedRecord]];}
return[['unlink']];}
_computeActiveSuggestedChannelCommand(){if(this.suggestionDelimiter==='/'&&this.activeSuggestedRecord){return[['link',this.activeSuggestedRecord]];}
return[['unlink']];}
_computeActiveSuggestedPartner(){if(this.suggestionDelimiter==='@'&&this.activeSuggestedRecord){return[['link',this.activeSuggestedRecord]];}
return[['unlink']];}
_computeActiveSuggestedRecord(){if(this.mainSuggestedRecords.length===0&&this.extraSuggestedRecords.length===0){return[['unlink']];}
if(this.mainSuggestedRecords.includes(this.activeSuggestedRecord)||this.extraSuggestedRecords.includes(this.activeSuggestedRecord)){return;}
const suggestedRecords=this.mainSuggestedRecords.concat(this.extraSuggestedRecords);const firstRecord=suggestedRecords[0];return[['link',firstRecord]];}
_computeActiveSuggestedRecordName(){switch(this.suggestionDelimiter){case'@':return"activeSuggestedPartner";case':':return"activeSuggestedCannedResponse";case'/':return"activeSuggestedChannelCommand";case'#':return"activeSuggestedChannel";default:return clear();}}
_computeCanPostMessage(){if(!this.textInputContent&&this.attachments.length===0){return false;}
return!this.hasUploadingAttachment&&!this.isPostingMessage;}
_computeExtraSuggestedPartners(){if(this.suggestionDelimiter==='@'){return[['replace',this.extraSuggestedRecords]];}
return[['unlink-all']];}
_computeExtraSuggestedRecords(){if(this.suggestionDelimiterPosition===undefined){return[['unlink-all']];}
return[['unlink',this.mainSuggestedRecords]];}
_computeExtraSuggestedRecordsList(){return this.extraSuggestedRecords;}
_computeExtraSuggestedRecordsListName(){if(this.suggestionDelimiter==='@'){return"extraSuggestedPartners";}
return clear();}
_computeHasSuggestions(){return this.mainSuggestedRecords.length>0||this.extraSuggestedRecords.length>0;}
_computeHasUploadingAttachment(){return this.attachments.some(attachment=>attachment.isTemporary);}
_computeMainSuggestedPartners(){if(this.suggestionDelimiter==='@'){return[['replace',this.mainSuggestedRecords]];}
return[['unlink-all']];}
_computeMainSuggestedRecords(){if(this.suggestionDelimiterPosition===undefined){return[['unlink-all']];}}
_computeMainSuggestedRecordsList(){return this.mainSuggestedRecords;}
_computeMainSuggestedRecordsListName(){switch(this.suggestionDelimiter){case'@':return"mainSuggestedPartners";case':':return"suggestedCannedResponses";case'/':return"suggestedChannelCommands";case'#':return"suggestedChannels";default:return clear();}}
_computeMentionedPartners(){const unmentionedPartners=[];const namesIndex={};for(const partner of this.mentionedPartners){const fromIndex=namesIndex[partner.name]!==undefined?namesIndex[partner.name]+1:0;const index=this.textInputContent.indexOf(`@${partner.name}`,fromIndex);if(index!==-1){namesIndex[partner.name]=index;}else{unmentionedPartners.push(partner);}}
return[['unlink',unmentionedPartners]];}
_computeMentionedChannels(){const unmentionedChannels=[];const namesIndex={};for(const channel of this.mentionedChannels){const fromIndex=namesIndex[channel.name]!==undefined?namesIndex[channel.name]+1:0;const index=this.textInputContent.indexOf(`#${channel.name}`,fromIndex);if(index!==-1){namesIndex[channel.name]=index;}else{unmentionedChannels.push(channel);}}
return[['unlink',unmentionedChannels]];}
_computeSuggestedCannedResponses(){if(this.suggestionDelimiter===':'){return[['replace',this.mainSuggestedRecords]];}
return[['unlink-all']];}
_computeSuggestedChannels(){if(this.suggestionDelimiter==='#'){return[['replace',this.mainSuggestedRecords]];}
return[['unlink-all']];}
_computeSuggestionDelimiter(){if(this.suggestionDelimiterPosition===undefined||this.suggestionDelimiterPosition>=this.textInputContent.length){return clear();}
return this.textInputContent[this.suggestionDelimiterPosition];}
_computeSuggestionDelimiterPosition(){if(this.textInputCursorStart!==this.textInputCursorEnd){return clear();}
const candidatePositions=[];if(this.suggestionDelimiterPosition!==undefined&&this.suggestionDelimiterPosition<this.textInputCursorStart){candidatePositions.push(this.suggestionDelimiterPosition);}
if(this.textInputCursorStart>0){candidatePositions.push(this.textInputCursorStart-1);}
const suggestionDelimiters=['@',':','#','/'];for(const candidatePosition of candidatePositions){if(candidatePosition<0||candidatePosition>=this.textInputContent.length){continue;}
const candidateChar=this.textInputContent[candidatePosition];if(candidateChar==='/'&&candidatePosition!==0){continue;}
if(!suggestionDelimiters.includes(candidateChar)){continue;}
const charBeforeCandidate=this.textInputContent[candidatePosition-1];if(charBeforeCandidate&&!/\s/.test(charBeforeCandidate)){continue;}
return candidatePosition;}
return clear();}
_computeSuggestedChannelCommands(){if(this.suggestionDelimiter==='/'){return[['replace',this.mainSuggestedRecords]];}
return[['unlink-all']];}
_computeSuggestionModelName(){switch(this.suggestionDelimiter){case'@':return'mail.partner';case':':return'mail.canned_response';case'/':return'mail.channel_command';case'#':return'mail.thread';default:return clear();}}
_computeSuggestionSearchTerm(){if(this.suggestionDelimiterPosition===undefined||this.suggestionDelimiterPosition>=this.textInputCursorStart){return clear();}
return this.textInputContent.substring(this.suggestionDelimiterPosition+1,this.textInputCursorStart);}
async _executeOrQueueFunction(func){if(this._hasMentionRpcInProgress){this._nextMentionRpcFunction=func;return;}
this._hasMentionRpcInProgress=true;this._nextMentionRpcFunction=undefined;try{await this.async(func);}finally{this._hasMentionRpcInProgress=false;if(this._nextMentionRpcFunction){this._executeOrQueueFunction(this._nextMentionRpcFunction);}}}
_generateEmojisOnHtml(htmlString){for(const emoji of emojis){for(const source of emoji.sources){const escapedSource=String(source).replace(/([.*+?=^!:${}()|[\]/\\])/g,'\\$1');const regexp=new RegExp('(\\s|^)('+escapedSource+')(?=\\s|$)','g');htmlString=htmlString.replace(regexp,'$1'+emoji.unicode);}}
return htmlString;}
_generateMentionsLinks(body){const mentions=[];for(const partner of this.mentionedPartners){const placeholder=`@-mention-partner-${partner.id}`;const text=`@${owl.utils.escape(partner.name)}`;mentions.push({class:'o_mail_redirect',id:partner.id,model:'res.partner',placeholder,text,});body=body.replace(text,placeholder);}
for(const channel of this.mentionedChannels){const placeholder=`#-mention-channel-${channel.id}`;const text=`#${owl.utils.escape(channel.name)}`;mentions.push({class:'o_channel_redirect',id:channel.id,model:'mail.channel',placeholder,text,});body=body.replace(text,placeholder);}
const baseHREF=this.env.session.url('/web');for(const mention of mentions){const href=`href='${baseHREF}#model=${mention.model}&id=${mention.id}'`;const attClass=`class='${mention.class}'`;const dataOeId=`data-oe-id='${mention.id}'`;const dataOeModel=`data-oe-model='${mention.model}'`;const target=`target='_blank'`;const link=`<a ${href} ${attClass} ${dataOeId} ${dataOeModel} ${target}>${mention.text}</a>`;body=body.replace(mention.placeholder,link);}
return body;}
_getCommandFromText(content){if(content.startsWith('/')){const firstWord=content.substring(1).split(/\s/)[0];return this.env.messaging.commands.find(command=>{if(command.name!==firstWord){return false;}
if(command.channel_types){return command.channel_types.includes(this.thread.channel_type);}
return true;});}
return undefined;}
_onChangeUpdateSuggestionList(){this._updateSuggestionList();this._executeOrQueueFunction(async()=>{if(this.suggestionDelimiterPosition===undefined||this.suggestionSearchTerm===undefined||!this.suggestionModelName){return;}
const Model=this.env.models[this.suggestionModelName];const searchTerm=this.suggestionSearchTerm;await this.async(()=>Model.fetchSuggestions(searchTerm,{thread:this.thread}));this._updateSuggestionList();if(this.suggestionSearchTerm&&this.suggestionSearchTerm===searchTerm&&this.suggestionModelName&&this.env.models[this.suggestionModelName]===Model&&!this.hasSuggestions){this.closeSuggestions();}});}
_reset(){this.update({attachments:[['unlink-all']],isLastStateChangeProgrammatic:true,mentionedChannels:[['unlink-all']],mentionedPartners:[['unlink-all']],subjectContent:"",textInputContent:'',textInputCursorEnd:0,textInputCursorStart:0,});}
_updateSuggestionList(){if(this.suggestionDelimiterPosition===undefined||this.suggestionSearchTerm===undefined||!this.suggestionModelName){return;}
const Model=this.env.models[this.suggestionModelName];const[mainSuggestedRecords,extraSuggestedRecords=[],]=Model.searchSuggestions(this.suggestionSearchTerm,{thread:this.thread});const sortFunction=Model.getSuggestionSortFunction(this.suggestionSearchTerm,{thread:this.thread});mainSuggestedRecords.sort(sortFunction);extraSuggestedRecords.sort(sortFunction);const limit=8;mainSuggestedRecords.length=Math.min(mainSuggestedRecords.length,limit);extraSuggestedRecords.length=Math.min(extraSuggestedRecords.length,limit-mainSuggestedRecords.length);this.update({extraSuggestedRecords:[['replace',extraSuggestedRecords]],hasToScrollToActiveSuggestion:true,mainSuggestedRecords:[['replace',mainSuggestedRecords]],});}
_validateMentionKeyword(beginningOnly){const beforeSuggestionDelimiterPosition=this.suggestionDelimiterPosition-1;if(beginningOnly&&beforeSuggestionDelimiterPosition>0){return false;}
let searchStr=this.textInputContent.substring(beforeSuggestionDelimiterPosition,this.textInputCursorStart);const pattern="^"+this.suggestionDelimiter+"|^\\s"+this.suggestionDelimiter;const regexStart=new RegExp(pattern,'g');searchStr=searchStr.replace(/^\s\s*|^[\n\r]/g,'');if(regexStart.test(searchStr)&&searchStr.length){searchStr=searchStr.replace(pattern,'');return!searchStr.includes(' ')&&!/[\r\n]/.test(searchStr)?searchStr.replace(this.suggestionDelimiter,''):false;}
return false;}}
Composer.fields={activeSuggestedCannedResponse:many2one('mail.canned_response',{compute:'_computeActiveSuggestedCannedResponse',dependencies:['activeSuggestedRecord','suggestionDelimiter',],}),activeSuggestedChannel:many2one('mail.thread',{compute:'_computeActiveSuggestedChannel',dependencies:['activeSuggestedRecord','suggestionDelimiter',],}),activeSuggestedChannelCommand:many2one('mail.channel_command',{compute:'_computeActiveSuggestedChannelCommand',dependencies:['activeSuggestedRecord','suggestionDelimiter',],}),activeSuggestedPartner:many2one('mail.partner',{compute:'_computeActiveSuggestedPartner',dependencies:['activeSuggestedRecord','suggestionDelimiter',],}),activeSuggestedRecord:many2one('mail.model',{compute:'_computeActiveSuggestedRecord',dependencies:['activeSuggestedRecord','extraSuggestedRecords','mainSuggestedRecords',],}),activeSuggestedRecordName:attr({compute:'_computeActiveSuggestedRecordName',dependencies:['suggestionDelimiter',],}),attachments:many2many('mail.attachment',{inverse:'composers',}),attachmentsAreTemporary:attr({related:'attachments.isTemporary',}),canPostMessage:attr({compute:'_computeCanPostMessage',dependencies:['attachments','hasUploadingAttachment','isPostingMessage','textInputContent',],default:false,}),discussAsReplying:one2one('mail.discuss',{inverse:'replyingToMessageOriginThreadComposer',}),extraSuggestedPartners:many2many('mail.partner',{compute:'_computeExtraSuggestedPartners',dependencies:['extraSuggestedRecords','suggestionDelimiter',],}),extraSuggestedRecords:many2many('mail.model',{compute:'_computeExtraSuggestedRecords',dependencies:['extraSuggestedRecords','mainSuggestedRecords','suggestionDelimiterPosition',],}),extraSuggestedRecordsList:attr({compute:'_computeExtraSuggestedRecordsList',dependencies:['extraSuggestedRecords',],}),extraSuggestedRecordsListName:attr({compute:'_computeExtraSuggestedRecordsListName',dependencies:['suggestionDelimiter',],}),hasUploadingAttachment:attr({compute:'_computeHasUploadingAttachment',dependencies:['attachments','attachmentsAreTemporary',],}),hasFocus:attr({default:false,}),hasSuggestions:attr({compute:'_computeHasSuggestions',dependencies:['extraSuggestedRecords','mainSuggestedRecords',],default:false,}),hasToScrollToActiveSuggestion:attr({default:false,}),isLastStateChangeProgrammatic:attr({default:false,}),isLog:attr({default:true,}),isPostingMessage:attr(),mainSuggestedPartners:many2many('mail.partner',{compute:'_computeMainSuggestedPartners',dependencies:['mainSuggestedRecords','suggestionDelimiter',],}),mainSuggestedRecords:many2many('mail.model',{compute:'_computeMainSuggestedRecords',dependencies:['mainSuggestedRecords','suggestionDelimiterPosition',],}),mainSuggestedRecordsList:attr({compute:'_computeMainSuggestedRecordsList',dependencies:['mainSuggestedRecords',],}),mainSuggestedRecordsListName:attr({compute:'_computeMainSuggestedRecordsListName',dependencies:['suggestionDelimiter',],}),mentionedChannels:many2many('mail.thread',{compute:'_computeMentionedChannels',dependencies:['textInputContent'],}),mentionedPartners:many2many('mail.partner',{compute:'_computeMentionedPartners',dependencies:['mentionedPartners','mentionedPartnersName','textInputContent',],}),mentionedPartnersName:attr({related:'mentionedPartners.name',}),onChangeUpdateSuggestionList:attr({compute:'_onChangeUpdateSuggestionList',dependencies:['suggestionDelimiterPosition','suggestionModelName','suggestionSearchTerm','thread',],}),recipients:many2many('mail.partner',{compute:'_computeRecipients',dependencies:['isLog','mentionedPartners','threadSuggestedRecipientInfoListIsSelected',]}),threadSuggestedRecipientInfoList:many2many('mail.suggested_recipient_info',{related:'thread.suggestedRecipientInfoList',}),threadSuggestedRecipientInfoListIsSelected:attr({related:'threadSuggestedRecipientInfoList.isSelected',}),subjectContent:attr({default:"",}),suggestedCannedResponses:many2many('mail.canned_response',{compute:'_computeSuggestedCannedResponses',dependencies:['mainSuggestedRecords','suggestionDelimiter',],}),suggestedChannelCommands:many2many('mail.channel_command',{compute:'_computeSuggestedChannelCommands',dependencies:['mainSuggestedRecords','suggestionDelimiter',],}),suggestedChannels:many2many('mail.thread',{compute:'_computeSuggestedChannels',dependencies:['mainSuggestedRecords','suggestionDelimiter',],}),suggestionDelimiter:attr({compute:'_computeSuggestionDelimiter',dependencies:['suggestionDelimiterPosition','textInputContent',],}),suggestionDelimiterPosition:attr({compute:'_computeSuggestionDelimiterPosition',dependencies:['textInputContent','textInputCursorEnd','textInputCursorStart',],}),suggestionModelName:attr({compute:'_computeSuggestionModelName',dependencies:['suggestionDelimiter',],}),suggestionSearchTerm:attr({compute:'_computeSuggestionSearchTerm',dependencies:['suggestionDelimiterPosition','textInputContent','textInputCursorStart',],}),textInputContent:attr({default:"",}),textInputCursorEnd:attr({default:0,}),textInputCursorStart:attr({default:0,}),textInputSelectionDirection:attr({default:"none",}),thread:one2one('mail.thread',{inverse:'composer',}),};Composer.modelName='mail.composer';return Composer;}
registerNewModel('mail.composer',factory);});;

/* /mail/static/src/models/country/country.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/country/country.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');function factory(dependencies){class Country extends dependencies['mail.model']{static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeFlagUrl(){if(!this.code){return clear();}
return`/base/static/img/country_flags/${this.code}.png`;}}
Country.fields={code:attr(),flagUrl:attr({compute:'_computeFlagUrl',dependencies:['code',],}),id:attr(),name:attr(),};Country.modelName='mail.country';return Country;}
registerNewModel('mail.country',factory);});;

/* /mail/static/src/models/device/device.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/device/device.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Device extends dependencies['mail.model']{_created(){const res=super._created(...arguments);this._refresh();this._onResize=_.debounce(()=>this._refresh(),100);return res;}
_willDelete(){window.removeEventListener('resize',this._onResize);return super._willDelete(...arguments);}
start(){window.addEventListener('resize',this._onResize);}
_refresh(){this.update({globalWindowInnerHeight:this.env.browser.innerHeight,globalWindowInnerWidth:this.env.browser.innerWidth,isMobile:this.env.device.isMobile,});}}
Device.fields={globalWindowInnerHeight:attr(),globalWindowInnerWidth:attr(),isMobile:attr(),};Device.modelName='mail.device';return Device;}
registerNewModel('mail.device',factory);});;

/* /mail/static/src/models/dialog/dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/dialog/dialog.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{many2one,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Dialog extends dependencies['mail.model']{}
Dialog.fields={manager:many2one('mail.dialog_manager',{inverse:'dialogs',}),record:one2one('mail.model',{isCausal:true,}),};Dialog.modelName='mail.dialog';return Dialog;}
registerNewModel('mail.dialog',factory);});;

/* /mail/static/src/models/dialog_manager/dialog_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/dialog_manager/dialog_manager.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{one2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class DialogManager extends dependencies['mail.model']{open(modelName,recordData){if(!modelName){throw new Error("Dialog should have a link to a model");}
const Model=this.env.models[modelName];if(!Model){throw new Error(`No model exists with name ${modelName}`);}
const record=Model.create(recordData);const dialog=this.env.models['mail.dialog'].create({manager:[['link',this]],record:[['link',record]],});return dialog;}}
DialogManager.fields={dialogs:one2many('mail.dialog',{inverse:'manager',isCausal:true,}),};DialogManager.modelName='mail.dialog_manager';return DialogManager;}
registerNewModel('mail.dialog_manager',factory);});;

/* /mail/static/src/models/discuss/discuss.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/discuss.discuss.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one,one2many,one2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');function factory(dependencies){class Discuss extends dependencies['mail.model']{cancelThreadRenaming(thread){this.update({renamingThreads:[['unlink',thread]]});}
clearIsAddingItem(){this.update({addingChannelValue:"",isAddingChannel:false,isAddingChat:false,});}
clearReplyingToMessage(){this.update({replyingToMessage:[['unlink-all']]});}
close(){this.update({isOpen:false});}
focus(){this.update({isDoFocus:true});}
async handleAddChannelAutocompleteSelect(ev,ui){const name=this.addingChannelValue;this.clearIsAddingItem();if(ui.item.special){const channel=await this.async(()=>this.env.models['mail.thread'].performRpcCreateChannel({name,privacy:ui.item.special,}));channel.open();}else{const channel=await this.async(()=>this.env.models['mail.thread'].performRpcJoinChannel({channelId:ui.item.id,}));channel.open();}}
async handleAddChannelAutocompleteSource(req,res){const value=req.term;const escapedValue=owl.utils.escape(value);this.update({addingChannelValue:value});const domain=[['channel_type','=','channel'],['name','ilike',value],];const fields=['channel_type','name','public','uuid'];const result=await this.async(()=>this.env.services.rpc({model:"mail.channel",method:"search_read",kwargs:{domain,fields,},}));const items=result.map(data=>{let escapedName=owl.utils.escape(data.name);return Object.assign(data,{label:escapedName,value:escapedName});});items.push({label:_.str.sprintf(`<strong>${this.env._t('Create %s')}</strong>`,`<em><span class="fa fa-hashtag"/>${escapedValue}</em>`,),escapedValue,special:'public'},{label:_.str.sprintf(`<strong>${this.env._t('Create %s')}</strong>`,`<em><span class="fa fa-lock"/>${escapedValue}</em>`,),escapedValue,special:'private'});res(items);}
handleAddChatAutocompleteSelect(ev,ui){this.env.messaging.openChat({partnerId:ui.item.id});this.clearIsAddingItem();}
handleAddChatAutocompleteSource(req,res){const value=owl.utils.escape(req.term);this.env.models['mail.partner'].imSearch({callback:partners=>{const suggestions=partners.map(partner=>{return{id:partner.id,value:partner.nameOrDisplayName,label:partner.nameOrDisplayName,};});res(_.sortBy(suggestions,'label'));},keyword:value,limit:10,});}
openInitThread(){const[model,id]=typeof this.initActiveId==='number'?['mail.channel',this.initActiveId]:this.initActiveId.split('_');const thread=this.env.models['mail.thread'].findFromIdentifyingData({id:model!=='mail.box'?Number(id):id,model,});if(!thread){return;}
thread.open();if(this.env.messaging.device.isMobile&&thread.channel_type){this.update({activeMobileNavbarTabId:thread.channel_type});}}
async openThread(thread){this.update({thread:[['link',thread]],});this.focus();if(!this.isOpen){this.env.bus.trigger('do-action',{action:'mail.action_discuss',options:{active_id:this.threadToActiveId(this),clear_breadcrumbs:false,on_reverse_breadcrumb:()=>this.close(),},});}}
async renameThread(thread,newName){await this.async(()=>thread.rename(newName));this.update({renamingThreads:[['unlink',thread]]});}
replyToMessage(message){this.update({replyingToMessage:[['link',message]]});this.replyingToMessageOriginThreadComposer.update({isLog:!message.is_discussion&&!message.is_notification});this.focus();}
setThreadRenaming(thread){this.update({renamingThreads:[['link',thread]]});}
threadToActiveId(thread){return`${thread.model}_${thread.id}`;}
_computeActiveId(){if(!this.thread){return clear();}
return this.threadToActiveId(this.thread);}
_computeAddingChannelValue(){if(!this.isOpen){return"";}
return this.addingChannelValue;}
_computeHasThreadView(){if(!this.thread||!this.isOpen){return false;}
if(this.env.messaging.device.isMobile&&(this.activeMobileNavbarTabId!=='mailbox'||this.thread.model!=='mail.box')){return false;}
return true;}
_computeIsAddingChannel(){if(!this.isOpen){return false;}
return this.isAddingChannel;}
_computeIsAddingChat(){if(!this.isOpen){return false;}
return this.isAddingChat;}
_computeIsReplyingToMessage(){return!!this.replyingToMessage;}
_computeReplyingToMessage(){if(!this.isOpen){return[['unlink-all']];}
return[];}
_computeThread(){let thread=this.thread;if(this.env.messaging&&this.env.messaging.inbox&&this.env.messaging.device.isMobile&&this.activeMobileNavbarTabId==='mailbox'&&this.initActiveId!=='mail.box_inbox'&&!thread){return[['replace',this.env.messaging.inbox]];}
if(!thread||!thread.isPinned){return[['unlink']];}
return[];}}
Discuss.fields={activeId:attr({compute:'_computeActiveId',dependencies:['thread','threadId','threadModel',],}),activeMobileNavbarTabId:attr({default:'mailbox',}),addingChannelValue:attr({compute:'_computeAddingChannelValue',default:"",dependencies:['isOpen'],}),device:one2one('mail.device',{related:'messaging.device',}),deviceIsMobile:attr({related:'device.isMobile',}),hasModerationDiscardDialog:attr({default:false,}),hasModerationRejectDialog:attr({default:false,}),hasThreadView:attr({compute:'_computeHasThreadView',dependencies:['activeMobileNavbarTabId','deviceIsMobile','isOpen','thread','threadModel',],}),initActiveId:attr({default:'mail.box_inbox',}),isAddingChannel:attr({compute:'_computeIsAddingChannel',default:false,dependencies:['isOpen'],}),isAddingChat:attr({compute:'_computeIsAddingChat',default:false,dependencies:['isOpen'],}),isDoFocus:attr({default:false,}),isOpen:attr({default:false,}),isReplyingToMessage:attr({compute:'_computeIsReplyingToMessage',default:false,dependencies:['replyingToMessage'],}),isThreadPinned:attr({related:'thread.isPinned',}),menu_id:attr({default:null,}),messaging:one2one('mail.messaging',{inverse:'discuss',}),messagingInbox:many2one('mail.thread',{related:'messaging.inbox',}),renamingThreads:one2many('mail.thread'),replyingToMessage:many2one('mail.message',{compute:'_computeReplyingToMessage',dependencies:['isOpen','replyingToMessage',],}),replyingToMessageOriginThread:many2one('mail.thread',{related:'replyingToMessage.originThread',}),replyingToMessageOriginThreadComposer:one2one('mail.composer',{inverse:'discussAsReplying',related:'replyingToMessageOriginThread.composer',}),sidebarQuickSearchValue:attr({default:"",}),stringifiedDomain:attr({default:'[]',}),thread:many2one('mail.thread',{compute:'_computeThread',dependencies:['activeMobileNavbarTabId','deviceIsMobile','isThreadPinned','messaging','messagingInbox','thread','threadModel',],}),threadId:attr({related:'thread.id',}),threadModel:attr({related:'thread.model',}),threadView:one2one('mail.thread_view',{related:'threadViewer.threadView',}),threadViewer:one2one('mail.thread_viewer',{default:[['create']],inverse:'discuss',isCausal:true,}),};Discuss.modelName='mail.discuss';return Discuss;}
registerNewModel('mail.discuss',factory);});;

/* /mail/static/src/models/follower/follower.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/follower.follower.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Follower extends dependencies['mail.model']{static convertData(data){const data2={};if('channel_id'in data){if(!data.channel_id){data2.channel=[['unlink-all']];}else{const channelData={id:data.channel_id,model:'mail.channel',name:data.name,};data2.channel=[['insert',channelData]];}}
if('id'in data){data2.id=data.id;}
if('is_active'in data){data2.isActive=data.is_active;}
if('is_editable'in data){data2.isEditable=data.is_editable;}
if('partner_id'in data){if(!data.partner_id){data2.partner=[['unlink-all']];}else{const partnerData={display_name:data.display_name,email:data.email,id:data.partner_id,name:data.name,};data2.partner=[['insert',partnerData]];}}
return data2;}
closeSubtypes(){this._subtypesListDialog.delete();this._subtypesListDialog=undefined;}
async openProfile(){if(this.partner){return this.partner.openProfile();}
return this.channel.openProfile();}
async remove(){const partner_ids=[];const channel_ids=[];if(this.partner){partner_ids.push(this.partner.id);}else{channel_ids.push(this.channel.id);}
await this.async(()=>this.env.services.rpc({model:this.followedThread.model,method:'message_unsubscribe',args:[[this.followedThread.id],partner_ids,channel_ids]}));const followedThread=this.followedThread;this.delete();followedThread.fetchAndUpdateSuggestedRecipients();}
selectSubtype(subtype){if(!this.selectedSubtypes.includes(subtype)){this.update({selectedSubtypes:[['link',subtype]]});}}
async showSubtypes(){const subtypesData=await this.async(()=>this.env.services.rpc({route:'/mail/read_subscription_data',params:{follower_id:this.id},}));this.update({subtypes:[['unlink-all']]});for(const data of subtypesData){const subtype=this.env.models['mail.follower_subtype'].insert(this.env.models['mail.follower_subtype'].convertData(data));this.update({subtypes:[['link',subtype]]});if(data.followed){this.update({selectedSubtypes:[['link',subtype]]});}else{this.update({selectedSubtypes:[['unlink',subtype]]});}}
this._subtypesListDialog=this.env.messaging.dialogManager.open('mail.follower_subtype_list',{follower:[['link',this]],});}
unselectSubtype(subtype){if(this.selectedSubtypes.includes(subtype)){this.update({selectedSubtypes:[['unlink',subtype]]});}}
async updateSubtypes(){if(this.selectedSubtypes.length===0){this.remove();}else{const kwargs={subtype_ids:this.selectedSubtypes.map(subtype=>subtype.id),};if(this.partner){kwargs.partner_ids=[this.partner.id];}else{kwargs.channel_ids=[this.channel.id];}
await this.async(()=>this.env.services.rpc({model:this.followedThread.model,method:'message_subscribe',args:[[this.followedThread.id]],kwargs,}));this.env.services['notification'].notify({type:'success',message:this.env._t("The subscription preferences were successfully applied."),});}
this.closeSubtypes();}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeName(){if(this.channel){return this.channel.name;}
if(this.partner){return this.partner.name;}
return'';}
_computeResId(){if(this.partner){return this.partner.id;}
if(this.channel){return this.channel.id;}
return 0;}
_computeResModel(){if(this.partner){return this.partner.model;}
if(this.channel){return this.channel.model;}
return'';}}
Follower.fields={resId:attr({compute:'_computeResId',default:0,dependencies:['channelId','partnerId',],}),channel:many2one('mail.thread'),channelId:attr({related:'channel.id',}),channelModel:attr({related:'channel.model',}),channelName:attr({related:'channel.name',}),displayName:attr({related:'partner.display_name'}),followedThread:many2one('mail.thread',{inverse:'followers',}),id:attr(),isActive:attr({default:true,}),isEditable:attr({default:false,}),name:attr({compute:'_computeName',dependencies:['channelName','partnerName',],}),partner:many2one('mail.partner'),partnerId:attr({related:'partner.id',}),partnerModel:attr({related:'partner.model',}),partnerName:attr({related:'partner.name',}),resModel:attr({compute:'_computeResModel',default:'',dependencies:['channelModel','partnerModel',],}),selectedSubtypes:many2many('mail.follower_subtype'),subtypes:many2many('mail.follower_subtype'),};Follower.modelName='mail.follower';return Follower;}
registerNewModel('mail.follower',factory);});;

/* /mail/static/src/models/follower_subtype/follower_subtype.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/follower_subtype/follower_subtype.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');function factory(dependencies){class FollowerSubtype extends dependencies['mail.model']{static convertData(data){const data2={};if('default'in data){data2.isDefault=data.default;}
if('id'in data){data2.id=data.id;}
if('internal'in data){data2.isInternal=data.internal;}
if('name'in data){data2.name=data.name;}
if('parent_model'in data){data2.parentModel=data.parent_model;}
if('res_model'in data){data2.resModel=data.res_model;}
if('sequence'in data){data2.sequence=data.sequence;}
return data2;}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}}
FollowerSubtype.fields={id:attr(),isDefault:attr({default:false,}),isInternal:attr({default:false,}),name:attr(),parentModel:attr(),resModel:attr(),sequence:attr(),};FollowerSubtype.modelName='mail.follower_subtype';return FollowerSubtype;}
registerNewModel('mail.follower_subtype',factory);});;

/* /mail/static/src/models/follower_subtype_list/follower_subtype_list.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/follower_subtype_list/follower_subtype_list.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{many2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class FollowerSubtypeList extends dependencies['mail.model']{}
FollowerSubtypeList.fields={follower:many2one('mail.follower'),};FollowerSubtypeList.modelName='mail.follower_subtype_list';return FollowerSubtypeList;}
registerNewModel('mail.follower_subtype_list',factory);});;

/* /mail/static/src/models/locale/locale.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/locale/locale.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Locale extends dependencies['mail.model']{_computeLanguage(){return this.env._t.database.parameters.code;}
_computeTextDirection(){return this.env._t.database.parameters.direction;}}
Locale.fields={language:attr({compute:'_computeLanguage',}),textDirection:attr({compute:'_computeTextDirection',}),};Locale.modelName='mail.locale';return Locale;}
registerNewModel('mail.locale',factory);});;

/* /mail/static/src/models/mail_template/mail_template.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/mail_template/mail_template.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class MailTemplate extends dependencies['mail.model']{preview(activity){const action={name:this.env._t("Compose Email"),type:'ir.actions.act_window',res_model:'mail.compose.message',views:[[false,'form']],target:'new',context:{default_res_id:activity.thread.id,default_model:activity.thread.model,default_use_template:true,default_template_id:this.id,force_email:true,},};this.env.bus.trigger('do-action',{action,options:{on_close:()=>{activity.thread.refresh();},},});}
async send(activity){await this.async(()=>this.env.services.rpc({model:activity.thread.model,method:'activity_send_mail',args:[[activity.thread.id],this.id],}));activity.thread.refresh();}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}}
MailTemplate.fields={activities:many2many('mail.activity',{inverse:'mailTemplates',}),id:attr(),name:attr(),};MailTemplate.modelName='mail.mail_template';return MailTemplate;}
registerNewModel('mail.mail_template',factory);});;

/* /mail/static/src/models/message/message.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/message/message.js',function(require){'use strict';const emojis=require('mail.emojis');const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2many}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');const{addLink,htmlToTextContentInline,parseAndTransform,timeFromNow}=require('mail.utils');const{str_to_datetime}=require('web.time');function factory(dependencies){class Message extends dependencies['mail.model']{static checkAll(thread,threadStringifiedDomain){const threadCache=thread.cache(threadStringifiedDomain);threadCache.update({checkedMessages:[['link',threadCache.messages]]});}
static convertData(data){const data2={};if('attachment_ids'in data){if(!data.attachment_ids){data2.attachments=[['unlink-all']];}else{data2.attachments=[['insert-and-replace',data.attachment_ids.map(attachmentData=>this.env.models['mail.attachment'].convertData(attachmentData))],];}}
if('author_id'in data){if(!data.author_id){data2.author=[['unlink-all']];}else if(data.author_id[0]!==0){data2.author=[['insert',{display_name:data.author_id[1],id:data.author_id[0],}],];}}
if('body'in data){data2.body=data.body;}
if('channel_ids'in data&&data.channel_ids){const channels=data.channel_ids.map(channelId=>this.env.models['mail.thread'].findFromIdentifyingData({id:channelId,model:'mail.channel',})).filter(channel=>!!channel);data2.serverChannels=[['replace',channels]];}
if('date'in data&&data.date){data2.date=moment(str_to_datetime(data.date));}
if('email_from'in data){data2.email_from=data.email_from;}
if('history_partner_ids'in data){data2.isHistory=data.history_partner_ids.includes(this.env.messaging.currentPartner.id);}
if('id'in data){data2.id=data.id;}
if('is_discussion'in data){data2.is_discussion=data.is_discussion;}
if('is_note'in data){data2.is_note=data.is_note;}
if('is_notification'in data){data2.is_notification=data.is_notification;}
if('message_type'in data){data2.message_type=data.message_type;}
if('model'in data&&'res_id'in data&&data.model&&data.res_id){const originThreadData={id:data.res_id,model:data.model,};if('record_name'in data&&data.record_name){originThreadData.name=data.record_name;}
if('res_model_name'in data&&data.res_model_name){originThreadData.model_name=data.res_model_name;}
if('module_icon'in data){originThreadData.moduleIcon=data.module_icon;}
data2.originThread=[['insert',originThreadData]];}
if('moderation_status'in data){data2.moderation_status=data.moderation_status;}
if('needaction_partner_ids'in data){data2.isNeedaction=data.needaction_partner_ids.includes(this.env.messaging.currentPartner.id);}
if('notifications'in data){data2.notifications=[['insert',data.notifications.map(notificationData=>this.env.models['mail.notification'].convertData(notificationData))]];}
if('starred_partner_ids'in data){data2.isStarred=data.starred_partner_ids.includes(this.env.messaging.currentPartner.id);}
if('subject'in data){data2.subject=data.subject;}
if('subtype_description'in data){data2.subtype_description=data.subtype_description;}
if('subtype_id'in data){data2.subtype_id=data.subtype_id;}
if('tracking_value_ids'in data){data2.tracking_value_ids=data.tracking_value_ids;}
return data2;}
static async markAllAsRead(domain){await this.env.services.rpc({model:'mail.message',method:'mark_all_as_read',kwargs:{domain},});}
static async markAsRead(messages){await this.env.services.rpc({model:'mail.message',method:'set_message_done',args:[messages.map(message=>message.id)]});}
static async moderate(messages,decision,kwargs){const messageIds=messages.map(message=>message.id);await this.env.services.rpc({model:'mail.message',method:'moderate',args:[messageIds,decision],kwargs:kwargs,});}
static async performRpcMessageFetch(domain,limit,moderated_channel_ids,context){const messagesData=await this.env.services.rpc({model:'mail.message',method:'message_fetch',kwargs:{context,domain,limit,moderated_channel_ids,},},{shadow:true});const messages=this.env.models['mail.message'].insert(messagesData.map(messageData=>this.env.models['mail.message'].convertData(messageData)));for(const message of messages){for(const thread of message.threads){if(thread.model!=='mail.channel'||thread.channel_type==='channel'){continue;}
this.env.models['mail.message_seen_indicator'].insert({channelId:thread.id,messageId:message.id,});}}
return messages;}
static uncheckAll(thread,threadStringifiedDomain){const threadCache=thread.cache(threadStringifiedDomain);threadCache.update({checkedMessages:[['unlink',threadCache.messages]]});}
static async unstarAll(){await this.env.services.rpc({model:'mail.message',method:'unstar_all',});}
isChecked(thread,threadStringifiedDomain){const relatedCheckedThreadCache=this.checkedThreadCaches.find(threadCache=>(threadCache.thread===thread&&threadCache.stringifiedDomain===threadStringifiedDomain));return!!relatedCheckedThreadCache;}
async markAsRead(){await this.async(()=>this.env.services.rpc({model:'mail.message',method:'set_message_done',args:[[this.id]]}));}
async moderate(decision,kwargs){await this.async(()=>this.constructor.moderate([this],decision,kwargs));}
openResendAction(){this.env.bus.trigger('do-action',{action:'mail.mail_resend_message_action',options:{additional_context:{mail_message_to_resend:this.id,},},});}
refreshDateFromNow(){this.update({dateFromNow:this._computeDateFromNow()});}
replyTo(){this.env.messaging.discuss.replyToMessage(this);}
toggleCheck(thread,threadStringifiedDomain){const threadCache=thread.cache(threadStringifiedDomain);if(threadCache.checkedMessages.includes(this)){threadCache.update({checkedMessages:[['unlink',this]]});}else{threadCache.update({checkedMessages:[['link',this]]});}}
async toggleStar(){await this.async(()=>this.env.services.rpc({model:'mail.message',method:'toggle_message_starred',args:[[this.id]]}));}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeDateFromNow(){if(!this.date){return clear();}
return timeFromNow(this.date);}
_computeFailureNotifications(){return[['replace',this.notifications.filter(notifications=>['exception','bounce'].includes(notifications.notification_status))]];}
_computeHasCheckbox(){return this.isModeratedByCurrentPartner;}
_computeIsCurrentPartnerAuthor(){return!!(this.author&&this.messagingCurrentPartner&&this.messagingCurrentPartner===this.author);}
_computeIsBodyEqualSubtypeDescription(){if(!this.body||!this.subtype_description){return false;}
const inlineBody=htmlToTextContentInline(this.body);return inlineBody.toLowerCase()===this.subtype_description.toLowerCase();}
_computeIsEmpty(){const isBodyEmpty=(!this.body||['','<p></p>','<p><br></p>','<p><br/></p>',].includes(this.body.replace(/\s/g,'')));return(isBodyEmpty&&this.attachments.length===0&&this.tracking_value_ids.length===0&&!this.subtype_description);}
_computeIsModeratedByCurrentPartner(){return(this.moderation_status==='pending_moderation'&&this.originThread&&this.originThread.isModeratedByCurrentPartner);}
_computeIsSubjectSimilarToOriginThreadName(){if(!this.subject||!this.originThread||!this.originThread.name){return false;}
const threadName=this.originThread.name.toLowerCase().trim();const prefixList=['re:','fw:','fwd:'];let cleanedSubject=this.subject.toLowerCase();let wasSubjectCleaned=true;while(wasSubjectCleaned){wasSubjectCleaned=false;if(threadName===cleanedSubject){return true;}
for(const prefix of prefixList){if(cleanedSubject.startsWith(prefix)){cleanedSubject=cleanedSubject.replace(prefix,'').trim();wasSubjectCleaned=true;break;}}}
return false;}
_computeMessaging(){return[['link',this.env.messaging]];}
_computePrettyBody(){if(!this.body){return clear();}
let prettyBody;for(const emoji of emojis){const{unicode}=emoji;const regexp=new RegExp(`(?:^|\\s|<[a-z]*>)(${unicode})(?=\\s|$|</[a-z]*>)`,"g");const originalBody=this.body;prettyBody=this.body.replace(regexp,` <span class="o_mail_emoji">${unicode}</span> `);if(_.str.count(prettyBody,"o_mail_emoji")>200){prettyBody=originalBody;}}
return parseAndTransform(prettyBody,addLink);}
_computeThreads(){const threads=[...this.serverChannels];if(this.isHistory){threads.push(this.env.messaging.history);}
if(this.isNeedaction){threads.push(this.env.messaging.inbox);}
if(this.isStarred){threads.push(this.env.messaging.starred);}
if(this.env.messaging.moderation&&this.isModeratedByCurrentPartner){threads.push(this.env.messaging.moderation);}
if(this.originThread){threads.push(this.originThread);}
return[['replace',threads]];}}
Message.fields={attachments:many2many('mail.attachment',{inverse:'messages',}),author:many2one('mail.partner',{inverse:'messagesAsAuthor',}),body:attr({default:"",}),checkedThreadCaches:many2many('mail.thread_cache',{inverse:'checkedMessages',}),date:attr(),dateFromNow:attr({compute:'_computeDateFromNow',dependencies:['date',],}),email_from:attr(),failureNotifications:one2many('mail.notification',{compute:'_computeFailureNotifications',dependencies:['notificationsStatus'],}),hasCheckbox:attr({compute:'_computeHasCheckbox',default:false,dependencies:['isModeratedByCurrentPartner'],}),id:attr(),isCurrentPartnerAuthor:attr({compute:'_computeIsCurrentPartnerAuthor',default:false,dependencies:['author','messagingCurrentPartner',],}),isBodyEqualSubtypeDescription:attr({compute:'_computeIsBodyEqualSubtypeDescription',default:false,dependencies:['body','subtype_description',],}),isEmpty:attr({compute:'_computeIsEmpty',dependencies:['attachments','body','subtype_description','tracking_value_ids',],}),isModeratedByCurrentPartner:attr({compute:'_computeIsModeratedByCurrentPartner',default:false,dependencies:['moderation_status','originThread','originThreadIsModeratedByCurrentPartner',],}),isSubjectSimilarToOriginThreadName:attr({compute:'_computeIsSubjectSimilarToOriginThreadName',dependencies:['originThread','originThreadName','subject',],}),isTemporary:attr({default:false,}),isTransient:attr({default:false,}),is_discussion:attr({default:false,}),isHistory:attr({default:false,}),isNeedaction:attr({default:false,}),is_note:attr({default:false,}),is_notification:attr({default:false,}),isStarred:attr({default:false,}),message_type:attr(),messaging:many2one('mail.messaging',{compute:'_computeMessaging',}),messagingCurrentPartner:many2one('mail.partner',{related:'messaging.currentPartner',}),messagingHistory:many2one('mail.thread',{related:'messaging.history',}),messagingInbox:many2one('mail.thread',{related:'messaging.inbox',}),messagingModeration:many2one('mail.thread',{related:'messaging.moderation',}),messagingStarred:many2one('mail.thread',{related:'messaging.starred',}),moderation_status:attr(),notifications:one2many('mail.notification',{inverse:'message',isCausal:true,}),notificationsStatus:attr({default:[],related:'notifications.notification_status',}),originThread:many2one('mail.thread',{inverse:'messagesAsOriginThread',}),originThreadIsModeratedByCurrentPartner:attr({default:false,related:'originThread.isModeratedByCurrentPartner',}),originThreadName:attr({related:'originThread.name',}),prettyBody:attr({compute:'_computePrettyBody',default:"",dependencies:['body'],}),subject:attr(),subtype_description:attr(),subtype_id:attr(),threads:many2many('mail.thread',{compute:'_computeThreads',dependencies:['isHistory','isModeratedByCurrentPartner','isNeedaction','isStarred','messagingHistory','messagingInbox','messagingModeration','messagingStarred','originThread','serverChannels',],inverse:'messages',}),tracking_value_ids:attr({default:[],}),serverChannels:many2many('mail.thread',{inverse:'messagesAsServerChannel',}),};Message.modelName='mail.message';return Message;}
registerNewModel('mail.message',factory);});;

/* /mail/static/src/models/message_seen_indicator/message_seen_indicator.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/message_seen_indicator/message_seen_indicator.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class MessageSeenIndicator extends dependencies['mail.model']{static recomputeFetchedValues(channel=undefined){const indicatorFindFunction=channel?localIndicator=>localIndicator.thread===channel:undefined;const indicators=this.env.models['mail.message_seen_indicator'].all(indicatorFindFunction);for(const indicator of indicators){indicator.update({hasEveryoneFetched:indicator._computeHasEveryoneFetched(),hasSomeoneFetched:indicator._computeHasSomeoneFetched(),partnersThatHaveFetched:indicator._computePartnersThatHaveFetched(),});}}
static recomputeSeenValues(channel=undefined){const indicatorFindFunction=channel?localIndicator=>localIndicator.thread===channel:undefined;const indicators=this.env.models['mail.message_seen_indicator'].all(indicatorFindFunction);for(const indicator of indicators){indicator.update({hasEveryoneSeen:indicator._computeHasEveryoneSeen(),hasSomeoneFetched:indicator._computeHasSomeoneFetched(),hasSomeoneSeen:indicator._computeHasSomeoneSeen(),isMessagePreviousToLastCurrentPartnerMessageSeenByEveryone:indicator._computeIsMessagePreviousToLastCurrentPartnerMessageSeenByEveryone(),partnersThatHaveFetched:indicator._computePartnersThatHaveFetched(),partnersThatHaveSeen:indicator._computePartnersThatHaveSeen(),});}}
static _createRecordLocalId(data){const{channelId,messageId}=data;return`${this.modelName}_${channelId}_${messageId}`;}
_computeHasEveryoneFetched(){if(!this.message||!this.thread||!this.thread.partnerSeenInfos){return false;}
const otherPartnerSeenInfosDidNotFetch=this.thread.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner!==this.message.author&&(!partnerSeenInfo.lastFetchedMessage||partnerSeenInfo.lastFetchedMessage.id<this.message.id));return otherPartnerSeenInfosDidNotFetch.length===0;}
_computeHasEveryoneSeen(){if(!this.message||!this.thread||!this.thread.partnerSeenInfos){return false;}
const otherPartnerSeenInfosDidNotSee=this.thread.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner!==this.message.author&&(!partnerSeenInfo.lastSeenMessage||partnerSeenInfo.lastSeenMessage.id<this.message.id));return otherPartnerSeenInfosDidNotSee.length===0;}
_computeHasSomeoneFetched(){if(!this.message||!this.thread||!this.thread.partnerSeenInfos){return false;}
const otherPartnerSeenInfosFetched=this.thread.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner!==this.message.author&&partnerSeenInfo.lastFetchedMessage&&partnerSeenInfo.lastFetchedMessage.id>=this.message.id);return otherPartnerSeenInfosFetched.length>0;}
_computeHasSomeoneSeen(){if(!this.message||!this.thread||!this.thread.partnerSeenInfos){return false;}
const otherPartnerSeenInfosSeen=this.thread.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner!==this.message.author&&partnerSeenInfo.lastSeenMessage&&partnerSeenInfo.lastSeenMessage.id>=this.message.id);return otherPartnerSeenInfosSeen.length>0;}
_computeIsMessagePreviousToLastCurrentPartnerMessageSeenByEveryone(){if(!this.message||!this.thread||!this.thread.lastCurrentPartnerMessageSeenByEveryone){return false;}
return this.message.id<this.thread.lastCurrentPartnerMessageSeenByEveryone.id;}
_computePartnersThatHaveFetched(){if(!this.message||!this.thread||!this.thread.partnerSeenInfos){return[['unlink-all']];}
const otherPartnersThatHaveFetched=this.thread.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner&&partnerSeenInfo.partner!==this.message.author&&partnerSeenInfo.lastFetchedMessage&&partnerSeenInfo.lastFetchedMessage.id>=this.message.id).map(partnerSeenInfo=>partnerSeenInfo.partner);if(otherPartnersThatHaveFetched.length===0){return[['unlink-all']];}
return[['replace',otherPartnersThatHaveFetched]];}
_computePartnersThatHaveSeen(){if(!this.message||!this.thread||!this.thread.partnerSeenInfos){return[['unlink-all']];}
const otherPartnersThatHaveSeen=this.thread.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner&&partnerSeenInfo.partner!==this.message.author&&partnerSeenInfo.lastSeenMessage&&partnerSeenInfo.lastSeenMessage.id>=this.message.id).map(partnerSeenInfo=>partnerSeenInfo.partner);if(otherPartnersThatHaveSeen.length===0){return[['unlink-all']];}
return[['replace',otherPartnersThatHaveSeen]];}
_computeMessage(){return[['insert',{id:this.messageId}]];}
_computeThread(){return[['insert',{id:this.channelId,model:'mail.channel',}]];}}
MessageSeenIndicator.modelName='mail.message_seen_indicator';MessageSeenIndicator.fields={channelId:attr(),hasEveryoneFetched:attr({compute:'_computeHasEveryoneFetched',default:false,dependencies:['messageAuthor','messageId','threadPartnerSeenInfos'],}),hasEveryoneSeen:attr({compute:'_computeHasEveryoneSeen',default:false,dependencies:['messageAuthor','messageId','threadPartnerSeenInfos'],}),hasSomeoneFetched:attr({compute:'_computeHasSomeoneFetched',default:false,dependencies:['messageAuthor','messageId','threadPartnerSeenInfos'],}),hasSomeoneSeen:attr({compute:'_computeHasSomeoneSeen',default:false,dependencies:['messageAuthor','messageId','threadPartnerSeenInfos'],}),id:attr(),isMessagePreviousToLastCurrentPartnerMessageSeenByEveryone:attr({compute:'_computeIsMessagePreviousToLastCurrentPartnerMessageSeenByEveryone',default:false,dependencies:['messageId','threadLastCurrentPartnerMessageSeenByEveryone',],}),message:many2one('mail.message',{compute:'_computeMessage',dependencies:['messageId',],}),messageAuthor:many2one('mail.partner',{related:'message.author',}),messageId:attr(),partnersThatHaveFetched:many2many('mail.partner',{compute:'_computePartnersThatHaveFetched',dependencies:['messageAuthor','messageId','threadPartnerSeenInfos'],}),partnersThatHaveSeen:many2many('mail.partner',{compute:'_computePartnersThatHaveSeen',dependencies:['messageAuthor','messageId','threadPartnerSeenInfos'],}),thread:many2one('mail.thread',{compute:'_computeThread',dependencies:['channelId',],inverse:'messageSeenIndicators'}),threadPartnerSeenInfos:one2many('mail.thread_partner_seen_info',{related:'thread.partnerSeenInfos',}),threadLastCurrentPartnerMessageSeenByEveryone:many2one('mail.message',{related:'thread.lastCurrentPartnerMessageSeenByEveryone',}),};return MessageSeenIndicator;}
registerNewModel('mail.message_seen_indicator',factory);});;

/* /mail/static/src/models/messaging/messaging.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/messaging/messaging.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2many,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Messaging extends dependencies['mail.model']{_willDelete(){if(this.env.services['bus_service']){this.env.services['bus_service'].off('window_focus',null,this._handleGlobalWindowFocus);}
return super._willDelete(...arguments);}
async start(){this._handleGlobalWindowFocus=this._handleGlobalWindowFocus.bind(this);this.env.services['bus_service'].on('window_focus',null,this._handleGlobalWindowFocus);await this.async(()=>this.initializer.start());this.notificationHandler.start();this.update({isInitialized:true});}
isNotificationPermissionDefault(){const windowNotification=this.env.browser.Notification;return windowNotification?windowNotification.permission==='default':false;}
async getChat({partnerId,userId}){if(userId){const user=this.env.models['mail.user'].insert({id:userId});return user.getChat();}
if(partnerId){const partner=this.env.models['mail.partner'].insert({id:partnerId});return partner.getChat();}}
async openChat(person,options){const chat=await this.async(()=>this.getChat(person));if(!chat){return;}
await this.async(()=>chat.open(options));return chat;}
async openDocument({id,model}){this.env.bus.trigger('do-action',{action:{type:'ir.actions.act_window',res_model:model,views:[[false,'form']],res_id:id,},});if(this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}
async openProfile({id,model}){if(model==='res.partner'){const partner=this.env.models['mail.partner'].insert({id});return partner.openProfile();}
if(model==='res.users'){const user=this.env.models['mail.user'].insert({id});return user.openProfile();}
if(model==='mail.channel'){let channel=this.env.models['mail.thread'].findFromIdentifyingData({id,model:'mail.channel'});if(!channel){channel=(await this.async(()=>this.env.models['mail.thread'].performRpcChannelInfo({ids:[id]})))[0];}
if(!channel){this.env.services['notification'].notify({message:this.env._t("You can only open the profile of existing channels."),type:'warning',});return;}
return channel.openProfile();}
return this.env.messaging.openDocument({id,model});}
_handleGlobalWindowFocus(){this.update({outOfFocusUnreadMessageCounter:0});this.env.bus.trigger('set_title_part',{part:'_chat',});}}
Messaging.fields={cannedResponses:one2many('mail.canned_response'),chatWindowManager:one2one('mail.chat_window_manager',{default:[['create']],inverse:'messaging',isCausal:true,}),commands:one2many('mail.channel_command'),currentPartner:one2one('mail.partner'),currentUser:one2one('mail.user'),device:one2one('mail.device',{default:[['create']],isCausal:true,}),dialogManager:one2one('mail.dialog_manager',{default:[['create']],isCausal:true,}),discuss:one2one('mail.discuss',{default:[['create']],inverse:'messaging',isCausal:true,}),history:one2one('mail.thread'),inbox:one2one('mail.thread'),initializer:one2one('mail.messaging_initializer',{default:[['create']],inverse:'messaging',isCausal:true,}),isInitialized:attr({default:false,}),locale:one2one('mail.locale',{default:[['create']],isCausal:true,}),messagingMenu:one2one('mail.messaging_menu',{default:[['create']],inverse:'messaging',isCausal:true,}),moderation:one2one('mail.thread'),notificationGroupManager:one2one('mail.notification_group_manager',{default:[['create']],isCausal:true,}),notificationHandler:one2one('mail.messaging_notification_handler',{default:[['create']],inverse:'messaging',isCausal:true,}),outOfFocusUnreadMessageCounter:attr({default:0,}),partnerRoot:many2one('mail.partner'),publicPartner:many2one('mail.partner'),publicPartners:many2many('mail.partner'),starred:one2one('mail.thread'),};Messaging.modelName='mail.messaging';return Messaging;}
registerNewModel('mail.messaging',factory);});;

/* /mail/static/src/models/messaging_initializer/messaging_initializer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/messaging_initializer/messaging_initializer.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{one2one}=require('mail/static/src/model/model_field.js');const{executeGracefully}=require('mail/static/src/utils/utils.js');function factory(dependencies){class MessagingInitializer extends dependencies['mail.model']{async start(){this.messaging.update({history:[['create',{id:'history',isServerPinned:true,model:'mail.box',name:this.env._t("History"),}]],inbox:[['create',{id:'inbox',isServerPinned:true,model:'mail.box',name:this.env._t("Inbox"),}]],moderation:[['create',{id:'moderation',model:'mail.box',name:this.env._t("Moderation"),}]],starred:[['create',{id:'starred',isServerPinned:true,model:'mail.box',name:this.env._t("Starred"),}]],});const device=this.messaging.device;device.start();const context=Object.assign({isMobile:device.isMobile,},this.env.session.user_context);const discuss=this.messaging.discuss;const data=await this.async(()=>this.env.services.rpc({route:'/mail/init_messaging',params:{context:context}},{shadow:true}));await this.async(()=>this._init(data));if(discuss.isOpen){discuss.openInitThread();}
if(this.env.autofetchPartnerImStatus){this.env.models['mail.partner'].startLoopFetchImStatus();}}
async _init({channel_slots,commands=[],current_partner,current_user_id,mail_failures={},mention_partner_suggestions=[],menu_id,moderation_channel_ids=[],moderation_counter=0,needaction_inbox_counter=0,partner_root,public_partner,public_partners,shortcodes=[],starred_counter=0}){const discuss=this.messaging.discuss;this._initPartners({current_partner,current_user_id,moderation_channel_ids,partner_root,public_partner,public_partners,});this._initMailboxes({moderation_channel_ids,moderation_counter,needaction_inbox_counter,starred_counter,});this._initCannedResponses(shortcodes);this._initCommands(commands);this._initMentionPartnerSuggestions(mention_partner_suggestions);await this.async(()=>this._initChannels(channel_slots));this._initMailFailures(mail_failures);discuss.update({menu_id});}
_initCannedResponses(cannedResponsesData){this.messaging.update({cannedResponses:[['insert',cannedResponsesData]],});}
async _initChannels({channel_channel=[],channel_direct_message=[],channel_private_group=[],}={}){const channelsData=channel_channel.concat(channel_direct_message,channel_private_group);return executeGracefully(channelsData.map(channelData=>()=>{const convertedData=this.env.models['mail.thread'].convertData(channelData);if(!convertedData.members){convertedData.members=[['link',this.env.messaging.currentPartner]];}
const channel=this.env.models['mail.thread'].insert(Object.assign({model:'mail.channel'},convertedData));if(!channel.isPinned){channel.pin();}}));}
_initCommands(commandsData){this.messaging.update({commands:[['insert',commandsData]],});}
_initMailboxes({moderation_channel_ids,moderation_counter,needaction_inbox_counter,starred_counter,}){this.env.messaging.inbox.update({counter:needaction_inbox_counter});this.env.messaging.starred.update({counter:starred_counter});if(moderation_channel_ids.length>0){this.messaging.moderation.update({counter:moderation_counter,isServerPinned:true,});}}
async _initMailFailures(mailFailuresData){await executeGracefully(mailFailuresData.map(messageData=>()=>{const message=this.env.models['mail.message'].insert(this.env.models['mail.message'].convertData(messageData));if(!message.author&&this.messaging.currentPartner){message.update({author:[['link',this.messaging.currentPartner]]});}}));this.messaging.notificationGroupManager.computeGroups();this.messaging.messagingMenu.update();}
async _initMentionPartnerSuggestions(mentionPartnerSuggestionsData){return executeGracefully(mentionPartnerSuggestionsData.map(suggestions=>()=>{return executeGracefully(suggestions.map(suggestion=>()=>{this.env.models['mail.partner'].insert(this.env.models['mail.partner'].convertData(suggestion));}));}));}
_initPartners({current_partner,current_user_id:currentUserId,moderation_channel_ids=[],partner_root,public_partner,public_partners=[],}){const publicPartner=this.env.models['mail.partner'].convertData(public_partner);this.messaging.update({currentPartner:[['insert',Object.assign(this.env.models['mail.partner'].convertData(current_partner),{moderatedChannels:[['insert',moderation_channel_ids.map(id=>{return{id,model:'mail.channel',};})],],user:[['insert',{id:currentUserId}]],})]],currentUser:[['insert',{id:currentUserId}]],partnerRoot:[['insert',this.env.models['mail.partner'].convertData(partner_root)]],publicPartner:[['insert',publicPartner]],publicPartners:[['insert',publicPartner],['insert',public_partners.map(publicPartner=>this.env.models['mail.partner'].convertData(publicPartner))],],});}}
MessagingInitializer.fields={messaging:one2one('mail.messaging',{inverse:'initializer',}),};MessagingInitializer.modelName='mail.messaging_initializer';return MessagingInitializer;}
registerNewModel('mail.messaging_initializer',factory);});;

/* /mail/static/src/models/messaging_menu/messaging_menu.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/messaging_menu/messaging_menu.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class MessagingMenu extends dependencies['mail.model']{close(){this.update({isOpen:false});}
toggleMobileNewMessage(){this.update({isMobileNewMessageToggled:!this.isMobileNewMessageToggled});}
toggleOpen(){this.update({isOpen:!this.isOpen});}
_computeInboxMessagesAutoloader(){if(!this.isOpen){return;}
const inbox=this.env.messaging.inbox;if(!inbox||!inbox.mainCache){return;}
inbox.mainCache.update({isCacheRefreshRequested:true});}
_updateCounter(){if(!this.env.messaging){return 0;}
const inboxMailbox=this.env.messaging.inbox;const unreadChannels=this.env.models['mail.thread'].all(thread=>thread.localMessageUnreadCounter>0&&thread.model==='mail.channel'&&thread.isPinned);let counter=unreadChannels.length;if(inboxMailbox){counter+=inboxMailbox.counter;}
if(this.messaging.notificationGroupManager){counter+=this.messaging.notificationGroupManager.groups.reduce((total,group)=>total+group.notifications.length,0);}
if(this.messaging.isNotificationPermissionDefault()){counter++;}
return counter;}
_updateAfter(previous){const counter=this._updateCounter();if(this.counter!==counter){this.update({counter});}}}
MessagingMenu.fields={activeTabId:attr({default:'all',}),counter:attr({default:0,}),inboxMessagesAutoloader:attr({compute:'_computeInboxMessagesAutoloader',dependencies:['isOpen','messagingInbox','messagingInboxMainCache',],}),isMobileNewMessageToggled:attr({default:false,}),isOpen:attr({default:false,}),messaging:one2one('mail.messaging',{inverse:'messagingMenu',}),messagingInbox:one2one('mail.thread',{related:'messaging.inbox',}),messagingInboxMainCache:one2one('mail.thread_cache',{related:'messagingInbox.mainCache',}),};MessagingMenu.modelName='mail.messaging_menu';return MessagingMenu;}
registerNewModel('mail.messaging_menu',factory);});;

/* /mail/static/src/models/messaging_notification_handler/messaging_notification_handler.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/messaging_notification_handler/messaging_notification_handler.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{one2one}=require('mail/static/src/model/model_field.js');const{decrement,increment}=require('mail/static/src/model/model_field_command.js');const{htmlToTextContentInline}=require('mail.utils');const PREVIEW_MSG_MAX_SIZE=350;function factory(dependencies){class MessagingNotificationHandler extends dependencies['mail.model']{_willDelete(){if(this.env.services['bus_service']){this.env.services['bus_service'].off('notification');this.env.services['bus_service'].stopPolling();}
return super._willDelete(...arguments);}
start(){this.env.services.bus_service.onNotification(null,notifs=>this._handleNotifications(notifs));this.env.services.bus_service.startPolling();}
_filterNotificationsOnUnsubscribe(notifications){const unsubscribedNotif=notifications.find(notif=>notif[1].info==='unsubscribe');if(unsubscribedNotif){notifications=notifications.filter(notif=>notif[0][1]!=='mail.channel'||notif[0][2]!==unsubscribedNotif[1].id);}
return notifications;}
async _handleNotifications(notifications){const filteredNotifications=this._filterNotificationsOnUnsubscribe(notifications);const proms=filteredNotifications.map(notification=>{const[channel,message]=notification;if(typeof channel==='string'){return;}
const[,model,id]=channel;switch(model){case'ir.needaction':return this._handleNotificationNeedaction(message);case'mail.channel':return this._handleNotificationChannel(id,message);case'res.partner':if(id!==this.env.messaging.currentPartner.id){return;}
return this._handleNotificationPartner(Object.assign({},message));}});await this.async(()=>Promise.all(proms));}
async _handleNotificationChannel(channelId,data){const{info,last_message_id,partner_id,}=data;switch(info){case'channel_fetched':return this._handleNotificationChannelFetched(channelId,{last_message_id,partner_id,});case'channel_seen':return this._handleNotificationChannelSeen(channelId,{last_message_id,partner_id,});case'typing_status':return this._handleNotificationChannelTypingStatus(channelId,data);default:return this._handleNotificationChannelMessage(channelId,data);}}
async _handleNotificationChannelFetched(channelId,{last_message_id,partner_id,}){const channel=this.env.models['mail.thread'].findFromIdentifyingData({id:channelId,model:'mail.channel',});if(!channel){return;}
if(channel.channel_type==='channel'){return;}
this.env.models['mail.thread_partner_seen_info'].insert({channelId:channel.id,lastFetchedMessage:[['insert',{id:last_message_id}]],partnerId:partner_id,});channel.update({messageSeenIndicators:[['insert',{channelId:channel.id,messageId:last_message_id,}]],});this.env.models['mail.message_seen_indicator'].recomputeFetchedValues(channel);}
async _handleNotificationChannelMessage(channelId,messageData){let channel=this.env.models['mail.thread'].findFromIdentifyingData({id:channelId,model:'mail.channel',});const wasChannelExisting=!!channel;const convertedData=this.env.models['mail.message'].convertData(messageData);const oldMessage=this.env.models['mail.message'].findFromIdentifyingData(convertedData);const oldMessageModerationStatus=(oldMessage&&oldMessage.moderation_status);const oldMessageWasModeratedByCurrentPartner=(oldMessage&&oldMessage.isModeratedByCurrentPartner);if(!channel){channel=(await this.async(()=>this.env.models['mail.thread'].performRpcChannelInfo({ids:[channelId]})))[0];}
if(!channel.isPinned){channel.pin();}
const message=this.env.models['mail.message'].insert(convertedData);this._notifyThreadViewsMessageReceived(message);if(oldMessage){if(oldMessageModerationStatus==='pending_moderation'&&message.moderation_status!=='pending_moderation'&&oldMessageWasModeratedByCurrentPartner){const moderation=this.env.messaging.moderation;moderation.update({counter:decrement()});}
return;}
if(message.author===this.env.messaging.currentPartner){return;}
if(channel.mass_mailing&&this.env.session.notification_type==='email'){this._handleNotificationChannelSeen(channelId,{last_message_id:messageData.id,partner_id:this.env.messaging.currentPartner.id,});return;}
const isChatWithOdooBot=(channel.correspondent&&channel.correspondent===this.env.messaging.partnerRoot);if(!isChatWithOdooBot){const isOdooFocused=this.env.services['bus_service'].isOdooFocused();if(!isOdooFocused&&channel.isChatChannel){this._notifyNewChannelMessageWhileOutOfFocus({channel,message,});}
if(channel.model==='mail.channel'&&channel.channel_type!=='channel'){channel.markAsFetched();}
if(channel.channel_type!=='channel'&&!this.env.messaging.device.isMobile&&!channel.chatWindow){this.env.messaging.chatWindowManager.openThread(channel);}}
if(!wasChannelExisting){return;}
this.messaging.messagingMenu.update();}
async _handleNotificationChannelSeen(channelId,{last_message_id,partner_id,}){const channel=this.env.models['mail.thread'].findFromIdentifyingData({id:channelId,model:'mail.channel',});if(!channel){return;}
const lastMessage=this.env.models['mail.message'].insert({id:last_message_id});const shouldComputeSeenIndicators=channel.channel_type!=='channel';const updateData={};if(shouldComputeSeenIndicators){this.env.models['mail.thread_partner_seen_info'].insert({channelId:channel.id,lastSeenMessage:[['link',lastMessage]],partnerId:partner_id,});Object.assign(updateData,{messageSeenIndicators:[['insert',{channelId:channel.id,messageId:lastMessage.id,},]],});}
if(this.env.messaging.currentPartner.id===partner_id){Object.assign(updateData,{lastSeenByCurrentPartnerMessageId:last_message_id,pendingSeenMessageId:undefined,});}
channel.update(updateData);if(shouldComputeSeenIndicators){this.env.models['mail.thread'].computeLastCurrentPartnerMessageSeenByEveryone(channel);this.env.models['mail.message_seen_indicator'].recomputeSeenValues(channel);}
this.messaging.messagingMenu.update();}
_handleNotificationChannelTypingStatus(channelId,{is_typing,partner_id,partner_name}){const channel=this.env.models['mail.thread'].findFromIdentifyingData({id:channelId,model:'mail.channel',});if(!channel){return;}
const partner=this.env.models['mail.partner'].insert({id:partner_id,name:partner_name,});if(partner===this.env.messaging.currentPartner){return;}
if(is_typing){if(channel.typingMembers.includes(partner)){channel.refreshOtherMemberTypingMember(partner);}else{channel.registerOtherMemberTypingMember(partner);}}else{if(!channel.typingMembers.includes(partner)){return;}
channel.unregisterOtherMemberTypingMember(partner);}}
_handleNotificationNeedaction(data){const message=this.env.models['mail.message'].insert(this.env.models['mail.message'].convertData(data));this.env.messaging.inbox.update({counter:increment()});const originThread=message.originThread;if(originThread&&message.isNeedaction){originThread.update({message_needaction_counter:increment()});}
this.messaging.messagingMenu.update();}
async _handleNotificationPartner(data){const{info,type,}=data;if(type==='activity_updated'){this.env.bus.trigger('activity_updated',data);}else if(type==='author'){return this._handleNotificationPartnerAuthor(data);}else if(info==='channel_seen'){return this._handleNotificationChannelSeen(data.channel_id,data);}else if(type==='deletion'){return this._handleNotificationPartnerDeletion(data);}else if(type==='message_notification_update'){return this._handleNotificationPartnerMessageNotificationUpdate(data.elements);}else if(type==='mark_as_read'){return this._handleNotificationPartnerMarkAsRead(data);}else if(type==='moderator'){return this._handleNotificationPartnerModerator(data);}else if(type==='simple_notification'){const escapedMessage=owl.utils.escape(data.message);this.env.services['notification'].notify({message:escapedMessage,sticky:data.sticky,type:data.warning?'warning':'danger',});}else if(type==='toggle_star'){return this._handleNotificationPartnerToggleStar(data);}else if(info==='transient_message'){return this._handleNotificationPartnerTransientMessage(data);}else if(info==='unsubscribe'){return this._handleNotificationPartnerUnsubscribe(data.id);}else if(type==='user_connection'){return this._handleNotificationPartnerUserConnection(data);}else if(!type){return this._handleNotificationPartnerChannel(data);}}
_handleNotificationPartnerAuthor(data){this.env.models['mail.message'].insert(this.env.models['mail.message'].convertData(data.message));}
_handleNotificationPartnerChannel(data){const convertedData=this.env.models['mail.thread'].convertData(Object.assign({model:'mail.channel'},data));if(!convertedData.members){convertedData.members=[['link',this.env.messaging.currentPartner]];}
let channel=this.env.models['mail.thread'].findFromIdentifyingData(convertedData);const wasCurrentPartnerMember=(channel&&channel.members.includes(this.env.messaging.currentPartner));channel=this.env.models['mail.thread'].insert(convertedData);if(channel.channel_type==='channel'&&data.info!=='creation'&&!wasCurrentPartnerMember){this.env.services['notification'].notify({message:_.str.sprintf(this.env._t("You have been invited to: %s"),owl.utils.escape(channel.name)),type:'warning',});}
this.messaging.messagingMenu.update();}
_handleNotificationPartnerDeletion({message_ids}){const moderationMailbox=this.env.messaging.moderation;for(const id of message_ids){const message=this.env.models['mail.message'].findFromIdentifyingData({id});if(message){if(message.moderation_status==='pending_moderation'&&message.originThread.isModeratedByCurrentPartner){moderationMailbox.update({counter:decrement()});}
message.delete();}}
this.messaging.notificationGroupManager.computeGroups();this.messaging.messagingMenu.update();}
_handleNotificationPartnerMessageNotificationUpdate(data){for(const messageData of data){const message=this.env.models['mail.message'].insert(this.env.models['mail.message'].convertData(messageData));if(!message.author&&this.messaging.currentPartner){message.update({author:[['link',this.messaging.currentPartner]]});}}
this.messaging.notificationGroupManager.computeGroups();this.messaging.messagingMenu.update();}
_handleNotificationPartnerMarkAsRead({channel_ids,message_ids=[],needaction_inbox_counter}){for(const message_id of message_ids){const message=this.env.models['mail.message'].findFromIdentifyingData({id:message_id});if(!message){continue;}
const originThread=message.originThread;if(originThread&&message.isNeedaction){originThread.update({message_needaction_counter:decrement()});}
message.update({isHistory:true,isNeedaction:false,});}
const inbox=this.env.messaging.inbox;if(needaction_inbox_counter!==undefined){inbox.update({counter:needaction_inbox_counter});}else{inbox.update({counter:decrement(message_ids.length)});}
if(inbox.counter>inbox.mainCache.fetchedMessages.length){inbox.mainCache.update({hasToLoadMessages:true});}
this.messaging.messagingMenu.update();}
_handleNotificationPartnerModerator({message:data}){this.env.models['mail.message'].insert(this.env.models['mail.message'].convertData(data));const moderationMailbox=this.env.messaging.moderation;if(moderationMailbox){moderationMailbox.update({counter:increment()});}
this.messaging.messagingMenu.update();}
_handleNotificationPartnerToggleStar({message_ids=[],starred}){const starredMailbox=this.env.messaging.starred;for(const messageId of message_ids){const message=this.env.models['mail.message'].findFromIdentifyingData({id:messageId,});if(!message){continue;}
message.update({isStarred:starred});starredMailbox.update({counter:starred?increment():decrement(),});}}
_handleNotificationPartnerTransientMessage(data){const convertedData=this.env.models['mail.message'].convertData(data);const lastMessageId=this.env.models['mail.message'].all().reduce((lastMessageId,message)=>Math.max(lastMessageId,message.id),0);const partnerRoot=this.env.messaging.partnerRoot;const message=this.env.models['mail.message'].create(Object.assign(convertedData,{author:[['link',partnerRoot]],id:lastMessageId+0.01,isTransient:true,}));this._notifyThreadViewsMessageReceived(message);this.messaging.messagingMenu.update();}
_handleNotificationPartnerUnsubscribe(channelId){const channel=this.env.models['mail.thread'].findFromIdentifyingData({id:channelId,model:'mail.channel',});if(!channel){return;}
let message;if(channel.correspondent){const correspondent=channel.correspondent;message=_.str.sprintf(this.env._t("You unpinned your conversation with <b>%s</b>."),owl.utils.escape(correspondent.name));}else{message=_.str.sprintf(this.env._t("You unsubscribed from <b>%s</b>."),owl.utils.escape(channel.name));}
channel.update({isServerPinned:false});this.env.services['notification'].notify({message,type:'warning',});}
async _handleNotificationPartnerUserConnection({message,partner_id,title}){this.env.services['bus_service'].sendNotification(title,message);const chat=await this.async(()=>this.env.messaging.getChat({partnerId:partner_id}));if(!chat||this.env.messaging.device.isMobile){return;}
this.env.messaging.chatWindowManager.openThread(chat);}
_notifyNewChannelMessageWhileOutOfFocus({channel,message}){const author=message.author;const messaging=this.env.messaging;let notificationTitle;if(!author){notificationTitle=this.env._t("New message");}else{const authorName=author.nameOrDisplayName;if(channel.channel_type==='channel'){const channelIcon=this.env.qweb.renderToString('mail.ThreadIcon',{env:this.env,thread:channel,});const channelName=owl.utils.escape(channel.displayName);const channelNameWithIcon=channelIcon+channelName;notificationTitle=_.str.sprintf(this.env._t("%s from %s"),owl.utils.escape(authorName),channelNameWithIcon);}else{notificationTitle=owl.utils.escape(authorName);}}
const notificationContent=owl.utils.escape(htmlToTextContentInline(message.body).substr(0,PREVIEW_MSG_MAX_SIZE));this.env.services['bus_service'].sendNotification(notificationTitle,notificationContent);messaging.update({outOfFocusUnreadMessageCounter:increment()});const titlePattern=messaging.outOfFocusUnreadMessageCounter===1?this.env._t("%d Message"):this.env._t("%d Messages");this.env.bus.trigger('set_title_part',{part:'_chat',title:_.str.sprintf(titlePattern,messaging.outOfFocusUnreadMessageCounter),});}
_notifyThreadViewsMessageReceived(message){for(const thread of message.threads){for(const threadView of thread.threadViews){threadView.addComponentHint('message-received',{message});}}}}
MessagingNotificationHandler.fields={messaging:one2one('mail.messaging',{inverse:'notificationHandler',}),};MessagingNotificationHandler.modelName='mail.messaging_notification_handler';return MessagingNotificationHandler;}
registerNewModel('mail.messaging_notification_handler',factory);});;

/* /mail/static/src/models/model/model.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/Model',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{RecordDeletedError}=require('mail/static/src/model/model_errors.js');function factory(){class Model{constructor({valid=false}={}){if(!valid){throw new Error("Record must always be instantiated from static method 'create()'");}}
_willCreate(){}
_created(){}
_willDelete(){}
static all(filterFunc){return this.env.modelManager.all(this,filterFunc);}
static create(data){return this.env.modelManager.create(this,data);}
static find(findFunc){return this.env.modelManager.find(this,findFunc);}
static findFromIdentifyingData(data){return this.env.modelManager.findFromIdentifyingData(this,data);}
static get(localId,{isCheckingInheritance}={}){return this.env.modelManager.get(this,localId,{isCheckingInheritance});}
static insert(data){return this.env.modelManager.insert(this,data);}
async async(func){return new Promise((resolve,reject)=>{Promise.resolve(func()).then(result=>{if(this.exists()){resolve(result);}else{reject(new RecordDeletedError(this.localId));}}).catch(error=>{if(this.exists()){reject(error);}else{reject(new RecordDeletedError(this.localId));}});});}
delete(){this.env.modelManager.delete(this);}
exists(){return this.env.modelManager.exists(this.constructor,this);}
update(data={}){this.env.modelManager.update(this,data);}
static _createRecordLocalId(data){return _.uniqueId(`${this.modelName}_`);}
_updateAfter(previous){}
_updateBefore(){return{};}}
Model.fields={};Model.modelName='mail.model';return Model;}
registerNewModel('mail.model',factory);});;

/* /mail/static/src/models/notification/notification.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/notification/notification.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Notification extends dependencies['mail.model']{static convertData(data){const data2={};if('failure_type'in data){data2.failure_type=data.failure_type;}
if('id'in data){data2.id=data.id;}
if('notification_status'in data){data2.notification_status=data.notification_status;}
if('notification_type'in data){data2.notification_type=data.notification_type;}
if('res_partner_id'in data){if(!data.res_partner_id){data2.partner=[['unlink-all']];}else{data2.partner=[['insert',{display_name:data.res_partner_id[1],id:data.res_partner_id[0],}],];}}
return data2;}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}}
Notification.fields={failure_type:attr(),id:attr(),message:many2one('mail.message',{inverse:'notifications',}),notification_status:attr(),notification_type:attr(),partner:many2one('mail.partner'),};Notification.modelName='mail.notification';return Notification;}
registerNewModel('mail.notification',factory);});;

/* /mail/static/src/models/notification_group/notification_group.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/notification_group/notification_group.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one,one2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class NotificationGroup extends dependencies['mail.model']{openCancelAction(){if(this.notification_type!=='email'){return;}
this.env.bus.trigger('do-action',{action:'mail.mail_resend_cancel_action',options:{additional_context:{default_model:this.res_model,unread_counter:this.notifications.length,},},});}
openDocuments(){if(this.thread){this.thread.open();}else{this._openDocuments();}}
_computeThread(){const notificationsThreadIds=this.notifications.filter(notification=>notification.message&&notification.message.originThread).map(notification=>notification.message.originThread.id);const threadIds=new Set(notificationsThreadIds);if(threadIds.size!==1){return[['unlink']];}
return[['insert',{id:notificationsThreadIds[0],model:this.res_model,}]];}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeDate(){const dates=this.notifications.filter(notification=>notification.message&&notification.message.date).map(notification=>notification.message.date);if(dates.length===0){return[['clear']];}
return moment.max(dates);}
_computeSequence(){return-Math.max(...this.notifications.map(notification=>notification.message.id));}
_openDocuments(){if(this.notification_type!=='email'){return;}
this.env.bus.trigger('do-action',{action:{name:this.env._t("Mail Failures"),type:'ir.actions.act_window',view_mode:'kanban,list,form',views:[[false,'kanban'],[false,'list'],[false,'form']],target:'current',res_model:this.res_model,domain:[['message_has_error','=',true]],},});if(this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}}}
NotificationGroup.fields={date:attr({compute:'_computeDate',dependencies:['notifications','notificationsMessage','notificationsMessageDate',],}),id:attr(),notification_type:attr(),notifications:one2many('mail.notification'),notificationsMessage:one2many('mail.message',{related:'notifications.message',}),notificationsMessageDate:attr({related:'notificationsMessage.date',}),notificationsMessageOriginThread:one2many('mail.thread',{related:'notificationsMessage.originThread',}),res_model:attr(),res_model_name:attr(),sequence:attr({compute:'_computeSequence',default:0,dependencies:['notifications','notificationsMessage',],}),thread:many2one('mail.thread',{compute:'_computeThread',dependencies:['res_model','notifications','notificationsMessage','notificationsMessageOriginThread',],})};NotificationGroup.modelName='mail.notification_group';return NotificationGroup;}
registerNewModel('mail.notification_group',factory);});;

/* /mail/static/src/models/notification_group_manager/notification_group_manager.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/notification_group_manager/notification_group_manager.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{one2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class NotificationGroupManager extends dependencies['mail.model']{computeGroups(){for(const group of this.groups){group.delete();}
const groups=[];this.env.messaging.currentPartner.failureNotifications.forEach(notification=>{const thread=notification.message.originThread;const channelId=thread.model==='mail.channel'?thread.id:null;const id=`${thread.model}/${channelId}/${notification.notification_type}`;const group=this.env.models['mail.notification_group'].insert({id,notification_type:notification.notification_type,res_model:thread.model,res_model_name:thread.model_name,});group.update({notifications:[['link',notification]]});if(!groups.includes(group)){groups.push(group);}});this.update({groups:[['link',groups]]});}}
NotificationGroupManager.fields={groups:one2many('mail.notification_group'),};NotificationGroupManager.modelName='mail.notification_group_manager';return NotificationGroupManager;}
registerNewModel('mail.notification_group_manager',factory);});;

/* /mail/static/src/models/partner/partner.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/partner/partner.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2many,one2one}=require('mail/static/src/model/model_field.js');const{cleanSearchTerm}=require('mail/static/src/utils/utils.js');function factory(dependencies){class Partner extends dependencies['mail.model']{static convertData(data){const data2={};if('active'in data){data2.active=data.active;}
if('country'in data){if(!data.country){data2.country=[['unlink-all']];}else{data2.country=[['insert',{id:data.country[0],name:data.country[1],}]];}}
if('display_name'in data){data2.display_name=data.display_name;}
if('email'in data){data2.email=data.email;}
if('id'in data){data2.id=data.id;}
if('im_status'in data){data2.im_status=data.im_status;}
if('name'in data){data2.name=data.name;}
if('user_id'in data){if(!data.user_id){data2.user=[['unlink-all']];}else{let user={};if(Array.isArray(data.user_id)){user={id:data.user_id[0],display_name:data.user_id[1],};}else{user={id:data.user_id,};}
user.isInternalUser=data.is_internal_user;data2.user=[['insert',user]];}}
return data2;}
static async fetchSuggestions(searchTerm,{thread}={}){const kwargs={search:searchTerm};const isNonPublicChannel=thread&&thread.model==='mail.channel'&&thread.public!=='public';if(isNonPublicChannel){kwargs.channel_id=thread.id;}
const[mainSuggestedPartners,extraSuggestedPartners,]=await this.env.services.rpc({model:'res.partner',method:'get_mention_suggestions',kwargs,},{shadow:true},);const partnersData=mainSuggestedPartners.concat(extraSuggestedPartners);const partners=this.env.models['mail.partner'].insert(partnersData.map(data=>this.env.models['mail.partner'].convertData(data)));if(isNonPublicChannel){thread.update({members:[['link',partners]]});}}
static async imSearch({callback,keyword,limit=10}){let partners=[];const cleanedSearchTerm=cleanSearchTerm(keyword);const currentPartner=this.env.messaging.currentPartner;for(const partner of this.all(partner=>partner.active)){if(partners.length<limit){if(partner!==currentPartner&&partner.name&&partner.user&&cleanSearchTerm(partner.name).includes(cleanedSearchTerm)){partners.push(partner);}}}
if(!partners.length){const partnersData=await this.env.services.rpc({model:'res.partner',method:'im_search',args:[keyword,limit]},{shadow:true});const newPartners=this.insert(partnersData.map(partnerData=>this.convertData(partnerData)));partners.push(...newPartners);}
callback(partners);}
static searchSuggestions(searchTerm,{thread}={}){let partners;const isNonPublicChannel=thread&&thread.model==='mail.channel'&&thread.public!=='public';if(isNonPublicChannel){partners=thread.members;}else{partners=this.env.models['mail.partner'].all();}
const cleanedSearchTerm=cleanSearchTerm(searchTerm);const mainSuggestionList=[];const extraSuggestionList=[];for(const partner of partners){if((!partner.active&&partner!==this.env.messaging.partnerRoot)||partner.id<=0||this.env.messaging.publicPartners.includes(partner)){continue;}
if((partner.nameOrDisplayName&&cleanSearchTerm(partner.nameOrDisplayName).includes(cleanedSearchTerm))||(partner.email&&cleanSearchTerm(partner.email).includes(cleanedSearchTerm))){if(partner.user){mainSuggestionList.push(partner);}else{extraSuggestionList.push(partner);}}}
return[mainSuggestionList,extraSuggestionList];}
static async startLoopFetchImStatus(){await this._fetchImStatus();this._loopFetchImStatus();}
async checkIsUser(){const userIds=await this.async(()=>this.env.services.rpc({model:'res.users',method:'search',args:[[['partner_id','=',this.id]]],kwargs:{context:{active_test:false},},},{shadow:true}));this.update({hasCheckedUser:true});if(userIds.length>0){this.update({user:[['insert',{id:userIds[0]}]]});}}
async getChat(){if(!this.user&&!this.hasCheckedUser){await this.async(()=>this.checkIsUser());}
if(!this.user){this.env.services['notification'].notify({message:this.env._t("You can only chat with partners that have a dedicated user."),type:'info',});return;}
return this.user.getChat();}
getMentionText(){return this.name;}
static getSuggestionSortFunction(searchTerm,{thread}={}){const cleanedSearchTerm=cleanSearchTerm(searchTerm);return(a,b)=>{const isAInternalUser=a.user&&a.user.isInternalUser;const isBInternalUser=b.user&&b.user.isInternalUser;if(isAInternalUser&&!isBInternalUser){return-1;}
if(!isAInternalUser&&isBInternalUser){return 1;}
if(thread&&thread.model==='mail.channel'){const isAMember=thread.members.includes(a);const isBMember=thread.members.includes(b);if(isAMember&&!isBMember){return-1;}
if(!isAMember&&isBMember){return 1;}}
if(thread){const isAFollower=thread.followersPartner.includes(a);const isBFollower=thread.followersPartner.includes(b);if(isAFollower&&!isBFollower){return-1;}
if(!isAFollower&&isBFollower){return 1;}}
const cleanedAName=cleanSearchTerm(a.nameOrDisplayName||'');const cleanedBName=cleanSearchTerm(b.nameOrDisplayName||'');if(cleanedAName.startsWith(cleanedSearchTerm)&&!cleanedBName.startsWith(cleanedSearchTerm)){return-1;}
if(!cleanedAName.startsWith(cleanedSearchTerm)&&cleanedBName.startsWith(cleanedSearchTerm)){return 1;}
if(cleanedAName<cleanedBName){return-1;}
if(cleanedAName>cleanedBName){return 1;}
const cleanedAEmail=cleanSearchTerm(a.email||'');const cleanedBEmail=cleanSearchTerm(b.email||'');if(cleanedAEmail.startsWith(cleanedSearchTerm)&&!cleanedAEmail.startsWith(cleanedSearchTerm)){return-1;}
if(!cleanedBEmail.startsWith(cleanedSearchTerm)&&cleanedBEmail.startsWith(cleanedSearchTerm)){return 1;}
if(cleanedAEmail<cleanedBEmail){return-1;}
if(cleanedAEmail>cleanedBEmail){return 1;}
return a.id-b.id;};}
async openChat(options){const chat=await this.async(()=>this.getChat());if(!chat){return;}
await this.async(()=>chat.open(options));return chat;}
async openProfile(){return this.env.messaging.openDocument({id:this.id,model:'res.partner',});}
_computeAvatarUrl(){return`/web/image/res.partner/${this.id}/image_128`;}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
static async _fetchImStatus(){const partnerIds=[];for(const partner of this.all()){if(partner.im_status!=='im_partner'&&partner.id>0){partnerIds.push(partner.id);}}
if(partnerIds.length===0){return;}
const dataList=await this.env.services.rpc({route:'/longpolling/im_status',params:{partner_ids:partnerIds,},},{shadow:true});this.insert(dataList);}
static _loopFetchImStatus(){setTimeout(async()=>{await this._fetchImStatus();this._loopFetchImStatus();},50*1000);}
_computeDisplayName(){return this.display_name||this.user&&this.user.display_name;}
_computeMessaging(){return[['link',this.env.messaging]];}
_computeNameOrDisplayName(){return this.name||this.display_name;}}
Partner.fields={active:attr({default:true,}),avatarUrl:attr({compute:'_computeAvatarUrl',dependencies:['id',],}),correspondentThreads:one2many('mail.thread',{inverse:'correspondent',}),country:many2one('mail.country'),display_name:attr({compute:'_computeDisplayName',default:"",dependencies:['display_name','userDisplayName',],}),email:attr(),failureNotifications:one2many('mail.notification',{related:'messagesAsAuthor.failureNotifications',}),hasCheckedUser:attr({default:false,}),id:attr(),im_status:attr(),memberThreads:many2many('mail.thread',{inverse:'members',}),messagesAsAuthor:one2many('mail.message',{inverse:'author',}),messaging:many2one('mail.messaging',{compute:'_computeMessaging',}),model:attr({default:'res.partner',}),moderatedChannels:many2many('mail.thread',{inverse:'moderators',}),name:attr(),nameOrDisplayName:attr({compute:'_computeNameOrDisplayName',dependencies:['display_name','name',],}),user:one2one('mail.user',{inverse:'partner',}),userDisplayName:attr({related:'user.display_name',}),};Partner.modelName='mail.partner';return Partner;}
registerNewModel('mail.partner',factory);});;

/* /mail/static/src/models/suggested_recipient_info/suggested_recipient_info.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/suggested_recipient_info/suggested_recipient_info.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class SuggestedRecipientInfo extends dependencies['mail.model']{_computeEmail(){return this.partner&&this.partner.email||this.email;}
_computeIsSelected(){return this.partner?this.isSelected:false;}
_computeName(){return this.partner&&this.partner.nameOrDisplayName||this.name;}}
SuggestedRecipientInfo.fields={email:attr({compute:'_computeEmail',dependencies:['email','partnerEmail',],}),isSelected:attr({compute:'_computeIsSelected',default:true,dependencies:['isSelected','partner',],}),name:attr({compute:'_computeName',dependencies:['name','partnerNameOrDisplayName',],}),partner:many2one('mail.partner'),partnerEmail:attr({related:'partner.email'}),partnerNameOrDisplayName:attr({related:'partner.nameOrDisplayName'}),reason:attr(),thread:many2one('mail.thread',{inverse:'suggestedRecipientInfoList',}),};SuggestedRecipientInfo.modelName='mail.suggested_recipient_info';return SuggestedRecipientInfo;}
registerNewModel('mail.suggested_recipient_info',factory);});;

/* /mail/static/src/models/thread/thread.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/thread/thread.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2many,one2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');const throttle=require('mail/static/src/utils/throttle/throttle.js');const Timer=require('mail/static/src/utils/timer/timer.js');const{cleanSearchTerm}=require('mail/static/src/utils/utils.js');const mailUtils=require('mail.utils');function factory(dependencies){class Thread extends dependencies['mail.model']{_willCreate(){const res=super._willCreate(...arguments);this._currentPartnerInactiveTypingTimer=new Timer(this.env,()=>this.async(()=>this._onCurrentPartnerInactiveTypingTimeout()),5*1000);this._currentPartnerLastNotifiedIsTyping=undefined;this._currentPartnerLongTypingTimer=new Timer(this.env,()=>this.async(()=>this._onCurrentPartnerLongTypingTimeout()),50*1000);this._forceNotifyNextCurrentPartnerTypingStatus=false;this._otherMembersLongTypingTimers=new Map();this._throttleNotifyCurrentPartnerTypingStatus=throttle(this.env,({isTyping})=>this.async(()=>this._notifyCurrentPartnerTypingStatus({isTyping})),2.5*1000);return res;}
_willDelete(){this._currentPartnerInactiveTypingTimer.clear();this._currentPartnerLongTypingTimer.clear();this._throttleNotifyCurrentPartnerTypingStatus.clear();for(const timer of this._otherMembersLongTypingTimers.values()){timer.clear();}
if(this.isTemporary){for(const message of this.messages){message.delete();}}
return super._willDelete(...arguments);}
static computeLastCurrentPartnerMessageSeenByEveryone(thread=undefined){const threads=thread?[thread]:this.env.models['mail.thread'].all();threads.map(localThread=>{localThread.update({lastCurrentPartnerMessageSeenByEveryone:localThread._computeLastCurrentPartnerMessageSeenByEveryone(),});});}
static convertData(data){const data2={messagesAsServerChannel:[],};if('model'in data){data2.model=data.model;}
if('channel_type'in data){data2.channel_type=data.channel_type;data2.model='mail.channel';}
if('create_uid'in data){data2.creator=[['insert',{id:data.create_uid}]];}
if('custom_channel_name'in data){data2.custom_channel_name=data.custom_channel_name;}
if('group_based_subscription'in data){data2.group_based_subscription=data.group_based_subscription;}
if('id'in data){data2.id=data.id;}
if('is_minimized'in data&&'state'in data){data2.serverFoldState=data.is_minimized?data.state:'closed';}
if('is_moderator'in data){data2.is_moderator=data.is_moderator;}
if('is_pinned'in data){data2.isServerPinned=data.is_pinned;}
if('last_message'in data&&data.last_message){data2.messagesAsServerChannel.push(['insert',{id:data.last_message.id}]);data2.serverLastMessageId=data.last_message.id;}
if('last_message_id'in data&&data.last_message_id){data2.messagesAsServerChannel.push(['insert',{id:data.last_message_id}]);data2.serverLastMessageId=data.last_message_id;}
if('mass_mailing'in data){data2.mass_mailing=data.mass_mailing;}
if('moderation'in data){data2.moderation=data.moderation;}
if('message_needaction_counter'in data){data2.message_needaction_counter=data.message_needaction_counter;}
if('message_unread_counter'in data){data2.serverMessageUnreadCounter=data.message_unread_counter;}
if('name'in data){data2.name=data.name;}
if('public'in data){data2.public=data.public;}
if('seen_message_id'in data){data2.lastSeenByCurrentPartnerMessageId=data.seen_message_id||0;}
if('uuid'in data){data2.uuid=data.uuid;}
if('members'in data){if(!data.members){data2.members=[['unlink-all']];}else{data2.members=[['insert-and-replace',data.members.map(memberData=>this.env.models['mail.partner'].convertData(memberData))],];}}
if('seen_partners_info'in data){if(!data.seen_partners_info){data2.partnerSeenInfos=[['unlink-all']];}else{data2.partnerSeenInfos=[['insert-and-replace',data.seen_partners_info.map(({fetched_message_id,partner_id,seen_message_id})=>{return{channelId:data2.id,lastFetchedMessage:[fetched_message_id?['insert',{id:fetched_message_id}]:['unlink-all']],lastSeenMessage:[seen_message_id?['insert',{id:seen_message_id}]:['unlink-all']],partnerId:partner_id,};})]];if(data.id||this.id){const messageIds=data.seen_partners_info.reduce((currentSet,{fetched_message_id,seen_message_id})=>{if(fetched_message_id){currentSet.add(fetched_message_id);}
if(seen_message_id){currentSet.add(seen_message_id);}
return currentSet;},new Set());if(messageIds.size>0){data2.messageSeenIndicators=[['insert',[...messageIds].map(messageId=>{return{channelId:data.id||this.id,messageId,};})]];}}}}
return data2;}
static async fetchSuggestions(searchTerm,{thread}={}){const channelsData=await this.env.services.rpc({model:'mail.channel',method:'get_mention_suggestions',kwargs:{search:searchTerm},},{shadow:true},);this.env.models['mail.thread'].insert(channelsData.map(channelData=>Object.assign({model:'mail.channel'},this.env.models['mail.thread'].convertData(channelData),)));}
static getSuggestionSortFunction(searchTerm,{thread}={}){const cleanedSearchTerm=cleanSearchTerm(searchTerm);return(a,b)=>{const isAPublic=a.model==='mail.channel'&&a.public==='public';const isBPublic=b.model==='mail.channel'&&b.public==='public';if(isAPublic&&!isBPublic){return-1;}
if(!isAPublic&&isBPublic){return 1;}
const isMemberOfA=a.model==='mail.channel'&&a.members.includes(this.env.messaging.currentPartner);const isMemberOfB=b.model==='mail.channel'&&b.members.includes(this.env.messaging.currentPartner);if(isMemberOfA&&!isMemberOfB){return-1;}
if(!isMemberOfA&&isMemberOfB){return 1;}
const cleanedAName=cleanSearchTerm(a.name||'');const cleanedBName=cleanSearchTerm(b.name||'');if(cleanedAName.startsWith(cleanedSearchTerm)&&!cleanedBName.startsWith(cleanedSearchTerm)){return-1;}
if(!cleanedAName.startsWith(cleanedSearchTerm)&&cleanedBName.startsWith(cleanedSearchTerm)){return 1;}
if(cleanedAName<cleanedBName){return-1;}
if(cleanedAName>cleanedBName){return 1;}
return a.id-b.id;};}
static async loadPreviews(threads){const channelIds=threads.reduce((list,thread)=>{if(thread.model==='mail.channel'){return list.concat(thread.id);}
return list;},[]);if(channelIds.length===0){return;}
const channelPreviews=await this.env.services.rpc({model:'mail.channel',method:'channel_fetch_preview',args:[channelIds],},{shadow:true});this.env.models['mail.message'].insert(channelPreviews.filter(p=>p.last_message).map(channelPreview=>this.env.models['mail.message'].convertData(channelPreview.last_message)));}
static async performRpcChannelFold(uuid,state){return this.env.services.rpc({model:'mail.channel',method:'channel_fold',kwargs:{state,uuid,}},{shadow:true});}
static async performRpcChannelInfo({ids}){const channelInfos=await this.env.services.rpc({model:'mail.channel',method:'channel_info',args:[ids],},{shadow:true});const channels=this.env.models['mail.thread'].insert(channelInfos.map(channelInfo=>this.env.models['mail.thread'].convertData(channelInfo)));this.env.messaging.messagingMenu.update();return channels;}
static async performRpcChannelSeen({ids,lastMessageId}){return this.env.services.rpc({model:'mail.channel',method:'channel_seen',args:[ids],kwargs:{last_message_id:lastMessageId,},},{shadow:true});}
static async performRpcChannelPin({pinned=false,uuid}){return this.env.services.rpc({model:'mail.channel',method:'channel_pin',kwargs:{uuid,pinned,},},{shadow:true});}
static async performRpcCreateChannel({name,privacy}){const device=this.env.messaging.device;const data=await this.env.services.rpc({model:'mail.channel',method:'channel_create',args:[name,privacy],kwargs:{context:Object.assign({},this.env.session.user_content,{isMobile:device.isMobile,}),},});return this.env.models['mail.thread'].insert(this.env.models['mail.thread'].convertData(data));}
static async performRpcCreateChat({partnerIds,pinForCurrentPartner}){const device=this.env.messaging.device;const data=await this.env.services.rpc({model:'mail.channel',method:'channel_get',kwargs:{context:Object.assign({},this.env.session.user_content,{isMobile:device.isMobile,}),partners_to:partnerIds,pin:pinForCurrentPartner,},});if(!data){return;}
return this.env.models['mail.thread'].insert(this.env.models['mail.thread'].convertData(data));}
static async performRpcJoinChannel({channelId}){const device=this.env.messaging.device;const data=await this.env.services.rpc({model:'mail.channel',method:'channel_join_and_get_info',args:[[channelId]],kwargs:{context:Object.assign({},this.env.session.user_content,{isMobile:device.isMobile,}),},});return this.env.models['mail.thread'].insert(this.env.models['mail.thread'].convertData(data));}
static async performRpcExecuteCommand({channelId,command,postData={}}){return this.env.services.rpc({model:'mail.channel',method:'execute_command',args:[[channelId]],kwargs:Object.assign({command},postData),});}
static async performRpcMessagePost({postData,threadId,threadModel}){return this.env.services.rpc({model:threadModel,method:'message_post',args:[threadId],kwargs:postData,});}
static async performRpcMailGetSuggestedRecipients({model,res_ids}){const data=await this.env.services.rpc({route:'/mail/get_suggested_recipients',params:{model,res_ids,},},{shadow:true});for(const id in data){const recipientInfoList=data[id].map(recipientInfoData=>{const[partner_id,emailInfo,reason]=recipientInfoData;const[name,email]=emailInfo&&mailUtils.parseEmail(emailInfo);return{email,name,partner:[partner_id?['insert',{id:partner_id}]:['unlink']],reason,};});this.insert({id:parseInt(id),model,suggestedRecipientInfoList:[['insert-and-replace',recipientInfoList]],});}}
static searchSuggestions(searchTerm,{thread}={}){let threads;if(thread&&thread.model==='mail.channel'&&thread.public!=='public'){threads=[thread];}else{threads=this.env.models['mail.thread'].all();}
const cleanedSearchTerm=cleanSearchTerm(searchTerm);return[threads.filter(thread=>!thread.isTemporary&&thread.model==='mail.channel'&&thread.channel_type==='channel'&&thread.name&&cleanSearchTerm(thread.name).includes(cleanedSearchTerm))];}
cache(stringifiedDomain='[]'){return this.env.models['mail.thread_cache'].insert({stringifiedDomain,thread:[['link',this]],});}
async fetchAttachments(){const attachmentsData=await this.async(()=>this.env.services.rpc({model:'ir.attachment',method:'search_read',domain:[['res_id','=',this.id],['res_model','=',this.model],],fields:['id','name','mimetype'],orderBy:[{name:'id',asc:false}],},{shadow:true}));this.update({originThreadAttachments:[['insert-and-replace',attachmentsData.map(data=>this.env.models['mail.attachment'].convertData(data))]],});this.update({areAttachmentsLoaded:true});}
async fetchAndUpdateSuggestedRecipients(){if(this.isTemporary){return;}
return this.env.models['mail.thread'].performRpcMailGetSuggestedRecipients({model:this.model,res_ids:[this.id],});}
async follow(){await this.async(()=>this.env.services.rpc({model:this.model,method:'message_subscribe',args:[[this.id]],kwargs:{partner_ids:[this.env.messaging.currentPartner.id],context:{},},}));this.refreshFollowers();this.fetchAndUpdateSuggestedRecipients();}
getMemberName(partner){return partner.nameOrDisplayName;}
getMentionText(){return this.name;}
loadNewMessages(){this.mainCache.loadNewMessages();}
async markAsFetched(){await this.async(()=>this.env.services.rpc({model:'mail.channel',method:'channel_fetched',args:[[this.id]],},{shadow:true}));}
async markAsSeen(message){if(this.model!=='mail.channel'){return;}
if(this.pendingSeenMessageId&&message.id<=this.pendingSeenMessageId){return;}
if(this.lastSeenByCurrentPartnerMessageId&&message.id<=this.lastSeenByCurrentPartnerMessageId){return;}
this.update({pendingSeenMessageId:message.id});return this.env.models['mail.thread'].performRpcChannelSeen({ids:[this.id],lastMessageId:message.id,});}
async markNeedactionMessagesAsOriginThreadAsRead(){await this.async(()=>this.env.models['mail.message'].markAsRead(this.needactionMessagesAsOriginThread));}
async markNeedactionMessagesAsRead(){await this.async(()=>this.env.models['mail.message'].markAsRead(this.needactionMessages));}
async notifyFoldStateToServer(state){if(this.model!=='mail.channel'){return;}
if(!this.uuid){return;}
return this.env.models['mail.thread'].performRpcChannelFold(this.uuid,state);}
async notifyPinStateToServer(){if(this.isPendingPinned){await this.env.models['mail.thread'].performRpcChannelPin({pinned:true,uuid:this.uuid,});}else{this.env.models['mail.thread'].performRpcExecuteCommand({channelId:this.id,command:'leave',});}}
async open({expanded=false}={}){const discuss=this.env.messaging.discuss;if(!['mail.box','mail.channel'].includes(this.model)){if(expanded||discuss.isOpen){this.env.messaging.chatWindowManager.closeThread(this);return this.env.messaging.openDocument({id:this.id,model:this.model,});}}
const device=this.env.messaging.device;if((!device.isMobile&&(discuss.isOpen||expanded))||this.model==='mail.box'){return discuss.openThread(this);}
return this.env.messaging.chatWindowManager.openThread(this,{makeActive:true,});}
async openProfile(){return this.env.messaging.openDocument({id:this.id,model:this.model,});}
async pin(){this.update({isPendingPinned:true});await this.notifyPinStateToServer();}
promptAddChannelFollower(){this._promptAddFollower({mail_invite_follower_channel_only:true});}
promptAddPartnerFollower(){this._promptAddFollower({mail_invite_follower_channel_only:false});}
async refresh(){if(this.isTemporary){return;}
this.loadNewMessages();this.update({isLoadingAttachments:true});await this.async(()=>this.fetchAttachments());this.update({isLoadingAttachments:false});}
async refreshActivities(){if(!this.hasActivities){return;}
if(this.isTemporary){return;}
const[{activity_ids:newActivityIds}]=await this.async(()=>this.env.services.rpc({model:this.model,method:'read',args:[this.id,['activity_ids']]},{shadow:true}));const activitiesData=await this.async(()=>this.env.services.rpc({model:'mail.activity',method:'activity_format',args:[newActivityIds]},{shadow:true}));const activities=this.env.models['mail.activity'].insert(activitiesData.map(activityData=>this.env.models['mail.activity'].convertData(activityData)));this.update({activities:[['replace',activities]]});}
async refreshFollowers(){if(this.isTemporary){this.update({followers:[['unlink-all']]});return;}
const{followers}=await this.async(()=>this.env.services.rpc({route:'/mail/read_followers',params:{res_id:this.id,res_model:this.model,},},{shadow:true}));this.update({areFollowersLoaded:true});if(followers.length>0){this.update({followers:[['insert-and-replace',followers.map(data=>this.env.models['mail.follower'].convertData(data))]],});}else{this.update({followers:[['unlink-all']],});}}
refreshCurrentPartnerIsTyping(){this._currentPartnerInactiveTypingTimer.reset();}
refreshOtherMemberTypingMember(partner){this._otherMembersLongTypingTimers.get(partner).reset();}
async registerCurrentPartnerIsTyping(){this._currentPartnerInactiveTypingTimer.start();this._currentPartnerLongTypingTimer.start();const currentPartner=this.env.messaging.currentPartner;const newOrderedTypingMemberLocalIds=this.orderedTypingMemberLocalIds.filter(localId=>localId!==currentPartner.localId);newOrderedTypingMemberLocalIds.push(currentPartner.localId);this.update({orderedTypingMemberLocalIds:newOrderedTypingMemberLocalIds,typingMembers:[['link',currentPartner]],});await this._throttleNotifyCurrentPartnerTypingStatus({isTyping:true});}
registerOtherMemberTypingMember(partner){const timer=new Timer(this.env,()=>this.async(()=>this._onOtherMemberLongTypingTimeout(partner)),60*1000);this._otherMembersLongTypingTimers.set(partner,timer);timer.start();const newOrderedTypingMemberLocalIds=this.orderedTypingMemberLocalIds.filter(localId=>localId!==partner.localId);newOrderedTypingMemberLocalIds.push(partner.localId);this.update({orderedTypingMemberLocalIds:newOrderedTypingMemberLocalIds,typingMembers:[['link',partner]],});}
async rename(newName){if(this.channel_type==='chat'){await this.async(()=>this.env.services.rpc({model:'mail.channel',method:'channel_set_custom_name',args:[this.id],kwargs:{name:newName,},}));}
this.update({custom_channel_name:newName});}
async unfollow(){const currentPartnerFollower=this.followers.find(follower=>follower.partner===this.env.messaging.currentPartner);await this.async(()=>currentPartnerFollower.remove());}
async unpin(){this.update({isPendingPinned:false});await this.notifyPinStateToServer();}
async unregisterCurrentPartnerIsTyping({immediateNotify=false}={}){this._currentPartnerInactiveTypingTimer.clear();this._currentPartnerLongTypingTimer.clear();const currentPartner=this.env.messaging.currentPartner;const newOrderedTypingMemberLocalIds=this.orderedTypingMemberLocalIds.filter(localId=>localId!==currentPartner.localId);this.update({orderedTypingMemberLocalIds:newOrderedTypingMemberLocalIds,typingMembers:[['unlink',currentPartner]],});if(immediateNotify){this._throttleNotifyCurrentPartnerTypingStatus.clear();}
await this.async(()=>this._throttleNotifyCurrentPartnerTypingStatus({isTyping:false}));}
unregisterOtherMemberTypingMember(partner){this._otherMembersLongTypingTimers.get(partner).clear();this._otherMembersLongTypingTimers.delete(partner);const newOrderedTypingMemberLocalIds=this.orderedTypingMemberLocalIds.filter(localId=>localId!==partner.localId);this.update({orderedTypingMemberLocalIds:newOrderedTypingMemberLocalIds,typingMembers:[['unlink',partner]],});}
unsubscribe(){this.env.messaging.chatWindowManager.closeThread(this);this.unpin();}
static _createRecordLocalId(data){const{channel_type,id,model}=data;let threadModel=model;if(!threadModel&&channel_type){threadModel='mail.channel';}
return`${this.modelName}_${threadModel}_${id}`;}
_computeAllAttachments(){const allAttachments=[...new Set(this.originThreadAttachments.concat(this.attachments))].sort((a1,a2)=>{if(!a1.isTemporary&&a2.isTemporary){return 1;}
if(a1.isTemporary&&!a2.isTemporary){return-1;}
return Math.abs(a2.id)-Math.abs(a1.id);});return[['replace',allAttachments]];}
_computeCorrespondent(){if(this.channel_type==='channel'){return[['unlink']];}
const correspondents=this.members.filter(partner=>partner!==this.env.messaging.currentPartner);if(correspondents.length===1){return[['link',correspondents[0]]];}
if(this.members.length===1){return[['link',this.members[0]]];}
return[['unlink']];}
_computeDisplayName(){if(this.channel_type==='chat'&&this.correspondent){return this.custom_channel_name||this.correspondent.nameOrDisplayName;}
return this.name;}
_computeFutureActivities(){return[['replace',this.activities.filter(activity=>activity.state==='planned')]];}
_computeHasSeenIndicators(){if(this.model!=='mail.channel'){return false;}
if(this.mass_mailing){return false;}
return['chat','livechat'].includes(this.channel_type);}
_computeIsChatChannel(){return this.channel_type==='chat';}
_computeIsCurrentPartnerFollowing(){return this.followers.some(follower=>follower.partner&&follower.partner===this.env.messaging.currentPartner);}
_computeIsModeratedByCurrentPartner(){if(!this.messaging){return false;}
if(!this.messaging.currentPartner){return false;}
return this.moderators.includes(this.env.messaging.currentPartner);}
_computeIsPinned(){return this.isPendingPinned!==undefined?this.isPendingPinned:this.isServerPinned;}
_computeLastCurrentPartnerMessageSeenByEveryone(){const otherPartnerSeenInfos=this.partnerSeenInfos.filter(partnerSeenInfo=>partnerSeenInfo.partner!==this.messagingCurrentPartner);if(otherPartnerSeenInfos.length===0){return[['unlink-all']];}
const otherPartnersLastSeenMessageIds=otherPartnerSeenInfos.map(partnerSeenInfo=>partnerSeenInfo.lastSeenMessage?partnerSeenInfo.lastSeenMessage.id:0);if(otherPartnersLastSeenMessageIds.length===0){return[['unlink-all']];}
const lastMessageSeenByAllId=Math.min(...otherPartnersLastSeenMessageIds);const currentPartnerOrderedSeenMessages=this.orderedNonTransientMessages.filter(message=>message.author===this.messagingCurrentPartner&&message.id<=lastMessageSeenByAllId);if(!currentPartnerOrderedSeenMessages||currentPartnerOrderedSeenMessages.length===0){return[['unlink-all']];}
return[['link',currentPartnerOrderedSeenMessages.slice().pop()]];}
_computeLastMessage(){const{length:l,[l-1]:lastMessage,}=this.orderedMessages;if(lastMessage){return[['link',lastMessage]];}
return[['unlink']];}
_computeLastNonTransientMessage(){const{length:l,[l-1]:lastMessage,}=this.orderedNonTransientMessages;if(lastMessage){return[['link',lastMessage]];}
return[['unlink']];}
_computeLastSeenByCurrentPartnerMessageId(){const firstMessage=this.orderedMessages[0];if(firstMessage&&this.lastSeenByCurrentPartnerMessageId&&this.lastSeenByCurrentPartnerMessageId<firstMessage.id){return this.lastSeenByCurrentPartnerMessageId;}
let lastSeenByCurrentPartnerMessageId=this.lastSeenByCurrentPartnerMessageId;for(const message of this.orderedMessages){if(message.id<=this.lastSeenByCurrentPartnerMessageId){continue;}
if(message.author===this.env.messaging.currentPartner||message.isTransient){lastSeenByCurrentPartnerMessageId=message.id;continue;}
return lastSeenByCurrentPartnerMessageId;}
return lastSeenByCurrentPartnerMessageId;}
_computeLastNeedactionMessage(){const orderedNeedactionMessages=this.needactionMessages.sort((m1,m2)=>m1.id<m2.id?-1:1);const{length:l,[l-1]:lastNeedactionMessage,}=orderedNeedactionMessages;if(lastNeedactionMessage){return[['link',lastNeedactionMessage]];}
return[['unlink']];}
_computeLastNeedactionMessageAsOriginThread(){const orderedNeedactionMessagesAsOriginThread=this.needactionMessagesAsOriginThread.sort((m1,m2)=>m1.id<m2.id?-1:1);const{length:l,[l-1]:lastNeedactionMessageAsOriginThread,}=orderedNeedactionMessagesAsOriginThread;if(lastNeedactionMessageAsOriginThread){return[['link',lastNeedactionMessageAsOriginThread]];}
return[['unlink']];}
_computeMainCache(){return[['link',this.cache()]];}
_computeLocalMessageUnreadCounter(){if(this.model!=='mail.channel'){return clear();}
let baseCounter=this.serverMessageUnreadCounter;let countFromId=this.serverLastMessageId;const firstMessage=this.orderedMessages[0];if(firstMessage&&this.lastSeenByCurrentPartnerMessageId&&this.lastSeenByCurrentPartnerMessageId>=firstMessage.id){baseCounter=0;countFromId=this.lastSeenByCurrentPartnerMessageId;}
return this.orderedMessages.reduce((total,message)=>{if(message.id<=countFromId){return total;}
return total+1;},baseCounter);}
_computeMessaging(){return[['link',this.env.messaging]];}
_computeNeedactionMessages(){return[['replace',this.messages.filter(message=>message.isNeedaction)]];}
_computeNeedactionMessagesAsOriginThread(){return[['replace',this.messagesAsOriginThread.filter(message=>message.isNeedaction)]];}
_computeMessageAfterNewMessageSeparator(){if(this.model!=='mail.channel'){return[['unlink']];}
if(this.localMessageUnreadCounter===0){return[['unlink']];}
const index=this.orderedMessages.findIndex(message=>message.id===this.lastSeenByCurrentPartnerMessageId);if(index===-1){return[['unlink']];}
const message=this.orderedMessages[index+1];if(!message){return[['unlink']];}
return[['link',message]];}
_computeOrderedMessages(){return[['replace',this.messages.sort((m1,m2)=>m1.id<m2.id?-1:1)]];}
_computeOrderedNonTransientMessages(){return[['replace',this.orderedMessages.filter(m=>!m.isTransient)]];}
_computeOrderedOtherTypingMembers(){return[['replace',this.orderedTypingMembers.filter(member=>member!==this.env.messaging.currentPartner),]];}
_computeOrderedTypingMembers(){return[['replace',this.orderedTypingMemberLocalIds.map(localId=>this.env.models['mail.partner'].get(localId)).filter(member=>!!member),]];}
_computeOverdueActivities(){return[['replace',this.activities.filter(activity=>activity.state==='overdue')]];}
_computeTodayActivities(){return[['replace',this.activities.filter(activity=>activity.state==='today')]];}
_computeTypingStatusText(){if(this.orderedOtherTypingMembers.length===0){return this.constructor.fields.typingStatusText.default;}
if(this.orderedOtherTypingMembers.length===1){return _.str.sprintf(this.env._t("%s is typing..."),this.getMemberName(this.orderedOtherTypingMembers[0]));}
if(this.orderedOtherTypingMembers.length===2){return _.str.sprintf(this.env._t("%s and %s are typing..."),this.getMemberName(this.orderedOtherTypingMembers[0]),this.getMemberName(this.orderedOtherTypingMembers[1]));}
return _.str.sprintf(this.env._t("%s, %s and more are typing..."),this.getMemberName(this.orderedOtherTypingMembers[0]),this.getMemberName(this.orderedOtherTypingMembers[1]));}
_computeUrl(){const baseHref=this.env.session.url('/web');if(this.model==='mail.channel'){return`${baseHref}#action=mail.action_discuss&active_id=${this.model}_${this.id}`;}
return`${baseHref}#model=${this.model}&id=${this.id}`;}
async _notifyCurrentPartnerTypingStatus({isTyping}){if(this._forceNotifyNextCurrentPartnerTypingStatus||isTyping!==this._currentPartnerLastNotifiedIsTyping){if(this.model==='mail.channel'){await this.async(()=>this.env.services.rpc({model:'mail.channel',method:'notify_typing',args:[this.id],kwargs:{is_typing:isTyping},},{shadow:true}));}
if(isTyping&&this._currentPartnerLongTypingTimer.isRunning){this._currentPartnerLongTypingTimer.reset();}}
this._forceNotifyNextCurrentPartnerTypingStatus=false;this._currentPartnerLastNotifiedIsTyping=isTyping;}
_onChangeFollowersPartner(){if(this.channel_type!=='chat'){return;}
for(const follower of this.followers){if(follower.partner){follower.remove();}}}
_onChangeLastSeenByCurrentPartnerMessageId(){this.env.messagingBus.trigger('o-thread-last-seen-by-current-partner-message-id-changed',{thread:this,});}
_onChangeThreadViews(){if(this.threadViews.length===0){return;}
if(this.channel_type==='chat'&&!this.areFollowersLoaded){this.refreshFollowers();}}
_onIsServerPinnedChanged(){if(this.isServerPinned===this.isPendingPinned){this.update({isPendingPinned:clear()});}}
_onServerFoldStateChanged(){if(!this.env.messaging.chatWindowManager){return;}
if(this.env.messaging.device.isMobile){return;}
if(this.serverFoldState==='closed'){this.env.messaging.chatWindowManager.closeThread(this,{notifyServer:false,});}else{this.env.messaging.chatWindowManager.openThread(this,{isFolded:this.serverFoldState==='folded',notifyServer:false,});}}
_promptAddFollower({mail_invite_follower_channel_only=false}={}){const self=this;const action={type:'ir.actions.act_window',res_model:'mail.wizard.invite',view_mode:'form',views:[[false,'form']],name:this.env._t("Invite Follower"),target:'new',context:{default_res_model:this.model,default_res_id:this.id,mail_invite_follower_channel_only,},};this.env.bus.trigger('do-action',{action,options:{on_close:async()=>{await this.async(()=>this.refreshFollowers());this.env.bus.trigger('mail.thread:promptAddFollower-closed');},},});}
async _onCurrentPartnerInactiveTypingTimeout(){await this.async(()=>this.unregisterCurrentPartnerIsTyping());}
async _onCurrentPartnerLongTypingTimeout(){this._forceNotifyNextCurrentPartnerTypingStatus=true;this._throttleNotifyCurrentPartnerTypingStatus.clear();await this.async(()=>this._throttleNotifyCurrentPartnerTypingStatus({isTyping:true}));}
async _onOtherMemberLongTypingTimeout(partner){if(!this.typingMembers.includes(partner)){this._otherMembersLongTypingTimers.delete(partner);return;}
this.unregisterOtherMemberTypingMember(partner);}}
Thread.fields={activities:one2many('mail.activity',{inverse:'thread',}),activitiesState:attr({related:'activities.state',}),allAttachments:many2many('mail.attachment',{compute:'_computeAllAttachments',dependencies:['attachments','originThreadAttachments',],}),areAttachmentsLoaded:attr({default:false,}),areFollowersLoaded:attr({default:false,}),attachments:many2many('mail.attachment',{inverse:'threads',}),caches:one2many('mail.thread_cache',{inverse:'thread',isCausal:true,}),channel_type:attr(),chatWindow:one2one('mail.chat_window',{inverse:'thread',}),chatWindowIsFolded:attr({related:'chatWindow.isFolded',}),composer:one2one('mail.composer',{default:[['create']],inverse:'thread',isCausal:true,}),correspondent:many2one('mail.partner',{compute:'_computeCorrespondent',dependencies:['channel_type','members','messagingCurrentPartner',],inverse:'correspondentThreads',}),correspondentNameOrDisplayName:attr({related:'correspondent.nameOrDisplayName',}),counter:attr({default:0,}),creator:many2one('mail.user'),custom_channel_name:attr(),displayName:attr({compute:'_computeDisplayName',dependencies:['channel_type','correspondent','correspondentNameOrDisplayName','custom_channel_name','name',],}),followersPartner:many2many('mail.partner',{related:'followers.partner',}),followers:one2many('mail.follower',{inverse:'followedThread',}),futureActivities:one2many('mail.activity',{compute:'_computeFutureActivities',dependencies:['activitiesState'],}),group_based_subscription:attr({default:false,}),hasActivities:attr({default:false,}),hasSeenIndicators:attr({compute:'_computeHasSeenIndicators',default:false,dependencies:['channel_type','mass_mailing','model',],}),id:attr(),isChatChannel:attr({compute:'_computeIsChatChannel',dependencies:['channel_type',],default:false,}),isCurrentPartnerFollowing:attr({compute:'_computeIsCurrentPartnerFollowing',default:false,dependencies:['followersPartner','messagingCurrentPartner',],}),isLoadingAttachments:attr({default:false,}),isModeratedByCurrentPartner:attr({compute:'_computeIsModeratedByCurrentPartner',dependencies:['messagingCurrentPartner','moderators',],}),isPendingPinned:attr(),isPinned:attr({compute:'_computeIsPinned',dependencies:['isPendingPinned','isServerPinned',],}),isServerPinned:attr({default:false,}),isTemporary:attr({default:false,}),is_moderator:attr({default:false,}),lastCurrentPartnerMessageSeenByEveryone:many2one('mail.message',{compute:'_computeLastCurrentPartnerMessageSeenByEveryone',dependencies:['messagingCurrentPartner','orderedNonTransientMessages','partnerSeenInfos',],}),lastMessage:many2one('mail.message',{compute:'_computeLastMessage',dependencies:['orderedMessages'],}),lastNeedactionMessage:many2one('mail.message',{compute:'_computeLastNeedactionMessage',dependencies:['needactionMessages'],}),lastNeedactionMessageAsOriginThread:many2one('mail.message',{compute:'_computeLastNeedactionMessageAsOriginThread',dependencies:['needactionMessagesAsOriginThread',],}),lastNonTransientMessage:many2one('mail.message',{compute:'_computeLastNonTransientMessage',dependencies:['orderedNonTransientMessages'],}),lastSeenByCurrentPartnerMessageId:attr({compute:'_computeLastSeenByCurrentPartnerMessageId',default:0,dependencies:['lastSeenByCurrentPartnerMessageId','messagingCurrentPartner','orderedMessages','orderedMessagesIsTransient',],}),localMessageUnreadCounter:attr({compute:'_computeLocalMessageUnreadCounter',dependencies:['lastSeenByCurrentPartnerMessageId','messagingCurrentPartner','orderedMessages','serverLastMessageId','serverMessageUnreadCounter',],}),mainCache:one2one('mail.thread_cache',{compute:'_computeMainCache',}),mass_mailing:attr({default:false,}),members:many2many('mail.partner',{inverse:'memberThreads',}),messageAfterNewMessageSeparator:many2one('mail.message',{compute:'_computeMessageAfterNewMessageSeparator',dependencies:['lastSeenByCurrentPartnerMessageId','localMessageUnreadCounter','model','orderedMessages',],}),message_needaction_counter:attr({default:0,}),messages:many2many('mail.message',{inverse:'threads',}),messagesAsOriginThread:one2many('mail.message',{inverse:'originThread',}),messagesAsOriginThreadIsNeedaction:attr({related:'messagesAsOriginThread.isNeedaction',}),messagesAsServerChannel:many2many('mail.message',{inverse:'serverChannels',}),messagesIsNeedaction:attr({related:'messages.isNeedaction',}),messageSeenIndicators:one2many('mail.message_seen_indicator',{inverse:'thread',isCausal:true,}),messaging:many2one('mail.messaging',{compute:'_computeMessaging',}),messagingCurrentPartner:many2one('mail.partner',{related:'messaging.currentPartner',}),model:attr(),model_name:attr(),moderation:attr({default:false,}),moderators:many2many('mail.partner',{inverse:'moderatedChannels',}),moduleIcon:attr(),name:attr(),needactionMessages:many2many('mail.message',{compute:'_computeNeedactionMessages',dependencies:['messages','messagesIsNeedaction',],}),needactionMessagesAsOriginThread:many2many('mail.message',{compute:'_computeNeedactionMessagesAsOriginThread',dependencies:['messagesAsOriginThread','messagesAsOriginThreadIsNeedaction',],}),onChangeFollowersPartner:attr({compute:'_onChangeFollowersPartner',dependencies:['followersPartner',],}),onChangeLastSeenByCurrentPartnerMessageId:attr({compute:'_onChangeLastSeenByCurrentPartnerMessageId',dependencies:['lastSeenByCurrentPartnerMessageId',],}),onChangeThreadView:attr({compute:'_onChangeThreadViews',dependencies:['threadViews',],}),onIsServerPinnedChanged:attr({compute:'_onIsServerPinnedChanged',dependencies:['isServerPinned',],}),onServerFoldStateChanged:attr({compute:'_onServerFoldStateChanged',dependencies:['serverFoldState',],}),orderedMessages:many2many('mail.message',{compute:'_computeOrderedMessages',dependencies:['messages'],}),orderedMessagesIsTransient:attr({related:'orderedMessages.isTransient',}),orderedNonTransientMessages:many2many('mail.message',{compute:'_computeOrderedNonTransientMessages',dependencies:['orderedMessages','orderedMessagesIsTransient',],}),orderedOtherTypingMembers:many2many('mail.partner',{compute:'_computeOrderedOtherTypingMembers',dependencies:['orderedTypingMembers'],}),orderedTypingMembers:many2many('mail.partner',{compute:'_computeOrderedTypingMembers',dependencies:['orderedTypingMemberLocalIds','typingMembers',],}),orderedTypingMemberLocalIds:attr({default:[],}),originThreadAttachments:one2many('mail.attachment',{inverse:'originThread',}),overdueActivities:one2many('mail.activity',{compute:'_computeOverdueActivities',dependencies:['activitiesState'],}),partnerSeenInfos:one2many('mail.thread_partner_seen_info',{inverse:'thread',isCausal:true,}),pendingSeenMessageId:attr(),public:attr(),serverFoldState:attr({default:'closed',}),serverLastMessageId:attr({default:0,}),serverMessageUnreadCounter:attr({default:0,}),suggestedRecipientInfoList:one2many('mail.suggested_recipient_info',{inverse:'thread',}),threadViews:one2many('mail.thread_view',{inverse:'thread',}),todayActivities:one2many('mail.activity',{compute:'_computeTodayActivities',dependencies:['activitiesState'],}),typingMembers:many2many('mail.partner'),typingStatusText:attr({compute:'_computeTypingStatusText',default:'',dependencies:['orderedOtherTypingMembers'],}),url:attr({compute:'_computeUrl',default:'',dependencies:['id','model',]}),uuid:attr(),};Thread.modelName='mail.thread';return Thread;}
registerNewModel('mail.thread',factory);});;

/* /mail/static/src/models/thread_cache/thread_cache.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/thread_cache/thread_cache.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2many,many2one,one2many}=require('mail/static/src/model/model_field.js');function factory(dependencies){class ThreadCache extends dependencies['mail.model']{async loadMoreMessages(){if(this.isAllHistoryLoaded||this.isLoading){return;}
if(!this.isLoaded){this.update({isCacheRefreshRequested:true});return;}
this.update({isLoadingMore:true});const messageIds=this.fetchedMessages.map(message=>message.id);const limit=30;const fetchedMessages=await this.async(()=>this._loadMessages({extraDomain:[['id','<',Math.min(...messageIds)]],limit,}));this.update({isLoadingMore:false});if(fetchedMessages.length<limit){this.update({isAllHistoryLoaded:true});}
for(const threadView of this.threadViews){threadView.addComponentHint('more-messages-loaded',{fetchedMessages});}
return fetchedMessages;}
async loadNewMessages(){if(this.isLoading){return;}
if(!this.isLoaded){this.update({isCacheRefreshRequested:true});return;}
const messageIds=this.fetchedMessages.map(message=>message.id);const fetchedMessages=this._loadMessages({extraDomain:[['id','>',Math.max(...messageIds)]],limit:false,});for(const threadView of this.threadViews){threadView.addComponentHint('new-messages-loaded',{fetchedMessages});}
return fetchedMessages;}
static _createRecordLocalId(data){const{stringifiedDomain='[]',thread:[[commandInsert,thread]],}=data;return`${this.modelName}_[${thread.localId}]_<${stringifiedDomain}>`;}
_computeCheckedMessages(){const messagesWithoutCheckbox=this.checkedMessages.filter(message=>!message.hasCheckbox);return[['unlink',messagesWithoutCheckbox]];}
_computeFetchedMessages(){if(!this.thread){return[['unlink-all']];}
const toUnlinkMessages=[];for(const message of this.fetchedMessages){if(!this.thread.messages.includes(message)){toUnlinkMessages.push(message);}}
return[['unlink',toUnlinkMessages]];}
_computeLastFetchedMessage(){const{length:l,[l-1]:lastFetchedMessage,}=this.orderedFetchedMessages;if(!lastFetchedMessage){return[['unlink']];}
return[['link',lastFetchedMessage]];}
_computeLastMessage(){const{length:l,[l-1]:lastMessage,}=this.orderedMessages;if(!lastMessage){return[['unlink']];}
return[['link',lastMessage]];}
_computeMessages(){if(!this.thread){return[['unlink-all']];}
let messages=this.fetchedMessages;if(this.stringifiedDomain!=='[]'){return[['replace',messages]];}
let newerMessages;if(!this.lastFetchedMessage){newerMessages=this.thread.messages;}else{newerMessages=this.thread.messages.filter(message=>message.id>this.lastFetchedMessage.id);}
messages=messages.concat(newerMessages);return[['replace',messages]];}
_computeNonEmptyMessages(){return[['replace',this.messages.filter(message=>!message.isEmpty)]];}
_computeOrderedFetchedMessages(){return[['replace',this.fetchedMessages.sort((m1,m2)=>m1.id<m2.id?-1:1)]];}
_computeOrderedMessages(){return[['replace',this.messages.sort((m1,m2)=>m1.id<m2.id?-1:1)]];}
_computeHasToLoadMessages(){if(!this.thread){return false;}
const wasCacheRefreshRequested=this.isCacheRefreshRequested;if(this.isCacheRefreshRequested){this.update({isCacheRefreshRequested:false});}
if(this.thread.isTemporary){return false;}
if(!wasCacheRefreshRequested&&this.threadViews.length===0){return false;}
if(this.isLoading){return false;}
if(!wasCacheRefreshRequested&&this.isLoaded){return false;}
const isMainCache=this.thread.mainCache===this;if(isMainCache&&this.isLoaded){return false;}
return true;}
_computeUncheckedMessages(){return[['replace',this.messages.filter(message=>message.hasCheckbox&&!this.checkedMessages.includes(message))]];}
_extendMessageDomain(domain){const thread=this.thread;if(thread.model==='mail.channel'){return domain.concat([['channel_ids','in',[thread.id]]]);}else if(thread===this.env.messaging.inbox){return domain.concat([['needaction','=',true]]);}else if(thread===this.env.messaging.starred){return domain.concat([['starred_partner_ids','in',[this.env.messaging.currentPartner.id]],]);}else if(thread===this.env.messaging.history){return domain.concat([['needaction','=',false]]);}else if(thread===this.env.messaging.moderation){return domain.concat([['moderation_status','=','pending_moderation']]);}else{return domain.concat([['message_type','!=','user_notification'],['model','=',thread.model],['res_id','=',thread.id],]);}}
async _loadMessages({extraDomain,limit=30}={}){this.update({isLoading:true});const searchDomain=JSON.parse(this.stringifiedDomain);let domain=searchDomain.length?searchDomain:[];domain=this._extendMessageDomain(domain);if(extraDomain){domain=extraDomain.concat(domain);}
const context=this.env.session.user_context;const moderated_channel_ids=this.thread.moderation?[this.thread.id]:undefined;const messages=await this.async(()=>this.env.models['mail.message'].performRpcMessageFetch(domain,limit,moderated_channel_ids,context,));this.update({fetchedMessages:[['link',messages]],isLoaded:true,isLoading:false,});if(!extraDomain&&messages.length<limit){this.update({isAllHistoryLoaded:true});}
this.env.messagingBus.trigger('o-thread-cache-loaded-messages',{fetchedMessages:messages,threadCache:this,});return messages;}
_onChangeMarkAllAsRead(){if(!this.isMarkAllAsReadRequested||!this.thread||!this.thread.mainCache||!this.isLoaded||this.isLoading){return;}
this.update({isMarkAllAsReadRequested:false});if(this.thread.isTemporary||this.thread.model==='mail.box'||this.thread.mainCache!==this||this.threadViews.length===0){return;}
this.env.models['mail.message'].markAllAsRead([['model','=',this.thread.model],['res_id','=',this.thread.id],]);}
_onHasToLoadMessagesChanged(){if(!this.hasToLoadMessages){return;}
this._loadMessages().then(fetchedMessages=>{for(const threadView of this.threadViews){threadView.addComponentHint('messages-loaded',{fetchedMessages});}});}
_onMessagesChanged(){if(!this.thread){return;}
if(this.thread.mainCache!==this){return;}
for(const threadView of this.thread.threadViews){if(threadView.threadCache){threadView.threadCache.update({isCacheRefreshRequested:true});}}}}
ThreadCache.fields={checkedMessages:many2many('mail.message',{compute:'_computeCheckedMessages',dependencies:['checkedMessages','messagesCheckboxes',],inverse:'checkedThreadCaches',}),fetchedMessages:many2many('mail.message',{compute:'_computeFetchedMessages',dependencies:['threadMessages'],}),hasToLoadMessages:attr({compute:'_computeHasToLoadMessages',dependencies:['isCacheRefreshRequested','isLoaded','isLoading','thread','threadIsTemporary','threadMainCache','threadViews',],}),isAllHistoryLoaded:attr({default:false,}),isLoaded:attr({default:false,}),isLoading:attr({default:false,}),isLoadingMore:attr({default:false,}),isCacheRefreshRequested:attr({default:false,}),isMarkAllAsReadRequested:attr({default:false,}),lastFetchedMessage:many2one('mail.message',{compute:'_computeLastFetchedMessage',dependencies:['orderedFetchedMessages'],}),lastMessage:many2one('mail.message',{compute:'_computeLastMessage',dependencies:['orderedMessages'],}),messagesCheckboxes:attr({related:'messages.hasCheckbox',}),messages:many2many('mail.message',{compute:'_computeMessages',dependencies:['fetchedMessages','threadMessages',],}),messagesAreEmpty:attr({related:'messages.isEmpty'}),nonEmptyMessages:many2many('mail.message',{compute:'_computeNonEmptyMessages',dependencies:['messages','messagesAreEmpty',],}),onChangeMarkAllAsRead:attr({compute:'_onChangeMarkAllAsRead',dependencies:['isLoaded','isLoading','isMarkAllAsReadRequested','thread','threadIsTemporary','threadMainCache','threadModel','threadViews',],}),onHasToLoadMessagesChanged:attr({compute:'_onHasToLoadMessagesChanged',dependencies:['hasToLoadMessages',],}),onMessagesChanged:attr({compute:'_onMessagesChanged',dependencies:['messages','thread','threadMainCache',],}),orderedFetchedMessages:many2many('mail.message',{compute:'_computeOrderedFetchedMessages',dependencies:['fetchedMessages'],}),orderedMessages:many2many('mail.message',{compute:'_computeOrderedMessages',dependencies:['messages'],}),stringifiedDomain:attr({default:'[]',}),thread:many2one('mail.thread',{inverse:'caches',}),threadIsTemporary:attr({related:'thread.isTemporary',}),threadMainCache:many2one('mail.thread_cache',{related:'thread.mainCache',}),threadMessages:many2many('mail.message',{related:'thread.messages',}),threadModel:attr({related:'thread.model',}),threadViews:one2many('mail.thread_view',{inverse:'threadCache',}),uncheckedMessages:many2many('mail.message',{compute:'_computeUncheckedMessages',dependencies:['checkedMessages','messagesCheckboxes','messages',],}),};ThreadCache.modelName='mail.thread_cache';return ThreadCache;}
registerNewModel('mail.thread_cache',factory);});;

/* /mail/static/src/models/thread_partner_seen_info/thread_partner_seen_info.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/thread_partner_seen_info/thread_partner_seen_info.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class ThreadPartnerSeenInfo extends dependencies['mail.model']{static _createRecordLocalId(data){const{channelId,partnerId}=data;return`${this.modelName}_${channelId}_${partnerId}`;}
_computePartner(){return[['insert',{id:this.partnerId}]];}
_computeThread(){return[['insert',{id:this.channelId,model:'mail.channel',}]];}}
ThreadPartnerSeenInfo.modelName='mail.thread_partner_seen_info';ThreadPartnerSeenInfo.fields={channelId:attr(),lastFetchedMessage:many2one('mail.message'),lastSeenMessage:many2one('mail.message'),partner:many2one('mail.partner',{compute:'_computePartner',dependencies:['partnerId'],}),partnerId:attr(),thread:many2one('mail.thread',{compute:'_computeThread',dependencies:['channelId'],inverse:'partnerSeenInfos',}),};return ThreadPartnerSeenInfo;}
registerNewModel('mail.thread_partner_seen_info',factory);});;

/* /mail/static/src/models/thread_view/thread_view.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/thread_view/thread_view.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{RecordDeletedError}=require('mail/static/src/model/model_errors.js');const{attr,many2many,many2one,one2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');function factory(dependencies){class ThreadView extends dependencies['mail.model']{_willDelete(){this.env.browser.clearTimeout(this._loaderTimeout);return super._willDelete(...arguments);}
addComponentHint(hintType,hintData){const hint={data:hintData,type:hintType};this.update({componentHintList:this.componentHintList.concat([hint]),});}
markComponentHintProcessed(hint){this.update({componentHintList:this.componentHintList.filter(h=>h!==hint),});this.env.messagingBus.trigger('o-thread-view-hint-processed',{hint,threadViewer:this.threadViewer,});}
handleVisibleMessage(message){if(!this.lastVisibleMessage||this.lastVisibleMessage.id<message.id){this.update({lastVisibleMessage:[['link',message]]});}}
_computeMessaging(){return[['link',this.env.messaging]];}
_computeTextInputSendShortcuts(){if(!this.thread){return;}
const isMailingList=this.thread.model==='mail.channel'&&this.thread.mass_mailing;if(this.env.messaging.device.isMobile||isMailingList){return['ctrl-enter','meta-enter'];}
return['enter'];}
_computeThreadCacheInitialScrollHeight(){if(!this.threadCache){return clear();}
const threadCacheInitialScrollHeight=this.threadCacheInitialScrollHeights[this.threadCache.localId];if(threadCacheInitialScrollHeight!==undefined){return threadCacheInitialScrollHeight;}
return clear();}
_computeThreadCacheInitialScrollPosition(){if(!this.threadCache){return clear();}
const threadCacheInitialScrollPosition=this.threadCacheInitialScrollPositions[this.threadCache.localId];if(threadCacheInitialScrollPosition!==undefined){return threadCacheInitialScrollPosition;}
return clear();}
_computeThreadShouldBeSetAsSeen(){if(!this.thread){return;}
if(!this.thread.lastNonTransientMessage){return;}
if(!this.lastVisibleMessage){return;}
if(this.lastVisibleMessage!==this.lastMessage){return;}
if(!this.hasComposerFocus){return;}
this.thread.markAsSeen(this.thread.lastNonTransientMessage).catch(e=>{if(!(e instanceof RecordDeletedError)){throw e;}});}
_onThreadCacheChanged(){this.update({componentHintList:clear()});this.addComponentHint('change-of-thread-cache');if(this.threadCache){this.threadCache.update({isCacheRefreshRequested:true,isMarkAllAsReadRequested:true,});}
this.update({lastVisibleMessage:[['unlink']]});}
_onThreadCacheIsLoadingChanged(){if(this.threadCache&&this.threadCache.isLoading){if(!this.isLoading&&!this.isPreparingLoading){this.update({isPreparingLoading:true});this.async(()=>new Promise(resolve=>{this._loaderTimeout=this.env.browser.setTimeout(resolve,400);})).then(()=>{const isLoading=this.threadCache?this.threadCache.isLoading:false;this.update({isLoading,isPreparingLoading:false});});}
return;}
this.env.browser.clearTimeout(this._loaderTimeout);this.update({isLoading:false,isPreparingLoading:false});}}
ThreadView.fields={checkedMessages:many2many('mail.message',{related:'threadCache.checkedMessages',}),componentHintList:attr({default:[],}),composer:many2one('mail.composer',{related:'thread.composer',}),device:one2one('mail.device',{related:'messaging.device',}),deviceIsMobile:attr({related:'device.isMobile',}),hasComposerFocus:attr({related:'composer.hasFocus',}),isLoading:attr({default:false,}),isPreparingLoading:attr({default:false,}),hasAutoScrollOnMessageReceived:attr({default:true,}),lastMessage:many2one('mail.message',{related:'thread.lastMessage',}),lastNonTransientMessage:many2one('mail.message',{related:'thread.lastNonTransientMessage',}),lastVisibleMessage:many2one('mail.message'),messages:many2many('mail.message',{related:'threadCache.messages',}),messaging:many2one('mail.messaging',{compute:'_computeMessaging',}),nonEmptyMessages:many2many('mail.message',{related:'threadCache.nonEmptyMessages',}),onThreadCacheChanged:attr({compute:'_onThreadCacheChanged',dependencies:['threadCache'],}),onThreadCacheIsLoadingChanged:attr({compute:'_onThreadCacheIsLoadingChanged',dependencies:['threadCache','threadCacheIsLoading',],}),stringifiedDomain:attr({related:'threadViewer.stringifiedDomain',}),textInputSendShortcuts:attr({compute:'_computeTextInputSendShortcuts',dependencies:['device','deviceIsMobile','thread','threadMassMailing','threadModel',],}),thread:many2one('mail.thread',{inverse:'threadViews',related:'threadViewer.thread',}),threadCache:many2one('mail.thread_cache',{inverse:'threadViews',related:'threadViewer.threadCache',}),threadCacheInitialScrollHeight:attr({compute:'_computeThreadCacheInitialScrollHeight',dependencies:['threadCache','threadCacheInitialScrollHeights',],}),threadCacheInitialScrollPosition:attr({compute:'_computeThreadCacheInitialScrollPosition',dependencies:['threadCache','threadCacheInitialScrollPositions',],}),threadCacheIsLoading:attr({related:'threadCache.isLoading',}),threadCacheInitialScrollHeights:attr({default:{},related:'threadViewer.threadCacheInitialScrollHeights',}),threadCacheInitialScrollPositions:attr({default:{},related:'threadViewer.threadCacheInitialScrollPositions',}),threadMassMailing:attr({related:'thread.mass_mailing',}),threadModel:attr({related:'thread.model',}),threadShouldBeSetAsSeen:attr({compute:'_computeThreadShouldBeSetAsSeen',dependencies:['hasComposerFocus','lastMessage','lastNonTransientMessage','lastVisibleMessage','threadCache',],}),threadViewer:one2one('mail.thread_viewer',{inverse:'threadView',}),uncheckedMessages:many2many('mail.message',{related:'threadCache.uncheckedMessages',}),};ThreadView.modelName='mail.thread_view';return ThreadView;}
registerNewModel('mail.thread_view',factory);});;

/* /mail/static/src/models/thread_view/thread_viewer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/thread_viewer/thread_viewer.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,many2one,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class ThreadViewer extends dependencies['mail.model']{saveThreadCacheScrollHeightAsInitial(scrollHeight,threadCache){threadCache=threadCache||this.threadCache;if(!threadCache){return;}
if(this.chatter){return;}
this.update({threadCacheInitialScrollHeights:Object.assign({},this.threadCacheInitialScrollHeights,{[threadCache.localId]:scrollHeight,}),});}
saveThreadCacheScrollPositionsAsInitial(scrollTop,threadCache){threadCache=threadCache||this.threadCache;if(!threadCache){return;}
if(this.chatter){return;}
this.update({threadCacheInitialScrollPositions:Object.assign({},this.threadCacheInitialScrollPositions,{[threadCache.localId]:scrollTop,}),});}
_computeHasThreadView(){if(this.chatter){return this.chatter.hasThreadView;}
if(this.chatWindow){return this.chatWindow.hasThreadView;}
if(this.discuss){return this.discuss.hasThreadView;}
return this.hasThreadView;}
_computeStringifiedDomain(){if(this.chatter){return'[]';}
if(this.chatWindow){return'[]';}
if(this.discuss){return this.discuss.stringifiedDomain;}
return this.stringifiedDomain;}
_computeThread(){if(this.chatter){if(!this.chatter.thread){return[['unlink']];}
return[['link',this.chatter.thread]];}
if(this.chatWindow){if(!this.chatWindow.thread){return[['unlink']];}
return[['link',this.chatWindow.thread]];}
if(this.discuss){if(!this.discuss.thread){return[['unlink']];}
return[['link',this.discuss.thread]];}
return[];}
_computeThreadCache(){if(!this.thread){return[['unlink']];}
return[['link',this.thread.cache(this.stringifiedDomain)]];}
_computeThreadView(){if(!this.hasThreadView){return[['unlink']];}
if(this.threadView){return[];}
return[['create']];}}
ThreadViewer.fields={chatter:one2one('mail.chatter',{inverse:'threadViewer',}),chatterHasThreadView:attr({related:'chatter.hasThreadView',}),chatterThread:many2one('mail.thread',{related:'chatter.thread',}),chatWindow:one2one('mail.chat_window',{inverse:'threadViewer',}),chatWindowHasThreadView:attr({related:'chatWindow.hasThreadView',}),chatWindowThread:many2one('mail.thread',{related:'chatWindow.thread',}),discuss:one2one('mail.discuss',{inverse:'threadViewer',}),discussHasThreadView:attr({related:'discuss.hasThreadView',}),discussStringifiedDomain:attr({related:'discuss.stringifiedDomain',}),discussThread:many2one('mail.thread',{related:'discuss.thread',}),hasThreadView:attr({compute:'_computeHasThreadView',default:false,dependencies:['chatterHasThreadView','chatWindowHasThreadView','discussHasThreadView',],}),stringifiedDomain:attr({compute:'_computeStringifiedDomain',default:'[]',dependencies:['discussStringifiedDomain',],}),thread:many2one('mail.thread',{compute:'_computeThread',dependencies:['chatterThread','chatWindowThread','discussThread',],}),threadCache:many2one('mail.thread_cache',{compute:'_computeThreadCache',dependencies:['stringifiedDomain','thread',],}),threadCacheInitialScrollHeights:attr({default:{},}),threadCacheInitialScrollPositions:attr({default:{},}),threadView:one2one('mail.thread_view',{compute:'_computeThreadView',dependencies:['hasThreadView',],inverse:'threadViewer',isCausal:true,}),};ThreadViewer.modelName='mail.thread_viewer';return ThreadViewer;}
registerNewModel('mail.thread_viewer',factory);});;

/* /mail/static/src/models/user/user.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/models/user/user.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class User extends dependencies['mail.model']{_willDelete(){if(this.env.messaging){if(this===this.env.messaging.currentUser){this.env.messaging.update({currentUser:[['unlink']]});}}
return super._willDelete(...arguments);}
static convertData(data){const data2={};if('id'in data){data2.id=data.id;}
if('partner_id'in data){if(!data.partner_id){data2.partner=[['unlink']];}else{const partnerNameGet=data['partner_id'];const partnerData={display_name:partnerNameGet[1],id:partnerNameGet[0],};data2.partner=[['insert',partnerData]];}}
return data2;}
static async performRpcRead({context,fields,ids}){const usersData=await this.env.services.rpc({model:'res.users',method:'read',args:[ids],kwargs:{context,fields,},},{shadow:true});return this.env.models['mail.user'].insert(usersData.map(userData=>this.env.models['mail.user'].convertData(userData)));}
async fetchPartner(){return this.env.models['mail.user'].performRpcRead({ids:[this.id],fields:['partner_id'],context:{active_test:false},});}
async getChat(){if(!this.partner){await this.async(()=>this.fetchPartner());}
if(!this.partner){this.env.services['notification'].notify({message:this.env._t("You can only chat with existing users."),type:'warning',});return;}
let chat=this.env.models['mail.thread'].find(thread=>thread.channel_type==='chat'&&thread.correspondent===this.partner&&thread.model==='mail.channel'&&thread.public==='private');if(!chat||!chat.isPinned){chat=await this.async(()=>this.env.models['mail.thread'].performRpcCreateChat({partnerIds:[this.partner.id],}));}
if(!chat){this.env.services['notification'].notify({message:this.env._t("An unexpected error occurred during the creation of the chat."),type:'warning',});return;}
return chat;}
async openChat(options){const chat=await this.async(()=>this.getChat());if(!chat){return;}
await this.async(()=>chat.open(options));return chat;}
async openProfile(){if(!this.partner){await this.async(()=>this.fetchPartner());}
if(!this.partner){this.env.services['notification'].notify({message:this.env._t("You can only open the profile of existing users."),type:'warning',});return;}
return this.partner.openProfile();}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}
_computeDisplayName(){return this.display_name||this.partner&&this.partner.display_name;}
_computeNameOrDisplayName(){return this.partner&&this.partner.nameOrDisplayName||this.display_name;}}
User.fields={id:attr(),isInternalUser:attr(),display_name:attr({compute:'_computeDisplayName',dependencies:['display_name','partnerDisplayName',],}),model:attr({default:'res.user',}),nameOrDisplayName:attr({compute:'_computeNameOrDisplayName',dependencies:['display_name','partnerNameOrDisplayName',]}),partner:one2one('mail.partner',{inverse:'user',}),partnerDisplayName:attr({related:'partner.display_name',}),partnerNameOrDisplayName:attr({related:'partner.nameOrDisplayName',}),};User.modelName='mail.user';return User;}
registerNewModel('mail.user',factory);});;

/* /mail/static/src/services/chat_window_service/chat_window_service.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/services/chat_window_service/chat_window_service.js',function(require){'use strict';const components={ChatWindowManager:require('mail/static/src/components/chat_window_manager/chat_window_manager.js'),};const AbstractService=require('web.AbstractService');const{bus,serviceRegistry}=require('web.core');const ChatWindowService=AbstractService.extend({start(){this._super(...arguments);this._webClientReady=false;this._listenHomeMenu();},destroy(){if(this.component){this.component.destroy();this.component=undefined;}},_getParentNode(){return document.querySelector('body');},_listenHomeMenu(){bus.on('hide_home_menu',this,this._onHideHomeMenu.bind(this));bus.on('show_home_menu',this,this._onShowHomeMenu.bind(this));bus.on('web_client_ready',this,this._onWebClientReady.bind(this));},async _mount(){if(this.component){this.component.destroy();this.component=undefined;}
const ChatWindowManagerComponent=components.ChatWindowManager;this.component=new ChatWindowManagerComponent(null);const parentNode=this._getParentNode();await this.component.mount(parentNode);},async _onHideHomeMenu(){if(!this._webClientReady){return;}
if(document.querySelector('.o_ChatWindowManager')){return;}
await this._mount();},async _onShowHomeMenu(){if(!this._webClientReady){return;}
if(document.querySelector('.o_ChatWindowManager')){return;}
await this._mount();},async _onWebClientReady(){await this._mount();this._webClientReady=true;},});serviceRegistry.add('chat_window',ChatWindowService);return ChatWindowService;});;

/* /mail/static/src/services/dialog_service/dialog_service.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/services/dialog_service/dialog_service.js',function(require){'use strict';const components={DialogManager:require('mail/static/src/components/dialog_manager/dialog_manager.js'),};const AbstractService=require('web.AbstractService');const{bus,serviceRegistry}=require('web.core');const DialogService=AbstractService.extend({start(){this._super(...arguments);this._webClientReady=false;this._listenHomeMenu();},destroy(){if(this.component){this.component.destroy();this.component=undefined;}},_getParentNode(){return document.querySelector('body');},_listenHomeMenu(){bus.on('hide_home_menu',this,this._onHideHomeMenu.bind(this));bus.on('show_home_menu',this,this._onShowHomeMenu.bind(this));bus.on('web_client_ready',this,this._onWebClientReady.bind(this));},async _mount(){if(this.component){this.component.destroy();this.component=undefined;}
const DialogManagerComponent=components.DialogManager;this.component=new DialogManagerComponent(null);const parentNode=this._getParentNode();await this.component.mount(parentNode);},async _onHideHomeMenu(){if(!this._webClientReady){return;}
if(document.querySelector('.o_DialogManager')){return;}
await this._mount();},async _onShowHomeMenu(){if(!this._webClientReady){return;}
if(document.querySelector('.o_DialogManager')){return;}
await this._mount();},async _onWebClientReady(){await this._mount();this._webClientReady=true;}});serviceRegistry.add('dialog',DialogService);return DialogService;});;

/* /mail/static/src/utils/deferred/deferred.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/utils/deferred/deferred.js',function(require){'use strict';function makeDeferred(){let resolve;let reject;const prom=new Promise(function(res,rej){resolve=res.bind(this);reject=rej.bind(this);});prom.resolve=(...args)=>resolve(...args);prom.reject=(...args)=>reject(...args);return prom;}
return{makeDeferred};});;

/* /mail/static/src/utils/throttle/throttle.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/utils/throttle/throttle.js',function(require){'use strict';const{makeDeferred}=require('mail/static/src/utils/deferred/deferred.js');class ThrottleCanceledError extends Error{constructor(throttleId,...args){super(...args);this.name='ThrottleCanceledError';this.throttleId=throttleId;}}
class ThrottleReinvokedError extends Error{constructor(throttleId,...args){super(...args);this.name='ThrottleReinvokedError';this.throttleId=throttleId;}}
class _ThrottleFlushedError extends Error{constructor(throttleId,...args){super(...args);this.name='_ThrottleFlushedError';this.throttleId=throttleId;}}
class Throttle{constructor(env,func,duration){this.env=env;this.id=_.uniqueId('throttle_');this._coolingDownDeferred=undefined;this._duration=duration;this._function=func;this._isCoolingDown=false;this._pendingInvokeDeferred=undefined;}
cancel(){if(!this._isCoolingDown){return;}
if(!this._pendingInvokeDeferred){return;}
this._pendingInvokeDeferred.reject(new ThrottleCanceledError(this.id));}
clear(){this.cancel();this.flush();}
async do(...args){if(!this._isCoolingDown){return this._invokeFunction(...args);}
if(this._pendingInvokeDeferred){this._pendingInvokeDeferred.reject(new ThrottleReinvokedError(this.id));}
try{this._pendingInvokeDeferred=makeDeferred();await Promise.race([this._coolingDownDeferred,this._pendingInvokeDeferred]);}catch(error){if(!(error instanceof _ThrottleFlushedError)||error.throttleId!==this.id){throw error;}}finally{this._pendingInvokeDeferred=undefined;}
return this._invokeFunction(...args);}
flush(){if(!this._isCoolingDown){return;}
const coolingDownDeferred=this._coolingDownDeferred;this._coolingDownDeferred=undefined;this._isCoolingDown=false;coolingDownDeferred.reject(new _ThrottleFlushedError(this.id));}
_invokeFunction(...args){const res=this._function(...args);this._startCoolingDown();return res;}
async _startCoolingDown(){if(this._coolingDownDeferred){throw new Error("Cannot start cooling down if there's already a cooling down in progress.");}
const coolingDownDeferred=makeDeferred();this._coolingDownDeferred=coolingDownDeferred;this._isCoolingDown=true;const cooldownTimeoutId=this.env.browser.setTimeout(()=>coolingDownDeferred.resolve(),this._duration);let unexpectedError;try{await coolingDownDeferred;}catch(error){if(!(error instanceof _ThrottleFlushedError)||error.throttleId!==this.id){unexpectedError=error;}}finally{this.env.browser.clearTimeout(cooldownTimeoutId);this._coolingDownDeferred=undefined;this._isCoolingDown=false;}
if(unexpectedError){throw unexpectedError;}}}
function throttle(env,func,duration,{silentCancelationErrors=true}={}){const throttleObj=new Throttle(env,func,duration);const callable=async(...args)=>{try{return await throttleObj.do(...args);}catch(error){const isSelfReinvokedError=(error instanceof ThrottleReinvokedError&&error.throttleId===throttleObj.id);const isSelfCanceledError=(error instanceof ThrottleCanceledError&&error.throttleId===throttleObj.id);if(silentCancelationErrors&&(isSelfReinvokedError||isSelfCanceledError)){return new Promise(()=>{});}else{throw error;}}};Object.assign(callable,{cancel:()=>throttleObj.cancel(),clear:()=>throttleObj.clear(),flush:()=>throttleObj.flush(),});return callable;}
Object.assign(throttle,{ThrottleReinvokedError,ThrottleCanceledError,});return throttle;});;

/* /mail/static/src/utils/timer/timer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/utils/timer/timer.js',function(require){'use strict';const{makeDeferred}=require('mail/static/src/utils/deferred/deferred.js');class TimerClearedError extends Error{constructor(timerId,...args){super(...args);this.name='TimerClearedError';this.timerId=timerId;}}
class Timer{constructor(env,onTimeout,duration,{silentCancelationErrors=true}={}){this.env=env;this.isRunning=false;this._duration=duration;this._hasSilentCancelationErrors=silentCancelationErrors;this._onTimeout=onTimeout;this._timeoutDeferred=undefined;this._timeoutId=undefined;}
clear(){this.env.browser.clearTimeout(this._timeoutId);this.isRunning=false;if(!this._timeoutDeferred){return;}
this._timeoutDeferred.reject(new TimerClearedError(this.id));}
async reset(){this.clear();await this.start();}
async start(){if(this.isRunning){throw new Error("Cannot start a timer that is currently running.");}
this.isRunning=true;const timeoutDeferred=makeDeferred();this._timeoutDeferred=timeoutDeferred;const timeoutId=this.env.browser.setTimeout(()=>{this.isRunning=false;timeoutDeferred.resolve(this._onTimeout());},this._duration);this._timeoutId=timeoutId;let result;try{result=await timeoutDeferred;}catch(error){if(!this._hasSilentCancelationErrors||!(error instanceof TimerClearedError)||error.timerId!==this.id){throw error;}}finally{this.env.browser.clearTimeout(timeoutId);this._timeoutDeferred=undefined;this.isRunning=false;}
return result;}}
Object.assign(Timer,{TimerClearedError,});return Timer;});;

/* /mail/static/src/utils/utils.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/utils/utils.js',function(require){'use strict';const{delay}=require('web.concurrency');const{patch:webUtilsPatch,unaccent,unpatch:webUtilsUnpatch,}=require('web.utils');const classPatchMap=new WeakMap();const eventHandledWeakMap=new WeakMap();function cleanSearchTerm(searchTerm){return unaccent(searchTerm.toLowerCase());}
async function executeGracefully(functions,maxTimeFrame=100){let startDate=new Date();for(const func of functions){if(new Date()-startDate>maxTimeFrame){await new Promise(resolve=>setTimeout(resolve));startDate=new Date();}
await func();}}
function isEventHandled(ev,markName){if(!eventHandledWeakMap.get(ev)){return false;}
return eventHandledWeakMap.get(ev).includes(markName);}
function markEventHandled(ev,markName){if(!eventHandledWeakMap.get(ev)){eventHandledWeakMap.set(ev,[]);}
eventHandledWeakMap.get(ev).push(markName);}
async function nextTick(){await delay(0);}
function patchClassMethods(Class,patchName,patch){let metadata=classPatchMap.get(Class);if(!metadata){metadata={origMethods:{},patches:{},current:[]};classPatchMap.set(Class,metadata);}
if(metadata.patches[patchName]){throw new Error(`Patch [${patchName}] already exists`);}
metadata.patches[patchName]=patch;applyPatch(Class,patch);metadata.current.push(patchName);function applyPatch(Class,patch){Object.keys(patch).forEach(function(methodName){const method=patch[methodName];if(typeof method==="function"){const original=Class[methodName];if(!(methodName in metadata.origMethods)){metadata.origMethods[methodName]=original;}
Class[methodName]=function(...args){const previousSuper=this._super;this._super=original;const res=method.call(this,...args);this._super=previousSuper;return res;};}});}
return()=>unpatchClassMethods.bind(Class,patchName);}
function patchInstanceMethods(Class,patchName,patch){return webUtilsPatch(Class,patchName,patch);}
function unpatchClassMethods(Class,patchName){let metadata=classPatchMap.get(Class);if(!metadata){return;}
classPatchMap.delete(Class);for(let k in metadata.origMethods){Class[k]=metadata.origMethods[k];}
for(let name of metadata.current){if(name!==patchName){patchClassMethods(Class,name,metadata.patches[name]);}}}
function unpatchInstanceMethods(Class,patchName){return webUtilsUnpatch(Class,patchName);}
return{cleanSearchTerm,executeGracefully,isEventHandled,markEventHandled,nextTick,patchClassMethods,patchInstanceMethods,unpatchClassMethods,unpatchInstanceMethods,};});;

/* /mail/static/src/widgets/discuss/discuss.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/widgets/discuss/discuss.js',function(require){'use strict';const components={Discuss:require('mail/static/src/components/discuss/discuss.js'),};const InvitePartnerDialog=require('mail/static/src/widgets/discuss_invite_partner_dialog/discuss_invite_partner_dialog.js');const AbstractAction=require('web.AbstractAction');const{action_registry,qweb}=require('web.core');const{Component}=owl;const DiscussWidget=AbstractAction.extend({template:'mail.widgets.Discuss',hasControlPanel:true,loadControlPanel:true,withSearchBar:true,searchMenuTypes:['filter','favorite'],init(parent,action,options={}){this._super(...arguments);this.$buttons=$(qweb.render('mail.widgets.Discuss.DiscussControlButtons'));this.$buttons.find('button').css({display:'inline-block'});this.$buttons.on('click','.o_invite',ev=>this._onClickInvite(ev));this.$buttons.on('click','.o_widget_Discuss_controlPanelButtonMarkAllRead',ev=>this._onClickMarkAllAsRead(ev));this.$buttons.on('click','.o_mobile_new_channel',ev=>this._onClickMobileNewChannel(ev));this.$buttons.on('click','.o_mobile_new_message',ev=>this._onClickMobileNewMessage(ev));this.$buttons.on('click','.o_unstar_all',ev=>this._onClickUnstarAll(ev));this.$buttons.on('click','.o_widget_Discuss_controlPanelButtonSelectAll',ev=>this._onClickSelectAll(ev));this.$buttons.on('click','.o_widget_Discuss_controlPanelButtonUnselectAll',ev=>this._onClickUnselectAll(ev));this.$buttons.on('click','.o_widget_Discuss_controlPanelButtonModeration.o-accept',ev=>this._onClickModerationAccept(ev));this.$buttons.on('click','.o_widget_Discuss_controlPanelButtonModeration.o-discard',ev=>this._onClickModerationDiscard(ev));this.$buttons.on('click','.o_widget_Discuss_controlPanelButtonModeration.o-reject',ev=>this._onClickModerationReject(ev));this.action=action;this.actionManager=parent;this.searchModelConfig.modelName='mail.message';this.discuss=undefined;this.options=options;this.component=undefined;this._lastPushStateActiveThread=null;},async willStart(){await this._super(...arguments);this.env=Component.env;await this.env.messagingCreatedPromise;const initActiveId=this.options.active_id||(this.action.context&&this.action.context.active_id)||(this.action.params&&this.action.params.default_active_id)||'mail.box_inbox';this.discuss=this.env.messaging.discuss;this.discuss.update({initActiveId});},destroy(){if(this.component){this.component.destroy();this.component=undefined;}
if(this.$buttons){this.$buttons.off().remove();}
this._super(...arguments);},on_attach_callback(){this._super(...arguments);if(this.component){return;}
const DiscussComponent=components.Discuss;this.component=new DiscussComponent();this._pushStateActionManagerEventListener=ev=>{ev.stopPropagation();if(this._lastPushStateActiveThread===this.discuss.thread){return;}
this._pushStateActionManager();this._lastPushStateActiveThread=this.discuss.thread;};this._showRainbowManEventListener=ev=>{ev.stopPropagation();this._showRainbowMan();};this._updateControlPanelEventListener=ev=>{ev.stopPropagation();this._updateControlPanel();};this.el.addEventListener('o-push-state-action-manager',this._pushStateActionManagerEventListener);this.el.addEventListener('o-show-rainbow-man',this._showRainbowManEventListener);this.el.addEventListener('o-update-control-panel',this._updateControlPanelEventListener);return this.component.mount(this.el);},on_detach_callback(){this._super(...arguments);if(this.component){this.component.destroy();}
this.component=undefined;this.el.removeEventListener('o-push-state-action-manager',this._pushStateActionManagerEventListener);this.el.removeEventListener('o-show-rainbow-man',this._showRainbowManEventListener);this.el.removeEventListener('o-update-control-panel',this._updateControlPanelEventListener);},_pushStateActionManager(){this.actionManager.do_push_state({action:this.action.id,active_id:this.discuss.activeId,});},_shouldHaveInviteButton(){return(this.discuss.thread&&this.discuss.thread.channel_type==='channel');},_showRainbowMan(){this.trigger_up('show_effect',{message:this.env._t("Congratulations, your inbox is empty!"),type:'rainbow_man',});},_updateControlPanel(){if(this._shouldHaveInviteButton()){this.$buttons.find('.o_invite').removeClass('o_hidden');}else{this.$buttons.find('.o_invite').addClass('o_hidden');}
if(this.discuss.threadView&&this.discuss.thread&&this.discuss.thread===this.env.messaging.inbox){this.$buttons.find('.o_widget_Discuss_controlPanelButtonMarkAllRead').removeClass('o_hidden').prop('disabled',this.discuss.threadView.messages.length===0);}else{this.$buttons.find('.o_widget_Discuss_controlPanelButtonMarkAllRead').addClass('o_hidden');}
if(this.discuss.threadView&&this.discuss.thread&&this.discuss.thread===this.env.messaging.starred){this.$buttons.find('.o_unstar_all').removeClass('o_hidden').prop('disabled',this.discuss.threadView.messages.length===0);}else{this.$buttons.find('.o_unstar_all').addClass('o_hidden');}
if(this.env.messaging.device.isMobile&&this.discuss.activeMobileNavbarTabId==='channel'){this.$buttons.find('.o_mobile_new_channel').removeClass('o_hidden');}else{this.$buttons.find('.o_mobile_new_channel').addClass('o_hidden');}
if(this.env.messaging.device.isMobile&&this.discuss.activeMobileNavbarTabId==='chat'){this.$buttons.find('.o_mobile_new_message').removeClass('o_hidden');}else{this.$buttons.find('.o_mobile_new_message').addClass('o_hidden');}
const $selectAll=this.$buttons.find('.o_widget_Discuss_controlPanelButtonSelectAll');const $unselectAll=this.$buttons.find('.o_widget_Discuss_controlPanelButtonUnselectAll');if(this.discuss.threadView&&(this.discuss.threadView.checkedMessages.length>0||this.discuss.threadView.uncheckedMessages.length>0)){$selectAll.removeClass('o_hidden');$selectAll.toggleClass('disabled',this.discuss.threadView.uncheckedMessages.length===0);$unselectAll.removeClass('o_hidden');$unselectAll.toggleClass('disabled',this.discuss.threadView.checkedMessages.length===0);}else{$selectAll.addClass('o_hidden');$selectAll.addClass('disabled');$unselectAll.addClass('o_hidden');$unselectAll.addClass('disabled');}
const $moderationButtons=this.$buttons.find('.o_widget_Discuss_controlPanelButtonModeration');if(this.discuss.threadView&&this.discuss.threadView.checkedMessages.length>0&&this.discuss.threadView.checkedMessages.filter(message=>!message.isModeratedByCurrentPartner).length===0){$moderationButtons.removeClass('o_hidden');}else{$moderationButtons.addClass('o_hidden');}
let title;if(this.env.messaging.device.isMobile||!this.discuss.thread){title=this.env._t("Discuss");}else{const prefix=this.discuss.thread.channel_type==='channel'&&this.discuss.thread.public!=='private'?'#':'';title=`${prefix}${this.discuss.thread.displayName}`;}
this.updateControlPanel({cp_content:{$buttons:this.$buttons,},title,});},_onClickInvite(){new InvitePartnerDialog(this,{activeThreadLocalId:this.discuss.thread.localId,messagingEnv:this.env,}).open();},_onClickMarkAllAsRead(){const domain=this.discuss.stringifiedDomain?JSON.parse(this.discuss.stringifiedDomain):undefined;this.env.models['mail.message'].markAllAsRead(domain);},_onClickMobileNewChannel(){this.discuss.update({isAddingChannel:true});},_onClickMobileNewMessage(){this.discuss.update({isAddingChat:true});},_onClickModerationAccept(){this.env.models['mail.message'].moderate(this.discuss.threadView.checkedMessages,'accept');},_onClickModerationDiscard(){this.discuss.update({hasModerationDiscardDialog:true});},_onClickModerationReject(){this.discuss.update({hasModerationRejectDialog:true});},_onClickSelectAll(){this.env.models['mail.message'].checkAll(this.discuss.thread,this.discuss.stringifiedDomain);},_onClickUnselectAll(){this.env.models['mail.message'].uncheckAll(this.discuss.thread,this.discuss.stringifiedDomain);},_onClickUnstarAll(){this.env.models['mail.message'].unstarAll();},_onSearch:function(searchQuery){this.discuss.update({stringifiedDomain:JSON.stringify(searchQuery.domain),});},});action_registry.add('mail.widgets.discuss',DiscussWidget);return DiscussWidget;});;

/* /mail/static/src/widgets/discuss_invite_partner_dialog/discuss_invite_partner_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/widgets/discuss_invite_partner_dialog/discuss_invite_partner_dialog.js',function(require){'use strict';const core=require('web.core');const Dialog=require('web.Dialog');const _lt=core._lt;const QWeb=core.qweb;const PartnerInviteDialog=Dialog.extend({dialog_title:_lt("Invite people"),template:'mail.widgets.DiscussInvitePartnerDialog',init(parent,{activeThreadLocalId,messagingEnv}){const env=messagingEnv;const channel=env.models['mail.thread'].get(activeThreadLocalId);this.channelId=channel.id;this.env=env;this._super(parent,{title:_.str.sprintf(this.env._t("Invite people to #%s"),owl.utils.escape(channel.displayName)),size:'medium',buttons:[{text:this.env._t("Invite"),close:true,classes:'btn-primary',click:ev=>this._invite(ev),}],});},start(){this.$input=this.$('.o_input');this.$input.select2({width:'100%',allowClear:true,multiple:true,formatResult:item=>{let status;if(item.id==='odoobot'){status='bot';}else{const partner=this.env.models['mail.partner'].findFromIdentifyingData({id:item.id,});status=partner.im_status;}
const $status=QWeb.render('mail.widgets.UserStatus',{status});return $('<span>').text(item.text).prepend($status);},query:query=>{this.env.models['mail.partner'].imSearch({callback:partners=>{let results=partners.map(partner=>{return{id:partner.id,label:partner.nameOrDisplayName,text:partner.nameOrDisplayName,value:partner.nameOrDisplayName,};});results=_.sortBy(results,'label');query.callback({results});},keyword:query.term,limit:20,});}});return this._super(...arguments);},async _invite(){const data=this.$input.select2('data');if(data.length===0){return;}
await this._rpc({model:'mail.channel',method:'channel_invite',args:[this.channelId],kwargs:{partner_ids:_.pluck(data,'id')},});const names=_.escape(_.pluck(data,'text').join(', '));const notification=_.str.sprintf(this.env._t("You added <b>%s</b> to the conversation."),names);this.env.services['notification'].notify({message:notification,type:'warning',});},});return PartnerInviteDialog;});;

/* /mail/static/src/widgets/form_renderer/form_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/widgets/form_renderer/form_renderer.js',function(require){"use strict";const components={ChatterContainer:require('mail/static/src/components/chatter_container/chatter_container.js'),};const FormRenderer=require('web.FormRenderer');const{ComponentWrapper}=require('web.OwlCompatibility');class ChatterContainerWrapperComponent extends ComponentWrapper{}
FormRenderer.include({init(parent,state,params){this._super(...arguments);this.chatterFields=params.chatterFields;this.mailFields=params.mailFields;this._chatterContainerComponent=undefined;this._chatterContainerTarget=undefined;this._isFromFormViewDialog=params.isFromFormViewDialog;},destroy(){this._super(...arguments);this._chatterContainerComponent=undefined;this.off('o_attachments_changed',this);this.off('o_chatter_rendered',this);this.off('o_message_posted',this);owl.Component.env.bus.off('mail.thread:promptAddFollower-closed',this);},_hasChatter(){return!!this._chatterContainerTarget;},_makeChatterContainerComponent(){const props=this._makeChatterContainerProps();this._chatterContainerComponent=new ChatterContainerWrapperComponent(this,components.ChatterContainer,props);this.on('o_chatter_rendered',this,ev=>this._onChatterRendered(ev));if(this.chatterFields.hasRecordReloadOnMessagePosted){this.on('o_message_posted',this,ev=>{this.trigger_up('reload',{keepChanges:true});});}
if(this.chatterFields.hasRecordReloadOnAttachmentsChanged){this.on('o_attachments_changed',this,ev=>this.trigger_up('reload',{keepChanges:true}));}
if(this.chatterFields.hasRecordReloadOnFollowersUpdate){owl.Component.env.bus.on('mail.thread:promptAddFollower-closed',this,ev=>this.trigger_up('reload',{keepChanges:true}));}},_makeChatterContainerProps(){return{hasActivities:this.chatterFields.hasActivityIds,hasFollowers:this.chatterFields.hasMessageFollowerIds,hasMessageList:this.chatterFields.hasMessageIds,isAttachmentBoxVisibleInitially:this.chatterFields.isAttachmentBoxVisibleInitially,threadId:this.state.res_id,threadModel:this.state.model,};},_makeChatterContainerTarget(){const $el=$('<div class="o_FormRenderer_chatterContainer"/>');this._chatterContainerTarget=$el[0];return $el;},async _mountChatterContainerComponent(){try{await this._chatterContainerComponent.mount(this._chatterContainerTarget);}catch(error){if(error.message!=="Mounting operation cancelled"){throw error;}}},_renderNode(node){if(node.tag==='div'&&node.attrs.class==='oe_chatter'){if(this._isFromFormViewDialog){return $('<div/>');}
return this._makeChatterContainerTarget();}
return this._super(...arguments);},async __renderView(){await this._super(...arguments);if(this._hasChatter()){if(!this._chatterContainerComponent){this._makeChatterContainerComponent();}else{await this._updateChatterContainerComponent();}
await this._mountChatterContainerComponent();}},async _updateChatterContainerComponent(){const props=this._makeChatterContainerProps();try{await this._chatterContainerComponent.update(props);}catch(error){if(error.message!=="Mounting operation cancelled"){throw error;}}},_onChatterRendered(ev){},});});;

/* /mail/static/src/widgets/messaging_menu/messaging_menu.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/widgets/messaging_menu/messaging_menu.js',function(require){'use strict';const components={MessagingMenu:require('mail/static/src/components/messaging_menu/messaging_menu.js'),};const SystrayMenu=require('web.SystrayMenu');const Widget=require('web.Widget');const MessagingMenu=Widget.extend({template:'mail.widgets.MessagingMenu',init(){this._super(...arguments);this.component=undefined;},destroy(){if(this.component){this.component.destroy();}
this._super(...arguments);},async on_attach_callback(){const MessagingMenuComponent=components.MessagingMenu;this.component=new MessagingMenuComponent(null);await this.component.mount(this.el);this.el.parentNode.insertBefore(this.component.el,this.el);this.el.parentNode.removeChild(this.el);},});const activityMenuIndex=SystrayMenu.Items.findIndex(SystrayMenuItem=>SystrayMenuItem.prototype.name==='activity_menu');if(activityMenuIndex>0){SystrayMenu.Items.splice(activityMenuIndex,0,MessagingMenu);}else{SystrayMenu.Items.push(MessagingMenu);}
return MessagingMenu;});;

/* /mail/static/src/widgets/notification_alert/notification_alert.js defined in bundle 'web.assets_backend' */
odoo.define('mail/static/src/widgets/notification_alert/notification_alert.js',function(require){"use strict";const components={NotificationAlert:require('mail/static/src/components/notification_alert/notification_alert.js'),};const{ComponentWrapper,WidgetAdapterMixin}=require('web.OwlCompatibility');const Widget=require('web.Widget');const widgetRegistry=require('web.widget_registry');class NotificationAlertWrapper extends ComponentWrapper{}
const NotificationAlert=Widget.extend(WidgetAdapterMixin,{init(){this._super(...arguments);this.component=undefined;},async start(){await this._super(...arguments);this.component=new NotificationAlertWrapper(this,components.NotificationAlert,{});await this.component.mount(this.el);},});widgetRegistry.add('notification_alert',NotificationAlert);return NotificationAlert;});;

/* /mail_bot/static/src/bugfix/bugfix.js defined in bundle 'web.assets_backend' */
odoo.define('mail_bot/static/src/bugfix/bugfix.js',function(require){'use strict';});;

/* /mail_bot/static/src/models/messaging_initializer/messaging_initializer.js defined in bundle 'web.assets_backend' */
odoo.define('mail_bot/static/src/models/messaging_initializer/messaging_initializer.js',function(require){'use strict';const{registerInstancePatchModel}=require('mail/static/src/model/model_core.js');registerInstancePatchModel('mail.messaging_initializer','mail_bot/static/src/models/messaging_initializer/messaging_initializer.js',{async _initializeOdooBot(){const data=await this.async(()=>this.env.services.rpc({model:'mail.channel',method:'init_odoobot',}));if(!data){return;}
this.env.session.odoobot_initialized=true;},async start(){await this.async(()=>this._super());if('odoobot_initialized'in this.env.session&&!this.env.session.odoobot_initialized){this._initializeOdooBot();}},});});;

/* /product/static/src/js/product_pricelist_report.js defined in bundle 'web.assets_backend' */
odoo.define('product.generate_pricelist',function(require){'use strict';var AbstractAction=require('web.AbstractAction');var core=require('web.core');var FieldMany2One=require('web.relational_fields').FieldMany2One;var StandaloneFieldManagerMixin=require('web.StandaloneFieldManagerMixin');var Widget=require('web.Widget');var QWeb=core.qweb;var _t=core._t;var QtyTagWidget=Widget.extend({template:'product.report_pricelist_qty',events:{'click .o_remove_qty':'_onClickRemoveQty',},init:function(parent,defaulQuantities){this._super.apply(this,arguments);this.quantities=defaulQuantities;this.MAX_QTY=5;},_onClickAddQty:function(){if(this.quantities.length>=this.MAX_QTY){this.do_notify(false,_.str.sprintf(_t("At most %d quantities can be displayed simultaneously. Remove a selected quantity to add others."),this.MAX_QTY));return;}
const qty=parseInt(this.$('.o_product_qty').val());if(qty&&qty>0){if(this.quantities.indexOf(qty)===-1){this.quantities.push(qty);this.quantities=this.quantities.sort((a,b)=>a-b);this.trigger_up('qty_changed',{quantities:this.quantities});this.renderElement();}else{this.displayNotification({message:_.str.sprintf(_t("Quantity already present (%d)."),qty),type:'info'});}}else{this.do_notify(false,_t("Please enter a positive whole number"));}},_onClickRemoveQty:function(ev){const qty=parseInt($(ev.currentTarget).closest('.badge').data('qty'));this.quantities=this.quantities.filter(q=>q!==qty);this.trigger_up('qty_changed',{quantities:this.quantities});this.renderElement();},});var GeneratePriceList=AbstractAction.extend(StandaloneFieldManagerMixin,{hasControlPanel:true,events:{'click .o_action':'_onClickAction','submit form':'_onSubmitForm',},custom_events:Object.assign({},StandaloneFieldManagerMixin.custom_events,{field_changed:'_onFieldChanged',qty_changed:'_onQtyChanged',}),init:function(parent,params){this._super.apply(this,arguments);StandaloneFieldManagerMixin.init.call(this);this.context=params.context;if(params.params&&params.params.active_ids&&typeof(params.params.active_ids==='string')){try{this.context.active_ids=params.params.active_ids.split(',').map(id=>parseInt(id));this.context.active_model=params.params.active_model;}catch(e){console.log('unable to load ids from the url fragment ');}}
if(!this.context.active_model){this.context.active_model='product.template';}
this.context.quantities=[1,5,10];},willStart:function(){let getPricelit;if(this.context.default_pricelist){getPricelit=Promise.resolve([this.context.default_pricelist]);}else{getPricelit=this._rpc({model:'product.pricelist',method:'search',args:[[]],kwargs:{limit:1}})}
const fieldSetup=getPricelit.then(pricelistIds=>{return this.model.makeRecord('report.product.report_pricelist',[{name:'pricelist_id',type:'many2one',relation:'product.pricelist',value:pricelistIds[0],}]);}).then(recordID=>{const record=this.model.get(recordID);this.many2one=new FieldMany2One(this,'pricelist_id',record,{mode:'edit',attrs:{can_create:false,can_write:false,options:{no_open:true},},});this._registerWidget(recordID,'pricelist_id',this.many2one);});return Promise.all([fieldSetup,this._getHtml(),this._super()]);},start:function(){this.controlPanelProps.cp_content=this._renderComponent();return this._super.apply(this,arguments).then(()=>{this.$('.o_content').html(this.reportHtml);});},getState:function(){return{active_model:this.context.active_model,};},getTitle:function(){return _t('Pricelist Report');},_getHtml:function(){return this._rpc({model:'report.product.report_pricelist',method:'get_html',kwargs:{context:this.context},}).then(result=>{this.reportHtml=result;});},_reload:function(){return this._getHtml().then(()=>{this.$('.o_content').html(this.reportHtml);});},_renderComponent:function(){const $buttons=$('<button>',{class:'btn btn-primary',text:_t("Print"),}).on('click',this._onClickPrint.bind(this));const $searchview=$(QWeb.render('product.report_pricelist_search'));this.many2one.appendTo($searchview.find('.o_pricelist'));this.qtyTagWidget=new QtyTagWidget(this,this.context.quantities);this.qtyTagWidget.replace($searchview.find('.o_product_qty'));return{$buttons,$searchview};},_onClickAction:function(ev){ev.preventDefault();this.do_action({type:'ir.actions.act_window',res_model:$(ev.currentTarget).data('model'),res_id:$(ev.currentTarget).data('res-id'),views:[[false,'form']],target:'self',});},_onClickPrint:function(){const reportName=_.str.sprintf('product.report_pricelist?active_model=%s&active_ids=%s&pricelist_id=%s&quantities=%s',this.context.active_model,this.context.active_ids||'',this.context.pricelist_id||'',this.context.quantities.toString()||'1',);return this.do_action({type:'ir.actions.report',report_type:'qweb-pdf',report_name:reportName,report_file:'product.report_pricelist',});},_onFieldChanged:function(event){this.context.pricelist_id=event.data.changes.pricelist_id.id;StandaloneFieldManagerMixin._onFieldChanged.apply(this,arguments);this._reload();},_onQtyChanged:function(ev){this.context.quantities=ev.data.quantities;this._reload();},_onSubmitForm:function(ev){ev.preventDefault();ev.stopPropagation();this.qtyTagWidget._onClickAddQty();},});core.action_registry.add('generate_pricelist',GeneratePriceList);return{GeneratePriceList,QtyTagWidget};});;

/* /partner_autocomplete/static/src/js/partner_autocomplete_core.js defined in bundle 'web.assets_backend' */
odoo.define('partner.autocomplete.Mixin',function(require){'use strict';var concurrency=require('web.concurrency');var core=require('web.core');var Qweb=core.qweb;var utils=require('web.utils');var _t=core._t;var PartnerAutocompleteMixin={_dropPreviousOdoo:new concurrency.DropPrevious(),_dropPreviousClearbit:new concurrency.DropPrevious(),_timeout:1000,_autocomplete:function(value){var self=this;value=value.trim();var isVAT=this._isVAT(value);var odooSuggestions=[];var clearbitSuggestions=[];return new Promise(function(resolve,reject){var odooPromise=self._getOdooSuggestions(value,isVAT).then(function(suggestions){odooSuggestions=suggestions;});var clearbitPromise=isVAT?false:self._getClearbitSuggestions(value).then(function(suggestions){clearbitSuggestions=suggestions;});var concatResults=function(){if(clearbitSuggestions&&clearbitSuggestions.length){var websites=odooSuggestions.map(function(suggestion){return suggestion.website;});clearbitSuggestions.forEach(function(suggestion){if(websites.indexOf(suggestion.domain)<0){websites.push(suggestion.domain);odooSuggestions.push(suggestion);}});}
odooSuggestions=_.filter(odooSuggestions,function(suggestion){return!suggestion.ignored;});_.each(odooSuggestions,function(suggestion){delete suggestion.ignored;});return resolve(odooSuggestions);};self._whenAll([odooPromise,clearbitPromise]).then(concatResults,concatResults);});},_enrichCompany:function(company){return this._rpc({model:'res.partner',method:'enrich_company',args:[company.website,company.partner_gid,company.vat],});},_getCompanyLogo:function(url){return this._getBase64Image(url).then(function(base64Image){return base64Image?base64Image.replace(/^data:image[^;]*;base64,?/,''):false;}).catch(function(){return false;});},_getCreateData:function(company){var self=this;var removeUselessFields=function(company){var fields='label,description,domain,logo,legal_name,ignored,email'.split(',');fields.forEach(function(field){delete company[field];});var notEmptyFields="country_id,state_id".split(',');notEmptyFields.forEach(function(field){if(!company[field])delete company[field];});};return new Promise(function(resolve){var enrichPromise=self._enrichCompany(company);var logoPromise=company.logo?self._getCompanyLogo(company.logo):false;self._whenAll([enrichPromise,logoPromise]).then(function(result){var company_data=result[0];var logo_data=result[1];if(company_data.error&&company_data.vat){company.vat=company_data.vat;}
if(company_data.error){if(company_data.error_message==='Insufficient Credit'){self._notifyNoCredits();}else if(company_data.error_message==='No Account Token'){self._notifyAccountToken();}else{self.do_notify(false,company_data.error_message);}
company_data=company;}
if(_.isEmpty(company_data)){company_data=company;}
removeUselessFields(company_data);if(company.vat){company_data.vat=company.vat;}
resolve({company:company_data,logo:logo_data});});});},_isOnline:function(){return navigator&&navigator.onLine;},_validateSearchTerm:function(search_val,onlyVAT){if(onlyVAT)return this._isVAT(search_val);else return search_val&&search_val.length>2;},_getBase64Image:function(url){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest();xhr.onload=function(){utils.getDataURLFromFile(xhr.response).then(resolve);};xhr.open('GET',url);xhr.responseType='blob';xhr.onerror=reject;xhr.send();});},_getClearbitSuggestions:function(value){var url='https://autocomplete.clearbit.com/v1/companies/suggest?query='+value;var def=$.ajax({url:url,dataType:'json',timeout:this._timeout,success:function(suggestions){suggestions.map(function(suggestion){suggestion.label=suggestion.name;suggestion.website=suggestion.domain;suggestion.description=suggestion.website;return suggestion;});return suggestions;},});return this._dropPreviousClearbit.add(def);},_getOdooSuggestions:function(value,isVAT){var method=isVAT?'read_by_vat':'autocomplete';var def=this._rpc({model:'res.partner',method:method,args:[value],},{shadow:true,}).then(function(suggestions){suggestions.map(function(suggestion){suggestion.logo=suggestion.logo||'';suggestion.label=suggestion.legal_name||suggestion.name;if(suggestion.vat)suggestion.description=suggestion.vat;else if(suggestion.website)suggestion.description=suggestion.website;if(suggestion.country_id&&suggestion.country_id.display_name){if(suggestion.description)suggestion.description+=_.str.sprintf(' (%s)',suggestion.country_id.display_name);else suggestion.description+=suggestion.country_id.display_name;}
return suggestion;});return suggestions;});return this._dropPreviousOdoo.add(def);},_isVAT:function(search_val){var str=this._sanitizeVAT(search_val);return checkVATNumber(str);},_sanitizeVAT:function(search_value){return search_value?search_value.replace(/[^A-Za-z0-9]/g,''):'';},_whenAll:function(promises){return Promise.all(promises.map(function(p){return Promise.resolve(p);}));},_notifyNoCredits:function(){var self=this;return this._rpc({model:'iap.account',method:'get_credits_url',args:['partner_autocomplete'],}).then(function(url){var title=_t('Not enough credits for Partner Autocomplete');var content=Qweb.render('partner_autocomplete.insufficient_credit_notification',{credits_url:url});self.do_notify(title,content,false,'o_partner_autocomplete_no_credits_notify');});},_notifyAccountToken:function(){var self=this;return this._rpc({model:'iap.account',method:'get_config_account_url',args:[]}).then(function(url){var title=_t('IAP Account Token missing');if(url){var content=Qweb.render('partner_autocomplete.account_token',{account_url:url});self.do_notify(title,content,false,'o_partner_autocomplete_no_credits_notify');}
else{self.do_notify(title);}});},};return PartnerAutocompleteMixin;});;

/* /partner_autocomplete/static/src/js/partner_autocomplete_fieldchar.js defined in bundle 'web.assets_backend' */
odoo.define('partner.autocomplete.fieldchar',function(require){'use strict';var basic_fields=require('web.basic_fields');var core=require('web.core');var field_registry=require('web.field_registry');var AutocompleteMixin=require('partner.autocomplete.Mixin');var QWeb=core.qweb;var FieldChar=basic_fields.FieldChar;var FieldAutocomplete=FieldChar.extend(AutocompleteMixin,{className:'o_field_partner_autocomplete',debounceSuggestions:400,resetOnAnyFieldChange:true,jsLibs:['/partner_autocomplete/static/lib/jsvat.js'],events:_.extend({},FieldChar.prototype.events,{'keyup':'_onKeyup','mousedown .o_partner_autocomplete_suggestion':'_onMousedown','focusout':'_onFocusout','mouseenter .o_partner_autocomplete_suggestion':'_onHoverDropdown','click .o_partner_autocomplete_suggestion':'_onSuggestionClicked',}),init:function(){this._super.apply(this,arguments);this.onlyVAT=this.name==='vat';if(this.mode==='edit'){this.tagName='div';this.className+=' dropdown open';}
if(this.debounceSuggestions>0){this._suggestCompanies=_.debounce(this._suggestCompanies.bind(this),this.debounceSuggestions);}},_isActive:function(){return this.model==='res.company'||(this.model==='res.partner'&&this.record.data.is_company&&!(this.record.data&&this.record.data.id));},_removeDropdown:function(){if(this.$dropdown){this.$dropdown.remove();this.$dropdown=undefined;}},_renderEdit:function(){this.$el.empty();this._prepareInput().appendTo(this.$el);},_selectCompany:function(company){var self=this;this._getCreateData(company).then(function(data){if(data.logo){var logoField=self.model==='res.partner'?'image_1920':'logo';data.company[logoField]=data.logo;}
if(self.model==='res.company'){var fields='comment,child_ids,bank_ids,additional_info'.split(',');fields.forEach(function(field){delete data.company[field];});}
self._setOne2ManyField('bank_ids',data.company.bank_ids);delete data.company.bank_ids;self.trigger_up('field_changed',{dataPointID:self.dataPointID,changes:data.company,onSuccess:function(){if(self.onlyVAT)
self.$input.val(self._formatValue(company.vat));else
self.$input.val(self._formatValue(company.name));},});});this._removeDropdown();},_setOne2ManyField:function(field,list){var self=this;var viewType=this.record.viewType;if(list&&this.record.fieldsInfo[viewType]&&this.record.fieldsInfo[viewType][field]){list.forEach(function(item){var changes={};changes[field]={operation:'CREATE',data:item,};self.trigger_up('field_changed',{dataPointID:self.dataPointID,changes:changes,});});}},_showDropdown:function(){this._removeDropdown();if(this.suggestions.length>0){this.$dropdown=$(QWeb.render('partner_autocomplete.dropdown',{suggestions:this.suggestions,}));this.$dropdown.appendTo(this.$el);}},_suggestCompanies:function(value){var self=this;if(this._validateSearchTerm(value,this.onlyVAT)&&this._isOnline()){return this._autocomplete(value).then(function(suggestions){if(suggestions&&suggestions.length){self.suggestions=suggestions;self._showDropdown();}else{self._removeDropdown();}});}else{this._removeDropdown();}},_onFocusout:function(){this._removeDropdown();},_onHoverDropdown:function(e){this.$dropdown.find('.active').removeClass('active');$(e.currentTarget).parent().addClass('active');},_onInput:function(){this._super.apply(this,arguments);if(this._isActive()){this._suggestCompanies(this.$input.val());}},_onKeydown:function(e){switch(e.which){case $.ui.keyCode.UP:case $.ui.keyCode.DOWN:if(!this.$dropdown){break;}
e.preventDefault();var $suggestions=this.$dropdown.children();var $active=$suggestions.filter('.active');var $to;if($active.length){$to=e.which===$.ui.keyCode.DOWN?$active.next():$active.prev();}else{$to=$suggestions.first();}
if($to.length){$active.removeClass('active');$to.addClass('active');}
return;}
this._super.apply(this,arguments);},_onKeyup:function(e){switch(e.which){case $.ui.keyCode.ESCAPE:e.preventDefault();this._removeDropdown();break;case $.ui.keyCode.ENTER:if(!this.$dropdown){break;}
e.preventDefault();var $active=this.$dropdown.find('.o_partner_autocomplete_suggestion.active');if(!$active.length){return;}
this._selectCompany(this.suggestions[$active.data('index')]);break;}},_onMousedown:function(e){e.preventDefault();},_onSuggestionClicked:function(e){e.preventDefault();this._selectCompany(this.suggestions[$(e.currentTarget).data('index')]);},});field_registry.add('field_partner_autocomplete',FieldAutocomplete);return FieldAutocomplete;});;

/* /partner_autocomplete/static/src/js/partner_autocomplete_many2one.js defined in bundle 'web.assets_backend' */
odoo.define('partner.autocomplete.many2one',function(require){'use strict';var FieldMany2One=require('web.relational_fields').FieldMany2One;var core=require('web.core');var AutocompleteMixin=require('partner.autocomplete.Mixin');var field_registry=require('web.field_registry');var _t=core._t;var PartnerField=FieldMany2One.extend(AutocompleteMixin,{jsLibs:['/partner_autocomplete/static/lib/jsvat.js'],init:function(){this._super.apply(this,arguments);this._addAutocompleteSource(this._searchSuggestions,{placeholder:_t('Searching Autocomplete...'),order:20,validation:this._validateSearchTerm,});this.additionalContext['show_vat']=true;},_createPartner:function(company){var self=this;self.$('input').val('');return self._getCreateData(company).then(function(data){var context={'default_is_company':true};_.each(data.company,function(val,key){context['default_'+key]=val&&val.id?val.id:val;});if(data.logo)context.default_image_1920=data.logo;return self._searchCreatePopup("form",false,context);});},_getDisplayNameWithoutVAT:function(value){return value.split('  ')[0];},_modifyAutompleteRendering:function(){var api=this.$input.data('ui-autocomplete');if(!api){return;}
api._renderItem=function(ul,item){ul.addClass('o_partner_autocomplete_dropdown');var $a=$('<a/>')["html"](item.label);if(item.logo){var $img=$('<img/>').attr('src',item.logo);$a.append($img);}
return $("<li></li>").data("item.autocomplete",item).append($a).appendTo(ul).addClass(item.classname);};},_renderEdit:function(){this.m2o_value=this._getDisplayNameWithoutVAT(this.m2o_value);this._super.apply(this,arguments);this._modifyAutompleteRendering();},_searchSuggestions:function(search_val){var self=this;return new Promise(function(resolve,reject){if(self._isOnline()){self._autocomplete(search_val).then(function(suggestions){var choices=[];if(suggestions&&suggestions.length){_.each(suggestions,function(suggestion){var label='<i class="fa fa-magic text-muted"/> ';label+=_.str.sprintf('%s, <span class="text-muted">%s</span>',suggestion.label,suggestion.description);choices.push({label:label,action:function(){self._createPartner(suggestion);},logo:suggestion.logo,classname:'o_partner_autocomplete_dropdown_item',});});}
resolve(choices);});}else{resolve([]);}});},});field_registry.add('res_partner_many2one',PartnerField);return PartnerField;});;

/* /sms/static/src/js/fields_phone_widget.js defined in bundle 'web.assets_backend' */
odoo.define('sms.fields',function(require){"use strict";var basic_fields=require('web.basic_fields');var core=require('web.core');var session=require('web.session');var _t=core._t;var Phone=basic_fields.FieldPhone;Phone.include({init(){this._super.apply(this,arguments);this.enableSMS='enable_sms'in this.attrs.options?this.attrs.options.enable_sms:true;this.attrs.options.enable_sms=this.enableSMS;},getFocusableElement(){if(this.enableSMS&&this.mode==='readonly'){return this.$el.filter('.'+this.className);}
return this._super.apply(this,arguments);},_onClickSMS:function(ev){ev.preventDefault();ev.stopPropagation();var context=session.user_context;context=_.extend({},context,{default_res_model:this.model,default_res_id:parseInt(this.res_id),default_number_field_name:this.name,default_composition_mode:'comment',});var self=this;return this.do_action({title:_t('Send SMS Text Message'),type:'ir.actions.act_window',res_model:'sms.composer',target:'new',views:[[false,'form']],context:context,},{on_close:function(){self.trigger_up('reload');}});},_renderReadonly:function(){var def=this._super.apply(this,arguments);if(this.enableSMS&&this.value){var $composerButton=$('<a>',{title:_t('Send SMS Text Message'),href:'',class:'ml-3 d-inline-flex align-items-center o_field_phone_sms',html:$('<small>',{class:'font-weight-bold ml-1',html:'SMS'}),});$composerButton.prepend($('<i>',{class:'fa fa-mobile'}));$composerButton.on('click',this._onClickSMS.bind(this));this.$el=this.$el.add($composerButton);}
return def;},});return Phone;});;

/* /sms/static/src/js/fields_sms_widget.js defined in bundle 'web.assets_backend' */
odoo.define('sms.sms_widget',function(require){"use strict";var core=require('web.core');var fieldRegistry=require('web.field_registry');var FieldTextEmojis=require('mail.field_text_emojis');var _t=core._t;var SmsWidget=FieldTextEmojis.extend({className:'o_field_text',enableEmojis:false,init:function(){this._super.apply(this,arguments);this.nbrChar=0;this.nbrSMS=0;this.encoding='GSM7';this.enableEmojis=!!this.nodeOptions.enable_emojis;},on_attach_callback:function(){if(this.enableEmojis){this._super.apply(this,arguments);}},_renderEdit:function(){var def=this._super.apply(this,arguments);this._compute();$('.o_sms_container').remove();var $sms_container=$('<div class="o_sms_container"/>');$sms_container.append(this._renderSMSInfo());$sms_container.append(this._renderIAPButton());this.$el=this.$el.add($sms_container);return def;},_compute:function(){var content=this._getValue();this.encoding=this._extractEncoding(content);this.nbrChar=content.length;this.nbrChar+=(content.match(/\n/g)||[]).length;this.nbrSMS=this._countSMS(this.nbrChar,this.encoding);},_countSMS:function(){if(this.nbrChar===0){return 0;}
if(this.encoding==='UNICODE'){if(this.nbrChar<=70){return 1;}
return Math.ceil(this.nbrChar/67);}
if(this.nbrChar<=160){return 1;}
return Math.ceil(this.nbrChar/153);},_extractEncoding:function(content){if(String(content).match(RegExp("^[@$\\n\\r_ !\\\"#%&'()*+,-./0123456789:;<=>?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz]*$"))){return'GSM7';}
return'UNICODE';},_renderIAPButton:function(){return $('<a>',{'href':'https://iap-services.odoo.com/iap/sms/pricing','target':'_blank','title':_t('SMS Pricing'),'aria-label':_t('SMS Pricing'),'class':'fa fa-lg fa-info-circle',});},_renderSMSInfo:function(){var string=_.str.sprintf(_t('%s characters, fits in %s SMS (%s) '),this.nbrChar,this.nbrSMS,this.encoding);var $span=$('<span>',{'class':'text-muted o_sms_count',});$span.text(string);return $span;},_updateSMSInfo:function(){this._compute();var string=_.str.sprintf(_t('%s characters, fits in %s SMS (%s) '),this.nbrChar,this.nbrSMS,this.encoding);this.$('.o_sms_count').text(string);},_onBlur:function(){var content=this._getValue();if(!content.trim().length&&content.length>0){this.do_warn(_t("Your SMS Text Message must include at least one non-whitespace character"));this.$input.val(content.trim());this._updateSMSInfo();}},_onChange:function(){this._super.apply(this,arguments);this._updateSMSInfo();},_onInput:function(){this._super.apply(this,arguments);this._updateSMSInfo();},});fieldRegistry.add('sms_widget',SmsWidget);return SmsWidget;});;

/* /sms/static/src/bugfix/bugfix.js defined in bundle 'web.assets_backend' */
odoo.define('sms/static/src/bugfix/bugfix.js',function(require){'use strict';});;

/* /sms/static/src/components/notification_group/notification_group.js defined in bundle 'web.assets_backend' */
odoo.define('sms/static/src/components/notification_group/notification_group.js',function(require){'use strict';const components={NotificationGroup:require('mail/static/src/components/notification_group/notification_group.js'),};const{patch}=require('web.utils');patch(components.NotificationGroup,'sms/static/src/components/notification_group/notification_group.js',{image(){if(this.group.notification_type==='sms'){return'/sms/static/img/sms_failure.svg';}
return this._super(...arguments);},});});;

/* /sms/static/src/models/message/message.js defined in bundle 'web.assets_backend' */
odoo.define('sms/static/src/models/message/message.js',function(require){'use strict';const{registerInstancePatchModel,}=require('mail/static/src/model/model_core.js');registerInstancePatchModel('mail.message','sms/static/src/models/message/message.js',{openResendAction(){if(this.message_type==='sms'){this.env.bus.trigger('do-action',{action:'sms.sms_resend_action',options:{additional_context:{default_mail_message_id:this.id,},},});}else{this._super(...arguments);}},});});;

/* /sms/static/src/models/notification_group/notification_group.js defined in bundle 'web.assets_backend' */
odoo.define('sms/static/src/models/notification_group/notification_group.js',function(require){'use strict';const{registerInstancePatchModel,}=require('mail/static/src/model/model_core.js');registerInstancePatchModel('mail.notification_group','sms/static/src/models/notification_group/notification_group.js',{openCancelAction(){if(this.notification_type!=='sms'){return this._super(...arguments);}
this.env.bus.trigger('do-action',{action:'sms.sms_cancel_action',options:{additional_context:{default_model:this.res_model,unread_counter:this.notifications.length,},},});},_openDocuments(){if(this.notification_type!=='sms'){return this._super(...arguments);}
this.env.bus.trigger('do-action',{action:{name:this.env._t("SMS Failures"),type:'ir.actions.act_window',view_mode:'kanban,list,form',views:[[false,'kanban'],[false,'list'],[false,'form']],target:'current',res_model:this.res_model,domain:[['message_has_sms_error','=',true]],},});if(this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}},});});;

/* /snailmail/static/src/bugfix/bugfix.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/bugfix/bugfix.js',function(require){'use strict';});;

/* /snailmail/static/src/components/message/message.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/components/message/message.js',function(require){'use strict';const components={Message:require('mail/static/src/components/message/message.js'),SnailmailErrorDialog:require('snailmail/static/src/components/snailmail_error_dialog/snailmail_error_dialog.js'),SnailmailNotificationPopover:require('snailmail/static/src/components/snailmail_notification_popover/snailmail_notification_popover.js'),};const{patch}=require('web.utils');const{useState}=owl;Object.assign(components.Message.components,{SnailmailErrorDialog:components.SnailmailErrorDialog,SnailmailNotificationPopover:components.SnailmailNotificationPopover,});patch(components.Message,'snailmail/static/src/components/message/message.js',{_constructor(){this._super(...arguments);this.snailmailState=useState({hasDialog:false,});},_onClickFailure(){if(this.message.message_type==='snailmail'){switch(this.message.notifications[0].failure_type){case'sn_credit':this.env.messaging.fetchSnailmailCreditsUrl();this.snailmailState.hasDialog=true;break;case'sn_error':this.snailmailState.hasDialog=true;break;case'sn_fields':this.message.openMissingFieldsLetterAction();break;case'sn_format':this.message.openFormatLetterAction();break;case'sn_price':this.snailmailState.hasDialog=true;break;case'sn_trial':this.env.messaging.fetchSnailmailCreditsUrlTrial();this.snailmailState.hasDialog=true;break;}}else{this._super(...arguments);}},_onDialogClosedSnailmailError(){this.snailmailState.hasDialog=false;},});});;

/* /snailmail/static/src/components/notification_group/notification_group.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/components/notification_group/notification_group.js',function(require){'use strict';const components={NotificationGroup:require('mail/static/src/components/notification_group/notification_group.js'),};const{patch}=require('web.utils');patch(components.NotificationGroup,'snailmail/static/src/components/notification_group/notification_group.js',{image(){if(this.group.notification_type==='snail'){return'/snailmail/static/img/snailmail_failure.png';}
return this._super(...arguments);},});});;

/* /snailmail/static/src/components/snailmail_error_dialog/snailmail_error_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/components/snailmail_error_dialog/snailmail_error_dialog.js',function(require){'use strict';const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');const Dialog=require('web.OwlDialog');const{Component}=owl;const{useRef}=owl.hooks;class SnailmailErrorDialog extends Component{constructor(...args){super(...args);useStore(props=>{const message=this.env.models['mail.message'].get(props.messageLocalId);const notifications=message?message.notifications:[];return{message:message?message.__state:undefined,notifications:notifications.map(notification=>notification?notification.__state:undefined),snailmail_credits_url:this.env.messaging.snailmail_credits_url,snailmail_credits_url_trial:this.env.messaging.snailmail_credits_url_trial,};},{compareDepth:{notifications:1,},});this._dialogRef=useRef('dialog');}
get hasCreditsError(){return(this.notification.failure_type==='sn_credit'||this.notification.failure_type==='sn_trial');}
get message(){return this.env.models['mail.message'].get(this.props.messageLocalId);}
get notification(){return this.message.notifications[0];}
get title(){return this.env._t("Failed letter");}
_onClickCancelLetter(){this._dialogRef.comp._close();this.message.cancelLetter();}
_onClickClose(){this._dialogRef.comp._close();}
_onClickResendLetter(){this._dialogRef.comp._close();this.message.resendLetter();}}
Object.assign(SnailmailErrorDialog,{components:{Dialog},props:{messageLocalId:String,},template:'snailmail.SnailmailErrorDialog',});return SnailmailErrorDialog;});;

/* /snailmail/static/src/components/snailmail_notification_popover/snailmail_notification_popover.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/components/snailmail_notification_popover/snailmail_notification_popover.js',function(require){'use strict';const{Component}=owl;const useStore=require('mail/static/src/component_hooks/use_store/use_store.js');class SnailmailNotificationPopover extends Component{constructor(...args){super(...args);useStore(props=>{const message=this.env.models['mail.message'].get(props.messageLocalId);const notifications=message?message.notifications:[];return{message:message?message.__state:undefined,notifications:notifications.map(notification=>notification?notification.__state:undefined),};},{compareDepth:{notifications:1,},});}
get iconClass(){switch(this.notification.notification_status){case'sent':return'fa fa-check';case'ready':return'fa fa-clock-o';case'canceled':return'fa fa-trash-o';default:return'fa fa-exclamation text-danger';}}
get iconTitle(){switch(this.notification.notification_status){case'sent':return this.env._t("Sent");case'ready':return this.env._t("Awaiting Dispatch");case'canceled':return this.env._t("Canceled");default:return this.env._t("Error");}}
get message(){return this.env.models['mail.message'].get(this.props.messageLocalId);}
get notification(){return this.message.notifications[0];}}
Object.assign(SnailmailNotificationPopover,{props:{messageLocalId:String,},template:'snailmail.SnailmailNotificationPopover',});return SnailmailNotificationPopover;});;

/* /snailmail/static/src/models/message/message.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/models/message.message.js',function(require){'use strict';const{registerInstancePatchModel}=require('mail/static/src/model/model_core.js');registerInstancePatchModel('mail.message','snailmail/static/src/models/message.message.js',{async cancelLetter(){await this.async(()=>this.env.services.rpc({model:'mail.message',method:'cancel_letter',args:[[this.id]],}));},openFormatLetterAction(){this.env.bus.trigger('do-action',{action:'snailmail.snailmail_letter_format_error_action',options:{additional_context:{message_id:this.id,},},});},async openMissingFieldsLetterAction(){const letterIds=await this.async(()=>this.env.services.rpc({model:'snailmail.letter',method:'search',args:[[['message_id','=',this.id]]],}));this.env.bus.trigger('do-action',{action:'snailmail.snailmail_letter_missing_required_fields_action',options:{additional_context:{default_letter_id:letterIds[0],},},});},async resendLetter(){await this.async(()=>this.env.services.rpc({model:'mail.message',method:'send_letter',args:[[this.id]],}));},});});;

/* /snailmail/static/src/models/messaging/messaging.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/models/messaging/messaging.js',function(require){'use strict';const{registerInstancePatchModel,registerFieldPatchModel,}=require('mail/static/src/model/model_core.js');const{attr}=require('mail/static/src/model/model_field.js');registerInstancePatchModel('mail.messaging','snailmail/static/src/models/messaging/messaging.js',{async fetchSnailmailCreditsUrl(){const snailmail_credits_url=await this.async(()=>this.env.services.rpc({model:'iap.account',method:'get_credits_url',args:['snailmail'],}));this.update({snailmail_credits_url,});},async fetchSnailmailCreditsUrlTrial(){const snailmail_credits_url_trial=await this.async(()=>this.env.services.rpc({model:'iap.account',method:'get_credits_url',args:['snailmail','',0,true],}));this.update({snailmail_credits_url_trial,});},});registerFieldPatchModel('mail.messaging','snailmail/static/src/models/messaging/messaging.js',{snailmail_credits_url:attr(),snailmail_credits_url_trial:attr(),});});;

/* /snailmail/static/src/models/notification_group/notification_group.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail/static/src/models/notification_group/notification_group.js',function(require){'use strict';const{registerInstancePatchModel,}=require('mail/static/src/model/model_core.js');registerInstancePatchModel('mail.notification_group','snailmail/static/src/models/notification_group/notification_group.js',{openCancelAction(){if(this.notification_type!=='snail'){return this._super(...arguments);}
this.env.bus.trigger('do-action',{action:'snailmail.snailmail_letter_cancel_action',options:{additional_context:{default_model:this.res_model,unread_counter:this.notifications.length,},},});},_openDocuments(){if(this.notification_type!=='snail'){return this._super(...arguments);}
this.env.bus.trigger('do-action',{action:{name:this.env._t("Snailmail Failures"),type:'ir.actions.act_window',view_mode:'kanban,list,form',views:[[false,'kanban'],[false,'list'],[false,'form']],target:'current',res_model:this.res_model,domain:[['message_ids.snailmail_error','=',true]],},});if(this.env.messaging.device.isMobile){this.env.messaging.messagingMenu.close();}},});});;

/* /account/static/src/js/account_payment_field.js defined in bundle 'web.assets_backend' */
odoo.define('account.payment',function(require){"use strict";var AbstractField=require('web.AbstractField');var core=require('web.core');var field_registry=require('web.field_registry');var field_utils=require('web.field_utils');var QWeb=core.qweb;var _t=core._t;var ShowPaymentLineWidget=AbstractField.extend({events:_.extend({'click .outstanding_credit_assign':'_onOutstandingCreditAssign',},AbstractField.prototype.events),supportedFieldTypes:['char'],isSet:function(){return true;},_render:function(){var self=this;var info=JSON.parse(this.value);if(!info){this.$el.html('');return;}
_.each(info.content,function(k,v){k.index=v;k.amount=field_utils.format.float(k.amount,{digits:k.digits});if(k.date){k.date=field_utils.format.date(field_utils.parse.date(k.date,{},{isUTC:true}));}});this.$el.html(QWeb.render('ShowPaymentInfo',{lines:info.content,outstanding:info.outstanding,title:info.title}));_.each(this.$('.js_payment_info'),function(k,v){var isRTL=_t.database.parameters.direction==="rtl";var content=info.content[v];var options={content:function(){var $content=$(QWeb.render('PaymentPopOver',content));var unreconcile_button=$content.filter('.js_unreconcile_payment').on('click',self._onRemoveMoveReconcile.bind(self));$content.filter('.js_open_payment').on('click',self._onOpenPayment.bind(self));return $content;},html:true,placement:isRTL?'bottom':'left',title:'Payment Information',trigger:'focus',delay:{"show":0,"hide":100},container:$(k).parent(),};$(k).popover(options);});},_onOpenPayment:function(event){var paymentId=parseInt($(event.target).attr('payment-id'));var moveId=parseInt($(event.target).attr('move-id'));var res_model;var id;if(paymentId!==undefined&&!isNaN(paymentId)){res_model="account.payment";id=paymentId;}else if(moveId!==undefined&&!isNaN(moveId)){res_model="account.move";id=moveId;}
if(res_model&&id){this.do_action({type:'ir.actions.act_window',res_model:res_model,res_id:id,views:[[false,'form']],target:'current'});}},_onOutstandingCreditAssign:function(event){event.stopPropagation();event.preventDefault();var self=this;var id=$(event.target).data('id')||false;this._rpc({model:'account.move',method:'js_assign_outstanding_line',args:[JSON.parse(this.value).move_id,id],}).then(function(){self.trigger_up('reload');});},_onRemoveMoveReconcile:function(event){var self=this;var moveId=parseInt($(event.target).attr('move-id'));var partialId=parseInt($(event.target).attr('partial-id'));if(partialId!==undefined&&!isNaN(partialId)){this._rpc({model:'account.move',method:'js_remove_outstanding_partial',args:[moveId,partialId],}).then(function(){self.trigger_up('reload');});}},});field_registry.add('payment',ShowPaymentLineWidget);return{ShowPaymentLineWidget:ShowPaymentLineWidget};});;

/* /account/static/src/js/account_resequence_field.js defined in bundle 'web.assets_backend' */
odoo.define('account.ShowResequenceRenderer',function(require){"use strict";const{Component}=owl;const{useState}=owl.hooks;const AbstractFieldOwl=require('web.AbstractFieldOwl');const field_registry=require('web.field_registry_owl');class ChangeLine extends Component{}
ChangeLine.template='account.ResequenceChangeLine';ChangeLine.props=["changeLine",'ordering'];class ShowResequenceRenderer extends AbstractFieldOwl{constructor(...args){super(...args);this.data=this.value?JSON.parse(this.value):{changeLines:[],ordering:'date',};}
async willUpdateProps(nextProps){await super.willUpdateProps(nextProps);Object.assign(this.data,JSON.parse(this.value));}}
ShowResequenceRenderer.template='account.ResequenceRenderer';ShowResequenceRenderer.components={ChangeLine}
field_registry.add('account_resequence_widget',ShowResequenceRenderer);return ShowResequenceRenderer;});;

/* /account/static/src/js/grouped_view_widget.js defined in bundle 'web.assets_backend' */
odoo.define('account.ShowGroupedList',function(require){"use strict";const{Component}=owl;const{useState}=owl.hooks;const AbstractFieldOwl=require('web.AbstractFieldOwl');const field_registry=require('web.field_registry_owl');class ListItem extends Component{}
ListItem.template='account.GroupedItemTemplate';ListItem.props=["item_vals","options"];class ListGroup extends Component{}
ListGroup.template='account.GroupedItemsTemplate';ListGroup.components={ListItem}
ListGroup.props=["group_vals","options"];class ShowGroupedList extends AbstractFieldOwl{constructor(...args){super(...args);this.data=this.value?JSON.parse(this.value):{groups_vals:[],options:{discarded_number:'',columns:[],},};}
async willUpdateProps(nextProps){await super.willUpdateProps(nextProps);Object.assign(this.data,JSON.parse(this.value));}}
ShowGroupedList.template='account.GroupedListTemplate';ShowGroupedList.components={ListGroup}
field_registry.add('grouped_view_widget',ShowGroupedList);return ShowGroupedList;});;

/* /account/static/src/js/mail_activity.js defined in bundle 'web.assets_backend' */
odoo.define('account.activity',function(require){"use strict";var AbstractField=require('web.AbstractField');var core=require('web.core');var field_registry=require('web.field_registry');var QWeb=core.qweb;var _t=core._t;var VatActivity=AbstractField.extend({className:'o_journal_activity_kanban',events:{'click .see_all_activities':'_onOpenAll','click .see_activity':'_onOpenActivity',},init:function(){this.MAX_ACTIVITY_DISPLAY=5;this._super.apply(this,arguments);},_render:function(){var self=this;var info=JSON.parse(this.value);if(!info){this.$el.html('');return;}
info.more_activities=false;if(info.activities.length>this.MAX_ACTIVITY_DISPLAY){info.more_activities=true;info.activities=info.activities.slice(0,this.MAX_ACTIVITY_DISPLAY);}
this.$el.html(QWeb.render('accountJournalDashboardActivity',info));},_onOpenActivity:function(e){e.preventDefault();var self=this;self.do_action({type:'ir.actions.act_window',name:_t('Journal Entry'),target:'current',res_id:$(e.target).data('resId'),res_model:'account.move',views:[[false,'form']],});},_onOpenAll:function(e){e.preventDefault();var self=this;self.do_action({type:'ir.actions.act_window',name:_t('Journal Entries'),res_model:'account.move',views:[[false,'kanban'],[false,'form']],search_view_id:[false],domain:[['journal_id','=',self.res_id],['activity_ids','!=',false]],});}})
field_registry.add('kanban_vat_activity',VatActivity);return VatActivity;});;

/* /account/static/src/js/tax_group.js defined in bundle 'web.assets_backend' */
odoo.define('account.tax_group',function(require){"use strict";var core=require('web.core');var session=require('web.session');var fieldRegistry=require('web.field_registry');var AbstractField=require('web.AbstractField');var fieldUtils=require('web.field_utils');var QWeb=core.qweb;var TaxGroupCustomField=AbstractField.extend({events:{'click .tax_group_edit':'_onClick','keydown .oe_tax_group_editable .tax_group_edit_input input':'_onKeydown','blur .oe_tax_group_editable .tax_group_edit_input input':'_onBlur',},_changeTaxValueByTaxGroup:function(taxGroupId,deltaAmount){const self=this;function applyChange(line_id){let debitAmount=0;let creditAmount=0;let amount_currency=0;if(line_id.data.currency_id){if(self.record.data.move_type==="in_invoice"){amount_currency=line_id.data.amount_currency-deltaAmount;}else{amount_currency=line_id.data.amount_currency+deltaAmount;}}else{let balance=line_id.data.price_subtotal;balance-=deltaAmount;if(self.record.data.move_type==="in_invoice"){if(balance>0){debitAmount=balance;}else if(balance<0){creditAmount=-balance;}}else{if(balance>0){creditAmount=balance;}else if(balance<0){debitAmount=-balance;}}}
self.trigger_up('field_changed',{dataPointID:self.record.id,changes:{line_ids:{operation:"UPDATE",id:line_id.id,data:{amount_currency:amount_currency,debit:debitAmount,credit:creditAmount}}},initialEvent:{dataPointID:line_id.id,changes:{amount_currency:amount_currency,debit:debitAmount,credit:creditAmount},},});}
let line_id=self.record.data.line_ids.data.find(elem=>elem.data.tax_group_id&&elem.data.tax_group_id.data.id===taxGroupId);if(line_id){applyChange(line_id);}else{const{limit,id,count}=self.record.data.line_ids;let offset=count-limit;self.trigger_up('load',{id,limit,offset,on_success:value=>{line_id=value.data.find(elem=>elem.data.tax_group_id&&elem.data.tax_group_id.data.id===taxGroupId);applyChange(line_id);},});}},_isPurchaseDocument:function(){return this.record.data.move_type==="in_invoice"||this.record.data.move_type==='in_refund';},_render:function(){var self=this;var displayEditWidget=self._isPurchaseDocument()&&this.record.data.state==='draft'&&this.getParent().mode==='edit';this.$el.html($(QWeb.render('AccountTaxGroupTemplate',{lines:self.value,displayEditWidget:displayEditWidget,})));},_onBlur:function(ev){ev.preventDefault();var $input=$(ev.target);var newValue=$input.val();var currency=session.get_currency(this.record.data.currency_id.data.id);try{newValue=fieldUtils.parse.float(newValue);newValue=fieldUtils.format.float(newValue,null,{digits:currency.digits});newValue=fieldUtils.parse.float(newValue);}catch(err){$input.addClass('o_field_invalid');return;}
var oldValue=$input.data('originalValue');if(newValue===oldValue||newValue===0){return this._render();}
var taxGroupId=$input.parents('.oe_tax_group_editable').data('taxGroupId');this._changeTaxValueByTaxGroup(taxGroupId,oldValue-newValue);},_onClick:function(ev){ev.preventDefault();var $taxGroupElement=$(ev.target).parents('.oe_tax_group_editable');$taxGroupElement.find('.tax_group_edit').addClass('d-none');$taxGroupElement.find('.tax_group_edit_input').removeClass('d-none');var $input=$taxGroupElement.find('.tax_group_edit_input input');var formatedOriginalValue=fieldUtils.format.float($input.data('originalValue'),{},{});$input.focus();$input.val(formatedOriginalValue);},_onKeydown:function(ev){switch(ev.which){case $.ui.keyCode.ENTER:case $.ui.keyCode.TAB:$(ev.target).blur();}},});fieldRegistry.add('tax-group-custom-field',TaxGroupCustomField)});;

/* /account/static/src/js/bank_statement.js defined in bundle 'web.assets_backend' */
odoo.define('account.bank_statement',function(require){"use strict";var KanbanController=require("web.KanbanController");var ListController=require("web.ListController");var includeDict={renderButtons:function(){this._super.apply(this,arguments);if(this.modelName==="account.bank.statement"){var data=this.model.get(this.handle);if(data.context.journal_type!=='cash'){this.$buttons.find('button.o_button_import').hide();}}}};KanbanController.include(includeDict);ListController.include(includeDict);});;

/* /account/static/src/js/section_and_note_fields_backend.js defined in bundle 'web.assets_backend' */
odoo.define('account.section_and_note_backend',function(require){"use strict";var FieldChar=require('web.basic_fields').FieldChar;var FieldOne2Many=require('web.relational_fields').FieldOne2Many;var fieldRegistry=require('web.field_registry');var ListFieldText=require('web.basic_fields').ListFieldText;var ListRenderer=require('web.ListRenderer');var SectionAndNoteListRenderer=ListRenderer.extend({_renderBodyCell:function(record,node,index,options){var $cell=this._super.apply(this,arguments);var isSection=record.data.display_type==='line_section';var isNote=record.data.display_type==='line_note';if(isSection||isNote){if(node.attrs.widget==="handle"){return $cell;}else if(node.attrs.name==="name"){var nbrColumns=this._getNumberOfCols();if(this.handleField){nbrColumns--;}
if(this.addTrashIcon){nbrColumns--;}
$cell.attr('colspan',nbrColumns);}else{$cell.removeClass('o_invisible_modifier');return $cell.addClass('o_hidden');}}
return $cell;},_renderRow:function(record,index){var $row=this._super.apply(this,arguments);if(record.data.display_type){$row.addClass('o_is_'+record.data.display_type);}
return $row;},_renderView:function(){var self=this;return this._super.apply(this,arguments).then(function(){self.$('.o_list_table').addClass('o_section_and_note_list_view');});}});var SectionAndNoteFieldOne2Many=FieldOne2Many.extend({_getRenderer:function(){if(this.view.arch.tag==='tree'){return SectionAndNoteListRenderer;}
return this._super.apply(this,arguments);},});var SectionAndNoteFieldText=function(parent,name,record,options){var isSection=record.data.display_type==='line_section';var Constructor=isSection?FieldChar:ListFieldText;return new Constructor(parent,name,record,options);};fieldRegistry.add('section_and_note_one2many',SectionAndNoteFieldOne2Many);fieldRegistry.add('section_and_note_text',SectionAndNoteFieldText);return SectionAndNoteListRenderer;});;

/* /account/static/src/js/tours/account.js defined in bundle 'web.assets_backend' */
odoo.define('account.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;tour.register('account_tour',{url:"/web",sequence:60,},[...tour.stepUtils.goToAppSteps('account.menu_finance',_t('Send invoices to your customers in no time with the <b>Invoicing app</b>.')),{trigger:"a.o_onboarding_step_action[data-method=action_open_base_onboarding_company]",content:_t("Start by checking your company's data."),position:"bottom",},{trigger:"button[name=action_save_onboarding_company_step]",extra_trigger:"a.o_onboarding_step_action[data-method=action_open_base_onboarding_company]",content:_t("Looks good. Let's continue."),position:"bottom",},{trigger:"a.o_onboarding_step_action[data-method=action_open_base_document_layout]",content:_t("Customize your layout."),position:"bottom",},{trigger:"button[name=document_layout_save]",extra_trigger:"a.o_onboarding_step_action[data-method=action_open_base_document_layout]",content:_t("Once everything is as you want it, validate."),position:"top",},{trigger:"a.o_onboarding_step_action[data-method=action_open_account_onboarding_create_invoice]",content:_t("Now, we'll create your first invoice."),position:"bottom",},{trigger:"div[name=partner_id] input",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Write a company name to <b>create one</b> or <b>see suggestions</b>."),position:"bottom",},{trigger:".o_m2o_dropdown_option a:contains('Create')",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Select first partner"),auto:true,},{trigger:".modal-content button.btn-primary",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Once everything is set, you are good to continue. You will be able to edit this later in the <b>Customers</b> menu."),auto:true,},{trigger:"div[name=invoice_line_ids] .o_field_x2many_list_row_add a:not([data-context])",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Add a line to your invoice"),},{trigger:"div[name=invoice_line_ids] textarea[name=name]",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Fill in the details of the line."),position:"bottom",},{trigger:"div[name=invoice_line_ids] input[name=price_unit]",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Set a price"),position:"bottom",run:'text 100',},{trigger:"button[name=action_post]",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Once your invoice is ready, press CONFIRM."),},{trigger:"button[name=action_invoice_sent]",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Send the invoice and check what the customer will receive."),},{trigger:"input[name=email]",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Write here <b>your own email address</b> to test the flow."),run:'text customer@example.com',auto:true,},{trigger:".modal-content button.btn-primary",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Validate."),auto:true,},{trigger:"button[name=send_and_print_action]",extra_trigger:"[name=move_type][raw-value=out_invoice]",content:_t("Let's send the invoice."),position:"top"}]);});;

/* /account/static/src/js/bills_tree_upload.js defined in bundle 'web.assets_backend' */
odoo.define('account.upload.bill.mixin',function(require){"use strict";var core=require('web.core');var _t=core._t;var qweb=core.qweb;var UploadBillMixin={start:function(){this.fileUploadID=_.uniqueId('account_bill_file_upload');$(window).on(this.fileUploadID,this._onFileUploaded.bind(this));return this._super.apply(this,arguments);},_onAddAttachment:function(ev){var $input=$(ev.currentTarget).find('input.o_input_file');if($input.val()!==''){var $binaryForm=this.$('.o_vendor_bill_upload form.o_form_binary_form');$binaryForm.submit();}},_onFileUploaded:function(){var self=this;var attachments=Array.prototype.slice.call(arguments,1);var attachent_ids=attachments.reduce(function(filtered,record){if(record.id){filtered.push(record.id);}
return filtered;},[]);return this._rpc({model:'account.journal',method:'create_invoice_from_attachment',args:["",attachent_ids],context:this.initialState.context,}).then(function(result){self.do_action(result);});},_onUpload:function(event){var self=this;var $formContainer=this.$('.o_content').find('.o_vendor_bill_upload');if(!$formContainer.length){$formContainer=$(qweb.render('account.BillsHiddenUploadForm',{widget:this}));$formContainer.appendTo(this.$('.o_content'));}
this.$('.o_vendor_bill_upload .o_input_file').click();},}
return UploadBillMixin;});odoo.define('account.bills.tree',function(require){"use strict";var core=require('web.core');var ListController=require('web.ListController');var ListView=require('web.ListView');var UploadBillMixin=require('account.upload.bill.mixin');var viewRegistry=require('web.view_registry');var BillsListController=ListController.extend(UploadBillMixin,{buttons_template:'BillsListView.buttons',events:_.extend({},ListController.prototype.events,{'click .o_button_upload_bill':'_onUpload','change .o_vendor_bill_upload .o_form_binary_form':'_onAddAttachment',}),});var BillsListView=ListView.extend({config:_.extend({},ListView.prototype.config,{Controller:BillsListController,}),});viewRegistry.add('account_tree',BillsListView);});odoo.define('account.dashboard.kanban',function(require){"use strict";var core=require('web.core');var KanbanController=require('web.KanbanController');var KanbanView=require('web.KanbanView');var UploadBillMixin=require('account.upload.bill.mixin');var viewRegistry=require('web.view_registry');var DashboardKanbanController=KanbanController.extend(UploadBillMixin,{events:_.extend({},KanbanController.prototype.events,{'click .o_button_upload_bill':'_onUpload','change .o_vendor_bill_upload .o_form_binary_form':'_onAddAttachment',}),_onUpload:function(event){var kanbanRecord=$(event.currentTarget).closest('.o_kanban_record').data('record');this.initialState.context['default_journal_id']=kanbanRecord.id;if($(event.currentTarget).attr('journal_type')=='sale'){this.initialState.context['default_move_type']='out_invoice'}else if($(event.currentTarget).attr('journal_type')=='purchase'){this.initialState.context['default_move_type']='in_invoice'}
UploadBillMixin._onUpload.apply(this,arguments);}});var DashboardKanbanView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Controller:DashboardKanbanController,}),});viewRegistry.add('account_dashboard_kanban',DashboardKanbanView);});;

/* /account/static/src/js/account_selection.js defined in bundle 'web.assets_backend' */
odoo.define('account.hierarchy.selection',function(require){"use strict";var core=require('web.core');var relational_fields=require('web.relational_fields');var _t=core._t;var registry=require('web.field_registry');var FieldSelection=relational_fields.FieldSelection;var qweb=core.qweb;var HierarchySelection=FieldSelection.extend({_renderEdit:function(){var self=this;var prom=Promise.resolve()
if(!self.hierarchy_groups){prom=this._rpc({model:'account.account.type',method:'search_read',kwargs:{domain:[],fields:['id','internal_group','display_name'],},}).then(function(arg){self.values=_.map(arg,v=>[v['id'],v['display_name']])
self.hierarchy_groups=[{'name':_t('Balance Sheet'),'children':[{'name':_t('Assets'),'ids':_.map(_.filter(arg,v=>v['internal_group']=='asset'),v=>v['id'])},{'name':_t('Liabilities'),'ids':_.map(_.filter(arg,v=>v['internal_group']=='liability'),v=>v['id'])},{'name':_t('Equity'),'ids':_.map(_.filter(arg,v=>v['internal_group']=='equity'),v=>v['id'])},],},{'name':_t('Profit & Loss'),'children':[{'name':_t('Income'),'ids':_.map(_.filter(arg,v=>v['internal_group']=='income'),v=>v['id'])},{'name':_t('Expense'),'ids':_.map(_.filter(arg,v=>v['internal_group']=='expense'),v=>v['id'])},],},{'name':_t('Other'),'ids':_.map(_.filter(arg,v=>!['asset','liability','equity','income','expense'].includes(v['internal_group'])),v=>v['id'])},]});}
Promise.resolve(prom).then(function(){self.$el.empty();self._addHierarchy(self.$el,self.hierarchy_groups,0);var value=self.value;if(self.field.type==='many2one'&&value){value=value.data.id;}
self.$el.val(JSON.stringify(value));});},_addHierarchy:function(el,group,level){var self=this;_.each(group,function(item){var optgroup=$('<optgroup/>').attr(({'label':$('<div/>').html('&nbsp;'.repeat(6*level)+item['name']).text(),}))
_.each(item['ids'],function(id){var value=_.find(self.values,v=>v[0]==id)
optgroup.append($('<option/>',{value:JSON.stringify(value[0]),text:value[1],}));})
el.append(optgroup)
if(item['children']){self._addHierarchy(el,item['children'],level+1);}})}});registry.add("account_hierarchy_selection",HierarchySelection);});;

/* /snailmail_account/static/src/js/snailmail_account_notification_manager.js defined in bundle 'web.assets_backend' */
odoo.define('snailmail_account.NotificationManager',function(require){"use strict";var AbstractService=require('web.AbstractService');var core=require("web.core");var SnailmailAccountNotificationManager=AbstractService.extend({dependencies:['bus_service'],start:function(){this._super.apply(this,arguments);this.call('bus_service','onNotification',this,this._onNotification);},_onNotification:function(notifs){var self=this;_.each(notifs,function(notif){var model=notif[0][1];var type=notif[1].type;if(model==='res.partner'&&type==='snailmail_invalid_address'){self.do_warn(notif[1].title,notif[1].message);}});}});core.serviceRegistry.add('snailmail_account_notification_service',SnailmailAccountNotificationManager);return SnailmailAccountNotificationManager;});;

/* /sale/static/src/js/sale.js defined in bundle 'web.assets_backend' */
odoo.define('sale.sales_team_dashboard',function(require){"use strict";var core=require('web.core');var KanbanRecord=require('web.KanbanRecord');var _t=core._t;KanbanRecord.include({events:_.defaults({'click .sales_team_target_definition':'_onSalesTeamTargetClick',},KanbanRecord.prototype.events),_onSalesTeamTargetClick:function(ev){ev.preventDefault();var self=this;this.$target_input=$('<input>');this.$('.o_kanban_primary_bottom:last').html(this.$target_input);this.$('.o_kanban_primary_bottom:last').prepend(_t("Set an invoicing target: "));this.$target_input.focus();this.$target_input.on({blur:this._onSalesTeamTargetSet.bind(this),keydown:function(ev){if(ev.keyCode===$.ui.keyCode.ENTER){self._onSalesTeamTargetSet();}},});},_onSalesTeamTargetSet:function(){var self=this;var value=Number(this.$target_input.val());if(isNaN(value)){this.do_warn(false,_t("Please enter an integer value"));}else{this.trigger_up('kanban_record_update',{invoiced_target:value,onSuccess:function(){self.trigger_up('reload');},});}},});});;

/* /sale/static/src/js/tours/sale.js defined in bundle 'web.assets_backend' */
odoo.define('sale.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;tour.register("sale_tour",{url:"/web",rainbowMan:false,sequence:20,},[tour.stepUtils.showAppsMenuItem(),{trigger:".o_app[data-menu-xmlid='sale.sale_menu_root']",content:_t("Open Sales app to send your first quotation in a few clicks."),position:"right",edition:"community"},{trigger:".o_app[data-menu-xmlid='sale.sale_menu_root']",content:_t("Open Sales app to send your first quotation in a few clicks."),position:"bottom",edition:"enterprise"},{trigger:'a.o_onboarding_step_action.btn[data-method=action_open_base_onboarding_company]',extra_trigger:".o_sale_order",content:_t("Start by checking your company's data."),position:"bottom",},{trigger:".modal-content button[name='action_save_onboarding_company_step']",content:_t("Looks good. Let's continue."),position:"left",},{trigger:'a.o_onboarding_step_action.btn[data-method=action_open_base_document_layout]',extra_trigger:".o_sale_order",content:_t("Customize your quotes and orders."),position:"bottom",},{trigger:"button[name='document_layout_save']",extra_trigger:".o_sale_order",content:_t("Good job, let's continue."),position:"top",},{trigger:'a.o_onboarding_step_action.btn[data-method=action_open_sale_onboarding_payment_acquirer]',extra_trigger:".o_sale_order",content:_t("To speed up order confirmation, we can activate electronic signatures or payments."),position:"bottom",},{trigger:"button[name='add_payment_methods']",extra_trigger:".o_sale_order",content:_t("Lets keep electronic signature for now."),position:"bottom",},{trigger:'a.o_onboarding_step_action.btn[data-method=action_open_sale_onboarding_sample_quotation]',extra_trigger:".o_sale_order",content:_t("Now, we'll create a sample quote."),position:"bottom",}]);tour.register("sale_quote_tour",{url:"/web#action=sale.action_quotations_with_onboarding&view_type=form",rainbowMan:true,rainbowManMessage:"<b>Congratulations</b>, your first quotation is sent!<br>Check your email to validate the quote.",sequence:30,},[{trigger:".o_form_editable .o_field_many2one[name='partner_id']",extra_trigger:".o_sale_order",content:_t("Write a company name to create one, or see suggestions."),position:"bottom",run:function(actions){actions.text("Agrolait",this.$anchor.find("input"));},},{trigger:".ui-menu-item > a",auto:true,in_modal:false,},{trigger:".o_field_x2many_list_row_add > a",extra_trigger:".o_field_many2one[name='partner_id'] .o_external_button",content:_t("Click here to add some products or services to your quotation."),position:"bottom",},{trigger:".o_field_widget[name='product_id'], .o_field_widget[name='product_template_id']",extra_trigger:".o_sale_order",content:_t("Select a product, or create a new one on the fly."),position:"right",run:function(actions){var $input=this.$anchor.find("input");actions.text("DESK0001",$input.length===0?this.$anchor:$input);var keyDownEvent=jQuery.Event("keydown");keyDownEvent.which=42;this.$anchor.trigger(keyDownEvent);var $descriptionElement=$(".o_form_editable textarea[name='name']");$descriptionElement.change(function(){$descriptionElement.addClass("product_creation_success");});},id:"product_selection_step"},{trigger:".ui-menu.ui-widget .ui-menu-item a:contains('DESK0001')",auto:true,},{trigger:".o_form_editable textarea[name='name'].product_creation_success",auto:true,run:function(){}},{trigger:".o_field_widget[name='price_unit'] ",extra_trigger:".o_sale_order",content:_t("<b>Set a price</b>."),position:"right",run:"text 10.0"},...tour.stepUtils.statusbarButtonsSteps("Send by Email",_t("<b>Send the quote</b> to yourself and check what the customer will receive."),".o_statusbar_buttons button[name='action_quotation_send']"),{trigger:".modal-footer button.btn-primary",auto:true,},{trigger:".modal-footer button[name='action_send_mail']",extra_trigger:".modal-footer button[name='action_send_mail']",content:_t("Let's send the quote."),position:"bottom",}]);});;

/* /sale/static/src/js/product_configurator_widget.js defined in bundle 'web.assets_backend' */
odoo.define('sale.product_configurator',function(require){var relationalFields=require('web.relational_fields');var FieldsRegistry=require('web.field_registry');var core=require('web.core');var _t=core._t;var ProductConfiguratorWidget=relationalFields.FieldMany2One.extend({events:_.extend({},relationalFields.FieldMany2One.prototype.events,{'click .o_edit_product_configuration':'_onEditConfiguration'}),_render:function(){this._super.apply(this,arguments);if(this.mode==='edit'&&this.value&&(this._isConfigurableProduct()||this._isConfigurableLine())){this._addProductLinkButton();this._addConfigurationEditButton();}else if(this.mode==='edit'&&this.value){this._addProductLinkButton();this.$('.o_edit_product_configuration').hide();}else{this.$('.o_external_button').hide();this.$('.o_edit_product_configuration').hide();}},_addProductLinkButton:function(){if(this.$('.o_external_button').length===0){var $productLinkButton=$('<button>',{type:'button',class:'fa fa-external-link btn btn-secondary o_external_button',tabindex:'-1',draggable:false,'aria-label':_t('External Link'),title:_t('External Link')});var $inputDropdown=this.$('.o_input_dropdown');$inputDropdown.after($productLinkButton);}},_addConfigurationEditButton:function(){var $inputDropdown=this.$('.o_input_dropdown');if($inputDropdown.length!==0&&this.$('.o_edit_product_configuration').length===0){var $editConfigurationButton=$('<button>',{type:'button',class:'fa fa-pencil btn btn-secondary o_edit_product_configuration',tabindex:'-1',draggable:false,'aria-label':_t('Edit Configuration'),title:_t('Edit Configuration')});$inputDropdown.after($editConfigurationButton);}},_isConfigurableProduct:function(){return false;},_isConfigurableLine:function(){return false;},reset:async function(record,ev){await this._super(...arguments);if(ev&&ev.target===this){if(ev.data.changes&&!ev.data.preventProductIdCheck&&ev.data.changes.product_template_id){this._onTemplateChange(record.data.product_template_id.data.id,ev.data.dataPointID);}else if(ev.data.changes&&ev.data.changes.product_id){this._onProductChange(record.data.product_id.data&&record.data.product_id.data.id,ev.data.dataPointID).then(wizardOpened=>{if(!wizardOpened){this._onLineConfigured();}});}}},_onTemplateChange:function(productTemplateId,dataPointId){return Promise.resolve(false);},_onProductChange:function(productId,dataPointId){return Promise.resolve(false);},_onLineConfigured:function(){},_onEditConfiguration:function(){if(this._isConfigurableLine()){this._onEditLineConfiguration();}else if(this._isConfigurableProduct()){this._onEditProductConfiguration();}},_onEditLineConfiguration:function(){},_onEditProductConfiguration:function(){},_convertFromMany2Many:function(recordData){if(recordData){var convertedValues=[];_.each(recordData.res_ids,function(resId){convertedValues.push([4,parseInt(resId)]);});return convertedValues;}
return null;},_convertFromOne2Many:function(recordData){if(recordData){var convertedValues=[];_.each(recordData.res_ids,function(resId){if(isNaN(resId)){_.each(recordData.data,function(record){if(record.ref===resId){convertedValues.push([0,0,{custom_product_template_attribute_value_id:record.data.custom_product_template_attribute_value_id.data.id,custom_value:record.data.custom_value}]);}});}else{convertedValues.push([4,resId]);}});return convertedValues;}
return null;}});FieldsRegistry.add('product_configurator',ProductConfiguratorWidget);return ProductConfiguratorWidget;});;

/* /sale/static/src/js/sale_order_view.js defined in bundle 'web.assets_backend' */
odoo.define('sale.SaleOrderView',function(require){"use strict";const FormController=require('web.FormController');const FormView=require('web.FormView');const viewRegistry=require('web.view_registry');const Dialog=require('web.Dialog');const core=require('web.core');const _t=core._t;const SaleOrderFormController=FormController.extend({custom_events:_.extend({},FormController.prototype.custom_events,{open_discount_wizard:'_onOpenDiscountWizard',}),_onOpenDiscountWizard(ev){const orderLines=this.renderer.state.data.order_line.data.filter(line=>!line.data.display_type);const recordData=ev.target.recordData;const isEqualDiscount=orderLines.slice(1).every(line=>line.data.discount===recordData.discount);if(orderLines.length>=3&&recordData.sequence===orderLines[0].data.sequence&&isEqualDiscount){Dialog.confirm(this,_t("Do you want to apply this discount to all order lines?"),{confirm_callback:()=>{orderLines.slice(1).forEach((line)=>{this.trigger_up('field_changed',{dataPointID:this.renderer.state.id,changes:{order_line:{operation:"UPDATE",id:line.id,data:{discount:orderLines[0].data.discount}}},});});},});}},});const SaleOrderView=FormView.extend({config:_.extend({},FormView.prototype.config,{Controller:SaleOrderFormController,}),});viewRegistry.add('sale_discount_form',SaleOrderView);return SaleOrderView;});;

/* /sale/static/src/js/product_discount_widget.js defined in bundle 'web.assets_backend' */
odoo.define('sale.product_discount',function(require){"use strict";const BasicFields=require('web.basic_fields');const FieldsRegistry=require('web.field_registry');const ProductDiscountWidget=BasicFields.FieldFloat.extend({async reset(record,ev){if(ev&&ev.data.changes&&ev.data.changes.discount>=0){this.trigger_up('open_discount_wizard');}
this._super(...arguments);},});FieldsRegistry.add('product_discount',ProductDiscountWidget);return ProductDiscountWidget;});;

/* /web_responsive/static/src/js/web_responsive.js defined in bundle 'web.assets_backend' */
odoo.define("web_responsive",function(require){"use strict";const ActionManager=require("web.ActionManager");const AbstractWebClient=require("web.AbstractWebClient");const AppsMenu=require("web.AppsMenu");const BasicController=require("web.BasicController");const config=require("web.config");const core=require("web.core");const FormRenderer=require("web.FormRenderer");const Menu=require("web.Menu");const RelationalFields=require("web.relational_fields");const ListRenderer=require("web.ListRenderer");const CalendarRenderer=require("web.CalendarRenderer");const patchMixin=require("web.patchMixin");const AttachmentViewer=require("mail/static/src/components/attachment_viewer/attachment_viewer.js");const PatchableAttachmentViewer=patchMixin(AttachmentViewer);const ControlPanel=require("web.ControlPanel");const SearchPanel=require("web/static/src/js/views/search_panel.js");const{QWeb,Context}=owl;const{useState,useContext}=owl.hooks;function closeAppDrawer(){_.defer(function(){var menu_apps_dropdown=document.querySelector(".o_menu_apps .dropdown");$(menu_apps_dropdown).has(".dropdown-menu.show").find("> a").dropdown("toggle");var menu_sections=document.querySelector(".o_menu_sections li.show .dropdown-toggle");$(menu_sections).dropdown("toggle");var menu_sections_mobile=document.querySelector(".o_menu_sections.show");$(menu_sections_mobile).collapse("hide");});}
function findNames(memo,menu){if(menu.action){var key=menu.parent_id?menu.parent_id[1]+"/":"";memo[key+menu.name]=menu;}
if(menu.children.length){_.reduce(menu.children,findNames,memo);}
return memo;}
AppsMenu.include({events:_.extend({"keydown .search-input input":"_searchResultsNavigate","input .search-input input":"_searchMenusSchedule","click .o-menu-search-result":"_searchResultChosen","shown.bs.dropdown":"_searchFocus","hidden.bs.dropdown":"_searchReset","hide.bs.dropdown":"_hideAppsMenu",},AppsMenu.prototype.events),init:function(parent,menuData){this._super.apply(this,arguments);for(const n in this._apps){this._apps[n].web_icon_data=menuData.children[n].web_icon_data;}
this._searchableMenus=_.reduce(menuData.children,findNames,{});this._search_def=false;},start:function(){this.$search_container=this.$(".search-container");this.$search_input=this.$(".search-input input");this.$search_results=this.$(".search-results");return this._super.apply(this,arguments);},_onAppsMenuItemClicked:function(ev){this._super.apply(this,arguments);ev.preventDefault();ev.stopPropagation();},_menuInfo:function(key){const original=this._searchableMenus[key];return _.extend({action_id:parseInt(original.action.split(",")[1],10),},original);},_searchFocus:function(){if(!config.device.isMobile){setTimeout(()=>this.$search_input.focus(),100);}},_searchReset:function(){this.$search_container.removeClass("has-results");this.$search_results.empty();this.$search_input.val("");},_searchMenusSchedule:function(){this._search_def=new Promise((resolve)=>{setTimeout(resolve,50);});this._search_def.then(this._searchMenus.bind(this));},_searchMenus:function(){const query=this.$search_input.val();if(query===""){this.$search_container.removeClass("has-results");this.$search_results.empty();return;}
var results=fuzzy.filter(query,_.keys(this._searchableMenus),{pre:"<b>",post:"</b>",});this.$search_container.toggleClass("has-results",Boolean(results.length));this.$search_results.html(core.qweb.render("web_responsive.MenuSearchResults",{results:results,widget:this,}));},_searchResultChosen:function(event){event.preventDefault();event.stopPropagation();const $result=$(event.currentTarget),text=$result.text().trim(),data=$result.data(),suffix=~text.indexOf("/")?"/":"";this.trigger_up("menu_clicked",{action_id:data.actionId,id:data.menuId,previous_menu_id:data.parentId,});const app=_.find(this._apps,function(_app){return text.indexOf(_app.name+suffix)===0;});core.bus.trigger("change_menu_section",app.menuID);},_searchResultsNavigate:function(event){const all=this.$search_results.find(".o-menu-search-result"),pre_focused=all.filter(".active")||$(all[0]);let offset=all.index(pre_focused),key=event.key;if(!all.length){return;}
if(key==="Tab"){event.preventDefault();key=event.shiftKey?"ArrowUp":"ArrowDown";}
switch(key){case"Enter":pre_focused.click();break;case"ArrowUp":offset--;break;case"ArrowDown":offset++;break;default:return;}
if(offset<0){offset=all.length+offset;}else if(offset>=all.length){offset-=all.length;}
const new_focused=$(all[offset]);pre_focused.removeClass("active");new_focused.addClass("active");this.$search_results.scrollTo(new_focused,{offset:{top:this.$search_results.height()*-0.5,},});},_hideAppsMenu:function(){return!this.$("input").is(":focus");},});BasicController.include({canBeDiscarded:function(recordID){if(this.model.isDirty(recordID||this.handle)){closeAppDrawer();}
return this._super.apply(this,arguments);},});Menu.include({events:_.extend({"click .o_menu_sections [role=menuitem]":"_onClickMenuItem","show.bs.dropdown .o_menu_systray, .o_menu_apps":"_hideMobileSubmenus",},Menu.prototype.events),start:function(){this.$menu_toggle=this.$(".o-menu-toggle");return this._super.apply(this,arguments);},_hideMobileSubmenus:function(){if(config.device.isMobile&&this.$menu_toggle.is(":visible")&&this.$section_placeholder.is(":visible")){this.$section_placeholder.collapse("hide");}},_onClickMenuItem:function(ev){ev.stopPropagation();},_updateMenuBrand:function(){if(!config.device.isMobile){return this._super.apply(this,arguments);}},});RelationalFields.FieldStatus.include({_setState:function(){this._super.apply(this,arguments);if(config.device.isMobile){_.map(this.status_information,(value)=>{value.fold=true;});}},});ListRenderer.include({_renderView:function(){const self=this;return this._super.apply(this,arguments).then(()=>{const $col_selector=self.$el.find(".o_optional_columns_dropdown_toggle");if($col_selector.length!==0){const $th=self.$el.find("thead>tr:first>th:last");$col_selector.appendTo($th);}});},_onToggleOptionalColumnDropdown:function(ev){ev.stopPropagation();this._super.apply(this,arguments);},});FormRenderer.include({_renderHeaderButtons:function(){const $buttons=this._super.apply(this,arguments);if(!config.device.isMobile||$buttons.children("button:not(.o_invisible_modifier)").length<=2){return $buttons;}
const $dropdown=$(core.qweb.render("web_responsive.MenuStatusbarButtons"));$buttons.addClass("dropdown-menu").appendTo($dropdown);return $dropdown;},});CalendarRenderer.include({_getFullCalendarOptions:function(){var options=this._super.apply(this,arguments);if(config.device.isMobile){options.views.dayGridMonth.columnHeaderFormat="ddd";}
return options;},});ActionManager.include({_appendController:function(){this._super.apply(this,arguments);closeAppDrawer();},});var KeyboardNavigationShiftAltMixin={_shiftPressed:function(keyEvent){const alt=keyEvent.altKey||keyEvent.key==="Alt",newEvent=_.extend({},keyEvent),shift=keyEvent.shiftKey||keyEvent.key==="Shift";if(alt&&!shift){newEvent.altKey=false;if(newEvent.key==="Alt"){newEvent.key="Shift";}}
return newEvent;},_onKeyDown:function(keyDownEvent){return this._super(this._shiftPressed(keyDownEvent));},_onKeyUp:function(keyUpEvent){return this._super(this._shiftPressed(keyUpEvent));},};AbstractWebClient.include(KeyboardNavigationShiftAltMixin);const deviceContext=new Context({isMobile:config.device.isMobile,size_class:config.device.size_class,SIZES:config.device.SIZES,});window.addEventListener("resize",owl.utils.debounce(()=>{const state=deviceContext.state;if(state.isMobile!==config.device.isMobile){state.isMobile=!state.isMobile;}
if(state.size_class!==config.device.size_class){state.size_class=config.device.size_class;}},15));PatchableAttachmentViewer.patch("web_responsive.AttachmentViewer",(T)=>{class AttachmentViewerPatchResponsive extends T{constructor(){super(...arguments);this.state=useState({maximized:false,});}
isCloseable(){return false;}}
return AttachmentViewerPatchResponsive;});QWeb.components.AttachmentViewer=PatchableAttachmentViewer;ControlPanel.patch("web_responsive.ControlPanelMobile",(T)=>{class ControlPanelPatchResponsive extends T{constructor(){super(...arguments);this.state=useState({mobileSearchMode:"",});this.device=useContext(deviceContext);}}
return ControlPanelPatchResponsive;});SearchPanel.patch("web_responsive.SearchPanelMobile",(T)=>{class SearchPanelPatchResponsive extends T{constructor(){super(...arguments);this.state.mobileSearch=false;this.device=useContext(deviceContext);}
getActiveSummary(){const selection=[];for(const filter of this.model.get("sections")){let filterValues=[];if(filter.type==="category"){if(filter.activeValueId){const parentIds=this._getAncestorValueIds(filter,filter.activeValueId);filterValues=[...parentIds,filter.activeValueId].map((valueId)=>filter.values.get(valueId).display_name);}}else{let values=[];if(filter.groups){values=Array.from(filter.groups.values(),(g)=>g.values).flat();}
if(filter.values){values=[...filter.values.values()];}
filterValues=values.filter((v)=>v.checked).map((v)=>v.display_name);}
if(filterValues.length){selection.push({values:filterValues,icon:filter.icon,color:filter.color,type:filter.type,});}}
return selection;}}
return SearchPanelPatchResponsive;});return{deviceContext:deviceContext,};});;

/* /web_responsive/static/src/js/kanban_renderer_mobile.js defined in bundle 'web.assets_backend' */
odoo.define("web_responsive.KanbanRendererMobile",function(require){"use strict";var config=require("web.config");var core=require("web.core");var KanbanRenderer=require("web.KanbanRenderer");var KanbanView=require("web.KanbanView");var KanbanQuickCreate=require("web.kanban_column_quick_create");var _t=core._t;var qweb=core.qweb;if(!config.device.isMobile){return;}
KanbanQuickCreate.include({init(){this._super.apply(this,arguments);this.isMobile=true;},_cancel:function(){this.trigger_up("close_quick_create");},toggleFold:function(){this._super.apply(this,arguments);if(!this.folded){this.$input.val("");}},});KanbanView.include({init(){this._super.apply(this,arguments);this.jsLibs.push("/web/static/lib/jquery.touchSwipe/jquery.touchSwipe.js");},});KanbanRenderer.include({custom_events:_.extend({},KanbanRenderer.prototype.custom_events||{},{quick_create_column_created:"_onColumnAdded",}),events:_.extend({},KanbanRenderer.prototype.events,{"click .o_kanban_mobile_tab":"_onMobileTabClicked","click .o_kanban_mobile_add_column":"_onMobileQuickCreateClicked",}),ANIMATE:true,init:function(){this._super.apply(this,arguments);this.activeColumnIndex=0;this._scrollPosition=null;},on_attach_callback:function(){if(this._scrollPosition&&this.state.groupedBy.length&&this.widgets.length){var $column=this.widgets[this.activeColumnIndex].$el;$column.scrollLeft(this._scrollPosition.left);$column.scrollTop(this._scrollPosition.top);}
this._computeTabPosition();this._super.apply(this,arguments);},on_detach_callback:function(){if(this.state.groupedBy.length&&this.widgets.length){var $column=this.widgets[this.activeColumnIndex].$el;this._scrollPosition={left:$column.scrollLeft(),top:$column.scrollTop(),};}else{this._scrollPosition=null;}
this._super.apply(this,arguments);},addQuickCreate:function(){if(this._canCreateColumn()&&!this.quickCreate.folded){this._onMobileQuickCreateClicked();}
return this.widgets[this.activeColumnIndex].addQuickCreate();},updateColumn:function(localID){var index=_.findIndex(this.widgets,{db_id:localID});var $column=this.widgets[index].$el;var scrollTop=$column.scrollTop();return(this._super.apply(this,arguments).then(()=>this._layoutUpdate(false)).then(()=>$column.scrollTop(scrollTop)).then(()=>this._enableSwipe()));},_canCreateColumn:function(){return this.quickCreateEnabled&&this.quickCreate&&this.widgets.length;},_computeColumnPosition:function(animate){if(this.widgets.length){const rtl=_t.database.parameters.direction==="rtl";this.$(".o_kanban_group").show();const $columnAfter=this._toNode(this.widgets.filter((widget,index)=>index>this.activeColumnIndex));const promiseAfter=this._updateColumnCss($columnAfter,rtl?{right:"100%"}:{left:"100%"},animate);const $columnBefore=this._toNode(this.widgets.filter((widget,index)=>index<this.activeColumnIndex));const promiseBefore=this._updateColumnCss($columnBefore,rtl?{right:"-100%"}:{left:"-100%"},animate);const $columnCurrent=this._toNode(this.widgets.filter((widget,index)=>index===this.activeColumnIndex));const promiseCurrent=this._updateColumnCss($columnCurrent,rtl?{right:"0%"}:{left:"0%"},animate);promiseAfter.then(promiseBefore).then(promiseCurrent).then(()=>{$columnAfter.hide();$columnBefore.hide();});}},_computeCurrentColumn:function(){if(this.widgets.length){var column=this.widgets[this.activeColumnIndex];if(!column){return;}
var columnID=column.id||column.db_id;this.$(".o_kanban_mobile_tab.o_current, .o_kanban_group.o_current").removeClass("o_current");this.$('.o_kanban_group[data-id="'+
columnID+'"], '+'.o_kanban_mobile_tab[data-id="'+
columnID+'"]').addClass("o_current");}},_computeTabPosition:function(){this._computeTabJustification();this._computeTabScrollPosition();},_computeTabScrollPosition:function(){if(this.widgets.length){var lastItemIndex=this.widgets.length-1;var moveToIndex=this.activeColumnIndex;var scrollToLeft=0;for(var i=0;i<moveToIndex;i++){var columnWidth=this._getTabWidth(this.widgets[i]);if(moveToIndex!==lastItemIndex&&i===moveToIndex-1){var partialWidth=0.75;scrollToLeft+=columnWidth*partialWidth;}else{scrollToLeft+=columnWidth;}}
this.$(".o_kanban_mobile_tabs").scrollLeft(scrollToLeft);}},_computeTabJustification:function(){if(this.widgets.length){var self=this;var widthChilds=this.widgets.reduce(function(total,column){return total+self._getTabWidth(column);},0);var $tabs=this.$(".o_kanban_mobile_tabs");$tabs.toggleClass("justify-content-between",$tabs.outerWidth()>=widthChilds);}},_enableSwipe:function(){var self=this;var step=_t.database.parameters.direction==="rtl"?-1:1;this.$el.swipe({excludedElements:".o_kanban_mobile_tabs",swipeLeft:function(){var moveToIndex=self.activeColumnIndex+step;if(moveToIndex<self.widgets.length){self._moveToGroup(moveToIndex,self.ANIMATE);}},swipeRight:function(){var moveToIndex=self.activeColumnIndex-step;if(moveToIndex>-1){self._moveToGroup(moveToIndex,self.ANIMATE);}},});},_getTabWidth:function(column){var columnID=column.id||column.db_id;return this.$('.o_kanban_mobile_tab[data-id="'+columnID+'"]').outerWidth();},_layoutUpdate:function(animate){this._computeCurrentColumn();this._computeTabPosition();this._computeColumnPosition(animate);this._enableSwipe();},_moveToGroup:function(moveToIndex,animate){if(this.widgets.length===0){return Promise.resolve();}
var self=this;if(moveToIndex>=0&&moveToIndex<this.widgets.length){this.activeColumnIndex=moveToIndex;}
var column=this.widgets[this.activeColumnIndex];this._enableSwipe();if(!column.data.isOpen){this.trigger_up("column_toggle_fold",{db_id:column.db_id,onSuccess:()=>self._layoutUpdate(animate),});}else{this._layoutUpdate(animate);}
return Promise.resolve();},_renderExampleBackground:function(){},_renderGrouped:function(fragment){var self=this;var newFragment=document.createDocumentFragment();this._super.apply(this,[newFragment]);this.defs.push(Promise.all(this.defs).then(function(){var data=[];_.each(self.state.data,function(group){if(!group.value){group=_.extend({},group,{value:_t("Undefined")});data.unshift(group);}else{data.push(group);}});var kanbanColumnContainer=document.createElement("div");kanbanColumnContainer.classList.add("o_kanban_columns_content");kanbanColumnContainer.appendChild(newFragment);fragment.appendChild(kanbanColumnContainer);$(qweb.render("KanbanView.MobileTabs",{data:data,quickCreateEnabled:self._canCreateColumn(),})).prependTo(fragment);}));},_renderView:function(){var self=this;return this._super.apply(this,arguments).then(function(){if(self.state.groupedBy.length){return self._moveToGroup(0);}
if(self._canCreateColumn()){self._onMobileQuickCreateClicked();}
return Promise.resolve();});},_toNode:function(widgets){const selectorCss=widgets.map((widget)=>'.o_kanban_group[data-id="'+(widget.id||widget.db_id)+'"]').join(", ");return this.$(selectorCss);},_updateColumnCss:function($column,cssProperties,animate){if(animate){return new Promise((resolve)=>$column.animate(cssProperties,"fast",resolve));}
$column.css(cssProperties);return Promise.resolve();},_onColumnAdded:function(){this._computeTabPosition();if(this._canCreateColumn()&&!this.quickCreate.folded){this.quickCreate.toggleFold();}},_onMobileQuickCreateClicked:function(event){if(event){event.stopPropagation();}
this.quickCreate.toggleFold();this.$(".o_kanban_group").toggle(this.quickCreate.folded);},_onMobileTabClicked:function(event){if(this._canCreateColumn()&&!this.quickCreate.folded){this.quickCreate.toggleFold();}
this._moveToGroup($(event.currentTarget).index(),true);},_onCloseQuickCreate:function(){if(this.widgets.length&&!this.quickCreate.folded){this.$(".o_kanban_group").toggle(true);this.quickCreate.toggleFold();}},});});;

/* /calendar/static/src/js/base_calendar.js defined in bundle 'web.assets_backend' */
odoo.define('base_calendar.base_calendar',function(require){"use strict";var BasicModel=require('web.BasicModel');var fieldRegistry=require('web.field_registry');var Notification=require('web.Notification');var relationalFields=require('web.relational_fields');var session=require('web.session');var WebClient=require('web.WebClient');var FieldMany2ManyTags=relationalFields.FieldMany2ManyTags;var CalendarNotification=Notification.extend({template:"CalendarNotification",xmlDependencies:(Notification.prototype.xmlDependencies||[]).concat(['/calendar/static/src/xml/notification_calendar.xml']),init:function(parent,params){this._super(parent,params);this.eid=params.eventID;this.sticky=true;this.events=_.extend(this.events||{},{'click .link2event':function(){var self=this;this._rpc({route:'/web/action/load',params:{action_id:'calendar.action_calendar_event_notify',},}).then(function(r){r.res_id=self.eid;return self.do_action(r);});},'click .link2recall':function(){this.close();},'click .link2showed':function(){this._rpc({route:'/calendar/notify_ack'}).then(this.close.bind(this,false),this.close.bind(this,false));},});},});WebClient.include({display_calendar_notif:function(notifications){var self=this;var last_notif_timer=0;clearTimeout(this.get_next_calendar_notif_timeout);_.each(this.calendar_notif_timeouts,clearTimeout);this.calendar_notif_timeouts={};_.each(notifications,function(notif){var key=notif.event_id+','+notif.alarm_id;if(key in self.calendar_notif){return;}
self.calendar_notif_timeouts[key]=setTimeout(function(){var notificationID=self.call('notification','notify',{Notification:CalendarNotification,title:notif.title,message:notif.message,eventID:notif.event_id,onClose:function(){delete self.calendar_notif[key];},});self.calendar_notif[key]=notificationID;},notif.timer*1000);last_notif_timer=Math.max(last_notif_timer,notif.timer);});if(last_notif_timer>0){this.get_next_calendar_notif_timeout=setTimeout(this.get_next_calendar_notif.bind(this),last_notif_timer*1000);}},get_next_calendar_notif:function(){session.rpc("/calendar/notify",{},{shadow:true}).then(this.display_calendar_notif.bind(this)).guardedCatch(function(reason){var err=reason.message;var ev=reason.event;if(err.code===-32098){ev.preventDefault();}});},show_application:function(){this.calendar_notif_timeouts={};this.calendar_notif={};this.call('bus_service','onNotification',this,function(notifications){_.each(notifications,(function(notification){if(notification[0][1]==='calendar.alarm'){this.display_calendar_notif(notification[1]);}}).bind(this));});return this._super.apply(this,arguments).then(this.get_next_calendar_notif.bind(this));},});BasicModel.include({_fetchSpecialAttendeeStatus:function(record,fieldName){var context=record.getContext({fieldName:fieldName});var attendeeIDs=record.data[fieldName]?this.localData[record.data[fieldName]].res_ids:[];var meetingID=_.isNumber(record.res_id)?record.res_id:false;return this._rpc({model:'res.partner',method:'get_attendee_detail',args:[attendeeIDs,meetingID],context:context,}).then(function(result){return _.map(result,function(d){return _.object(['id','display_name','status','color'],d);});});},});var Many2ManyAttendee=FieldMany2ManyTags.extend({tag_template:"Many2ManyAttendeeTag",specialData:"_fetchSpecialAttendeeStatus",_getRenderTagsContext:function(){var result=this._super.apply(this,arguments);result.attendeesData=this.record.specialData.partner_ids;return result;},});fieldRegistry.add('many2manyattendee',Many2ManyAttendee);});;

/* /calendar/static/src/js/calendar_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('calendar.CalendarRenderer',function(require){"use strict";const CalendarRenderer=require('web.CalendarRenderer');const CalendarPopover=require('web.CalendarPopover');const session=require('web.session');const AttendeeCalendarPopover=CalendarPopover.extend({template:'Calendar.attendee.status.popover',events:_.extend({},CalendarPopover.prototype.events,{'click .o-calendar-attendee-status .dropdown-item':'_onClickAttendeeStatus'}),init:function(){var self=this;this._super.apply(this,arguments);if(this.isCurrentPartnerAttendee()){this.statusColors={accepted:'text-success',declined:'text-danger',tentative:'text-muted',needsAction:'text-dark'};this.statusInfo={};_.each(this.fields.attendee_status.selection,function(selection){self.statusInfo[selection[0]]={text:selection[1],color:self.statusColors[selection[0]]};});this.selectedStatusInfo=this.statusInfo[this.event.extendedProps.record.attendee_status];}},isCurrentPartnerAttendee(){return this.event.extendedProps.record.partner_ids.includes(session.partner_id);},isEventDeletable(){return this._super()&&(this._isEventPrivate()?this.isCurrentPartnerAttendee():true);},isEventDetailsVisible(){return this._isEventPrivate()?this.isCurrentPartnerAttendee():this._super();},isEventEditable(){return this._isEventPrivate()?this.isCurrentPartnerAttendee():this._super();},displayAttendeeAnswerChoice(){const isCurrentpartner=(currentValue)=>currentValue===session.partner_id;const onlyAttendee=this.event.extendedProps.record.partner_ids.every(isCurrentpartner);return this.isCurrentPartnerAttendee()&&!onlyAttendee;},_isEventPrivate(){return this.event.extendedProps.record.privacy==='private';},_onClickAttendeeStatus:function(ev){ev.preventDefault();var self=this;var selectedStatus=$(ev.currentTarget).attr('data-action');this._rpc({model:'calendar.event',method:'change_attendee_status',args:[parseInt(this.event.id),selectedStatus],}).then(function(){self.event.extendedProps.record.attendee_status=selectedStatus;self.$('.o-calendar-attendee-status-text').text(self.statusInfo[selectedStatus].text);self.$('.o-calendar-attendee-status-icon').removeClass(_.values(self.statusColors).join(' ')).addClass(self.statusInfo[selectedStatus].color);});},});const AttendeeCalendarRenderer=CalendarRenderer.extend({config:_.extend({},CalendarRenderer.prototype.config,{CalendarPopover:AttendeeCalendarPopover,}),});return AttendeeCalendarRenderer});;

/* /calendar/static/src/js/calendar_controller.js defined in bundle 'web.assets_backend' */
odoo.define('calendar.CalendarController',function(require){"use strict";const Controller=require('web.CalendarController');const Dialog=require('web.Dialog');const{qweb,_t}=require('web.core');const CalendarController=Controller.extend({_askRecurrenceUpdatePolicy(){return new Promise((resolve,reject)=>{new Dialog(this,{title:_t('Edit Recurrent event'),size:'small',$content:$(qweb.render('calendar.RecurrentEventUpdate')),buttons:[{text:_t('Confirm'),classes:'btn-primary',close:true,click:function(){resolve(this.$('input:checked').val());},}],}).open();});},async _onDropRecord(event){const _super=this._super;if(event.data.record.recurrency){const recurrenceUpdate=await this._askRecurrenceUpdatePolicy();event.data=_.extend({},event.data,{'recurrenceUpdate':recurrenceUpdate,});}
_super.apply(this,arguments);},async _onUpdateRecord(event){const _super=this._super;if(event.data.record.recurrency){const recurrenceUpdate=await this._askRecurrenceUpdatePolicy();event.data=_.extend({},event.data,{'recurrenceUpdate':recurrenceUpdate,});}
_super.apply(this,arguments);},});return CalendarController;});;

/* /calendar/static/src/js/calendar_model.js defined in bundle 'web.assets_backend' */
odoo.define('calendar.CalendarModel',function(require){"use strict";const Model=require('web.CalendarModel');const CalendarModel=Model.extend({calendarEventToRecord(event){const data=this._super(event);return _.extend({},data,{'recurrence_update':event.recurrenceUpdate,});}});return CalendarModel;});;

/* /calendar/static/src/js/calendar_view.js defined in bundle 'web.assets_backend' */
odoo.define('calendar.CalendarView',function(require){"use strict";var CalendarController=require('calendar.CalendarController');var CalendarModel=require('calendar.CalendarModel');const CalendarRenderer=require('calendar.CalendarRenderer');var CalendarView=require('web.CalendarView');var viewRegistry=require('web.view_registry');var AttendeeCalendarView=CalendarView.extend({config:_.extend({},CalendarView.prototype.config,{Renderer:CalendarRenderer,Controller:CalendarController,Model:CalendarModel,}),});viewRegistry.add('attendee_calendar',AttendeeCalendarView);return AttendeeCalendarView});;

/* /calendar/static/src/js/mail_activity.js defined in bundle 'web.assets_backend' */
odoo.define('calendar.Activity',function(require){"use strict";var Activity=require('mail.Activity');var Dialog=require('web.Dialog');var core=require('web.core');var _t=core._t;Activity.include({_onEditActivity:function(event,options){var self=this;var activity_id=$(event.currentTarget).data('activity-id');var activity=_.find(this.activities,function(act){return act.id===activity_id;});if(activity&&activity.activity_category==='meeting'&&activity.calendar_event_id){return self._super(event,_.extend({res_model:'calendar.event',res_id:activity.calendar_event_id[0],}));}
return self._super(event,options);},_onUnlinkActivity:function(event,options){event.preventDefault();var self=this;var activity_id=$(event.currentTarget).data('activity-id');var activity=_.find(this.activities,function(act){return act.id===activity_id;});if(activity&&activity.activity_category==='meeting'&&activity.calendar_event_id){Dialog.confirm(self,_t("The activity is linked to a meeting. Deleting it will remove the meeting as well. Do you want to proceed ?"),{confirm_callback:function(){return self._rpc({model:'mail.activity',method:'unlink_w_meeting',args:[[activity_id]],}).then(self._reload.bind(self,{activity:true}));},});}
else{return self._super(event,options);}},});});;

/* /calendar/static/src/js/systray_activity_menu.js defined in bundle 'web.assets_backend' */
odoo.define('calendar.systray.ActivityMenu',function(require){"use strict";var ActivityMenu=require('mail.systray.ActivityMenu');var fieldUtils=require('web.field_utils');ActivityMenu.include({_getActivityData:function(){var self=this;return this._super.apply(this,arguments).then(function(){var meeting=_.find(self._activities,{type:'meeting'});if(meeting&&meeting.meetings){_.each(meeting.meetings,function(res){res.start=fieldUtils.parse.datetime(res.start,false,{isUTC:true});});}});},_onActivityFilterClick:function(ev){var $el=$(ev.currentTarget);var data=_.extend({},$el.data());if(data.res_model==="calendar.event"&&data.filter==="my"){this.do_action('calendar.action_calendar_event',{additional_context:{default_mode:'day',search_default_mymeetings:1,},clear_breadcrumbs:true,});}else{this._super.apply(this,arguments);}},});});;

/* /crm/static/src/js/crm_form.js defined in bundle 'web.assets_backend' */
odoo.define("crm.crm_form",function(require){"use strict";var FormController=require('web.FormController');var FormView=require('web.FormView');var viewRegistry=require('web.view_registry');var CrmFormController=FormController.extend({saveRecord:function(){return this._super(...arguments).then((modifiedFields)=>{if(modifiedFields.indexOf('stage_id')!==-1){this._checkRainbowmanMessage(this.renderer.state.res_id)}});},_applyChanges:function(dataPointID,changes,event){return this._super(...arguments).then(()=>{if(event.data.force_save&&'stage_id'in changes){this._checkRainbowmanMessage(parseInt(event.target.res_id));}});},_checkRainbowmanMessage:async function(recordId){const message=await this._rpc({model:'crm.lead',method:'get_rainbowman_message',args:[[recordId]],});if(message){this.trigger_up('show_effect',{message:message,type:'rainbow_man',});}}});var CrmFormView=FormView.extend({config:_.extend({},FormView.prototype.config,{Controller:CrmFormController,}),});viewRegistry.add('crm_form',CrmFormView);return{CrmFormController:CrmFormController,CrmFormView:CrmFormView,};});;

/* /crm/static/src/js/crm_kanban.js defined in bundle 'web.assets_backend' */
odoo.define('crm.crm_kanban',function(require){"use strict";var KanbanModel=require('web.KanbanModel');var KanbanView=require('web.KanbanView');var viewRegistry=require('web.view_registry');var CrmKanbanModel=KanbanModel.extend({moveRecord:async function(recordID,groupID,parentID){var result=await this._super(...arguments);if(this.localData[parentID].groupedBy[0]===this.defaultGroupedBy[0]){const message=await this._rpc({model:'crm.lead',method:'get_rainbowman_message',args:[[parseInt(this.localData[recordID].res_id)]],});if(message){this.trigger_up('show_effect',{message:message,type:'rainbow_man',});}}
return result;},});var CrmKanbanView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Model:CrmKanbanModel,}),});viewRegistry.add('crm_kanban',CrmKanbanView);return{CrmKanbanModel:CrmKanbanModel,CrmKanbanView:CrmKanbanView,};});;

/* /crm/static/src/js/systray_activity_menu.js defined in bundle 'web.assets_backend' */
odoo.define('crm.systray.ActivityMenu',function(require){"use strict";var ActivityMenu=require('mail.systray.ActivityMenu');ActivityMenu.include({_getViewsList(model){if(model==="crm.lead"){return[[false,'list'],[false,'kanban'],[false,'form'],[false,'calendar'],[false,'pivot'],[false,'graph'],[false,'activity']];}
return this._super(...arguments);},_onActivityFilterClick:function(event){var data=_.extend({},$(event.currentTarget).data(),$(event.target).data());var context={};if(data.res_model==="crm.lead"){if(data.filter==='my'){context['search_default_activities_overdue']=1;context['search_default_activities_today']=1;}else{context['search_default_activities_'+data.filter]=1;}
context['force_search_count']=1;this.do_action('crm.crm_lead_action_my_activities',{additional_context:context,clear_breadcrumbs:true,});}else{this._super.apply(this,arguments);}},});});;

/* /crm/static/src/js/tours/crm.js defined in bundle 'web.assets_backend' */
odoo.define('crm.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;tour.register('crm_tour',{url:"/web",rainbowManMessage:_t("Congrats, best of luck catching such big fish! :)"),sequence:10,},[tour.stepUtils.showAppsMenuItem(),{trigger:'.o_app[data-menu-xmlid="crm.crm_menu_root"]',content:_t('Ready to boost your sales? Let\'s have a look at your <b>Pipeline</b>.'),position:'bottom',edition:'community',},{trigger:'.o_app[data-menu-xmlid="crm.crm_menu_root"]',content:_t('Ready to boost your sales? Let\'s have a look at your <b>Pipeline</b>.'),position:'bottom',edition:'enterprise',},{trigger:'.o-kanban-button-new',extra_trigger:'.o_opportunity_kanban',content:_t("<b>Create your first opportunity.</b>"),position:'bottom',},{trigger:".o_kanban_quick_create .o_field_widget[name='partner_id']",content:_t('<b>Write a few letters</b> to look for a company, or create a new one.'),position:"top",run:function(actions){actions.text("Brandon Freeman",this.$anchor.find("input"));},},{trigger:".ui-menu-item > a",auto:true,in_modal:false,},{trigger:".o_kanban_quick_create .o_kanban_add",content:_t("Now, <b>add your Opportunity</b> to your Pipeline."),position:"bottom",},{trigger:".o_opportunity_kanban .o_kanban_group:first-child .o_kanban_record:last-child .oe_kanban_content",extra_trigger:".o_opportunity_kanban",content:_t("<b>Drag &amp; drop opportunities</b> between columns as you progress in your sales cycle."),position:"right",run:"drag_and_drop .o_opportunity_kanban .o_kanban_group:eq(2) ",},{trigger:".o_kanban_record:not(.o_updating) .o_activity_color_default",extra_trigger:".o_opportunity_kanban",content:_t("Looks like nothing is planned. :(<br><br><i>Tip : Schedule activities to keep track of everything you have to do!</i>"),position:"bottom",},{trigger:".o_schedule_activity",extra_trigger:".o_opportunity_kanban",content:_t("Let's <b>Schedule an Activity.</b>"),position:"bottom",width:200,},{trigger:'.modal-footer button[name="action_close_dialog"]',content:_t("All set. Lets <b>Schedule</b> it."),position:"top",run:function(actions){actions.auto('.modal-footer button[special=cancel]');},},{id:"drag_opportunity_to_won_step",trigger:".o_opportunity_kanban .o_kanban_record:last-child",content:_t("Drag your opportunity to <b>Won</b> when you get the deal. Congrats !"),position:"bottom",run:"drag_and_drop .o_opportunity_kanban .o_kanban_group:eq(3) ",},{trigger:".o_kanban_record",extra_trigger:".o_opportunity_kanban",content:_t("Lets have a look at an Opportunity."),position:"right",run:function(actions){actions.auto(".o_kanban_record");},},{trigger:".o_lead_opportunity_form .o_statusbar_status",content:_t("This bar also allows you to switch stage."),position:"bottom"},{trigger:".breadcrumb-item:not(.active):first",content:_t("Click on the breadcrumb to go back to the Pipeline."),position:"bottom",run:function(actions){actions.auto(".breadcrumb-item:not(.active):last");}}]);});;

/* /crm_iap_lead/static/src/js/leads_tree_generate_leads.js defined in bundle 'web.assets_backend' */
odoo.define('crm.leads.tree',function(require){"use strict";var ListController=require('web.ListController');var ListView=require('web.ListView');var KanbanController=require('web.KanbanController');var KanbanView=require('crm.crm_kanban').CrmKanbanView;var viewRegistry=require('web.view_registry');function renderGenerateLeadsButton(){if(this.$buttons){var self=this;var lead_type=self.initialState.getContext()['default_type'];this.$buttons.on('click','.o_button_generate_leads',function(){self.do_action({name:'Generate Leads',type:'ir.actions.act_window',res_model:'crm.iap.lead.mining.request',target:'new',views:[[false,'form']],context:{'is_modal':true,'default_lead_type':lead_type},});});}}
var LeadMiningRequestListController=ListController.extend({willStart:function(){var self=this;var ready=this.getSession().user_has_group('sales_team.group_sale_manager').then(function(is_sale_manager){if(is_sale_manager){self.buttons_template='LeadMiningRequestListView.buttons';}});return Promise.all([this._super.apply(this,arguments),ready]);},renderButtons:function(){this._super.apply(this,arguments);renderGenerateLeadsButton.apply(this,arguments);}});var LeadMiningRequestListView=ListView.extend({config:_.extend({},ListView.prototype.config,{Controller:LeadMiningRequestListController,}),});var LeadMiningRequestKanbanController=KanbanController.extend({willStart:function(){var self=this;var ready=this.getSession().user_has_group('sales_team.group_sale_manager').then(function(is_sale_manager){if(is_sale_manager){self.buttons_template='LeadMiningRequestKanbanView.buttons';}});return Promise.all([this._super.apply(this,arguments),ready]);},renderButtons:function(){this._super.apply(this,arguments);renderGenerateLeadsButton.apply(this,arguments);}});var LeadMiningRequestKanbanView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Controller:LeadMiningRequestKanbanController,}),});viewRegistry.add('crm_iap_lead_mining_request_tree',LeadMiningRequestListView);viewRegistry.add('crm_iap_lead_mining_request_kanban',LeadMiningRequestKanbanView);});;

/* /crm_iap_lead/static/src/js/tours/crm_iap_lead.js defined in bundle 'web.assets_backend' */
odoo.define('crm_iap_lead.generate_leads_steps',function(require){"use strict";var tour=require('web_tour.tour');var core=require('web.core');require('crm.tour');var _t=core._t;var DragOppToWonStepIndex=_.findIndex(tour.tours.crm_tour.steps,function(step){return(step.id==='drag_opportunity_to_won_step');});tour.tours.crm_tour.steps.splice(DragOppToWonStepIndex+1,0,{trigger:".o_button_generate_leads",content:_t("Looking for more opportunities ?<br>Try the <b>Lead Generation</b> tool."),position:"bottom",run:function(actions){actions.auto('.o_button_generate_leads');},},{trigger:'.modal-body .o_industry',content:_t("Which Industry do you want to target?"),position:"right",},{trigger:'.modal-footer button[name=action_submit]',content:_t("Now, just let the magic happen!"),position:"bottom",run:function(actions){actions.auto('.modal-footer button[special=cancel]');}});});;

/* /base_accounting_kit/static/src/js/account_dashboard.js defined in bundle 'web.assets_backend' */
odoo.define('AccountingDashboard.AccountingDashboard',function(require){'use strict';var AbstractAction=require('web.AbstractAction');var ajax=require('web.ajax');var core=require('web.core');var rpc=require('web.rpc');var web_client=require('web.web_client');var _t=core._t;var QWeb=core.qweb;var self=this;var currency;var ActionMenu=AbstractAction.extend({contentTemplate:'Invoicedashboard',events:{'click .invoice_dashboard':'onclick_dashboard','click #prog_bar':'onclick_prog_bar','click #invoice_this_month':'onclick_invoice_this_month','click #invoice_this_year':'onclick_invoice_this_year','click #invoice_last_month':'onclick_invoice_last_month','click #invoice_last_year':'onclick_invoice_last_year','click #onclick_banks_balance':'onclick_bank_balance','click #income_this_month':'onclick_income_this_month','click #income_this_year':'onclick_income_this_year','click #income_last_month':'onclick_income_last_month','click #income_last_year':'onclick_income_last_year','click #total_aged_payable':'onclick_total_aged_payable','click #in_ex_bar_chart':'onclick_in_ex_bar_chart','click #aged_recevable_pie_chart':'onclick_aged_recevable_pie_chart','click #invoice_bar_chart':'onclick_invoice_bar_chart','click .overdue_line_cust':'onclick_overdue_line_cust','click .top_customers':'onclick_top_customers','click .top_customers_amount':'onclick_top_customers_amount','click #bank_balance_hide':'onclick_bank_balance_hide','click #cash_balance_hide':'onclick_cash_balance_hide','click #in_ex_hide':'onclick_in_ex_hide','click #aged_payable_hide':'onclick_aged_payable_hide','change #aged_receivable_values':function(e){e.stopPropagation();var $target=$(e.target);var value=$target.val();this.onclick_aged_payable(this.$('#aged_receivable_values').val());},'change #aged_payable_value':function(e){e.stopPropagation();var $target=$(e.target);var value=$target.val();this.$('.aged_receivable_this_month').empty();this.onclick_aged_receivable(this.$('#aged_payable_value').val());},'change #top_10_customer_value':function(e){e.stopPropagation();var $target=$(e.target);var value=$target.val();this.$('.top_10_customers_this_month').empty();this.onclick_top_10_month(this.$('#top_10_customer_value').val());},'change #toggle-two':'onclick_toggle_two','click #unreconciled_counts_this_year':'unreconciled_year','click #unreconciled_items_':'unreconciled_month','click #total_customer_invoice_paid_current_month':'invoice_month_paid','click #total_customer_invoice_current_month':'invoice_month','click #total_supplier_invoice_paid_current_month':'bill_month_paid','click #total_supplier_invoice_current_month':'bill_month','click #total_customer_invoice_paid_current_year':'invoice_year_paid','click #total_customer_invoice_current_year':'invoice_year','click #total_supplier_invoice_paid_current_year':'bill_year_paid','click #total_supplier_invoice_current_year':'bill_year','click #net_profit_current_year':'profit_income_year','click #net_profit_current_months':'profit_income_month','click #total_incomes_this_year':'total_income_year','click #total_incomes_':'total_income_month','click #total_expense_this_year':'expense_year','click #total_expenses_':'expense_month',},profit_income_year:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_profit_income_year",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Net Profit or Loss'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},profit_income_month:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_profit_income_month",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Net Profit or Loss'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},total_income_year:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_total_income_year",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Total Income'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},total_income_month:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_total_income_month",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Total Income'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},expense_year:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_expense_year",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Total Expenses'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},expense_month:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_expense_month",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Total Expenses'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},unreconciled_year:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_unreconcile_year",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Unreconciled'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},unreconciled_month:function(ev){var posted=false;var self=this;rpc.query({model:"account.move",method:"click_unreconcile_month",args:[posted],}).then(function(result){self.do_action({res_model:'account.move.line',name:_t('Unreconciled'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},invoice_month_paid:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_invoice_month_paid",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Paid'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},invoice_month:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_invoice_month",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Invoice'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},bill_month_paid:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_bill_month_paid",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Paid'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},bill_month:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_bill_month",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Invoice'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},bill_year:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_bill_year",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Invoice'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},bill_year_paid:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_bill_year_paid",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Paid'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},invoice_year:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_invoice_year",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Invoice'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},invoice_year_paid:function(ev){var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
var self=this;rpc.query({model:"account.move",method:"click_invoice_year_paid",args:[posted],}).then(function(result){self.do_action({res_model:'account.move',name:_t('Paid'),views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',domain:[['id','in',result]],});})},onclick_toggle_two:function(ev){this.onclick_aged_payable(this.$('#aged_receivable_values').val());this.onclick_aged_receivable(this.$('#aged_payable_value').val());this.onclick_invoice_this_year(ev);this.onclick_invoice_this_month(ev);this.onclick_income_this_month(ev);this.onclick_income_last_month(ev);this.onclick_income_last_year(ev);this.onclick_income_this_year(ev);},onclick_top_10_month:function(f){var selected=$('.btn.btn-tool.income');var data=$(selected[0]).data();var posted=false;var self=this;var f=f;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:"account.move",method:"get_currency",}).then(function(result){currency=result;})
rpc.query({model:"account.move",method:"get_top_10_customers_month",args:[posted,f]}).then(function(result){$('#top_10_customers').hide();$('#top_10_customers_last_month').hide();$('#top_10_customers_this_month').show();$('#top_10_customers_this_month').empty();var due_count=0;_.forEach(result,function(x){due_count++;var amount=self.format_currency(currency,x.amount);$('#top_10_customers_this_month').append('<li><div id="line_'+x.parent+'" data-user-id="'+x.parent+'">'+x.customers+'</div>'+'<div id="line_'+x.parent+'" data-user-id="'+x.parent+'">'+amount+'</div>'+'</li>');$('#line_'+x.parent).on("click",function(){self.do_action({res_model:'res.partner',name:_t('Partner'),views:[[false,'form']],type:'ir.actions.act_window',res_id:x.parent,});});});})},onclick_income_last_year:function(ev){ev.preventDefault();var selected=$('.btn.btn-tool.income');var data=$(selected[0]).data();var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:'account.move',method:'get_income_last_year',args:[posted],}).then(function(result){$('#net_profit_current_months').hide();$('#net_profit_last_month').hide();$('#net_profit_last_year').show();$('#net_profit_this_year').hide();var ctx=document.getElementById("canvas").getContext('2d');var income=result.income;var expense=result.expense;var profit=result.profit;var labels=result.month;if(window.myCharts!=undefined)
window.myCharts.destroy();window.myCharts=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Income',data:income,backgroundColor:'#66aecf',borderColor:'#66aecf',borderWidth:1,type:'bar',fill:false},{label:'Expense',data:expense,backgroundColor:'#6993d6',borderColor:'#6993d6',borderWidth:1,type:'bar',fill:false},{label:'Profit/Loss',data:profit,backgroundColor:'#0bd465',borderColor:'#0bd465',borderWidth:1,type:'line',fill:false}]},options:{responsive:true,maintainAspectRatio:false,}});})},onclick_income_last_month:function(ev){ev.preventDefault();var selected=$('.btn.btn-tool.income');var data=$(selected[0]).data();var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:'account.move',method:'get_income_last_month',args:[posted],}).then(function(result){$('#net_profit_current_months').hide();$('#net_profit_last_month').show();$('#net_profit_this_year').hide();$('#net_profit_last_year').hide();var ctx=document.getElementById("canvas").getContext('2d');var income=result.income;var expense=result.expense;var profit=result.profit;var labels=result.date;if(window.myCharts!=undefined)
window.myCharts.destroy();window.myCharts=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Income',data:income,backgroundColor:'#66aecf',borderColor:'#66aecf',borderWidth:1,type:'bar',fill:false},{label:'Expense',data:expense,backgroundColor:'#6993d6',borderColor:'#6993d6',borderWidth:1,type:'bar',fill:false},{label:'Profit/Loss',data:profit,backgroundColor:'#0bd465',borderColor:'#0bd465',borderWidth:1,type:'line',fill:false}]},options:{responsive:true,maintainAspectRatio:false,}});})},onclick_income_this_year:function(ev){ev.preventDefault();var selected=$('.btn.btn-tool.income');var data=$(selected[0]).data();var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:'account.move',method:'get_income_this_year',args:[posted],}).then(function(result){$('#net_profit_current_months').hide();$('#net_profit_last_month').hide();$('#net_profit_last_year').hide();$('#net_profit_this_year').show();var ctx=document.getElementById("canvas").getContext('2d');var income=result.income;var expense=result.expense;var profit=result.profit;var labels=result.month;if(window.myCharts!=undefined)
window.myCharts.destroy();window.myCharts=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Income',data:income,backgroundColor:'#66aecf',borderColor:'#66aecf',borderWidth:1,type:'bar',fill:false},{label:'Expense',data:expense,backgroundColor:'#6993d6',borderColor:'#6993d6',borderWidth:1,type:'bar',fill:false},{label:'Profit/Loss',data:profit,backgroundColor:'#0bd465',borderColor:'#0bd465',borderWidth:1,type:'line',fill:false}]},options:{responsive:true,maintainAspectRatio:false,}});})},onclick_invoice_this_year:function(ev){ev.preventDefault();var selected=$('.btn.btn-tool.selected');var data=$(selected[0]).data();var posted=false;var self=this;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:"account.move",method:"get_currency",}).then(function(result){currency=result;})
rpc.query({model:"account.move",method:"get_total_invoice_current_year",args:[posted],}).then(function(result){$('#total_supplier_invoice_paid').hide();$('#total_supplier_invoice').hide();$('#total_customer_invoice_paid').hide();$('#total_customer_invoice').hide();$('#tot_invoice').hide();$('#tot_supplier_inv').hide();$('#total_supplier_invoice_paid_current_month').hide();$('#total_supplier_invoice_current_month').hide();$('#total_customer_invoice_paid_current_month').hide();$('#total_customer_invoice_current_month').hide();$('#tot_invoice_current_month').hide();$('#tot_supplier_inv_current_month').hide();$('#total_supplier_invoice_paid_current_year').empty();$('#total_supplier_invoice_current_year').empty();$('#total_customer_invoice_paid_current_year').empty();$('#total_customer_invoice_current_year').empty();$('#tot_invoice_current_year').empty();$('#tot_supplier_inv_current_year').empty();$('#total_supplier_invoice_paid_current_year').show();$('#total_supplier_invoice_current_year').show();$('#total_customer_invoice_paid_current_year').show();$('#total_customer_invoice_current_year').show();$('#tot_invoice_current_year').show();$('#tot_supplier_inv_current_year').show();var tot_invoice_current_year=result[0][0]
var tot_credit_current_year=result[1][0]
var tot_supplier_inv_current_year=result[2][0]
var tot_supplier_refund_current_year=result[3][0]
var tot_customer_invoice_paid_current_year=result[4][0]
var tot_supplier_invoice_paid_current_year=result[5][0]
var tot_customer_credit_paid_current_year=result[6][0]
var tot_supplier_refund_paid_current_year=result[7][0]
var customer_invoice_total_current_year=(tot_invoice_current_year-tot_credit_current_year).toFixed(2)
var customer_invoice_paid_current_year=(tot_customer_invoice_paid_current_year-tot_customer_credit_paid_current_year).toFixed(2)
var invoice_percentage_current_year=((customer_invoice_total_current_year/customer_invoice_paid_current_year)*100).toFixed(2)
var supplier_invoice_total_current_year=(tot_supplier_inv_current_year-tot_supplier_refund_current_year).toFixed(2)
var supplier_invoice_paid_current_year=(tot_supplier_invoice_paid_current_year-tot_supplier_refund_paid_current_year).toFixed(2)
var supplier_percentage_current_year=((supplier_invoice_total_current_year/supplier_invoice_paid_current_year)*100).toFixed(2)
$('#tot_supplier_inv_current_year').attr("value",supplier_invoice_paid_current_year);$('#tot_supplier_inv_current_year').attr("max",supplier_invoice_total_current_year);$('#tot_invoice_current_year').attr("value",customer_invoice_paid_current_year);$('#tot_invoice_current_year').attr("max",customer_invoice_total_current_year);customer_invoice_paid_current_year=self.format_currency(currency,customer_invoice_paid_current_year);customer_invoice_total_current_year=self.format_currency(currency,customer_invoice_total_current_year);supplier_invoice_paid_current_year=self.format_currency(currency,supplier_invoice_paid_current_year);supplier_invoice_total_current_year=self.format_currency(currency,supplier_invoice_total_current_year);$('#total_customer_invoice_paid_current_year').append('<div class="logo">'+'<span>'+customer_invoice_paid_current_year+'</span><span>Total Paid<span></div>');$('#total_customer_invoice_current_year').append('<div" class="logo">'+'<span>'+customer_invoice_total_current_year+'</span><span>Total Invoice <span></div>');$('#total_supplier_invoice_paid_current_year').append('<div" class="logo">'+'<span>'+supplier_invoice_paid_current_year+'</span><span>Total Paid<span></div>');$('#total_supplier_invoice_current_year').append('<div" class="logo">'+'<span>'+supplier_invoice_total_current_year+'</span><span>Total Invoice<span></div>');})},onclick_invoice_this_month:function(ev){ev.preventDefault();var selected=$('.btn.btn-tool.selected');var data=$(selected[0]).data();var posted=false;var self=this;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:"account.move",method:"get_currency",}).then(function(result){currency=result;})
rpc.query({model:"account.move",method:"get_total_invoice_current_month",args:[posted],}).then(function(result){$('#total_supplier_invoice_paid').hide();$('#total_supplier_invoice').hide();$('#total_customer_invoice_paid').hide();$('#total_customer_invoice').hide();$('#tot_invoice').hide();$('#tot_supplier_inv').hide();$('#total_supplier_invoice_paid_current_month').empty();$('#total_supplier_invoice_current_month').empty();$('#total_customer_invoice_paid_current_month').empty();$('#total_customer_invoice_current_month').empty();$('#tot_invoice_current_month').empty();$('#tot_supplier_inv_current_month').empty();$('#total_supplier_invoice_paid_current_year').hide();$('#total_supplier_invoice_current_year').hide();$('#total_customer_invoice_paid_current_year').hide();$('#total_customer_invoice_current_year').hide();$('#tot_invoice_current_year').hide();$('#tot_supplier_inv_current_year').hide();$('#total_supplier_invoice_paid_current_month').show();$('#total_supplier_invoice_current_month').show();$('#total_customer_invoice_paid_current_month').show();$('#total_customer_invoice_current_month').show();$('#tot_invoice_current_month').show();$('#tot_supplier_inv_current_month').show();var tot_invoice_current_month=result[0][0]
var tot_credit_current_month=result[1][0]
var tot_supplier_inv_current_month=result[2][0]
var tot_supplier_refund_current_month=result[3][0]
var tot_customer_invoice_paid_current_month=result[4][0]
var tot_supplier_invoice_paid_current_month=result[5][0]
var tot_customer_credit_paid_current_month=result[6][0]
var tot_supplier_refund_paid_current_month=result[7][0]
var customer_invoice_total_current_month=(tot_invoice_current_month-tot_credit_current_month).toFixed(2)
var customer_invoice_paid_current_month=(tot_customer_invoice_paid_current_month-tot_customer_credit_paid_current_month).toFixed(2)
var invoice_percentage_current_month=((customer_invoice_total_current_month/customer_invoice_paid_current_month)*100).toFixed(2)
var supplier_invoice_total_current_month=(tot_supplier_inv_current_month-tot_supplier_refund_current_month).toFixed(2)
var supplier_invoice_paid_current_month=(tot_supplier_invoice_paid_current_month-tot_supplier_refund_paid_current_month).toFixed(2)
var supplier_percentage_current_month=((supplier_invoice_total_current_month/supplier_invoice_paid_current_month)*100).toFixed(2)
$('#tot_supplier_inv_current_month').attr("value",supplier_invoice_paid_current_month);$('#tot_supplier_inv_current_month').attr("max",supplier_invoice_total_current_month);$('#tot_invoice_current_month').attr("value",customer_invoice_paid_current_month);$('#tot_invoice_current_month').attr("max",customer_invoice_total_current_month);customer_invoice_paid_current_month=self.format_currency(currency,customer_invoice_paid_current_month);customer_invoice_total_current_month=self.format_currency(currency,customer_invoice_total_current_month);supplier_invoice_paid_current_month=self.format_currency(currency,supplier_invoice_paid_current_month);supplier_invoice_total_current_month=self.format_currency(currency,supplier_invoice_total_current_month);$('#total_customer_invoice_paid_current_month').append('<div class="logo">'+'<span>'+customer_invoice_paid_current_month+'</span><span>Total Paid<span></div>');$('#total_customer_invoice_current_month').append('<div" class="logo">'+'<span>'+customer_invoice_total_current_month+'</span><span>Total Invoice<span></div>');$('#total_supplier_invoice_paid_current_month').append('<div" class="logo">'+'<span>'+supplier_invoice_paid_current_month+'</span><span>Total Paid<span></div>');$('#total_supplier_invoice_current_month').append('<div" class="logo">'+'<span>'+supplier_invoice_total_current_month+'</span><span>Total Invoice<span></div>');})},onclick_income_this_month:function(ev){ev.preventDefault();var selected=$('.btn.btn-tool.income');var data=$(selected[0]).data();var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:'account.move',method:'get_income_this_month',args:[posted],}).then(function(result){var ctx=document.getElementById("canvas").getContext('2d');var income=result.income;var expense=result.expense;var profit=result.profit;var labels=result.date;if(window.myCharts!=undefined)
window.myCharts.destroy();window.myCharts=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Income',data:income,backgroundColor:'#66aecf',borderColor:'#66aecf',borderWidth:1,type:'bar',fill:false},{label:'Expense',data:expense,backgroundColor:'#6993d6',borderColor:'#6993d6',borderWidth:1,type:'bar',fill:false},{label:'Profit/Loss',data:profit,backgroundColor:'#0bd465',borderColor:'#0bd465',borderWidth:1,type:'line',fill:false}]},options:{responsive:true,maintainAspectRatio:false,}});})},onclick_aged_payable:function(f){var arg=f;var selected=$('.btn.btn-tool.expense');var data=$(selected[0]).data();var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:'account.move',method:'get_overdues_this_month_and_year',args:[posted,f],}).then(function(result){$(document).ready(function(){var options={responsive:false};if(window.donut!=undefined)
window.donut.destroy();window.donut=new Chart($("#canvas1"),{type:'doughnut',tooltipFillColor:"rgba(51, 51, 51, 0.55)",data:{labels:result.due_partner,datasets:[{data:result.due_amount,backgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF'],hoverBackgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF']}]},options:{responsive:false}});});})},onclick_aged_receivable:function(f){var selected=$('.btn.btn-tool.expense');var data=$(selected[0]).data();var posted=false;var f=f
if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:'account.move',method:'get_latebillss',args:[posted,f],}).then(function(result){function myFunction(){document.getElementByClass("btn btn-tool dropdown-toggle").text
document.getElementById("aged_receivable_this_month").text}
$(document).ready(function(){var options={responsive:true,legend:{position:'bottom'}};if(window.donuts!=undefined)
window.donuts.destroy();window.donuts=new Chart($("#horizontalbarChart"),{type:'doughnut',tooltipFillColor:"rgba(51, 51, 51, 0.55)",data:{labels:result.bill_partner,datasets:[{data:result.bill_amount,backgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF'],hoverBackgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF']}]},options:{responsive:false}});});})},renderElement:function(ev){var self=this;$.when(this._super()).then(function(ev){$('#toggle-two').bootstrapToggle({on:'View All Entries',off:'View Posted Entries'});var posted=false;if($('#toggle-two')[0].checked==true){posted="posted"}
rpc.query({model:"account.move",method:"get_currency",}).then(function(result){currency=result;})
rpc.query({model:"account.move",method:"get_income_this_month",args:[posted],}).then(function(result){var ctx=document.getElementById("canvas").getContext('2d');var income=result.income;var expense=result.expense;var profit=result.profit;var labels=result.date;if(window.myCharts!=undefined)
window.myCharts.destroy();window.myCharts=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Income',data:income,backgroundColor:'#66aecf',borderColor:'#66aecf',borderWidth:1,type:'bar',fill:false},{label:'Expense',data:expense,backgroundColor:'#6993d6',borderColor:'#6993d6',borderWidth:1,type:'bar',fill:false},{label:'Profit/Loss',data:profit,backgroundColor:'#0bd465',borderColor:'#0bd465',borderWidth:1,type:'line',fill:false}]},options:{responsive:true,maintainAspectRatio:false,}});})
var arg='this_month';rpc.query({model:'account.move',method:'get_overdues_this_month_and_year',args:[posted,arg],}).then(function(result){})
var arg='this_month';rpc.query({model:'account.move',method:'get_overdues_this_month_and_year',args:[posted,arg],}).then(function(result){$(document).ready(function(){var options={responsive:true,legend:{position:'bottom'}};if(window.donut!=undefined)
window.donut.destroy();window.donut=new Chart($("#canvas1"),{type:'doughnut',tooltipFillColor:"rgba(51, 51, 51, 0.55)",data:{labels:result.due_partner,datasets:[{data:result.due_amount,backgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF'],hoverBackgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF']}]},options:{responsive:false}});});})
rpc.query({model:"account.move",method:"get_total_invoice_current_month",args:[posted],}).then(function(result){$('#total_supplier_invoice_paid').hide();$('#total_supplier_invoice').hide();$('#total_customer_invoice_paid').hide();$('#total_customer_invoice').hide();$('#tot_invoice').hide();$('#tot_supplier_inv').hide();$('#total_supplier_invoice_paid_current_month').empty();$('#total_supplier_invoice_current_month').empty();$('#total_customer_invoice_paid_current_month').empty();$('#total_customer_invoice_current_month').empty();$('#tot_invoice_current_month').empty();$('#tot_supplier_inv_current_month').empty();$('#total_supplier_invoice_paid_current_year').hide();$('#total_supplier_invoice_current_year').hide();$('#total_customer_invoice_paid_current_year').hide();$('#total_customer_invoice_current_year').hide();$('#tot_invoice_current_year').hide();$('#tot_supplier_inv_current_year').hide();$('#total_supplier_invoice_paid_current_month').show();$('#total_supplier_invoice_current_month').show();$('#total_customer_invoice_paid_current_month').show();$('#total_customer_invoice_current_month').show();$('#tot_invoice_current_month').show();$('#tot_supplier_inv_current_month').show();var tot_invoice_current_month=result[0][0]
var tot_credit_current_month=result[1][0]
var tot_supplier_inv_current_month=result[2][0]
var tot_supplier_refund_current_month=result[3][0]
var tot_customer_invoice_paid_current_month=result[4][0]
var tot_supplier_invoice_paid_current_month=result[5][0]
var tot_customer_credit_paid_current_month=result[6][0]
var tot_supplier_refund_paid_current_month=result[7][0]
var customer_invoice_total_current_month=(tot_invoice_current_month-tot_credit_current_month).toFixed(2)
var customer_invoice_paid_current_month=(tot_customer_invoice_paid_current_month-tot_customer_credit_paid_current_month).toFixed(2)
var invoice_percentage_current_month=((customer_invoice_total_current_month/customer_invoice_paid_current_month)*100).toFixed(2)
var supplier_invoice_total_current_month=(tot_supplier_inv_current_month-tot_supplier_refund_current_month).toFixed(2)
var supplier_invoice_paid_current_month=(tot_supplier_invoice_paid_current_month-tot_supplier_refund_paid_current_month).toFixed(2)
var supplier_percentage_current_month=((supplier_invoice_total_current_month/supplier_invoice_paid_current_month)*100).toFixed(2)
$('#tot_supplier_inv_current_month').attr("value",supplier_invoice_paid_current_month);$('#tot_supplier_inv_current_month').attr("max",supplier_invoice_total_current_month);$('#tot_invoice_current_month').attr("value",customer_invoice_paid_current_month);$('#tot_invoice_current_month').attr("max",customer_invoice_total_current_month);currency=result[8]
customer_invoice_paid_current_month=self.format_currency(currency,customer_invoice_paid_current_month);customer_invoice_total_current_month=self.format_currency(currency,customer_invoice_total_current_month);supplier_invoice_paid_current_month=self.format_currency(currency,supplier_invoice_paid_current_month);supplier_invoice_total_current_month=self.format_currency(currency,supplier_invoice_total_current_month);$('#total_customer_invoice_paid_current_month').append('<div class="logo">'+'<span>'+customer_invoice_paid_current_month+'</span><span>Total Paid<span></div>');$('#total_customer_invoice_current_month').append('<div" class="logo">'+'<span>'+customer_invoice_total_current_month+'</span><span>Total Invoice<span></div>');$('#total_supplier_invoice_paid_current_month').append('<div" class="logo">'+'<span>'+supplier_invoice_paid_current_month+'</span><span>Total Paid<span></div>');$('#total_supplier_invoice_current_month').append('<div" class="logo">'+'<span>'+supplier_invoice_total_current_month+'</span><span>Total Invoice<span></div>');})
var arg='last_month'
rpc.query({model:'account.move',method:'get_latebillss',args:[posted,arg],}).then(function(result){$(document).ready(function(){var options={responsive:true,legend:{position:'bottom'}};if(window.donuts!=undefined)
window.donuts.destroy();window.donuts=new Chart($("#horizontalbarChart"),{type:'doughnut',tooltipFillColor:"rgba(51, 51, 51, 0.55)",data:{labels:result.bill_partner,datasets:[{data:result.bill_amount,backgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF'],hoverBackgroundColor:['#66aecf ','#6993d6 ','#666fcf','#7c66cf','#9c66cf','#bc66cf ','#b75fcc',' #cb5fbf ',' #cc5f7f ',' #cc6260','#cc815f','#cca15f ','#ccc25f','#b9cf66','#99cf66',' #75cb5f ','#60cc6c','#804D8000','#80B33300','#80CC80CC','#f2552c','#00cccc','#1f2e2e','#993333','#00cca3','#1a1a00','#3399ff','#8066664D','#80991AFF','#808E666FF','#804DB3FF','#801AB399','#80E666B3','#8033991A','#80CC9999','#80B3B31A','#8000E680','#804D8066','#80809980','#80E6FF80','#801AFF33','#80999933','#80FF3380','#80CCCC00','#8066E64D','#804D80CC','#809900B3','#80E64D66','#804DB380','#80FF4D4D','#8099E6E6','#806666FF']}]},options:{responsive:false}});});})
rpc.query({model:"account.move",method:"get_overdues",}).then(function(result){var due_count=0;_.forEach(result,function(x){due_count++;$('#overdues').append('<li><a class="overdue_line_cust" href="#" id="line_'+x.parent+'" data-user-id="'+x.parent+'">'+x.due_partner+'</a>'+'&nbsp;&nbsp;&nbsp;&nbsp;'+'<span>'+x.due_amount+' '+currency+'</span>'+'</li>');});$('#due_count').append('<span class="badge badge-danger">'+due_count+' Due(s)</span>');})
var f='this_month'
rpc.query({model:"account.move",method:"get_top_10_customers_month",args:[posted,f]}).then(function(result){var due_count=0;var amount;$('#top_10_customers_this_month').empty();_.forEach(result,function(x){$('#top_10_customers_this_month').show();due_count++;amount=self.format_currency(currency,x.amount);$('#top_10_customers_this_month').append('<li><div id="line_'+x.parent+'" data-user-id="'+x.parent+'">'+x.customers+'</div>'+'<div id="line_'+x.parent+'" data-user-id="'+x.parent+'">'+amount+'</div>'+'</li>');$('#line_'+x.parent).on("click",function(){self.do_action({res_model:'res.partner',name:_t('Partner'),views:[[false,'form']],type:'ir.actions.act_window',res_id:x.parent,});});});})
rpc.query({model:"account.move",method:"bank_balance",args:[posted]}).then(function(result){var banks=result['banks'];var amount;var balance=result['banking'];var bnk_ids=result['bank_ids'];for(var k=0;k<banks.length;k++){amount=self.format_currency(currency,balance[k]);$('#current_bank_balance').empty()
$('#current_bank_balance').append('<li><div val="'+bnk_ids[k]+'"id="b_'+bnk_ids[k]+'">'+banks[k]+'</div><div>'+amount+'</div></li>');$('#drop_charts_balance').append('<li>'+balance[k].toFixed(2)+'</li>');$('#b_'+bnk_ids[k]).on("click",function(ev){self.do_action({res_model:'account.account',name:_t('Account'),views:[[false,'form']],type:'ir.actions.act_window',res_id:parseInt(this.id.replace('b_','')),});});}})
rpc.query({model:"account.move",method:"get_latebills",}).then(function(result){var late_count=0;_.forEach(result,function(x){late_count++;$('#latebills').append('<li><a class="overdue_line_cust" href="#" id="line_'+x.parent+'" data-user-id="'+x.parent+'">'+x.partner+'<span>'+x.amount+' '+currency+'</span>'+'</a>'+'</li>');});$('#late_count').append('<span class="badge badge-danger">'+late_count+' Late(s)</span>');})
rpc.query({model:"account.move",method:"get_total_invoice",}).then(function(result){var total_invoice=result[0].sum;total_invoice=total_invoice
$('#total_invoice').append('<span>'+total_invoice+' '+currency+'</span> ')})
rpc.query({model:"account.move",method:"get_total_invoice_this_month",args:[posted],}).then(function(result){var invoice_this_month=result[0].sum;if(invoice_this_month){var total_invoices_this_month=invoice_this_month.toFixed(2)
$('#total_invoices_').append('<span>'+total_invoices_this_month+' '+currency+'</span> <div class="title">This month</div>')}})
rpc.query({model:"account.move",method:"get_total_invoice_last_month",}).then(function(result){var invoice_last_month=result[0].sum;var total_invoices_last_month=invoice_last_month
$('#total_invoices_last').append('<span>'+total_invoices_last_month+' '+currency+'</span><div class="title">Last month</div>')})
rpc.query({model:"account.move",method:"unreconcile_items"}).then(function(result){var unreconciled_count=result[0].count;$('#unreconciled_items').append('<span>'+unreconciled_count+' Item(s)</a></span> ')})
rpc.query({model:"account.move",method:"unreconcile_items_this_month",args:[posted],}).then(function(result){var unreconciled_counts_=result[0].count;$('#unreconciled_items_').empty()
$('#unreconciled_items_').append('<span>'+unreconciled_counts_+' Item(s)</span><div class="title">This month</div>')})
rpc.query({model:"account.move",method:"unreconcile_items_this_year",args:[posted],}).then(function(result){var unreconciled_counts_this_year=result[0].count;$('#unreconciled_counts_this_year').empty()
$('#unreconciled_counts_this_year').append('<span>'+unreconciled_counts_this_year+'  Item(s)</span><div class="title">This Year</div>')})
rpc.query({model:"account.move",method:"unreconcile_items_last_year"}).then(function(result){var unreconciled_counts_last_year=result[0].count;$('#unreconciled_counts_last_year').empty()
$('#unreconciled_counts_last_year').append('<span>'+unreconciled_counts_last_year+'  Item(s)</span><div class="title">Last Year</div>')})
rpc.query({model:"account.move",method:"month_income"}).then(function(result){var income=result[0].debit-result[0].credit;income=-income;income=self.format_currency(currency,income);$('#total_income').append('<span>'+income+'</span>')})
rpc.query({model:"account.move",method:"month_income_this_month",args:[posted],}).then(function(result){var incomes_=result[0].debit-result[0].credit;if(incomes_){incomes_=-incomes_;incomes_=self.format_currency(currency,incomes_);$('#total_incomes_').empty()
$('#total_incomes_').append('<span>'+incomes_+'</span><div class="title">This month</div>')}else{incomes_=-incomes_;incomes_=self.format_currency(currency,incomes_);$('#total_incomes_').empty()
$('#total_incomes_').append('<span>'+incomes_+'</span><div class="title">This month</div>')}})
rpc.query({model:"account.move",method:"month_income_last_month"}).then(function(result){var incomes_last=result[0].debit-result[0].credit;incomes_last=-incomes_last;incomes_last=self.format_currency(currency,incomes_last);$('#total_incomes_last').append('<span>'+incomes_last+'</span><div class="title">Last month</div>')})
rpc.query({model:"account.move",method:"month_expense"}).then(function(result){var expense=result[0].debit-result[0].credit;var expenses=expense;expenses=self.format_currency(currency,expenses);$('#total_expense').append('<span>'+expenses+'</span>')})
rpc.query({model:"account.move",method:"month_expense_this_month",args:[posted],}).then(function(result){var expense_this_month=result[0].debit-result[0].credit;if(expense_this_month){var expenses_this_month_=expense_this_month;expenses_this_month_=self.format_currency(currency,expenses_this_month_);$('#total_expenses_').empty()
$('#total_expenses_').append('<span>'+expenses_this_month_+'</span><div class="title">This month</div>')}else{var expenses_this_month_=expense_this_month;expenses_this_month_=self.format_currency(currency,expenses_this_month_);$('#total_expenses_').empty()
$('#total_expenses_').append('<span>'+expenses_this_month_+'</span><div class="title">This month</div>')}})
rpc.query({model:"account.move",method:"month_expense_this_year",args:[posted],}).then(function(result){var expense_this_year=result[0].debit-result[0].credit;if(expense_this_year){var expenses_this_year_=expense_this_year;expenses_this_year_=self.format_currency(currency,expenses_this_year_);$('#total_expense_this_year').empty();$('#total_expense_this_year').append('<span >'+expenses_this_year_+'</span><div class="title">This Year</div>')}else{var expenses_this_year_=expense_this_year;expenses_this_year_=self.format_currency(currency,expenses_this_year_);$('#total_expense_this_year').empty();$('#total_expense_this_year').append('<span >'+expenses_this_year_+'</span><div class="title">This Year</div>')}})
rpc.query({model:"account.move",method:"month_income_last_year"}).then(function(result){var incomes_last_year=result[0].debit-result[0].credit;incomes_last_year=-incomes_last_year
incomes_last_year=self.format_currency(currency,incomes_last_year);$('#total_incomes_last_year').empty();$('#total_incomes_last_year').append('<span>'+incomes_last_year+'</span><div class="title">Last Year</div>')})
rpc.query({model:"account.move",method:"month_income_this_year",args:[posted],}).then(function(result){var incomes_this_year=result[0].debit-result[0].credit;if(incomes_this_year){incomes_this_year=-incomes_this_year;incomes_this_year=self.format_currency(currency,incomes_this_year);$('#total_incomes_this_year').empty();$('#total_incomes_this_year').append('<span>'+incomes_this_year+'</span><div class="title">This Year</div>')}else{incomes_this_year=-incomes_this_year;incomes_this_year=self.format_currency(currency,incomes_this_year);$('#total_incomes_this_year').empty();$('#total_incomes_this_year').append('<span>'+incomes_this_year+'</span><div class="title">This Year</div>')}})
rpc.query({model:"account.move",method:"profit_income_this_month",args:[posted],}).then(function(result){var net_profit=true
if(result[1]==undefined){result[1]=0;if((result[0])>(result[1])){net_profit=result[1]-result[0]}}
if(result[0]==undefined){result[0]=0;}
if((-result[1])>(result[0])){net_profit=-result[1]-result[0]}else if((result[1])>(result[0])){net_profit=-result[1]-result[0]}else{net_profit=-result[1]-result[0]}
var profit_this_months=net_profit;if(profit_this_months){var net_profit_this_months=profit_this_months;net_profit_this_months=self.format_currency(currency,net_profit_this_months);$('#net_profit_current_months').empty();$('#net_profit_current_months').append('<span>'+net_profit_this_months+'</span> <div class="title">This Month</div>')}else{var net_profit_this_months=profit_this_months;net_profit_this_months=self.format_currency(currency,net_profit_this_months);$('#net_profit_current_months').empty();$('#net_profit_current_months').append('<span>'+net_profit_this_months+'</span> <div class="title">This Month</div>')}})
rpc.query({model:"account.move",method:"profit_income_this_year",args:[posted],}).then(function(result){var net_profit=true
if(result[1]==undefined){result[1]=0;if((result[0])>(result[1])){net_profit=result[1]-result[0]}}
if(result[0]==undefined){result[0]=0;}
if((-result[1])>(result[0])){net_profit=-result[1]-result[0]}else if((result[1])>(result[0])){net_profit=-result[1]-result[0]}else{net_profit=-result[1]-result[0]}
var profit_this_year=net_profit;if(profit_this_year){var net_profit_this_year=profit_this_year;net_profit_this_year=self.format_currency(currency,net_profit_this_year);$('#net_profit_current_year').empty();$('#net_profit_current_year').append('<span>'+net_profit_this_year+'</span> <div class="title">This Year</div>')}else{var net_profit_this_year=profit_this_year;net_profit_this_year=self.format_currency(currency,net_profit_this_year);$('#net_profit_current_year').empty();$('#net_profit_current_year').append('<span>'+net_profit_this_year+'</span> <div class="title">This Year</div>')}})});},format_currency:function(currency,amount){if(typeof(amount)!='number'){amount=parseFloat(amount);}
var formatted_value=(parseInt(amount)).toLocaleString(currency.language,{minimumFractionDigits:2})
if(currency.position==="after"){return formatted_value+=' '+currency.symbol;}else{return currency.symbol+' '+formatted_value;}},willStart:function(){var self=this;self.drpdn_show=false;return Promise.all([ajax.loadLibs(this),this._super()]);},});core.action_registry.add('invoice_dashboard',ActionMenu);});;

/* /base_accounting_kit/static/src/js/payment_model.js defined in bundle 'web.assets_backend' */
odoo.define('base_accounting_kit.ReconciliationModel',function(require){"use strict";var BasicModel=require('web.BasicModel');var field_utils=require('web.field_utils');var utils=require('web.utils');var session=require('web.session');var WarningDialog=require('web.CrashManager').WarningDialog;var core=require('web.core');var _t=core._t;var StatementModel=BasicModel.extend({avoidCreate:false,quickCreateFields:['account_id','amount','analytic_account_id','label','tax_ids','force_tax_included','analytic_tag_ids','to_check'],modes:['create','match_rp','match_other'],init:function(parent,options){this._super.apply(this,arguments);this.reconcileModels=[];this.lines={};this.valuenow=0;this.valuemax=0;this.alreadyDisplayed=[];this.domain=[];this.defaultDisplayQty=options&&options.defaultDisplayQty||10;this.limitMoveLines=options&&options.limitMoveLines||15;this.display_context='init';},addProposition:function(handle,mv_line_id){var self=this;var line=this.getLine(handle);var prop=_.clone(_.find(line['mv_lines_'+line.mode],{'id':mv_line_id}));this._addProposition(line,prop);line['mv_lines_'+line.mode]=_.filter(line['mv_lines_'+line.mode],l=>l['id']!=mv_line_id);line.reconciliation_proposition=_.filter(line.reconciliation_proposition,function(prop){return prop&&!prop.invalid;});if(!line.st_line.partner_id&&line.reconciliation_proposition&&line.reconciliation_proposition.length==1&&prop.partner_id&&line.type===undefined){return this.changePartner(handle,{'id':prop.partner_id,'display_name':prop.partner_name},true);}
return Promise.all([this._computeLine(line),this._performMoveLine(handle,'match_rp',line.mode=='match_rp'?1:0),this._performMoveLine(handle,'match_other',line.mode=='match_other'?1:0)]);},changeFilter:function(handle,filter){var line=this.getLine(handle);line['filter_'+line.mode]=filter;line['mv_lines_'+line.mode]=[];return this._performMoveLine(handle,line.mode);},changeMode:function(handle,mode){var self=this;var line=this.getLine(handle);if(mode==='default'){var match_requests=self.modes.filter(x=>x.startsWith('match')).map(x=>this._performMoveLine(handle,x))
return Promise.all(match_requests).then(function(){return self.changeMode(handle,self._getDefaultMode(handle));});}
if(mode==='next'){var available_modes=self._getAvailableModes(handle)
mode=available_modes[(available_modes.indexOf(line.mode)+1)%available_modes.length];}
line.mode=mode;if(['match_rp','match_other'].includes(line.mode)){if(!(line['mv_lines_'+line.mode]&&line['mv_lines_'+line.mode].length)){return this._performMoveLine(handle,line.mode);}else{return this._formatMoveLine(handle,line.mode,[]);}}
if(line.mode==='create'){return this.createProposition(handle);}
return Promise.resolve();},changeOffset:function(handle){var line=this.getLine(handle);return this._performMoveLine(handle,line.mode);},changePartner:function(handle,partner,preserveMode){var self=this;var line=this.getLine(handle);line.st_line.partner_id=partner&&partner.id;line.st_line.partner_name=partner&&partner.display_name||'';line.mv_lines_match_rp=[];line.mv_lines_match_other=[];return Promise.resolve(partner&&this._changePartner(handle,partner.id)).then(function(){if(line.st_line.partner_id){_.each(line.reconciliation_proposition,function(prop){if(prop.partner_id!=line.st_line.partner_id){line.reconciliation_proposition=[];return false;}});}
return self._computeLine(line);}).then(function(){return self.changeMode(handle,preserveMode?line.mode:'default',true);})},closeStatement:function(){var self=this;return this._rpc({model:'account.bank.statement.line',method:'button_confirm_bank',args:[self.bank_statement_line_id.id],}).then(function(){return self.bank_statement_line_id.id;});},createProposition:function(handle){var line=this.getLine(handle);var prop=_.filter(line.reconciliation_proposition,'__focus');prop=this._formatQuickCreate(line);line.reconciliation_proposition.push(prop);line.createForm=_.pick(prop,this.quickCreateFields);return this._computeLine(line);},getContext:function(){return this.context;},getStatementLines:function(){var self=this;var linesToDisplay=_.pick(this.lines,function(value,key,object){if(value.visible===true&&self.alreadyDisplayed.indexOf(key)===-1){self.alreadyDisplayed.push(key);return object;}});return linesToDisplay;},hasMoreLines:function(){var notDisplayed=_.filter(this.lines,function(line){return!line.visible;});if(notDisplayed.length>0){return true;}
return false;},getLine:function(handle){return this.lines[handle];},load:function(context){var self=this;this.context=context;this.statement_line_ids=context.statement_line_ids;if(this.statement_line_ids===undefined){return self._rpc({model:'account.bank.statement.line',method:'search_read',fields:['id'],domain:[['journal_id','=?',context.active_id]],}).then(function(result){self.statement_line_ids=result.map(r=>r.id);return self.reload()})}else{return self.reload();}},loadMore:function(qty){if(qty===undefined){qty=this.defaultDisplayQty;}
var ids=_.pluck(this.lines,'id');ids=ids.splice(this.pagerIndex,qty);this.pagerIndex+=qty;return this.loadData(ids,this._getExcludedIds());},loadData:function(ids){var self=this;var excluded_ids=this._getExcludedIds();return self._rpc({model:'account.reconciliation.widget',method:'get_bank_statement_line_data',args:[ids,excluded_ids],context:self.context,}).then(function(res){return self._formatLine(res['lines']);})},reload:function(){var self=this;self.alreadyDisplayed=[];self.lines={};self.pagerIndex=0;var def_statement=this._rpc({model:'account.reconciliation.widget',method:'get_bank_statement_data',kwargs:{"bank_statement_line_ids":self.statement_line_ids,"srch_domain":self.domain},context:self.context,}).then(function(statement){self.statement=statement;self.bank_statement_line_id=self.statement_line_ids.length===1?{id:self.statement_line_ids[0],display_name:statement.statement_name}:false;self.valuenow=self.valuenow||statement.value_min;self.valuemax=self.valuemax||statement.value_max;self.context.journal_id=statement.journal_id;_.each(statement.lines,function(res){var handle=_.uniqueId('rline');self.lines[handle]={id:res.st_line.id,partner_id:res.st_line.partner_id,handle:handle,reconciled:false,mode:'inactive',mv_lines_match_rp:[],mv_lines_match_other:[],filter_match_rp:"",filter_match_other:"",reconciliation_proposition:[],reconcileModels:[],};});});var domainReconcile=[];if(self.context&&self.context.company_ids){domainReconcile.push(['company_id','in',self.context.company_ids]);}
if(self.context&&self.context.active_model==='account.journal'&&self.context.active_ids){domainReconcile.push('|');domainReconcile.push(['match_journal_ids','=',false]);domainReconcile.push(['match_journal_ids','in',self.context.active_ids]);}
var def_reconcileModel=this._loadReconciliationModel({domainReconcile:domainReconcile});var def_account=this._rpc({model:'account.account',method:'search_read',fields:['code'],}).then(function(accounts){self.accounts=_.object(_.pluck(accounts,'id'),_.pluck(accounts,'code'));});var def_taxes=self._loadTaxes();return Promise.all([def_statement,def_reconcileModel,def_account,def_taxes]).then(function(){_.each(self.lines,function(line){line.reconcileModels=self.reconcileModels;});var ids=_.pluck(self.lines,'id');ids=ids.splice(0,self.defaultDisplayQty);self.pagerIndex=ids.length;return self._formatLine(self.statement.lines);});},_readAnalyticTags:function(params){var self=this;this.analyticTags={};if(!params||!params.res_ids||!params.res_ids.length){return $.when();}
var fields=(params&&params.fields||[]).concat(['id','display_name']);return this._rpc({model:'account.analytic.tag',method:'read',args:[params.res_ids,fields,],}).then(function(tags){for(var i=0;i<tags.length;i++){var tag=tags[i];self.analyticTags[tag.id]=tag;}});},_loadReconciliationModel:function(params){var self=this;return this._rpc({model:'account.reconcile.model',method:'search_read',domain:params.domainReconcile||[],}).then(function(reconcileModels){var analyticTagIds=[];for(var i=0;i<reconcileModels.length;i++){var modelTags=reconcileModels[i].analytic_tag_ids||[];for(var j=0;j<modelTags.length;j++){if(analyticTagIds.indexOf(modelTags[j])===-1){analyticTagIds.push(modelTags[j]);}}}
return self._readAnalyticTags({res_ids:analyticTagIds}).then(function(){for(var i=0;i<reconcileModels.length;i++){var recModel=reconcileModels[i];var analyticTagData=[];var modelTags=reconcileModels[i].analytic_tag_ids||[];for(var j=0;j<modelTags.length;j++){var tagId=modelTags[j];analyticTagData.push([tagId,self.analyticTags[tagId].display_name])}
recModel.analytic_tag_ids=analyticTagData;}
self.reconcileModels=reconcileModels;});});},_loadTaxes:function(){var self=this;self.taxes={};return this._rpc({model:'account.tax',method:'search_read',fields:['price_include','name'],}).then(function(taxes){_.each(taxes,function(tax){self.taxes[tax.id]={price_include:tax.price_include,display_name:tax.name,};});return taxes;});},quickCreateProposition:function(handle,reconcileModelId){var self=this;var line=this.getLine(handle);var reconcileModel=_.find(this.reconcileModels,function(r){return r.id===reconcileModelId;});var fields=['account_id','amount','amount_type','analytic_account_id','journal_id','label','force_tax_included','tax_ids','analytic_tag_ids','to_check','amount_from_label_regex','decimal_separator'];this._blurProposition(handle);var focus=this._formatQuickCreate(line,_.pick(reconcileModel,fields));focus.reconcileModelId=reconcileModelId;line.reconciliation_proposition.push(focus);var defs=[];if(reconcileModel.has_second_line){defs.push(self._computeLine(line).then(function(){var second={};_.each(fields,function(key){second[key]=("second_"+key)in reconcileModel?reconcileModel["second_"+key]:reconcileModel[key];});var second_focus=self._formatQuickCreate(line,second);second_focus.reconcileModelId=reconcileModelId;line.reconciliation_proposition.push(second_focus);self._computeReconcileModels(handle,reconcileModelId);}))}
return Promise.all(defs).then(function(){line.createForm=_.pick(focus,self.quickCreateFields);return self._computeLine(line);})},removeProposition:function(handle,id){var self=this;var line=this.getLine(handle);var defs=[];var prop=_.find(line.reconciliation_proposition,{'id':id});if(prop){line.reconciliation_proposition=_.filter(line.reconciliation_proposition,function(p){return p.id!==prop.id&&p.id!==prop.link&&p.link!==prop.id&&(!p.link||p.link!==prop.link);});if(prop['reconcileModelId']===undefined){if(['receivable','payable','liquidity'].includes(prop.account_type)){line.mv_lines_match_rp.unshift(prop);}else{line.mv_lines_match_other.unshift(prop);}}
if(line.reconciliation_proposition.length==0&&line.st_line.has_no_partner)
defs.push(self.changePartner(line.handle));}
line.mode=(id||line.mode!=="create")&&isNaN(id)?'create':'match_rp';defs.push(this._computeLine(line));return Promise.all(defs).then(function(){return self.changeMode(handle,line.mode,true);})},getPartialReconcileAmount:function(handle,data){var line=this.getLine(handle);var formatOptions={currency_id:line.st_line.currency_id,noSymbol:true,};var prop=_.find(line.reconciliation_proposition,{'id':data.data});if(prop){var amount=prop.partial_amount||prop.amount;var partial=Math.abs(line.balance.amount+amount);if(Math.abs(line.balance.amount)>=Math.abs(amount)){amount=Math.abs(amount);}else if(partial<=Math.abs(prop.amount)&&partial>=0){amount=partial;}else{amount=Math.abs(amount);}
return field_utils.format.monetary(amount,{},formatOptions);}},partialReconcile:function(handle,data){var line=this.getLine(handle);var prop=_.find(line.reconciliation_proposition,{'id':data.mvLineId});if(prop){var amount=data.amount;try{amount=field_utils.parse.float(data.amount);}
catch(err){amount=NaN;}
if(amount>=Math.abs(prop.amount)||amount<=0||isNaN(amount)){delete prop.partial_amount_str;delete prop.partial_amount;if(isNaN(amount)||amount<0){this.do_warn(_.str.sprintf(_t('The amount %s is not a valid partial amount'),data.amount));}
return this._computeLine(line);}
else{var format_options={currency_id:line.st_line.currency_id};prop.partial_amount=(prop.amount>0?1:-1)*amount;prop.partial_amount_str=field_utils.format.monetary(Math.abs(prop.partial_amount),{},format_options);}}
return this._computeLine(line);},updateProposition:function(handle,values){var self=this;var line=this.getLine(handle);var prop=_.last(_.filter(line.reconciliation_proposition,'__focus'));if('to_check'in values&&values.to_check===false){prop.to_check=line.reconciliation_proposition.some(function(rec_prop,index){return rec_prop.id!==prop.id&&rec_prop.to_check;});}
if(!prop){prop=this._formatQuickCreate(line);line.reconciliation_proposition.push(prop);}
_.each(values,function(value,fieldName){if(fieldName==='analytic_tag_ids'){switch(value.operation){case"ADD_M2M":var vids=_.isArray(value.ids)?value.ids:[value.ids];_.each(vids,function(val){if(!_.findWhere(prop.analytic_tag_ids,{id:val.id})){prop.analytic_tag_ids.push(val);}});break;case"FORGET":var id=self.localData[value.ids[0]].ref;prop.analytic_tag_ids=_.filter(prop.analytic_tag_ids,function(val){return val.id!==id;});break;}}
else if(fieldName==='tax_ids'){switch(value.operation){case"ADD_M2M":prop.__tax_to_recompute=true;var vids=_.isArray(value.ids)?value.ids:[value.ids];_.each(vids,function(val){if(!_.findWhere(prop.tax_ids,{id:val.id})){value.ids.price_include=self.taxes[val.id]?self.taxes[val.id].price_include:false;prop.tax_ids.push(val);}});break;case"FORGET":prop.__tax_to_recompute=true;var id=self.localData[value.ids[0]].ref;prop.tax_ids=_.filter(prop.tax_ids,function(val){return val.id!==id;});break;}}
else{prop[fieldName]=values[fieldName];}});if('account_id'in values){prop.account_code=prop.account_id?this.accounts[prop.account_id.id]:'';}
if('amount'in values){prop.base_amount=values.amount;if(prop.reconcileModelId){this._computeReconcileModels(handle,prop.reconcileModelId);}}
if('force_tax_included'in values||'amount'in values||'account_id'in values){prop.__tax_to_recompute=true;}
line.createForm=_.pick(prop,this.quickCreateFields);if(prop.base_amount)
line.createForm.amount=prop.base_amount;if(prop.tax_ids.length!==1){prop.amount=prop.base_amount;line.createForm.force_tax_included=false;}
return this._computeLine(line);},validate:function(handle){var self=this;this.display_context='validate';var handles=[];if(handle){handles=[handle];}else{_.each(this.lines,function(line,handle){if(!line.reconciled&&line.balance&&!line.balance.amount&&line.reconciliation_proposition.length){handles.push(handle);}});}
var ids=[];var values=[];var handlesPromises=[];_.each(handles,function(handle){var line=self.getLine(handle);var props=_.filter(line.reconciliation_proposition,function(prop){return!prop.invalid;});var computeLinePromise;if(props.length===0){props.push(self._formatQuickCreate(line,{account_id:[line.st_line.open_balance_account_id,self.accounts[line.st_line.open_balance_account_id]],}));line.reconciliation_proposition.push(props[0]);computeLinePromise=self._computeLine(line);}
ids.push(line.id);handlesPromises.push(Promise.resolve(computeLinePromise).then(function(){var values_dict={"partner_id":line.st_line.partner_id,"counterpart_aml_dicts":_.map(_.filter(props,function(prop){return!isNaN(prop.id)&&!prop.already_paid;}),self._formatToProcessReconciliation.bind(self,line)),"payment_aml_ids":_.pluck(_.filter(props,function(prop){return!isNaN(prop.id)&&prop.already_paid;}),'id'),"new_aml_dicts":_.map(_.filter(props,function(prop){return isNaN(prop.id)&&prop.display;}),self._formatToProcessReconciliation.bind(self,line)),"to_check":line.to_check,};var currency=session.get_currency(line.st_line.currency_id);var balance=line.balance.amount;if(!utils.float_is_zero(balance,currency.digits[1])){var unreconciled_amount_dict={'account_id':line.st_line.open_balance_account_id,'credit':balance>0?balance:0,'debit':balance<0?-balance:0,'name':line.st_line.name+' : '+_t("Open balance"),};values_dict['new_aml_dicts'].push(unreconciled_amount_dict);}
values.push(values_dict);line.reconciled=true;}));_.each(self.lines,function(other_line){if(other_line!=line){var filtered_prop=other_line.reconciliation_proposition.filter(p=>!line.reconciliation_proposition.map(l=>l.id).includes(p.id));if(filtered_prop.length!=other_line.reconciliation_proposition.length){other_line.need_update=true;other_line.reconciliation_proposition=filtered_prop;}
self._computeLine(line);}})});return Promise.all(handlesPromises).then(function(){return self._rpc({model:'account.reconciliation.widget',method:'process_bank_statement_line',args:[ids,values],context:self.context,}).then(self._validatePostProcess.bind(self)).then(function(){self.valuenow+=handles.length;return{handles:handles};});});},_addProposition:function(line,prop){line.reconciliation_proposition.push(prop);},_blurProposition:function(handle){var line=this.getLine(handle);line.reconciliation_proposition=_.filter(line.reconciliation_proposition,function(l){l.__focus=false;return!l.invalid;});},_changePartner:function(handle,partner_id){var self=this;return this._rpc({model:'res.partner',method:'read',args:[partner_id,["property_account_receivable_id","property_account_payable_id"]],}).then(function(result){if(result.length>0){var line=self.getLine(handle);self.lines[handle].st_line.open_balance_account_id=line.balance.amount<0?result[0]['property_account_payable_id'][0]:result[0]['property_account_receivable_id'][0];}});},_computeLine:function(line){var self=this;var tax_defs=[];var reconciliation_proposition=[];var formatOptions={currency_id:line.st_line.currency_id,};line.to_check=false;_.each(line.reconciliation_proposition,function(prop){if(prop.to_check){line.to_check=true;}
if(prop.tax_repartition_line_id){if(!_.find(line.reconciliation_proposition,{'id':prop.link}).__tax_to_recompute){reconciliation_proposition.push(prop);}
return;}
if(!prop.already_paid&&parseInt(prop.id)){prop.is_move_line=true;}
reconciliation_proposition.push(prop);if(prop.tax_ids&&prop.tax_ids.length&&prop.__tax_to_recompute&&prop.base_amount){reconciliation_proposition=_.filter(reconciliation_proposition,function(p){return!p.tax_repartition_line_id||p.link!==prop.id;});var args=[prop.tax_ids.map(function(el){return el.id;}),prop.base_amount,formatOptions.currency_id];var add_context={'round':true};if(prop.tax_ids.length===1&&line.createForm&&line.createForm.force_tax_included)
add_context.force_price_include=true;tax_defs.push(self._rpc({model:'account.tax',method:'json_friendly_compute_all',args:args,context:$.extend({},self.context||{},add_context),}).then(function(result){_.each(result.taxes,function(tax){var tax_prop=self._formatQuickCreate(line,{'link':prop.id,'tax_ids':tax.tax_ids,'tax_repartition_line_id':tax.tax_repartition_line_id,'tag_ids':tax.tag_ids,'amount':tax.amount,'label':prop.label?prop.label+" "+tax.name:tax.name,'date':prop.date,'account_id':tax.account_id?[tax.account_id,null]:prop.account_id,'analytic':tax.analytic,'__focus':false});prop.tax_exigible=tax.tax_exigibility==='on_payment'?true:undefined;prop.amount=tax.base;prop.amount_str=field_utils.format.monetary(Math.abs(prop.amount),{},formatOptions);prop.invalid=!self._isValid(prop);tax_prop.amount_str=field_utils.format.monetary(Math.abs(tax_prop.amount),{},formatOptions);tax_prop.invalid=prop.invalid;reconciliation_proposition.push(tax_prop);});prop.tag_ids=result.base_tags;}));}else{prop.amount_str=field_utils.format.monetary(Math.abs(prop.amount),{},formatOptions);prop.display=self._isDisplayedProposition(prop);prop.invalid=!self._isValid(prop);}});return Promise.all(tax_defs).then(function(){_.each(reconciliation_proposition,function(prop){prop.__tax_to_recompute=false;});line.reconciliation_proposition=reconciliation_proposition;var amount_currency=0;var total=line.st_line.amount||0;var isOtherCurrencyId=_.uniq(_.pluck(_.reject(reconciliation_proposition,'invalid'),'currency_id'));isOtherCurrencyId=isOtherCurrencyId.length===1&&!total&&isOtherCurrencyId[0]!==formatOptions.currency_id?isOtherCurrencyId[0]:false;_.each(reconciliation_proposition,function(prop){if(!prop.invalid){total-=prop.partial_amount||prop.amount;if(isOtherCurrencyId){amount_currency-=(prop.amount<0?-1:1)*Math.abs(prop.amount_currency);}}});var company_currency=session.get_currency(line.st_line.currency_id);var company_precision=company_currency&&company_currency.digits[1]||2;total=utils.round_decimals(total,company_precision)||0;if(isOtherCurrencyId){var other_currency=session.get_currency(isOtherCurrencyId);var other_precision=other_currency&&other_currency.digits[1]||2;amount_currency=utils.round_decimals(amount_currency,other_precision);}
line.balance={amount:total,amount_str:field_utils.format.monetary(Math.abs(total),{},formatOptions),currency_id:isOtherCurrencyId,amount_currency:isOtherCurrencyId?amount_currency:total,amount_currency_str:isOtherCurrencyId?field_utils.format.monetary(Math.abs(amount_currency),{},{currency_id:isOtherCurrencyId}):false,account_code:self.accounts[line.st_line.open_balance_account_id],};line.balance.show_balance=line.balance.amount_currency!=0;line.balance.type=line.balance.amount_currency?(line.st_line.partner_id?0:-1):1;});},_computeReconcileModels:function(handle,reconcileModelId){var line=this.getLine(handle);var props=_.filter(line.reconciliation_proposition,{'reconcileModelId':reconcileModelId,'__focus':true});if(props.length===2&&props[0].percent&&props[1].percent){if(props[0].percent+props[1].percent===100){props[0].base_amount=props[0].amount=line.st_line.amount-props[1].base_amount;props[0].__tax_to_recompute=true;}}},_formatNameGet:function(value){return value?(value.id?value:{'id':value[0],'display_name':value[1]}):false;},_formatMany2ManyTags:function(value){var res=[];for(var i=0,len=value.length;i<len;i++){res[i]={'id':value[i][0],'display_name':value[i][1]};}
return res;},_formatMany2ManyTagsTax:function(value){var res=[];for(var i=0;i<value.length;i++){res.push({id:value[i],display_name:this.taxes[value[i]]?this.taxes[value[i]].display_name:''});}
return res;},_formatLineProposition:function(line,props){var self=this;if(props.length){_.each(props,function(prop){prop.amount=prop.debit||-prop.credit;prop.label=prop.name;prop.account_id=self._formatNameGet(prop.account_id||line.account_id);prop.is_partially_reconciled=prop.amount_str!==prop.total_amount_str;prop.to_check=!!prop.to_check;});}},_formatLine:function(lines){var self=this;var defs=[];_.each(lines,function(data){var line=_.find(self.lines,function(l){return l.id===data.st_line.id;});line.visible=true;line.limitMoveLines=self.limitMoveLines;_.extend(line,data);self._formatLineProposition(line,line.reconciliation_proposition);if(!line.reconciliation_proposition.length){delete line.reconciliation_proposition;}
defs.push(self._computeLine(line).then(function(){if(!line.st_line.partner_id&&line.reconciliation_proposition.length>0){var hasDifferentPartners=function(prop){return!prop.partner_id||prop.partner_id!=line.reconciliation_proposition[0].partner_id;};if(!_.any(line.reconciliation_proposition,hasDifferentPartners)){return self.changePartner(line.handle,{'id':line.reconciliation_proposition[0].partner_id,'display_name':line.reconciliation_proposition[0].partner_name,},true);}}else if(!line.st_line.partner_id&&line.partner_id&&line.partner_name){return self.changePartner(line.handle,{'id':line.partner_id,'display_name':line.partner_name,},true);}
return true;}).then(function(){return data.write_off?self.quickCreateProposition(line.handle,data.model_id):true;}).then(function(){if(!line.st_line.partner_id&&self.context.partner_id&&self.context.partner_name){return self.changePartner(line.handle,{'id':self.context.partner_id,'display_name':self.context.partner_name,},true);}
return true;}));});return Promise.all(defs);},_formatMoveLine:function(handle,mode,mv_lines){var self=this;var line=this.getLine(handle);line['mv_lines_'+mode]=_.uniq(line['mv_lines_'+mode].concat(mv_lines),l=>l.id);if(mv_lines[0]){line['remaining_'+mode]=mv_lines[0].recs_count-mv_lines.length;}else if(line['mv_lines_'+mode].lenght==0){line['remaining_'+mode]=0;}
this._formatLineProposition(line,mv_lines);if((line.mode=='match_other'||line.mode=="match_rp")&&!line['mv_lines_'+mode].length&&!line['filter_'+mode].length){line.mode=self._getDefaultMode(handle);if(line.mode!=='match_rp'&&line.mode!=='match_other'&&line.mode!=='inactive'){return this._computeLine(line).then(function(){return self.createProposition(handle);});}}else{return this._computeLine(line);}},_getDefaultMode:function(handle){var line=this.getLine(handle);if(line.balance.amount===0&&(!line.st_line.mv_lines_match_rp||line.st_line.mv_lines_match_rp.length===0)&&(!line.st_line.mv_lines_match_other||line.st_line.mv_lines_match_other.length===0)){return'inactive';}
if(line.mv_lines_match_rp&&line.mv_lines_match_rp.length){return'match_rp';}
if(line.mv_lines_match_other&&line.mv_lines_match_other.length){return'match_other';}
return'create';},_getAvailableModes:function(handle){var line=this.getLine(handle);var modes=[]
if(line.mv_lines_match_rp&&line.mv_lines_match_rp.length){modes.push('match_rp')}
if(line.mv_lines_match_other&&line.mv_lines_match_other.length){modes.push('match_other')}
modes.push('create')
return modes},_formatQuickCreate:function(line,values){values=values||{};var today=new moment().utc().format();var account=this._formatNameGet(values.account_id);var formatOptions={currency_id:line.st_line.currency_id,};var amount;switch(values.amount_type){case'percentage':amount=line.balance.amount*values.amount/100;break;case'regex':var matching=line.st_line.name.match(new RegExp(values.amount_from_label_regex))
amount=0;if(matching&&matching.length==2){matching=matching[1].replace(new RegExp('\\D'+values.decimal_separator,'g'),'');matching=matching.replace(values.decimal_separator,'.');amount=parseFloat(matching)||0;amount=line.balance.amount>0?amount:-amount;}
break;case'fixed':amount=values.amount;break;default:amount=values.amount!==undefined?values.amount:line.balance.amount;}
var prop={'id':_.uniqueId('createLine'),'label':values.label||line.st_line.name,'account_id':account,'account_code':account?this.accounts[account.id]:'','analytic_account_id':this._formatNameGet(values.analytic_account_id),'analytic_tag_ids':this._formatMany2ManyTags(values.analytic_tag_ids||[]),'journal_id':this._formatNameGet(values.journal_id),'tax_ids':this._formatMany2ManyTagsTax(values.tax_ids||[]),'tag_ids':values.tag_ids,'tax_repartition_line_id':values.tax_repartition_line_id,'debit':0,'credit':0,'date':values.date?values.date:field_utils.parse.date(today,{},{isUTC:true}),'force_tax_included':values.force_tax_included||false,'base_amount':amount,'percent':values.amount_type==="percentage"?values.amount:null,'link':values.link,'display':true,'invalid':true,'to_check':!!values.to_check,'__tax_to_recompute':true,'__focus':'__focus'in values?values.__focus:true,};if(prop.base_amount){var sign=prop.base_amount<0?-1:1;var amount=field_utils.format.monetary(Math.abs(prop.base_amount),{},formatOptions);prop.base_amount=sign*field_utils.parse.monetary(amount,{},formatOptions);}
prop.amount=prop.base_amount;return prop;},_getExcludedIds:function(){var excludedIds=[];_.each(this.lines,function(line){if(line.reconciliation_proposition){_.each(line.reconciliation_proposition,function(prop){if(parseInt(prop['id'])){excludedIds.push(prop['id']);}});}});return excludedIds;},_isDisplayedProposition:function(prop){return!isNaN(prop.id)||!!prop.account_id;},_isValid:function(prop){return!isNaN(prop.id)||prop.account_id&&prop.amount&&prop.label&&!!prop.label.length;},_performMoveLine:function(handle,mode,limit){limit=limit||this.limitMoveLines;var line=this.getLine(handle);var excluded_ids=_.map(_.union(line.reconciliation_proposition,line.mv_lines_match_rp,line.mv_lines_match_other),function(prop){return _.isNumber(prop.id)?prop.id:null;}).filter(id=>id!=null);var filter=line['filter_'+mode]||"";return this._rpc({model:'account.reconciliation.widget',method:'get_move_lines_for_bank_statement_line',args:[line.id,line.st_line.partner_id,excluded_ids,filter,0,limit,mode==='match_rp'?'rp':'other'],context:this.context,}).then(this._formatMoveLine.bind(this,handle,mode));},_formatToProcessReconciliation:function(line,prop){var amount=-prop.amount;if(prop.partial_amount){amount=-prop.partial_amount;}
var result={name:prop.label,debit:amount>0?amount:0,credit:amount<0?-amount:0,tax_exigible:prop.tax_exigible,analytic_tag_ids:[[6,null,_.pluck(prop.analytic_tag_ids,'id')]]};if(!isNaN(prop.id)){result.counterpart_aml_id=prop.id;}else{result.account_id=prop.account_id.id;if(prop.journal_id){result.journal_id=prop.journal_id.id;}}
if(!isNaN(prop.id))result.counterpart_aml_id=prop.id;if(prop.analytic_account_id)result.analytic_account_id=prop.analytic_account_id.id;if(prop.tax_ids&&prop.tax_ids.length)result.tax_ids=[[6,null,_.pluck(prop.tax_ids,'id')]];if(prop.tag_ids&&prop.tag_ids.length)result.tag_ids=[[6,null,prop.tag_ids]];if(prop.tax_repartition_line_id)result.tax_repartition_line_id=prop.tax_repartition_line_id;if(prop.reconcileModelId)result.reconcile_model_id=prop.reconcileModelId
return result;},_validatePostProcess:function(data){var self=this;return Promise.resolve();},});var ManualModel=StatementModel.extend({quickCreateFields:['account_id','journal_id','amount','analytic_account_id','label','tax_ids','force_tax_included','analytic_tag_ids','date','to_check'],modes:['create','match'],hasMoreLines:function(){if(this.manualLines.length>this.pagerIndex){return true;}
return false;},load:function(context){var self=this;this.context=context;var domain_account_id=[];if(context&&context.company_ids){domain_account_id.push(['company_id','in',context.company_ids]);}
var def_account=this._rpc({model:'account.account',method:'search_read',domain:domain_account_id,fields:['code'],}).then(function(accounts){self.account_ids=_.pluck(accounts,'id');self.accounts=_.object(self.account_ids,_.pluck(accounts,'code'));});var domainReconcile=[];var session_allowed_company_ids=session.user_context.allowed_company_ids||[]
var company_ids=context&&context.company_ids||session_allowed_company_ids.slice(0,1);if(company_ids){domainReconcile.push(['company_id','in',company_ids]);}
var def_reconcileModel=this._loadReconciliationModel({domainReconcile:domainReconcile});var def_taxes=this._loadTaxes();return Promise.all([def_reconcileModel,def_account,def_taxes]).then(function(){switch(context.mode){case'customers':case'suppliers':var mode=context.mode==='customers'?'receivable':'payable';var args=['partner',context.partner_ids||null,mode];return self._rpc({model:'account.reconciliation.widget',method:'get_data_for_manual_reconciliation',args:args,context:context,}).then(function(result){self.manualLines=result;self.valuenow=0;self.valuemax=Object.keys(self.manualLines).length;var lines=self.manualLines.slice(0,self.defaultDisplayQty);self.pagerIndex=lines.length;return self.loadData(lines);});case'accounts':return self._rpc({model:'account.reconciliation.widget',method:'get_data_for_manual_reconciliation',args:['account',context.account_ids||self.account_ids],context:context,}).then(function(result){self.manualLines=result;self.valuenow=0;self.valuemax=Object.keys(self.manualLines).length;var lines=self.manualLines.slice(0,self.defaultDisplayQty);self.pagerIndex=lines.length;return self.loadData(lines);});default:var partner_ids=context.partner_ids||null;var account_ids=context.account_ids||self.account_ids||null;return self._rpc({model:'account.reconciliation.widget',method:'get_all_data_for_manual_reconciliation',args:[partner_ids,account_ids],context:context,}).then(function(result){self.manualLines=[].concat(result.accounts,result.customers,result.suppliers);self.valuenow=0;self.valuemax=Object.keys(self.manualLines).length;var lines=self.manualLines.slice(0,self.defaultDisplayQty);self.pagerIndex=lines.length;return self.loadData(lines);});}});},reload:function(){this.lines={};return this.load(this.context);},loadMore:function(qty){if(qty===undefined){qty=this.defaultDisplayQty;}
var lines=this.manualLines.slice(this.pagerIndex,this.pagerIndex+qty);this.pagerIndex+=qty;return this.loadData(lines);},loadData:function(lines){var self=this;var defs=[];_.each(lines,function(l){defs.push(self._formatLine(l.mode,l));});return Promise.all(defs);},validate:function(handle){var self=this;var handles=[];if(handle){handles=[handle];}else{_.each(this.lines,function(line,handle){if(!line.reconciled&&!line.balance.amount&&line.reconciliation_proposition.length){handles.push(handle);}});}
var def=Promise.resolve();var process_reconciliations=[];var reconciled=[];_.each(handles,function(handle){var line=self.getLine(handle);if(line.reconciled){return;}
var props=line.reconciliation_proposition;if(!props.length){self.valuenow++;reconciled.push(handle);line.reconciled=true;process_reconciliations.push({id:line.type==='accounts'?line.account_id:line.partner_id,type:line.type,mv_line_ids:[],new_mv_line_dicts:[],});}else{var mv_line_ids=_.pluck(_.filter(props,function(prop){return!isNaN(prop.id);}),'id');var new_mv_line_dicts=_.map(_.filter(props,function(prop){return isNaN(prop.id)&&prop.display;}),self._formatToProcessReconciliation.bind(self,line));process_reconciliations.push({id:null,type:null,mv_line_ids:mv_line_ids,new_mv_line_dicts:new_mv_line_dicts});}
line.reconciliation_proposition=[];});if(process_reconciliations.length){def=self._rpc({model:'account.reconciliation.widget',method:'process_move_lines',args:[process_reconciliations],});}
return def.then(function(){var defs=[];var account_ids=[];var partner_ids=[];_.each(handles,function(handle){var line=self.getLine(handle);if(line.reconciled){return;}
line.filter_match="";defs.push(self._performMoveLine(handle,'match').then(function(){if(!line.mv_lines_match.length){self.valuenow++;reconciled.push(handle);line.reconciled=true;if(line.type==='accounts'){account_ids.push(line.account_id.id);}else{partner_ids.push(line.partner_id);}}}));});return Promise.all(defs).then(function(){if(partner_ids.length){self._rpc({model:'res.partner',method:'mark_as_reconciled',args:[partner_ids],});}
return{reconciled:reconciled,updated:_.difference(handles,reconciled)};});});},removeProposition:function(handle,id){var self=this;var line=this.getLine(handle);var defs=[];var prop=_.find(line.reconciliation_proposition,{'id':id});if(prop){line.reconciliation_proposition=_.filter(line.reconciliation_proposition,function(p){return p.id!==prop.id&&p.id!==prop.link&&p.link!==prop.id&&(!p.link||p.link!==prop.link);});line.mv_lines_match=line.mv_lines_match||[];line.mv_lines_match.unshift(prop);if(line.reconciliation_proposition.length==0&&line.st_line.has_no_partner)
defs.push(self.changePartner(line.handle));}
line.mode=(id||line.mode!=="create")&&isNaN(id)?'create':'match';defs.push(this._computeLine(line));return Promise.all(defs).then(function(){return self.changeMode(handle,line.mode,true);})},_computeLine:function(line){return this._super(line).then(function(){var props=_.reject(line.reconciliation_proposition,'invalid');_.each(line.reconciliation_proposition,function(p){delete p.is_move_line;});line.balance.type=-1;if(!line.balance.amount_currency&&props.length){line.balance.type=1;}else if(_.any(props,function(prop){return prop.amount>0;})&&_.any(props,function(prop){return prop.amount<0;})){line.balance.type=0;}});},_formatLine:function(type,data){var line=this.lines[_.uniqueId('rline')]=_.extend(data,{type:type,reconciled:false,mode:'inactive',limitMoveLines:this.limitMoveLines,filter_match:"",reconcileModels:this.reconcileModels,account_id:this._formatNameGet([data.account_id,data.account_name]),st_line:data,visible:true});this._formatLineProposition(line,line.reconciliation_proposition);if(!line.reconciliation_proposition.length){delete line.reconciliation_proposition;}
return this._computeLine(line);},_formatLineProposition:function(line,props){var self=this;this._super(line,props);if(props.length){_.each(props,function(prop){var tmp_value=prop.debit||prop.credit;prop.credit=prop.credit!==0?0:tmp_value;prop.debit=prop.debit!==0?0:tmp_value;prop.amount=-prop.amount;prop.journal_id=self._formatNameGet(prop.journal_id||line.journal_id);prop.to_check=!!prop.to_check;});}},_formatQuickCreate:function(line,values){if(values&&values.journal_id===undefined&&line&&line.createForm&&line.createForm.journal_id){values.journal_id=line.createForm.journal_id;}
return this._super(line,values);},_isDisplayedProposition:function(prop){return!!prop.journal_id&&this._super(prop);},_isValid:function(prop){return prop.journal_id&&this._super(prop);},_performMoveLine:function(handle,mode,limit){limit=limit||this.limitMoveLines;var line=this.getLine(handle);var excluded_ids=_.map(_.union(line.reconciliation_proposition,line.mv_lines_match),function(prop){return _.isNumber(prop.id)?prop.id:null;}).filter(id=>id!=null);var filter=line.filter_match||"";var args=[line.account_id.id,line.partner_id,excluded_ids,filter,0,limit];return this._rpc({model:'account.reconciliation.widget',method:'get_move_lines_for_manual_reconciliation',args:args,context:this.context,}).then(this._formatMoveLine.bind(this,handle,''));},_formatToProcessReconciliation:function(line,prop){var result=this._super(line,prop);result['date']=prop.date;return result;},_getDefaultMode:function(handle){var line=this.getLine(handle);if(line.balance.amount===0&&(!line.st_line.mv_lines_match||line.st_line.mv_lines_match.length===0)){return'inactive';}
return line.mv_lines_match.length>0?'match':'create';},_formatMoveLine:function(handle,mode,mv_lines){var self=this;var line=this.getLine(handle);line.mv_lines_match=_.uniq((line.mv_lines_match||[]).concat(mv_lines),l=>l.id);this._formatLineProposition(line,mv_lines);if(line.mode!=='create'&&!line.mv_lines_match.length&&!line.filter_match.length){line.mode=this.avoidCreate||!line.balance.amount?'inactive':'create';if(line.mode==='create'){return this._computeLine(line).then(function(){return self.createProposition(handle);});}}else{return this._computeLine(line);}},});return{StatementModel:StatementModel,ManualModel:ManualModel,};});;

/* /base_accounting_kit/static/src/js/payment_render.js defined in bundle 'web.assets_backend' */
odoo.define('base_accounting_kit.ReconciliationRenderer',function(require){"use strict";var Widget=require('web.Widget');var FieldManagerMixin=require('web.FieldManagerMixin');var relational_fields=require('web.relational_fields');var basic_fields=require('web.basic_fields');var core=require('web.core');var time=require('web.time');var session=require('web.session');var qweb=core.qweb;var _t=core._t;var StatementRenderer=Widget.extend(FieldManagerMixin,{template:'reconciliation.statement',events:{'click *[rel="do_action"]':'_onDoAction','click button.js_load_more':'_onLoadMore',},init:function(parent,model,state){this._super(parent);this.model=model;this._initialState=state;},start:function(){var self=this;var defs=[this._super.apply(this,arguments)];this.time=Date.now();this.$progress=$('');return Promise.all(defs);},hideLoadMoreButton:function(show){if(!show){this.$('.js_load_more').show();}
else{this.$('.js_load_more').hide();}},showRainbowMan:function(state){if(this.model.display_context!=='validate'){return}
var dt=Date.now()-this.time;var $done=$(qweb.render("reconciliation.done",{'duration':moment(dt).utc().format(time.getLangTimeFormat()),'number':state.valuenow,'timePerTransaction':Math.round(dt/1000/state.valuemax),'context':state.context,}));$done.find('*').addClass('o_reward_subcontent');$done.find('.button_close_statement').click(this._onCloseBankStatement.bind(this));$done.find('.button_back_to_statement').click(this._onGoToBankStatement.bind(this));if(session.show_effect){this.trigger_up('show_effect',{type:'rainbow_man',fadeout:'no',message:$done,});this.$el.css('min-height','450px');}else{$done.appendTo(this.$el);}},update:function(state){var self=this;this._updateProgressBar(state);if(state.valuenow===state.valuemax&&!this.$('.done_message').length){this.showRainbowMan(state);}
if(state.notifications){this._renderNotifications(state.notifications);}},_updateProgressBar:function(state){this.$progress.find('.valuenow').text(state.valuenow);this.$progress.find('.valuemax').text(state.valuemax);this.$progress.find('.progress-bar').attr('aria-valuenow',state.valuenow).attr('aria-valuemax',state.valuemax).css('width',(state.valuenow/state.valuemax*100)+'%');},_renderNotifications:function(notifications){this.$(".notification_area").empty();for(var i=0;i<notifications.length;i++){var $notification=$(qweb.render("reconciliation.notification",notifications[i])).hide();$notification.appendTo(this.$(".notification_area")).slideDown(300);}},_onCloseBankStatement:function(e){this.trigger_up('close_statement');},_onDoAction:function(e){e.preventDefault();var name=e.currentTarget.dataset.action_name;var model=e.currentTarget.dataset.model;if(e.currentTarget.dataset.ids){var ids=e.currentTarget.dataset.ids.split(",").map(Number);var domain=[['id','in',ids]];}else{var domain=e.currentTarget.dataset.domain;}
var context=e.currentTarget.dataset.context;var tag=e.currentTarget.dataset.tag;if(tag){this.do_action({type:'ir.actions.client',tag:tag,context:context,})}else{this.do_action({name:name,res_model:model,domain:domain,context:context,views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',view_mode:"list"});}},_onGoToBankStatement:function(e){var journalId=$(e.target).attr('data_journal_id');if(journalId){journalId=parseInt(journalId);}
$('.o_reward').remove();this.do_action({name:'Bank Statements',res_model:'account.bank.statement',views:[[false,'list'],[false,'form']],type:'ir.actions.act_window',context:{search_default_journal_id:journalId,'journal_type':'bank'},view_mode:'form',});},_onLoadMore:function(e){this.trigger_up('load_more');},});var LineRenderer=Widget.extend(FieldManagerMixin,{template:"reconciliation.line",events:{'click .accounting_view caption .o_buttons button':'_onValidate','click .accounting_view tfoot':'_onChangeTab','click':'_onTogglePanel','click .o_field_widget':'_onStopPropagation','keydown .o_input, .edit_amount_input':'_onStopPropagation','click .o_notebook li a':'_onChangeTab','click .cell':'_onEditAmount','change input.filter':'_onFilterChange','click .match .load-more a':'_onLoadMore','click .match .mv_line td':'_onSelectMoveLine','click .accounting_view tbody .mv_line td':'_onSelectProposition','click .o_reconcile_models button':'_onQuickCreateProposition','click .create .add_line':'_onCreateProposition','click .reconcile_model_create':'_onCreateReconcileModel','click .reconcile_model_edit':'_onEditReconcileModel','keyup input':'_onInputKeyup','blur input':'_onInputKeyup','keydown':'_onKeydown',},custom_events:_.extend({},FieldManagerMixin.custom_events,{'field_changed':'_onFieldChanged',}),_avoidFieldUpdate:{},MV_LINE_DEBOUNCE:200,_onKeydown:function(ev){switch(ev.which){case $.ui.keyCode.ENTER:this.trigger_up('navigation_move',{direction:'validate',handle:this.handle});break;case $.ui.keyCode.UP:ev.stopPropagation();ev.preventDefault();this.trigger_up('navigation_move',{direction:'up',handle:this.handle});break;case $.ui.keyCode.DOWN:ev.stopPropagation();ev.preventDefault();this.trigger_up('navigation_move',{direction:'down',handle:this.handle});break;}},init:function(parent,model,state){this._super(parent);FieldManagerMixin.init.call(this);this.model=model;this._initialState=state;if(this.MV_LINE_DEBOUNCE){this._onSelectMoveLine=_.debounce(this._onSelectMoveLine,this.MV_LINE_DEBOUNCE,true);}else{this._onSelectMoveLine=this._onSelectMoveLine;}},start:function(){var self=this;var def1=this._makePartnerRecord(this._initialState.st_line.partner_id,this._initialState.st_line.partner_name).then(function(recordID){self.fields={partner_id:new relational_fields.FieldMany2One(self,'partner_id',self.model.get(recordID),{mode:'edit',attrs:{placeholder:self._initialState.st_line.communication_partner_name||_t('Select Partner'),}})};self.fields.partner_id.insertAfter(self.$('.accounting_view caption .o_buttons'));});var def3=session.user_has_group('analytic.group_analytic_tags').then(function(has_group){self.group_tags=has_group;});var def4=session.user_has_group('analytic.group_analytic_accounting').then(function(has_group){self.group_acc=has_group;});$('<span class="line_info_button fa fa-info-circle"/>').appendTo(this.$('thead .cell_info_popover')).attr("data-content",qweb.render('reconciliation.line.statement_line.details',{'state':this._initialState}));this.$el.popover({'selector':'.line_info_button','placement':'left','container':this.$el,'html':true,'sanitize':false,'trigger':'hover','animation':false,'toggle':'popover'});var def2=this._super.apply(this,arguments);return Promise.all([def1,def2,def3,def4]);},update:function(state){var self=this;var to_check_checked=!!(state.to_check);this.$('caption .o_buttons button.o_validate').toggleClass('d-none',!!state.balance.type&&!to_check_checked);this.$('caption .o_buttons button.o_reconcile').toggleClass('d-none',state.balance.type<=0||to_check_checked);this.$('caption .o_buttons .o_no_valid').toggleClass('d-none',state.balance.type>=0||to_check_checked);self.$('caption .o_buttons button.o_validate').toggleClass('text-warning',to_check_checked);this._makePartnerRecord(state.st_line.partner_id,state.st_line.partner_name).then(function(recordID){self.fields.partner_id.reset(self.model.get(recordID));self.$el.attr('data-partner',state.st_line.partner_id);});this.$el.data('mode',state.mode).attr('data-mode',state.mode);this.$('.o_notebook li a').attr('aria-selected',false);this.$('.o_notebook li a').removeClass('active');this.$('.o_notebook .tab-content .tab-pane').removeClass('active');this.$('.o_notebook li a[href*="notebook_page_'+state.mode+'"]').attr('aria-selected',true);this.$('.o_notebook li a[href*="notebook_page_'+state.mode+'"]').addClass('active');this.$('.o_notebook .tab-content .tab-pane[id*="notebook_page_'+state.mode+'"]').addClass('active');this.$('.create, .match').each(function(){$(this).removeAttr('style');});var $props=this.$('.accounting_view tbody').empty();var props=[];var balance=state.balance.amount_currency;_.each(state.reconciliation_proposition,function(prop){if(prop.display){props.push(prop);}});_.each(props,function(line){var $line=$(qweb.render("reconciliation.line.mv_line",{'line':line,'state':state,'proposition':true}));if(!isNaN(line.id)){$('<span class="line_info_button fa fa-info-circle"/>').appendTo($line.find('.cell_info_popover')).attr("data-content",qweb.render('reconciliation.line.mv_line.details',{'line':line}));}
$props.append($line);});var matching_modes=self.model.modes.filter(x=>x.startsWith('match'));for(let i=0;i<matching_modes.length;i++){var stateMvLines=state['mv_lines_'+matching_modes[i]]||[];var recs_count=stateMvLines.length>0?stateMvLines[0].recs_count:0;var remaining=state['remaining_'+matching_modes[i]];var $mv_lines=this.$('div[id*="notebook_page_'+matching_modes[i]+'"] .match table tbody').empty();this.$('.o_notebook li a[href*="notebook_page_'+matching_modes[i]+'"]').parent().toggleClass('d-none',stateMvLines.length===0&&!state['filter_'+matching_modes[i]]);_.each(stateMvLines,function(line){var $line=$(qweb.render("reconciliation.line.mv_line",{'line':line,'state':state}));if(!isNaN(line.id)){$('<span class="line_info_button fa fa-info-circle"/>').appendTo($line.find('.cell_info_popover')).attr("data-content",qweb.render('reconciliation.line.mv_line.details',{'line':line}));}
$mv_lines.append($line);});this.$('div[id*="notebook_page_'+matching_modes[i]+'"] .match div.load-more').toggle(remaining>0);this.$('div[id*="notebook_page_'+matching_modes[i]+'"] .match div.load-more span').text(remaining);}
this.$('.popover').remove();this.$('table tfoot').html(qweb.render("reconciliation.line.balance",{'state':state}));if(state.createForm){var createPromise;if(!this.fields.account_id){createPromise=this._renderCreate(state);}
Promise.resolve(createPromise).then(function(){var data=self.model.get(self.handleCreateRecord).data;return self.model.notifyChanges(self.handleCreateRecord,state.createForm).then(function(){return self.model.notifyChanges(self.handleCreateRecord,{analytic_tag_ids:{operation:'REPLACE_WITH',ids:[]}})}).then(function(){var defs=[];_.each(state.createForm.analytic_tag_ids,function(tag){defs.push(self.model.notifyChanges(self.handleCreateRecord,{analytic_tag_ids:{operation:'ADD_M2M',ids:tag}}));});return Promise.all(defs);}).then(function(){return self.model.notifyChanges(self.handleCreateRecord,{tax_ids:{operation:'REPLACE_WITH',ids:[]}})}).then(function(){var defs=[];_.each(state.createForm.tax_ids,function(tag){defs.push(self.model.notifyChanges(self.handleCreateRecord,{tax_ids:{operation:'ADD_M2M',ids:tag}}));});return Promise.all(defs);}).then(function(){var record=self.model.get(self.handleCreateRecord);_.each(self.fields,function(field,fieldName){if(self._avoidFieldUpdate[fieldName])return;if(fieldName==="partner_id")return;if((data[fieldName]||state.createForm[fieldName])&&!_.isEqual(state.createForm[fieldName],data[fieldName])){field.reset(record);}
if(fieldName==='tax_ids'){if(!state.createForm[fieldName].length||state.createForm[fieldName].length>1){$('.create_force_tax_included').addClass('d-none');}
else{$('.create_force_tax_included').removeClass('d-none');var price_include=state.createForm[fieldName][0].price_include;var force_tax_included=state.createForm[fieldName][0].force_tax_included;self.$('.create_force_tax_included input').prop('checked',force_tax_included);self.$('.create_force_tax_included input').prop('disabled',price_include);}}});if(state.to_check){self.$('.create_to_check input').prop('checked',state.to_check).change();}
return true;});});}
this.$('.create .add_line').toggle(!!state.balance.amount_currency);},updatePartialAmount:function(line_id,amount){var $line=this.$('.mv_line[data-line-id='+line_id+']');$line.find('.edit_amount').addClass('d-none');$line.find('.edit_amount_input').removeClass('d-none');$line.find('.edit_amount_input').focus();$line.find('.edit_amount_input').val(amount);$line.find('.line_amount').addClass('d-none');},_destroyPopover:function($el){var popover=$el.data('bs.popover');if(popover){popover.dispose();}},_makePartnerRecord:function(partnerID,partnerName){var field={relation:'res.partner',type:'many2one',name:'partner_id',};if(partnerID){field.value=[partnerID,partnerName];}
return this.model.makeRecord('account.bank.statement.line',[field],{partner_id:{domain:["|",["is_company","=",true],["parent_id","=",false]],options:{no_open:true}}});},_renderCreate:function(state){var self=this;return this.model.makeRecord('account.bank.statement.line',[{relation:'account.account',type:'many2one',name:'account_id',domain:[['company_id','=',state.st_line.company_id],['deprecated','=',false]],},{relation:'account.journal',type:'many2one',name:'journal_id',domain:[['company_id','=',state.st_line.company_id]],},{relation:'account.tax',type:'many2many',name:'tax_ids',domain:[['company_id','=',state.st_line.company_id]],},{relation:'account.analytic.account',type:'many2one',name:'analytic_account_id',},{relation:'account.analytic.tag',type:'many2many',name:'analytic_tag_ids',},{type:'boolean',name:'force_tax_included',},{type:'char',name:'label',},{type:'float',name:'amount',},{type:'char',name:'date',},{type:'boolean',name:'to_check',}],{account_id:{string:_t("Account"),},label:{string:_t("Label")},amount:{string:_t("Account")},}).then(function(recordID){self.handleCreateRecord=recordID;var record=self.model.get(self.handleCreateRecord);self.fields.account_id=new relational_fields.FieldMany2One(self,'account_id',record,{mode:'edit',attrs:{can_create:false}});self.fields.journal_id=new relational_fields.FieldMany2One(self,'journal_id',record,{mode:'edit'});self.fields.tax_ids=new relational_fields.FieldMany2ManyTags(self,'tax_ids',record,{mode:'edit',additionalContext:{append_type_to_tax_name:true}});self.fields.analytic_account_id=new relational_fields.FieldMany2One(self,'analytic_account_id',record,{mode:'edit'});self.fields.analytic_tag_ids=new relational_fields.FieldMany2ManyTags(self,'analytic_tag_ids',record,{mode:'edit'});self.fields.force_tax_included=new basic_fields.FieldBoolean(self,'force_tax_included',record,{mode:'edit'});self.fields.label=new basic_fields.FieldChar(self,'label',record,{mode:'edit'});self.fields.amount=new basic_fields.FieldFloat(self,'amount',record,{mode:'edit'});self.fields.date=new basic_fields.FieldDate(self,'date',record,{mode:'edit'});self.fields.to_check=new basic_fields.FieldBoolean(self,'to_check',record,{mode:'edit'});var $create=$(qweb.render("reconciliation.line.create",{'state':state,'group_tags':self.group_tags,'group_acc':self.group_acc}));self.fields.account_id.appendTo($create.find('.create_account_id .o_td_field')).then(addRequiredStyle.bind(self,self.fields.account_id));self.fields.journal_id.appendTo($create.find('.create_journal_id .o_td_field'));self.fields.tax_ids.appendTo($create.find('.create_tax_id .o_td_field'));self.fields.analytic_account_id.appendTo($create.find('.create_analytic_account_id .o_td_field'));self.fields.analytic_tag_ids.appendTo($create.find('.create_analytic_tag_ids .o_td_field'));self.fields.force_tax_included.appendTo($create.find('.create_force_tax_included .o_td_field'));self.fields.label.appendTo($create.find('.create_label .o_td_field')).then(addRequiredStyle.bind(self,self.fields.label));self.fields.amount.appendTo($create.find('.create_amount .o_td_field')).then(addRequiredStyle.bind(self,self.fields.amount));self.fields.date.appendTo($create.find('.create_date .o_td_field'));self.fields.to_check.appendTo($create.find('.create_to_check .o_td_field'));self.$('.create').append($create);function addRequiredStyle(widget){widget.$el.addClass('o_required_modifier');}});},_onStopPropagation:function(ev){ev.stopPropagation();},_onCreateReconcileModel:function(event){event.preventDefault();var self=this;this.do_action({type:'ir.actions.act_window',res_model:'account.reconcile.model',views:[[false,'form']],target:'current'},{on_reverse_breadcrumb:function(){self.trigger_up('reload');},});},_editAmount:function(event){event.stopPropagation();var $line=$(event.target);var moveLineId=$line.closest('.mv_line').data('line-id');this.trigger_up('partial_reconcile',{'data':{mvLineId:moveLineId,'amount':$line.val()}});},_onEditAmount:function(event){event.preventDefault();event.stopPropagation();if(!$(event.target).hasClass('edit_amount_input')){var $line=$(event.target);this.trigger_up('getPartialAmount',{'data':$line.closest('.mv_line').data('line-id')});}},_onEditReconcileModel:function(event){event.preventDefault();var self=this;this.do_action({type:'ir.actions.act_window',res_model:'account.reconcile.model',views:[[false,'list'],[false,'form']],view_mode:"list",target:'current'},{on_reverse_breadcrumb:function(){self.trigger_up('reload');},});},_onFieldChanged:function(event){event.stopPropagation();var fieldName=event.target.name;if(fieldName==='partner_id'){var partner_id=event.data.changes.partner_id;this.trigger_up('change_partner',{'data':partner_id});}else{if(event.data.changes.amount&&isNaN(event.data.changes.amount)){return;}
this.trigger_up('update_proposition',{'data':event.data.changes});}},_onTogglePanel:function(){if(this.$el[0].getAttribute('data-mode')=='inactive')
this.trigger_up('change_mode',{'data':'default'});},_onChangeTab:function(event){if(event.currentTarget.nodeName==='TFOOT'){this.trigger_up('change_mode',{'data':'next'});}else{var modes=this.model.modes;var selected_mode=modes.find(function(e){return event.target.getAttribute('href').includes(e)});if(selected_mode){this.trigger_up('change_mode',{'data':selected_mode});}}},_onFilterChange:function(event){this.trigger_up('change_filter',{'data':_.str.strip($(event.target).val())});},_onInputKeyup:function(event){var target_partner_id=$(event.target).parents('[name="partner_id"]');if(target_partner_id.length===1){return;}
if(event.keyCode===13){if($(event.target).hasClass('edit_amount_input')){$(event.target).blur();return;}
var created_lines=_.findWhere(this.model.lines,{mode:'create'});if(created_lines&&created_lines.balance.amount){this._onCreateProposition();}
return;}
if($(event.target).hasClass('edit_amount_input')){if(event.type==='keyup'){return;}
else{return this._editAmount(event);}}
var self=this;for(var fieldName in this.fields){var field=this.fields[fieldName];if(!field.$el.is(event.target)){continue;}
this._avoidFieldUpdate[field.name]=event.type!=='focusout';field.value=false;field._setValue($(event.target).val()).then(function(){self._avoidFieldUpdate[field.name]=false;});break;}},_onLoadMore:function(ev){ev.preventDefault();this.trigger_up('change_offset');},_onSelectMoveLine:function(event){var $el=$(event.target);$el.prop('disabled',true);this._destroyPopover($el);var moveLineId=$el.closest('.mv_line').data('line-id');this.trigger_up('add_proposition',{'data':moveLineId});},_onSelectProposition:function(event){var $el=$(event.target);this._destroyPopover($el);var moveLineId=$el.closest('.mv_line').data('line-id');this.trigger_up('remove_proposition',{'data':moveLineId});},_onQuickCreateProposition:function(event){document.activeElement&&document.activeElement.blur();this.trigger_up('quick_create_proposition',{'data':$(event.target).data('reconcile-model-id')});},_onCreateProposition:function(){document.activeElement&&document.activeElement.blur();var invalid=[];_.each(this.fields,function(field){if(!field.isValid()){invalid.push(field.string);}});if(invalid.length){this.do_warn(_t("Some fields are undefined"),invalid.join(', '));return;}
this.trigger_up('create_proposition');},_onValidate:function(){this.trigger_up('validate');}});var ManualRenderer=StatementRenderer.extend({template:"reconciliation.manual.statement",});var ManualLineRenderer=LineRenderer.extend({template:"reconciliation.manual.line",removeProposition:function(handle,id){if(!id){return Promise.resolve();}
return this._super(handle,id);},start:function(){var self=this;return this._super.apply(this,arguments).then(function(){return self.model.makeRecord('account.move.line',[{relation:'account.account',type:'many2one',name:'account_id',value:[self._initialState.account_id.id,self._initialState.account_id.display_name],}]).then(function(recordID){self.fields.title_account_id=new relational_fields.FieldMany2One(self,'account_id',self.model.get(recordID),{mode:'readonly'});}).then(function(){return self.fields.title_account_id.appendTo(self.$('.accounting_view thead td:eq(0) span:first'));});});},update:function(state){this._super(state);var props=_.filter(state.reconciliation_proposition,{'display':true});if(!props.length){var $line=$(qweb.render("reconciliation.line.mv_line",{'line':{},'state':state}));this.$('.accounting_view tbody').append($line);}},_renderCreate:function(state){var self=this;var parentPromise=this._super(state).then(function(){self.$('.create .create_journal_id').show();self.$('.create .create_date').removeClass('d-none');self.$('.create .create_journal_id .o_input').addClass('o_required_modifier');});return parentPromise;},});return{StatementRenderer:StatementRenderer,ManualRenderer:ManualRenderer,LineRenderer:LineRenderer,ManualLineRenderer:ManualLineRenderer,};});;

/* /base_accounting_kit/static/src/js/payment_matching.js defined in bundle 'web.assets_backend' */
odoo.define('base_accounting_kit.ReconciliationClientAction',function(require){"use strict";var AbstractAction=require('web.AbstractAction');var ReconciliationModel=require('base_accounting_kit.ReconciliationModel');var ReconciliationRenderer=require('base_accounting_kit.ReconciliationRenderer');var core=require('web.core');var QWeb=core.qweb;var StatementAction=AbstractAction.extend({hasControlPanel:true,withSearchBar:true,loadControlPanel:true,title:core._t('Bank Reconciliation'),contentTemplate:'reconciliation',custom_events:{change_mode:'_onAction',change_filter:'_onAction',change_offset:'_onAction',change_partner:'_onAction',add_proposition:'_onAction',remove_proposition:'_onAction',update_proposition:'_onAction',create_proposition:'_onAction',getPartialAmount:'_onActionPartialAmount',quick_create_proposition:'_onAction',partial_reconcile:'_onAction',validate:'_onValidate',close_statement:'_onCloseStatement',load_more:'_onLoadMore',reload:'reload',search:'_onSearch',navigation_move:'_onNavigationMove',},config:_.extend({},AbstractAction.prototype.config,{Model:ReconciliationModel.StatementModel,ActionRenderer:ReconciliationRenderer.StatementRenderer,LineRenderer:ReconciliationRenderer.LineRenderer,params:['statement_line_ids'],defaultDisplayQty:10,limitMoveLines:15,}),_onNavigationMove:function(ev){var non_reconciled_keys=_.keys(_.pick(this.model.lines,function(value,key,object){return!value.reconciled}));var currentIndex=_.indexOf(non_reconciled_keys,ev.data.handle);var widget=false;switch(ev.data.direction){case'up':ev.stopPropagation();widget=this._getWidget(non_reconciled_keys[currentIndex-1]);break;case'down':ev.stopPropagation();widget=this._getWidget(non_reconciled_keys[currentIndex+1]);break;case'validate':ev.stopPropagation();widget=this._getWidget(non_reconciled_keys[currentIndex]);widget.$('caption .o_buttons button:visible').click();break;}
if(widget)widget.$el.focus();},init:function(parent,params){this._super.apply(this,arguments);this.action_manager=parent;this.params=params;this.searchModelConfig.modelName='account.bank.statement.line';this.controlPanelProps.cp_content={};this.model=new this.config.Model(this,{modelName:"account.reconciliation.widget",defaultDisplayQty:params.params&&params.params.defaultDisplayQty||this.config.defaultDisplayQty,limitMoveLines:params.params&&params.params.limitMoveLines||this.config.limitMoveLines,});this.widgets=[];_.each(params.params,function(value,name){params.context[name]=name.indexOf('_ids')!==-1?_.map((value+'').split(','),parseFloat):value;});params.params={};_.each(this.config.params,function(name){if(params.context[name]){params.params[name]=params.context[name];}});},willStart:function(){var self=this;var def=this.model.load(this.params.context).then(this._super.bind(this));return def.then(function(){if(!self.model.context||!self.model.context.active_id){self.model.context={'active_id':self.params.context.active_id,'active_model':self.params.context.active_model};}
var journal_id=self.params.context.journal_id;if(self.model.context.active_id&&self.model.context.active_model==='account.journal'){journal_id=journal_id||self.model.context.active_id;}
if(journal_id){var promise=self._rpc({model:'account.journal',method:'read',args:[journal_id,['display_name']],});}else{var promise=Promise.resolve();}
return promise.then(function(result){var title=result&&result[0]?result[0]['display_name']:self.params.display_name||''
self._setTitle(title);self.renderer=new self.config.ActionRenderer(self,self.model,{'bank_statement_line_id':self.model.bank_statement_line_id,'valuenow':self.model.valuenow,'valuemax':self.model.valuemax,'defaultDisplayQty':self.model.defaultDisplayQty,'title':title,});});});},reload:function(){var self=this;self.$('.o_reconciliation_lines').addClass('d-none');_.each(this.widgets,function(widget){widget.destroy();});this.widgets=[];self.$('.o_reconciliation_lines').removeClass('d-none');return this.model.reload().then(function(){return self._renderLinesOrRainbow();});},_renderLinesOrRainbow:function(){var self=this;return self._renderLines().then(function(){var initialState=self.renderer._initialState;var valuenow=self.model.statement?self.model.statement.value_min:initialState.valuenow;var valuemax=self.model.statement?self.model.statement.value_max:initialState.valuemax;if(valuenow===valuemax){initialState.valuenow=valuenow;initialState.context=self.model.getContext();self.renderer.showRainbowMan(initialState);self.remove_cp();}else{if(initialState.valuenow>0)
self.renderer._renderNotifications(self.model.statement.notifications);self._openFirstLine();self.renderer.$('[data-toggle="tooltip"]').tooltip();self.do_show();}});},start:function(){var self=this;var args=arguments;var sup=this._super;return this.renderer.prependTo(self.$('.o_form_sheet')).then(function(){return self._renderLinesOrRainbow().then(function(){self.do_show();return sup.apply(self,args);});});},do_show:function(){this._super.apply(this,arguments);if(this.action_manager){this.$pager=$(QWeb.render('reconciliation.control.pager',{widget:this.renderer}));this.controlPanelProps.cp_content={$pager:this.$pager};this.renderer.$progress=this.$pager;$(this.renderer.$progress).parent().css('width','100%').css('padding-left','0');}},remove_cp:function(){this.controlPanelProps.cp_content={};},_getWidget:function(handle){return _.find(this.widgets,function(widget){return widget.handle===handle;});},_loadMore:function(qty){var self=this;return this.model.loadMore(qty).then(function(){return self._renderLines();});},_openFirstLine:function(previous_handle){var self=this;previous_handle=previous_handle||'rline0';var handle=_.compact(_.map(this.model.lines,function(line,handle){return(line.reconciled||(parseInt(handle.substr(5))<parseInt(previous_handle.substr(5))))?null:handle;}))[0];if(handle){var line=this.model.getLine(handle);this.model.changeMode(handle,'default').then(function(){self._getWidget(handle).update(line);}).guardedCatch(function(){self._getWidget(handle).update(line);}).then(function(){self._getWidget(handle).$el.focus();});}
return handle;},_forceUpdate:function(){var self=this;_.each(this.model.lines,function(handle){var widget=self._getWidget(handle['handle']);if(widget&&handle.need_update){widget.update(handle);widget.need_update=false;}})},_renderLines:function(){var self=this;var linesToDisplay=this.model.getStatementLines();var linePromises=[];_.each(linesToDisplay,function(line,handle){var widget=new self.config.LineRenderer(self,self.model,line);widget.handle=handle;self.widgets.push(widget);linePromises.push(widget.appendTo(self.$('.o_reconciliation_lines')));});if(this.model.hasMoreLines()===false){this.renderer.hideLoadMoreButton(true);}
else{this.renderer.hideLoadMoreButton(false);}
return Promise.all(linePromises);},_onAction:function(event){var self=this;var handle=event.target.handle;var current_line=this.model.getLine(handle);this.model[_.str.camelize(event.name)](handle,event.data.data).then(function(){var widget=self._getWidget(handle);if(widget){widget.update(current_line);}
if(current_line.mode!=='inactive'){_.each(self.model.lines,function(line,_handle){if(line.mode!=='inactive'&&_handle!==handle){self.model.changeMode(_handle,'inactive');var widget=self._getWidget(_handle);if(widget){widget.update(line);}}});}});},_onSearch:function(ev){var self=this;ev.stopPropagation();this.model.domain=ev.data.domain;this.model.display_context='search';self.reload().then(function(){self.renderer._updateProgressBar({'valuenow':self.model.valuenow,'valuemax':self.model.valuemax,});});},_onActionPartialAmount:function(event){var self=this;var handle=event.target.handle;var line=this.model.getLine(handle);var amount=this.model.getPartialReconcileAmount(handle,event.data);self._getWidget(handle).updatePartialAmount(event.data.data,amount);},_onCloseStatement:function(event){var self=this;return this.model.closeStatement().then(function(result){self.do_action({name:'Bank Statements',res_model:'account.bank.statement.line',res_id:result,views:[[false,'form']],type:'ir.actions.act_window',view_mode:'form',});$('.o_reward').remove();});},_onLoadMore:function(event){return this._loadMore(this.model.defaultDisplayQty);},_onValidate:function(event){var self=this;var handle=event.target.handle;this.model.validate(handle).then(function(result){self.renderer.update({'valuenow':self.model.valuenow,'valuemax':self.model.valuemax,'title':self.title,'time':Date.now()-self.time,'notifications':result.notifications,'context':self.model.getContext(),});self._forceUpdate();_.each(result.handles,function(handle){var widget=self._getWidget(handle);if(widget){widget.destroy();var index=_.findIndex(self.widgets,function(widget){return widget.handle===handle;});self.widgets.splice(index,1);}});if(self.widgets.length<self.model.defaultDisplayQty&&self.model.valuemax-self.model.valuenow>=self.model.defaultDisplayQty){var toLoad=self.model.defaultDisplayQty-self.widgets.length;self._loadMore(toLoad);}
self._openFirstLine(handle);});},});var ManualAction=StatementAction.extend({title:core._t('Journal Items to Reconcile'),withSearchBar:false,config:_.extend({},StatementAction.prototype.config,{Model:ReconciliationModel.ManualModel,ActionRenderer:ReconciliationRenderer.ManualRenderer,LineRenderer:ReconciliationRenderer.ManualLineRenderer,params:['company_ids','mode','partner_ids','account_ids'],defaultDisplayQty:30,limitMoveLines:15,}),_onValidate:function(event){var self=this;var handle=event.target.handle;var method='validate';this.model[method](handle).then(function(result){_.each(result.reconciled,function(handle){self._getWidget(handle).destroy();});_.each(result.updated,function(handle){self._getWidget(handle).update(self.model.getLine(handle));});self.renderer.update({valuenow:_.compact(_.invoke(self.widgets,'isDestroyed')).length,valuemax:self.widgets.length,title:self.title,time:Date.now()-self.time,});if(!_.any(result.updated,function(handle){return self.model.getLine(handle).mode!=='inactive';})){self._openFirstLine(handle);}});},});core.action_registry.add('bank_statement_reconciliation_view',StatementAction);core.action_registry.add('manual_reconciliation_view',ManualAction);return{StatementAction:StatementAction,ManualAction:ManualAction,};});;

/* /base_accounting_kit/static/lib/Chart.bundle.js defined in bundle 'web.assets_backend' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):(global.Chart=factory());}(this,(function(){'use strict';var conversions={rgb2hsl:rgb2hsl,rgb2hsv:rgb2hsv,rgb2hwb:rgb2hwb,rgb2cmyk:rgb2cmyk,rgb2keyword:rgb2keyword,rgb2xyz:rgb2xyz,rgb2lab:rgb2lab,rgb2lch:rgb2lch,hsl2rgb:hsl2rgb,hsl2hsv:hsl2hsv,hsl2hwb:hsl2hwb,hsl2cmyk:hsl2cmyk,hsl2keyword:hsl2keyword,hsv2rgb:hsv2rgb,hsv2hsl:hsv2hsl,hsv2hwb:hsv2hwb,hsv2cmyk:hsv2cmyk,hsv2keyword:hsv2keyword,hwb2rgb:hwb2rgb,hwb2hsl:hwb2hsl,hwb2hsv:hwb2hsv,hwb2cmyk:hwb2cmyk,hwb2keyword:hwb2keyword,cmyk2rgb:cmyk2rgb,cmyk2hsl:cmyk2hsl,cmyk2hsv:cmyk2hsv,cmyk2hwb:cmyk2hwb,cmyk2keyword:cmyk2keyword,keyword2rgb:keyword2rgb,keyword2hsl:keyword2hsl,keyword2hsv:keyword2hsv,keyword2hwb:keyword2hwb,keyword2cmyk:keyword2cmyk,keyword2lab:keyword2lab,keyword2xyz:keyword2xyz,xyz2rgb:xyz2rgb,xyz2lab:xyz2lab,xyz2lch:xyz2lch,lab2xyz:lab2xyz,lab2rgb:lab2rgb,lab2lch:lab2lch,lch2lab:lch2lab,lch2xyz:lch2xyz,lch2rgb:lch2rgb};function rgb2hsl(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,l;if(max==min)
h=0;else if(r==max)
h=(g-b)/delta;else if(g==max)
h=2+(b-r)/delta;else if(b==max)
h=4+(r-g)/delta;h=Math.min(h*60,360);if(h<0)
h+=360;l=(min+max)/2;if(max==min)
s=0;else if(l<=0.5)
s=delta/(max+min);else
s=delta/(2-max-min);return[h,s*100,l*100];}
function rgb2hsv(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,v;if(max==0)
s=0;else
s=(delta/max*1000)/10;if(max==min)
h=0;else if(r==max)
h=(g-b)/delta;else if(g==max)
h=2+(b-r)/delta;else if(b==max)
h=4+(r-g)/delta;h=Math.min(h*60,360);if(h<0)
h+=360;v=((max/255)*1000)/10;return[h,s,v];}
function rgb2hwb(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],h=rgb2hsl(rgb)[0],w=1/255*Math.min(r,Math.min(g,b)),b=1-1/255*Math.max(r,Math.max(g,b));return[h,w*100,b*100];}
function rgb2cmyk(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,c,m,y,k;k=Math.min(1-r,1-g,1-b);c=(1-r-k)/(1-k)||0;m=(1-g-k)/(1-k)||0;y=(1-b-k)/(1-k)||0;return[c*100,m*100,y*100,k*100];}
function rgb2keyword(rgb){return reverseKeywords[JSON.stringify(rgb)];}
function rgb2xyz(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;r=r>0.04045?Math.pow(((r+0.055)/1.055),2.4):(r/12.92);g=g>0.04045?Math.pow(((g+0.055)/1.055),2.4):(g/12.92);b=b>0.04045?Math.pow(((b+0.055)/1.055),2.4):(b/12.92);var x=(r*0.4124)+(g*0.3576)+(b*0.1805);var y=(r*0.2126)+(g*0.7152)+(b*0.0722);var z=(r*0.0193)+(g*0.1192)+(b*0.9505);return[x*100,y*100,z*100];}
function rgb2lab(rgb){var xyz=rgb2xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2],l,a,b;x/=95.047;y/=100;z/=108.883;x=x>0.008856?Math.pow(x,1/3):(7.787*x)+(16/116);y=y>0.008856?Math.pow(y,1/3):(7.787*y)+(16/116);z=z>0.008856?Math.pow(z,1/3):(7.787*z)+(16/116);l=(116*y)-16;a=500*(x-y);b=200*(y-z);return[l,a,b];}
function rgb2lch(args){return lab2lch(rgb2lab(args));}
function hsl2rgb(hsl){var h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100,t1,t2,t3,rgb,val;if(s==0){val=l*255;return[val,val,val];}
if(l<0.5)
t2=l*(1+s);else
t2=l+s-l*s;t1=2*l-t2;rgb=[0,0,0];for(var i=0;i<3;i++){t3=h+1/3*-(i-1);t3<0&&t3++;t3>1&&t3--;if(6*t3<1)
val=t1+(t2-t1)*6*t3;else if(2*t3<1)
val=t2;else if(3*t3<2)
val=t1+(t2-t1)*(2/3-t3)*6;else
val=t1;rgb[i]=val*255;}
return rgb;}
function hsl2hsv(hsl){var h=hsl[0],s=hsl[1]/100,l=hsl[2]/100,sv,v;if(l===0){return[0,0,0];}
l*=2;s*=(l<=1)?l:2-l;v=(l+s)/2;sv=(2*s)/(l+s);return[h,sv*100,v*100];}
function hsl2hwb(args){return rgb2hwb(hsl2rgb(args));}
function hsl2cmyk(args){return rgb2cmyk(hsl2rgb(args));}
function hsl2keyword(args){return rgb2keyword(hsl2rgb(args));}
function hsv2rgb(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6;var f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-(s*f)),t=255*v*(1-(s*(1-f))),v=255*v;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q];}}
function hsv2hsl(hsv){var h=hsv[0],s=hsv[1]/100,v=hsv[2]/100,sl,l;l=(2-s)*v;sl=s*v;sl/=(l<=1)?l:2-l;sl=sl||0;l/=2;return[h,sl*100,l*100];}
function hsv2hwb(args){return rgb2hwb(hsv2rgb(args))}
function hsv2cmyk(args){return rgb2cmyk(hsv2rgb(args));}
function hsv2keyword(args){return rgb2keyword(hsv2rgb(args));}
function hwb2rgb(hwb){var h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl,i,v,f,n;if(ratio>1){wh/=ratio;bl/=ratio;}
i=Math.floor(6*h);v=1-bl;f=6*h-i;if((i&0x01)!=0){f=1-f;}
n=wh+f*(v-wh);switch(i){default:case 6:case 0:r=v;g=n;b=wh;break;case 1:r=n;g=v;b=wh;break;case 2:r=wh;g=v;b=n;break;case 3:r=wh;g=n;b=v;break;case 4:r=n;g=wh;b=v;break;case 5:r=v;g=wh;b=n;break;}
return[r*255,g*255,b*255];}
function hwb2hsl(args){return rgb2hsl(hwb2rgb(args));}
function hwb2hsv(args){return rgb2hsv(hwb2rgb(args));}
function hwb2cmyk(args){return rgb2cmyk(hwb2rgb(args));}
function hwb2keyword(args){return rgb2keyword(hwb2rgb(args));}
function cmyk2rgb(cmyk){var c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100,r,g,b;r=1-Math.min(1,c*(1-k)+k);g=1-Math.min(1,m*(1-k)+k);b=1-Math.min(1,y*(1-k)+k);return[r*255,g*255,b*255];}
function cmyk2hsl(args){return rgb2hsl(cmyk2rgb(args));}
function cmyk2hsv(args){return rgb2hsv(cmyk2rgb(args));}
function cmyk2hwb(args){return rgb2hwb(cmyk2rgb(args));}
function cmyk2keyword(args){return rgb2keyword(cmyk2rgb(args));}
function xyz2rgb(xyz){var x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100,r,g,b;r=(x*3.2406)+(y*-1.5372)+(z*-0.4986);g=(x*-0.9689)+(y*1.8758)+(z*0.0415);b=(x*0.0557)+(y*-0.2040)+(z*1.0570);r=r>0.0031308?((1.055*Math.pow(r,1.0/2.4))-0.055):r=(r*12.92);g=g>0.0031308?((1.055*Math.pow(g,1.0/2.4))-0.055):g=(g*12.92);b=b>0.0031308?((1.055*Math.pow(b,1.0/2.4))-0.055):b=(b*12.92);r=Math.min(Math.max(0,r),1);g=Math.min(Math.max(0,g),1);b=Math.min(Math.max(0,b),1);return[r*255,g*255,b*255];}
function xyz2lab(xyz){var x=xyz[0],y=xyz[1],z=xyz[2],l,a,b;x/=95.047;y/=100;z/=108.883;x=x>0.008856?Math.pow(x,1/3):(7.787*x)+(16/116);y=y>0.008856?Math.pow(y,1/3):(7.787*y)+(16/116);z=z>0.008856?Math.pow(z,1/3):(7.787*z)+(16/116);l=(116*y)-16;a=500*(x-y);b=200*(y-z);return[l,a,b];}
function xyz2lch(args){return lab2lch(xyz2lab(args));}
function lab2xyz(lab){var l=lab[0],a=lab[1],b=lab[2],x,y,z,y2;if(l<=8){y=(l*100)/903.3;y2=(7.787*(y/100))+(16/116);}else{y=100*Math.pow((l+16)/116,3);y2=Math.pow(y/100,1/3);}
x=x/95.047<=0.008856?x=(95.047*((a/500)+y2-(16/116)))/7.787:95.047*Math.pow((a/500)+y2,3);z=z/108.883<=0.008859?z=(108.883*(y2-(b/200)-(16/116)))/7.787:108.883*Math.pow(y2-(b/200),3);return[x,y,z];}
function lab2lch(lab){var l=lab[0],a=lab[1],b=lab[2],hr,h,c;hr=Math.atan2(b,a);h=hr*360/2/Math.PI;if(h<0){h+=360;}
c=Math.sqrt(a*a+b*b);return[l,c,h];}
function lab2rgb(args){return xyz2rgb(lab2xyz(args));}
function lch2lab(lch){var l=lch[0],c=lch[1],h=lch[2],a,b,hr;hr=h/360*2*Math.PI;a=c*Math.cos(hr);b=c*Math.sin(hr);return[l,a,b];}
function lch2xyz(args){return lab2xyz(lch2lab(args));}
function lch2rgb(args){return lab2rgb(lch2lab(args));}
function keyword2rgb(keyword){return cssKeywords[keyword];}
function keyword2hsl(args){return rgb2hsl(keyword2rgb(args));}
function keyword2hsv(args){return rgb2hsv(keyword2rgb(args));}
function keyword2hwb(args){return rgb2hwb(keyword2rgb(args));}
function keyword2cmyk(args){return rgb2cmyk(keyword2rgb(args));}
function keyword2lab(args){return rgb2lab(keyword2rgb(args));}
function keyword2xyz(args){return rgb2xyz(keyword2rgb(args));}
var cssKeywords={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var reverseKeywords={};for(var key in cssKeywords){reverseKeywords[JSON.stringify(cssKeywords[key])]=key;}
var convert=function(){return new Converter();};for(var func in conversions){convert[func+"Raw"]=(function(func){return function(arg){if(typeof arg=="number")
arg=Array.prototype.slice.call(arguments);return conversions[func](arg);}})(func);var pair=/(\w+)2(\w+)/.exec(func),from=pair[1],to=pair[2];convert[from]=convert[from]||{};convert[from][to]=convert[func]=(function(func){return function(arg){if(typeof arg=="number")
arg=Array.prototype.slice.call(arguments);var val=conversions[func](arg);if(typeof val=="string"||val===undefined)
return val;for(var i=0;i<val.length;i++)
val[i]=Math.round(val[i]);return val;}})(func);}
var Converter=function(){this.convs={};};Converter.prototype.routeSpace=function(space,args){var values=args[0];if(values===undefined){return this.getValues(space);}
if(typeof values=="number"){values=Array.prototype.slice.call(args);}
return this.setValues(space,values);};Converter.prototype.setValues=function(space,values){this.space=space;this.convs={};this.convs[space]=values;return this;};Converter.prototype.getValues=function(space){var vals=this.convs[space];if(!vals){var fspace=this.space,from=this.convs[fspace];vals=convert[fspace][space](from);this.convs[space]=vals;}
return vals;};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(space){Converter.prototype[space]=function(vals){return this.routeSpace(space,arguments);};});var colorConvert=convert;var colorName={"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aqua":[0,255,255],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"black":[0,0,0],"blanchedalmond":[255,235,205],"blue":[0,0,255],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"fuchsia":[255,0,255],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"gray":[128,128,128],"green":[0,128,0],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"lime":[0,255,0],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"maroon":[128,0,0],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"navy":[0,0,128],"oldlace":[253,245,230],"olive":[128,128,0],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"purple":[128,0,128],"rebeccapurple":[102,51,153],"red":[255,0,0],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"silver":[192,192,192],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"teal":[0,128,128],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"white":[255,255,255],"whitesmoke":[245,245,245],"yellow":[255,255,0],"yellowgreen":[154,205,50]};var colorString={getRgba:getRgba,getHsla:getHsla,getRgb:getRgb,getHsl:getHsl,getHwb:getHwb,getAlpha:getAlpha,hexString:hexString,rgbString:rgbString,rgbaString:rgbaString,percentString:percentString,percentaString:percentaString,hslString:hslString,hslaString:hslaString,hwbString:hwbString,keyword:keyword};function getRgba(string){if(!string){return;}
var abbr=/^#([a-fA-F0-9]{3,4})$/i,hex=/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i,rgba=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,per=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,keyword=/(\w+)/;var rgb=[0,0,0],a=1,match=string.match(abbr),hexAlpha="";if(match){match=match[1];hexAlpha=match[3];for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match[i]+match[i],16);}
if(hexAlpha){a=Math.round((parseInt(hexAlpha+hexAlpha,16)/255)*100)/100;}}
else if(match=string.match(hex)){hexAlpha=match[2];match=match[1];for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match.slice(i*2,i*2+2),16);}
if(hexAlpha){a=Math.round((parseInt(hexAlpha,16)/255)*100)/100;}}
else if(match=string.match(rgba)){for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match[i+1]);}
a=parseFloat(match[4]);}
else if(match=string.match(per)){for(var i=0;i<rgb.length;i++){rgb[i]=Math.round(parseFloat(match[i+1])*2.55);}
a=parseFloat(match[4]);}
else if(match=string.match(keyword)){if(match[1]=="transparent"){return[0,0,0,0];}
rgb=colorName[match[1]];if(!rgb){return;}}
for(var i=0;i<rgb.length;i++){rgb[i]=scale(rgb[i],0,255);}
if(!a&&a!=0){a=1;}
else{a=scale(a,0,1);}
rgb[3]=a;return rgb;}
function getHsla(string){if(!string){return;}
var hsl=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var match=string.match(hsl);if(match){var alpha=parseFloat(match[4]);var h=scale(parseInt(match[1]),0,360),s=scale(parseFloat(match[2]),0,100),l=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,s,l,a];}}
function getHwb(string){if(!string){return;}
var hwb=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var match=string.match(hwb);if(match){var alpha=parseFloat(match[4]);var h=scale(parseInt(match[1]),0,360),w=scale(parseFloat(match[2]),0,100),b=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,w,b,a];}}
function getRgb(string){var rgba=getRgba(string);return rgba&&rgba.slice(0,3);}
function getHsl(string){var hsla=getHsla(string);return hsla&&hsla.slice(0,3);}
function getAlpha(string){var vals=getRgba(string);if(vals){return vals[3];}
else if(vals=getHsla(string)){return vals[3];}
else if(vals=getHwb(string)){return vals[3];}}
function hexString(rgba,a){var a=(a!==undefined&&rgba.length===3)?a:rgba[3];return"#"+hexDouble(rgba[0])
+hexDouble(rgba[1])
+hexDouble(rgba[2])
+((a>=0&&a<1)?hexDouble(Math.round(a*255)):"");}
function rgbString(rgba,alpha){if(alpha<1||(rgba[3]&&rgba[3]<1)){return rgbaString(rgba,alpha);}
return"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")";}
function rgbaString(rgba,alpha){if(alpha===undefined){alpha=(rgba[3]!==undefined?rgba[3]:1);}
return"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]
+", "+alpha+")";}
function percentString(rgba,alpha){if(alpha<1||(rgba[3]&&rgba[3]<1)){return percentaString(rgba,alpha);}
var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)";}
function percentaString(rgba,alpha){var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgba("+r+"%, "+g+"%, "+b+"%, "+(alpha||rgba[3]||1)+")";}
function hslString(hsla,alpha){if(alpha<1||(hsla[3]&&hsla[3]<1)){return hslaString(hsla,alpha);}
return"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)";}
function hslaString(hsla,alpha){if(alpha===undefined){alpha=(hsla[3]!==undefined?hsla[3]:1);}
return"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "
+alpha+")";}
function hwbString(hwb,alpha){if(alpha===undefined){alpha=(hwb[3]!==undefined?hwb[3]:1);}
return"hwb("+hwb[0]+", "+hwb[1]+"%, "+hwb[2]+"%"
+(alpha!==undefined&&alpha!==1?", "+alpha:"")+")";}
function keyword(rgb){return reverseNames[rgb.slice(0,3)];}
function scale(num,min,max){return Math.min(Math.max(min,num),max);}
function hexDouble(num){var str=num.toString(16).toUpperCase();return(str.length<2)?"0"+str:str;}
var reverseNames={};for(var name in colorName){reverseNames[colorName[name]]=name;}
var Color=function(obj){if(obj instanceof Color){return obj;}
if(!(this instanceof Color)){return new Color(obj);}
this.valid=false;this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var vals;if(typeof obj==='string'){vals=colorString.getRgba(obj);if(vals){this.setValues('rgb',vals);}else if(vals=colorString.getHsla(obj)){this.setValues('hsl',vals);}else if(vals=colorString.getHwb(obj)){this.setValues('hwb',vals);}}else if(typeof obj==='object'){vals=obj;if(vals.r!==undefined||vals.red!==undefined){this.setValues('rgb',vals);}else if(vals.l!==undefined||vals.lightness!==undefined){this.setValues('hsl',vals);}else if(vals.v!==undefined||vals.value!==undefined){this.setValues('hsv',vals);}else if(vals.w!==undefined||vals.whiteness!==undefined){this.setValues('hwb',vals);}else if(vals.c!==undefined||vals.cyan!==undefined){this.setValues('cmyk',vals);}}};Color.prototype={isValid:function(){return this.valid;},rgb:function(){return this.setSpace('rgb',arguments);},hsl:function(){return this.setSpace('hsl',arguments);},hsv:function(){return this.setSpace('hsv',arguments);},hwb:function(){return this.setSpace('hwb',arguments);},cmyk:function(){return this.setSpace('cmyk',arguments);},rgbArray:function(){return this.values.rgb;},hslArray:function(){return this.values.hsl;},hsvArray:function(){return this.values.hsv;},hwbArray:function(){var values=this.values;if(values.alpha!==1){return values.hwb.concat([values.alpha]);}
return values.hwb;},cmykArray:function(){return this.values.cmyk;},rgbaArray:function(){var values=this.values;return values.rgb.concat([values.alpha]);},hslaArray:function(){var values=this.values;return values.hsl.concat([values.alpha]);},alpha:function(val){if(val===undefined){return this.values.alpha;}
this.setValues('alpha',val);return this;},red:function(val){return this.setChannel('rgb',0,val);},green:function(val){return this.setChannel('rgb',1,val);},blue:function(val){return this.setChannel('rgb',2,val);},hue:function(val){if(val){val%=360;val=val<0?360+val:val;}
return this.setChannel('hsl',0,val);},saturation:function(val){return this.setChannel('hsl',1,val);},lightness:function(val){return this.setChannel('hsl',2,val);},saturationv:function(val){return this.setChannel('hsv',1,val);},whiteness:function(val){return this.setChannel('hwb',1,val);},blackness:function(val){return this.setChannel('hwb',2,val);},value:function(val){return this.setChannel('hsv',2,val);},cyan:function(val){return this.setChannel('cmyk',0,val);},magenta:function(val){return this.setChannel('cmyk',1,val);},yellow:function(val){return this.setChannel('cmyk',2,val);},black:function(val){return this.setChannel('cmyk',3,val);},hexString:function(){return colorString.hexString(this.values.rgb);},rgbString:function(){return colorString.rgbString(this.values.rgb,this.values.alpha);},rgbaString:function(){return colorString.rgbaString(this.values.rgb,this.values.alpha);},percentString:function(){return colorString.percentString(this.values.rgb,this.values.alpha);},hslString:function(){return colorString.hslString(this.values.hsl,this.values.alpha);},hslaString:function(){return colorString.hslaString(this.values.hsl,this.values.alpha);},hwbString:function(){return colorString.hwbString(this.values.hwb,this.values.alpha);},keyword:function(){return colorString.keyword(this.values.rgb,this.values.alpha);},rgbNumber:function(){var rgb=this.values.rgb;return(rgb[0]<<16)|(rgb[1]<<8)|rgb[2];},luminosity:function(){var rgb=this.values.rgb;var lum=[];for(var i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=(chan<=0.03928)?chan/12.92:Math.pow(((chan+0.055)/1.055),2.4);}
return 0.2126*lum[0]+0.7152*lum[1]+0.0722*lum[2];},contrast:function(color2){var lum1=this.luminosity();var lum2=color2.luminosity();if(lum1>lum2){return(lum1+0.05)/(lum2+0.05);}
return(lum2+0.05)/(lum1+0.05);},level:function(color2){var contrastRatio=this.contrast(color2);if(contrastRatio>=7.1){return'AAA';}
return(contrastRatio>=4.5)?'AA':'';},dark:function(){var rgb=this.values.rgb;var yiq=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;return yiq<128;},light:function(){return!this.dark();},negate:function(){var rgb=[];for(var i=0;i<3;i++){rgb[i]=255-this.values.rgb[i];}
this.setValues('rgb',rgb);return this;},lighten:function(ratio){var hsl=this.values.hsl;hsl[2]+=hsl[2]*ratio;this.setValues('hsl',hsl);return this;},darken:function(ratio){var hsl=this.values.hsl;hsl[2]-=hsl[2]*ratio;this.setValues('hsl',hsl);return this;},saturate:function(ratio){var hsl=this.values.hsl;hsl[1]+=hsl[1]*ratio;this.setValues('hsl',hsl);return this;},desaturate:function(ratio){var hsl=this.values.hsl;hsl[1]-=hsl[1]*ratio;this.setValues('hsl',hsl);return this;},whiten:function(ratio){var hwb=this.values.hwb;hwb[1]+=hwb[1]*ratio;this.setValues('hwb',hwb);return this;},blacken:function(ratio){var hwb=this.values.hwb;hwb[2]+=hwb[2]*ratio;this.setValues('hwb',hwb);return this;},greyscale:function(){var rgb=this.values.rgb;var val=rgb[0]*0.3+rgb[1]*0.59+rgb[2]*0.11;this.setValues('rgb',[val,val,val]);return this;},clearer:function(ratio){var alpha=this.values.alpha;this.setValues('alpha',alpha-(alpha*ratio));return this;},opaquer:function(ratio){var alpha=this.values.alpha;this.setValues('alpha',alpha+(alpha*ratio));return this;},rotate:function(degrees){var hsl=this.values.hsl;var hue=(hsl[0]+degrees)%360;hsl[0]=hue<0?360+hue:hue;this.setValues('hsl',hsl);return this;},mix:function(mixinColor,weight){var color1=this;var color2=mixinColor;var p=weight===undefined?0.5:weight;var w=2*p-1;var a=color1.alpha()-color2.alpha();var w1=(((w*a===-1)?w:(w+a)/(1+w*a))+1)/2.0;var w2=1-w1;return this.rgb(w1*color1.red()+w2*color2.red(),w1*color1.green()+w2*color2.green(),w1*color1.blue()+w2*color2.blue()).alpha(color1.alpha()*p+color2.alpha()*(1-p));},toJSON:function(){return this.rgb();},clone:function(){var result=new Color();var source=this.values;var target=result.values;var value,type;for(var prop in source){if(source.hasOwnProperty(prop)){value=source[prop];type=({}).toString.call(value);if(type==='[object Array]'){target[prop]=value.slice(0);}else if(type==='[object Number]'){target[prop]=value;}else{console.error('unexpected color value:',value);}}}
return result;}};Color.prototype.spaces={rgb:['red','green','blue'],hsl:['hue','saturation','lightness'],hsv:['hue','saturation','value'],hwb:['hue','whiteness','blackness'],cmyk:['cyan','magenta','yellow','black']};Color.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]};Color.prototype.getValues=function(space){var values=this.values;var vals={};for(var i=0;i<space.length;i++){vals[space.charAt(i)]=values[space][i];}
if(values.alpha!==1){vals.a=values.alpha;}
return vals;};Color.prototype.setValues=function(space,vals){var values=this.values;var spaces=this.spaces;var maxes=this.maxes;var alpha=1;var i;this.valid=true;if(space==='alpha'){alpha=vals;}else if(vals.length){values[space]=vals.slice(0,space.length);alpha=vals[space.length];}else if(vals[space.charAt(0)]!==undefined){for(i=0;i<space.length;i++){values[space][i]=vals[space.charAt(i)];}
alpha=vals.a;}else if(vals[spaces[space][0]]!==undefined){var chans=spaces[space];for(i=0;i<space.length;i++){values[space][i]=vals[chans[i]];}
alpha=vals.alpha;}
values.alpha=Math.max(0,Math.min(1,(alpha===undefined?values.alpha:alpha)));if(space==='alpha'){return false;}
var capped;for(i=0;i<space.length;i++){capped=Math.max(0,Math.min(maxes[space][i],values[space][i]));values[space][i]=Math.round(capped);}
for(var sname in spaces){if(sname!==space){values[sname]=colorConvert[space][sname](values[space]);}}
return true;};Color.prototype.setSpace=function(space,args){var vals=args[0];if(vals===undefined){return this.getValues(space);}
if(typeof vals==='number'){vals=Array.prototype.slice.call(args);}
this.setValues(space,vals);return this;};Color.prototype.setChannel=function(space,index,val){var svalues=this.values[space];if(val===undefined){return svalues[index];}else if(val===svalues[index]){return this;}
svalues[index]=val;this.setValues(space,svalues);return this;};if(typeof window!=='undefined'){window.Color=Color;}
var chartjsColor=Color;var helpers={noop:function(){},uid:(function(){var id=0;return function(){return id++;};}()),isNullOrUndef:function(value){return value===null||typeof value==='undefined';},isArray:function(value){if(Array.isArray&&Array.isArray(value)){return true;}
var type=Object.prototype.toString.call(value);if(type.substr(0,7)==='[object'&&type.substr(-6)==='Array]'){return true;}
return false;},isObject:function(value){return value!==null&&Object.prototype.toString.call(value)==='[object Object]';},isFinite:function(value){return(typeof value==='number'||value instanceof Number)&&isFinite(value);},valueOrDefault:function(value,defaultValue){return typeof value==='undefined'?defaultValue:value;},valueAtIndexOrDefault:function(value,index,defaultValue){return helpers.valueOrDefault(helpers.isArray(value)?value[index]:value,defaultValue);},callback:function(fn,args,thisArg){if(fn&&typeof fn.call==='function'){return fn.apply(thisArg,args);}},each:function(loopable,fn,thisArg,reverse){var i,len,keys;if(helpers.isArray(loopable)){len=loopable.length;if(reverse){for(i=len-1;i>=0;i--){fn.call(thisArg,loopable[i],i);}}else{for(i=0;i<len;i++){fn.call(thisArg,loopable[i],i);}}}else if(helpers.isObject(loopable)){keys=Object.keys(loopable);len=keys.length;for(i=0;i<len;i++){fn.call(thisArg,loopable[keys[i]],keys[i]);}}},arrayEquals:function(a0,a1){var i,ilen,v0,v1;if(!a0||!a1||a0.length!==a1.length){return false;}
for(i=0,ilen=a0.length;i<ilen;++i){v0=a0[i];v1=a1[i];if(v0 instanceof Array&&v1 instanceof Array){if(!helpers.arrayEquals(v0,v1)){return false;}}else if(v0!==v1){return false;}}
return true;},clone:function(source){if(helpers.isArray(source)){return source.map(helpers.clone);}
if(helpers.isObject(source)){var target={};var keys=Object.keys(source);var klen=keys.length;var k=0;for(;k<klen;++k){target[keys[k]]=helpers.clone(source[keys[k]]);}
return target;}
return source;},_merger:function(key,target,source,options){var tval=target[key];var sval=source[key];if(helpers.isObject(tval)&&helpers.isObject(sval)){helpers.merge(tval,sval,options);}else{target[key]=helpers.clone(sval);}},_mergerIf:function(key,target,source){var tval=target[key];var sval=source[key];if(helpers.isObject(tval)&&helpers.isObject(sval)){helpers.mergeIf(tval,sval);}else if(!target.hasOwnProperty(key)){target[key]=helpers.clone(sval);}},merge:function(target,source,options){var sources=helpers.isArray(source)?source:[source];var ilen=sources.length;var merge,i,keys,klen,k;if(!helpers.isObject(target)){return target;}
options=options||{};merge=options.merger||helpers._merger;for(i=0;i<ilen;++i){source=sources[i];if(!helpers.isObject(source)){continue;}
keys=Object.keys(source);for(k=0,klen=keys.length;k<klen;++k){merge(keys[k],target,source,options);}}
return target;},mergeIf:function(target,source){return helpers.merge(target,source,{merger:helpers._mergerIf});},extend:function(target){var setFn=function(value,key){target[key]=value;};for(var i=1,ilen=arguments.length;i<ilen;++i){helpers.each(arguments[i],setFn);}
return target;},inherits:function(extensions){var me=this;var ChartElement=(extensions&&extensions.hasOwnProperty('constructor'))?extensions.constructor:function(){return me.apply(this,arguments);};var Surrogate=function(){this.constructor=ChartElement;};Surrogate.prototype=me.prototype;ChartElement.prototype=new Surrogate();ChartElement.extend=helpers.inherits;if(extensions){helpers.extend(ChartElement.prototype,extensions);}
ChartElement.__super__=me.prototype;return ChartElement;}};var helpers_core=helpers;helpers.callCallback=helpers.callback;helpers.indexOf=function(array,item,fromIndex){return Array.prototype.indexOf.call(array,item,fromIndex);};helpers.getValueOrDefault=helpers.valueOrDefault;helpers.getValueAtIndexOrDefault=helpers.valueAtIndexOrDefault;var effects={linear:function(t){return t;},easeInQuad:function(t){return t*t;},easeOutQuad:function(t){return-t*(t-2);},easeInOutQuad:function(t){if((t/=0.5)<1){return 0.5*t*t;}
return-0.5*((--t)*(t-2)-1);},easeInCubic:function(t){return t*t*t;},easeOutCubic:function(t){return(t=t-1)*t*t+1;},easeInOutCubic:function(t){if((t/=0.5)<1){return 0.5*t*t*t;}
return 0.5*((t-=2)*t*t+2);},easeInQuart:function(t){return t*t*t*t;},easeOutQuart:function(t){return-((t=t-1)*t*t*t-1);},easeInOutQuart:function(t){if((t/=0.5)<1){return 0.5*t*t*t*t;}
return-0.5*((t-=2)*t*t*t-2);},easeInQuint:function(t){return t*t*t*t*t;},easeOutQuint:function(t){return(t=t-1)*t*t*t*t+1;},easeInOutQuint:function(t){if((t/=0.5)<1){return 0.5*t*t*t*t*t;}
return 0.5*((t-=2)*t*t*t*t+2);},easeInSine:function(t){return-Math.cos(t*(Math.PI/2))+1;},easeOutSine:function(t){return Math.sin(t*(Math.PI/2));},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t)-1);},easeInExpo:function(t){return(t===0)?0:Math.pow(2,10*(t-1));},easeOutExpo:function(t){return(t===1)?1:-Math.pow(2,-10*t)+1;},easeInOutExpo:function(t){if(t===0){return 0;}
if(t===1){return 1;}
if((t/=0.5)<1){return 0.5*Math.pow(2,10*(t-1));}
return 0.5*(-Math.pow(2,-10*--t)+2);},easeInCirc:function(t){if(t>=1){return t;}
return-(Math.sqrt(1-t*t)-1);},easeOutCirc:function(t){return Math.sqrt(1-(t=t-1)*t);},easeInOutCirc:function(t){if((t/=0.5)<1){return-0.5*(Math.sqrt(1-t*t)-1);}
return 0.5*(Math.sqrt(1-(t-=2)*t)+1);},easeInElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0;}
if(t===1){return 1;}
if(!p){p=0.3;}
if(a<1){a=1;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(1/a);}
return-(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p));},easeOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0;}
if(t===1){return 1;}
if(!p){p=0.3;}
if(a<1){a=1;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(1/a);}
return a*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/p)+1;},easeInOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0;}
if((t/=0.5)===2){return 1;}
if(!p){p=0.45;}
if(a<1){a=1;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(1/a);}
if(t<1){return-0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p));}
return a*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*0.5+1;},easeInBack:function(t){var s=1.70158;return t*t*((s+1)*t-s);},easeOutBack:function(t){var s=1.70158;return(t=t-1)*t*((s+1)*t+s)+1;},easeInOutBack:function(t){var s=1.70158;if((t/=0.5)<1){return 0.5*(t*t*(((s*=(1.525))+1)*t-s));}
return 0.5*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2);},easeInBounce:function(t){return 1-effects.easeOutBounce(1-t);},easeOutBounce:function(t){if(t<(1/2.75)){return 7.5625*t*t;}
if(t<(2/2.75)){return 7.5625*(t-=(1.5/2.75))*t+0.75;}
if(t<(2.5/2.75)){return 7.5625*(t-=(2.25/2.75))*t+0.9375;}
return 7.5625*(t-=(2.625/2.75))*t+0.984375;},easeInOutBounce:function(t){if(t<0.5){return effects.easeInBounce(t*2)*0.5;}
return effects.easeOutBounce(t*2-1)*0.5+0.5;}};var helpers_easing={effects:effects};helpers_core.easingEffects=effects;var PI=Math.PI;var RAD_PER_DEG=PI/180;var DOUBLE_PI=PI*2;var HALF_PI=PI/2;var QUARTER_PI=PI/4;var TWO_THIRDS_PI=PI*2/3;var exports$1={clear:function(chart){chart.ctx.clearRect(0,0,chart.width,chart.height);},roundedRect:function(ctx,x,y,width,height,radius){if(radius){var r=Math.min(radius,height/2,width/2);var left=x+r;var top=y+r;var right=x+width-r;var bottom=y+height-r;ctx.moveTo(x,top);if(left<right&&top<bottom){ctx.arc(left,top,r,-PI,-HALF_PI);ctx.arc(right,top,r,-HALF_PI,0);ctx.arc(right,bottom,r,0,HALF_PI);ctx.arc(left,bottom,r,HALF_PI,PI);}else if(left<right){ctx.moveTo(left,y);ctx.arc(right,top,r,-HALF_PI,HALF_PI);ctx.arc(left,top,r,HALF_PI,PI+HALF_PI);}else if(top<bottom){ctx.arc(left,top,r,-PI,0);ctx.arc(left,bottom,r,0,PI);}else{ctx.arc(left,top,r,-PI,PI);}
ctx.closePath();ctx.moveTo(x,y);}else{ctx.rect(x,y,width,height);}},drawPoint:function(ctx,style,radius,x,y,rotation){var type,xOffset,yOffset,size,cornerRadius;var rad=(rotation||0)*RAD_PER_DEG;if(style&&typeof style==='object'){type=style.toString();if(type==='[object HTMLImageElement]'||type==='[object HTMLCanvasElement]'){ctx.drawImage(style,x-style.width/2,y-style.height/2,style.width,style.height);return;}}
if(isNaN(radius)||radius<=0){return;}
ctx.beginPath();switch(style){default:ctx.arc(x,y,radius,0,DOUBLE_PI);ctx.closePath();break;case'triangle':ctx.moveTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius);rad+=TWO_THIRDS_PI;ctx.lineTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius);rad+=TWO_THIRDS_PI;ctx.lineTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius);ctx.closePath();break;case'rectRounded':cornerRadius=radius*0.516;size=radius-cornerRadius;xOffset=Math.cos(rad+QUARTER_PI)*size;yOffset=Math.sin(rad+QUARTER_PI)*size;ctx.arc(x-xOffset,y-yOffset,cornerRadius,rad-PI,rad-HALF_PI);ctx.arc(x+yOffset,y-xOffset,cornerRadius,rad-HALF_PI,rad);ctx.arc(x+xOffset,y+yOffset,cornerRadius,rad,rad+HALF_PI);ctx.arc(x-yOffset,y+xOffset,cornerRadius,rad+HALF_PI,rad+PI);ctx.closePath();break;case'rect':if(!rotation){size=Math.SQRT1_2*radius;ctx.rect(x-size,y-size,2*size,2*size);break;}
rad+=QUARTER_PI;case'rectRot':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+yOffset,y-xOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.lineTo(x-yOffset,y+xOffset);ctx.closePath();break;case'crossRot':rad+=QUARTER_PI;case'cross':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x+yOffset,y-xOffset);ctx.lineTo(x-yOffset,y+xOffset);break;case'star':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x+yOffset,y-xOffset);ctx.lineTo(x-yOffset,y+xOffset);rad+=QUARTER_PI;xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x+yOffset,y-xOffset);ctx.lineTo(x-yOffset,y+xOffset);break;case'line':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);break;case'dash':ctx.moveTo(x,y);ctx.lineTo(x+Math.cos(rad)*radius,y+Math.sin(rad)*radius);break;}
ctx.fill();ctx.stroke();},_isPointInArea:function(point,area){var epsilon=1e-6;return point.x>area.left-epsilon&&point.x<area.right+epsilon&&point.y>area.top-epsilon&&point.y<area.bottom+epsilon;},clipArea:function(ctx,area){ctx.save();ctx.beginPath();ctx.rect(area.left,area.top,area.right-area.left,area.bottom-area.top);ctx.clip();},unclipArea:function(ctx){ctx.restore();},lineTo:function(ctx,previous,target,flip){var stepped=target.steppedLine;if(stepped){if(stepped==='middle'){var midpoint=(previous.x+target.x)/2.0;ctx.lineTo(midpoint,flip?target.y:previous.y);ctx.lineTo(midpoint,flip?previous.y:target.y);}else if((stepped==='after'&&!flip)||(stepped!=='after'&&flip)){ctx.lineTo(previous.x,target.y);}else{ctx.lineTo(target.x,previous.y);}
ctx.lineTo(target.x,target.y);return;}
if(!target.tension){ctx.lineTo(target.x,target.y);return;}
ctx.bezierCurveTo(flip?previous.controlPointPreviousX:previous.controlPointNextX,flip?previous.controlPointPreviousY:previous.controlPointNextY,flip?target.controlPointNextX:target.controlPointPreviousX,flip?target.controlPointNextY:target.controlPointPreviousY,target.x,target.y);}};var helpers_canvas=exports$1;helpers_core.clear=exports$1.clear;helpers_core.drawRoundedRectangle=function(ctx){ctx.beginPath();exports$1.roundedRect.apply(exports$1,arguments);};var defaults={_set:function(scope,values){return helpers_core.merge(this[scope]||(this[scope]={}),values);}};defaults._set('global',{defaultColor:'rgba(0,0,0,0.1)',defaultFontColor:'#666',defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:'normal',defaultLineHeight:1.2,showLines:true});var core_defaults=defaults;var valueOrDefault=helpers_core.valueOrDefault;function toFontString(font){if(!font||helpers_core.isNullOrUndef(font.size)||helpers_core.isNullOrUndef(font.family)){return null;}
return(font.style?font.style+' ':'')
+(font.weight?font.weight+' ':'')
+font.size+'px '
+font.family;}
var helpers_options={toLineHeight:function(value,size){var matches=(''+value).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!matches||matches[1]==='normal'){return size*1.2;}
value=+matches[2];switch(matches[3]){case'px':return value;case'%':value/=100;break;default:break;}
return size*value;},toPadding:function(value){var t,r,b,l;if(helpers_core.isObject(value)){t=+value.top||0;r=+value.right||0;b=+value.bottom||0;l=+value.left||0;}else{t=r=b=l=+value||0;}
return{top:t,right:r,bottom:b,left:l,height:t+b,width:l+r};},_parseFont:function(options){var globalDefaults=core_defaults.global;var size=valueOrDefault(options.fontSize,globalDefaults.defaultFontSize);var font={family:valueOrDefault(options.fontFamily,globalDefaults.defaultFontFamily),lineHeight:helpers_core.options.toLineHeight(valueOrDefault(options.lineHeight,globalDefaults.defaultLineHeight),size),size:size,style:valueOrDefault(options.fontStyle,globalDefaults.defaultFontStyle),weight:null,string:''};font.string=toFontString(font);return font;},resolve:function(inputs,context,index){var i,ilen,value;for(i=0,ilen=inputs.length;i<ilen;++i){value=inputs[i];if(value===undefined){continue;}
if(context!==undefined&&typeof value==='function'){value=value(context);}
if(index!==undefined&&helpers_core.isArray(value)){value=value[index];}
if(value!==undefined){return value;}}}};var helpers$1=helpers_core;var easing=helpers_easing;var canvas=helpers_canvas;var options=helpers_options;helpers$1.easing=easing;helpers$1.canvas=canvas;helpers$1.options=options;function interpolate(start,view,model,ease){var keys=Object.keys(model);var i,ilen,key,actual,origin,target,type,c0,c1;for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];target=model[key];if(!view.hasOwnProperty(key)){view[key]=target;}
actual=view[key];if(actual===target||key[0]==='_'){continue;}
if(!start.hasOwnProperty(key)){start[key]=actual;}
origin=start[key];type=typeof target;if(type===typeof origin){if(type==='string'){c0=chartjsColor(origin);if(c0.valid){c1=chartjsColor(target);if(c1.valid){view[key]=c1.mix(c0,ease).rgbString();continue;}}}else if(helpers$1.isFinite(origin)&&helpers$1.isFinite(target)){view[key]=origin+(target-origin)*ease;continue;}}
view[key]=target;}}
var Element=function(configuration){helpers$1.extend(this,configuration);this.initialize.apply(this,arguments);};helpers$1.extend(Element.prototype,{initialize:function(){this.hidden=false;},pivot:function(){var me=this;if(!me._view){me._view=helpers$1.clone(me._model);}
me._start={};return me;},transition:function(ease){var me=this;var model=me._model;var start=me._start;var view=me._view;if(!model||ease===1){me._view=model;me._start=null;return me;}
if(!view){view=me._view={};}
if(!start){start=me._start={};}
interpolate(start,view,model,ease);return me;},tooltipPosition:function(){return{x:this._model.x,y:this._model.y};},hasValue:function(){return helpers$1.isNumber(this._model.x)&&helpers$1.isNumber(this._model.y);}});Element.extend=helpers$1.inherits;var core_element=Element;var exports$2=core_element.extend({chart:null,currentStep:0,numSteps:60,easing:'',render:null,onAnimationProgress:null,onAnimationComplete:null,});var core_animation=exports$2;Object.defineProperty(exports$2.prototype,'animationObject',{get:function(){return this;}});Object.defineProperty(exports$2.prototype,'chartInstance',{get:function(){return this.chart;},set:function(value){this.chart=value;}});core_defaults._set('global',{animation:{duration:1000,easing:'easeOutQuart',onProgress:helpers$1.noop,onComplete:helpers$1.noop}});var core_animations={animations:[],request:null,addAnimation:function(chart,animation,duration,lazy){var animations=this.animations;var i,ilen;animation.chart=chart;animation.startTime=Date.now();animation.duration=duration;if(!lazy){chart.animating=true;}
for(i=0,ilen=animations.length;i<ilen;++i){if(animations[i].chart===chart){animations[i]=animation;return;}}
animations.push(animation);if(animations.length===1){this.requestAnimationFrame();}},cancelAnimation:function(chart){var index=helpers$1.findIndex(this.animations,function(animation){return animation.chart===chart;});if(index!==-1){this.animations.splice(index,1);chart.animating=false;}},requestAnimationFrame:function(){var me=this;if(me.request===null){me.request=helpers$1.requestAnimFrame.call(window,function(){me.request=null;me.startDigest();});}},startDigest:function(){var me=this;me.advance();if(me.animations.length>0){me.requestAnimationFrame();}},advance:function(){var animations=this.animations;var animation,chart,numSteps,nextStep;var i=0;while(i<animations.length){animation=animations[i];chart=animation.chart;numSteps=animation.numSteps;nextStep=Math.floor((Date.now()-animation.startTime)/animation.duration*numSteps)+1;animation.currentStep=Math.min(nextStep,numSteps);helpers$1.callback(animation.render,[chart,animation],chart);helpers$1.callback(animation.onAnimationProgress,[animation],chart);if(animation.currentStep>=numSteps){helpers$1.callback(animation.onAnimationComplete,[animation],chart);chart.animating=false;animations.splice(i,1);}else{++i;}}}};var resolve=helpers$1.options.resolve;var arrayEvents=['push','pop','shift','splice','unshift'];function listenArrayEvents(array,listener){if(array._chartjs){array._chartjs.listeners.push(listener);return;}
Object.defineProperty(array,'_chartjs',{configurable:true,enumerable:false,value:{listeners:[listener]}});arrayEvents.forEach(function(key){var method='onData'+key.charAt(0).toUpperCase()+key.slice(1);var base=array[key];Object.defineProperty(array,key,{configurable:true,enumerable:false,value:function(){var args=Array.prototype.slice.call(arguments);var res=base.apply(this,args);helpers$1.each(array._chartjs.listeners,function(object){if(typeof object[method]==='function'){object[method].apply(object,args);}});return res;}});});}
function unlistenArrayEvents(array,listener){var stub=array._chartjs;if(!stub){return;}
var listeners=stub.listeners;var index=listeners.indexOf(listener);if(index!==-1){listeners.splice(index,1);}
if(listeners.length>0){return;}
arrayEvents.forEach(function(key){delete array[key];});delete array._chartjs;}
var DatasetController=function(chart,datasetIndex){this.initialize(chart,datasetIndex);};helpers$1.extend(DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(chart,datasetIndex){var me=this;me.chart=chart;me.index=datasetIndex;me.linkScales();me.addElements();},updateIndex:function(datasetIndex){this.index=datasetIndex;},linkScales:function(){var me=this;var meta=me.getMeta();var dataset=me.getDataset();if(meta.xAxisID===null||!(meta.xAxisID in me.chart.scales)){meta.xAxisID=dataset.xAxisID||me.chart.options.scales.xAxes[0].id;}
if(meta.yAxisID===null||!(meta.yAxisID in me.chart.scales)){meta.yAxisID=dataset.yAxisID||me.chart.options.scales.yAxes[0].id;}},getDataset:function(){return this.chart.data.datasets[this.index];},getMeta:function(){return this.chart.getDatasetMeta(this.index);},getScaleForId:function(scaleID){return this.chart.scales[scaleID];},_getValueScaleId:function(){return this.getMeta().yAxisID;},_getIndexScaleId:function(){return this.getMeta().xAxisID;},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId());},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId());},reset:function(){this.update(true);},destroy:function(){if(this._data){unlistenArrayEvents(this._data,this);}},createMetaDataset:function(){var me=this;var type=me.datasetElementType;return type&&new type({_chart:me.chart,_datasetIndex:me.index});},createMetaData:function(index){var me=this;var type=me.dataElementType;return type&&new type({_chart:me.chart,_datasetIndex:me.index,_index:index});},addElements:function(){var me=this;var meta=me.getMeta();var data=me.getDataset().data||[];var metaData=meta.data;var i,ilen;for(i=0,ilen=data.length;i<ilen;++i){metaData[i]=metaData[i]||me.createMetaData(i);}
meta.dataset=meta.dataset||me.createMetaDataset();},addElementAndReset:function(index){var element=this.createMetaData(index);this.getMeta().data.splice(index,0,element);this.updateElement(element,index,true);},buildOrUpdateElements:function(){var me=this;var dataset=me.getDataset();var data=dataset.data||(dataset.data=[]);if(me._data!==data){if(me._data){unlistenArrayEvents(me._data,me);}
if(data&&Object.isExtensible(data)){listenArrayEvents(data,me);}
me._data=data;}
me.resyncElements();},update:helpers$1.noop,transition:function(easingValue){var meta=this.getMeta();var elements=meta.data||[];var ilen=elements.length;var i=0;for(;i<ilen;++i){elements[i].transition(easingValue);}
if(meta.dataset){meta.dataset.transition(easingValue);}},draw:function(){var meta=this.getMeta();var elements=meta.data||[];var ilen=elements.length;var i=0;if(meta.dataset){meta.dataset.draw();}
for(;i<ilen;++i){elements[i].draw();}},removeHoverStyle:function(element){helpers$1.merge(element._model,element.$previousStyle||{});delete element.$previousStyle;},setHoverStyle:function(element){var dataset=this.chart.data.datasets[element._datasetIndex];var index=element._index;var custom=element.custom||{};var model=element._model;var getHoverColor=helpers$1.getHoverColor;element.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth};model.backgroundColor=resolve([custom.hoverBackgroundColor,dataset.hoverBackgroundColor,getHoverColor(model.backgroundColor)],undefined,index);model.borderColor=resolve([custom.hoverBorderColor,dataset.hoverBorderColor,getHoverColor(model.borderColor)],undefined,index);model.borderWidth=resolve([custom.hoverBorderWidth,dataset.hoverBorderWidth,model.borderWidth],undefined,index);},resyncElements:function(){var me=this;var meta=me.getMeta();var data=me.getDataset().data;var numMeta=meta.data.length;var numData=data.length;if(numData<numMeta){meta.data.splice(numData,numMeta-numData);}else if(numData>numMeta){me.insertElements(numMeta,numData-numMeta);}},insertElements:function(start,count){for(var i=0;i<count;++i){this.addElementAndReset(start+i);}},onDataPush:function(){var count=arguments.length;this.insertElements(this.getDataset().data.length-count,count);},onDataPop:function(){this.getMeta().data.pop();},onDataShift:function(){this.getMeta().data.shift();},onDataSplice:function(start,count){this.getMeta().data.splice(start,count);this.insertElements(start,arguments.length-2);},onDataUnshift:function(){this.insertElements(0,arguments.length);}});DatasetController.extend=helpers$1.inherits;var core_datasetController=DatasetController;core_defaults._set('global',{elements:{arc:{backgroundColor:core_defaults.global.defaultColor,borderColor:'#fff',borderWidth:2,borderAlign:'center'}}});var element_arc=core_element.extend({inLabelRange:function(mouseX){var vm=this._view;if(vm){return(Math.pow(mouseX-vm.x,2)<Math.pow(vm.radius+vm.hoverRadius,2));}
return false;},inRange:function(chartX,chartY){var vm=this._view;if(vm){var pointRelativePosition=helpers$1.getAngleFromPoint(vm,{x:chartX,y:chartY});var angle=pointRelativePosition.angle;var distance=pointRelativePosition.distance;var startAngle=vm.startAngle;var endAngle=vm.endAngle;while(endAngle<startAngle){endAngle+=2.0*Math.PI;}
while(angle>endAngle){angle-=2.0*Math.PI;}
while(angle<startAngle){angle+=2.0*Math.PI;}
var betweenAngles=(angle>=startAngle&&angle<=endAngle);var withinRadius=(distance>=vm.innerRadius&&distance<=vm.outerRadius);return(betweenAngles&&withinRadius);}
return false;},getCenterPoint:function(){var vm=this._view;var halfAngle=(vm.startAngle+vm.endAngle)/2;var halfRadius=(vm.innerRadius+vm.outerRadius)/2;return{x:vm.x+Math.cos(halfAngle)*halfRadius,y:vm.y+Math.sin(halfAngle)*halfRadius};},getArea:function(){var vm=this._view;return Math.PI*((vm.endAngle-vm.startAngle)/(2*Math.PI))*(Math.pow(vm.outerRadius,2)-Math.pow(vm.innerRadius,2));},tooltipPosition:function(){var vm=this._view;var centreAngle=vm.startAngle+((vm.endAngle-vm.startAngle)/2);var rangeFromCentre=(vm.outerRadius-vm.innerRadius)/2+vm.innerRadius;return{x:vm.x+(Math.cos(centreAngle)*rangeFromCentre),y:vm.y+(Math.sin(centreAngle)*rangeFromCentre)};},draw:function(){var ctx=this._chart.ctx;var vm=this._view;var sA=vm.startAngle;var eA=vm.endAngle;var pixelMargin=(vm.borderAlign==='inner')?0.33:0;var angleMargin;ctx.save();ctx.beginPath();ctx.arc(vm.x,vm.y,Math.max(vm.outerRadius-pixelMargin,0),sA,eA);ctx.arc(vm.x,vm.y,vm.innerRadius,eA,sA,true);ctx.closePath();ctx.fillStyle=vm.backgroundColor;ctx.fill();if(vm.borderWidth){if(vm.borderAlign==='inner'){ctx.beginPath();angleMargin=pixelMargin/vm.outerRadius;ctx.arc(vm.x,vm.y,vm.outerRadius,sA-angleMargin,eA+angleMargin);if(vm.innerRadius>pixelMargin){angleMargin=pixelMargin/vm.innerRadius;ctx.arc(vm.x,vm.y,vm.innerRadius-pixelMargin,eA+angleMargin,sA-angleMargin,true);}else{ctx.arc(vm.x,vm.y,pixelMargin,eA+Math.PI/2,sA-Math.PI/2);}
ctx.closePath();ctx.clip();ctx.beginPath();ctx.arc(vm.x,vm.y,vm.outerRadius,sA,eA);ctx.arc(vm.x,vm.y,vm.innerRadius,eA,sA,true);ctx.closePath();ctx.lineWidth=vm.borderWidth*2;ctx.lineJoin='round';}else{ctx.lineWidth=vm.borderWidth;ctx.lineJoin='bevel';}
ctx.strokeStyle=vm.borderColor;ctx.stroke();}
ctx.restore();}});var valueOrDefault$1=helpers$1.valueOrDefault;var defaultColor=core_defaults.global.defaultColor;core_defaults._set('global',{elements:{line:{tension:0.4,backgroundColor:defaultColor,borderWidth:3,borderColor:defaultColor,borderCapStyle:'butt',borderDash:[],borderDashOffset:0.0,borderJoinStyle:'miter',capBezierPoints:true,fill:true,}}});var element_line=core_element.extend({draw:function(){var me=this;var vm=me._view;var ctx=me._chart.ctx;var spanGaps=vm.spanGaps;var points=me._children.slice();var globalDefaults=core_defaults.global;var globalOptionLineElements=globalDefaults.elements.line;var lastDrawnIndex=-1;var index,current,previous,currentVM;if(me._loop&&points.length){points.push(points[0]);}
ctx.save();ctx.lineCap=vm.borderCapStyle||globalOptionLineElements.borderCapStyle;if(ctx.setLineDash){ctx.setLineDash(vm.borderDash||globalOptionLineElements.borderDash);}
ctx.lineDashOffset=valueOrDefault$1(vm.borderDashOffset,globalOptionLineElements.borderDashOffset);ctx.lineJoin=vm.borderJoinStyle||globalOptionLineElements.borderJoinStyle;ctx.lineWidth=valueOrDefault$1(vm.borderWidth,globalOptionLineElements.borderWidth);ctx.strokeStyle=vm.borderColor||globalDefaults.defaultColor;ctx.beginPath();lastDrawnIndex=-1;for(index=0;index<points.length;++index){current=points[index];previous=helpers$1.previousItem(points,index);currentVM=current._view;if(index===0){if(!currentVM.skip){ctx.moveTo(currentVM.x,currentVM.y);lastDrawnIndex=index;}}else{previous=lastDrawnIndex===-1?previous:points[lastDrawnIndex];if(!currentVM.skip){if((lastDrawnIndex!==(index-1)&&!spanGaps)||lastDrawnIndex===-1){ctx.moveTo(currentVM.x,currentVM.y);}else{helpers$1.canvas.lineTo(ctx,previous._view,current._view);}
lastDrawnIndex=index;}}}
ctx.stroke();ctx.restore();}});var valueOrDefault$2=helpers$1.valueOrDefault;var defaultColor$1=core_defaults.global.defaultColor;core_defaults._set('global',{elements:{point:{radius:3,pointStyle:'circle',backgroundColor:defaultColor$1,borderColor:defaultColor$1,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});function xRange(mouseX){var vm=this._view;return vm?(Math.abs(mouseX-vm.x)<vm.radius+vm.hitRadius):false;}
function yRange(mouseY){var vm=this._view;return vm?(Math.abs(mouseY-vm.y)<vm.radius+vm.hitRadius):false;}
var element_point=core_element.extend({inRange:function(mouseX,mouseY){var vm=this._view;return vm?((Math.pow(mouseX-vm.x,2)+Math.pow(mouseY-vm.y,2))<Math.pow(vm.hitRadius+vm.radius,2)):false;},inLabelRange:xRange,inXRange:xRange,inYRange:yRange,getCenterPoint:function(){var vm=this._view;return{x:vm.x,y:vm.y};},getArea:function(){return Math.PI*Math.pow(this._view.radius,2);},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y,padding:vm.radius+vm.borderWidth};},draw:function(chartArea){var vm=this._view;var ctx=this._chart.ctx;var pointStyle=vm.pointStyle;var rotation=vm.rotation;var radius=vm.radius;var x=vm.x;var y=vm.y;var globalDefaults=core_defaults.global;var defaultColor=globalDefaults.defaultColor;if(vm.skip){return;}
if(chartArea===undefined||helpers$1.canvas._isPointInArea(vm,chartArea)){ctx.strokeStyle=vm.borderColor||defaultColor;ctx.lineWidth=valueOrDefault$2(vm.borderWidth,globalDefaults.elements.point.borderWidth);ctx.fillStyle=vm.backgroundColor||defaultColor;helpers$1.canvas.drawPoint(ctx,pointStyle,radius,x,y,rotation);}}});var defaultColor$2=core_defaults.global.defaultColor;core_defaults._set('global',{elements:{rectangle:{backgroundColor:defaultColor$2,borderColor:defaultColor$2,borderSkipped:'bottom',borderWidth:0}}});function isVertical(vm){return vm&&vm.width!==undefined;}
function getBarBounds(vm){var x1,x2,y1,y2,half;if(isVertical(vm)){half=vm.width/2;x1=vm.x-half;x2=vm.x+half;y1=Math.min(vm.y,vm.base);y2=Math.max(vm.y,vm.base);}else{half=vm.height/2;x1=Math.min(vm.x,vm.base);x2=Math.max(vm.x,vm.base);y1=vm.y-half;y2=vm.y+half;}
return{left:x1,top:y1,right:x2,bottom:y2};}
function swap(orig,v1,v2){return orig===v1?v2:orig===v2?v1:orig;}
function parseBorderSkipped(vm){var edge=vm.borderSkipped;var res={};if(!edge){return res;}
if(vm.horizontal){if(vm.base>vm.x){edge=swap(edge,'left','right');}}else if(vm.base<vm.y){edge=swap(edge,'bottom','top');}
res[edge]=true;return res;}
function parseBorderWidth(vm,maxW,maxH){var value=vm.borderWidth;var skip=parseBorderSkipped(vm);var t,r,b,l;if(helpers$1.isObject(value)){t=+value.top||0;r=+value.right||0;b=+value.bottom||0;l=+value.left||0;}else{t=r=b=l=+value||0;}
return{t:skip.top||(t<0)?0:t>maxH?maxH:t,r:skip.right||(r<0)?0:r>maxW?maxW:r,b:skip.bottom||(b<0)?0:b>maxH?maxH:b,l:skip.left||(l<0)?0:l>maxW?maxW:l};}
function boundingRects(vm){var bounds=getBarBounds(vm);var width=bounds.right-bounds.left;var height=bounds.bottom-bounds.top;var border=parseBorderWidth(vm,width/2,height/2);return{outer:{x:bounds.left,y:bounds.top,w:width,h:height},inner:{x:bounds.left+border.l,y:bounds.top+border.t,w:width-border.l-border.r,h:height-border.t-border.b}};}
function inRange(vm,x,y){var skipX=x===null;var skipY=y===null;var bounds=!vm||(skipX&&skipY)?false:getBarBounds(vm);return bounds&&(skipX||x>=bounds.left&&x<=bounds.right)&&(skipY||y>=bounds.top&&y<=bounds.bottom);}
var element_rectangle=core_element.extend({draw:function(){var ctx=this._chart.ctx;var vm=this._view;var rects=boundingRects(vm);var outer=rects.outer;var inner=rects.inner;ctx.fillStyle=vm.backgroundColor;ctx.fillRect(outer.x,outer.y,outer.w,outer.h);if(outer.w===inner.w&&outer.h===inner.h){return;}
ctx.save();ctx.beginPath();ctx.rect(outer.x,outer.y,outer.w,outer.h);ctx.clip();ctx.fillStyle=vm.borderColor;ctx.rect(inner.x,inner.y,inner.w,inner.h);ctx.fill('evenodd');ctx.restore();},height:function(){var vm=this._view;return vm.base-vm.y;},inRange:function(mouseX,mouseY){return inRange(this._view,mouseX,mouseY);},inLabelRange:function(mouseX,mouseY){var vm=this._view;return isVertical(vm)?inRange(vm,mouseX,null):inRange(vm,null,mouseY);},inXRange:function(mouseX){return inRange(this._view,mouseX,null);},inYRange:function(mouseY){return inRange(this._view,null,mouseY);},getCenterPoint:function(){var vm=this._view;var x,y;if(isVertical(vm)){x=vm.x;y=(vm.y+vm.base)/2;}else{x=(vm.x+vm.base)/2;y=vm.y;}
return{x:x,y:y};},getArea:function(){var vm=this._view;return isVertical(vm)?vm.width*Math.abs(vm.y-vm.base):vm.height*Math.abs(vm.x-vm.base);},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y};}});var elements={};var Arc=element_arc;var Line=element_line;var Point=element_point;var Rectangle=element_rectangle;elements.Arc=Arc;elements.Line=Line;elements.Point=Point;elements.Rectangle=Rectangle;var resolve$1=helpers$1.options.resolve;core_defaults._set('bar',{hover:{mode:'label'},scales:{xAxes:[{type:'category',categoryPercentage:0.8,barPercentage:0.9,offset:true,gridLines:{offsetGridLines:true}}],yAxes:[{type:'linear'}]}});function computeMinSampleSize(scale,pixels){var min=scale.isHorizontal()?scale.width:scale.height;var ticks=scale.getTicks();var prev,curr,i,ilen;for(i=1,ilen=pixels.length;i<ilen;++i){min=Math.min(min,Math.abs(pixels[i]-pixels[i-1]));}
for(i=0,ilen=ticks.length;i<ilen;++i){curr=scale.getPixelForTick(i);min=i>0?Math.min(min,curr-prev):min;prev=curr;}
return min;}
function computeFitCategoryTraits(index,ruler,options){var thickness=options.barThickness;var count=ruler.stackCount;var curr=ruler.pixels[index];var size,ratio;if(helpers$1.isNullOrUndef(thickness)){size=ruler.min*options.categoryPercentage;ratio=options.barPercentage;}else{size=thickness*count;ratio=1;}
return{chunk:size/count,ratio:ratio,start:curr-(size/2)};}
function computeFlexCategoryTraits(index,ruler,options){var pixels=ruler.pixels;var curr=pixels[index];var prev=index>0?pixels[index-1]:null;var next=index<pixels.length-1?pixels[index+1]:null;var percent=options.categoryPercentage;var start,size;if(prev===null){prev=curr-(next===null?ruler.end-ruler.start:next-curr);}
if(next===null){next=curr+curr-prev;}
start=curr-(curr-Math.min(prev,next))/2*percent;size=Math.abs(next-prev)/2*percent;return{chunk:size/ruler.stackCount,ratio:options.barPercentage,start:start};}
var controller_bar=core_datasetController.extend({dataElementType:elements.Rectangle,initialize:function(){var me=this;var meta;core_datasetController.prototype.initialize.apply(me,arguments);meta=me.getMeta();meta.stack=me.getDataset().stack;meta.bar=true;},update:function(reset){var me=this;var rects=me.getMeta().data;var i,ilen;me._ruler=me.getRuler();for(i=0,ilen=rects.length;i<ilen;++i){me.updateElement(rects[i],i,reset);}},updateElement:function(rectangle,index,reset){var me=this;var meta=me.getMeta();var dataset=me.getDataset();var options=me._resolveElementOptions(rectangle,index);rectangle._xScale=me.getScaleForId(meta.xAxisID);rectangle._yScale=me.getScaleForId(meta.yAxisID);rectangle._datasetIndex=me.index;rectangle._index=index;rectangle._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderSkipped:options.borderSkipped,borderWidth:options.borderWidth,datasetLabel:dataset.label,label:me.chart.data.labels[index]};me._updateElementGeometry(rectangle,index,reset);rectangle.pivot();},_updateElementGeometry:function(rectangle,index,reset){var me=this;var model=rectangle._model;var vscale=me._getValueScale();var base=vscale.getBasePixel();var horizontal=vscale.isHorizontal();var ruler=me._ruler||me.getRuler();var vpixels=me.calculateBarValuePixels(me.index,index);var ipixels=me.calculateBarIndexPixels(me.index,index,ruler);model.horizontal=horizontal;model.base=reset?base:vpixels.base;model.x=horizontal?reset?base:vpixels.head:ipixels.center;model.y=horizontal?ipixels.center:reset?base:vpixels.head;model.height=horizontal?ipixels.size:undefined;model.width=horizontal?undefined:ipixels.size;},_getStacks:function(last){var me=this;var chart=me.chart;var scale=me._getIndexScale();var stacked=scale.options.stacked;var ilen=last===undefined?chart.data.datasets.length:last+1;var stacks=[];var i,meta;for(i=0;i<ilen;++i){meta=chart.getDatasetMeta(i);if(meta.bar&&chart.isDatasetVisible(i)&&(stacked===false||(stacked===true&&stacks.indexOf(meta.stack)===-1)||(stacked===undefined&&(meta.stack===undefined||stacks.indexOf(meta.stack)===-1)))){stacks.push(meta.stack);}}
return stacks;},getStackCount:function(){return this._getStacks().length;},getStackIndex:function(datasetIndex,name){var stacks=this._getStacks(datasetIndex);var index=(name!==undefined)?stacks.indexOf(name):-1;return(index===-1)?stacks.length-1:index;},getRuler:function(){var me=this;var scale=me._getIndexScale();var stackCount=me.getStackCount();var datasetIndex=me.index;var isHorizontal=scale.isHorizontal();var start=isHorizontal?scale.left:scale.top;var end=start+(isHorizontal?scale.width:scale.height);var pixels=[];var i,ilen,min;for(i=0,ilen=me.getMeta().data.length;i<ilen;++i){pixels.push(scale.getPixelForValue(null,i,datasetIndex));}
min=helpers$1.isNullOrUndef(scale.options.barThickness)?computeMinSampleSize(scale,pixels):-1;return{min:min,pixels:pixels,start:start,end:end,stackCount:stackCount,scale:scale};},calculateBarValuePixels:function(datasetIndex,index){var me=this;var chart=me.chart;var meta=me.getMeta();var scale=me._getValueScale();var isHorizontal=scale.isHorizontal();var datasets=chart.data.datasets;var value=+scale.getRightValue(datasets[datasetIndex].data[index]);var minBarLength=scale.options.minBarLength;var stacked=scale.options.stacked;var stack=meta.stack;var start=0;var i,imeta,ivalue,base,head,size;if(stacked||(stacked===undefined&&stack!==undefined)){for(i=0;i<datasetIndex;++i){imeta=chart.getDatasetMeta(i);if(imeta.bar&&imeta.stack===stack&&imeta.controller._getValueScaleId()===scale.id&&chart.isDatasetVisible(i)){ivalue=+scale.getRightValue(datasets[i].data[index]);if((value<0&&ivalue<0)||(value>=0&&ivalue>0)){start+=ivalue;}}}}
base=scale.getPixelForValue(start);head=scale.getPixelForValue(start+value);size=head-base;if(minBarLength!==undefined&&Math.abs(size)<minBarLength){size=minBarLength;if(value>=0&&!isHorizontal||value<0&&isHorizontal){head=base-minBarLength;}else{head=base+minBarLength;}}
return{size:size,base:base,head:head,center:head+size/2};},calculateBarIndexPixels:function(datasetIndex,index,ruler){var me=this;var options=ruler.scale.options;var range=options.barThickness==='flex'?computeFlexCategoryTraits(index,ruler,options):computeFitCategoryTraits(index,ruler,options);var stackIndex=me.getStackIndex(datasetIndex,me.getMeta().stack);var center=range.start+(range.chunk*stackIndex)+(range.chunk/2);var size=Math.min(helpers$1.valueOrDefault(options.maxBarThickness,Infinity),range.chunk*range.ratio);return{base:center-size/2,head:center+size/2,center:center,size:size};},draw:function(){var me=this;var chart=me.chart;var scale=me._getValueScale();var rects=me.getMeta().data;var dataset=me.getDataset();var ilen=rects.length;var i=0;helpers$1.canvas.clipArea(chart.ctx,chart.chartArea);for(;i<ilen;++i){if(!isNaN(scale.getRightValue(dataset.data[i]))){rects[i].draw();}}
helpers$1.canvas.unclipArea(chart.ctx);},_resolveElementOptions:function(rectangle,index){var me=this;var chart=me.chart;var datasets=chart.data.datasets;var dataset=datasets[me.index];var custom=rectangle.custom||{};var options=chart.options.elements.rectangle;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderSkipped','borderWidth'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$1([custom[key],dataset[key],options[key]],context,index);}
return values;}});var valueOrDefault$3=helpers$1.valueOrDefault;var resolve$2=helpers$1.options.resolve;core_defaults._set('bubble',{hover:{mode:'single'},scales:{xAxes:[{type:'linear',position:'bottom',id:'x-axis-0'}],yAxes:[{type:'linear',position:'left',id:'y-axis-0'}]},tooltips:{callbacks:{title:function(){return'';},label:function(item,data){var datasetLabel=data.datasets[item.datasetIndex].label||'';var dataPoint=data.datasets[item.datasetIndex].data[item.index];return datasetLabel+': ('+item.xLabel+', '+item.yLabel+', '+dataPoint.r+')';}}}});var controller_bubble=core_datasetController.extend({dataElementType:elements.Point,update:function(reset){var me=this;var meta=me.getMeta();var points=meta.data;helpers$1.each(points,function(point,index){me.updateElement(point,index,reset);});},updateElement:function(point,index,reset){var me=this;var meta=me.getMeta();var custom=point.custom||{};var xScale=me.getScaleForId(meta.xAxisID);var yScale=me.getScaleForId(meta.yAxisID);var options=me._resolveElementOptions(point,index);var data=me.getDataset().data[index];var dsIndex=me.index;var x=reset?xScale.getPixelForDecimal(0.5):xScale.getPixelForValue(typeof data==='object'?data:NaN,index,dsIndex);var y=reset?yScale.getBasePixel():yScale.getPixelForValue(data,index,dsIndex);point._xScale=xScale;point._yScale=yScale;point._options=options;point._datasetIndex=dsIndex;point._index=index;point._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,hitRadius:options.hitRadius,pointStyle:options.pointStyle,rotation:options.rotation,radius:reset?0:options.radius,skip:custom.skip||isNaN(x)||isNaN(y),x:x,y:y,};point.pivot();},setHoverStyle:function(point){var model=point._model;var options=point._options;var getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius};model.backgroundColor=valueOrDefault$3(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$3(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$3(options.hoverBorderWidth,options.borderWidth);model.radius=options.radius+options.hoverRadius;},_resolveElementOptions:function(point,index){var me=this;var chart=me.chart;var datasets=chart.data.datasets;var dataset=datasets[me.index];var custom=point.custom||{};var options=chart.options.elements.point;var data=dataset.data[index];var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderWidth','hoverBackgroundColor','hoverBorderColor','hoverBorderWidth','hoverRadius','hitRadius','pointStyle','rotation'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$2([custom[key],dataset[key],options[key]],context,index);}
values.radius=resolve$2([custom.radius,data?data.r:undefined,dataset.radius,options.radius],context,index);return values;}});var resolve$3=helpers$1.options.resolve;var valueOrDefault$4=helpers$1.valueOrDefault;core_defaults._set('doughnut',{animation:{animateRotate:true,animateScale:false},hover:{mode:'single'},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data;var datasets=data.datasets;var labels=data.labels;if(datasets.length){for(var i=0;i<datasets[0].data.length;++i){text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>');if(labels[i]){text.push(labels[i]);}
text.push('</li>');}}
text.push('</ul>');return text.join('');},legend:{labels:{generateLabels:function(chart){var data=chart.data;if(data.labels.length&&data.datasets.length){return data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0);var ds=data.datasets[0];var arc=meta.data[i];var custom=arc&&arc.custom||{};var arcOpts=chart.options.elements.arc;var fill=resolve$3([custom.backgroundColor,ds.backgroundColor,arcOpts.backgroundColor],undefined,i);var stroke=resolve$3([custom.borderColor,ds.borderColor,arcOpts.borderColor],undefined,i);var bw=resolve$3([custom.borderWidth,ds.borderWidth,arcOpts.borderWidth],undefined,i);return{text:label,fillStyle:fill,strokeStyle:stroke,lineWidth:bw,hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i};});}
return[];}},onClick:function(e,legendItem){var index=legendItem.index;var chart=this.chart;var i,ilen,meta;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){meta=chart.getDatasetMeta(i);if(meta.data[index]){meta.data[index].hidden=!meta.data[index].hidden;}}
chart.update();}},cutoutPercentage:50,rotation:Math.PI*-0.5,circumference:Math.PI*2.0,tooltips:{callbacks:{title:function(){return'';},label:function(tooltipItem,data){var dataLabel=data.labels[tooltipItem.index];var value=': '+data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];if(helpers$1.isArray(dataLabel)){dataLabel=dataLabel.slice();dataLabel[0]+=value;}else{dataLabel+=value;}
return dataLabel;}}}});var controller_doughnut=core_datasetController.extend({dataElementType:elements.Arc,linkScales:helpers$1.noop,getRingIndex:function(datasetIndex){var ringIndex=0;for(var j=0;j<datasetIndex;++j){if(this.chart.isDatasetVisible(j)){++ringIndex;}}
return ringIndex;},update:function(reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var availableWidth=chartArea.right-chartArea.left;var availableHeight=chartArea.bottom-chartArea.top;var minSize=Math.min(availableWidth,availableHeight);var offset={x:0,y:0};var meta=me.getMeta();var arcs=meta.data;var cutoutPercentage=opts.cutoutPercentage;var circumference=opts.circumference;var chartWeight=me._getRingWeight(me.index);var i,ilen;if(circumference<Math.PI*2.0){var startAngle=opts.rotation%(Math.PI*2.0);startAngle+=Math.PI*2.0*(startAngle>=Math.PI?-1:startAngle<-Math.PI?1:0);var endAngle=startAngle+circumference;var start={x:Math.cos(startAngle),y:Math.sin(startAngle)};var end={x:Math.cos(endAngle),y:Math.sin(endAngle)};var contains0=(startAngle<=0&&endAngle>=0)||(startAngle<=Math.PI*2.0&&Math.PI*2.0<=endAngle);var contains90=(startAngle<=Math.PI*0.5&&Math.PI*0.5<=endAngle)||(startAngle<=Math.PI*2.5&&Math.PI*2.5<=endAngle);var contains180=(startAngle<=-Math.PI&&-Math.PI<=endAngle)||(startAngle<=Math.PI&&Math.PI<=endAngle);var contains270=(startAngle<=-Math.PI*0.5&&-Math.PI*0.5<=endAngle)||(startAngle<=Math.PI*1.5&&Math.PI*1.5<=endAngle);var cutout=cutoutPercentage/100.0;var min={x:contains180?-1:Math.min(start.x*(start.x<0?1:cutout),end.x*(end.x<0?1:cutout)),y:contains270?-1:Math.min(start.y*(start.y<0?1:cutout),end.y*(end.y<0?1:cutout))};var max={x:contains0?1:Math.max(start.x*(start.x>0?1:cutout),end.x*(end.x>0?1:cutout)),y:contains90?1:Math.max(start.y*(start.y>0?1:cutout),end.y*(end.y>0?1:cutout))};var size={width:(max.x-min.x)*0.5,height:(max.y-min.y)*0.5};minSize=Math.min(availableWidth/size.width,availableHeight/size.height);offset={x:(max.x+min.x)*-0.5,y:(max.y+min.y)*-0.5};}
for(i=0,ilen=arcs.length;i<ilen;++i){arcs[i]._options=me._resolveElementOptions(arcs[i],i);}
chart.borderWidth=me.getMaxBorderWidth();chart.outerRadius=Math.max((minSize-chart.borderWidth)/2,0);chart.innerRadius=Math.max(cutoutPercentage?(chart.outerRadius/100)*(cutoutPercentage):0,0);chart.radiusLength=(chart.outerRadius-chart.innerRadius)/(me._getVisibleDatasetWeightTotal()||1);chart.offsetX=offset.x*chart.outerRadius;chart.offsetY=offset.y*chart.outerRadius;meta.total=me.calculateTotal();me.outerRadius=chart.outerRadius-chart.radiusLength*me._getRingWeightOffset(me.index);me.innerRadius=Math.max(me.outerRadius-chart.radiusLength*chartWeight,0);for(i=0,ilen=arcs.length;i<ilen;++i){me.updateElement(arcs[i],i,reset);}},updateElement:function(arc,index,reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var animationOpts=opts.animation;var centerX=(chartArea.left+chartArea.right)/2;var centerY=(chartArea.top+chartArea.bottom)/2;var startAngle=opts.rotation;var endAngle=opts.rotation;var dataset=me.getDataset();var circumference=reset&&animationOpts.animateRotate?0:arc.hidden?0:me.calculateCircumference(dataset.data[index])*(opts.circumference/(2.0*Math.PI));var innerRadius=reset&&animationOpts.animateScale?0:me.innerRadius;var outerRadius=reset&&animationOpts.animateScale?0:me.outerRadius;var options=arc._options||{};helpers$1.extend(arc,{_datasetIndex:me.index,_index:index,_model:{backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,borderAlign:options.borderAlign,x:centerX+chart.offsetX,y:centerY+chart.offsetY,startAngle:startAngle,endAngle:endAngle,circumference:circumference,outerRadius:outerRadius,innerRadius:innerRadius,label:helpers$1.valueAtIndexOrDefault(dataset.label,index,chart.data.labels[index])}});var model=arc._model;if(!reset||!animationOpts.animateRotate){if(index===0){model.startAngle=opts.rotation;}else{model.startAngle=me.getMeta().data[index-1]._model.endAngle;}
model.endAngle=model.startAngle+model.circumference;}
arc.pivot();},calculateTotal:function(){var dataset=this.getDataset();var meta=this.getMeta();var total=0;var value;helpers$1.each(meta.data,function(element,index){value=dataset.data[index];if(!isNaN(value)&&!element.hidden){total+=Math.abs(value);}});return total;},calculateCircumference:function(value){var total=this.getMeta().total;if(total>0&&!isNaN(value)){return(Math.PI*2.0)*(Math.abs(value)/total);}
return 0;},getMaxBorderWidth:function(arcs){var me=this;var max=0;var chart=me.chart;var i,ilen,meta,arc,controller,options,borderWidth,hoverWidth;if(!arcs){for(i=0,ilen=chart.data.datasets.length;i<ilen;++i){if(chart.isDatasetVisible(i)){meta=chart.getDatasetMeta(i);arcs=meta.data;if(i!==me.index){controller=meta.controller;}
break;}}}
if(!arcs){return 0;}
for(i=0,ilen=arcs.length;i<ilen;++i){arc=arcs[i];options=controller?controller._resolveElementOptions(arc,i):arc._options;if(options.borderAlign!=='inner'){borderWidth=options.borderWidth;hoverWidth=options.hoverBorderWidth;max=borderWidth>max?borderWidth:max;max=hoverWidth>max?hoverWidth:max;}}
return max;},setHoverStyle:function(arc){var model=arc._model;var options=arc._options;var getHoverColor=helpers$1.getHoverColor;arc.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,};model.backgroundColor=valueOrDefault$4(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$4(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$4(options.hoverBorderWidth,options.borderWidth);},_resolveElementOptions:function(arc,index){var me=this;var chart=me.chart;var dataset=me.getDataset();var custom=arc.custom||{};var options=chart.options.elements.arc;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderWidth','borderAlign','hoverBackgroundColor','hoverBorderColor','hoverBorderWidth',];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$3([custom[key],dataset[key],options[key]],context,index);}
return values;},_getRingWeightOffset:function(datasetIndex){var ringWeightOffset=0;for(var i=0;i<datasetIndex;++i){if(this.chart.isDatasetVisible(i)){ringWeightOffset+=this._getRingWeight(i);}}
return ringWeightOffset;},_getRingWeight:function(dataSetIndex){return Math.max(valueOrDefault$4(this.chart.data.datasets[dataSetIndex].weight,1),0);},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length);}});core_defaults._set('horizontalBar',{hover:{mode:'index',axis:'y'},scales:{xAxes:[{type:'linear',position:'bottom'}],yAxes:[{type:'category',position:'left',categoryPercentage:0.8,barPercentage:0.9,offset:true,gridLines:{offsetGridLines:true}}]},elements:{rectangle:{borderSkipped:'left'}},tooltips:{mode:'index',axis:'y'}});var controller_horizontalBar=controller_bar.extend({_getValueScaleId:function(){return this.getMeta().xAxisID;},_getIndexScaleId:function(){return this.getMeta().yAxisID;}});var valueOrDefault$5=helpers$1.valueOrDefault;var resolve$4=helpers$1.options.resolve;var isPointInArea=helpers$1.canvas._isPointInArea;core_defaults._set('line',{showLines:true,spanGaps:false,hover:{mode:'label'},scales:{xAxes:[{type:'category',id:'x-axis-0'}],yAxes:[{type:'linear',id:'y-axis-0'}]}});function lineEnabled(dataset,options){return valueOrDefault$5(dataset.showLine,options.showLines);}
var controller_line=core_datasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,update:function(reset){var me=this;var meta=me.getMeta();var line=meta.dataset;var points=meta.data||[];var scale=me.getScaleForId(meta.yAxisID);var dataset=me.getDataset();var showLine=lineEnabled(dataset,me.chart.options);var i,ilen;if(showLine){if((dataset.tension!==undefined)&&(dataset.lineTension===undefined)){dataset.lineTension=dataset.tension;}
line._scale=scale;line._datasetIndex=me.index;line._children=points;line._model=me._resolveLineOptions(line);line.pivot();}
for(i=0,ilen=points.length;i<ilen;++i){me.updateElement(points[i],i,reset);}
if(showLine&&line._model.tension!==0){me.updateBezierControlPoints();}
for(i=0,ilen=points.length;i<ilen;++i){points[i].pivot();}},updateElement:function(point,index,reset){var me=this;var meta=me.getMeta();var custom=point.custom||{};var dataset=me.getDataset();var datasetIndex=me.index;var value=dataset.data[index];var yScale=me.getScaleForId(meta.yAxisID);var xScale=me.getScaleForId(meta.xAxisID);var lineModel=meta.dataset._model;var x,y;var options=me._resolvePointOptions(point,index);x=xScale.getPixelForValue(typeof value==='object'?value:NaN,index,datasetIndex);y=reset?yScale.getBasePixel():me.calculatePointY(value,index,datasetIndex);point._xScale=xScale;point._yScale=yScale;point._options=options;point._datasetIndex=datasetIndex;point._index=index;point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:options.radius,pointStyle:options.pointStyle,rotation:options.rotation,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,tension:valueOrDefault$5(custom.tension,lineModel?lineModel.tension:0),steppedLine:lineModel?lineModel.steppedLine:false,hitRadius:options.hitRadius};},_resolvePointOptions:function(element,index){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options.elements.point;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var ELEMENT_OPTIONS={backgroundColor:'pointBackgroundColor',borderColor:'pointBorderColor',borderWidth:'pointBorderWidth',hitRadius:'pointHitRadius',hoverBackgroundColor:'pointHoverBackgroundColor',hoverBorderColor:'pointHoverBorderColor',hoverBorderWidth:'pointHoverBorderWidth',hoverRadius:'pointHoverRadius',pointStyle:'pointStyle',radius:'pointRadius',rotation:'pointRotation'};var keys=Object.keys(ELEMENT_OPTIONS);for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$4([custom[key],dataset[ELEMENT_OPTIONS[key]],dataset[key],options[key]],context,index);}
return values;},_resolveLineOptions:function(element){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options;var elementOptions=options.elements.line;var values={};var i,ilen,key;var keys=['backgroundColor','borderWidth','borderColor','borderCapStyle','borderDash','borderDashOffset','borderJoinStyle','fill','cubicInterpolationMode'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$4([custom[key],dataset[key],elementOptions[key]]);}
values.spanGaps=valueOrDefault$5(dataset.spanGaps,options.spanGaps);values.tension=valueOrDefault$5(dataset.lineTension,elementOptions.tension);values.steppedLine=resolve$4([custom.steppedLine,dataset.steppedLine,elementOptions.stepped]);return values;},calculatePointY:function(value,index,datasetIndex){var me=this;var chart=me.chart;var meta=me.getMeta();var yScale=me.getScaleForId(meta.yAxisID);var sumPos=0;var sumNeg=0;var i,ds,dsMeta;if(yScale.options.stacked){for(i=0;i<datasetIndex;i++){ds=chart.data.datasets[i];dsMeta=chart.getDatasetMeta(i);if(dsMeta.type==='line'&&dsMeta.yAxisID===yScale.id&&chart.isDatasetVisible(i)){var stackedRightValue=Number(yScale.getRightValue(ds.data[index]));if(stackedRightValue<0){sumNeg+=stackedRightValue||0;}else{sumPos+=stackedRightValue||0;}}}
var rightValue=Number(yScale.getRightValue(value));if(rightValue<0){return yScale.getPixelForValue(sumNeg+rightValue);}
return yScale.getPixelForValue(sumPos+rightValue);}
return yScale.getPixelForValue(value);},updateBezierControlPoints:function(){var me=this;var chart=me.chart;var meta=me.getMeta();var lineModel=meta.dataset._model;var area=chart.chartArea;var points=meta.data||[];var i,ilen,model,controlPoints;if(lineModel.spanGaps){points=points.filter(function(pt){return!pt._model.skip;});}
function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min);}
if(lineModel.cubicInterpolationMode==='monotone'){helpers$1.splineCurveMonotone(points);}else{for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;controlPoints=helpers$1.splineCurve(helpers$1.previousItem(points,i)._model,model,helpers$1.nextItem(points,i)._model,lineModel.tension);model.controlPointPreviousX=controlPoints.previous.x;model.controlPointPreviousY=controlPoints.previous.y;model.controlPointNextX=controlPoints.next.x;model.controlPointNextY=controlPoints.next.y;}}
if(chart.options.elements.line.capBezierPoints){for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;if(isPointInArea(model,area)){if(i>0&&isPointInArea(points[i-1]._model,area)){model.controlPointPreviousX=capControlPoint(model.controlPointPreviousX,area.left,area.right);model.controlPointPreviousY=capControlPoint(model.controlPointPreviousY,area.top,area.bottom);}
if(i<points.length-1&&isPointInArea(points[i+1]._model,area)){model.controlPointNextX=capControlPoint(model.controlPointNextX,area.left,area.right);model.controlPointNextY=capControlPoint(model.controlPointNextY,area.top,area.bottom);}}}}},draw:function(){var me=this;var chart=me.chart;var meta=me.getMeta();var points=meta.data||[];var area=chart.chartArea;var ilen=points.length;var halfBorderWidth;var i=0;if(lineEnabled(me.getDataset(),chart.options)){halfBorderWidth=(meta.dataset._model.borderWidth||0)/2;helpers$1.canvas.clipArea(chart.ctx,{left:area.left,right:area.right,top:area.top-halfBorderWidth,bottom:area.bottom+halfBorderWidth});meta.dataset.draw();helpers$1.canvas.unclipArea(chart.ctx);}
for(;i<ilen;++i){points[i].draw(area);}},setHoverStyle:function(point){var model=point._model;var options=point._options;var getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius};model.backgroundColor=valueOrDefault$5(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$5(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$5(options.hoverBorderWidth,options.borderWidth);model.radius=valueOrDefault$5(options.hoverRadius,options.radius);},});var resolve$5=helpers$1.options.resolve;core_defaults._set('polarArea',{scale:{type:'radialLinear',angleLines:{display:false},gridLines:{circular:true},pointLabels:{display:false},ticks:{beginAtZero:true}},animation:{animateRotate:true,animateScale:true},startAngle:-0.5*Math.PI,legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data;var datasets=data.datasets;var labels=data.labels;if(datasets.length){for(var i=0;i<datasets[0].data.length;++i){text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>');if(labels[i]){text.push(labels[i]);}
text.push('</li>');}}
text.push('</ul>');return text.join('');},legend:{labels:{generateLabels:function(chart){var data=chart.data;if(data.labels.length&&data.datasets.length){return data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0);var ds=data.datasets[0];var arc=meta.data[i];var custom=arc.custom||{};var arcOpts=chart.options.elements.arc;var fill=resolve$5([custom.backgroundColor,ds.backgroundColor,arcOpts.backgroundColor],undefined,i);var stroke=resolve$5([custom.borderColor,ds.borderColor,arcOpts.borderColor],undefined,i);var bw=resolve$5([custom.borderWidth,ds.borderWidth,arcOpts.borderWidth],undefined,i);return{text:label,fillStyle:fill,strokeStyle:stroke,lineWidth:bw,hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i};});}
return[];}},onClick:function(e,legendItem){var index=legendItem.index;var chart=this.chart;var i,ilen,meta;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){meta=chart.getDatasetMeta(i);meta.data[index].hidden=!meta.data[index].hidden;}
chart.update();}},tooltips:{callbacks:{title:function(){return'';},label:function(item,data){return data.labels[item.index]+': '+item.yLabel;}}}});var controller_polarArea=core_datasetController.extend({dataElementType:elements.Arc,linkScales:helpers$1.noop,update:function(reset){var me=this;var dataset=me.getDataset();var meta=me.getMeta();var start=me.chart.options.startAngle||0;var starts=me._starts=[];var angles=me._angles=[];var arcs=meta.data;var i,ilen,angle;me._updateRadius();meta.count=me.countVisibleElements();for(i=0,ilen=dataset.data.length;i<ilen;i++){starts[i]=start;angle=me._computeAngle(i);angles[i]=angle;start+=angle;}
for(i=0,ilen=arcs.length;i<ilen;++i){arcs[i]._options=me._resolveElementOptions(arcs[i],i);me.updateElement(arcs[i],i,reset);}},_updateRadius:function(){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var minSize=Math.min(chartArea.right-chartArea.left,chartArea.bottom-chartArea.top);chart.outerRadius=Math.max(minSize/2,0);chart.innerRadius=Math.max(opts.cutoutPercentage?(chart.outerRadius/100)*(opts.cutoutPercentage):1,0);chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount();me.outerRadius=chart.outerRadius-(chart.radiusLength*me.index);me.innerRadius=me.outerRadius-chart.radiusLength;},updateElement:function(arc,index,reset){var me=this;var chart=me.chart;var dataset=me.getDataset();var opts=chart.options;var animationOpts=opts.animation;var scale=chart.scale;var labels=chart.data.labels;var centerX=scale.xCenter;var centerY=scale.yCenter;var datasetStartAngle=opts.startAngle;var distance=arc.hidden?0:scale.getDistanceFromCenterForValue(dataset.data[index]);var startAngle=me._starts[index];var endAngle=startAngle+(arc.hidden?0:me._angles[index]);var resetRadius=animationOpts.animateScale?0:scale.getDistanceFromCenterForValue(dataset.data[index]);var options=arc._options||{};helpers$1.extend(arc,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,borderAlign:options.borderAlign,x:centerX,y:centerY,innerRadius:0,outerRadius:reset?resetRadius:distance,startAngle:reset&&animationOpts.animateRotate?datasetStartAngle:startAngle,endAngle:reset&&animationOpts.animateRotate?datasetStartAngle:endAngle,label:helpers$1.valueAtIndexOrDefault(labels,index,labels[index])}});arc.pivot();},countVisibleElements:function(){var dataset=this.getDataset();var meta=this.getMeta();var count=0;helpers$1.each(meta.data,function(element,index){if(!isNaN(dataset.data[index])&&!element.hidden){count++;}});return count;},setHoverStyle:function(arc){var model=arc._model;var options=arc._options;var getHoverColor=helpers$1.getHoverColor;var valueOrDefault=helpers$1.valueOrDefault;arc.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,};model.backgroundColor=valueOrDefault(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault(options.hoverBorderWidth,options.borderWidth);},_resolveElementOptions:function(arc,index){var me=this;var chart=me.chart;var dataset=me.getDataset();var custom=arc.custom||{};var options=chart.options.elements.arc;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderWidth','borderAlign','hoverBackgroundColor','hoverBorderColor','hoverBorderWidth',];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$5([custom[key],dataset[key],options[key]],context,index);}
return values;},_computeAngle:function(index){var me=this;var count=this.getMeta().count;var dataset=me.getDataset();var meta=me.getMeta();if(isNaN(dataset.data[index])||meta.data[index].hidden){return 0;}
var context={chart:me.chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};return resolve$5([me.chart.options.elements.arc.angle,(2*Math.PI)/count],context,index);}});core_defaults._set('pie',helpers$1.clone(core_defaults.doughnut));core_defaults._set('pie',{cutoutPercentage:0});var controller_pie=controller_doughnut;var valueOrDefault$6=helpers$1.valueOrDefault;var resolve$6=helpers$1.options.resolve;core_defaults._set('radar',{scale:{type:'radialLinear'},elements:{line:{tension:0}}});var controller_radar=core_datasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,linkScales:helpers$1.noop,update:function(reset){var me=this;var meta=me.getMeta();var line=meta.dataset;var points=meta.data||[];var scale=me.chart.scale;var dataset=me.getDataset();var i,ilen;if((dataset.tension!==undefined)&&(dataset.lineTension===undefined)){dataset.lineTension=dataset.tension;}
line._scale=scale;line._datasetIndex=me.index;line._children=points;line._loop=true;line._model=me._resolveLineOptions(line);line.pivot();for(i=0,ilen=points.length;i<ilen;++i){me.updateElement(points[i],i,reset);}
me.updateBezierControlPoints();for(i=0,ilen=points.length;i<ilen;++i){points[i].pivot();}},updateElement:function(point,index,reset){var me=this;var custom=point.custom||{};var dataset=me.getDataset();var scale=me.chart.scale;var pointPosition=scale.getPointPositionForValue(index,dataset.data[index]);var options=me._resolvePointOptions(point,index);var lineModel=me.getMeta().dataset._model;var x=reset?scale.xCenter:pointPosition.x;var y=reset?scale.yCenter:pointPosition.y;point._scale=scale;point._options=options;point._datasetIndex=me.index;point._index=index;point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:options.radius,pointStyle:options.pointStyle,rotation:options.rotation,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,tension:valueOrDefault$6(custom.tension,lineModel?lineModel.tension:0),hitRadius:options.hitRadius};},_resolvePointOptions:function(element,index){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options.elements.point;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var ELEMENT_OPTIONS={backgroundColor:'pointBackgroundColor',borderColor:'pointBorderColor',borderWidth:'pointBorderWidth',hitRadius:'pointHitRadius',hoverBackgroundColor:'pointHoverBackgroundColor',hoverBorderColor:'pointHoverBorderColor',hoverBorderWidth:'pointHoverBorderWidth',hoverRadius:'pointHoverRadius',pointStyle:'pointStyle',radius:'pointRadius',rotation:'pointRotation'};var keys=Object.keys(ELEMENT_OPTIONS);for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$6([custom[key],dataset[ELEMENT_OPTIONS[key]],dataset[key],options[key]],context,index);}
return values;},_resolveLineOptions:function(element){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options.elements.line;var values={};var i,ilen,key;var keys=['backgroundColor','borderWidth','borderColor','borderCapStyle','borderDash','borderDashOffset','borderJoinStyle','fill'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$6([custom[key],dataset[key],options[key]]);}
values.tension=valueOrDefault$6(dataset.lineTension,options.tension);return values;},updateBezierControlPoints:function(){var me=this;var meta=me.getMeta();var area=me.chart.chartArea;var points=meta.data||[];var i,ilen,model,controlPoints;function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min);}
for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;controlPoints=helpers$1.splineCurve(helpers$1.previousItem(points,i,true)._model,model,helpers$1.nextItem(points,i,true)._model,model.tension);model.controlPointPreviousX=capControlPoint(controlPoints.previous.x,area.left,area.right);model.controlPointPreviousY=capControlPoint(controlPoints.previous.y,area.top,area.bottom);model.controlPointNextX=capControlPoint(controlPoints.next.x,area.left,area.right);model.controlPointNextY=capControlPoint(controlPoints.next.y,area.top,area.bottom);}},setHoverStyle:function(point){var model=point._model;var options=point._options;var getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius};model.backgroundColor=valueOrDefault$6(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$6(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$6(options.hoverBorderWidth,options.borderWidth);model.radius=valueOrDefault$6(options.hoverRadius,options.radius);}});core_defaults._set('scatter',{hover:{mode:'single'},scales:{xAxes:[{id:'x-axis-1',type:'linear',position:'bottom'}],yAxes:[{id:'y-axis-1',type:'linear',position:'left'}]},showLines:false,tooltips:{callbacks:{title:function(){return'';},label:function(item){return'('+item.xLabel+', '+item.yLabel+')';}}}});var controller_scatter=controller_line;var controllers={bar:controller_bar,bubble:controller_bubble,doughnut:controller_doughnut,horizontalBar:controller_horizontalBar,line:controller_line,polarArea:controller_polarArea,pie:controller_pie,radar:controller_radar,scatter:controller_scatter};function getRelativePosition(e,chart){if(e.native){return{x:e.x,y:e.y};}
return helpers$1.getRelativePosition(e,chart);}
function parseVisibleItems(chart,handler){var datasets=chart.data.datasets;var meta,i,j,ilen,jlen;for(i=0,ilen=datasets.length;i<ilen;++i){if(!chart.isDatasetVisible(i)){continue;}
meta=chart.getDatasetMeta(i);for(j=0,jlen=meta.data.length;j<jlen;++j){var element=meta.data[j];if(!element._view.skip){handler(element);}}}}
function getIntersectItems(chart,position){var elements=[];parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y)){elements.push(element);}});return elements;}
function getNearestItems(chart,position,intersect,distanceMetric){var minDistance=Number.POSITIVE_INFINITY;var nearestItems=[];parseVisibleItems(chart,function(element){if(intersect&&!element.inRange(position.x,position.y)){return;}
var center=element.getCenterPoint();var distance=distanceMetric(position,center);if(distance<minDistance){nearestItems=[element];minDistance=distance;}else if(distance===minDistance){nearestItems.push(element);}});return nearestItems;}
function getDistanceMetricForAxis(axis){var useX=axis.indexOf('x')!==-1;var useY=axis.indexOf('y')!==-1;return function(pt1,pt2){var deltaX=useX?Math.abs(pt1.x-pt2.x):0;var deltaY=useY?Math.abs(pt1.y-pt2.y):0;return Math.sqrt(Math.pow(deltaX,2)+Math.pow(deltaY,2));};}
function indexMode(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||'x';var distanceMetric=getDistanceMetricForAxis(options.axis);var items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,false,distanceMetric);var elements=[];if(!items.length){return[];}
chart.data.datasets.forEach(function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);var element=meta.data[items[0]._index];if(element&&!element._view.skip){elements.push(element);}}});return elements;}
var core_interaction={modes:{single:function(chart,e){var position=getRelativePosition(e,chart);var elements=[];parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y)){elements.push(element);return elements;}});return elements.slice(0,1);},label:indexMode,index:indexMode,dataset:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||'xy';var distanceMetric=getDistanceMetricForAxis(options.axis);var items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,false,distanceMetric);if(items.length>0){items=chart.getDatasetMeta(items[0]._datasetIndex).data;}
return items;},'x-axis':function(chart,e){return indexMode(chart,e,{intersect:false});},point:function(chart,e){var position=getRelativePosition(e,chart);return getIntersectItems(chart,position);},nearest:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||'xy';var distanceMetric=getDistanceMetricForAxis(options.axis);return getNearestItems(chart,position,options.intersect,distanceMetric);},x:function(chart,e,options){var position=getRelativePosition(e,chart);var items=[];var intersectsItem=false;parseVisibleItems(chart,function(element){if(element.inXRange(position.x)){items.push(element);}
if(element.inRange(position.x,position.y)){intersectsItem=true;}});if(options.intersect&&!intersectsItem){items=[];}
return items;},y:function(chart,e,options){var position=getRelativePosition(e,chart);var items=[];var intersectsItem=false;parseVisibleItems(chart,function(element){if(element.inYRange(position.y)){items.push(element);}
if(element.inRange(position.x,position.y)){intersectsItem=true;}});if(options.intersect&&!intersectsItem){items=[];}
return items;}}};function filterByPosition(array,position){return helpers$1.where(array,function(v){return v.position===position;});}
function sortByWeight(array,reverse){array.forEach(function(v,i){v._tmpIndex_=i;return v;});array.sort(function(a,b){var v0=reverse?b:a;var v1=reverse?a:b;return v0.weight===v1.weight?v0._tmpIndex_-v1._tmpIndex_:v0.weight-v1.weight;});array.forEach(function(v){delete v._tmpIndex_;});}
function findMaxPadding(boxes){var top=0;var left=0;var bottom=0;var right=0;helpers$1.each(boxes,function(box){if(box.getPadding){var boxPadding=box.getPadding();top=Math.max(top,boxPadding.top);left=Math.max(left,boxPadding.left);bottom=Math.max(bottom,boxPadding.bottom);right=Math.max(right,boxPadding.right);}});return{top:top,left:left,bottom:bottom,right:right};}
function addSizeByPosition(boxes,size){helpers$1.each(boxes,function(box){size[box.position]+=box.isHorizontal()?box.height:box.width;});}
core_defaults._set('global',{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var core_layouts={defaults:{},addBox:function(chart,item){if(!chart.boxes){chart.boxes=[];}
item.fullWidth=item.fullWidth||false;item.position=item.position||'top';item.weight=item.weight||0;chart.boxes.push(item);},removeBox:function(chart,layoutItem){var index=chart.boxes?chart.boxes.indexOf(layoutItem):-1;if(index!==-1){chart.boxes.splice(index,1);}},configure:function(chart,item,options){var props=['fullWidth','position','weight'];var ilen=props.length;var i=0;var prop;for(;i<ilen;++i){prop=props[i];if(options.hasOwnProperty(prop)){item[prop]=options[prop];}}},update:function(chart,width,height){if(!chart){return;}
var layoutOptions=chart.options.layout||{};var padding=helpers$1.options.toPadding(layoutOptions.padding);var leftPadding=padding.left;var rightPadding=padding.right;var topPadding=padding.top;var bottomPadding=padding.bottom;var leftBoxes=filterByPosition(chart.boxes,'left');var rightBoxes=filterByPosition(chart.boxes,'right');var topBoxes=filterByPosition(chart.boxes,'top');var bottomBoxes=filterByPosition(chart.boxes,'bottom');var chartAreaBoxes=filterByPosition(chart.boxes,'chartArea');sortByWeight(leftBoxes,true);sortByWeight(rightBoxes,false);sortByWeight(topBoxes,true);sortByWeight(bottomBoxes,false);var verticalBoxes=leftBoxes.concat(rightBoxes);var horizontalBoxes=topBoxes.concat(bottomBoxes);var outerBoxes=verticalBoxes.concat(horizontalBoxes);var chartWidth=width-leftPadding-rightPadding;var chartHeight=height-topPadding-bottomPadding;var chartAreaWidth=chartWidth/2;var verticalBoxWidth=(width-chartAreaWidth)/verticalBoxes.length;var maxChartAreaWidth=chartWidth;var maxChartAreaHeight=chartHeight;var outerBoxSizes={top:topPadding,left:leftPadding,bottom:bottomPadding,right:rightPadding};var minBoxSizes=[];var maxPadding;function getMinimumBoxSize(box){var minSize;var isHorizontal=box.isHorizontal();if(isHorizontal){minSize=box.update(box.fullWidth?chartWidth:maxChartAreaWidth,chartHeight/2);maxChartAreaHeight-=minSize.height;}else{minSize=box.update(verticalBoxWidth,maxChartAreaHeight);maxChartAreaWidth-=minSize.width;}
minBoxSizes.push({horizontal:isHorizontal,width:minSize.width,box:box,});}
helpers$1.each(outerBoxes,getMinimumBoxSize);maxPadding=findMaxPadding(outerBoxes);function fitBox(box){var minBoxSize=helpers$1.findNextWhere(minBoxSizes,function(minBox){return minBox.box===box;});if(minBoxSize){if(minBoxSize.horizontal){var scaleMargin={left:Math.max(outerBoxSizes.left,maxPadding.left),right:Math.max(outerBoxSizes.right,maxPadding.right),top:0,bottom:0};box.update(box.fullWidth?chartWidth:maxChartAreaWidth,chartHeight/2,scaleMargin);}else{box.update(minBoxSize.width,maxChartAreaHeight);}}}
helpers$1.each(verticalBoxes,fitBox);addSizeByPosition(verticalBoxes,outerBoxSizes);helpers$1.each(horizontalBoxes,fitBox);addSizeByPosition(horizontalBoxes,outerBoxSizes);function finalFitVerticalBox(box){var minBoxSize=helpers$1.findNextWhere(minBoxSizes,function(minSize){return minSize.box===box;});var scaleMargin={left:0,right:0,top:outerBoxSizes.top,bottom:outerBoxSizes.bottom};if(minBoxSize){box.update(minBoxSize.width,maxChartAreaHeight,scaleMargin);}}
helpers$1.each(verticalBoxes,finalFitVerticalBox);outerBoxSizes={top:topPadding,left:leftPadding,bottom:bottomPadding,right:rightPadding};addSizeByPosition(outerBoxes,outerBoxSizes);var leftPaddingAddition=Math.max(maxPadding.left-outerBoxSizes.left,0);outerBoxSizes.left+=leftPaddingAddition;outerBoxSizes.right+=Math.max(maxPadding.right-outerBoxSizes.right,0);var topPaddingAddition=Math.max(maxPadding.top-outerBoxSizes.top,0);outerBoxSizes.top+=topPaddingAddition;outerBoxSizes.bottom+=Math.max(maxPadding.bottom-outerBoxSizes.bottom,0);var newMaxChartAreaHeight=height-outerBoxSizes.top-outerBoxSizes.bottom;var newMaxChartAreaWidth=width-outerBoxSizes.left-outerBoxSizes.right;if(newMaxChartAreaWidth!==maxChartAreaWidth||newMaxChartAreaHeight!==maxChartAreaHeight){helpers$1.each(verticalBoxes,function(box){box.height=newMaxChartAreaHeight;});helpers$1.each(horizontalBoxes,function(box){if(!box.fullWidth){box.width=newMaxChartAreaWidth;}});maxChartAreaHeight=newMaxChartAreaHeight;maxChartAreaWidth=newMaxChartAreaWidth;}
var left=leftPadding+leftPaddingAddition;var top=topPadding+topPaddingAddition;function placeBox(box){if(box.isHorizontal()){box.left=box.fullWidth?leftPadding:outerBoxSizes.left;box.right=box.fullWidth?width-rightPadding:outerBoxSizes.left+maxChartAreaWidth;box.top=top;box.bottom=top+box.height;top=box.bottom;}else{box.left=left;box.right=left+box.width;box.top=outerBoxSizes.top;box.bottom=outerBoxSizes.top+maxChartAreaHeight;left=box.right;}}
helpers$1.each(leftBoxes.concat(topBoxes),placeBox);left+=maxChartAreaWidth;top+=maxChartAreaHeight;helpers$1.each(rightBoxes,placeBox);helpers$1.each(bottomBoxes,placeBox);chart.chartArea={left:outerBoxSizes.left,top:outerBoxSizes.top,right:outerBoxSizes.left+maxChartAreaWidth,bottom:outerBoxSizes.top+maxChartAreaHeight};helpers$1.each(chartAreaBoxes,function(box){box.left=chart.chartArea.left;box.top=chart.chartArea.top;box.right=chart.chartArea.right;box.bottom=chart.chartArea.bottom;box.update(maxChartAreaWidth,maxChartAreaHeight);});}};var platform_basic={acquireContext:function(item){if(item&&item.canvas){item=item.canvas;}
return item&&item.getContext('2d')||null;}};var platform_dom="/*\n * DOM element rendering detection\n * https://davidwalsh.name/detect-node-insertion\n */\n@keyframes chartjs-render-animation {\n\tfrom { opacity: 0.99; }\n\tto { opacity: 1; }\n}\n\n.chartjs-render-monitor {\n\tanimation: chartjs-render-animation 0.001s;\n}\n\n/*\n * DOM element resizing detection\n * https://github.com/marcj/css-element-queries\n */\n.chartjs-size-monitor,\n.chartjs-size-monitor-expand,\n.chartjs-size-monitor-shrink {\n\tposition: absolute;\n\tdirection: ltr;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\tpointer-events: none;\n\tvisibility: hidden;\n\tz-index: -1;\n}\n\n.chartjs-size-monitor-expand > div {\n\tposition: absolute;\n\twidth: 1000000px;\n\theight: 1000000px;\n\tleft: 0;\n\ttop: 0;\n}\n\n.chartjs-size-monitor-shrink > div {\n\tposition: absolute;\n\twidth: 200%;\n\theight: 200%;\n\tleft: 0;\n\ttop: 0;\n}\n";var platform_dom$1=Object.freeze({default:platform_dom});var commonjsGlobal=typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{};function commonjsRequire(){throw new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');}
function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports;}
function getCjsExportFromNamespace(n){return n&&n.default||n;}
var stylesheet=getCjsExportFromNamespace(platform_dom$1);var EXPANDO_KEY='$chartjs';var CSS_PREFIX='chartjs-';var CSS_SIZE_MONITOR=CSS_PREFIX+'size-monitor';var CSS_RENDER_MONITOR=CSS_PREFIX+'render-monitor';var CSS_RENDER_ANIMATION=CSS_PREFIX+'render-animation';var ANIMATION_START_EVENTS=['animationstart','webkitAnimationStart'];var EVENT_TYPES={touchstart:'mousedown',touchmove:'mousemove',touchend:'mouseup',pointerenter:'mouseenter',pointerdown:'mousedown',pointermove:'mousemove',pointerup:'mouseup',pointerleave:'mouseout',pointerout:'mouseout'};function readUsedSize(element,property){var value=helpers$1.getStyle(element,property);var matches=value&&value.match(/^(\d+)(\.\d+)?px$/);return matches?Number(matches[1]):undefined;}
function initCanvas(canvas,config){var style=canvas.style;var renderHeight=canvas.getAttribute('height');var renderWidth=canvas.getAttribute('width');canvas[EXPANDO_KEY]={initial:{height:renderHeight,width:renderWidth,style:{display:style.display,height:style.height,width:style.width}}};style.display=style.display||'block';if(renderWidth===null||renderWidth===''){var displayWidth=readUsedSize(canvas,'width');if(displayWidth!==undefined){canvas.width=displayWidth;}}
if(renderHeight===null||renderHeight===''){if(canvas.style.height===''){canvas.height=canvas.width/(config.options.aspectRatio||2);}else{var displayHeight=readUsedSize(canvas,'height');if(displayWidth!==undefined){canvas.height=displayHeight;}}}
return canvas;}
var supportsEventListenerOptions=(function(){var supports=false;try{var options=Object.defineProperty({},'passive',{get:function(){supports=true;}});window.addEventListener('e',null,options);}catch(e){}
return supports;}());var eventListenerOptions=supportsEventListenerOptions?{passive:true}:false;function addListener(node,type,listener){node.addEventListener(type,listener,eventListenerOptions);}
function removeListener(node,type,listener){node.removeEventListener(type,listener,eventListenerOptions);}
function createEvent(type,chart,x,y,nativeEvent){return{type:type,chart:chart,native:nativeEvent||null,x:x!==undefined?x:null,y:y!==undefined?y:null,};}
function fromNativeEvent(event,chart){var type=EVENT_TYPES[event.type]||event.type;var pos=helpers$1.getRelativePosition(event,chart);return createEvent(type,chart,pos.x,pos.y,event);}
function throttled(fn,thisArg){var ticking=false;var args=[];return function(){args=Array.prototype.slice.call(arguments);thisArg=thisArg||this;if(!ticking){ticking=true;helpers$1.requestAnimFrame.call(window,function(){ticking=false;fn.apply(thisArg,args);});}};}
function createDiv(cls){var el=document.createElement('div');el.className=cls||'';return el;}
function createResizer(handler){var maxSize=1000000;var resizer=createDiv(CSS_SIZE_MONITOR);var expand=createDiv(CSS_SIZE_MONITOR+'-expand');var shrink=createDiv(CSS_SIZE_MONITOR+'-shrink');expand.appendChild(createDiv());shrink.appendChild(createDiv());resizer.appendChild(expand);resizer.appendChild(shrink);resizer._reset=function(){expand.scrollLeft=maxSize;expand.scrollTop=maxSize;shrink.scrollLeft=maxSize;shrink.scrollTop=maxSize;};var onScroll=function(){resizer._reset();handler();};addListener(expand,'scroll',onScroll.bind(expand,'expand'));addListener(shrink,'scroll',onScroll.bind(shrink,'shrink'));return resizer;}
function watchForRender(node,handler){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={});var proxy=expando.renderProxy=function(e){if(e.animationName===CSS_RENDER_ANIMATION){handler();}};helpers$1.each(ANIMATION_START_EVENTS,function(type){addListener(node,type,proxy);});expando.reflow=!!node.offsetParent;node.classList.add(CSS_RENDER_MONITOR);}
function unwatchForRender(node){var expando=node[EXPANDO_KEY]||{};var proxy=expando.renderProxy;if(proxy){helpers$1.each(ANIMATION_START_EVENTS,function(type){removeListener(node,type,proxy);});delete expando.renderProxy;}
node.classList.remove(CSS_RENDER_MONITOR);}
function addResizeListener(node,listener,chart){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={});var resizer=expando.resizer=createResizer(throttled(function(){if(expando.resizer){var container=chart.options.maintainAspectRatio&&node.parentNode;var w=container?container.clientWidth:0;listener(createEvent('resize',chart));if(container&&container.clientWidth<w&&chart.canvas){listener(createEvent('resize',chart));}}}));watchForRender(node,function(){if(expando.resizer){var container=node.parentNode;if(container&&container!==resizer.parentNode){container.insertBefore(resizer,container.firstChild);}
resizer._reset();}});}
function removeResizeListener(node){var expando=node[EXPANDO_KEY]||{};var resizer=expando.resizer;delete expando.resizer;unwatchForRender(node);if(resizer&&resizer.parentNode){resizer.parentNode.removeChild(resizer);}}
function injectCSS(platform,css){var style=platform._style||document.createElement('style');if(!platform._style){platform._style=style;css='/* Chart.js */\n'+css;style.setAttribute('type','text/css');document.getElementsByTagName('head')[0].appendChild(style);}
style.appendChild(document.createTextNode(css));}
var platform_dom$2={disableCSSInjection:false,_enabled:typeof window!=='undefined'&&typeof document!=='undefined',_ensureLoaded:function(){if(this._loaded){return;}
this._loaded=true;if(!this.disableCSSInjection){injectCSS(this,stylesheet);}},acquireContext:function(item,config){if(typeof item==='string'){item=document.getElementById(item);}else if(item.length){item=item[0];}
if(item&&item.canvas){item=item.canvas;}
var context=item&&item.getContext&&item.getContext('2d');this._ensureLoaded();if(context&&context.canvas===item){initCanvas(item,config);return context;}
return null;},releaseContext:function(context){var canvas=context.canvas;if(!canvas[EXPANDO_KEY]){return;}
var initial=canvas[EXPANDO_KEY].initial;['height','width'].forEach(function(prop){var value=initial[prop];if(helpers$1.isNullOrUndef(value)){canvas.removeAttribute(prop);}else{canvas.setAttribute(prop,value);}});helpers$1.each(initial.style||{},function(value,key){canvas.style[key]=value;});canvas.width=canvas.width;delete canvas[EXPANDO_KEY];},addEventListener:function(chart,type,listener){var canvas=chart.canvas;if(type==='resize'){addResizeListener(canvas,listener,chart);return;}
var expando=listener[EXPANDO_KEY]||(listener[EXPANDO_KEY]={});var proxies=expando.proxies||(expando.proxies={});var proxy=proxies[chart.id+'_'+type]=function(event){listener(fromNativeEvent(event,chart));};addListener(canvas,type,proxy);},removeEventListener:function(chart,type,listener){var canvas=chart.canvas;if(type==='resize'){removeResizeListener(canvas);return;}
var expando=listener[EXPANDO_KEY]||{};var proxies=expando.proxies||{};var proxy=proxies[chart.id+'_'+type];if(!proxy){return;}
removeListener(canvas,type,proxy);}};helpers$1.addEvent=addListener;helpers$1.removeEvent=removeListener;var implementation=platform_dom$2._enabled?platform_dom$2:platform_basic;var platform=helpers$1.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},implementation);core_defaults._set('global',{plugins:{}});var core_plugins={_plugins:[],_cacheId:0,register:function(plugins){var p=this._plugins;([]).concat(plugins).forEach(function(plugin){if(p.indexOf(plugin)===-1){p.push(plugin);}});this._cacheId++;},unregister:function(plugins){var p=this._plugins;([]).concat(plugins).forEach(function(plugin){var idx=p.indexOf(plugin);if(idx!==-1){p.splice(idx,1);}});this._cacheId++;},clear:function(){this._plugins=[];this._cacheId++;},count:function(){return this._plugins.length;},getAll:function(){return this._plugins;},notify:function(chart,hook,args){var descriptors=this.descriptors(chart);var ilen=descriptors.length;var i,descriptor,plugin,params,method;for(i=0;i<ilen;++i){descriptor=descriptors[i];plugin=descriptor.plugin;method=plugin[hook];if(typeof method==='function'){params=[chart].concat(args||[]);params.push(descriptor.options);if(method.apply(plugin,params)===false){return false;}}}
return true;},descriptors:function(chart){var cache=chart.$plugins||(chart.$plugins={});if(cache.id===this._cacheId){return cache.descriptors;}
var plugins=[];var descriptors=[];var config=(chart&&chart.config)||{};var options=(config.options&&config.options.plugins)||{};this._plugins.concat(config.plugins||[]).forEach(function(plugin){var idx=plugins.indexOf(plugin);if(idx!==-1){return;}
var id=plugin.id;var opts=options[id];if(opts===false){return;}
if(opts===true){opts=helpers$1.clone(core_defaults.global.plugins[id]);}
plugins.push(plugin);descriptors.push({plugin:plugin,options:opts||{}});});cache.descriptors=descriptors;cache.id=this._cacheId;return descriptors;},_invalidate:function(chart){delete chart.$plugins;}};var core_scaleService={constructors:{},defaults:{},registerScaleType:function(type,scaleConstructor,scaleDefaults){this.constructors[type]=scaleConstructor;this.defaults[type]=helpers$1.clone(scaleDefaults);},getScaleConstructor:function(type){return this.constructors.hasOwnProperty(type)?this.constructors[type]:undefined;},getScaleDefaults:function(type){return this.defaults.hasOwnProperty(type)?helpers$1.merge({},[core_defaults.scale,this.defaults[type]]):{};},updateScaleDefaults:function(type,additions){var me=this;if(me.defaults.hasOwnProperty(type)){me.defaults[type]=helpers$1.extend(me.defaults[type],additions);}},addScalesToLayout:function(chart){helpers$1.each(chart.scales,function(scale){scale.fullWidth=scale.options.fullWidth;scale.position=scale.options.position;scale.weight=scale.options.weight;core_layouts.addBox(chart,scale);});}};var valueOrDefault$7=helpers$1.valueOrDefault;core_defaults._set('global',{tooltips:{enabled:true,custom:null,mode:'nearest',position:'average',intersect:true,backgroundColor:'rgba(0,0,0,0.8)',titleFontStyle:'bold',titleSpacing:2,titleMarginBottom:6,titleFontColor:'#fff',titleAlign:'left',bodySpacing:2,bodyFontColor:'#fff',bodyAlign:'left',footerFontStyle:'bold',footerSpacing:2,footerMarginTop:6,footerFontColor:'#fff',footerAlign:'left',yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:'#fff',displayColors:true,borderColor:'rgba(0,0,0,0)',borderWidth:0,callbacks:{beforeTitle:helpers$1.noop,title:function(tooltipItems,data){var title='';var labels=data.labels;var labelCount=labels?labels.length:0;if(tooltipItems.length>0){var item=tooltipItems[0];if(item.label){title=item.label;}else if(item.xLabel){title=item.xLabel;}else if(labelCount>0&&item.index<labelCount){title=labels[item.index];}}
return title;},afterTitle:helpers$1.noop,beforeBody:helpers$1.noop,beforeLabel:helpers$1.noop,label:function(tooltipItem,data){var label=data.datasets[tooltipItem.datasetIndex].label||'';if(label){label+=': ';}
if(!helpers$1.isNullOrUndef(tooltipItem.value)){label+=tooltipItem.value;}else{label+=tooltipItem.yLabel;}
return label;},labelColor:function(tooltipItem,chart){var meta=chart.getDatasetMeta(tooltipItem.datasetIndex);var activeElement=meta.data[tooltipItem.index];var view=activeElement._view;return{borderColor:view.borderColor,backgroundColor:view.backgroundColor};},labelTextColor:function(){return this._options.bodyFontColor;},afterLabel:helpers$1.noop,afterBody:helpers$1.noop,beforeFooter:helpers$1.noop,footer:helpers$1.noop,afterFooter:helpers$1.noop}}});var positioners={average:function(elements){if(!elements.length){return false;}
var i,len;var x=0;var y=0;var count=0;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var pos=el.tooltipPosition();x+=pos.x;y+=pos.y;++count;}}
return{x:x/count,y:y/count};},nearest:function(elements,eventPosition){var x=eventPosition.x;var y=eventPosition.y;var minDistance=Number.POSITIVE_INFINITY;var i,len,nearestElement;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var center=el.getCenterPoint();var d=helpers$1.distanceBetweenPoints(eventPosition,center);if(d<minDistance){minDistance=d;nearestElement=el;}}}
if(nearestElement){var tp=nearestElement.tooltipPosition();x=tp.x;y=tp.y;}
return{x:x,y:y};}};function pushOrConcat(base,toPush){if(toPush){if(helpers$1.isArray(toPush)){Array.prototype.push.apply(base,toPush);}else{base.push(toPush);}}
return base;}
function splitNewlines(str){if((typeof str==='string'||str instanceof String)&&str.indexOf('\n')>-1){return str.split('\n');}
return str;}
function createTooltipItem(element){var xScale=element._xScale;var yScale=element._yScale||element._scale;var index=element._index;var datasetIndex=element._datasetIndex;var controller=element._chart.getDatasetMeta(datasetIndex).controller;var indexScale=controller._getIndexScale();var valueScale=controller._getValueScale();return{xLabel:xScale?xScale.getLabelForIndex(index,datasetIndex):'',yLabel:yScale?yScale.getLabelForIndex(index,datasetIndex):'',label:indexScale?''+indexScale.getLabelForIndex(index,datasetIndex):'',value:valueScale?''+valueScale.getLabelForIndex(index,datasetIndex):'',index:index,datasetIndex:datasetIndex,x:element._model.x,y:element._model.y};}
function getBaseModel(tooltipOpts){var globalDefaults=core_defaults.global;return{xPadding:tooltipOpts.xPadding,yPadding:tooltipOpts.yPadding,xAlign:tooltipOpts.xAlign,yAlign:tooltipOpts.yAlign,bodyFontColor:tooltipOpts.bodyFontColor,_bodyFontFamily:valueOrDefault$7(tooltipOpts.bodyFontFamily,globalDefaults.defaultFontFamily),_bodyFontStyle:valueOrDefault$7(tooltipOpts.bodyFontStyle,globalDefaults.defaultFontStyle),_bodyAlign:tooltipOpts.bodyAlign,bodyFontSize:valueOrDefault$7(tooltipOpts.bodyFontSize,globalDefaults.defaultFontSize),bodySpacing:tooltipOpts.bodySpacing,titleFontColor:tooltipOpts.titleFontColor,_titleFontFamily:valueOrDefault$7(tooltipOpts.titleFontFamily,globalDefaults.defaultFontFamily),_titleFontStyle:valueOrDefault$7(tooltipOpts.titleFontStyle,globalDefaults.defaultFontStyle),titleFontSize:valueOrDefault$7(tooltipOpts.titleFontSize,globalDefaults.defaultFontSize),_titleAlign:tooltipOpts.titleAlign,titleSpacing:tooltipOpts.titleSpacing,titleMarginBottom:tooltipOpts.titleMarginBottom,footerFontColor:tooltipOpts.footerFontColor,_footerFontFamily:valueOrDefault$7(tooltipOpts.footerFontFamily,globalDefaults.defaultFontFamily),_footerFontStyle:valueOrDefault$7(tooltipOpts.footerFontStyle,globalDefaults.defaultFontStyle),footerFontSize:valueOrDefault$7(tooltipOpts.footerFontSize,globalDefaults.defaultFontSize),_footerAlign:tooltipOpts.footerAlign,footerSpacing:tooltipOpts.footerSpacing,footerMarginTop:tooltipOpts.footerMarginTop,caretSize:tooltipOpts.caretSize,cornerRadius:tooltipOpts.cornerRadius,backgroundColor:tooltipOpts.backgroundColor,opacity:0,legendColorBackground:tooltipOpts.multiKeyBackground,displayColors:tooltipOpts.displayColors,borderColor:tooltipOpts.borderColor,borderWidth:tooltipOpts.borderWidth};}
function getTooltipSize(tooltip,model){var ctx=tooltip._chart.ctx;var height=model.yPadding*2;var width=0;var body=model.body;var combinedBodyLength=body.reduce(function(count,bodyItem){return count+bodyItem.before.length+bodyItem.lines.length+bodyItem.after.length;},0);combinedBodyLength+=model.beforeBody.length+model.afterBody.length;var titleLineCount=model.title.length;var footerLineCount=model.footer.length;var titleFontSize=model.titleFontSize;var bodyFontSize=model.bodyFontSize;var footerFontSize=model.footerFontSize;height+=titleLineCount*titleFontSize;height+=titleLineCount?(titleLineCount-1)*model.titleSpacing:0;height+=titleLineCount?model.titleMarginBottom:0;height+=combinedBodyLength*bodyFontSize;height+=combinedBodyLength?(combinedBodyLength-1)*model.bodySpacing:0;height+=footerLineCount?model.footerMarginTop:0;height+=footerLineCount*(footerFontSize);height+=footerLineCount?(footerLineCount-1)*model.footerSpacing:0;var widthPadding=0;var maxLineWidth=function(line){width=Math.max(width,ctx.measureText(line).width+widthPadding);};ctx.font=helpers$1.fontString(titleFontSize,model._titleFontStyle,model._titleFontFamily);helpers$1.each(model.title,maxLineWidth);ctx.font=helpers$1.fontString(bodyFontSize,model._bodyFontStyle,model._bodyFontFamily);helpers$1.each(model.beforeBody.concat(model.afterBody),maxLineWidth);widthPadding=model.displayColors?(bodyFontSize+2):0;helpers$1.each(body,function(bodyItem){helpers$1.each(bodyItem.before,maxLineWidth);helpers$1.each(bodyItem.lines,maxLineWidth);helpers$1.each(bodyItem.after,maxLineWidth);});widthPadding=0;ctx.font=helpers$1.fontString(footerFontSize,model._footerFontStyle,model._footerFontFamily);helpers$1.each(model.footer,maxLineWidth);width+=2*model.xPadding;return{width:width,height:height};}
function determineAlignment(tooltip,size){var model=tooltip._model;var chart=tooltip._chart;var chartArea=tooltip._chart.chartArea;var xAlign='center';var yAlign='center';if(model.y<size.height){yAlign='top';}else if(model.y>(chart.height-size.height)){yAlign='bottom';}
var lf,rf;var olf,orf;var yf;var midX=(chartArea.left+chartArea.right)/2;var midY=(chartArea.top+chartArea.bottom)/2;if(yAlign==='center'){lf=function(x){return x<=midX;};rf=function(x){return x>midX;};}else{lf=function(x){return x<=(size.width/2);};rf=function(x){return x>=(chart.width-(size.width/2));};}
olf=function(x){return x+size.width+model.caretSize+model.caretPadding>chart.width;};orf=function(x){return x-size.width-model.caretSize-model.caretPadding<0;};yf=function(y){return y<=midY?'top':'bottom';};if(lf(model.x)){xAlign='left';if(olf(model.x)){xAlign='center';yAlign=yf(model.y);}}else if(rf(model.x)){xAlign='right';if(orf(model.x)){xAlign='center';yAlign=yf(model.y);}}
var opts=tooltip._options;return{xAlign:opts.xAlign?opts.xAlign:xAlign,yAlign:opts.yAlign?opts.yAlign:yAlign};}
function getBackgroundPoint(vm,size,alignment,chart){var x=vm.x;var y=vm.y;var caretSize=vm.caretSize;var caretPadding=vm.caretPadding;var cornerRadius=vm.cornerRadius;var xAlign=alignment.xAlign;var yAlign=alignment.yAlign;var paddingAndSize=caretSize+caretPadding;var radiusAndPadding=cornerRadius+caretPadding;if(xAlign==='right'){x-=size.width;}else if(xAlign==='center'){x-=(size.width/2);if(x+size.width>chart.width){x=chart.width-size.width;}
if(x<0){x=0;}}
if(yAlign==='top'){y+=paddingAndSize;}else if(yAlign==='bottom'){y-=size.height+paddingAndSize;}else{y-=(size.height/2);}
if(yAlign==='center'){if(xAlign==='left'){x+=paddingAndSize;}else if(xAlign==='right'){x-=paddingAndSize;}}else if(xAlign==='left'){x-=radiusAndPadding;}else if(xAlign==='right'){x+=radiusAndPadding;}
return{x:x,y:y};}
function getAlignedX(vm,align){return align==='center'?vm.x+vm.width/2:align==='right'?vm.x+vm.width-vm.xPadding:vm.x+vm.xPadding;}
function getBeforeAfterBodyLines(callback){return pushOrConcat([],splitNewlines(callback));}
var exports$3=core_element.extend({initialize:function(){this._model=getBaseModel(this._options);this._lastActive=[];},getTitle:function(){var me=this;var opts=me._options;var callbacks=opts.callbacks;var beforeTitle=callbacks.beforeTitle.apply(me,arguments);var title=callbacks.title.apply(me,arguments);var afterTitle=callbacks.afterTitle.apply(me,arguments);var lines=[];lines=pushOrConcat(lines,splitNewlines(beforeTitle));lines=pushOrConcat(lines,splitNewlines(title));lines=pushOrConcat(lines,splitNewlines(afterTitle));return lines;},getBeforeBody:function(){return getBeforeAfterBodyLines(this._options.callbacks.beforeBody.apply(this,arguments));},getBody:function(tooltipItems,data){var me=this;var callbacks=me._options.callbacks;var bodyItems=[];helpers$1.each(tooltipItems,function(tooltipItem){var bodyItem={before:[],lines:[],after:[]};pushOrConcat(bodyItem.before,splitNewlines(callbacks.beforeLabel.call(me,tooltipItem,data)));pushOrConcat(bodyItem.lines,callbacks.label.call(me,tooltipItem,data));pushOrConcat(bodyItem.after,splitNewlines(callbacks.afterLabel.call(me,tooltipItem,data)));bodyItems.push(bodyItem);});return bodyItems;},getAfterBody:function(){return getBeforeAfterBodyLines(this._options.callbacks.afterBody.apply(this,arguments));},getFooter:function(){var me=this;var callbacks=me._options.callbacks;var beforeFooter=callbacks.beforeFooter.apply(me,arguments);var footer=callbacks.footer.apply(me,arguments);var afterFooter=callbacks.afterFooter.apply(me,arguments);var lines=[];lines=pushOrConcat(lines,splitNewlines(beforeFooter));lines=pushOrConcat(lines,splitNewlines(footer));lines=pushOrConcat(lines,splitNewlines(afterFooter));return lines;},update:function(changed){var me=this;var opts=me._options;var existingModel=me._model;var model=me._model=getBaseModel(opts);var active=me._active;var data=me._data;var alignment={xAlign:existingModel.xAlign,yAlign:existingModel.yAlign};var backgroundPoint={x:existingModel.x,y:existingModel.y};var tooltipSize={width:existingModel.width,height:existingModel.height};var tooltipPosition={x:existingModel.caretX,y:existingModel.caretY};var i,len;if(active.length){model.opacity=1;var labelColors=[];var labelTextColors=[];tooltipPosition=positioners[opts.position].call(me,active,me._eventPosition);var tooltipItems=[];for(i=0,len=active.length;i<len;++i){tooltipItems.push(createTooltipItem(active[i]));}
if(opts.filter){tooltipItems=tooltipItems.filter(function(a){return opts.filter(a,data);});}
if(opts.itemSort){tooltipItems=tooltipItems.sort(function(a,b){return opts.itemSort(a,b,data);});}
helpers$1.each(tooltipItems,function(tooltipItem){labelColors.push(opts.callbacks.labelColor.call(me,tooltipItem,me._chart));labelTextColors.push(opts.callbacks.labelTextColor.call(me,tooltipItem,me._chart));});model.title=me.getTitle(tooltipItems,data);model.beforeBody=me.getBeforeBody(tooltipItems,data);model.body=me.getBody(tooltipItems,data);model.afterBody=me.getAfterBody(tooltipItems,data);model.footer=me.getFooter(tooltipItems,data);model.x=tooltipPosition.x;model.y=tooltipPosition.y;model.caretPadding=opts.caretPadding;model.labelColors=labelColors;model.labelTextColors=labelTextColors;model.dataPoints=tooltipItems;tooltipSize=getTooltipSize(this,model);alignment=determineAlignment(this,tooltipSize);backgroundPoint=getBackgroundPoint(model,tooltipSize,alignment,me._chart);}else{model.opacity=0;}
model.xAlign=alignment.xAlign;model.yAlign=alignment.yAlign;model.x=backgroundPoint.x;model.y=backgroundPoint.y;model.width=tooltipSize.width;model.height=tooltipSize.height;model.caretX=tooltipPosition.x;model.caretY=tooltipPosition.y;me._model=model;if(changed&&opts.custom){opts.custom.call(me,model);}
return me;},drawCaret:function(tooltipPoint,size){var ctx=this._chart.ctx;var vm=this._view;var caretPosition=this.getCaretPosition(tooltipPoint,size,vm);ctx.lineTo(caretPosition.x1,caretPosition.y1);ctx.lineTo(caretPosition.x2,caretPosition.y2);ctx.lineTo(caretPosition.x3,caretPosition.y3);},getCaretPosition:function(tooltipPoint,size,vm){var x1,x2,x3,y1,y2,y3;var caretSize=vm.caretSize;var cornerRadius=vm.cornerRadius;var xAlign=vm.xAlign;var yAlign=vm.yAlign;var ptX=tooltipPoint.x;var ptY=tooltipPoint.y;var width=size.width;var height=size.height;if(yAlign==='center'){y2=ptY+(height/2);if(xAlign==='left'){x1=ptX;x2=x1-caretSize;x3=x1;y1=y2+caretSize;y3=y2-caretSize;}else{x1=ptX+width;x2=x1+caretSize;x3=x1;y1=y2-caretSize;y3=y2+caretSize;}}else{if(xAlign==='left'){x2=ptX+cornerRadius+(caretSize);x1=x2-caretSize;x3=x2+caretSize;}else if(xAlign==='right'){x2=ptX+width-cornerRadius-caretSize;x1=x2-caretSize;x3=x2+caretSize;}else{x2=vm.caretX;x1=x2-caretSize;x3=x2+caretSize;}
if(yAlign==='top'){y1=ptY;y2=y1-caretSize;y3=y1;}else{y1=ptY+height;y2=y1+caretSize;y3=y1;var tmp=x3;x3=x1;x1=tmp;}}
return{x1:x1,x2:x2,x3:x3,y1:y1,y2:y2,y3:y3};},drawTitle:function(pt,vm,ctx){var title=vm.title;if(title.length){pt.x=getAlignedX(vm,vm._titleAlign);ctx.textAlign=vm._titleAlign;ctx.textBaseline='top';var titleFontSize=vm.titleFontSize;var titleSpacing=vm.titleSpacing;ctx.fillStyle=vm.titleFontColor;ctx.font=helpers$1.fontString(titleFontSize,vm._titleFontStyle,vm._titleFontFamily);var i,len;for(i=0,len=title.length;i<len;++i){ctx.fillText(title[i],pt.x,pt.y);pt.y+=titleFontSize+titleSpacing;if(i+1===title.length){pt.y+=vm.titleMarginBottom-titleSpacing;}}}},drawBody:function(pt,vm,ctx){var bodyFontSize=vm.bodyFontSize;var bodySpacing=vm.bodySpacing;var bodyAlign=vm._bodyAlign;var body=vm.body;var drawColorBoxes=vm.displayColors;var labelColors=vm.labelColors;var xLinePadding=0;var colorX=drawColorBoxes?getAlignedX(vm,'left'):0;var textColor;ctx.textAlign=bodyAlign;ctx.textBaseline='top';ctx.font=helpers$1.fontString(bodyFontSize,vm._bodyFontStyle,vm._bodyFontFamily);pt.x=getAlignedX(vm,bodyAlign);var fillLineOfText=function(line){ctx.fillText(line,pt.x+xLinePadding,pt.y);pt.y+=bodyFontSize+bodySpacing;};ctx.fillStyle=vm.bodyFontColor;helpers$1.each(vm.beforeBody,fillLineOfText);xLinePadding=drawColorBoxes&&bodyAlign!=='right'?bodyAlign==='center'?(bodyFontSize/2+1):(bodyFontSize+2):0;helpers$1.each(body,function(bodyItem,i){textColor=vm.labelTextColors[i];ctx.fillStyle=textColor;helpers$1.each(bodyItem.before,fillLineOfText);helpers$1.each(bodyItem.lines,function(line){if(drawColorBoxes){ctx.fillStyle=vm.legendColorBackground;ctx.fillRect(colorX,pt.y,bodyFontSize,bodyFontSize);ctx.lineWidth=1;ctx.strokeStyle=labelColors[i].borderColor;ctx.strokeRect(colorX,pt.y,bodyFontSize,bodyFontSize);ctx.fillStyle=labelColors[i].backgroundColor;ctx.fillRect(colorX+1,pt.y+1,bodyFontSize-2,bodyFontSize-2);ctx.fillStyle=textColor;}
fillLineOfText(line);});helpers$1.each(bodyItem.after,fillLineOfText);});xLinePadding=0;helpers$1.each(vm.afterBody,fillLineOfText);pt.y-=bodySpacing;},drawFooter:function(pt,vm,ctx){var footer=vm.footer;if(footer.length){pt.x=getAlignedX(vm,vm._footerAlign);pt.y+=vm.footerMarginTop;ctx.textAlign=vm._footerAlign;ctx.textBaseline='top';ctx.fillStyle=vm.footerFontColor;ctx.font=helpers$1.fontString(vm.footerFontSize,vm._footerFontStyle,vm._footerFontFamily);helpers$1.each(footer,function(line){ctx.fillText(line,pt.x,pt.y);pt.y+=vm.footerFontSize+vm.footerSpacing;});}},drawBackground:function(pt,vm,ctx,tooltipSize){ctx.fillStyle=vm.backgroundColor;ctx.strokeStyle=vm.borderColor;ctx.lineWidth=vm.borderWidth;var xAlign=vm.xAlign;var yAlign=vm.yAlign;var x=pt.x;var y=pt.y;var width=tooltipSize.width;var height=tooltipSize.height;var radius=vm.cornerRadius;ctx.beginPath();ctx.moveTo(x+radius,y);if(yAlign==='top'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x+width-radius,y);ctx.quadraticCurveTo(x+width,y,x+width,y+radius);if(yAlign==='center'&&xAlign==='right'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x+width,y+height-radius);ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height);if(yAlign==='bottom'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x+radius,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-radius);if(yAlign==='center'&&xAlign==='left'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x,y+radius);ctx.quadraticCurveTo(x,y,x+radius,y);ctx.closePath();ctx.fill();if(vm.borderWidth>0){ctx.stroke();}},draw:function(){var ctx=this._chart.ctx;var vm=this._view;if(vm.opacity===0){return;}
var tooltipSize={width:vm.width,height:vm.height};var pt={x:vm.x,y:vm.y};var opacity=Math.abs(vm.opacity<1e-3)?0:vm.opacity;var hasTooltipContent=vm.title.length||vm.beforeBody.length||vm.body.length||vm.afterBody.length||vm.footer.length;if(this._options.enabled&&hasTooltipContent){ctx.save();ctx.globalAlpha=opacity;this.drawBackground(pt,vm,ctx,tooltipSize);pt.y+=vm.yPadding;this.drawTitle(pt,vm,ctx);this.drawBody(pt,vm,ctx);this.drawFooter(pt,vm,ctx);ctx.restore();}},handleEvent:function(e){var me=this;var options=me._options;var changed=false;me._lastActive=me._lastActive||[];if(e.type==='mouseout'){me._active=[];}else{me._active=me._chart.getElementsAtEventForMode(e,options.mode,options);}
changed=!helpers$1.arrayEquals(me._active,me._lastActive);if(changed){me._lastActive=me._active;if(options.enabled||options.custom){me._eventPosition={x:e.x,y:e.y};me.update(true);me.pivot();}}
return changed;}});var positioners_1=positioners;var core_tooltip=exports$3;core_tooltip.positioners=positioners_1;var valueOrDefault$8=helpers$1.valueOrDefault;core_defaults._set('global',{elements:{},events:['mousemove','mouseout','click','touchstart','touchmove'],hover:{onHover:null,mode:'nearest',intersect:true,animationDuration:400},onClick:null,maintainAspectRatio:true,responsive:true,responsiveAnimationDuration:0});function mergeScaleConfig(){return helpers$1.merge({},[].slice.call(arguments),{merger:function(key,target,source,options){if(key==='xAxes'||key==='yAxes'){var slen=source[key].length;var i,type,scale;if(!target[key]){target[key]=[];}
for(i=0;i<slen;++i){scale=source[key][i];type=valueOrDefault$8(scale.type,key==='xAxes'?'category':'linear');if(i>=target[key].length){target[key].push({});}
if(!target[key][i].type||(scale.type&&scale.type!==target[key][i].type)){helpers$1.merge(target[key][i],[core_scaleService.getScaleDefaults(type),scale]);}else{helpers$1.merge(target[key][i],scale);}}}else{helpers$1._merger(key,target,source,options);}}});}
function mergeConfig(){return helpers$1.merge({},[].slice.call(arguments),{merger:function(key,target,source,options){var tval=target[key]||{};var sval=source[key];if(key==='scales'){target[key]=mergeScaleConfig(tval,sval);}else if(key==='scale'){target[key]=helpers$1.merge(tval,[core_scaleService.getScaleDefaults(sval.type),sval]);}else{helpers$1._merger(key,target,source,options);}}});}
function initConfig(config){config=config||{};var data=config.data=config.data||{};data.datasets=data.datasets||[];data.labels=data.labels||[];config.options=mergeConfig(core_defaults.global,core_defaults[config.type],config.options||{});return config;}
function updateConfig(chart){var newOptions=chart.options;helpers$1.each(chart.scales,function(scale){core_layouts.removeBox(chart,scale);});newOptions=mergeConfig(core_defaults.global,core_defaults[chart.config.type],newOptions);chart.options=chart.config.options=newOptions;chart.ensureScalesHaveIDs();chart.buildOrUpdateScales();chart.tooltip._options=newOptions.tooltips;chart.tooltip.initialize();}
function positionIsHorizontal(position){return position==='top'||position==='bottom';}
var Chart=function(item,config){this.construct(item,config);return this;};helpers$1.extend(Chart.prototype,{construct:function(item,config){var me=this;config=initConfig(config);var context=platform.acquireContext(item,config);var canvas=context&&context.canvas;var height=canvas&&canvas.height;var width=canvas&&canvas.width;me.id=helpers$1.uid();me.ctx=context;me.canvas=canvas;me.config=config;me.width=width;me.height=height;me.aspectRatio=height?width/height:null;me.options=config.options;me._bufferedRender=false;me.chart=me;me.controller=me;Chart.instances[me.id]=me;Object.defineProperty(me,'data',{get:function(){return me.config.data;},set:function(value){me.config.data=value;}});if(!context||!canvas){console.error("Failed to create chart: can't acquire context from the given item");return;}
me.initialize();me.update();},initialize:function(){var me=this;core_plugins.notify(me,'beforeInit');helpers$1.retinaScale(me,me.options.devicePixelRatio);me.bindEvents();if(me.options.responsive){me.resize(true);}
me.ensureScalesHaveIDs();me.buildOrUpdateScales();me.initToolTip();core_plugins.notify(me,'afterInit');return me;},clear:function(){helpers$1.canvas.clear(this);return this;},stop:function(){core_animations.cancelAnimation(this);return this;},resize:function(silent){var me=this;var options=me.options;var canvas=me.canvas;var aspectRatio=(options.maintainAspectRatio&&me.aspectRatio)||null;var newWidth=Math.max(0,Math.floor(helpers$1.getMaximumWidth(canvas)));var newHeight=Math.max(0,Math.floor(aspectRatio?newWidth/aspectRatio:helpers$1.getMaximumHeight(canvas)));if(me.width===newWidth&&me.height===newHeight){return;}
canvas.width=me.width=newWidth;canvas.height=me.height=newHeight;canvas.style.width=newWidth+'px';canvas.style.height=newHeight+'px';helpers$1.retinaScale(me,options.devicePixelRatio);if(!silent){var newSize={width:newWidth,height:newHeight};core_plugins.notify(me,'resize',[newSize]);if(options.onResize){options.onResize(me,newSize);}
me.stop();me.update({duration:options.responsiveAnimationDuration});}},ensureScalesHaveIDs:function(){var options=this.options;var scalesOptions=options.scales||{};var scaleOptions=options.scale;helpers$1.each(scalesOptions.xAxes,function(xAxisOptions,index){xAxisOptions.id=xAxisOptions.id||('x-axis-'+index);});helpers$1.each(scalesOptions.yAxes,function(yAxisOptions,index){yAxisOptions.id=yAxisOptions.id||('y-axis-'+index);});if(scaleOptions){scaleOptions.id=scaleOptions.id||'scale';}},buildOrUpdateScales:function(){var me=this;var options=me.options;var scales=me.scales||{};var items=[];var updated=Object.keys(scales).reduce(function(obj,id){obj[id]=false;return obj;},{});if(options.scales){items=items.concat((options.scales.xAxes||[]).map(function(xAxisOptions){return{options:xAxisOptions,dtype:'category',dposition:'bottom'};}),(options.scales.yAxes||[]).map(function(yAxisOptions){return{options:yAxisOptions,dtype:'linear',dposition:'left'};}));}
if(options.scale){items.push({options:options.scale,dtype:'radialLinear',isDefault:true,dposition:'chartArea'});}
helpers$1.each(items,function(item){var scaleOptions=item.options;var id=scaleOptions.id;var scaleType=valueOrDefault$8(scaleOptions.type,item.dtype);if(positionIsHorizontal(scaleOptions.position)!==positionIsHorizontal(item.dposition)){scaleOptions.position=item.dposition;}
updated[id]=true;var scale=null;if(id in scales&&scales[id].type===scaleType){scale=scales[id];scale.options=scaleOptions;scale.ctx=me.ctx;scale.chart=me;}else{var scaleClass=core_scaleService.getScaleConstructor(scaleType);if(!scaleClass){return;}
scale=new scaleClass({id:id,type:scaleType,options:scaleOptions,ctx:me.ctx,chart:me});scales[scale.id]=scale;}
scale.mergeTicksOptions();if(item.isDefault){me.scale=scale;}});helpers$1.each(updated,function(hasUpdated,id){if(!hasUpdated){delete scales[id];}});me.scales=scales;core_scaleService.addScalesToLayout(this);},buildOrUpdateControllers:function(){var me=this;var newControllers=[];helpers$1.each(me.data.datasets,function(dataset,datasetIndex){var meta=me.getDatasetMeta(datasetIndex);var type=dataset.type||me.config.type;if(meta.type&&meta.type!==type){me.destroyDatasetMeta(datasetIndex);meta=me.getDatasetMeta(datasetIndex);}
meta.type=type;if(meta.controller){meta.controller.updateIndex(datasetIndex);meta.controller.linkScales();}else{var ControllerClass=controllers[meta.type];if(ControllerClass===undefined){throw new Error('"'+meta.type+'" is not a chart type.');}
meta.controller=new ControllerClass(me,datasetIndex);newControllers.push(meta.controller);}},me);return newControllers;},resetElements:function(){var me=this;helpers$1.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.reset();},me);},reset:function(){this.resetElements();this.tooltip.initialize();},update:function(config){var me=this;if(!config||typeof config!=='object'){config={duration:config,lazy:arguments[1]};}
updateConfig(me);core_plugins._invalidate(me);if(core_plugins.notify(me,'beforeUpdate')===false){return;}
me.tooltip._data=me.data;var newControllers=me.buildOrUpdateControllers();helpers$1.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.buildOrUpdateElements();},me);me.updateLayout();if(me.options.animation&&me.options.animation.duration){helpers$1.each(newControllers,function(controller){controller.reset();});}
me.updateDatasets();me.tooltip.initialize();me.lastActive=[];core_plugins.notify(me,'afterUpdate');if(me._bufferedRender){me._bufferedRequest={duration:config.duration,easing:config.easing,lazy:config.lazy};}else{me.render(config);}},updateLayout:function(){var me=this;if(core_plugins.notify(me,'beforeLayout')===false){return;}
core_layouts.update(this,this.width,this.height);core_plugins.notify(me,'afterScaleUpdate');core_plugins.notify(me,'afterLayout');},updateDatasets:function(){var me=this;if(core_plugins.notify(me,'beforeDatasetsUpdate')===false){return;}
for(var i=0,ilen=me.data.datasets.length;i<ilen;++i){me.updateDataset(i);}
core_plugins.notify(me,'afterDatasetsUpdate');},updateDataset:function(index){var me=this;var meta=me.getDatasetMeta(index);var args={meta:meta,index:index};if(core_plugins.notify(me,'beforeDatasetUpdate',[args])===false){return;}
meta.controller.update();core_plugins.notify(me,'afterDatasetUpdate',[args]);},render:function(config){var me=this;if(!config||typeof config!=='object'){config={duration:config,lazy:arguments[1]};}
var animationOptions=me.options.animation;var duration=valueOrDefault$8(config.duration,animationOptions&&animationOptions.duration);var lazy=config.lazy;if(core_plugins.notify(me,'beforeRender')===false){return;}
var onComplete=function(animation){core_plugins.notify(me,'afterRender');helpers$1.callback(animationOptions&&animationOptions.onComplete,[animation],me);};if(animationOptions&&duration){var animation=new core_animation({numSteps:duration/16.66,easing:config.easing||animationOptions.easing,render:function(chart,animationObject){var easingFunction=helpers$1.easing.effects[animationObject.easing];var currentStep=animationObject.currentStep;var stepDecimal=currentStep/animationObject.numSteps;chart.draw(easingFunction(stepDecimal),stepDecimal,currentStep);},onAnimationProgress:animationOptions.onProgress,onAnimationComplete:onComplete});core_animations.addAnimation(me,animation,duration,lazy);}else{me.draw();onComplete(new core_animation({numSteps:0,chart:me}));}
return me;},draw:function(easingValue){var me=this;me.clear();if(helpers$1.isNullOrUndef(easingValue)){easingValue=1;}
me.transition(easingValue);if(me.width<=0||me.height<=0){return;}
if(core_plugins.notify(me,'beforeDraw',[easingValue])===false){return;}
helpers$1.each(me.boxes,function(box){box.draw(me.chartArea);},me);me.drawDatasets(easingValue);me._drawTooltip(easingValue);core_plugins.notify(me,'afterDraw',[easingValue]);},transition:function(easingValue){var me=this;for(var i=0,ilen=(me.data.datasets||[]).length;i<ilen;++i){if(me.isDatasetVisible(i)){me.getDatasetMeta(i).controller.transition(easingValue);}}
me.tooltip.transition(easingValue);},drawDatasets:function(easingValue){var me=this;if(core_plugins.notify(me,'beforeDatasetsDraw',[easingValue])===false){return;}
for(var i=(me.data.datasets||[]).length-1;i>=0;--i){if(me.isDatasetVisible(i)){me.drawDataset(i,easingValue);}}
core_plugins.notify(me,'afterDatasetsDraw',[easingValue]);},drawDataset:function(index,easingValue){var me=this;var meta=me.getDatasetMeta(index);var args={meta:meta,index:index,easingValue:easingValue};if(core_plugins.notify(me,'beforeDatasetDraw',[args])===false){return;}
meta.controller.draw(easingValue);core_plugins.notify(me,'afterDatasetDraw',[args]);},_drawTooltip:function(easingValue){var me=this;var tooltip=me.tooltip;var args={tooltip:tooltip,easingValue:easingValue};if(core_plugins.notify(me,'beforeTooltipDraw',[args])===false){return;}
tooltip.draw();core_plugins.notify(me,'afterTooltipDraw',[args]);},getElementAtEvent:function(e){return core_interaction.modes.single(this,e);},getElementsAtEvent:function(e){return core_interaction.modes.label(this,e,{intersect:true});},getElementsAtXAxis:function(e){return core_interaction.modes['x-axis'](this,e,{intersect:true});},getElementsAtEventForMode:function(e,mode,options){var method=core_interaction.modes[mode];if(typeof method==='function'){return method(this,e,options);}
return[];},getDatasetAtEvent:function(e){return core_interaction.modes.dataset(this,e,{intersect:true});},getDatasetMeta:function(datasetIndex){var me=this;var dataset=me.data.datasets[datasetIndex];if(!dataset._meta){dataset._meta={};}
var meta=dataset._meta[me.id];if(!meta){meta=dataset._meta[me.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null};}
return meta;},getVisibleDatasetCount:function(){var count=0;for(var i=0,ilen=this.data.datasets.length;i<ilen;++i){if(this.isDatasetVisible(i)){count++;}}
return count;},isDatasetVisible:function(datasetIndex){var meta=this.getDatasetMeta(datasetIndex);return typeof meta.hidden==='boolean'?!meta.hidden:!this.data.datasets[datasetIndex].hidden;},generateLegend:function(){return this.options.legendCallback(this);},destroyDatasetMeta:function(datasetIndex){var id=this.id;var dataset=this.data.datasets[datasetIndex];var meta=dataset._meta&&dataset._meta[id];if(meta){meta.controller.destroy();delete dataset._meta[id];}},destroy:function(){var me=this;var canvas=me.canvas;var i,ilen;me.stop();for(i=0,ilen=me.data.datasets.length;i<ilen;++i){me.destroyDatasetMeta(i);}
if(canvas){me.unbindEvents();helpers$1.canvas.clear(me);platform.releaseContext(me.ctx);me.canvas=null;me.ctx=null;}
core_plugins.notify(me,'destroy');delete Chart.instances[me.id];},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments);},initToolTip:function(){var me=this;me.tooltip=new core_tooltip({_chart:me,_chartInstance:me,_data:me.data,_options:me.options.tooltips},me);},bindEvents:function(){var me=this;var listeners=me._listeners={};var listener=function(){me.eventHandler.apply(me,arguments);};helpers$1.each(me.options.events,function(type){platform.addEventListener(me,type,listener);listeners[type]=listener;});if(me.options.responsive){listener=function(){me.resize();};platform.addEventListener(me,'resize',listener);listeners.resize=listener;}},unbindEvents:function(){var me=this;var listeners=me._listeners;if(!listeners){return;}
delete me._listeners;helpers$1.each(listeners,function(listener,type){platform.removeEventListener(me,type,listener);});},updateHoverStyle:function(elements,mode,enabled){var method=enabled?'setHoverStyle':'removeHoverStyle';var element,i,ilen;for(i=0,ilen=elements.length;i<ilen;++i){element=elements[i];if(element){this.getDatasetMeta(element._datasetIndex).controller[method](element);}}},eventHandler:function(e){var me=this;var tooltip=me.tooltip;if(core_plugins.notify(me,'beforeEvent',[e])===false){return;}
me._bufferedRender=true;me._bufferedRequest=null;var changed=me.handleEvent(e);if(tooltip){changed=tooltip._start?tooltip.handleEvent(e):changed|tooltip.handleEvent(e);}
core_plugins.notify(me,'afterEvent',[e]);var bufferedRequest=me._bufferedRequest;if(bufferedRequest){me.render(bufferedRequest);}else if(changed&&!me.animating){me.stop();me.render({duration:me.options.hover.animationDuration,lazy:true});}
me._bufferedRender=false;me._bufferedRequest=null;return me;},handleEvent:function(e){var me=this;var options=me.options||{};var hoverOptions=options.hover;var changed=false;me.lastActive=me.lastActive||[];if(e.type==='mouseout'){me.active=[];}else{me.active=me.getElementsAtEventForMode(e,hoverOptions.mode,hoverOptions);}
helpers$1.callback(options.onHover||options.hover.onHover,[e.native,me.active],me);if(e.type==='mouseup'||e.type==='click'){if(options.onClick){options.onClick.call(me,e.native,me.active);}}
if(me.lastActive.length){me.updateHoverStyle(me.lastActive,hoverOptions.mode,false);}
if(me.active.length&&hoverOptions.mode){me.updateHoverStyle(me.active,hoverOptions.mode,true);}
changed=!helpers$1.arrayEquals(me.active,me.lastActive);me.lastActive=me.active;return changed;}});Chart.instances={};var core_controller=Chart;Chart.Controller=Chart;Chart.types={};helpers$1.configMerge=mergeConfig;helpers$1.scaleMerge=mergeScaleConfig;var core_helpers=function(){helpers$1.where=function(collection,filterCallback){if(helpers$1.isArray(collection)&&Array.prototype.filter){return collection.filter(filterCallback);}
var filtered=[];helpers$1.each(collection,function(item){if(filterCallback(item)){filtered.push(item);}});return filtered;};helpers$1.findIndex=Array.prototype.findIndex?function(array,callback,scope){return array.findIndex(callback,scope);}:function(array,callback,scope){scope=scope===undefined?array:scope;for(var i=0,ilen=array.length;i<ilen;++i){if(callback.call(scope,array[i],i,array)){return i;}}
return-1;};helpers$1.findNextWhere=function(arrayToSearch,filterCallback,startIndex){if(helpers$1.isNullOrUndef(startIndex)){startIndex=-1;}
for(var i=startIndex+1;i<arrayToSearch.length;i++){var currentItem=arrayToSearch[i];if(filterCallback(currentItem)){return currentItem;}}};helpers$1.findPreviousWhere=function(arrayToSearch,filterCallback,startIndex){if(helpers$1.isNullOrUndef(startIndex)){startIndex=arrayToSearch.length;}
for(var i=startIndex-1;i>=0;i--){var currentItem=arrayToSearch[i];if(filterCallback(currentItem)){return currentItem;}}};helpers$1.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n);};helpers$1.almostEquals=function(x,y,epsilon){return Math.abs(x-y)<epsilon;};helpers$1.almostWhole=function(x,epsilon){var rounded=Math.round(x);return(((rounded-epsilon)<x)&&((rounded+epsilon)>x));};helpers$1.max=function(array){return array.reduce(function(max,value){if(!isNaN(value)){return Math.max(max,value);}
return max;},Number.NEGATIVE_INFINITY);};helpers$1.min=function(array){return array.reduce(function(min,value){if(!isNaN(value)){return Math.min(min,value);}
return min;},Number.POSITIVE_INFINITY);};helpers$1.sign=Math.sign?function(x){return Math.sign(x);}:function(x){x=+x;if(x===0||isNaN(x)){return x;}
return x>0?1:-1;};helpers$1.log10=Math.log10?function(x){return Math.log10(x);}:function(x){var exponent=Math.log(x)*Math.LOG10E;var powerOf10=Math.round(exponent);var isPowerOf10=x===Math.pow(10,powerOf10);return isPowerOf10?powerOf10:exponent;};helpers$1.toRadians=function(degrees){return degrees*(Math.PI/180);};helpers$1.toDegrees=function(radians){return radians*(180/Math.PI);};helpers$1._decimalPlaces=function(x){if(!helpers$1.isFinite(x)){return;}
var e=1;var p=0;while(Math.round(x*e)/e!==x){e*=10;p++;}
return p;};helpers$1.getAngleFromPoint=function(centrePoint,anglePoint){var distanceFromXCenter=anglePoint.x-centrePoint.x;var distanceFromYCenter=anglePoint.y-centrePoint.y;var radialDistanceFromCenter=Math.sqrt(distanceFromXCenter*distanceFromXCenter+distanceFromYCenter*distanceFromYCenter);var angle=Math.atan2(distanceFromYCenter,distanceFromXCenter);if(angle<(-0.5*Math.PI)){angle+=2.0*Math.PI;}
return{angle:angle,distance:radialDistanceFromCenter};};helpers$1.distanceBetweenPoints=function(pt1,pt2){return Math.sqrt(Math.pow(pt2.x-pt1.x,2)+Math.pow(pt2.y-pt1.y,2));};helpers$1.aliasPixel=function(pixelWidth){return(pixelWidth%2===0)?0:0.5;};helpers$1._alignPixel=function(chart,pixel,width){var devicePixelRatio=chart.currentDevicePixelRatio;var halfWidth=width/2;return Math.round((pixel-halfWidth)*devicePixelRatio)/devicePixelRatio+halfWidth;};helpers$1.splineCurve=function(firstPoint,middlePoint,afterPoint,t){var previous=firstPoint.skip?middlePoint:firstPoint;var current=middlePoint;var next=afterPoint.skip?middlePoint:afterPoint;var d01=Math.sqrt(Math.pow(current.x-previous.x,2)+Math.pow(current.y-previous.y,2));var d12=Math.sqrt(Math.pow(next.x-current.x,2)+Math.pow(next.y-current.y,2));var s01=d01/(d01+d12);var s12=d12/(d01+d12);s01=isNaN(s01)?0:s01;s12=isNaN(s12)?0:s12;var fa=t*s01;var fb=t*s12;return{previous:{x:current.x-fa*(next.x-previous.x),y:current.y-fa*(next.y-previous.y)},next:{x:current.x+fb*(next.x-previous.x),y:current.y+fb*(next.y-previous.y)}};};helpers$1.EPSILON=Number.EPSILON||1e-14;helpers$1.splineCurveMonotone=function(points){var pointsWithTangents=(points||[]).map(function(point){return{model:point._model,deltaK:0,mK:0};});var pointsLen=pointsWithTangents.length;var i,pointBefore,pointCurrent,pointAfter;for(i=0;i<pointsLen;++i){pointCurrent=pointsWithTangents[i];if(pointCurrent.model.skip){continue;}
pointBefore=i>0?pointsWithTangents[i-1]:null;pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null;if(pointAfter&&!pointAfter.model.skip){var slopeDeltaX=(pointAfter.model.x-pointCurrent.model.x);pointCurrent.deltaK=slopeDeltaX!==0?(pointAfter.model.y-pointCurrent.model.y)/slopeDeltaX:0;}
if(!pointBefore||pointBefore.model.skip){pointCurrent.mK=pointCurrent.deltaK;}else if(!pointAfter||pointAfter.model.skip){pointCurrent.mK=pointBefore.deltaK;}else if(this.sign(pointBefore.deltaK)!==this.sign(pointCurrent.deltaK)){pointCurrent.mK=0;}else{pointCurrent.mK=(pointBefore.deltaK+pointCurrent.deltaK)/2;}}
var alphaK,betaK,tauK,squaredMagnitude;for(i=0;i<pointsLen-1;++i){pointCurrent=pointsWithTangents[i];pointAfter=pointsWithTangents[i+1];if(pointCurrent.model.skip||pointAfter.model.skip){continue;}
if(helpers$1.almostEquals(pointCurrent.deltaK,0,this.EPSILON)){pointCurrent.mK=pointAfter.mK=0;continue;}
alphaK=pointCurrent.mK/pointCurrent.deltaK;betaK=pointAfter.mK/pointCurrent.deltaK;squaredMagnitude=Math.pow(alphaK,2)+Math.pow(betaK,2);if(squaredMagnitude<=9){continue;}
tauK=3/Math.sqrt(squaredMagnitude);pointCurrent.mK=alphaK*tauK*pointCurrent.deltaK;pointAfter.mK=betaK*tauK*pointCurrent.deltaK;}
var deltaX;for(i=0;i<pointsLen;++i){pointCurrent=pointsWithTangents[i];if(pointCurrent.model.skip){continue;}
pointBefore=i>0?pointsWithTangents[i-1]:null;pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null;if(pointBefore&&!pointBefore.model.skip){deltaX=(pointCurrent.model.x-pointBefore.model.x)/3;pointCurrent.model.controlPointPreviousX=pointCurrent.model.x-deltaX;pointCurrent.model.controlPointPreviousY=pointCurrent.model.y-deltaX*pointCurrent.mK;}
if(pointAfter&&!pointAfter.model.skip){deltaX=(pointAfter.model.x-pointCurrent.model.x)/3;pointCurrent.model.controlPointNextX=pointCurrent.model.x+deltaX;pointCurrent.model.controlPointNextY=pointCurrent.model.y+deltaX*pointCurrent.mK;}}};helpers$1.nextItem=function(collection,index,loop){if(loop){return index>=collection.length-1?collection[0]:collection[index+1];}
return index>=collection.length-1?collection[collection.length-1]:collection[index+1];};helpers$1.previousItem=function(collection,index,loop){if(loop){return index<=0?collection[collection.length-1]:collection[index-1];}
return index<=0?collection[0]:collection[index-1];};helpers$1.niceNum=function(range,round){var exponent=Math.floor(helpers$1.log10(range));var fraction=range/Math.pow(10,exponent);var niceFraction;if(round){if(fraction<1.5){niceFraction=1;}else if(fraction<3){niceFraction=2;}else if(fraction<7){niceFraction=5;}else{niceFraction=10;}}else if(fraction<=1.0){niceFraction=1;}else if(fraction<=2){niceFraction=2;}else if(fraction<=5){niceFraction=5;}else{niceFraction=10;}
return niceFraction*Math.pow(10,exponent);};helpers$1.requestAnimFrame=(function(){if(typeof window==='undefined'){return function(callback){callback();};}
return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return window.setTimeout(callback,1000/60);};}());helpers$1.getRelativePosition=function(evt,chart){var mouseX,mouseY;var e=evt.originalEvent||evt;var canvas=evt.target||evt.srcElement;var boundingRect=canvas.getBoundingClientRect();var touches=e.touches;if(touches&&touches.length>0){mouseX=touches[0].clientX;mouseY=touches[0].clientY;}else{mouseX=e.clientX;mouseY=e.clientY;}
var paddingLeft=parseFloat(helpers$1.getStyle(canvas,'padding-left'));var paddingTop=parseFloat(helpers$1.getStyle(canvas,'padding-top'));var paddingRight=parseFloat(helpers$1.getStyle(canvas,'padding-right'));var paddingBottom=parseFloat(helpers$1.getStyle(canvas,'padding-bottom'));var width=boundingRect.right-boundingRect.left-paddingLeft-paddingRight;var height=boundingRect.bottom-boundingRect.top-paddingTop-paddingBottom;mouseX=Math.round((mouseX-boundingRect.left-paddingLeft)/(width)*canvas.width/chart.currentDevicePixelRatio);mouseY=Math.round((mouseY-boundingRect.top-paddingTop)/(height)*canvas.height/chart.currentDevicePixelRatio);return{x:mouseX,y:mouseY};};function parseMaxStyle(styleValue,node,parentProperty){var valueInPixels;if(typeof styleValue==='string'){valueInPixels=parseInt(styleValue,10);if(styleValue.indexOf('%')!==-1){valueInPixels=valueInPixels/100*node.parentNode[parentProperty];}}else{valueInPixels=styleValue;}
return valueInPixels;}
function isConstrainedValue(value){return value!==undefined&&value!==null&&value!=='none';}
function getConstraintDimension(domNode,maxStyle,percentageProperty){var view=document.defaultView;var parentNode=helpers$1._getParentNode(domNode);var constrainedNode=view.getComputedStyle(domNode)[maxStyle];var constrainedContainer=view.getComputedStyle(parentNode)[maxStyle];var hasCNode=isConstrainedValue(constrainedNode);var hasCContainer=isConstrainedValue(constrainedContainer);var infinity=Number.POSITIVE_INFINITY;if(hasCNode||hasCContainer){return Math.min(hasCNode?parseMaxStyle(constrainedNode,domNode,percentageProperty):infinity,hasCContainer?parseMaxStyle(constrainedContainer,parentNode,percentageProperty):infinity);}
return'none';}
helpers$1.getConstraintWidth=function(domNode){return getConstraintDimension(domNode,'max-width','clientWidth');};helpers$1.getConstraintHeight=function(domNode){return getConstraintDimension(domNode,'max-height','clientHeight');};helpers$1._calculatePadding=function(container,padding,parentDimension){padding=helpers$1.getStyle(container,padding);return padding.indexOf('%')>-1?parentDimension*parseInt(padding,10)/100:parseInt(padding,10);};helpers$1._getParentNode=function(domNode){var parent=domNode.parentNode;if(parent&&parent.toString()==='[object ShadowRoot]'){parent=parent.host;}
return parent;};helpers$1.getMaximumWidth=function(domNode){var container=helpers$1._getParentNode(domNode);if(!container){return domNode.clientWidth;}
var clientWidth=container.clientWidth;var paddingLeft=helpers$1._calculatePadding(container,'padding-left',clientWidth);var paddingRight=helpers$1._calculatePadding(container,'padding-right',clientWidth);var w=clientWidth-paddingLeft-paddingRight;var cw=helpers$1.getConstraintWidth(domNode);return isNaN(cw)?w:Math.min(w,cw);};helpers$1.getMaximumHeight=function(domNode){var container=helpers$1._getParentNode(domNode);if(!container){return domNode.clientHeight;}
var clientHeight=container.clientHeight;var paddingTop=helpers$1._calculatePadding(container,'padding-top',clientHeight);var paddingBottom=helpers$1._calculatePadding(container,'padding-bottom',clientHeight);var h=clientHeight-paddingTop-paddingBottom;var ch=helpers$1.getConstraintHeight(domNode);return isNaN(ch)?h:Math.min(h,ch);};helpers$1.getStyle=function(el,property){return el.currentStyle?el.currentStyle[property]:document.defaultView.getComputedStyle(el,null).getPropertyValue(property);};helpers$1.retinaScale=function(chart,forceRatio){var pixelRatio=chart.currentDevicePixelRatio=forceRatio||(typeof window!=='undefined'&&window.devicePixelRatio)||1;if(pixelRatio===1){return;}
var canvas=chart.canvas;var height=chart.height;var width=chart.width;canvas.height=height*pixelRatio;canvas.width=width*pixelRatio;chart.ctx.scale(pixelRatio,pixelRatio);if(!canvas.style.height&&!canvas.style.width){canvas.style.height=height+'px';canvas.style.width=width+'px';}};helpers$1.fontString=function(pixelSize,fontStyle,fontFamily){return fontStyle+' '+pixelSize+'px '+fontFamily;};helpers$1.longestText=function(ctx,font,arrayOfThings,cache){cache=cache||{};var data=cache.data=cache.data||{};var gc=cache.garbageCollect=cache.garbageCollect||[];if(cache.font!==font){data=cache.data={};gc=cache.garbageCollect=[];cache.font=font;}
ctx.font=font;var longest=0;helpers$1.each(arrayOfThings,function(thing){if(thing!==undefined&&thing!==null&&helpers$1.isArray(thing)!==true){longest=helpers$1.measureText(ctx,data,gc,longest,thing);}else if(helpers$1.isArray(thing)){helpers$1.each(thing,function(nestedThing){if(nestedThing!==undefined&&nestedThing!==null&&!helpers$1.isArray(nestedThing)){longest=helpers$1.measureText(ctx,data,gc,longest,nestedThing);}});}});var gcLen=gc.length/2;if(gcLen>arrayOfThings.length){for(var i=0;i<gcLen;i++){delete data[gc[i]];}
gc.splice(0,gcLen);}
return longest;};helpers$1.measureText=function(ctx,data,gc,longest,string){var textWidth=data[string];if(!textWidth){textWidth=data[string]=ctx.measureText(string).width;gc.push(string);}
if(textWidth>longest){longest=textWidth;}
return longest;};helpers$1.numberOfLabelLines=function(arrayOfThings){var numberOfLines=1;helpers$1.each(arrayOfThings,function(thing){if(helpers$1.isArray(thing)){if(thing.length>numberOfLines){numberOfLines=thing.length;}}});return numberOfLines;};helpers$1.color=!chartjsColor?function(value){console.error('Color.js not found!');return value;}:function(value){if(value instanceof CanvasGradient){value=core_defaults.global.defaultColor;}
return chartjsColor(value);};helpers$1.getHoverColor=function(colorValue){return(colorValue instanceof CanvasPattern||colorValue instanceof CanvasGradient)?colorValue:helpers$1.color(colorValue).saturate(0.5).darken(0.1).rgbString();};};function abstract(){throw new Error('This method is not implemented: either no adapter can '+'be found or an incomplete integration was provided.');}
function DateAdapter(options){this.options=options||{};}
helpers$1.extend(DateAdapter.prototype,{formats:abstract,parse:abstract,format:abstract,add:abstract,diff:abstract,startOf:abstract,endOf:abstract,_create:function(value){return value;}});DateAdapter.override=function(members){helpers$1.extend(DateAdapter.prototype,members);};var _date=DateAdapter;var core_adapters={_date:_date};var core_ticks={formatters:{values:function(value){return helpers$1.isArray(value)?value:''+value;},linear:function(tickValue,index,ticks){var delta=ticks.length>3?ticks[2]-ticks[1]:ticks[1]-ticks[0];if(Math.abs(delta)>1){if(tickValue!==Math.floor(tickValue)){delta=tickValue-Math.floor(tickValue);}}
var logDelta=helpers$1.log10(Math.abs(delta));var tickString='';if(tickValue!==0){var maxTick=Math.max(Math.abs(ticks[0]),Math.abs(ticks[ticks.length-1]));if(maxTick<1e-4){var logTick=helpers$1.log10(Math.abs(tickValue));tickString=tickValue.toExponential(Math.floor(logTick)-Math.floor(logDelta));}else{var numDecimal=-1*Math.floor(logDelta);numDecimal=Math.max(Math.min(numDecimal,20),0);tickString=tickValue.toFixed(numDecimal);}}else{tickString='0';}
return tickString;},logarithmic:function(tickValue,index,ticks){var remain=tickValue/(Math.pow(10,Math.floor(helpers$1.log10(tickValue))));if(tickValue===0){return'0';}else if(remain===1||remain===2||remain===5||index===0||index===ticks.length-1){return tickValue.toExponential();}
return'';}}};var valueOrDefault$9=helpers$1.valueOrDefault;var valueAtIndexOrDefault=helpers$1.valueAtIndexOrDefault;core_defaults._set('scale',{display:true,position:'left',offset:false,gridLines:{display:true,color:'rgba(0, 0, 0, 0.1)',lineWidth:1,drawBorder:true,drawOnChartArea:true,drawTicks:true,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:'rgba(0,0,0,0.25)',zeroLineBorderDash:[],zeroLineBorderDashOffset:0.0,offsetGridLines:false,borderDash:[],borderDashOffset:0.0},scaleLabel:{display:false,labelString:'',padding:{top:4,bottom:4}},ticks:{beginAtZero:false,minRotation:0,maxRotation:50,mirror:false,padding:0,reverse:false,display:true,autoSkip:true,autoSkipPadding:0,labelOffset:0,callback:core_ticks.formatters.values,minor:{},major:{}}});function labelsFromTicks(ticks){var labels=[];var i,ilen;for(i=0,ilen=ticks.length;i<ilen;++i){labels.push(ticks[i].label);}
return labels;}
function getPixelForGridLine(scale,index,offsetGridLines){var lineValue=scale.getPixelForTick(index);if(offsetGridLines){if(scale.getTicks().length===1){lineValue-=scale.isHorizontal()?Math.max(lineValue-scale.left,scale.right-lineValue):Math.max(lineValue-scale.top,scale.bottom-lineValue);}else if(index===0){lineValue-=(scale.getPixelForTick(1)-lineValue)/2;}else{lineValue-=(lineValue-scale.getPixelForTick(index-1))/2;}}
return lineValue;}
function computeTextSize(context,tick,font){return helpers$1.isArray(tick)?helpers$1.longestText(context,font,tick):context.measureText(tick).width;}
var core_scale=core_element.extend({getPadding:function(){var me=this;return{left:me.paddingLeft||0,top:me.paddingTop||0,right:me.paddingRight||0,bottom:me.paddingBottom||0};},getTicks:function(){return this._ticks;},mergeTicksOptions:function(){var ticks=this.options.ticks;if(ticks.minor===false){ticks.minor={display:false};}
if(ticks.major===false){ticks.major={display:false};}
for(var key in ticks){if(key!=='major'&&key!=='minor'){if(typeof ticks.minor[key]==='undefined'){ticks.minor[key]=ticks[key];}
if(typeof ticks.major[key]==='undefined'){ticks.major[key]=ticks[key];}}}},beforeUpdate:function(){helpers$1.callback(this.options.beforeUpdate,[this]);},update:function(maxWidth,maxHeight,margins){var me=this;var i,ilen,labels,label,ticks,tick;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=helpers$1.extend({left:0,right:0,top:0,bottom:0},margins);me._maxLabelLines=0;me.longestLabelWidth=0;me.longestTextCache=me.longestTextCache||{};me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeDataLimits();me.determineDataLimits();me.afterDataLimits();me.beforeBuildTicks();ticks=me.buildTicks()||[];ticks=me.afterBuildTicks(ticks)||ticks;me.beforeTickToLabelConversion();labels=me.convertTicksToLabels(ticks)||me.ticks;me.afterTickToLabelConversion();me.ticks=labels;for(i=0,ilen=labels.length;i<ilen;++i){label=labels[i];tick=ticks[i];if(!tick){ticks.push(tick={label:label,major:false});}else{tick.label=label;}}
me._ticks=ticks;me.beforeCalculateTickRotation();me.calculateTickRotation();me.afterCalculateTickRotation();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize;},afterUpdate:function(){helpers$1.callback(this.options.afterUpdate,[this]);},beforeSetDimensions:function(){helpers$1.callback(this.options.beforeSetDimensions,[this]);},setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width;}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height;}
me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;},afterSetDimensions:function(){helpers$1.callback(this.options.afterSetDimensions,[this]);},beforeDataLimits:function(){helpers$1.callback(this.options.beforeDataLimits,[this]);},determineDataLimits:helpers$1.noop,afterDataLimits:function(){helpers$1.callback(this.options.afterDataLimits,[this]);},beforeBuildTicks:function(){helpers$1.callback(this.options.beforeBuildTicks,[this]);},buildTicks:helpers$1.noop,afterBuildTicks:function(ticks){var me=this;if(helpers$1.isArray(ticks)&&ticks.length){return helpers$1.callback(me.options.afterBuildTicks,[me,ticks]);}
me.ticks=helpers$1.callback(me.options.afterBuildTicks,[me,me.ticks])||me.ticks;return ticks;},beforeTickToLabelConversion:function(){helpers$1.callback(this.options.beforeTickToLabelConversion,[this]);},convertTicksToLabels:function(){var me=this;var tickOpts=me.options.ticks;me.ticks=me.ticks.map(tickOpts.userCallback||tickOpts.callback,this);},afterTickToLabelConversion:function(){helpers$1.callback(this.options.afterTickToLabelConversion,[this]);},beforeCalculateTickRotation:function(){helpers$1.callback(this.options.beforeCalculateTickRotation,[this]);},calculateTickRotation:function(){var me=this;var context=me.ctx;var tickOpts=me.options.ticks;var labels=labelsFromTicks(me._ticks);var tickFont=helpers$1.options._parseFont(tickOpts);context.font=tickFont.string;var labelRotation=tickOpts.minRotation||0;if(labels.length&&me.options.display&&me.isHorizontal()){var originalLabelWidth=helpers$1.longestText(context,tickFont.string,labels,me.longestTextCache);var labelWidth=originalLabelWidth;var cosRotation,sinRotation;var tickWidth=me.getPixelForTick(1)-me.getPixelForTick(0)-6;while(labelWidth>tickWidth&&labelRotation<tickOpts.maxRotation){var angleRadians=helpers$1.toRadians(labelRotation);cosRotation=Math.cos(angleRadians);sinRotation=Math.sin(angleRadians);if(sinRotation*originalLabelWidth>me.maxHeight){labelRotation--;break;}
labelRotation++;labelWidth=cosRotation*originalLabelWidth;}}
me.labelRotation=labelRotation;},afterCalculateTickRotation:function(){helpers$1.callback(this.options.afterCalculateTickRotation,[this]);},beforeFit:function(){helpers$1.callback(this.options.beforeFit,[this]);},fit:function(){var me=this;var minSize=me.minSize={width:0,height:0};var labels=labelsFromTicks(me._ticks);var opts=me.options;var tickOpts=opts.ticks;var scaleLabelOpts=opts.scaleLabel;var gridLineOpts=opts.gridLines;var display=me._isVisible();var position=opts.position;var isHorizontal=me.isHorizontal();var parseFont=helpers$1.options._parseFont;var tickFont=parseFont(tickOpts);var tickMarkLength=opts.gridLines.tickMarkLength;if(isHorizontal){minSize.width=me.isFullWidth()?me.maxWidth-me.margins.left-me.margins.right:me.maxWidth;}else{minSize.width=display&&gridLineOpts.drawTicks?tickMarkLength:0;}
if(isHorizontal){minSize.height=display&&gridLineOpts.drawTicks?tickMarkLength:0;}else{minSize.height=me.maxHeight;}
if(scaleLabelOpts.display&&display){var scaleLabelFont=parseFont(scaleLabelOpts);var scaleLabelPadding=helpers$1.options.toPadding(scaleLabelOpts.padding);var deltaHeight=scaleLabelFont.lineHeight+scaleLabelPadding.height;if(isHorizontal){minSize.height+=deltaHeight;}else{minSize.width+=deltaHeight;}}
if(tickOpts.display&&display){var largestTextWidth=helpers$1.longestText(me.ctx,tickFont.string,labels,me.longestTextCache);var tallestLabelHeightInLines=helpers$1.numberOfLabelLines(labels);var lineSpace=tickFont.size*0.5;var tickPadding=me.options.ticks.padding;me._maxLabelLines=tallestLabelHeightInLines;me.longestLabelWidth=largestTextWidth;if(isHorizontal){var angleRadians=helpers$1.toRadians(me.labelRotation);var cosRotation=Math.cos(angleRadians);var sinRotation=Math.sin(angleRadians);var labelHeight=(sinRotation*largestTextWidth)
+(tickFont.lineHeight*tallestLabelHeightInLines)
+lineSpace;minSize.height=Math.min(me.maxHeight,minSize.height+labelHeight+tickPadding);me.ctx.font=tickFont.string;var firstLabelWidth=computeTextSize(me.ctx,labels[0],tickFont.string);var lastLabelWidth=computeTextSize(me.ctx,labels[labels.length-1],tickFont.string);var offsetLeft=me.getPixelForTick(0)-me.left;var offsetRight=me.right-me.getPixelForTick(labels.length-1);var paddingLeft,paddingRight;if(me.labelRotation!==0){paddingLeft=position==='bottom'?(cosRotation*firstLabelWidth):(cosRotation*lineSpace);paddingRight=position==='bottom'?(cosRotation*lineSpace):(cosRotation*lastLabelWidth);}else{paddingLeft=firstLabelWidth/2;paddingRight=lastLabelWidth/2;}
me.paddingLeft=Math.max(paddingLeft-offsetLeft,0)+3;me.paddingRight=Math.max(paddingRight-offsetRight,0)+3;}else{if(tickOpts.mirror){largestTextWidth=0;}else{largestTextWidth+=tickPadding+lineSpace;}
minSize.width=Math.min(me.maxWidth,minSize.width+largestTextWidth);me.paddingTop=tickFont.size/2;me.paddingBottom=tickFont.size/2;}}
me.handleMargins();me.width=minSize.width;me.height=minSize.height;},handleMargins:function(){var me=this;if(me.margins){me.paddingLeft=Math.max(me.paddingLeft-me.margins.left,0);me.paddingTop=Math.max(me.paddingTop-me.margins.top,0);me.paddingRight=Math.max(me.paddingRight-me.margins.right,0);me.paddingBottom=Math.max(me.paddingBottom-me.margins.bottom,0);}},afterFit:function(){helpers$1.callback(this.options.afterFit,[this]);},isHorizontal:function(){return this.options.position==='top'||this.options.position==='bottom';},isFullWidth:function(){return(this.options.fullWidth);},getRightValue:function(rawValue){if(helpers$1.isNullOrUndef(rawValue)){return NaN;}
if((typeof rawValue==='number'||rawValue instanceof Number)&&!isFinite(rawValue)){return NaN;}
if(rawValue){if(this.isHorizontal()){if(rawValue.x!==undefined){return this.getRightValue(rawValue.x);}}else if(rawValue.y!==undefined){return this.getRightValue(rawValue.y);}}
return rawValue;},getLabelForIndex:helpers$1.noop,getPixelForValue:helpers$1.noop,getValueForPixel:helpers$1.noop,getPixelForTick:function(index){var me=this;var offset=me.options.offset;if(me.isHorizontal()){var innerWidth=me.width-(me.paddingLeft+me.paddingRight);var tickWidth=innerWidth/Math.max((me._ticks.length-(offset?0:1)),1);var pixel=(tickWidth*index)+me.paddingLeft;if(offset){pixel+=tickWidth/2;}
var finalVal=me.left+pixel;finalVal+=me.isFullWidth()?me.margins.left:0;return finalVal;}
var innerHeight=me.height-(me.paddingTop+me.paddingBottom);return me.top+(index*(innerHeight/(me._ticks.length-1)));},getPixelForDecimal:function(decimal){var me=this;if(me.isHorizontal()){var innerWidth=me.width-(me.paddingLeft+me.paddingRight);var valueOffset=(innerWidth*decimal)+me.paddingLeft;var finalVal=me.left+valueOffset;finalVal+=me.isFullWidth()?me.margins.left:0;return finalVal;}
return me.top+(decimal*me.height);},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue());},getBaseValue:function(){var me=this;var min=me.min;var max=me.max;return me.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0;},_autoSkip:function(ticks){var me=this;var isHorizontal=me.isHorizontal();var optionTicks=me.options.ticks.minor;var tickCount=ticks.length;var skipRatio=false;var maxTicks=optionTicks.maxTicksLimit;var ticksLength=me._tickSize()*(tickCount-1);var axisLength=isHorizontal?me.width-(me.paddingLeft+me.paddingRight):me.height-(me.paddingTop+me.PaddingBottom);var result=[];var i,tick;if(ticksLength>axisLength){skipRatio=1+Math.floor(ticksLength/axisLength);}
if(tickCount>maxTicks){skipRatio=Math.max(skipRatio,1+Math.floor(tickCount/maxTicks));}
for(i=0;i<tickCount;i++){tick=ticks[i];if(skipRatio>1&&i%skipRatio>0){delete tick.label;}
result.push(tick);}
return result;},_tickSize:function(){var me=this;var isHorizontal=me.isHorizontal();var optionTicks=me.options.ticks.minor;var rot=helpers$1.toRadians(me.labelRotation);var cos=Math.abs(Math.cos(rot));var sin=Math.abs(Math.sin(rot));var padding=optionTicks.autoSkipPadding||0;var w=(me.longestLabelWidth+padding)||0;var tickFont=helpers$1.options._parseFont(optionTicks);var h=(me._maxLabelLines*tickFont.lineHeight+padding)||0;return isHorizontal?h*cos>w*sin?w/cos:h/sin:h*sin<w*cos?h/cos:w/sin;},_isVisible:function(){var me=this;var chart=me.chart;var display=me.options.display;var i,ilen,meta;if(display!=='auto'){return!!display;}
for(i=0,ilen=chart.data.datasets.length;i<ilen;++i){if(chart.isDatasetVisible(i)){meta=chart.getDatasetMeta(i);if(meta.xAxisID===me.id||meta.yAxisID===me.id){return true;}}}
return false;},draw:function(chartArea){var me=this;var options=me.options;if(!me._isVisible()){return;}
var chart=me.chart;var context=me.ctx;var globalDefaults=core_defaults.global;var defaultFontColor=globalDefaults.defaultFontColor;var optionTicks=options.ticks.minor;var optionMajorTicks=options.ticks.major||optionTicks;var gridLines=options.gridLines;var scaleLabel=options.scaleLabel;var position=options.position;var isRotated=me.labelRotation!==0;var isMirrored=optionTicks.mirror;var isHorizontal=me.isHorizontal();var parseFont=helpers$1.options._parseFont;var ticks=optionTicks.display&&optionTicks.autoSkip?me._autoSkip(me.getTicks()):me.getTicks();var tickFontColor=valueOrDefault$9(optionTicks.fontColor,defaultFontColor);var tickFont=parseFont(optionTicks);var lineHeight=tickFont.lineHeight;var majorTickFontColor=valueOrDefault$9(optionMajorTicks.fontColor,defaultFontColor);var majorTickFont=parseFont(optionMajorTicks);var tickPadding=optionTicks.padding;var labelOffset=optionTicks.labelOffset;var tl=gridLines.drawTicks?gridLines.tickMarkLength:0;var scaleLabelFontColor=valueOrDefault$9(scaleLabel.fontColor,defaultFontColor);var scaleLabelFont=parseFont(scaleLabel);var scaleLabelPadding=helpers$1.options.toPadding(scaleLabel.padding);var labelRotationRadians=helpers$1.toRadians(me.labelRotation);var itemsToDraw=[];var axisWidth=gridLines.drawBorder?valueAtIndexOrDefault(gridLines.lineWidth,0,0):0;var alignPixel=helpers$1._alignPixel;var borderValue,tickStart,tickEnd;if(position==='top'){borderValue=alignPixel(chart,me.bottom,axisWidth);tickStart=me.bottom-tl;tickEnd=borderValue-axisWidth/2;}else if(position==='bottom'){borderValue=alignPixel(chart,me.top,axisWidth);tickStart=borderValue+axisWidth/2;tickEnd=me.top+tl;}else if(position==='left'){borderValue=alignPixel(chart,me.right,axisWidth);tickStart=me.right-tl;tickEnd=borderValue-axisWidth/2;}else{borderValue=alignPixel(chart,me.left,axisWidth);tickStart=borderValue+axisWidth/2;tickEnd=me.left+tl;}
var epsilon=0.0000001;helpers$1.each(ticks,function(tick,index){if(helpers$1.isNullOrUndef(tick.label)){return;}
var label=tick.label;var lineWidth,lineColor,borderDash,borderDashOffset;if(index===me.zeroLineIndex&&options.offset===gridLines.offsetGridLines){lineWidth=gridLines.zeroLineWidth;lineColor=gridLines.zeroLineColor;borderDash=gridLines.zeroLineBorderDash||[];borderDashOffset=gridLines.zeroLineBorderDashOffset||0.0;}else{lineWidth=valueAtIndexOrDefault(gridLines.lineWidth,index);lineColor=valueAtIndexOrDefault(gridLines.color,index);borderDash=gridLines.borderDash||[];borderDashOffset=gridLines.borderDashOffset||0.0;}
var tx1,ty1,tx2,ty2,x1,y1,x2,y2,labelX,labelY,textOffset,textAlign;var labelCount=helpers$1.isArray(label)?label.length:1;var lineValue=getPixelForGridLine(me,index,gridLines.offsetGridLines);if(isHorizontal){var labelYOffset=tl+tickPadding;if(lineValue<me.left-epsilon){lineColor='rgba(0,0,0,0)';}
tx1=tx2=x1=x2=alignPixel(chart,lineValue,lineWidth);ty1=tickStart;ty2=tickEnd;labelX=me.getPixelForTick(index)+labelOffset;if(position==='top'){y1=alignPixel(chart,chartArea.top,axisWidth)+axisWidth/2;y2=chartArea.bottom;textOffset=((!isRotated?0.5:1)-labelCount)*lineHeight;textAlign=!isRotated?'center':'left';labelY=me.bottom-labelYOffset;}else{y1=chartArea.top;y2=alignPixel(chart,chartArea.bottom,axisWidth)-axisWidth/2;textOffset=(!isRotated?0.5:0)*lineHeight;textAlign=!isRotated?'center':'right';labelY=me.top+labelYOffset;}}else{var labelXOffset=(isMirrored?0:tl)+tickPadding;if(lineValue<me.top-epsilon){lineColor='rgba(0,0,0,0)';}
tx1=tickStart;tx2=tickEnd;ty1=ty2=y1=y2=alignPixel(chart,lineValue,lineWidth);labelY=me.getPixelForTick(index)+labelOffset;textOffset=(1-labelCount)*lineHeight/2;if(position==='left'){x1=alignPixel(chart,chartArea.left,axisWidth)+axisWidth/2;x2=chartArea.right;textAlign=isMirrored?'left':'right';labelX=me.right-labelXOffset;}else{x1=chartArea.left;x2=alignPixel(chart,chartArea.right,axisWidth)-axisWidth/2;textAlign=isMirrored?'right':'left';labelX=me.left+labelXOffset;}}
itemsToDraw.push({tx1:tx1,ty1:ty1,tx2:tx2,ty2:ty2,x1:x1,y1:y1,x2:x2,y2:y2,labelX:labelX,labelY:labelY,glWidth:lineWidth,glColor:lineColor,glBorderDash:borderDash,glBorderDashOffset:borderDashOffset,rotation:-1*labelRotationRadians,label:label,major:tick.major,textOffset:textOffset,textAlign:textAlign});});helpers$1.each(itemsToDraw,function(itemToDraw){var glWidth=itemToDraw.glWidth;var glColor=itemToDraw.glColor;if(gridLines.display&&glWidth&&glColor){context.save();context.lineWidth=glWidth;context.strokeStyle=glColor;if(context.setLineDash){context.setLineDash(itemToDraw.glBorderDash);context.lineDashOffset=itemToDraw.glBorderDashOffset;}
context.beginPath();if(gridLines.drawTicks){context.moveTo(itemToDraw.tx1,itemToDraw.ty1);context.lineTo(itemToDraw.tx2,itemToDraw.ty2);}
if(gridLines.drawOnChartArea){context.moveTo(itemToDraw.x1,itemToDraw.y1);context.lineTo(itemToDraw.x2,itemToDraw.y2);}
context.stroke();context.restore();}
if(optionTicks.display){context.save();context.translate(itemToDraw.labelX,itemToDraw.labelY);context.rotate(itemToDraw.rotation);context.font=itemToDraw.major?majorTickFont.string:tickFont.string;context.fillStyle=itemToDraw.major?majorTickFontColor:tickFontColor;context.textBaseline='middle';context.textAlign=itemToDraw.textAlign;var label=itemToDraw.label;var y=itemToDraw.textOffset;if(helpers$1.isArray(label)){for(var i=0;i<label.length;++i){context.fillText(''+label[i],0,y);y+=lineHeight;}}else{context.fillText(label,0,y);}
context.restore();}});if(scaleLabel.display){var scaleLabelX;var scaleLabelY;var rotation=0;var halfLineHeight=scaleLabelFont.lineHeight/2;if(isHorizontal){scaleLabelX=me.left+((me.right-me.left)/2);scaleLabelY=position==='bottom'?me.bottom-halfLineHeight-scaleLabelPadding.bottom:me.top+halfLineHeight+scaleLabelPadding.top;}else{var isLeft=position==='left';scaleLabelX=isLeft?me.left+halfLineHeight+scaleLabelPadding.top:me.right-halfLineHeight-scaleLabelPadding.top;scaleLabelY=me.top+((me.bottom-me.top)/2);rotation=isLeft?-0.5*Math.PI:0.5*Math.PI;}
context.save();context.translate(scaleLabelX,scaleLabelY);context.rotate(rotation);context.textAlign='center';context.textBaseline='middle';context.fillStyle=scaleLabelFontColor;context.font=scaleLabelFont.string;context.fillText(scaleLabel.labelString,0,0);context.restore();}
if(axisWidth){var firstLineWidth=axisWidth;var lastLineWidth=valueAtIndexOrDefault(gridLines.lineWidth,ticks.length-1,0);var x1,x2,y1,y2;if(isHorizontal){x1=alignPixel(chart,me.left,firstLineWidth)-firstLineWidth/2;x2=alignPixel(chart,me.right,lastLineWidth)+lastLineWidth/2;y1=y2=borderValue;}else{y1=alignPixel(chart,me.top,firstLineWidth)-firstLineWidth/2;y2=alignPixel(chart,me.bottom,lastLineWidth)+lastLineWidth/2;x1=x2=borderValue;}
context.lineWidth=axisWidth;context.strokeStyle=valueAtIndexOrDefault(gridLines.color,0);context.beginPath();context.moveTo(x1,y1);context.lineTo(x2,y2);context.stroke();}}});var defaultConfig={position:'bottom'};var scale_category=core_scale.extend({getLabels:function(){var data=this.chart.data;return this.options.labels||(this.isHorizontal()?data.xLabels:data.yLabels)||data.labels;},determineDataLimits:function(){var me=this;var labels=me.getLabels();me.minIndex=0;me.maxIndex=labels.length-1;var findIndex;if(me.options.ticks.min!==undefined){findIndex=labels.indexOf(me.options.ticks.min);me.minIndex=findIndex!==-1?findIndex:me.minIndex;}
if(me.options.ticks.max!==undefined){findIndex=labels.indexOf(me.options.ticks.max);me.maxIndex=findIndex!==-1?findIndex:me.maxIndex;}
me.min=labels[me.minIndex];me.max=labels[me.maxIndex];},buildTicks:function(){var me=this;var labels=me.getLabels();me.ticks=(me.minIndex===0&&me.maxIndex===labels.length-1)?labels:labels.slice(me.minIndex,me.maxIndex+1);},getLabelForIndex:function(index,datasetIndex){var me=this;var chart=me.chart;if(chart.getDatasetMeta(datasetIndex).controller._getValueScaleId()===me.id){return me.getRightValue(chart.data.datasets[datasetIndex].data[index]);}
return me.ticks[index-me.minIndex];},getPixelForValue:function(value,index){var me=this;var offset=me.options.offset;var offsetAmt=Math.max((me.maxIndex+1-me.minIndex-(offset?0:1)),1);var valueCategory;if(value!==undefined&&value!==null){valueCategory=me.isHorizontal()?value.x:value.y;}
if(valueCategory!==undefined||(value!==undefined&&isNaN(index))){var labels=me.getLabels();value=valueCategory||value;var idx=labels.indexOf(value);index=idx!==-1?idx:index;}
if(me.isHorizontal()){var valueWidth=me.width/offsetAmt;var widthOffset=(valueWidth*(index-me.minIndex));if(offset){widthOffset+=(valueWidth/2);}
return me.left+widthOffset;}
var valueHeight=me.height/offsetAmt;var heightOffset=(valueHeight*(index-me.minIndex));if(offset){heightOffset+=(valueHeight/2);}
return me.top+heightOffset;},getPixelForTick:function(index){return this.getPixelForValue(this.ticks[index],index+this.minIndex,null);},getValueForPixel:function(pixel){var me=this;var offset=me.options.offset;var value;var offsetAmt=Math.max((me._ticks.length-(offset?0:1)),1);var horz=me.isHorizontal();var valueDimension=(horz?me.width:me.height)/offsetAmt;pixel-=horz?me.left:me.top;if(offset){pixel-=(valueDimension/2);}
if(pixel<=0){value=0;}else{value=Math.round(pixel/valueDimension);}
return value+me.minIndex;},getBasePixel:function(){return this.bottom;}});var _defaults=defaultConfig;scale_category._defaults=_defaults;var noop=helpers$1.noop;var isNullOrUndef=helpers$1.isNullOrUndef;function generateTicks(generationOptions,dataRange){var ticks=[];var MIN_SPACING=1e-14;var stepSize=generationOptions.stepSize;var unit=stepSize||1;var maxNumSpaces=generationOptions.maxTicks-1;var min=generationOptions.min;var max=generationOptions.max;var precision=generationOptions.precision;var rmin=dataRange.min;var rmax=dataRange.max;var spacing=helpers$1.niceNum((rmax-rmin)/maxNumSpaces/unit)*unit;var factor,niceMin,niceMax,numSpaces;if(spacing<MIN_SPACING&&isNullOrUndef(min)&&isNullOrUndef(max)){return[rmin,rmax];}
numSpaces=Math.ceil(rmax/spacing)-Math.floor(rmin/spacing);if(numSpaces>maxNumSpaces){spacing=helpers$1.niceNum(numSpaces*spacing/maxNumSpaces/unit)*unit;}
if(stepSize||isNullOrUndef(precision)){factor=Math.pow(10,helpers$1._decimalPlaces(spacing));}else{factor=Math.pow(10,precision);spacing=Math.ceil(spacing*factor)/factor;}
niceMin=Math.floor(rmin/spacing)*spacing;niceMax=Math.ceil(rmax/spacing)*spacing;if(stepSize){if(!isNullOrUndef(min)&&helpers$1.almostWhole(min/spacing,spacing/1000)){niceMin=min;}
if(!isNullOrUndef(max)&&helpers$1.almostWhole(max/spacing,spacing/1000)){niceMax=max;}}
numSpaces=(niceMax-niceMin)/spacing;if(helpers$1.almostEquals(numSpaces,Math.round(numSpaces),spacing/1000)){numSpaces=Math.round(numSpaces);}else{numSpaces=Math.ceil(numSpaces);}
niceMin=Math.round(niceMin*factor)/factor;niceMax=Math.round(niceMax*factor)/factor;ticks.push(isNullOrUndef(min)?niceMin:min);for(var j=1;j<numSpaces;++j){ticks.push(Math.round((niceMin+j*spacing)*factor)/factor);}
ticks.push(isNullOrUndef(max)?niceMax:max);return ticks;}
var scale_linearbase=core_scale.extend({getRightValue:function(value){if(typeof value==='string'){return+value;}
return core_scale.prototype.getRightValue.call(this,value);},handleTickRangeOptions:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;if(tickOpts.beginAtZero){var minSign=helpers$1.sign(me.min);var maxSign=helpers$1.sign(me.max);if(minSign<0&&maxSign<0){me.max=0;}else if(minSign>0&&maxSign>0){me.min=0;}}
var setMin=tickOpts.min!==undefined||tickOpts.suggestedMin!==undefined;var setMax=tickOpts.max!==undefined||tickOpts.suggestedMax!==undefined;if(tickOpts.min!==undefined){me.min=tickOpts.min;}else if(tickOpts.suggestedMin!==undefined){if(me.min===null){me.min=tickOpts.suggestedMin;}else{me.min=Math.min(me.min,tickOpts.suggestedMin);}}
if(tickOpts.max!==undefined){me.max=tickOpts.max;}else if(tickOpts.suggestedMax!==undefined){if(me.max===null){me.max=tickOpts.suggestedMax;}else{me.max=Math.max(me.max,tickOpts.suggestedMax);}}
if(setMin!==setMax){if(me.min>=me.max){if(setMin){me.max=me.min+1;}else{me.min=me.max-1;}}}
if(me.min===me.max){me.max++;if(!tickOpts.beginAtZero){me.min--;}}},getTickLimit:function(){var me=this;var tickOpts=me.options.ticks;var stepSize=tickOpts.stepSize;var maxTicksLimit=tickOpts.maxTicksLimit;var maxTicks;if(stepSize){maxTicks=Math.ceil(me.max/stepSize)-Math.floor(me.min/stepSize)+1;}else{maxTicks=me._computeTickLimit();maxTicksLimit=maxTicksLimit||11;}
if(maxTicksLimit){maxTicks=Math.min(maxTicksLimit,maxTicks);}
return maxTicks;},_computeTickLimit:function(){return Number.POSITIVE_INFINITY;},handleDirectionalChanges:noop,buildTicks:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;var maxTicks=me.getTickLimit();maxTicks=Math.max(2,maxTicks);var numericGeneratorOptions={maxTicks:maxTicks,min:tickOpts.min,max:tickOpts.max,precision:tickOpts.precision,stepSize:helpers$1.valueOrDefault(tickOpts.fixedStepSize,tickOpts.stepSize)};var ticks=me.ticks=generateTicks(numericGeneratorOptions,me);me.handleDirectionalChanges();me.max=helpers$1.max(ticks);me.min=helpers$1.min(ticks);if(tickOpts.reverse){ticks.reverse();me.start=me.max;me.end=me.min;}else{me.start=me.min;me.end=me.max;}},convertTicksToLabels:function(){var me=this;me.ticksAsNumbers=me.ticks.slice();me.zeroLineIndex=me.ticks.indexOf(0);core_scale.prototype.convertTicksToLabels.call(me);}});var defaultConfig$1={position:'left',ticks:{callback:core_ticks.formatters.linear}};var scale_linear=scale_linearbase.extend({determineDataLimits:function(){var me=this;var opts=me.options;var chart=me.chart;var data=chart.data;var datasets=data.datasets;var isHorizontal=me.isHorizontal();var DEFAULT_MIN=0;var DEFAULT_MAX=1;function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id;}
me.min=null;me.max=null;var hasStacks=opts.stacked;if(hasStacks===undefined){helpers$1.each(datasets,function(dataset,datasetIndex){if(hasStacks){return;}
var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&meta.stack!==undefined){hasStacks=true;}});}
if(opts.stacked||hasStacks){var valuesPerStack={};helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);var key=[meta.type,((opts.stacked===undefined&&meta.stack===undefined)?datasetIndex:''),meta.stack].join('.');if(valuesPerStack[key]===undefined){valuesPerStack[key]={positiveValues:[],negativeValues:[]};}
var positiveValues=valuesPerStack[key].positiveValues;var negativeValues=valuesPerStack[key].negativeValues;if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return;}
positiveValues[index]=positiveValues[index]||0;negativeValues[index]=negativeValues[index]||0;if(opts.relativePoints){positiveValues[index]=100;}else if(value<0){negativeValues[index]+=value;}else{positiveValues[index]+=value;}});}});helpers$1.each(valuesPerStack,function(valuesForType){var values=valuesForType.positiveValues.concat(valuesForType.negativeValues);var minVal=helpers$1.min(values);var maxVal=helpers$1.max(values);me.min=me.min===null?minVal:Math.min(me.min,minVal);me.max=me.max===null?maxVal:Math.max(me.max,maxVal);});}else{helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return;}
if(me.min===null){me.min=value;}else if(value<me.min){me.min=value;}
if(me.max===null){me.max=value;}else if(value>me.max){me.max=value;}});}});}
me.min=isFinite(me.min)&&!isNaN(me.min)?me.min:DEFAULT_MIN;me.max=isFinite(me.max)&&!isNaN(me.max)?me.max:DEFAULT_MAX;this.handleTickRangeOptions();},_computeTickLimit:function(){var me=this;var tickFont;if(me.isHorizontal()){return Math.ceil(me.width/40);}
tickFont=helpers$1.options._parseFont(me.options.ticks);return Math.ceil(me.height/tickFont.lineHeight);},handleDirectionalChanges:function(){if(!this.isHorizontal()){this.ticks.reverse();}},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index]);},getPixelForValue:function(value){var me=this;var start=me.start;var rightValue=+me.getRightValue(value);var pixel;var range=me.end-start;if(me.isHorizontal()){pixel=me.left+(me.width/range*(rightValue-start));}else{pixel=me.bottom-(me.height/range*(rightValue-start));}
return pixel;},getValueForPixel:function(pixel){var me=this;var isHorizontal=me.isHorizontal();var innerDimension=isHorizontal?me.width:me.height;var offset=(isHorizontal?pixel-me.left:me.bottom-pixel)/innerDimension;return me.start+((me.end-me.start)*offset);},getPixelForTick:function(index){return this.getPixelForValue(this.ticksAsNumbers[index]);}});var _defaults$1=defaultConfig$1;scale_linear._defaults=_defaults$1;var valueOrDefault$a=helpers$1.valueOrDefault;function generateTicks$1(generationOptions,dataRange){var ticks=[];var tickVal=valueOrDefault$a(generationOptions.min,Math.pow(10,Math.floor(helpers$1.log10(dataRange.min))));var endExp=Math.floor(helpers$1.log10(dataRange.max));var endSignificand=Math.ceil(dataRange.max/Math.pow(10,endExp));var exp,significand;if(tickVal===0){exp=Math.floor(helpers$1.log10(dataRange.minNotZero));significand=Math.floor(dataRange.minNotZero/Math.pow(10,exp));ticks.push(tickVal);tickVal=significand*Math.pow(10,exp);}else{exp=Math.floor(helpers$1.log10(tickVal));significand=Math.floor(tickVal/Math.pow(10,exp));}
var precision=exp<0?Math.pow(10,Math.abs(exp)):1;do{ticks.push(tickVal);++significand;if(significand===10){significand=1;++exp;precision=exp>=0?1:precision;}
tickVal=Math.round(significand*Math.pow(10,exp)*precision)/precision;}while(exp<endExp||(exp===endExp&&significand<endSignificand));var lastTick=valueOrDefault$a(generationOptions.max,tickVal);ticks.push(lastTick);return ticks;}
var defaultConfig$2={position:'left',ticks:{callback:core_ticks.formatters.logarithmic}};function nonNegativeOrDefault(value,defaultValue){return helpers$1.isFinite(value)&&value>=0?value:defaultValue;}
var scale_logarithmic=core_scale.extend({determineDataLimits:function(){var me=this;var opts=me.options;var chart=me.chart;var data=chart.data;var datasets=data.datasets;var isHorizontal=me.isHorizontal();function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id;}
me.min=null;me.max=null;me.minNotZero=null;var hasStacks=opts.stacked;if(hasStacks===undefined){helpers$1.each(datasets,function(dataset,datasetIndex){if(hasStacks){return;}
var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&meta.stack!==undefined){hasStacks=true;}});}
if(opts.stacked||hasStacks){var valuesPerStack={};helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);var key=[meta.type,((opts.stacked===undefined&&meta.stack===undefined)?datasetIndex:''),meta.stack].join('.');if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){if(valuesPerStack[key]===undefined){valuesPerStack[key]=[];}
helpers$1.each(dataset.data,function(rawValue,index){var values=valuesPerStack[key];var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden||value<0){return;}
values[index]=values[index]||0;values[index]+=value;});}});helpers$1.each(valuesPerStack,function(valuesForType){if(valuesForType.length>0){var minVal=helpers$1.min(valuesForType);var maxVal=helpers$1.max(valuesForType);me.min=me.min===null?minVal:Math.min(me.min,minVal);me.max=me.max===null?maxVal:Math.max(me.max,maxVal);}});}else{helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden||value<0){return;}
if(me.min===null){me.min=value;}else if(value<me.min){me.min=value;}
if(me.max===null){me.max=value;}else if(value>me.max){me.max=value;}
if(value!==0&&(me.minNotZero===null||value<me.minNotZero)){me.minNotZero=value;}});}});}
this.handleTickRangeOptions();},handleTickRangeOptions:function(){var me=this;var tickOpts=me.options.ticks;var DEFAULT_MIN=1;var DEFAULT_MAX=10;me.min=nonNegativeOrDefault(tickOpts.min,me.min);me.max=nonNegativeOrDefault(tickOpts.max,me.max);if(me.min===me.max){if(me.min!==0&&me.min!==null){me.min=Math.pow(10,Math.floor(helpers$1.log10(me.min))-1);me.max=Math.pow(10,Math.floor(helpers$1.log10(me.max))+1);}else{me.min=DEFAULT_MIN;me.max=DEFAULT_MAX;}}
if(me.min===null){me.min=Math.pow(10,Math.floor(helpers$1.log10(me.max))-1);}
if(me.max===null){me.max=me.min!==0?Math.pow(10,Math.floor(helpers$1.log10(me.min))+1):DEFAULT_MAX;}
if(me.minNotZero===null){if(me.min>0){me.minNotZero=me.min;}else if(me.max<1){me.minNotZero=Math.pow(10,Math.floor(helpers$1.log10(me.max)));}else{me.minNotZero=DEFAULT_MIN;}}},buildTicks:function(){var me=this;var tickOpts=me.options.ticks;var reverse=!me.isHorizontal();var generationOptions={min:nonNegativeOrDefault(tickOpts.min),max:nonNegativeOrDefault(tickOpts.max)};var ticks=me.ticks=generateTicks$1(generationOptions,me);me.max=helpers$1.max(ticks);me.min=helpers$1.min(ticks);if(tickOpts.reverse){reverse=!reverse;me.start=me.max;me.end=me.min;}else{me.start=me.min;me.end=me.max;}
if(reverse){ticks.reverse();}},convertTicksToLabels:function(){this.tickValues=this.ticks.slice();core_scale.prototype.convertTicksToLabels.call(this);},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index]);},getPixelForTick:function(index){return this.getPixelForValue(this.tickValues[index]);},_getFirstTickValue:function(value){var exp=Math.floor(helpers$1.log10(value));var significand=Math.floor(value/Math.pow(10,exp));return significand*Math.pow(10,exp);},getPixelForValue:function(value){var me=this;var tickOpts=me.options.ticks;var reverse=tickOpts.reverse;var log10=helpers$1.log10;var firstTickValue=me._getFirstTickValue(me.minNotZero);var offset=0;var innerDimension,pixel,start,end,sign;value=+me.getRightValue(value);if(reverse){start=me.end;end=me.start;sign=-1;}else{start=me.start;end=me.end;sign=1;}
if(me.isHorizontal()){innerDimension=me.width;pixel=reverse?me.right:me.left;}else{innerDimension=me.height;sign*=-1;pixel=reverse?me.top:me.bottom;}
if(value!==start){if(start===0){offset=valueOrDefault$a(tickOpts.fontSize,core_defaults.global.defaultFontSize);innerDimension-=offset;start=firstTickValue;}
if(value!==0){offset+=innerDimension/(log10(end)-log10(start))*(log10(value)-log10(start));}
pixel+=sign*offset;}
return pixel;},getValueForPixel:function(pixel){var me=this;var tickOpts=me.options.ticks;var reverse=tickOpts.reverse;var log10=helpers$1.log10;var firstTickValue=me._getFirstTickValue(me.minNotZero);var innerDimension,start,end,value;if(reverse){start=me.end;end=me.start;}else{start=me.start;end=me.end;}
if(me.isHorizontal()){innerDimension=me.width;value=reverse?me.right-pixel:pixel-me.left;}else{innerDimension=me.height;value=reverse?pixel-me.top:me.bottom-pixel;}
if(value!==start){if(start===0){var offset=valueOrDefault$a(tickOpts.fontSize,core_defaults.global.defaultFontSize);value-=offset;innerDimension-=offset;start=firstTickValue;}
value*=log10(end)-log10(start);value/=innerDimension;value=Math.pow(10,log10(start)+value);}
return value;}});var _defaults$2=defaultConfig$2;scale_logarithmic._defaults=_defaults$2;var valueOrDefault$b=helpers$1.valueOrDefault;var valueAtIndexOrDefault$1=helpers$1.valueAtIndexOrDefault;var resolve$7=helpers$1.options.resolve;var defaultConfig$3={display:true,animate:true,position:'chartArea',angleLines:{display:true,color:'rgba(0, 0, 0, 0.1)',lineWidth:1,borderDash:[],borderDashOffset:0.0},gridLines:{circular:false},ticks:{showLabelBackdrop:true,backdropColor:'rgba(255,255,255,0.75)',backdropPaddingY:2,backdropPaddingX:2,callback:core_ticks.formatters.linear},pointLabels:{display:true,fontSize:10,callback:function(label){return label;}}};function getValueCount(scale){var opts=scale.options;return opts.angleLines.display||opts.pointLabels.display?scale.chart.data.labels.length:0;}
function getTickBackdropHeight(opts){var tickOpts=opts.ticks;if(tickOpts.display&&opts.display){return valueOrDefault$b(tickOpts.fontSize,core_defaults.global.defaultFontSize)+tickOpts.backdropPaddingY*2;}
return 0;}
function measureLabelSize(ctx,lineHeight,label){if(helpers$1.isArray(label)){return{w:helpers$1.longestText(ctx,ctx.font,label),h:label.length*lineHeight};}
return{w:ctx.measureText(label).width,h:lineHeight};}
function determineLimits(angle,pos,size,min,max){if(angle===min||angle===max){return{start:pos-(size/2),end:pos+(size/2)};}else if(angle<min||angle>max){return{start:pos-size,end:pos};}
return{start:pos,end:pos+size};}
function fitWithPointLabels(scale){var plFont=helpers$1.options._parseFont(scale.options.pointLabels);var furthestLimits={l:0,r:scale.width,t:0,b:scale.height-scale.paddingTop};var furthestAngles={};var i,textSize,pointPosition;scale.ctx.font=plFont.string;scale._pointLabelSizes=[];var valueCount=getValueCount(scale);for(i=0;i<valueCount;i++){pointPosition=scale.getPointPosition(i,scale.drawingArea+5);textSize=measureLabelSize(scale.ctx,plFont.lineHeight,scale.pointLabels[i]||'');scale._pointLabelSizes[i]=textSize;var angleRadians=scale.getIndexAngle(i);var angle=helpers$1.toDegrees(angleRadians)%360;var hLimits=determineLimits(angle,pointPosition.x,textSize.w,0,180);var vLimits=determineLimits(angle,pointPosition.y,textSize.h,90,270);if(hLimits.start<furthestLimits.l){furthestLimits.l=hLimits.start;furthestAngles.l=angleRadians;}
if(hLimits.end>furthestLimits.r){furthestLimits.r=hLimits.end;furthestAngles.r=angleRadians;}
if(vLimits.start<furthestLimits.t){furthestLimits.t=vLimits.start;furthestAngles.t=angleRadians;}
if(vLimits.end>furthestLimits.b){furthestLimits.b=vLimits.end;furthestAngles.b=angleRadians;}}
scale.setReductions(scale.drawingArea,furthestLimits,furthestAngles);}
function getTextAlignForAngle(angle){if(angle===0||angle===180){return'center';}else if(angle<180){return'left';}
return'right';}
function fillText(ctx,text,position,lineHeight){var y=position.y+lineHeight/2;var i,ilen;if(helpers$1.isArray(text)){for(i=0,ilen=text.length;i<ilen;++i){ctx.fillText(text[i],position.x,y);y+=lineHeight;}}else{ctx.fillText(text,position.x,y);}}
function adjustPointPositionForLabelHeight(angle,textSize,position){if(angle===90||angle===270){position.y-=(textSize.h/2);}else if(angle>270||angle<90){position.y-=textSize.h;}}
function drawPointLabels(scale){var ctx=scale.ctx;var opts=scale.options;var angleLineOpts=opts.angleLines;var gridLineOpts=opts.gridLines;var pointLabelOpts=opts.pointLabels;var lineWidth=valueOrDefault$b(angleLineOpts.lineWidth,gridLineOpts.lineWidth);var lineColor=valueOrDefault$b(angleLineOpts.color,gridLineOpts.color);var tickBackdropHeight=getTickBackdropHeight(opts);ctx.save();ctx.lineWidth=lineWidth;ctx.strokeStyle=lineColor;if(ctx.setLineDash){ctx.setLineDash(resolve$7([angleLineOpts.borderDash,gridLineOpts.borderDash,[]]));ctx.lineDashOffset=resolve$7([angleLineOpts.borderDashOffset,gridLineOpts.borderDashOffset,0.0]);}
var outerDistance=scale.getDistanceFromCenterForValue(opts.ticks.reverse?scale.min:scale.max);var plFont=helpers$1.options._parseFont(pointLabelOpts);ctx.font=plFont.string;ctx.textBaseline='middle';for(var i=getValueCount(scale)-1;i>=0;i--){if(angleLineOpts.display&&lineWidth&&lineColor){var outerPosition=scale.getPointPosition(i,outerDistance);ctx.beginPath();ctx.moveTo(scale.xCenter,scale.yCenter);ctx.lineTo(outerPosition.x,outerPosition.y);ctx.stroke();}
if(pointLabelOpts.display){var extra=(i===0?tickBackdropHeight/2:0);var pointLabelPosition=scale.getPointPosition(i,outerDistance+extra+5);var pointLabelFontColor=valueAtIndexOrDefault$1(pointLabelOpts.fontColor,i,core_defaults.global.defaultFontColor);ctx.fillStyle=pointLabelFontColor;var angleRadians=scale.getIndexAngle(i);var angle=helpers$1.toDegrees(angleRadians);ctx.textAlign=getTextAlignForAngle(angle);adjustPointPositionForLabelHeight(angle,scale._pointLabelSizes[i],pointLabelPosition);fillText(ctx,scale.pointLabels[i]||'',pointLabelPosition,plFont.lineHeight);}}
ctx.restore();}
function drawRadiusLine(scale,gridLineOpts,radius,index){var ctx=scale.ctx;var circular=gridLineOpts.circular;var valueCount=getValueCount(scale);var lineColor=valueAtIndexOrDefault$1(gridLineOpts.color,index-1);var lineWidth=valueAtIndexOrDefault$1(gridLineOpts.lineWidth,index-1);var pointPosition;if((!circular&&!valueCount)||!lineColor||!lineWidth){return;}
ctx.save();ctx.strokeStyle=lineColor;ctx.lineWidth=lineWidth;if(ctx.setLineDash){ctx.setLineDash(gridLineOpts.borderDash||[]);ctx.lineDashOffset=gridLineOpts.borderDashOffset||0.0;}
ctx.beginPath();if(circular){ctx.arc(scale.xCenter,scale.yCenter,radius,0,Math.PI*2);}else{pointPosition=scale.getPointPosition(0,radius);ctx.moveTo(pointPosition.x,pointPosition.y);for(var i=1;i<valueCount;i++){pointPosition=scale.getPointPosition(i,radius);ctx.lineTo(pointPosition.x,pointPosition.y);}}
ctx.closePath();ctx.stroke();ctx.restore();}
function numberOrZero(param){return helpers$1.isNumber(param)?param:0;}
var scale_radialLinear=scale_linearbase.extend({setDimensions:function(){var me=this;me.width=me.maxWidth;me.height=me.maxHeight;me.paddingTop=getTickBackdropHeight(me.options)/2;me.xCenter=Math.floor(me.width/2);me.yCenter=Math.floor((me.height-me.paddingTop)/2);me.drawingArea=Math.min(me.height-me.paddingTop,me.width)/2;},determineDataLimits:function(){var me=this;var chart=me.chart;var min=Number.POSITIVE_INFINITY;var max=Number.NEGATIVE_INFINITY;helpers$1.each(chart.data.datasets,function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return;}
min=Math.min(value,min);max=Math.max(value,max);});}});me.min=(min===Number.POSITIVE_INFINITY?0:min);me.max=(max===Number.NEGATIVE_INFINITY?0:max);me.handleTickRangeOptions();},_computeTickLimit:function(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options));},convertTicksToLabels:function(){var me=this;scale_linearbase.prototype.convertTicksToLabels.call(me);me.pointLabels=me.chart.data.labels.map(me.options.pointLabels.callback,me);},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index]);},fit:function(){var me=this;var opts=me.options;if(opts.display&&opts.pointLabels.display){fitWithPointLabels(me);}else{me.setCenterPoint(0,0,0,0);}},setReductions:function(largestPossibleRadius,furthestLimits,furthestAngles){var me=this;var radiusReductionLeft=furthestLimits.l/Math.sin(furthestAngles.l);var radiusReductionRight=Math.max(furthestLimits.r-me.width,0)/Math.sin(furthestAngles.r);var radiusReductionTop=-furthestLimits.t/Math.cos(furthestAngles.t);var radiusReductionBottom=-Math.max(furthestLimits.b-(me.height-me.paddingTop),0)/Math.cos(furthestAngles.b);radiusReductionLeft=numberOrZero(radiusReductionLeft);radiusReductionRight=numberOrZero(radiusReductionRight);radiusReductionTop=numberOrZero(radiusReductionTop);radiusReductionBottom=numberOrZero(radiusReductionBottom);me.drawingArea=Math.min(Math.floor(largestPossibleRadius-(radiusReductionLeft+radiusReductionRight)/2),Math.floor(largestPossibleRadius-(radiusReductionTop+radiusReductionBottom)/2));me.setCenterPoint(radiusReductionLeft,radiusReductionRight,radiusReductionTop,radiusReductionBottom);},setCenterPoint:function(leftMovement,rightMovement,topMovement,bottomMovement){var me=this;var maxRight=me.width-rightMovement-me.drawingArea;var maxLeft=leftMovement+me.drawingArea;var maxTop=topMovement+me.drawingArea;var maxBottom=(me.height-me.paddingTop)-bottomMovement-me.drawingArea;me.xCenter=Math.floor(((maxLeft+maxRight)/2)+me.left);me.yCenter=Math.floor(((maxTop+maxBottom)/2)+me.top+me.paddingTop);},getIndexAngle:function(index){var angleMultiplier=(Math.PI*2)/getValueCount(this);var startAngle=this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0;var startAngleRadians=startAngle*Math.PI*2/360;return index*angleMultiplier+startAngleRadians;},getDistanceFromCenterForValue:function(value){var me=this;if(value===null){return 0;}
var scalingFactor=me.drawingArea/(me.max-me.min);if(me.options.ticks.reverse){return(me.max-value)*scalingFactor;}
return(value-me.min)*scalingFactor;},getPointPosition:function(index,distanceFromCenter){var me=this;var thisAngle=me.getIndexAngle(index)-(Math.PI/2);return{x:Math.cos(thisAngle)*distanceFromCenter+me.xCenter,y:Math.sin(thisAngle)*distanceFromCenter+me.yCenter};},getPointPositionForValue:function(index,value){return this.getPointPosition(index,this.getDistanceFromCenterForValue(value));},getBasePosition:function(){var me=this;var min=me.min;var max=me.max;return me.getPointPositionForValue(0,me.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0);},draw:function(){var me=this;var opts=me.options;var gridLineOpts=opts.gridLines;var tickOpts=opts.ticks;if(opts.display){var ctx=me.ctx;var startAngle=this.getIndexAngle(0);var tickFont=helpers$1.options._parseFont(tickOpts);if(opts.angleLines.display||opts.pointLabels.display){drawPointLabels(me);}
helpers$1.each(me.ticks,function(label,index){if(index>0||tickOpts.reverse){var yCenterOffset=me.getDistanceFromCenterForValue(me.ticksAsNumbers[index]);if(gridLineOpts.display&&index!==0){drawRadiusLine(me,gridLineOpts,yCenterOffset,index);}
if(tickOpts.display){var tickFontColor=valueOrDefault$b(tickOpts.fontColor,core_defaults.global.defaultFontColor);ctx.font=tickFont.string;ctx.save();ctx.translate(me.xCenter,me.yCenter);ctx.rotate(startAngle);if(tickOpts.showLabelBackdrop){var labelWidth=ctx.measureText(label).width;ctx.fillStyle=tickOpts.backdropColor;ctx.fillRect(-labelWidth/2-tickOpts.backdropPaddingX,-yCenterOffset-tickFont.size/2-tickOpts.backdropPaddingY,labelWidth+tickOpts.backdropPaddingX*2,tickFont.size+tickOpts.backdropPaddingY*2);}
ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=tickFontColor;ctx.fillText(label,0,-yCenterOffset);ctx.restore();}}});}}});var _defaults$3=defaultConfig$3;scale_radialLinear._defaults=_defaults$3;var valueOrDefault$c=helpers$1.valueOrDefault;var MIN_INTEGER=Number.MIN_SAFE_INTEGER||-9007199254740991;var MAX_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;var INTERVALS={millisecond:{common:true,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:true,size:1000,steps:[1,2,5,10,15,30]},minute:{common:true,size:60000,steps:[1,2,5,10,15,30]},hour:{common:true,size:3600000,steps:[1,2,3,6,12]},day:{common:true,size:86400000,steps:[1,2,5]},week:{common:false,size:604800000,steps:[1,2,3,4]},month:{common:true,size:2.628e9,steps:[1,2,3]},quarter:{common:false,size:7.884e9,steps:[1,2,3,4]},year:{common:true,size:3.154e10}};var UNITS=Object.keys(INTERVALS);function sorter(a,b){return a-b;}
function arrayUnique(items){var hash={};var out=[];var i,ilen,item;for(i=0,ilen=items.length;i<ilen;++i){item=items[i];if(!hash[item]){hash[item]=true;out.push(item);}}
return out;}
function buildLookupTable(timestamps,min,max,distribution){if(distribution==='linear'||!timestamps.length){return[{time:min,pos:0},{time:max,pos:1}];}
var table=[];var items=[min];var i,ilen,prev,curr,next;for(i=0,ilen=timestamps.length;i<ilen;++i){curr=timestamps[i];if(curr>min&&curr<max){items.push(curr);}}
items.push(max);for(i=0,ilen=items.length;i<ilen;++i){next=items[i+1];prev=items[i-1];curr=items[i];if(prev===undefined||next===undefined||Math.round((next+prev)/2)!==curr){table.push({time:curr,pos:i/(ilen-1)});}}
return table;}
function lookup(table,key,value){var lo=0;var hi=table.length-1;var mid,i0,i1;while(lo>=0&&lo<=hi){mid=(lo+hi)>>1;i0=table[mid-1]||null;i1=table[mid];if(!i0){return{lo:null,hi:i1};}else if(i1[key]<value){lo=mid+1;}else if(i0[key]>value){hi=mid-1;}else{return{lo:i0,hi:i1};}}
return{lo:i1,hi:null};}
function interpolate$1(table,skey,sval,tkey){var range=lookup(table,skey,sval);var prev=!range.lo?table[0]:!range.hi?table[table.length-2]:range.lo;var next=!range.lo?table[1]:!range.hi?table[table.length-1]:range.hi;var span=next[skey]-prev[skey];var ratio=span?(sval-prev[skey])/span:0;var offset=(next[tkey]-prev[tkey])*ratio;return prev[tkey]+offset;}
function toTimestamp(scale,input){var adapter=scale._adapter;var options=scale.options.time;var parser=options.parser;var format=parser||options.format;var value=input;if(typeof parser==='function'){value=parser(value);}
if(!helpers$1.isFinite(value)){value=typeof format==='string'?adapter.parse(value,format):adapter.parse(value);}
if(value!==null){return+value;}
if(!parser&&typeof format==='function'){value=format(input);if(!helpers$1.isFinite(value)){value=adapter.parse(value);}}
return value;}
function parse(scale,input){if(helpers$1.isNullOrUndef(input)){return null;}
var options=scale.options.time;var value=toTimestamp(scale,scale.getRightValue(input));if(value===null){return value;}
if(options.round){value=+scale._adapter.startOf(value,options.round);}
return value;}
function determineStepSize(min,max,unit,capacity){var range=max-min;var interval=INTERVALS[unit];var milliseconds=interval.size;var steps=interval.steps;var i,ilen,factor;if(!steps){return Math.ceil(range/(capacity*milliseconds));}
for(i=0,ilen=steps.length;i<ilen;++i){factor=steps[i];if(Math.ceil(range/(milliseconds*factor))<=capacity){break;}}
return factor;}
function determineUnitForAutoTicks(minUnit,min,max,capacity){var ilen=UNITS.length;var i,interval,factor;for(i=UNITS.indexOf(minUnit);i<ilen-1;++i){interval=INTERVALS[UNITS[i]];factor=interval.steps?interval.steps[interval.steps.length-1]:MAX_INTEGER;if(interval.common&&Math.ceil((max-min)/(factor*interval.size))<=capacity){return UNITS[i];}}
return UNITS[ilen-1];}
function determineUnitForFormatting(scale,ticks,minUnit,min,max){var ilen=UNITS.length;var i,unit;for(i=ilen-1;i>=UNITS.indexOf(minUnit);i--){unit=UNITS[i];if(INTERVALS[unit].common&&scale._adapter.diff(max,min,unit)>=ticks.length){return unit;}}
return UNITS[minUnit?UNITS.indexOf(minUnit):0];}
function determineMajorUnit(unit){for(var i=UNITS.indexOf(unit)+1,ilen=UNITS.length;i<ilen;++i){if(INTERVALS[UNITS[i]].common){return UNITS[i];}}}
function generate(scale,min,max,capacity){var adapter=scale._adapter;var options=scale.options;var timeOpts=options.time;var minor=timeOpts.unit||determineUnitForAutoTicks(timeOpts.minUnit,min,max,capacity);var major=determineMajorUnit(minor);var stepSize=valueOrDefault$c(timeOpts.stepSize,timeOpts.unitStepSize);var weekday=minor==='week'?timeOpts.isoWeekday:false;var majorTicksEnabled=options.ticks.major.enabled;var interval=INTERVALS[minor];var first=min;var last=max;var ticks=[];var time;if(!stepSize){stepSize=determineStepSize(min,max,minor,capacity);}
if(weekday){first=+adapter.startOf(first,'isoWeek',weekday);last=+adapter.startOf(last,'isoWeek',weekday);}
first=+adapter.startOf(first,weekday?'day':minor);last=+adapter.startOf(last,weekday?'day':minor);if(last<max){last=+adapter.add(last,1,minor);}
time=first;if(majorTicksEnabled&&major&&!weekday&&!timeOpts.round){time=+adapter.startOf(time,major);time=+adapter.add(time,~~((first-time)/(interval.size*stepSize))*stepSize,minor);}
for(;time<last;time=+adapter.add(time,stepSize,minor)){ticks.push(+time);}
ticks.push(+time);return ticks;}
function computeOffsets(table,ticks,min,max,options){var start=0;var end=0;var first,last;if(options.offset&&ticks.length){if(!options.time.min){first=interpolate$1(table,'time',ticks[0],'pos');if(ticks.length===1){start=1-first;}else{start=(interpolate$1(table,'time',ticks[1],'pos')-first)/2;}}
if(!options.time.max){last=interpolate$1(table,'time',ticks[ticks.length-1],'pos');if(ticks.length===1){end=last;}else{end=(last-interpolate$1(table,'time',ticks[ticks.length-2],'pos'))/2;}}}
return{start:start,end:end};}
function ticksFromTimestamps(scale,values,majorUnit){var ticks=[];var i,ilen,value,major;for(i=0,ilen=values.length;i<ilen;++i){value=values[i];major=majorUnit?value===+scale._adapter.startOf(value,majorUnit):false;ticks.push({value:value,major:major});}
return ticks;}
var defaultConfig$4={position:'bottom',distribution:'linear',bounds:'data',adapters:{},time:{parser:false,format:false,unit:false,round:false,displayFormat:false,isoWeekday:false,minUnit:'millisecond',displayFormats:{}},ticks:{autoSkip:false,source:'auto',major:{enabled:false}}};var scale_time=core_scale.extend({initialize:function(){this.mergeTicksOptions();core_scale.prototype.initialize.call(this);},update:function(){var me=this;var options=me.options;var time=options.time||(options.time={});var adapter=me._adapter=new core_adapters._date(options.adapters.date);if(time.format){console.warn('options.time.format is deprecated and replaced by options.time.parser.');}
helpers$1.mergeIf(time.displayFormats,adapter.formats());return core_scale.prototype.update.apply(me,arguments);},getRightValue:function(rawValue){if(rawValue&&rawValue.t!==undefined){rawValue=rawValue.t;}
return core_scale.prototype.getRightValue.call(this,rawValue);},determineDataLimits:function(){var me=this;var chart=me.chart;var adapter=me._adapter;var timeOpts=me.options.time;var unit=timeOpts.unit||'day';var min=MAX_INTEGER;var max=MIN_INTEGER;var timestamps=[];var datasets=[];var labels=[];var i,j,ilen,jlen,data,timestamp;var dataLabels=chart.data.labels||[];for(i=0,ilen=dataLabels.length;i<ilen;++i){labels.push(parse(me,dataLabels[i]));}
for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){if(chart.isDatasetVisible(i)){data=chart.data.datasets[i].data;if(helpers$1.isObject(data[0])){datasets[i]=[];for(j=0,jlen=data.length;j<jlen;++j){timestamp=parse(me,data[j]);timestamps.push(timestamp);datasets[i][j]=timestamp;}}else{for(j=0,jlen=labels.length;j<jlen;++j){timestamps.push(labels[j]);}
datasets[i]=labels.slice(0);}}else{datasets[i]=[];}}
if(labels.length){labels=arrayUnique(labels).sort(sorter);min=Math.min(min,labels[0]);max=Math.max(max,labels[labels.length-1]);}
if(timestamps.length){timestamps=arrayUnique(timestamps).sort(sorter);min=Math.min(min,timestamps[0]);max=Math.max(max,timestamps[timestamps.length-1]);}
min=parse(me,timeOpts.min)||min;max=parse(me,timeOpts.max)||max;min=min===MAX_INTEGER?+adapter.startOf(Date.now(),unit):min;max=max===MIN_INTEGER?+adapter.endOf(Date.now(),unit)+1:max;me.min=Math.min(min,max);me.max=Math.max(min+1,max);me._horizontal=me.isHorizontal();me._table=[];me._timestamps={data:timestamps,datasets:datasets,labels:labels};},buildTicks:function(){var me=this;var min=me.min;var max=me.max;var options=me.options;var timeOpts=options.time;var timestamps=[];var ticks=[];var i,ilen,timestamp;switch(options.ticks.source){case'data':timestamps=me._timestamps.data;break;case'labels':timestamps=me._timestamps.labels;break;case'auto':default:timestamps=generate(me,min,max,me.getLabelCapacity(min),options);}
if(options.bounds==='ticks'&&timestamps.length){min=timestamps[0];max=timestamps[timestamps.length-1];}
min=parse(me,timeOpts.min)||min;max=parse(me,timeOpts.max)||max;for(i=0,ilen=timestamps.length;i<ilen;++i){timestamp=timestamps[i];if(timestamp>=min&&timestamp<=max){ticks.push(timestamp);}}
me.min=min;me.max=max;me._unit=timeOpts.unit||determineUnitForFormatting(me,ticks,timeOpts.minUnit,me.min,me.max);me._majorUnit=determineMajorUnit(me._unit);me._table=buildLookupTable(me._timestamps.data,min,max,options.distribution);me._offsets=computeOffsets(me._table,ticks,min,max,options);if(options.ticks.reverse){ticks.reverse();}
return ticksFromTimestamps(me,ticks,me._majorUnit);},getLabelForIndex:function(index,datasetIndex){var me=this;var adapter=me._adapter;var data=me.chart.data;var timeOpts=me.options.time;var label=data.labels&&index<data.labels.length?data.labels[index]:'';var value=data.datasets[datasetIndex].data[index];if(helpers$1.isObject(value)){label=me.getRightValue(value);}
if(timeOpts.tooltipFormat){return adapter.format(toTimestamp(me,label),timeOpts.tooltipFormat);}
if(typeof label==='string'){return label;}
return adapter.format(toTimestamp(me,label),timeOpts.displayFormats.datetime);},tickFormatFunction:function(time,index,ticks,format){var me=this;var adapter=me._adapter;var options=me.options;var formats=options.time.displayFormats;var minorFormat=formats[me._unit];var majorUnit=me._majorUnit;var majorFormat=formats[majorUnit];var majorTime=+adapter.startOf(time,majorUnit);var majorTickOpts=options.ticks.major;var major=majorTickOpts.enabled&&majorUnit&&majorFormat&&time===majorTime;var label=adapter.format(time,format?format:major?majorFormat:minorFormat);var tickOpts=major?majorTickOpts:options.ticks.minor;var formatter=valueOrDefault$c(tickOpts.callback,tickOpts.userCallback);return formatter?formatter(label,index,ticks):label;},convertTicksToLabels:function(ticks){var labels=[];var i,ilen;for(i=0,ilen=ticks.length;i<ilen;++i){labels.push(this.tickFormatFunction(ticks[i].value,i,ticks));}
return labels;},getPixelForOffset:function(time){var me=this;var isReverse=me.options.ticks.reverse;var size=me._horizontal?me.width:me.height;var start=me._horizontal?isReverse?me.right:me.left:isReverse?me.bottom:me.top;var pos=interpolate$1(me._table,'time',time,'pos');var offset=size*(me._offsets.start+pos)/(me._offsets.start+1+me._offsets.end);return isReverse?start-offset:start+offset;},getPixelForValue:function(value,index,datasetIndex){var me=this;var time=null;if(index!==undefined&&datasetIndex!==undefined){time=me._timestamps.datasets[datasetIndex][index];}
if(time===null){time=parse(me,value);}
if(time!==null){return me.getPixelForOffset(time);}},getPixelForTick:function(index){var ticks=this.getTicks();return index>=0&&index<ticks.length?this.getPixelForOffset(ticks[index].value):null;},getValueForPixel:function(pixel){var me=this;var size=me._horizontal?me.width:me.height;var start=me._horizontal?me.left:me.top;var pos=(size?(pixel-start)/size:0)*(me._offsets.start+1+me._offsets.start)-me._offsets.end;var time=interpolate$1(me._table,'pos',pos,'time');return me._adapter._create(time);},getLabelWidth:function(label){var me=this;var ticksOpts=me.options.ticks;var tickLabelWidth=me.ctx.measureText(label).width;var angle=helpers$1.toRadians(ticksOpts.maxRotation);var cosRotation=Math.cos(angle);var sinRotation=Math.sin(angle);var tickFontSize=valueOrDefault$c(ticksOpts.fontSize,core_defaults.global.defaultFontSize);return(tickLabelWidth*cosRotation)+(tickFontSize*sinRotation);},getLabelCapacity:function(exampleTime){var me=this;var format=me.options.time.displayFormats.millisecond;var exampleLabel=me.tickFormatFunction(exampleTime,0,[],format);var tickLabelWidth=me.getLabelWidth(exampleLabel);var innerWidth=me.isHorizontal()?me.width:me.height;var capacity=Math.floor(innerWidth/tickLabelWidth);return capacity>0?capacity:1;}});var _defaults$4=defaultConfig$4;scale_time._defaults=_defaults$4;var scales={category:scale_category,linear:scale_linear,logarithmic:scale_logarithmic,radialLinear:scale_radialLinear,time:scale_time};var moment=createCommonjsModule(function(module,exports){(function(global,factory){module.exports=factory();}(commonjsGlobal,(function(){var hookCallback;function hooks(){return hookCallback.apply(null,arguments);}
function setHookCallback(callback){hookCallback=callback;}
function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==='[object Array]';}
function isObject(input){return input!=null&&Object.prototype.toString.call(input)==='[object Object]';}
function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return(Object.getOwnPropertyNames(obj).length===0);}else{var k;for(k in obj){if(obj.hasOwnProperty(k)){return false;}}
return true;}}
function isUndefined(input){return input===void 0;}
function isNumber(input){return typeof input==='number'||Object.prototype.toString.call(input)==='[object Number]';}
function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==='[object Date]';}
function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i));}
return res;}
function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b);}
function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i];}}
if(hasOwnProp(b,'toString')){a.toString=b.toString;}
if(hasOwnProp(b,'valueOf')){a.valueOf=b.valueOf;}
return a;}
function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc();}
function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false};}
function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags();}
return m._pf;}
var some;if(Array.prototype.some){some=Array.prototype.some;}else{some=function(fun){var t=Object(this);var len=t.length>>>0;for(var i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true;}}
return false;};}
function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);var parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null;});var isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||(flags.meridiem&&parsedParts));if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined;}
if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid;}
else{return isNowValid;}}
return m._isValid;}
function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags);}
else{getParsingFlags(m).userInvalidated=true;}
return m;}
var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject;}
if(!isUndefined(from._i)){to._i=from._i;}
if(!isUndefined(from._f)){to._f=from._f;}
if(!isUndefined(from._l)){to._l=from._l;}
if(!isUndefined(from._strict)){to._strict=from._strict;}
if(!isUndefined(from._tzm)){to._tzm=from._tzm;}
if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC;}
if(!isUndefined(from._offset)){to._offset=from._offset;}
if(!isUndefined(from._pf)){to._pf=getParsingFlags(from);}
if(!isUndefined(from._locale)){to._locale=from._locale;}
if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val;}}}
return to;}
var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN);}
if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false;}}
function isMoment(obj){return obj instanceof Moment||(obj!=null&&obj._isAMomentObject!=null);}
function absFloor(number){if(number<0){return Math.ceil(number)||0;}else{return Math.floor(number);}}
function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber);}
return value;}
function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++;}}
return diffs+lengthDiff;}
function warn(msg){if(hooks.suppressDeprecationWarnings===false&&(typeof console!=='undefined')&&console.warn){console.warn('Deprecation warning: '+msg);}}
function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg);}
if(firstTime){var args=[];var arg;for(var i=0;i<arguments.length;i++){arg='';if(typeof arguments[i]==='object'){arg+='\n['+i+'] ';for(var key in arguments[0]){arg+=key+': '+arguments[0][key]+', ';}
arg=arg.slice(0,-2);}else{arg=arguments[i];}
args.push(arg);}
warn(msg+'\nArguments: '+Array.prototype.slice.call(args).join('')+'\n'+(new Error()).stack);firstTime=false;}
return fn.apply(this,arguments);},fn);}
var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg);}
if(!deprecations[name]){warn(msg);deprecations[name]=true;}}
hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return input instanceof Function||Object.prototype.toString.call(input)==='[object Function]';}
function set(config){var prop,i;for(i in config){prop=config[i];if(isFunction(prop)){this[i]=prop;}else{this['_'+i]=prop;}}
this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+'|'+(/\d{1,2}/).source);}
function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop]);}else if(childConfig[prop]!=null){res[prop]=childConfig[prop];}else{delete res[prop];}}}
for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop]);}}
return res;}
function Locale(config){if(config!=null){this.set(config);}}
var keys;if(Object.keys){keys=Object.keys;}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i);}}
return res;};}
var defaultCalendar={sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[Last] dddd [at] LT',sameElse:'L'};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar['sameElse'];return isFunction(output)?output.call(mom,now):output;}
var defaultLongDateFormat={LTS:'h:mm:ss A',LT:'h:mm A',L:'MM/DD/YYYY',LL:'MMMM D, YYYY',LLL:'MMMM D, YYYY h:mm A',LLLL:'dddd, MMMM D, YYYY h:mm A'};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format;}
this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1);});return this._longDateFormat[key];}
var defaultInvalidDate='Invalid date';function invalidDate(){return this._invalidDate;}
var defaultOrdinal='%d';var defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace('%d',number);}
var defaultRelativeTime={future:'in %s',past:'%s ago',s:'a few seconds',ss:'%d seconds',m:'a minute',mm:'%d minutes',h:'an hour',hh:'%d hours',d:'a day',dd:'%d days',M:'a month',MM:'%d months',y:'a year',yy:'%d years'};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(isFunction(output))?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number);}
function pastFuture(diff,output){var format=this._relativeTime[diff>0?'future':'past'];return isFunction(format)?format(output):format.replace(/%s/i,output);}
var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+'s']=aliases[shorthand]=unit;}
function normalizeUnits(units){return typeof units==='string'?aliases[units]||aliases[units.toLowerCase()]:undefined;}
function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];}}}
return normalizedInput;}
var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority;}
function getPrioritizedUnits(unitsObj){var units=[];for(var u in unitsObj){units.push({unit:u,priority:priorities[u]});}
units.sort(function(a,b){return a.priority-b.priority;});return units;}
function zeroFill(number,targetLength,forceSign){var absNumber=''+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?(forceSign?'+':''):'-')+
Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber;}
var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==='string'){func=function(){return this[callback]();};}
if(token){formatTokenFunctions[token]=func;}
if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2]);};}
if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token);};}}
function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,'');}
return input.replace(/\\/g,'');}
function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]];}else{array[i]=removeFormattingTokens(array[i]);}}
return function(mom){var output='',i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i];}
return output;};}
function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate();}
format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m);}
function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input;}
localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1;}
return format;}
var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match3to4=/\d\d\d\d?/;var match5to6=/\d\d\d\d\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;var regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return(isStrict&&strictRegex)?strictRegex:regex;};}
function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token));}
return regexes[token](config._strict,config._locale);}
function unescapeFormat(s){return regexEscape(s.replace('\\','').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4;}));}
function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');}
var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==='string'){token=[token];}
if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input);};}
for(i=0;i<token.length;i++){tokens[token[i]]=func;}}
function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token);});}
function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token);}}
var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;var WEEK=7;var WEEKDAY=8;addFormatToken('Y',0,0,function(){var y=this.year();return y<=9999?''+y:'+'+y;});addFormatToken(0,['YY',2],0,function(){return this.year()%100;});addFormatToken(0,['YYYY',4],0,'year');addFormatToken(0,['YYYYY',5],0,'year');addFormatToken(0,['YYYYYY',6,true],0,'year');addUnitAlias('year','y');addUnitPriority('year',1);addRegexToken('Y',matchSigned);addRegexToken('YY',match1to2,match2);addRegexToken('YYYY',match1to4,match4);addRegexToken('YYYYY',match1to6,match6);addRegexToken('YYYYYY',match1to6,match6);addParseToken(['YYYYY','YYYYYY'],YEAR);addParseToken('YYYY',function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input);});addParseToken('YY',function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input);});addParseToken('Y',function(input,array){array[YEAR]=parseInt(input,10);});function daysInYear(year){return isLeapYear(year)?366:365;}
function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0;}
hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000);};var getSetYear=makeGetSet('FullYear',true);function getIsLeapYear(){return isLeapYear(this.year());}
function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this;}else{return get(this,unit);}};}
function get(mom,unit){return mom.isValid()?mom._d['get'+(mom._isUTC?'UTC':'')+unit]():NaN;}
function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==='FullYear'&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){mom._d['set'+(mom._isUTC?'UTC':'')+unit](value,mom.month(),daysInMonth(value,mom.month()));}
else{mom._d['set'+(mom._isUTC?'UTC':'')+unit](value);}}}
function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]();}
return this;}
function stringSet(units,value){if(typeof units==='object'){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units);for(var i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit]);}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value);}}
return this;}
function mod(n,x){return((n%x)+x)%x;}
var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf;}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i;}}
return-1;};}
function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN;}
var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?(isLeapYear(year)?29:28):(31-modMonth%7%2);}
addFormatToken('M',['MM',2],'Mo',function(){return this.month()+1;});addFormatToken('MMM',0,0,function(format){return this.localeData().monthsShort(this,format);});addFormatToken('MMMM',0,0,function(format){return this.localeData().months(this,format);});addUnitAlias('month','M');addUnitPriority('month',8);addRegexToken('M',match1to2);addRegexToken('MM',match1to2,match2);addRegexToken('MMM',function(isStrict,locale){return locale.monthsShortRegex(isStrict);});addRegexToken('MMMM',function(isStrict,locale){return locale.monthsRegex(isStrict);});addParseToken(['M','MM'],function(input,array){array[MONTH]=toInt(input)-1;});addParseToken(['MMM','MMMM'],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month;}else{getParsingFlags(config).invalidMonth=input;}});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var defaultLocaleMonths='January_February_March_April_May_June_July_August_September_October_November_December'.split('_');function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months['standalone'];}
return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?'format':'standalone'][m.month()];}
var defaultLocaleMonthsShort='Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort['standalone'];}
return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?'format':'standalone'][m.month()];}
function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2000,i]);this._shortMonthsParse[i]=this.monthsShort(mom,'').toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='MMM'){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}}else{if(format==='MMM'){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}}}
function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict);}
if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];}
for(i=0;i<12;i++){mom=createUTC([2000,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp('^'+this.months(mom,'').replace('.','')+'$','i');this._shortMonthsParse[i]=new RegExp('^'+this.monthsShort(mom,'').replace('.','')+'$','i');}
if(!strict&&!this._monthsParse[i]){regex='^'+this.months(mom,'')+'|^'+this.monthsShort(mom,'');this._monthsParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='MMMM'&&this._longMonthsParse[i].test(monthName)){return i;}else if(strict&&format==='MMM'&&this._shortMonthsParse[i].test(monthName)){return i;}else if(!strict&&this._monthsParse[i].test(monthName)){return i;}}}
function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom;}
if(typeof value==='string'){if(/^\d+$/.test(value)){value=toInt(value);}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom;}}}
dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d['set'+(mom._isUTC?'UTC':'')+'Month'](value,dayOfMonth);return mom;}
function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this;}else{return get(this,'Month');}}
function getDaysInMonth(){return daysInMonth(this.year(),this.month());}
var defaultMonthsShortRegex=matchWord;function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsShortStrictRegex;}else{return this._monthsShortRegex;}}else{if(!hasOwnProp(this,'_monthsShortRegex')){this._monthsShortRegex=defaultMonthsShortRegex;}
return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex;}}
var defaultMonthsRegex=matchWord;function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsStrictRegex;}else{return this._monthsRegex;}}else{if(!hasOwnProp(this,'_monthsRegex')){this._monthsRegex=defaultMonthsRegex;}
return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex;}}
function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length;}
var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2000,i]);shortPieces.push(this.monthsShort(mom,''));longPieces.push(this.months(mom,''));mixedPieces.push(this.months(mom,''));mixedPieces.push(this.monthsShort(mom,''));}
shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);}
for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i]);}
this._monthsRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._monthsShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');}
function createDate(y,m,d,h,M,s,ms){var date;if(y<100&&y>=0){date=new Date(y+400,m,d,h,M,s,ms);if(isFinite(date.getFullYear())){date.setFullYear(y);}}else{date=new Date(y,m,d,h,M,s,ms);}
return date;}
function createUTCDate(y){var date;if(y<100&&y>=0){var args=Array.prototype.slice.call(arguments);args[0]=y+400;date=new Date(Date.UTC.apply(null,args));if(isFinite(date.getUTCFullYear())){date.setUTCFullYear(y);}}else{date=new Date(Date.UTC.apply(null,arguments));}
return date;}
function firstWeekOffset(year,dow,doy){var
fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1;}
function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear;}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year);}else{resYear=year;resDayOfYear=dayOfYear;}
return{year:resYear,dayOfYear:resDayOfYear};}
function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy);}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1;}else{resYear=mom.year();resWeek=week;}
return{week:resWeek,year:resYear};}
function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7;}
addFormatToken('w',['ww',2],'wo','week');addFormatToken('W',['WW',2],'Wo','isoWeek');addUnitAlias('week','w');addUnitAlias('isoWeek','W');addUnitPriority('week',5);addUnitPriority('isoWeek',5);addRegexToken('w',match1to2);addRegexToken('ww',match1to2,match2);addRegexToken('W',match1to2);addRegexToken('WW',match1to2,match2);addWeekParseToken(['w','ww','W','WW'],function(input,week,config,token){week[token.substr(0,1)]=toInt(input);});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week;}
var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow;}
function localeFirstDayOfYear(){return this._week.doy;}
function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,'d');}
function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,'d');}
addFormatToken('d',0,'do','day');addFormatToken('dd',0,0,function(format){return this.localeData().weekdaysMin(this,format);});addFormatToken('ddd',0,0,function(format){return this.localeData().weekdaysShort(this,format);});addFormatToken('dddd',0,0,function(format){return this.localeData().weekdays(this,format);});addFormatToken('e',0,0,'weekday');addFormatToken('E',0,0,'isoWeekday');addUnitAlias('day','d');addUnitAlias('weekday','e');addUnitAlias('isoWeekday','E');addUnitPriority('day',11);addUnitPriority('weekday',11);addUnitPriority('isoWeekday',11);addRegexToken('d',match1to2);addRegexToken('e',match1to2);addRegexToken('E',match1to2);addRegexToken('dd',function(isStrict,locale){return locale.weekdaysMinRegex(isStrict);});addRegexToken('ddd',function(isStrict,locale){return locale.weekdaysShortRegex(isStrict);});addRegexToken('dddd',function(isStrict,locale){return locale.weekdaysRegex(isStrict);});addWeekParseToken(['dd','ddd','dddd'],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday;}else{getParsingFlags(config).invalidWeekday=input;}});addWeekParseToken(['d','e','E'],function(input,week,config,token){week[token]=toInt(input);});function parseWeekday(input,locale){if(typeof input!=='string'){return input;}
if(!isNaN(input)){return parseInt(input,10);}
input=locale.weekdaysParse(input);if(typeof input==='number'){return input;}
return null;}
function parseIsoWeekday(input,locale){if(typeof input==='string'){return locale.weekdaysParse(input)%7||7;}
return isNaN(input)?null:input;}
function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n));}
var defaultLocaleWeekdays='Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[(m&&m!==true&&this._weekdays.isFormat.test(format))?'format':'standalone'];return(m===true)?shiftWeekdays(weekdays,this._week.dow):(m)?weekdays[m.day()]:weekdays;}
var defaultLocaleWeekdaysShort='Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');function localeWeekdaysShort(m){return(m===true)?shiftWeekdays(this._weekdaysShort,this._week.dow):(m)?this._weekdaysShort[m.day()]:this._weekdaysShort;}
var defaultLocaleWeekdaysMin='Su_Mo_Tu_We_Th_Fr_Sa'.split('_');function localeWeekdaysMin(m){return(m===true)?shiftWeekdays(this._weekdaysMin,this._week.dow):(m)?this._weekdaysMin[m.day()]:this._weekdaysMin;}
function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2000,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,'').toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,'').toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='dddd'){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}}else{if(format==='dddd'){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}}}
function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict);}
if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[];}
for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp('^'+this.weekdays(mom,'').replace('.','\\.?')+'$','i');this._shortWeekdaysParse[i]=new RegExp('^'+this.weekdaysShort(mom,'').replace('.','\\.?')+'$','i');this._minWeekdaysParse[i]=new RegExp('^'+this.weekdaysMin(mom,'').replace('.','\\.?')+'$','i');}
if(!this._weekdaysParse[i]){regex='^'+this.weekdays(mom,'')+'|^'+this.weekdaysShort(mom,'')+'|^'+this.weekdaysMin(mom,'');this._weekdaysParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='dddd'&&this._fullWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='ddd'&&this._shortWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='dd'&&this._minWeekdaysParse[i].test(weekdayName)){return i;}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i;}}}
function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,'d');}else{return day;}}
function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,'d');}
function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7);}else{return this.day()||7;}}
var defaultWeekdaysRegex=matchWord;function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysStrictRegex;}else{return this._weekdaysRegex;}}else{if(!hasOwnProp(this,'_weekdaysRegex')){this._weekdaysRegex=defaultWeekdaysRegex;}
return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex;}}
var defaultWeekdaysShortRegex=matchWord;function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysShortStrictRegex;}else{return this._weekdaysShortRegex;}}else{if(!hasOwnProp(this,'_weekdaysShortRegex')){this._weekdaysShortRegex=defaultWeekdaysShortRegex;}
return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;}}
var defaultWeekdaysMinRegex=matchWord;function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysMinStrictRegex;}else{return this._weekdaysMinRegex;}}else{if(!hasOwnProp(this,'_weekdaysMinRegex')){this._weekdaysMinRegex=defaultWeekdaysMinRegex;}
return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;}}
function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length;}
var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);minp=this.weekdaysMin(mom,'');shortp=this.weekdaysShort(mom,'');longp=this.weekdays(mom,'');minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp);}
minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<7;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);mixedPieces[i]=regexEscape(mixedPieces[i]);}
this._weekdaysRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._weekdaysShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');this._weekdaysMinStrictRegex=new RegExp('^('+minPieces.join('|')+')','i');}
function hFormat(){return this.hours()%12||12;}
function kFormat(){return this.hours()||24;}
addFormatToken('H',['HH',2],0,'hour');addFormatToken('h',['hh',2],0,hFormat);addFormatToken('k',['kk',2],0,kFormat);addFormatToken('hmm',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2);});addFormatToken('hmmss',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2);});addFormatToken('Hmm',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2);});addFormatToken('Hmmss',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2);});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase);});}
meridiem('a',true);meridiem('A',false);addUnitAlias('hour','h');addUnitPriority('hour',13);function matchMeridiem(isStrict,locale){return locale._meridiemParse;}
addRegexToken('a',matchMeridiem);addRegexToken('A',matchMeridiem);addRegexToken('H',match1to2);addRegexToken('h',match1to2);addRegexToken('k',match1to2);addRegexToken('HH',match1to2,match2);addRegexToken('hh',match1to2,match2);addRegexToken('kk',match1to2,match2);addRegexToken('hmm',match3to4);addRegexToken('hmmss',match5to6);addRegexToken('Hmm',match3to4);addRegexToken('Hmmss',match5to6);addParseToken(['H','HH'],HOUR);addParseToken(['k','kk'],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput;});addParseToken(['a','A'],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input;});addParseToken(['h','hh'],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true;});addParseToken('hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true;});addParseToken('hmmss',function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true;});addParseToken('Hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));});addParseToken('Hmmss',function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));});function localeIsPM(input){return((input+'').toLowerCase().charAt(0)==='p');}
var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM';}else{return isLower?'am':'AM';}}
var getSetHour=makeGetSet('Hours',true);var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={};var localeFamilies={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace('_','-'):key;}
function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split('-');j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split('-'):null;while(j>0){locale=loadLocale(split.slice(0,j).join('-'));if(locale){return locale;}
if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break;}
j--;}
i++;}
return globalLocale;}
function loadLocale(name){var oldLocale=null;if(!locales[name]&&('object'!=='undefined')&&module&&module.exports){try{oldLocale=globalLocale._abbr;var aliasedRequire=commonjsRequire;aliasedRequire('./locale/'+name);getSetGlobalLocale(oldLocale);}catch(e){}}
return locales[name];}
function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key);}
else{data=defineLocale(key,values);}
if(data){globalLocale=data;}
else{if((typeof console!=='undefined')&&console.warn){console.warn('Locale '+key+' not found. Did you forget to load it?');}}}
return globalLocale._abbr;}
function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple('defineLocaleOverride','use moment.updateLocale(localeName, config) to change '+'an existing locale. moment.defineLocale(localeName, '+'config) should only be used for creating a new locale '+'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');parentConfig=locales[name]._config;}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config;}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config;}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[];}
localeFamilies[config.parentLocale].push({name:name,config:config});return null;}}}
locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config);});}
getSetGlobalLocale(name);return locales[name];}else{delete locales[name];return null;}}
function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config;}
config=mergeConfigs(parentConfig,config);locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale;getSetGlobalLocale(name);}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;}else if(locales[name]!=null){delete locales[name];}}}
return locales[name];}
function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr;}
if(!key){return globalLocale;}
if(!isArray(key)){locale=loadLocale(key);if(locale){return locale;}
key=[key];}
return chooseLocale(key);}
function listLocales(){return keys(locales);}
function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||(a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0))?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE;}
if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK;}
if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY;}
getParsingFlags(m).overflow=overflow;}
return m;}
function defaults(a,b,c){if(a!=null){return a;}
if(b!=null){return b;}
return c;}
function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()];}
return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()];}
function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return;}
currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config);}
if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true;}
date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate();}
for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i];}
for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i];}
if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0;}
config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);}
if(config._nextDay){config._a[HOUR]=24;}
if(config._w&&typeof config._w.d!=='undefined'&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true;}}
function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true;}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true;}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true;}}else{weekday=dow;}}
if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true;}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true;}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear;}}
var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var tzRegex=/Z|[+-]\d\d(?::?\d\d)?/;var isoDates=[['YYYYYY-MM-DD',/[+-]\d{6}-\d\d-\d\d/],['YYYY-MM-DD',/\d{4}-\d\d-\d\d/],['GGGG-[W]WW-E',/\d{4}-W\d\d-\d/],['GGGG-[W]WW',/\d{4}-W\d\d/,false],['YYYY-DDD',/\d{4}-\d{3}/],['YYYY-MM',/\d{4}-\d\d/,false],['YYYYYYMMDD',/[+-]\d{10}/],['YYYYMMDD',/\d{8}/],['GGGG[W]WWE',/\d{4}W\d{3}/],['GGGG[W]WW',/\d{4}W\d{2}/,false],['YYYYDDD',/\d{7}/]];var isoTimes=[['HH:mm:ss.SSSS',/\d\d:\d\d:\d\d\.\d+/],['HH:mm:ss,SSSS',/\d\d:\d\d:\d\d,\d+/],['HH:mm:ss',/\d\d:\d\d:\d\d/],['HH:mm',/\d\d:\d\d/],['HHmmss.SSSS',/\d\d\d\d\d\d\.\d+/],['HHmmss,SSSS',/\d\d\d\d\d\d,\d+/],['HHmmss',/\d\d\d\d\d\d/],['HHmm',/\d\d\d\d/],['HH',/\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break;}}
if(dateFormat==null){config._isValid=false;return;}
if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||' ')+isoTimes[i][0];break;}}
if(timeFormat==null){config._isValid=false;return;}}
if(!allowTime&&timeFormat!=null){config._isValid=false;return;}
if(match[4]){if(tzRegex.exec(match[4])){tzFormat='Z';}else{config._isValid=false;return;}}
config._f=dateFormat+(timeFormat||'')+(tzFormat||'');configFromStringAndFormat(config);}else{config._isValid=false;}}
var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10));}
return result;}
function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2000+year;}else if(year<=999){return 1900+year;}
return year;}
function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g,' ').replace(/(\s\s+)/g,' ').replace(/^\s\s*/,'').replace(/\s\s*$/,'');}
function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false;}}
return true;}
var obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset];}else if(militaryOffset){return 0;}else{var hm=parseInt(numOffset,10);var m=hm%100,h=(hm-m)/100;return h*60+m;}}
function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i));if(match){var parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return;}
config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true;}else{config._isValid=false;}}
function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return;}
configFromISO(config);if(config._isValid===false){delete config._isValid;}else{return;}
configFromRFC2822(config);if(config._isValid===false){delete config._isValid;}else{return;}
hooks.createFromInputFallback(config);}
hooks.createFromInputFallback=deprecate('value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), '+'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are '+'discouraged and will be removed in an upcoming major release. Please refer to '+'http://momentjs.com/guides/#/warnings/js-date/ for more info.',function(config){config._d=new Date(config._i+(config._useUTC?' UTC':''));});hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return;}
if(config._f===hooks.RFC_2822){configFromRFC2822(config);return;}
config._a=[];getParsingFlags(config).empty=true;var string=''+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped);}
string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length;}
if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false;}
else{getParsingFlags(config).unusedTokens.push(token);}
addTimeToArrayFromToken(token,parsedInput,config);}
else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token);}}
getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string);}
if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined;}
getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config);}
function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour;}
if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem);}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12;}
if(!isPm&&hour===12){hour=0;}
return hour;}else{return hour;}}
function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return;}
for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC;}
tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue;}
currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig;}}
extend(config,bestMoment||tempConfig);}
function configFromObject(config){if(config._d){return;}
var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10);});configFromArray(config);}
function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,'d');res._nextDay=undefined;}
return res;}
function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||(format===undefined&&input==='')){return createInvalid({nullInput:true});}
if(typeof input==='string'){config._i=input=config._locale.preparse(input);}
if(isMoment(input)){return new Moment(checkOverflow(input));}else if(isDate(input)){config._d=input;}else if(isArray(format)){configFromStringAndArray(config);}else if(format){configFromStringAndFormat(config);}else{configFromInput(config);}
if(!isValid(config)){config._d=null;}
return config;}
function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now());}else if(isDate(input)){config._d=new Date(input.valueOf());}else if(typeof input==='string'){configFromString(config);}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10);});configFromArray(config);}else if(isObject(input)){configFromObject(config);}else if(isNumber(input)){config._d=new Date(input);}else{hooks.createFromInputFallback(config);}}
function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(locale===true||locale===false){strict=locale;locale=undefined;}
if((isObject(input)&&isObjectEmpty(input))||(isArray(input)&&input.length===0)){input=undefined;}
c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c);}
function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false);}
var prototypeMin=deprecate('moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other;}else{return createInvalid();}});var prototypeMax=deprecate('moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other;}else{return createInvalid();}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0];}
if(!moments.length){return createLocal();}
res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i];}}
return res;}
function min(){var args=[].slice.call(arguments,0);return pickBy('isBefore',args);}
function max(){var args=[].slice.call(arguments,0);return pickBy('isAfter',args);}
var now=function(){return Date.now?Date.now():+(new Date());};var ordering=['year','quarter','month','week','day','hour','minute','second','millisecond'];function isDurationValid(m){for(var key in m){if(!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false;}}
var unitHasDecimal=false;for(var i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false;}
if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true;}}}
return true;}
function isValid$1(){return this._isValid;}
function createInvalid$1(){return createDuration(NaN);}
function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+
seconds*1e3+
minutes*6e4+
hours*1000*60*60;this._days=+days+
weeks*7;this._months=+months+
quarters*3+
years*12;this._data={};this._locale=getLocale();this._bubble();}
function isDuration(obj){return obj instanceof Duration;}
function absRound(number){if(number<0){return Math.round(-1*number)*-1;}else{return Math.round(number);}}
function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign='+';if(offset<0){offset=-offset;sign='-';}
return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~(offset)%60,2);});}
offset('Z',':');offset('ZZ','');addRegexToken('Z',matchShortOffset);addRegexToken('ZZ',matchShortOffset);addParseToken(['Z','ZZ'],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input);});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||'').match(matcher);if(matches===null){return null;}
var chunk=matches[matches.length-1]||[];var parts=(chunk+'').match(chunkOffset)||['-',0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==='+'?minutes:-minutes;}
function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res;}else{return createLocal(input).local();}}
function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15;}
hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){if(typeof input==='string'){input=offsetFromString(matchShortOffset,input);if(input===null){return this;}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60;}
if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this);}
this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,'m');}
if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,'m'),1,false);}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null;}}
return this;}else{return this._isUTC?offset:getDateOffset(this);}}
function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=='string'){input=-input;}
this.utcOffset(input,keepLocalTime);return this;}else{return-this.utcOffset();}}
function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime);}
function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),'m');}}
return this;}
function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true);}else if(typeof this._i==='string'){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone);}
else{this.utcOffset(0,true);}}
return this;}
function hasAlignedHourOffset(input){if(!this.isValid()){return false;}
input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0;}
function isDaylightSavingTime(){return(this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset());}
function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted;}
var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0;}else{this._isDSTShifted=false;}
return this._isDSTShifted;}
function isLocal(){return this.isValid()?!this._isUTC:false;}
function isUtcOffset(){return this.isValid()?this._isUTC:false;}
function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false;}
var aspNetRegex=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months};}else if(isNumber(input)){duration={};if(key){duration[key]=input;}else{duration.milliseconds=input;}}else if(!!(match=aspNetRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1000))*sign};}else if(!!(match=isoRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)};}else if(duration==null){duration={};}else if(typeof duration==='object'&&('from'in duration||'to'in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months;}
ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,'_locale')){ret._locale=input._locale;}
return ret;}
createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(',','.'));return(isNaN(res)?0:res)*sign;}
function positiveMomentsDifference(base,other){var res={};res.months=other.month()-base.month()+
(other.year()-base.year())*12;if(base.clone().add(res.months,'M').isAfter(other)){--res.months;}
res.milliseconds=+other-+(base.clone().add(res.months,'M'));return res;}
function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0};}
other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other);}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months;}
return res;}
function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,'moment().'+name+'(period, number) is deprecated. Please use moment().'+name+'(number, period). '+'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');tmp=val;val=period;period=tmp;}
val=typeof val==='string'?+val:val;dur=createDuration(val,period);addSubtract(this,dur,direction);return this;};}
function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return;}
updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,'Month')+months*isAdding);}
if(days){set$1(mom,'Date',get(mom,'Date')+days*isAdding);}
if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding);}
if(updateOffset){hooks.updateOffset(mom,days||months);}}
var add=createAdder(1,'add');var subtract=createAdder(-1,'subtract');function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,'days',true);return diff<-6?'sameElse':diff<-1?'lastWeek':diff<0?'lastDay':diff<1?'sameDay':diff<2?'nextDay':diff<7?'nextWeek':'sameElse';}
function calendar$1(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf('day'),format=hooks.calendarFormat(this,sod)||'sameElse';var output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)));}
function clone(){return new Moment(this);}
function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()>localInput.valueOf();}else{return localInput.valueOf()<this.clone().startOf(units).valueOf();}}
function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()<localInput.valueOf();}else{return this.clone().endOf(units).valueOf()<localInput.valueOf();}}
function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false;}
inclusivity=inclusivity||'()';return(inclusivity[0]==='('?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===')'?this.isBefore(localTo,units):!this.isAfter(localTo,units));}
function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()===localInput.valueOf();}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf();}}
function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units);}
function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units);}
function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN;}
that=cloneWithOffset(input,this);if(!that.isValid()){return NaN;}
zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case'year':output=monthDiff(this,that)/12;break;case'month':output=monthDiff(this,that);break;case'quarter':output=monthDiff(this,that)/3;break;case'second':output=(this-that)/1e3;break;case'minute':output=(this-that)/6e4;break;case'hour':output=(this-that)/36e5;break;case'day':output=(this-that-zoneDelta)/864e5;break;case'week':output=(this-that-zoneDelta)/6048e5;break;default:output=this-that;}
return asFloat?output:absFloor(output);}
function monthDiff(a,b){var wholeMonthDiff=((b.year()-a.year())*12)+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,'months'),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,'months');adjust=(b-anchor)/(anchor-anchor2);}else{anchor2=a.clone().add(wholeMonthDiff+1,'months');adjust=(b-anchor)/(anchor2-anchor);}
return-(wholeMonthDiff+adjust)||0;}
hooks.defaultFormat='YYYY-MM-DDTHH:mm:ssZ';hooks.defaultFormatUtc='YYYY-MM-DDTHH:mm:ss[Z]';function toString(){return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');}
function toISOString(keepOffset){if(!this.isValid()){return null;}
var utc=keepOffset!==true;var m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]':'YYYYYY-MM-DD[T]HH:mm:ss.SSSZ');}
if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString();}else{return new Date(this.valueOf()+this.utcOffset()*60*1000).toISOString().replace('Z',formatMoment(m,'Z'));}}
return formatMoment(m,utc?'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]':'YYYY-MM-DD[T]HH:mm:ss.SSSZ');}
function inspect(){if(!this.isValid()){return'moment.invalid(/* '+this._i+' */)';}
var func='moment';var zone='';if(!this.isLocal()){func=this.utcOffset()===0?'moment.utc':'moment.parseZone';zone='Z';}
var prefix='['+func+'("]';var year=(0<=this.year()&&this.year()<=9999)?'YYYY':'YYYYYY';var datetime='-MM-DD[T]HH:mm:ss.SSS';var suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix);}
function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat;}
var output=formatMoment(this,inputString);return this.localeData().postformat(output);}
function from(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix);}
function to(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix);}
function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr;}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData;}
return this;}}
var lang=deprecate('moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',function(key){if(key===undefined){return this.localeData();}else{return this.locale(key);}});function localeData(){return this._locale;}
var MS_PER_SECOND=1000;var MS_PER_MINUTE=60*MS_PER_SECOND;var MS_PER_HOUR=60*MS_PER_MINUTE;var MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor;}
function localStartOfDate(y,m,d){if(y<100&&y>=0){return new Date(y+400,m,d)-MS_PER_400_YEARS;}else{return new Date(y,m,d).valueOf();}}
function utcStartOfDate(y,m,d){if(y<100&&y>=0){return Date.UTC(y+400,m,d)-MS_PER_400_YEARS;}else{return Date.UTC(y,m,d);}}
function startOf(units){var time;units=normalizeUnits(units);if(units===undefined||units==='millisecond'||!this.isValid()){return this;}
var startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case'year':time=startOfDate(this.year(),0,1);break;case'quarter':time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case'month':time=startOfDate(this.year(),this.month(),1);break;case'week':time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case'isoWeek':time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case'day':case'date':time=startOfDate(this.year(),this.month(),this.date());break;case'hour':time=this._d.valueOf();time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case'minute':time=this._d.valueOf();time-=mod$1(time,MS_PER_MINUTE);break;case'second':time=this._d.valueOf();time-=mod$1(time,MS_PER_SECOND);break;}
this._d.setTime(time);hooks.updateOffset(this,true);return this;}
function endOf(units){var time;units=normalizeUnits(units);if(units===undefined||units==='millisecond'||!this.isValid()){return this;}
var startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case'year':time=startOfDate(this.year()+1,0,1)-1;break;case'quarter':time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case'month':time=startOfDate(this.year(),this.month()+1,1)-1;break;case'week':time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case'isoWeek':time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case'day':case'date':time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case'hour':time=this._d.valueOf();time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case'minute':time=this._d.valueOf();time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case'second':time=this._d.valueOf();time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1;break;}
this._d.setTime(time);hooks.updateOffset(this,true);return this;}
function valueOf(){return this._d.valueOf()-((this._offset||0)*60000);}
function unix(){return Math.floor(this.valueOf()/1000);}
function toDate(){return new Date(this.valueOf());}
function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()];}
function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()};}
function toJSON(){return this.isValid()?this.toISOString():null;}
function isValid$2(){return isValid(this);}
function parsingFlags(){return extend({},getParsingFlags(this));}
function invalidAt(){return getParsingFlags(this).overflow;}
function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict};}
addFormatToken(0,['gg',2],0,function(){return this.weekYear()%100;});addFormatToken(0,['GG',2],0,function(){return this.isoWeekYear()%100;});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter);}
addWeekYearFormatToken('gggg','weekYear');addWeekYearFormatToken('ggggg','weekYear');addWeekYearFormatToken('GGGG','isoWeekYear');addWeekYearFormatToken('GGGGG','isoWeekYear');addUnitAlias('weekYear','gg');addUnitAlias('isoWeekYear','GG');addUnitPriority('weekYear',1);addUnitPriority('isoWeekYear',1);addRegexToken('G',matchSigned);addRegexToken('g',matchSigned);addRegexToken('GG',match1to2,match2);addRegexToken('gg',match1to2,match2);addRegexToken('GGGG',match1to4,match4);addRegexToken('gggg',match1to4,match4);addRegexToken('GGGGG',match1to6,match6);addRegexToken('ggggg',match1to6,match6);addWeekParseToken(['gggg','ggggg','GGGG','GGGGG'],function(input,week,config,token){week[token.substr(0,2)]=toInt(input);});addWeekParseToken(['gg','GG'],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input);});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy);}
function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4);}
function getISOWeeksInYear(){return weeksInYear(this.year(),1,4);}
function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy);}
function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year;}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget;}
return setWeekAll.call(this,input,week,weekday,dow,doy);}}
function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this;}
addFormatToken('Q',0,'Qo','quarter');addUnitAlias('quarter','Q');addUnitPriority('quarter',7);addRegexToken('Q',match1);addParseToken('Q',function(input,array){array[MONTH]=(toInt(input)-1)*3;});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3);}
addFormatToken('D',['DD',2],'Do','date');addUnitAlias('date','D');addUnitPriority('date',9);addRegexToken('D',match1to2);addRegexToken('DD',match1to2,match2);addRegexToken('Do',function(isStrict,locale){return isStrict?(locale._dayOfMonthOrdinalParse||locale._ordinalParse):locale._dayOfMonthOrdinalParseLenient;});addParseToken(['D','DD'],DATE);addParseToken('Do',function(input,array){array[DATE]=toInt(input.match(match1to2)[0]);});var getSetDayOfMonth=makeGetSet('Date',true);addFormatToken('DDD',['DDDD',3],'DDDo','dayOfYear');addUnitAlias('dayOfYear','DDD');addUnitPriority('dayOfYear',4);addRegexToken('DDD',match1to3);addRegexToken('DDDD',match3);addParseToken(['DDD','DDDD'],function(input,array,config){config._dayOfYear=toInt(input);});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf('day')-this.clone().startOf('year'))/864e5)+1;return input==null?dayOfYear:this.add((input-dayOfYear),'d');}
addFormatToken('m',['mm',2],0,'minute');addUnitAlias('minute','m');addUnitPriority('minute',14);addRegexToken('m',match1to2);addRegexToken('mm',match1to2,match2);addParseToken(['m','mm'],MINUTE);var getSetMinute=makeGetSet('Minutes',false);addFormatToken('s',['ss',2],0,'second');addUnitAlias('second','s');addUnitPriority('second',15);addRegexToken('s',match1to2);addRegexToken('ss',match1to2,match2);addParseToken(['s','ss'],SECOND);var getSetSecond=makeGetSet('Seconds',false);addFormatToken('S',0,0,function(){return~~(this.millisecond()/100);});addFormatToken(0,['SS',2],0,function(){return~~(this.millisecond()/10);});addFormatToken(0,['SSS',3],0,'millisecond');addFormatToken(0,['SSSS',4],0,function(){return this.millisecond()*10;});addFormatToken(0,['SSSSS',5],0,function(){return this.millisecond()*100;});addFormatToken(0,['SSSSSS',6],0,function(){return this.millisecond()*1000;});addFormatToken(0,['SSSSSSS',7],0,function(){return this.millisecond()*10000;});addFormatToken(0,['SSSSSSSS',8],0,function(){return this.millisecond()*100000;});addFormatToken(0,['SSSSSSSSS',9],0,function(){return this.millisecond()*1000000;});addUnitAlias('millisecond','ms');addUnitPriority('millisecond',16);addRegexToken('S',match1to3,match1);addRegexToken('SS',match1to3,match2);addRegexToken('SSS',match1to3,match3);var token;for(token='SSSS';token.length<=9;token+='S'){addRegexToken(token,matchUnsigned);}
function parseMs(input,array){array[MILLISECOND]=toInt(('0.'+input)*1000);}
for(token='S';token.length<=9;token+='S'){addParseToken(token,parseMs);}
var getSetMillisecond=makeGetSet('Milliseconds',false);addFormatToken('z',0,0,'zoneAbbr');addFormatToken('zz',0,0,'zoneName');function getZoneAbbr(){return this._isUTC?'UTC':'';}
function getZoneName(){return this._isUTC?'Coordinated Universal Time':'';}
var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate('dates accessor is deprecated. Use date instead.',getSetDayOfMonth);proto.months=deprecate('months accessor is deprecated. Use month instead',getSetMonth);proto.years=deprecate('years accessor is deprecated. Use year instead',getSetYear);proto.zone=deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/',getSetZone);proto.isDSTShifted=deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information',isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1000);}
function createInZone(){return createLocal.apply(null,arguments).parseZone();}
function preParsePostFormat(string){return string;}
var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale();var utc=createUTC().set(setter,index);return locale[field](utc,format);}
function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined;}
format=format||'';if(index!=null){return get$1(format,index,field,'month');}
var i;var out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,'month');}
return out;}
function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==='boolean'){if(isNumber(format)){index=format;format=undefined;}
format=format||'';}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined;}
format=format||'';}
var locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(index!=null){return get$1(format,(index+shift)%7,field,'day');}
var i;var out=[];for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,'day');}
return out;}
function listMonths(format,index){return listMonthsImpl(format,index,'months');}
function listMonthsShort(format,index){return listMonthsImpl(format,index,'monthsShort');}
function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdays');}
function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysShort');}
function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysMin');}
getSetGlobalLocale('en',{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th';return number+output;}});hooks.lang=deprecate('moment.lang is deprecated. Use moment.locale instead.',getSetGlobalLocale);hooks.langData=deprecate('moment.langData is deprecated. Use moment.localeData instead.',getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this;}
function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble();}
function add$1(input,value){return addSubtract$1(this,input,value,1);}
function subtract$1(input,value){return addSubtract$1(this,input,value,-1);}
function absCeil(number){if(number<0){return Math.floor(number);}else{return Math.ceil(number);}}
function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years,monthsFromDays;if(!((milliseconds>=0&&days>=0&&months>=0)||(milliseconds<=0&&days<=0&&months<=0))){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0;}
data.milliseconds=milliseconds%1000;seconds=absFloor(milliseconds/1000);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this;}
function daysToMonths(days){return days*4800/146097;}
function monthsToDays(months){return months*146097/4800;}
function as(units){if(!this.isValid()){return NaN;}
var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==='month'||units==='quarter'||units==='year'){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);switch(units){case'month':return months;case'quarter':return months/3;case'year':return months/12;}}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case'week':return days/7+milliseconds/6048e5;case'day':return days+milliseconds/864e5;case'hour':return days*24+milliseconds/36e5;case'minute':return days*1440+milliseconds/6e4;case'second':return days*86400+milliseconds/1000;case'millisecond':return Math.floor(days*864e5)+milliseconds;default:throw new Error('Unknown unit '+units);}}}
function valueOf$1(){if(!this.isValid()){return NaN;}
return(this._milliseconds+
this._days*864e5+
(this._months%12)*2592e6+
toInt(this._months/12)*31536e6);}
function makeAs(alias){return function(){return this.as(alias);};}
var asMilliseconds=makeAs('ms');var asSeconds=makeAs('s');var asMinutes=makeAs('m');var asHours=makeAs('h');var asDays=makeAs('d');var asWeeks=makeAs('w');var asMonths=makeAs('M');var asQuarters=makeAs('Q');var asYears=makeAs('y');function clone$1(){return createDuration(this);}
function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+'s']():NaN;}
function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN;};}
var milliseconds=makeGetter('milliseconds');var seconds=makeGetter('seconds');var minutes=makeGetter('minutes');var hours=makeGetter('hours');var days=makeGetter('days');var months=makeGetter('months');var years=makeGetter('years');function weeks(){return absFloor(this.days()/7);}
var round=Math.round;var thresholds={ss:44,s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture);}
function relativeTime$1(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs();var seconds=round(duration.as('s'));var minutes=round(duration.as('m'));var hours=round(duration.as('h'));var days=round(duration.as('d'));var months=round(duration.as('M'));var years=round(duration.as('y'));var a=seconds<=thresholds.ss&&['s',seconds]||seconds<thresholds.s&&['ss',seconds]||minutes<=1&&['m']||minutes<thresholds.m&&['mm',minutes]||hours<=1&&['h']||hours<thresholds.h&&['hh',hours]||days<=1&&['d']||days<thresholds.d&&['dd',days]||months<=1&&['M']||months<thresholds.M&&['MM',months]||years<=1&&['y']||['yy',years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a);}
function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round;}
if(typeof(roundingFunction)==='function'){round=roundingFunction;return true;}
return false;}
function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false;}
if(limit===undefined){return thresholds[threshold];}
thresholds[threshold]=limit;if(threshold==='s'){thresholds.ss=limit-1;}
return true;}
function humanize(withSuffix){if(!this.isValid()){return this.localeData().invalidDate();}
var locale=this.localeData();var output=relativeTime$1(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output);}
return locale.postformat(output);}
var abs$1=Math.abs;function sign(x){return((x>0)-(x<0))||+x;}
function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate();}
var seconds=abs$1(this._milliseconds)/1000;var days=abs$1(this._days);var months=abs$1(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds?seconds.toFixed(3).replace(/\.?0+$/,''):'';var total=this.asSeconds();if(!total){return'P0D';}
var totalSign=total<0?'-':'';var ymSign=sign(this._months)!==sign(total)?'-':'';var daysSign=sign(this._days)!==sign(total)?'-':'';var hmsSign=sign(this._milliseconds)!==sign(total)?'-':'';return totalSign+'P'+
(Y?ymSign+Y+'Y':'')+
(M?ymSign+M+'M':'')+
(D?daysSign+D+'D':'')+
((h||m||s)?'T':'')+
(h?hmsSign+h+'H':'')+
(m?hmsSign+m+'M':'')+
(s?hmsSign+s+'S':'');}
var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)',toISOString$1);proto$2.lang=lang;addFormatToken('X',0,0,'unix');addFormatToken('x',0,0,'valueOf');addRegexToken('x',matchSigned);addRegexToken('X',matchTimestamp);addParseToken('X',function(input,array,config){config._d=new Date(parseFloat(input,10)*1000);});addParseToken('x',function(input,array,config){config._d=new Date(toInt(input));});hooks.version='2.24.0';setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:'YYYY-MM-DDTHH:mm',DATETIME_LOCAL_SECONDS:'YYYY-MM-DDTHH:mm:ss',DATETIME_LOCAL_MS:'YYYY-MM-DDTHH:mm:ss.SSS',DATE:'YYYY-MM-DD',TIME:'HH:mm',TIME_SECONDS:'HH:mm:ss',TIME_MS:'HH:mm:ss.SSS',WEEK:'GGGG-[W]WW',MONTH:'YYYY-MM'};return hooks;})));});var FORMATS={datetime:'MMM D, YYYY, h:mm:ss a',millisecond:'h:mm:ss.SSS a',second:'h:mm:ss a',minute:'h:mm a',hour:'hA',day:'MMM D',week:'ll',month:'MMM YYYY',quarter:'[Q]Q - YYYY',year:'YYYY'};core_adapters._date.override(typeof moment==='function'?{_id:'moment',formats:function(){return FORMATS;},parse:function(value,format){if(typeof value==='string'&&typeof format==='string'){value=moment(value,format);}else if(!(value instanceof moment)){value=moment(value);}
return value.isValid()?value.valueOf():null;},format:function(time,format){return moment(time).format(format);},add:function(time,amount,unit){return moment(time).add(amount,unit).valueOf();},diff:function(max,min,unit){return moment.duration(moment(max).diff(moment(min))).as(unit);},startOf:function(time,unit,weekday){time=moment(time);if(unit==='isoWeek'){return time.isoWeekday(weekday).valueOf();}
return time.startOf(unit).valueOf();},endOf:function(time,unit){return moment(time).endOf(unit).valueOf();},_create:function(time){return moment(time);},}:{});core_defaults._set('global',{plugins:{filler:{propagate:true}}});var mappers={dataset:function(source){var index=source.fill;var chart=source.chart;var meta=chart.getDatasetMeta(index);var visible=meta&&chart.isDatasetVisible(index);var points=(visible&&meta.dataset._children)||[];var length=points.length||0;return!length?null:function(point,i){return(i<length&&points[i]._view)||null;};},boundary:function(source){var boundary=source.boundary;var x=boundary?boundary.x:null;var y=boundary?boundary.y:null;return function(point){return{x:x===null?point.x:x,y:y===null?point.y:y,};};}};function decodeFill(el,index,count){var model=el._model||{};var fill=model.fill;var target;if(fill===undefined){fill=!!model.backgroundColor;}
if(fill===false||fill===null){return false;}
if(fill===true){return'origin';}
target=parseFloat(fill,10);if(isFinite(target)&&Math.floor(target)===target){if(fill[0]==='-'||fill[0]==='+'){target=index+target;}
if(target===index||target<0||target>=count){return false;}
return target;}
switch(fill){case'bottom':return'start';case'top':return'end';case'zero':return'origin';case'origin':case'start':case'end':return fill;default:return false;}}
function computeBoundary(source){var model=source.el._model||{};var scale=source.el._scale||{};var fill=source.fill;var target=null;var horizontal;if(isFinite(fill)){return null;}
if(fill==='start'){target=model.scaleBottom===undefined?scale.bottom:model.scaleBottom;}else if(fill==='end'){target=model.scaleTop===undefined?scale.top:model.scaleTop;}else if(model.scaleZero!==undefined){target=model.scaleZero;}else if(scale.getBasePosition){target=scale.getBasePosition();}else if(scale.getBasePixel){target=scale.getBasePixel();}
if(target!==undefined&&target!==null){if(target.x!==undefined&&target.y!==undefined){return target;}
if(helpers$1.isFinite(target)){horizontal=scale.isHorizontal();return{x:horizontal?target:null,y:horizontal?null:target};}}
return null;}
function resolveTarget(sources,index,propagate){var source=sources[index];var fill=source.fill;var visited=[index];var target;if(!propagate){return fill;}
while(fill!==false&&visited.indexOf(fill)===-1){if(!isFinite(fill)){return fill;}
target=sources[fill];if(!target){return false;}
if(target.visible){return fill;}
visited.push(fill);fill=target.fill;}
return false;}
function createMapper(source){var fill=source.fill;var type='dataset';if(fill===false){return null;}
if(!isFinite(fill)){type='boundary';}
return mappers[type](source);}
function isDrawable(point){return point&&!point.skip;}
function drawArea(ctx,curve0,curve1,len0,len1){var i;if(!len0||!len1){return;}
ctx.moveTo(curve0[0].x,curve0[0].y);for(i=1;i<len0;++i){helpers$1.canvas.lineTo(ctx,curve0[i-1],curve0[i]);}
ctx.lineTo(curve1[len1-1].x,curve1[len1-1].y);for(i=len1-1;i>0;--i){helpers$1.canvas.lineTo(ctx,curve1[i],curve1[i-1],true);}}
function doFill(ctx,points,mapper,view,color,loop){var count=points.length;var span=view.spanGaps;var curve0=[];var curve1=[];var len0=0;var len1=0;var i,ilen,index,p0,p1,d0,d1;ctx.beginPath();for(i=0,ilen=(count+!!loop);i<ilen;++i){index=i%count;p0=points[index]._view;p1=mapper(p0,index,view);d0=isDrawable(p0);d1=isDrawable(p1);if(d0&&d1){len0=curve0.push(p0);len1=curve1.push(p1);}else if(len0&&len1){if(!span){drawArea(ctx,curve0,curve1,len0,len1);len0=len1=0;curve0=[];curve1=[];}else{if(d0){curve0.push(p0);}
if(d1){curve1.push(p1);}}}}
drawArea(ctx,curve0,curve1,len0,len1);ctx.closePath();ctx.fillStyle=color;ctx.fill();}
var plugin_filler={id:'filler',afterDatasetsUpdate:function(chart,options){var count=(chart.data.datasets||[]).length;var propagate=options.propagate;var sources=[];var meta,i,el,source;for(i=0;i<count;++i){meta=chart.getDatasetMeta(i);el=meta.dataset;source=null;if(el&&el._model&&el instanceof elements.Line){source={visible:chart.isDatasetVisible(i),fill:decodeFill(el,i,count),chart:chart,el:el};}
meta.$filler=source;sources.push(source);}
for(i=0;i<count;++i){source=sources[i];if(!source){continue;}
source.fill=resolveTarget(sources,i,propagate);source.boundary=computeBoundary(source);source.mapper=createMapper(source);}},beforeDatasetDraw:function(chart,args){var meta=args.meta.$filler;if(!meta){return;}
var ctx=chart.ctx;var el=meta.el;var view=el._view;var points=el._children||[];var mapper=meta.mapper;var color=view.backgroundColor||core_defaults.global.defaultColor;if(mapper&&color&&points.length){helpers$1.canvas.clipArea(ctx,chart.chartArea);doFill(ctx,points,mapper,view,color,el._loop);helpers$1.canvas.unclipArea(ctx);}}};var noop$1=helpers$1.noop;var valueOrDefault$d=helpers$1.valueOrDefault;core_defaults._set('global',{legend:{display:true,position:'top',fullWidth:true,reverse:false,weight:1000,onClick:function(e,legendItem){var index=legendItem.datasetIndex;var ci=this.chart;var meta=ci.getDatasetMeta(index);meta.hidden=meta.hidden===null?!ci.data.datasets[index].hidden:null;ci.update();},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(chart){var data=chart.data;return helpers$1.isArray(data.datasets)?data.datasets.map(function(dataset,i){return{text:dataset.label,fillStyle:(!helpers$1.isArray(dataset.backgroundColor)?dataset.backgroundColor:dataset.backgroundColor[0]),hidden:!chart.isDatasetVisible(i),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset.borderColor,pointStyle:dataset.pointStyle,datasetIndex:i};},this):[];}}},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');for(var i=0;i<chart.data.datasets.length;i++){text.push('<li><span style="background-color:'+chart.data.datasets[i].backgroundColor+'"></span>');if(chart.data.datasets[i].label){text.push(chart.data.datasets[i].label);}
text.push('</li>');}
text.push('</ul>');return text.join('');}});function getBoxWidth(labelOpts,fontSize){return labelOpts.usePointStyle&&labelOpts.boxWidth>fontSize?fontSize:labelOpts.boxWidth;}
var Legend=core_element.extend({initialize:function(config){helpers$1.extend(this,config);this.legendHitBoxes=[];this._hoveredItem=null;this.doughnutMode=false;},beforeUpdate:noop$1,update:function(maxWidth,maxHeight,margins){var me=this;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=margins;me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeBuildLabels();me.buildLabels();me.afterBuildLabels();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize;},afterUpdate:noop$1,beforeSetDimensions:noop$1,setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width;}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height;}
me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;me.minSize={width:0,height:0};},afterSetDimensions:noop$1,beforeBuildLabels:noop$1,buildLabels:function(){var me=this;var labelOpts=me.options.labels||{};var legendItems=helpers$1.callback(labelOpts.generateLabels,[me.chart],me)||[];if(labelOpts.filter){legendItems=legendItems.filter(function(item){return labelOpts.filter(item,me.chart.data);});}
if(me.options.reverse){legendItems.reverse();}
me.legendItems=legendItems;},afterBuildLabels:noop$1,beforeFit:noop$1,fit:function(){var me=this;var opts=me.options;var labelOpts=opts.labels;var display=opts.display;var ctx=me.ctx;var labelFont=helpers$1.options._parseFont(labelOpts);var fontSize=labelFont.size;var hitboxes=me.legendHitBoxes=[];var minSize=me.minSize;var isHorizontal=me.isHorizontal();if(isHorizontal){minSize.width=me.maxWidth;minSize.height=display?10:0;}else{minSize.width=display?10:0;minSize.height=me.maxHeight;}
if(display){ctx.font=labelFont.string;if(isHorizontal){var lineWidths=me.lineWidths=[0];var totalHeight=0;ctx.textAlign='left';ctx.textBaseline='top';helpers$1.each(me.legendItems,function(legendItem,i){var boxWidth=getBoxWidth(labelOpts,fontSize);var width=boxWidth+(fontSize/2)+ctx.measureText(legendItem.text).width;if(i===0||lineWidths[lineWidths.length-1]+width+labelOpts.padding>minSize.width){totalHeight+=fontSize+labelOpts.padding;lineWidths[lineWidths.length-(i>0?0:1)]=labelOpts.padding;}
hitboxes[i]={left:0,top:0,width:width,height:fontSize};lineWidths[lineWidths.length-1]+=width+labelOpts.padding;});minSize.height+=totalHeight;}else{var vPadding=labelOpts.padding;var columnWidths=me.columnWidths=[];var totalWidth=labelOpts.padding;var currentColWidth=0;var currentColHeight=0;var itemHeight=fontSize+vPadding;helpers$1.each(me.legendItems,function(legendItem,i){var boxWidth=getBoxWidth(labelOpts,fontSize);var itemWidth=boxWidth+(fontSize/2)+ctx.measureText(legendItem.text).width;if(i>0&&currentColHeight+itemHeight>minSize.height-vPadding){totalWidth+=currentColWidth+labelOpts.padding;columnWidths.push(currentColWidth);currentColWidth=0;currentColHeight=0;}
currentColWidth=Math.max(currentColWidth,itemWidth);currentColHeight+=itemHeight;hitboxes[i]={left:0,top:0,width:itemWidth,height:fontSize};});totalWidth+=currentColWidth;columnWidths.push(currentColWidth);minSize.width+=totalWidth;}}
me.width=minSize.width;me.height=minSize.height;},afterFit:noop$1,isHorizontal:function(){return this.options.position==='top'||this.options.position==='bottom';},draw:function(){var me=this;var opts=me.options;var labelOpts=opts.labels;var globalDefaults=core_defaults.global;var defaultColor=globalDefaults.defaultColor;var lineDefault=globalDefaults.elements.line;var legendWidth=me.width;var lineWidths=me.lineWidths;if(opts.display){var ctx=me.ctx;var fontColor=valueOrDefault$d(labelOpts.fontColor,globalDefaults.defaultFontColor);var labelFont=helpers$1.options._parseFont(labelOpts);var fontSize=labelFont.size;var cursor;ctx.textAlign='left';ctx.textBaseline='middle';ctx.lineWidth=0.5;ctx.strokeStyle=fontColor;ctx.fillStyle=fontColor;ctx.font=labelFont.string;var boxWidth=getBoxWidth(labelOpts,fontSize);var hitboxes=me.legendHitBoxes;var drawLegendBox=function(x,y,legendItem){if(isNaN(boxWidth)||boxWidth<=0){return;}
ctx.save();var lineWidth=valueOrDefault$d(legendItem.lineWidth,lineDefault.borderWidth);ctx.fillStyle=valueOrDefault$d(legendItem.fillStyle,defaultColor);ctx.lineCap=valueOrDefault$d(legendItem.lineCap,lineDefault.borderCapStyle);ctx.lineDashOffset=valueOrDefault$d(legendItem.lineDashOffset,lineDefault.borderDashOffset);ctx.lineJoin=valueOrDefault$d(legendItem.lineJoin,lineDefault.borderJoinStyle);ctx.lineWidth=lineWidth;ctx.strokeStyle=valueOrDefault$d(legendItem.strokeStyle,defaultColor);if(ctx.setLineDash){ctx.setLineDash(valueOrDefault$d(legendItem.lineDash,lineDefault.borderDash));}
if(opts.labels&&opts.labels.usePointStyle){var radius=boxWidth*Math.SQRT2/2;var centerX=x+boxWidth/2;var centerY=y+fontSize/2;helpers$1.canvas.drawPoint(ctx,legendItem.pointStyle,radius,centerX,centerY);}else{if(lineWidth!==0){ctx.strokeRect(x,y,boxWidth,fontSize);}
ctx.fillRect(x,y,boxWidth,fontSize);}
ctx.restore();};var fillText=function(x,y,legendItem,textWidth){var halfFontSize=fontSize/2;var xLeft=boxWidth+halfFontSize+x;var yMiddle=y+halfFontSize;ctx.fillText(legendItem.text,xLeft,yMiddle);if(legendItem.hidden){ctx.beginPath();ctx.lineWidth=2;ctx.moveTo(xLeft,yMiddle);ctx.lineTo(xLeft+textWidth,yMiddle);ctx.stroke();}};var isHorizontal=me.isHorizontal();if(isHorizontal){cursor={x:me.left+((legendWidth-lineWidths[0])/2)+labelOpts.padding,y:me.top+labelOpts.padding,line:0};}else{cursor={x:me.left+labelOpts.padding,y:me.top+labelOpts.padding,line:0};}
var itemHeight=fontSize+labelOpts.padding;helpers$1.each(me.legendItems,function(legendItem,i){var textWidth=ctx.measureText(legendItem.text).width;var width=boxWidth+(fontSize/2)+textWidth;var x=cursor.x;var y=cursor.y;if(isHorizontal){if(i>0&&x+width+labelOpts.padding>me.left+me.minSize.width){y=cursor.y+=itemHeight;cursor.line++;x=cursor.x=me.left+((legendWidth-lineWidths[cursor.line])/2)+labelOpts.padding;}}else if(i>0&&y+itemHeight>me.top+me.minSize.height){x=cursor.x=x+me.columnWidths[cursor.line]+labelOpts.padding;y=cursor.y=me.top+labelOpts.padding;cursor.line++;}
drawLegendBox(x,y,legendItem);hitboxes[i].left=x;hitboxes[i].top=y;fillText(x,y,legendItem,textWidth);if(isHorizontal){cursor.x+=width+labelOpts.padding;}else{cursor.y+=itemHeight;}});}},_getLegendItemAt:function(x,y){var me=this;var i,hitBox,lh;if(x>=me.left&&x<=me.right&&y>=me.top&&y<=me.bottom){lh=me.legendHitBoxes;for(i=0;i<lh.length;++i){hitBox=lh[i];if(x>=hitBox.left&&x<=hitBox.left+hitBox.width&&y>=hitBox.top&&y<=hitBox.top+hitBox.height){return me.legendItems[i];}}}
return null;},handleEvent:function(e){var me=this;var opts=me.options;var type=e.type==='mouseup'?'click':e.type;var hoveredItem;if(type==='mousemove'){if(!opts.onHover&&!opts.onLeave){return;}}else if(type==='click'){if(!opts.onClick){return;}}else{return;}
hoveredItem=me._getLegendItemAt(e.x,e.y);if(type==='click'){if(hoveredItem&&opts.onClick){opts.onClick.call(me,e.native,hoveredItem);}}else{if(opts.onLeave&&hoveredItem!==me._hoveredItem){if(me._hoveredItem){opts.onLeave.call(me,e.native,me._hoveredItem);}
me._hoveredItem=hoveredItem;}
if(opts.onHover&&hoveredItem){opts.onHover.call(me,e.native,hoveredItem);}}}});function createNewLegendAndAttach(chart,legendOpts){var legend=new Legend({ctx:chart.ctx,options:legendOpts,chart:chart});core_layouts.configure(chart,legend,legendOpts);core_layouts.addBox(chart,legend);chart.legend=legend;}
var plugin_legend={id:'legend',_element:Legend,beforeInit:function(chart){var legendOpts=chart.options.legend;if(legendOpts){createNewLegendAndAttach(chart,legendOpts);}},beforeUpdate:function(chart){var legendOpts=chart.options.legend;var legend=chart.legend;if(legendOpts){helpers$1.mergeIf(legendOpts,core_defaults.global.legend);if(legend){core_layouts.configure(chart,legend,legendOpts);legend.options=legendOpts;}else{createNewLegendAndAttach(chart,legendOpts);}}else if(legend){core_layouts.removeBox(chart,legend);delete chart.legend;}},afterEvent:function(chart,e){var legend=chart.legend;if(legend){legend.handleEvent(e);}}};var noop$2=helpers$1.noop;core_defaults._set('global',{title:{display:false,fontStyle:'bold',fullWidth:true,padding:10,position:'top',text:'',weight:2000}});var Title=core_element.extend({initialize:function(config){var me=this;helpers$1.extend(me,config);me.legendHitBoxes=[];},beforeUpdate:noop$2,update:function(maxWidth,maxHeight,margins){var me=this;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=margins;me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeBuildLabels();me.buildLabels();me.afterBuildLabels();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize;},afterUpdate:noop$2,beforeSetDimensions:noop$2,setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width;}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height;}
me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;me.minSize={width:0,height:0};},afterSetDimensions:noop$2,beforeBuildLabels:noop$2,buildLabels:noop$2,afterBuildLabels:noop$2,beforeFit:noop$2,fit:function(){var me=this;var opts=me.options;var display=opts.display;var minSize=me.minSize;var lineCount=helpers$1.isArray(opts.text)?opts.text.length:1;var fontOpts=helpers$1.options._parseFont(opts);var textSize=display?(lineCount*fontOpts.lineHeight)+(opts.padding*2):0;if(me.isHorizontal()){minSize.width=me.maxWidth;minSize.height=textSize;}else{minSize.width=textSize;minSize.height=me.maxHeight;}
me.width=minSize.width;me.height=minSize.height;},afterFit:noop$2,isHorizontal:function(){var pos=this.options.position;return pos==='top'||pos==='bottom';},draw:function(){var me=this;var ctx=me.ctx;var opts=me.options;if(opts.display){var fontOpts=helpers$1.options._parseFont(opts);var lineHeight=fontOpts.lineHeight;var offset=lineHeight/2+opts.padding;var rotation=0;var top=me.top;var left=me.left;var bottom=me.bottom;var right=me.right;var maxWidth,titleX,titleY;ctx.fillStyle=helpers$1.valueOrDefault(opts.fontColor,core_defaults.global.defaultFontColor);ctx.font=fontOpts.string;if(me.isHorizontal()){titleX=left+((right-left)/2);titleY=top+offset;maxWidth=right-left;}else{titleX=opts.position==='left'?left+offset:right-offset;titleY=top+((bottom-top)/2);maxWidth=bottom-top;rotation=Math.PI*(opts.position==='left'?-0.5:0.5);}
ctx.save();ctx.translate(titleX,titleY);ctx.rotate(rotation);ctx.textAlign='center';ctx.textBaseline='middle';var text=opts.text;if(helpers$1.isArray(text)){var y=0;for(var i=0;i<text.length;++i){ctx.fillText(text[i],0,y,maxWidth);y+=lineHeight;}}else{ctx.fillText(text,0,0,maxWidth);}
ctx.restore();}}});function createNewTitleBlockAndAttach(chart,titleOpts){var title=new Title({ctx:chart.ctx,options:titleOpts,chart:chart});core_layouts.configure(chart,title,titleOpts);core_layouts.addBox(chart,title);chart.titleBlock=title;}
var plugin_title={id:'title',_element:Title,beforeInit:function(chart){var titleOpts=chart.options.title;if(titleOpts){createNewTitleBlockAndAttach(chart,titleOpts);}},beforeUpdate:function(chart){var titleOpts=chart.options.title;var titleBlock=chart.titleBlock;if(titleOpts){helpers$1.mergeIf(titleOpts,core_defaults.global.title);if(titleBlock){core_layouts.configure(chart,titleBlock,titleOpts);titleBlock.options=titleOpts;}else{createNewTitleBlockAndAttach(chart,titleOpts);}}else if(titleBlock){core_layouts.removeBox(chart,titleBlock);delete chart.titleBlock;}}};var plugins={};var filler=plugin_filler;var legend=plugin_legend;var title=plugin_title;plugins.filler=filler;plugins.legend=legend;plugins.title=title;core_controller.helpers=helpers$1;core_helpers(core_controller);core_controller._adapters=core_adapters;core_controller.Animation=core_animation;core_controller.animationService=core_animations;core_controller.controllers=controllers;core_controller.DatasetController=core_datasetController;core_controller.defaults=core_defaults;core_controller.Element=core_element;core_controller.elements=elements;core_controller.Interaction=core_interaction;core_controller.layouts=core_layouts;core_controller.platform=platform;core_controller.plugins=core_plugins;core_controller.Scale=core_scale;core_controller.scaleService=core_scaleService;core_controller.Ticks=core_ticks;core_controller.Tooltip=core_tooltip;core_controller.helpers.each(scales,function(scale,type){core_controller.scaleService.registerScaleType(type,scale,scale._defaults);});for(var k in plugins){if(plugins.hasOwnProperty(k)){core_controller.plugins.register(plugins[k]);}}
core_controller.platform.initialize();var src=core_controller;if(typeof window!=='undefined'){window.Chart=core_controller;}
core_controller.Chart=core_controller;core_controller.Legend=plugins.legend._element;core_controller.Title=plugins.title._element;core_controller.pluginService=core_controller.plugins;core_controller.PluginBase=core_controller.Element.extend({});core_controller.canvasHelpers=core_controller.helpers.canvas;core_controller.layoutService=core_controller.layouts;core_controller.LinearScaleBase=scale_linearbase;core_controller.helpers.each(['Bar','Bubble','Doughnut','Line','PolarArea','Radar','Scatter'],function(klass){core_controller[klass]=function(ctx,cfg){return new core_controller(ctx,core_controller.helpers.merge(cfg||{},{type:klass.charAt(0).toLowerCase()+klass.slice(1)}));};});return src;})));;

/* /base_accounting_kit/static/lib/Chart.bundle.min.js defined in bundle 'web.assets_backend' */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Chart=e()}(this,function(){"use strict";var t={rgb2hsl:e,rgb2hsv:i,rgb2hwb:n,rgb2cmyk:a,rgb2keyword:o,rgb2xyz:s,rgb2lab:l,rgb2lch:function(t){return v(l(t))},hsl2rgb:u,hsl2hsv:function(t){var e=t[0],i=t[1]/100,n=t[2]/100;if(0===n)return[0,0,0];return[e,100*(2*(i*=(n*=2)<=1?n:2-n)/(n+i)),100*((n+i)/2)]},hsl2hwb:function(t){return n(u(t))},hsl2cmyk:function(t){return a(u(t))},hsl2keyword:function(t){return o(u(t))},hsv2rgb:d,hsv2hsl:function(t){var e,i,n=t[0],a=t[1]/100,r=t[2]/100;return e=a*r,[n,100*(e=(e/=(i=(2-a)*r)<=1?i:2-i)||0),100*(i/=2)]},hsv2hwb:function(t){return n(d(t))},hsv2cmyk:function(t){return a(d(t))},hsv2keyword:function(t){return o(d(t))},hwb2rgb:h,hwb2hsl:function(t){return e(h(t))},hwb2hsv:function(t){return i(h(t))},hwb2cmyk:function(t){return a(h(t))},hwb2keyword:function(t){return o(h(t))},cmyk2rgb:c,cmyk2hsl:function(t){return e(c(t))},cmyk2hsv:function(t){return i(c(t))},cmyk2hwb:function(t){return n(c(t))},cmyk2keyword:function(t){return o(c(t))},keyword2rgb:_,keyword2hsl:function(t){return e(_(t))},keyword2hsv:function(t){return i(_(t))},keyword2hwb:function(t){return n(_(t))},keyword2cmyk:function(t){return a(_(t))},keyword2lab:function(t){return l(_(t))},keyword2xyz:function(t){return s(_(t))},xyz2rgb:f,xyz2lab:m,xyz2lch:function(t){return v(m(t))},lab2xyz:p,lab2rgb:y,lab2lch:v,lch2lab:x,lch2xyz:function(t){return p(x(t))},lch2rgb:function(t){return y(x(t))}};function e(t){var e,i,n=t[0]/255,a=t[1]/255,r=t[2]/255,o=Math.min(n,a,r),s=Math.max(n,a,r),l=s-o;return s==o?e=0:n==s?e=(a-r)/l:a==s?e=2+(r-n)/l:r==s&&(e=4+(n-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+s)/2,[e,100*(s==o?0:i<=.5?l/(s+o):l/(2-s-o)),100*i]}function i(t){var e,i,n=t[0],a=t[1],r=t[2],o=Math.min(n,a,r),s=Math.max(n,a,r),l=s-o;return i=0==s?0:l/s*1e3/10,s==o?e=0:n==s?e=(a-r)/l:a==s?e=2+(r-n)/l:r==s&&(e=4+(n-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),[e,i,s/255*1e3/10]}function n(t){var i=t[0],n=t[1],a=t[2];return[e(t)[0],100*(1/255*Math.min(i,Math.min(n,a))),100*(a=1-1/255*Math.max(i,Math.max(n,a)))]}function a(t){var e,i=t[0]/255,n=t[1]/255,a=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-n,1-a)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-a-e)/(1-e)||0),100*e]}function o(t){return w[JSON.stringify(t)]}function s(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*i+.0722*n),100*(.0193*e+.1192*i+.9505*n)]}function l(t){var e=s(t),i=e[0],n=e[1],a=e[2];return n/=100,a/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(i-n),200*(n-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]}function u(t){var e,i,n,a,r,o=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[r=255*l,r,r];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),a=[0,0,0];for(var u=0;u<3;u++)(n=o+1/3*-(u-1))<0&&n++,n>1&&n--,r=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,a[u]=255*r;return a}function d(t){var e=t[0]/60,i=t[1]/100,n=t[2]/100,a=Math.floor(e)%6,r=e-Math.floor(e),o=255*n*(1-i),s=255*n*(1-i*r),l=255*n*(1-i*(1-r));n*=255;switch(a){case 0:return[n,l,o];case 1:return[s,n,o];case 2:return[o,n,l];case 3:return[o,s,n];case 4:return[l,o,n];case 5:return[n,o,s]}}function h(t){var e,i,n,a,o=t[0]/360,s=t[1]/100,l=t[2]/100,u=s+l;switch(u>1&&(s/=u,l/=u),n=6*o-(e=Math.floor(6*o)),0!=(1&e)&&(n=1-n),a=s+n*((i=1-l)-s),e){default:case 6:case 0:r=i,g=a,b=s;break;case 1:r=a,g=i,b=s;break;case 2:r=s,g=i,b=a;break;case 3:r=s,g=a,b=i;break;case 4:r=a,g=s,b=i;break;case 5:r=i,g=s,b=a}return[255*r,255*g,255*b]}function c(t){var e=t[0]/100,i=t[1]/100,n=t[2]/100,a=t[3]/100;return[255*(1-Math.min(1,e*(1-a)+a)),255*(1-Math.min(1,i*(1-a)+a)),255*(1-Math.min(1,n*(1-a)+a))]}function f(t){var e,i,n,a=t[0]/100,r=t[1]/100,o=t[2]/100;return i=-.9689*a+1.8758*r+.0415*o,n=.0557*a+-.204*r+1.057*o,e=(e=3.2406*a+-1.5372*r+-.4986*o)>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1))]}function m(t){var e=t[0],i=t[1],n=t[2];return i/=100,n/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]}function p(t){var e,i,n,a,r=t[0],o=t[1],s=t[2];return r<=8?a=(i=100*r/903.3)/100*7.787+16/116:(i=100*Math.pow((r+16)/116,3),a=Math.pow(i/100,1/3)),[e=e/95.047<=.008856?e=95.047*(o/500+a-16/116)/7.787:95.047*Math.pow(o/500+a,3),i,n=n/108.883<=.008859?n=108.883*(a-s/200-16/116)/7.787:108.883*Math.pow(a-s/200,3)]}function v(t){var e,i=t[0],n=t[1],a=t[2];return(e=360*Math.atan2(a,n)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(n*n+a*a),e]}function y(t){return f(p(t))}function x(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]}function _(t){return k[t]}var k={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},w={};for(var M in k)w[JSON.stringify(k[M])]=M;var S=function(){return new O};for(var D in t){S[D+"Raw"]=function(e){return function(i){return"number"==typeof i&&(i=Array.prototype.slice.call(arguments)),t[e](i)}}(D);var C=/(\w+)2(\w+)/.exec(D),P=C[1],T=C[2];(S[P]=S[P]||{})[T]=S[D]=function(e){return function(i){"number"==typeof i&&(i=Array.prototype.slice.call(arguments));var n=t[e](i);if("string"==typeof n||void 0===n)return n;for(var a=0;a<n.length;a++)n[a]=Math.round(n[a]);return n}}(D)}var O=function(){this.convs={}};O.prototype.routeSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i))},O.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},O.prototype.getValues=function(t){var e=this.convs[t];if(!e){var i=this.space,n=this.convs[i];e=S[i][t](n),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(t){O.prototype[t]=function(e){return this.routeSpace(t,arguments)}});var I=S,A={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},F={getRgba:R,getHsla:L,getRgb:function(t){var e=R(t);return e&&e.slice(0,3)},getHsl:function(t){var e=L(t);return e&&e.slice(0,3)},getHwb:W,getAlpha:function(t){var e=R(t);if(e)return e[3];if(e=L(t))return e[3];if(e=W(t))return e[3]},hexString:function(t,e){var e=void 0!==e&&3===t.length?e:t[3];return"#"+H(t[0])+H(t[1])+H(t[2])+(e>=0&&e<1?H(Math.round(255*e)):"")},rgbString:function(t,e){if(e<1||t[3]&&t[3]<1)return Y(t,e);return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},rgbaString:Y,percentString:function(t,e){if(e<1||t[3]&&t[3]<1)return N(t,e);var i=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),a=Math.round(t[2]/255*100);return"rgb("+i+"%, "+n+"%, "+a+"%)"},percentaString:N,hslString:function(t,e){if(e<1||t[3]&&t[3]<1)return z(t,e);return"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"},hslaString:z,hwbString:function(t,e){void 0===e&&(e=void 0!==t[3]?t[3]:1);return"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"},keyword:function(t){return E[t.slice(0,3)]}};function R(t){if(t){var e=[0,0,0],i=1,n=t.match(/^#([a-fA-F0-9]{3,4})$/i),a="";if(n){a=(n=n[1])[3];for(var r=0;r<e.length;r++)e[r]=parseInt(n[r]+n[r],16);a&&(i=Math.round(parseInt(a+a,16)/255*100)/100)}else if(n=t.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){a=n[2],n=n[1];for(r=0;r<e.length;r++)e[r]=parseInt(n.slice(2*r,2*r+2),16);a&&(i=Math.round(parseInt(a,16)/255*100)/100)}else if(n=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<e.length;r++)e[r]=parseInt(n[r+1]);i=parseFloat(n[4])}else if(n=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<e.length;r++)e[r]=Math.round(2.55*parseFloat(n[r+1]));i=parseFloat(n[4])}else if(n=t.match(/(\w+)/)){if("transparent"==n[1])return[0,0,0,0];if(!(e=A[n[1]]))return}for(r=0;r<e.length;r++)e[r]=V(e[r],0,255);return i=i||0==i?V(i,0,1):1,e[3]=i,e}}function L(t){if(t){var e=t.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[V(parseInt(e[1]),0,360),V(parseFloat(e[2]),0,100),V(parseFloat(e[3]),0,100),V(isNaN(i)?1:i,0,1)]}}}function W(t){if(t){var e=t.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[V(parseInt(e[1]),0,360),V(parseFloat(e[2]),0,100),V(parseFloat(e[3]),0,100),V(isNaN(i)?1:i,0,1)]}}}function Y(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function N(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function z(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function V(t,e,i){return Math.min(Math.max(e,t),i)}function H(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var E={};for(var B in A)E[A[B]]=B;var j=function(t){return t instanceof j?t:this instanceof j?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof t?(e=F.getRgba(t))?this.setValues("rgb",e):(e=F.getHsla(t))?this.setValues("hsl",e):(e=F.getHwb(t))&&this.setValues("hwb",e):"object"==typeof t&&(void 0!==(e=t).r||void 0!==e.red?this.setValues("rgb",e):void 0!==e.l||void 0!==e.lightness?this.setValues("hsl",e):void 0!==e.v||void 0!==e.value?this.setValues("hsv",e):void 0!==e.w||void 0!==e.whiteness?this.setValues("hwb",e):void 0===e.c&&void 0===e.cyan||this.setValues("cmyk",e)))):new j(t);var e};j.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t=(t%=360)<0?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return F.hexString(this.values.rgb)},rgbString:function(){return F.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return F.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return F.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return F.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return F.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return F.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return F.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],i=0;i<t.length;i++){var n=t[i]/255;e[i]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;e<3;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,i=(e[0]+t)%360;return e[0]=i<0?360+i:i,this.setValues("hsl",e),this},mix:function(t,e){var i=t,n=void 0===e?.5:e,a=2*n-1,r=this.alpha()-i.alpha(),o=((a*r==-1?a:(a+r)/(1+a*r))+1)/2,s=1-o;return this.rgb(o*this.red()+s*i.red(),o*this.green()+s*i.green(),o*this.blue()+s*i.blue()).alpha(this.alpha()*n+i.alpha()*(1-n))},toJSON:function(){return this.rgb()},clone:function(){var t,e,i=new j,n=this.values,a=i.values;for(var r in n)n.hasOwnProperty(r)&&(t=n[r],"[object Array]"===(e={}.toString.call(t))?a[r]=t.slice(0):"[object Number]"===e?a[r]=t:console.error("unexpected color value:",t));return i}},j.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},j.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},j.prototype.getValues=function(t){for(var e=this.values,i={},n=0;n<t.length;n++)i[t.charAt(n)]=e[t][n];return 1!==e.alpha&&(i.a=e.alpha),i},j.prototype.setValues=function(t,e){var i,n,a=this.values,r=this.spaces,o=this.maxes,s=1;if(this.valid=!0,"alpha"===t)s=e;else if(e.length)a[t]=e.slice(0,t.length),s=e[t.length];else if(void 0!==e[t.charAt(0)]){for(i=0;i<t.length;i++)a[t][i]=e[t.charAt(i)];s=e.a}else if(void 0!==e[r[t][0]]){var l=r[t];for(i=0;i<t.length;i++)a[t][i]=e[l[i]];s=e.alpha}if(a.alpha=Math.max(0,Math.min(1,void 0===s?a.alpha:s)),"alpha"===t)return!1;for(i=0;i<t.length;i++)n=Math.max(0,Math.min(o[t][i],a[t][i])),a[t][i]=Math.round(n);for(var u in r)u!==t&&(a[u]=I[t][u](a[t]));return!0},j.prototype.setSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i),this)},j.prototype.setChannel=function(t,e,i){var n=this.values[t];return void 0===i?n[e]:i===n[e]?this:(n[e]=i,this.setValues(t,n),this)},"undefined"!=typeof window&&(window.Color=j);var U,G=j,q={noop:function(){},uid:(U=0,function(){return U++}),isNullOrUndef:function(t){return null==t},isArray:function(t){if(Array.isArray&&Array.isArray(t))return!0;var e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)},isObject:function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},isFinite:function(t){return("number"==typeof t||t instanceof Number)&&isFinite(t)},valueOrDefault:function(t,e){return void 0===t?e:t},valueAtIndexOrDefault:function(t,e,i){return q.valueOrDefault(q.isArray(t)?t[e]:t,i)},callback:function(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)},each:function(t,e,i,n){var a,r,o;if(q.isArray(t))if(r=t.length,n)for(a=r-1;a>=0;a--)e.call(i,t[a],a);else for(a=0;a<r;a++)e.call(i,t[a],a);else if(q.isObject(t))for(r=(o=Object.keys(t)).length,a=0;a<r;a++)e.call(i,t[o[a]],o[a])},arrayEquals:function(t,e){var i,n,a,r;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(a=t[i],r=e[i],a instanceof Array&&r instanceof Array){if(!q.arrayEquals(a,r))return!1}else if(a!==r)return!1;return!0},clone:function(t){if(q.isArray(t))return t.map(q.clone);if(q.isObject(t)){for(var e={},i=Object.keys(t),n=i.length,a=0;a<n;++a)e[i[a]]=q.clone(t[i[a]]);return e}return t},_merger:function(t,e,i,n){var a=e[t],r=i[t];q.isObject(a)&&q.isObject(r)?q.merge(a,r,n):e[t]=q.clone(r)},_mergerIf:function(t,e,i){var n=e[t],a=i[t];q.isObject(n)&&q.isObject(a)?q.mergeIf(n,a):e.hasOwnProperty(t)||(e[t]=q.clone(a))},merge:function(t,e,i){var n,a,r,o,s,l=q.isArray(e)?e:[e],u=l.length;if(!q.isObject(t))return t;for(n=(i=i||{}).merger||q._merger,a=0;a<u;++a)if(e=l[a],q.isObject(e))for(s=0,o=(r=Object.keys(e)).length;s<o;++s)n(r[s],t,e,i);return t},mergeIf:function(t,e){return q.merge(t,e,{merger:q._mergerIf})},extend:function(t){for(var e=function(e,i){t[i]=e},i=1,n=arguments.length;i<n;++i)q.each(arguments[i],e);return t},inherits:function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=q.inherits,t&&q.extend(i.prototype,t),i.__super__=e.prototype,i}},Z=q;q.callCallback=q.callback,q.indexOf=function(t,e,i){return Array.prototype.indexOf.call(t,e,i)},q.getValueOrDefault=q.valueOrDefault,q.getValueAtIndexOrDefault=q.valueAtIndexOrDefault;var $={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.45),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-$.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*$.easeInBounce(2*t):.5*$.easeOutBounce(2*t-1)+.5}},X={effects:$};Z.easingEffects=$;var K=Math.PI,J=K/180,Q=2*K,tt=K/2,et=K/4,it=2*K/3,nt={clear:function(t){t.ctx.clearRect(0,0,t.width,t.height)},roundedRect:function(t,e,i,n,a,r){if(r){var o=Math.min(r,a/2,n/2),s=e+o,l=i+o,u=e+n-o,d=i+a-o;t.moveTo(e,l),s<u&&l<d?(t.arc(s,l,o,-K,-tt),t.arc(u,l,o,-tt,0),t.arc(u,d,o,0,tt),t.arc(s,d,o,tt,K)):s<u?(t.moveTo(s,i),t.arc(u,l,o,-tt,tt),t.arc(s,l,o,tt,K+tt)):l<d?(t.arc(s,l,o,-K,0),t.arc(s,d,o,0,K)):t.arc(s,l,o,-K,K),t.closePath(),t.moveTo(e,i)}else t.rect(e,i,n,a)},drawPoint:function(t,e,i,n,a,r){var o,s,l,u,d,h=(r||0)*J;if(!e||"object"!=typeof e||"[object HTMLImageElement]"!==(o=e.toString())&&"[object HTMLCanvasElement]"!==o){if(!(isNaN(i)||i<=0)){switch(t.beginPath(),e){default:t.arc(n,a,i,0,Q),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(h)*i,a-Math.cos(h)*i),h+=it,t.lineTo(n+Math.sin(h)*i,a-Math.cos(h)*i),h+=it,t.lineTo(n+Math.sin(h)*i,a-Math.cos(h)*i),t.closePath();break;case"rectRounded":u=i-(d=.516*i),s=Math.cos(h+et)*u,l=Math.sin(h+et)*u,t.arc(n-s,a-l,d,h-K,h-tt),t.arc(n+l,a-s,d,h-tt,h),t.arc(n+s,a+l,d,h,h+tt),t.arc(n-l,a+s,d,h+tt,h+K),t.closePath();break;case"rect":if(!r){u=Math.SQRT1_2*i,t.rect(n-u,a-u,2*u,2*u);break}h+=et;case"rectRot":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+l,a-s),t.lineTo(n+s,a+l),t.lineTo(n-l,a+s),t.closePath();break;case"crossRot":h+=et;case"cross":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l),t.moveTo(n+l,a-s),t.lineTo(n-l,a+s);break;case"star":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l),t.moveTo(n+l,a-s),t.lineTo(n-l,a+s),h+=et,s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l),t.moveTo(n+l,a-s),t.lineTo(n-l,a+s);break;case"line":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l);break;case"dash":t.moveTo(n,a),t.lineTo(n+Math.cos(h)*i,a+Math.sin(h)*i)}t.fill(),t.stroke()}}else t.drawImage(e,n-e.width/2,a-e.height/2,e.width,e.height)},_isPointInArea:function(t,e){return t.x>e.left-1e-6&&t.x<e.right+1e-6&&t.y>e.top-1e-6&&t.y<e.bottom+1e-6},clipArea:function(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()},unclipArea:function(t){t.restore()},lineTo:function(t,e,i,n){var a=i.steppedLine;if(a){if("middle"===a){var r=(e.x+i.x)/2;t.lineTo(r,n?i.y:e.y),t.lineTo(r,n?e.y:i.y)}else"after"===a&&!n||"after"!==a&&n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}else i.tension?t.bezierCurveTo(n?e.controlPointPreviousX:e.controlPointNextX,n?e.controlPointPreviousY:e.controlPointNextY,n?i.controlPointNextX:i.controlPointPreviousX,n?i.controlPointNextY:i.controlPointPreviousY,i.x,i.y):t.lineTo(i.x,i.y)}},at=nt;Z.clear=nt.clear,Z.drawRoundedRectangle=function(t){t.beginPath(),nt.roundedRect.apply(nt,arguments)};var rt={_set:function(t,e){return Z.merge(this[t]||(this[t]={}),e)}};rt._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var ot=rt,st=Z.valueOrDefault;var lt={toLineHeight:function(t,e){var i=(""+t).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t},toPadding:function(t){var e,i,n,a;return Z.isObject(t)?(e=+t.top||0,i=+t.right||0,n=+t.bottom||0,a=+t.left||0):e=i=n=a=+t||0,{top:e,right:i,bottom:n,left:a,height:e+n,width:a+i}},_parseFont:function(t){var e=ot.global,i=st(t.fontSize,e.defaultFontSize),n={family:st(t.fontFamily,e.defaultFontFamily),lineHeight:Z.options.toLineHeight(st(t.lineHeight,e.defaultLineHeight),i),size:i,style:st(t.fontStyle,e.defaultFontStyle),weight:null,string:""};return n.string=function(t){return!t||Z.isNullOrUndef(t.size)||Z.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(n),n},resolve:function(t,e,i){var n,a,r;for(n=0,a=t.length;n<a;++n)if(void 0!==(r=t[n])&&(void 0!==e&&"function"==typeof r&&(r=r(e)),void 0!==i&&Z.isArray(r)&&(r=r[i]),void 0!==r))return r}},ut=Z,dt=X,ht=at,ct=lt;ut.easing=dt,ut.canvas=ht,ut.options=ct;var ft=function(t){ut.extend(this,t),this.initialize.apply(this,arguments)};ut.extend(ft.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=ut.clone(t._model)),t._start={},t},transition:function(t){var e=this,i=e._model,n=e._start,a=e._view;return i&&1!==t?(a||(a=e._view={}),n||(n=e._start={}),function(t,e,i,n){var a,r,o,s,l,u,d,h,c,f=Object.keys(i);for(a=0,r=f.length;a<r;++a)if(u=i[o=f[a]],e.hasOwnProperty(o)||(e[o]=u),(s=e[o])!==u&&"_"!==o[0]){if(t.hasOwnProperty(o)||(t[o]=s),(d=typeof u)==typeof(l=t[o]))if("string"===d){if((h=G(l)).valid&&(c=G(u)).valid){e[o]=c.mix(h,n).rgbString();continue}}else if(ut.isFinite(l)&&ut.isFinite(u)){e[o]=l+(u-l)*n;continue}e[o]=u}}(n,a,i,t),e):(e._view=i,e._start=null,e)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return ut.isNumber(this._model.x)&&ut.isNumber(this._model.y)}}),ft.extend=ut.inherits;var gt=ft,mt=gt.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),pt=mt;Object.defineProperty(mt.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(mt.prototype,"chartInstance",{get:function(){return this.chart},set:function(t){this.chart=t}}),ot._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:ut.noop,onComplete:ut.noop}});var vt={animations:[],request:null,addAnimation:function(t,e,i,n){var a,r,o=this.animations;for(e.chart=t,e.startTime=Date.now(),e.duration=i,n||(t.animating=!0),a=0,r=o.length;a<r;++a)if(o[a].chart===t)return void(o[a]=e);o.push(e),1===o.length&&this.requestAnimationFrame()},cancelAnimation:function(t){var e=ut.findIndex(this.animations,function(e){return e.chart===t});-1!==e&&(this.animations.splice(e,1),t.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=ut.requestAnimFrame.call(window,function(){t.request=null,t.startDigest()}))},startDigest:function(){this.advance(),this.animations.length>0&&this.requestAnimationFrame()},advance:function(){for(var t,e,i,n,a=this.animations,r=0;r<a.length;)e=(t=a[r]).chart,i=t.numSteps,n=Math.floor((Date.now()-t.startTime)/t.duration*i)+1,t.currentStep=Math.min(n,i),ut.callback(t.render,[e,t],e),ut.callback(t.onAnimationProgress,[t],e),t.currentStep>=i?(ut.callback(t.onAnimationComplete,[t],e),e.animating=!1,a.splice(r,1)):++r}},yt=ut.options.resolve,bt=["push","pop","shift","splice","unshift"];function xt(t,e){var i=t._chartjs;if(i){var n=i.listeners,a=n.indexOf(e);-1!==a&&n.splice(a,1),n.length>0||(bt.forEach(function(e){delete t[e]}),delete t._chartjs)}}var _t=function(t,e){this.initialize(t,e)};ut.extend(_t.prototype,{datasetElementType:null,dataElementType:null,initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){var t=this,e=t.getMeta(),i=t.getDataset();null!==e.xAxisID&&e.xAxisID in t.chart.scales||(e.xAxisID=i.xAxisID||t.chart.options.scales.xAxes[0].id),null!==e.yAxisID&&e.yAxisID in t.chart.scales||(e.yAxisID=i.yAxisID||t.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this.update(!0)},destroy:function(){this._data&&xt(this._data,this)},createMetaDataset:function(){var t=this.datasetElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(t){var e=this.dataElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index,_index:t})},addElements:function(){var t,e,i=this.getMeta(),n=this.getDataset().data||[],a=i.data;for(t=0,e=n.length;t<e;++t)a[t]=a[t]||this.createMetaData(t);i.dataset=i.dataset||this.createMetaDataset()},addElementAndReset:function(t){var e=this.createMetaData(t);this.getMeta().data.splice(t,0,e),this.updateElement(e,t,!0)},buildOrUpdateElements:function(){var t,e,i=this,n=i.getDataset(),a=n.data||(n.data=[]);i._data!==a&&(i._data&&xt(i._data,i),a&&Object.isExtensible(a)&&(e=i,(t=a)._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),bt.forEach(function(e){var i="onData"+e.charAt(0).toUpperCase()+e.slice(1),n=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),a=n.apply(this,e);return ut.each(t._chartjs.listeners,function(t){"function"==typeof t[i]&&t[i].apply(t,e)}),a}})}))),i._data=a),i.resyncElements()},update:ut.noop,transition:function(t){for(var e=this.getMeta(),i=e.data||[],n=i.length,a=0;a<n;++a)i[a].transition(t);e.dataset&&e.dataset.transition(t)},draw:function(){var t=this.getMeta(),e=t.data||[],i=e.length,n=0;for(t.dataset&&t.dataset.draw();n<i;++n)e[n].draw()},removeHoverStyle:function(t){ut.merge(t._model,t.$previousStyle||{}),delete t.$previousStyle},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},a=t._model,r=ut.getHoverColor;t.$previousStyle={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth},a.backgroundColor=yt([n.hoverBackgroundColor,e.hoverBackgroundColor,r(a.backgroundColor)],void 0,i),a.borderColor=yt([n.hoverBorderColor,e.hoverBorderColor,r(a.borderColor)],void 0,i),a.borderWidth=yt([n.hoverBorderWidth,e.hoverBorderWidth,a.borderWidth],void 0,i)},resyncElements:function(){var t=this.getMeta(),e=this.getDataset().data,i=t.data.length,n=e.length;n<i?t.data.splice(n,i-n):n>i&&this.insertElements(i,n-i)},insertElements:function(t,e){for(var i=0;i<e;++i)this.addElementAndReset(t+i)},onDataPush:function(){var t=arguments.length;this.insertElements(this.getDataset().data.length-t,t)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(t,e){this.getMeta().data.splice(t,e),this.insertElements(t,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),_t.extend=ut.inherits;var kt=_t;ot._set("global",{elements:{arc:{backgroundColor:ot.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var wt=gt.extend({inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,e){var i=this._view;if(i){for(var n=ut.getAngleFromPoint(i,{x:t,y:e}),a=n.angle,r=n.distance,o=i.startAngle,s=i.endAngle;s<o;)s+=2*Math.PI;for(;a>s;)a-=2*Math.PI;for(;a<o;)a+=2*Math.PI;var l=a>=o&&a<=s,u=r>=i.innerRadius&&r<=i.outerRadius;return l&&u}return!1},getCenterPoint:function(){var t=this._view,e=(t.startAngle+t.endAngle)/2,i=(t.innerRadius+t.outerRadius)/2;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},getArea:function(){var t=this._view;return Math.PI*((t.endAngle-t.startAngle)/(2*Math.PI))*(Math.pow(t.outerRadius,2)-Math.pow(t.innerRadius,2))},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,i=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},draw:function(){var t,e=this._chart.ctx,i=this._view,n=i.startAngle,a=i.endAngle,r="inner"===i.borderAlign?.33:0;e.save(),e.beginPath(),e.arc(i.x,i.y,Math.max(i.outerRadius-r,0),n,a),e.arc(i.x,i.y,i.innerRadius,a,n,!0),e.closePath(),e.fillStyle=i.backgroundColor,e.fill(),i.borderWidth&&("inner"===i.borderAlign?(e.beginPath(),t=r/i.outerRadius,e.arc(i.x,i.y,i.outerRadius,n-t,a+t),i.innerRadius>r?(t=r/i.innerRadius,e.arc(i.x,i.y,i.innerRadius-r,a+t,n-t,!0)):e.arc(i.x,i.y,r,a+Math.PI/2,n-Math.PI/2),e.closePath(),e.clip(),e.beginPath(),e.arc(i.x,i.y,i.outerRadius,n,a),e.arc(i.x,i.y,i.innerRadius,a,n,!0),e.closePath(),e.lineWidth=2*i.borderWidth,e.lineJoin="round"):(e.lineWidth=i.borderWidth,e.lineJoin="bevel"),e.strokeStyle=i.borderColor,e.stroke()),e.restore()}}),Mt=ut.valueOrDefault,St=ot.global.defaultColor;ot._set("global",{elements:{line:{tension:.4,backgroundColor:St,borderWidth:3,borderColor:St,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var Dt=gt.extend({draw:function(){var t,e,i,n,a=this._view,r=this._chart.ctx,o=a.spanGaps,s=this._children.slice(),l=ot.global,u=l.elements.line,d=-1;for(this._loop&&s.length&&s.push(s[0]),r.save(),r.lineCap=a.borderCapStyle||u.borderCapStyle,r.setLineDash&&r.setLineDash(a.borderDash||u.borderDash),r.lineDashOffset=Mt(a.borderDashOffset,u.borderDashOffset),r.lineJoin=a.borderJoinStyle||u.borderJoinStyle,r.lineWidth=Mt(a.borderWidth,u.borderWidth),r.strokeStyle=a.borderColor||l.defaultColor,r.beginPath(),d=-1,t=0;t<s.length;++t)e=s[t],i=ut.previousItem(s,t),n=e._view,0===t?n.skip||(r.moveTo(n.x,n.y),d=t):(i=-1===d?i:s[d],n.skip||(d!==t-1&&!o||-1===d?r.moveTo(n.x,n.y):ut.canvas.lineTo(r,i._view,e._view),d=t));r.stroke(),r.restore()}}),Ct=ut.valueOrDefault,Pt=ot.global.defaultColor;function Tt(t){var e=this._view;return!!e&&Math.abs(t-e.x)<e.radius+e.hitRadius}ot._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:Pt,borderColor:Pt,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var Ot=gt.extend({inRange:function(t,e){var i=this._view;return!!i&&Math.pow(t-i.x,2)+Math.pow(e-i.y,2)<Math.pow(i.hitRadius+i.radius,2)},inLabelRange:Tt,inXRange:Tt,inYRange:function(t){var e=this._view;return!!e&&Math.abs(t-e.y)<e.radius+e.hitRadius},getCenterPoint:function(){var t=this._view;return{x:t.x,y:t.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(t){var e=this._view,i=this._chart.ctx,n=e.pointStyle,a=e.rotation,r=e.radius,o=e.x,s=e.y,l=ot.global,u=l.defaultColor;e.skip||(void 0===t||ut.canvas._isPointInArea(e,t))&&(i.strokeStyle=e.borderColor||u,i.lineWidth=Ct(e.borderWidth,l.elements.point.borderWidth),i.fillStyle=e.backgroundColor||u,ut.canvas.drawPoint(i,n,r,o,s,a))}}),It=ot.global.defaultColor;function At(t){return t&&void 0!==t.width}function Ft(t){var e,i,n,a,r;return At(t)?(r=t.width/2,e=t.x-r,i=t.x+r,n=Math.min(t.y,t.base),a=Math.max(t.y,t.base)):(r=t.height/2,e=Math.min(t.x,t.base),i=Math.max(t.x,t.base),n=t.y-r,a=t.y+r),{left:e,top:n,right:i,bottom:a}}function Rt(t,e,i){return t===e?i:t===i?e:t}function Lt(t,e,i){var n,a,r,o,s=t.borderWidth,l=function(t){var e=t.borderSkipped,i={};return e?(t.horizontal?t.base>t.x&&(e=Rt(e,"left","right")):t.base<t.y&&(e=Rt(e,"bottom","top")),i[e]=!0,i):i}(t);return ut.isObject(s)?(n=+s.top||0,a=+s.right||0,r=+s.bottom||0,o=+s.left||0):n=a=r=o=+s||0,{t:l.top||n<0?0:n>i?i:n,r:l.right||a<0?0:a>e?e:a,b:l.bottom||r<0?0:r>i?i:r,l:l.left||o<0?0:o>e?e:o}}function Wt(t,e,i){var n=null===e,a=null===i,r=!(!t||n&&a)&&Ft(t);return r&&(n||e>=r.left&&e<=r.right)&&(a||i>=r.top&&i<=r.bottom)}ot._set("global",{elements:{rectangle:{backgroundColor:It,borderColor:It,borderSkipped:"bottom",borderWidth:0}}});var Yt=gt.extend({draw:function(){var t=this._chart.ctx,e=this._view,i=function(t){var e=Ft(t),i=e.right-e.left,n=e.bottom-e.top,a=Lt(t,i/2,n/2);return{outer:{x:e.left,y:e.top,w:i,h:n},inner:{x:e.left+a.l,y:e.top+a.t,w:i-a.l-a.r,h:n-a.t-a.b}}}(e),n=i.outer,a=i.inner;t.fillStyle=e.backgroundColor,t.fillRect(n.x,n.y,n.w,n.h),n.w===a.w&&n.h===a.h||(t.save(),t.beginPath(),t.rect(n.x,n.y,n.w,n.h),t.clip(),t.fillStyle=e.borderColor,t.rect(a.x,a.y,a.w,a.h),t.fill("evenodd"),t.restore())},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){return Wt(this._view,t,e)},inLabelRange:function(t,e){var i=this._view;return At(i)?Wt(i,t,null):Wt(i,null,e)},inXRange:function(t){return Wt(this._view,t,null)},inYRange:function(t){return Wt(this._view,null,t)},getCenterPoint:function(){var t,e,i=this._view;return At(i)?(t=i.x,e=(i.y+i.base)/2):(t=(i.x+i.base)/2,e=i.y),{x:t,y:e}},getArea:function(){var t=this._view;return At(t)?t.width*Math.abs(t.y-t.base):t.height*Math.abs(t.x-t.base)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}}),Nt={},zt=wt,Vt=Dt,Ht=Ot,Et=Yt;Nt.Arc=zt,Nt.Line=Vt,Nt.Point=Ht,Nt.Rectangle=Et;var Bt=ut.options.resolve;ot._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}});var jt=kt.extend({dataElementType:Nt.Rectangle,initialize:function(){var t;kt.prototype.initialize.apply(this,arguments),(t=this.getMeta()).stack=this.getDataset().stack,t.bar=!0},update:function(t){var e,i,n=this.getMeta().data;for(this._ruler=this.getRuler(),e=0,i=n.length;e<i;++e)this.updateElement(n[e],e,t)},updateElement:function(t,e,i){var n=this,a=n.getMeta(),r=n.getDataset(),o=n._resolveElementOptions(t,e);t._xScale=n.getScaleForId(a.xAxisID),t._yScale=n.getScaleForId(a.yAxisID),t._datasetIndex=n.index,t._index=e,t._model={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth,datasetLabel:r.label,label:n.chart.data.labels[e]},n._updateElementGeometry(t,e,i),t.pivot()},_updateElementGeometry:function(t,e,i){var n=this,a=t._model,r=n._getValueScale(),o=r.getBasePixel(),s=r.isHorizontal(),l=n._ruler||n.getRuler(),u=n.calculateBarValuePixels(n.index,e),d=n.calculateBarIndexPixels(n.index,e,l);a.horizontal=s,a.base=i?o:u.base,a.x=s?i?o:u.head:d.center,a.y=s?d.center:i?o:u.head,a.height=s?d.size:void 0,a.width=s?void 0:d.size},_getStacks:function(t){var e,i,n=this.chart,a=this._getIndexScale().options.stacked,r=void 0===t?n.data.datasets.length:t+1,o=[];for(e=0;e<r;++e)(i=n.getDatasetMeta(e)).bar&&n.isDatasetVisible(e)&&(!1===a||!0===a&&-1===o.indexOf(i.stack)||void 0===a&&(void 0===i.stack||-1===o.indexOf(i.stack)))&&o.push(i.stack);return o},getStackCount:function(){return this._getStacks().length},getStackIndex:function(t,e){var i=this._getStacks(t),n=void 0!==e?i.indexOf(e):-1;return-1===n?i.length-1:n},getRuler:function(){var t,e,i=this._getIndexScale(),n=this.getStackCount(),a=this.index,r=i.isHorizontal(),o=r?i.left:i.top,s=o+(r?i.width:i.height),l=[];for(t=0,e=this.getMeta().data.length;t<e;++t)l.push(i.getPixelForValue(null,t,a));return{min:ut.isNullOrUndef(i.options.barThickness)?function(t,e){var i,n,a,r,o=t.isHorizontal()?t.width:t.height,s=t.getTicks();for(a=1,r=e.length;a<r;++a)o=Math.min(o,Math.abs(e[a]-e[a-1]));for(a=0,r=s.length;a<r;++a)n=t.getPixelForTick(a),o=a>0?Math.min(o,n-i):o,i=n;return o}(i,l):-1,pixels:l,start:o,end:s,stackCount:n,scale:i}},calculateBarValuePixels:function(t,e){var i,n,a,r,o,s,l=this.chart,u=this.getMeta(),d=this._getValueScale(),h=d.isHorizontal(),c=l.data.datasets,f=+d.getRightValue(c[t].data[e]),g=d.options.minBarLength,m=d.options.stacked,p=u.stack,v=0;if(m||void 0===m&&void 0!==p)for(i=0;i<t;++i)(n=l.getDatasetMeta(i)).bar&&n.stack===p&&n.controller._getValueScaleId()===d.id&&l.isDatasetVisible(i)&&(a=+d.getRightValue(c[i].data[e]),(f<0&&a<0||f>=0&&a>0)&&(v+=a));return r=d.getPixelForValue(v),s=(o=d.getPixelForValue(v+f))-r,void 0!==g&&Math.abs(s)<g&&(s=g,o=f>=0&&!h||f<0&&h?r-g:r+g),{size:s,base:r,head:o,center:o+s/2}},calculateBarIndexPixels:function(t,e,i){var n=i.scale.options,a="flex"===n.barThickness?function(t,e,i){var n,a=e.pixels,r=a[t],o=t>0?a[t-1]:null,s=t<a.length-1?a[t+1]:null,l=i.categoryPercentage;return null===o&&(o=r-(null===s?e.end-e.start:s-r)),null===s&&(s=r+r-o),n=r-(r-Math.min(o,s))/2*l,{chunk:Math.abs(s-o)/2*l/e.stackCount,ratio:i.barPercentage,start:n}}(e,i,n):function(t,e,i){var n,a,r=i.barThickness,o=e.stackCount,s=e.pixels[t];return ut.isNullOrUndef(r)?(n=e.min*i.categoryPercentage,a=i.barPercentage):(n=r*o,a=1),{chunk:n/o,ratio:a,start:s-n/2}}(e,i,n),r=this.getStackIndex(t,this.getMeta().stack),o=a.start+a.chunk*r+a.chunk/2,s=Math.min(ut.valueOrDefault(n.maxBarThickness,1/0),a.chunk*a.ratio);return{base:o-s/2,head:o+s/2,center:o,size:s}},draw:function(){var t=this.chart,e=this._getValueScale(),i=this.getMeta().data,n=this.getDataset(),a=i.length,r=0;for(ut.canvas.clipArea(t.ctx,t.chartArea);r<a;++r)isNaN(e.getRightValue(n.data[r]))||i[r].draw();ut.canvas.unclipArea(t.ctx)},_resolveElementOptions:function(t,e){var i,n,a,r=this.chart,o=r.data.datasets[this.index],s=t.custom||{},l=r.options.elements.rectangle,u={},d={chart:r,dataIndex:e,dataset:o,datasetIndex:this.index},h=["backgroundColor","borderColor","borderSkipped","borderWidth"];for(i=0,n=h.length;i<n;++i)u[a=h[i]]=Bt([s[a],o[a],l[a]],d,e);return u}}),Ut=ut.valueOrDefault,Gt=ut.options.resolve;ot._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.datasets[t.datasetIndex].label||"",n=e.datasets[t.datasetIndex].data[t.index];return i+": ("+t.xLabel+", "+t.yLabel+", "+n.r+")"}}}});var qt=kt.extend({dataElementType:Nt.Point,update:function(t){var e=this,i=e.getMeta().data;ut.each(i,function(i,n){e.updateElement(i,n,t)})},updateElement:function(t,e,i){var n=this,a=n.getMeta(),r=t.custom||{},o=n.getScaleForId(a.xAxisID),s=n.getScaleForId(a.yAxisID),l=n._resolveElementOptions(t,e),u=n.getDataset().data[e],d=n.index,h=i?o.getPixelForDecimal(.5):o.getPixelForValue("object"==typeof u?u:NaN,e,d),c=i?s.getBasePixel():s.getPixelForValue(u,e,d);t._xScale=o,t._yScale=s,t._options=l,t._datasetIndex=d,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:i?0:l.radius,skip:r.skip||isNaN(h)||isNaN(c),x:h,y:c},t.pivot()},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Ut(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Ut(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Ut(i.hoverBorderWidth,i.borderWidth),e.radius=i.radius+i.hoverRadius},_resolveElementOptions:function(t,e){var i,n,a,r=this.chart,o=r.data.datasets[this.index],s=t.custom||{},l=r.options.elements.point,u=o.data[e],d={},h={chart:r,dataIndex:e,dataset:o,datasetIndex:this.index},c=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"];for(i=0,n=c.length;i<n;++i)d[a=c[i]]=Gt([s[a],o[a],l[a]],h,e);return d.radius=Gt([s.radius,u?u.r:void 0,o.radius,l.radius],h,e),d}}),Zt=ut.options.resolve,$t=ut.valueOrDefault;ot._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,a=i.labels;if(n.length)for(var r=0;r<n[0].data.length;++r)e.push('<li><span style="background-color:'+n[0].backgroundColor[r]+'"></span>'),a[r]&&e.push(a[r]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map(function(i,n){var a=t.getDatasetMeta(0),r=e.datasets[0],o=a.data[n],s=o&&o.custom||{},l=t.options.elements.arc;return{text:i,fillStyle:Zt([s.backgroundColor,r.backgroundColor,l.backgroundColor],void 0,n),strokeStyle:Zt([s.borderColor,r.borderColor,l.borderColor],void 0,n),lineWidth:Zt([s.borderWidth,r.borderWidth,l.borderWidth],void 0,n),hidden:isNaN(r.data[n])||a.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var i,n,a,r=e.index,o=this.chart;for(i=0,n=(o.data.datasets||[]).length;i<n;++i)(a=o.getDatasetMeta(i)).data[r]&&(a.data[r].hidden=!a.data[r].hidden);o.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.labels[t.index],n=": "+e.datasets[t.datasetIndex].data[t.index];return ut.isArray(i)?(i=i.slice())[0]+=n:i+=n,i}}}});var Xt=kt.extend({dataElementType:Nt.Arc,linkScales:ut.noop,getRingIndex:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&++e;return e},update:function(t){var e,i,n=this,a=n.chart,r=a.chartArea,o=a.options,s=r.right-r.left,l=r.bottom-r.top,u=Math.min(s,l),d={x:0,y:0},h=n.getMeta(),c=h.data,f=o.cutoutPercentage,g=o.circumference,m=n._getRingWeight(n.index);if(g<2*Math.PI){var p=o.rotation%(2*Math.PI),v=(p+=2*Math.PI*(p>=Math.PI?-1:p<-Math.PI?1:0))+g,y={x:Math.cos(p),y:Math.sin(p)},b={x:Math.cos(v),y:Math.sin(v)},x=p<=0&&v>=0||p<=2*Math.PI&&2*Math.PI<=v,_=p<=.5*Math.PI&&.5*Math.PI<=v||p<=2.5*Math.PI&&2.5*Math.PI<=v,k=p<=-Math.PI&&-Math.PI<=v||p<=Math.PI&&Math.PI<=v,w=p<=.5*-Math.PI&&.5*-Math.PI<=v||p<=1.5*Math.PI&&1.5*Math.PI<=v,M=f/100,S={x:k?-1:Math.min(y.x*(y.x<0?1:M),b.x*(b.x<0?1:M)),y:w?-1:Math.min(y.y*(y.y<0?1:M),b.y*(b.y<0?1:M))},D={x:x?1:Math.max(y.x*(y.x>0?1:M),b.x*(b.x>0?1:M)),y:_?1:Math.max(y.y*(y.y>0?1:M),b.y*(b.y>0?1:M))},C={width:.5*(D.x-S.x),height:.5*(D.y-S.y)};u=Math.min(s/C.width,l/C.height),d={x:-.5*(D.x+S.x),y:-.5*(D.y+S.y)}}for(e=0,i=c.length;e<i;++e)c[e]._options=n._resolveElementOptions(c[e],e);for(a.borderWidth=n.getMaxBorderWidth(),a.outerRadius=Math.max((u-a.borderWidth)/2,0),a.innerRadius=Math.max(f?a.outerRadius/100*f:0,0),a.radiusLength=(a.outerRadius-a.innerRadius)/(n._getVisibleDatasetWeightTotal()||1),a.offsetX=d.x*a.outerRadius,a.offsetY=d.y*a.outerRadius,h.total=n.calculateTotal(),n.outerRadius=a.outerRadius-a.radiusLength*n._getRingWeightOffset(n.index),n.innerRadius=Math.max(n.outerRadius-a.radiusLength*m,0),e=0,i=c.length;e<i;++e)n.updateElement(c[e],e,t)},updateElement:function(t,e,i){var n=this,a=n.chart,r=a.chartArea,o=a.options,s=o.animation,l=(r.left+r.right)/2,u=(r.top+r.bottom)/2,d=o.rotation,h=o.rotation,c=n.getDataset(),f=i&&s.animateRotate?0:t.hidden?0:n.calculateCircumference(c.data[e])*(o.circumference/(2*Math.PI)),g=i&&s.animateScale?0:n.innerRadius,m=i&&s.animateScale?0:n.outerRadius,p=t._options||{};ut.extend(t,{_datasetIndex:n.index,_index:e,_model:{backgroundColor:p.backgroundColor,borderColor:p.borderColor,borderWidth:p.borderWidth,borderAlign:p.borderAlign,x:l+a.offsetX,y:u+a.offsetY,startAngle:d,endAngle:h,circumference:f,outerRadius:m,innerRadius:g,label:ut.valueAtIndexOrDefault(c.label,e,a.data.labels[e])}});var v=t._model;i&&s.animateRotate||(v.startAngle=0===e?o.rotation:n.getMeta().data[e-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},calculateTotal:function(){var t,e=this.getDataset(),i=this.getMeta(),n=0;return ut.each(i.data,function(i,a){t=e.data[a],isNaN(t)||i.hidden||(n+=Math.abs(t))}),n},calculateCircumference:function(t){var e=this.getMeta().total;return e>0&&!isNaN(t)?2*Math.PI*(Math.abs(t)/e):0},getMaxBorderWidth:function(t){var e,i,n,a,r,o,s,l,u=0,d=this.chart;if(!t)for(e=0,i=d.data.datasets.length;e<i;++e)if(d.isDatasetVisible(e)){t=(n=d.getDatasetMeta(e)).data,e!==this.index&&(r=n.controller);break}if(!t)return 0;for(e=0,i=t.length;e<i;++e)a=t[e],"inner"!==(o=r?r._resolveElementOptions(a,e):a._options).borderAlign&&(s=o.borderWidth,u=(l=o.hoverBorderWidth)>(u=s>u?s:u)?l:u);return u},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=$t(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=$t(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=$t(i.hoverBorderWidth,i.borderWidth)},_resolveElementOptions:function(t,e){var i,n,a,r=this.chart,o=this.getDataset(),s=t.custom||{},l=r.options.elements.arc,u={},d={chart:r,dataIndex:e,dataset:o,datasetIndex:this.index},h=["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"];for(i=0,n=h.length;i<n;++i)u[a=h[i]]=Zt([s[a],o[a],l[a]],d,e);return u},_getRingWeightOffset:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e},_getRingWeight:function(t){return Math.max($t(this.chart.data.datasets[t].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});ot._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}});var Kt=jt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Jt=ut.valueOrDefault,Qt=ut.options.resolve,te=ut.canvas._isPointInArea;function ee(t,e){return Jt(t.showLine,e.showLines)}ot._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var ie=kt.extend({datasetElementType:Nt.Line,dataElementType:Nt.Point,update:function(t){var e,i,n=this,a=n.getMeta(),r=a.dataset,o=a.data||[],s=n.getScaleForId(a.yAxisID),l=n.getDataset(),u=ee(l,n.chart.options);for(u&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=s,r._datasetIndex=n.index,r._children=o,r._model=n._resolveLineOptions(r),r.pivot()),e=0,i=o.length;e<i;++e)n.updateElement(o[e],e,t);for(u&&0!==r._model.tension&&n.updateBezierControlPoints(),e=0,i=o.length;e<i;++e)o[e].pivot()},updateElement:function(t,e,i){var n,a,r=this,o=r.getMeta(),s=t.custom||{},l=r.getDataset(),u=r.index,d=l.data[e],h=r.getScaleForId(o.yAxisID),c=r.getScaleForId(o.xAxisID),f=o.dataset._model,g=r._resolvePointOptions(t,e);n=c.getPixelForValue("object"==typeof d?d:NaN,e,u),a=i?h.getBasePixel():r.calculatePointY(d,e,u),t._xScale=c,t._yScale=h,t._options=g,t._datasetIndex=u,t._index=e,t._model={x:n,y:a,skip:s.skip||isNaN(n)||isNaN(a),radius:g.radius,pointStyle:g.pointStyle,rotation:g.rotation,backgroundColor:g.backgroundColor,borderColor:g.borderColor,borderWidth:g.borderWidth,tension:Jt(s.tension,f?f.tension:0),steppedLine:!!f&&f.steppedLine,hitRadius:g.hitRadius}},_resolvePointOptions:function(t,e){var i,n,a,r=this.chart,o=r.data.datasets[this.index],s=t.custom||{},l=r.options.elements.point,u={},d={chart:r,dataIndex:e,dataset:o,datasetIndex:this.index},h={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},c=Object.keys(h);for(i=0,n=c.length;i<n;++i)u[a=c[i]]=Qt([s[a],o[h[a]],o[a],l[a]],d,e);return u},_resolveLineOptions:function(t){var e,i,n,a=this.chart,r=a.data.datasets[this.index],o=t.custom||{},s=a.options,l=s.elements.line,u={},d=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill","cubicInterpolationMode"];for(e=0,i=d.length;e<i;++e)u[n=d[e]]=Qt([o[n],r[n],l[n]]);return u.spanGaps=Jt(r.spanGaps,s.spanGaps),u.tension=Jt(r.lineTension,l.tension),u.steppedLine=Qt([o.steppedLine,r.steppedLine,l.stepped]),u},calculatePointY:function(t,e,i){var n,a,r,o=this.chart,s=this.getMeta(),l=this.getScaleForId(s.yAxisID),u=0,d=0;if(l.options.stacked){for(n=0;n<i;n++)if(a=o.data.datasets[n],"line"===(r=o.getDatasetMeta(n)).type&&r.yAxisID===l.id&&o.isDatasetVisible(n)){var h=Number(l.getRightValue(a.data[e]));h<0?d+=h||0:u+=h||0}var c=Number(l.getRightValue(t));return c<0?l.getPixelForValue(d+c):l.getPixelForValue(u+c)}return l.getPixelForValue(t)},updateBezierControlPoints:function(){var t,e,i,n,a=this.chart,r=this.getMeta(),o=r.dataset._model,s=a.chartArea,l=r.data||[];function u(t,e,i){return Math.max(Math.min(t,i),e)}if(o.spanGaps&&(l=l.filter(function(t){return!t._model.skip})),"monotone"===o.cubicInterpolationMode)ut.splineCurveMonotone(l);else for(t=0,e=l.length;t<e;++t)i=l[t]._model,n=ut.splineCurve(ut.previousItem(l,t)._model,i,ut.nextItem(l,t)._model,o.tension),i.controlPointPreviousX=n.previous.x,i.controlPointPreviousY=n.previous.y,i.controlPointNextX=n.next.x,i.controlPointNextY=n.next.y;if(a.options.elements.line.capBezierPoints)for(t=0,e=l.length;t<e;++t)i=l[t]._model,te(i,s)&&(t>0&&te(l[t-1]._model,s)&&(i.controlPointPreviousX=u(i.controlPointPreviousX,s.left,s.right),i.controlPointPreviousY=u(i.controlPointPreviousY,s.top,s.bottom)),t<l.length-1&&te(l[t+1]._model,s)&&(i.controlPointNextX=u(i.controlPointNextX,s.left,s.right),i.controlPointNextY=u(i.controlPointNextY,s.top,s.bottom)))},draw:function(){var t,e=this.chart,i=this.getMeta(),n=i.data||[],a=e.chartArea,r=n.length,o=0;for(ee(this.getDataset(),e.options)&&(t=(i.dataset._model.borderWidth||0)/2,ut.canvas.clipArea(e.ctx,{left:a.left,right:a.right,top:a.top-t,bottom:a.bottom+t}),i.dataset.draw(),ut.canvas.unclipArea(e.ctx));o<r;++o)n[o].draw(a)},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Jt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Jt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Jt(i.hoverBorderWidth,i.borderWidth),e.radius=Jt(i.hoverRadius,i.radius)}}),ne=ut.options.resolve;ot._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,a=i.labels;if(n.length)for(var r=0;r<n[0].data.length;++r)e.push('<li><span style="background-color:'+n[0].backgroundColor[r]+'"></span>'),a[r]&&e.push(a[r]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map(function(i,n){var a=t.getDatasetMeta(0),r=e.datasets[0],o=a.data[n].custom||{},s=t.options.elements.arc;return{text:i,fillStyle:ne([o.backgroundColor,r.backgroundColor,s.backgroundColor],void 0,n),strokeStyle:ne([o.borderColor,r.borderColor,s.borderColor],void 0,n),lineWidth:ne([o.borderWidth,r.borderWidth,s.borderWidth],void 0,n),hidden:isNaN(r.data[n])||a.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var i,n,a,r=e.index,o=this.chart;for(i=0,n=(o.data.datasets||[]).length;i<n;++i)(a=o.getDatasetMeta(i)).data[r].hidden=!a.data[r].hidden;o.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}});var ae=kt.extend({dataElementType:Nt.Arc,linkScales:ut.noop,update:function(t){var e,i,n,a=this,r=a.getDataset(),o=a.getMeta(),s=a.chart.options.startAngle||0,l=a._starts=[],u=a._angles=[],d=o.data;for(a._updateRadius(),o.count=a.countVisibleElements(),e=0,i=r.data.length;e<i;e++)l[e]=s,n=a._computeAngle(e),u[e]=n,s+=n;for(e=0,i=d.length;e<i;++e)d[e]._options=a._resolveElementOptions(d[e],e),a.updateElement(d[e],e,t)},_updateRadius:function(){var t=this,e=t.chart,i=e.chartArea,n=e.options,a=Math.min(i.right-i.left,i.bottom-i.top);e.outerRadius=Math.max(a/2,0),e.innerRadius=Math.max(n.cutoutPercentage?e.outerRadius/100*n.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),t.outerRadius=e.outerRadius-e.radiusLength*t.index,t.innerRadius=t.outerRadius-e.radiusLength},updateElement:function(t,e,i){var n=this,a=n.chart,r=n.getDataset(),o=a.options,s=o.animation,l=a.scale,u=a.data.labels,d=l.xCenter,h=l.yCenter,c=o.startAngle,f=t.hidden?0:l.getDistanceFromCenterForValue(r.data[e]),g=n._starts[e],m=g+(t.hidden?0:n._angles[e]),p=s.animateScale?0:l.getDistanceFromCenterForValue(r.data[e]),v=t._options||{};ut.extend(t,{_datasetIndex:n.index,_index:e,_scale:l,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,x:d,y:h,innerRadius:0,outerRadius:i?p:f,startAngle:i&&s.animateRotate?c:g,endAngle:i&&s.animateRotate?c:m,label:ut.valueAtIndexOrDefault(u,e,u[e])}}),t.pivot()},countVisibleElements:function(){var t=this.getDataset(),e=this.getMeta(),i=0;return ut.each(e.data,function(e,n){isNaN(t.data[n])||e.hidden||i++}),i},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor,a=ut.valueOrDefault;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=a(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=a(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=a(i.hoverBorderWidth,i.borderWidth)},_resolveElementOptions:function(t,e){var i,n,a,r=this.chart,o=this.getDataset(),s=t.custom||{},l=r.options.elements.arc,u={},d={chart:r,dataIndex:e,dataset:o,datasetIndex:this.index},h=["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"];for(i=0,n=h.length;i<n;++i)u[a=h[i]]=ne([s[a],o[a],l[a]],d,e);return u},_computeAngle:function(t){var e=this,i=this.getMeta().count,n=e.getDataset(),a=e.getMeta();if(isNaN(n.data[t])||a.data[t].hidden)return 0;var r={chart:e.chart,dataIndex:t,dataset:n,datasetIndex:e.index};return ne([e.chart.options.elements.arc.angle,2*Math.PI/i],r,t)}});ot._set("pie",ut.clone(ot.doughnut)),ot._set("pie",{cutoutPercentage:0});var re=Xt,oe=ut.valueOrDefault,se=ut.options.resolve;ot._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}});var le=kt.extend({datasetElementType:Nt.Line,dataElementType:Nt.Point,linkScales:ut.noop,update:function(t){var e,i,n=this,a=n.getMeta(),r=a.dataset,o=a.data||[],s=n.chart.scale,l=n.getDataset();for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=s,r._datasetIndex=n.index,r._children=o,r._loop=!0,r._model=n._resolveLineOptions(r),r.pivot(),e=0,i=o.length;e<i;++e)n.updateElement(o[e],e,t);for(n.updateBezierControlPoints(),e=0,i=o.length;e<i;++e)o[e].pivot()},updateElement:function(t,e,i){var n=this,a=t.custom||{},r=n.getDataset(),o=n.chart.scale,s=o.getPointPositionForValue(e,r.data[e]),l=n._resolvePointOptions(t,e),u=n.getMeta().dataset._model,d=i?o.xCenter:s.x,h=i?o.yCenter:s.y;t._scale=o,t._options=l,t._datasetIndex=n.index,t._index=e,t._model={x:d,y:h,skip:a.skip||isNaN(d)||isNaN(h),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:oe(a.tension,u?u.tension:0),hitRadius:l.hitRadius}},_resolvePointOptions:function(t,e){var i,n,a,r=this.chart,o=r.data.datasets[this.index],s=t.custom||{},l=r.options.elements.point,u={},d={chart:r,dataIndex:e,dataset:o,datasetIndex:this.index},h={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},c=Object.keys(h);for(i=0,n=c.length;i<n;++i)u[a=c[i]]=se([s[a],o[h[a]],o[a],l[a]],d,e);return u},_resolveLineOptions:function(t){var e,i,n,a=this.chart,r=a.data.datasets[this.index],o=t.custom||{},s=a.options.elements.line,l={},u=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"];for(e=0,i=u.length;e<i;++e)l[n=u[e]]=se([o[n],r[n],s[n]]);return l.tension=oe(r.lineTension,s.tension),l},updateBezierControlPoints:function(){var t,e,i,n,a=this.getMeta(),r=this.chart.chartArea,o=a.data||[];function s(t,e,i){return Math.max(Math.min(t,i),e)}for(t=0,e=o.length;t<e;++t)i=o[t]._model,n=ut.splineCurve(ut.previousItem(o,t,!0)._model,i,ut.nextItem(o,t,!0)._model,i.tension),i.controlPointPreviousX=s(n.previous.x,r.left,r.right),i.controlPointPreviousY=s(n.previous.y,r.top,r.bottom),i.controlPointNextX=s(n.next.x,r.left,r.right),i.controlPointNextY=s(n.next.y,r.top,r.bottom)},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=oe(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=oe(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=oe(i.hoverBorderWidth,i.borderWidth),e.radius=oe(i.hoverRadius,i.radius)}});ot._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:!1,tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}});var ue={bar:jt,bubble:qt,doughnut:Xt,horizontalBar:Kt,line:ie,polarArea:ae,pie:re,radar:le,scatter:ie};function de(t,e){return t.native?{x:t.x,y:t.y}:ut.getRelativePosition(t,e)}function he(t,e){var i,n,a,r,o;for(n=0,r=t.data.datasets.length;n<r;++n)if(t.isDatasetVisible(n))for(a=0,o=(i=t.getDatasetMeta(n)).data.length;a<o;++a){var s=i.data[a];s._view.skip||e(s)}}function ce(t,e){var i=[];return he(t,function(t){t.inRange(e.x,e.y)&&i.push(t)}),i}function fe(t,e,i,n){var a=Number.POSITIVE_INFINITY,r=[];return he(t,function(t){if(!i||t.inRange(e.x,e.y)){var o=t.getCenterPoint(),s=n(e,o);s<a?(r=[t],a=s):s===a&&r.push(t)}}),r}function ge(t){var e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,n){var a=e?Math.abs(t.x-n.x):0,r=i?Math.abs(t.y-n.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(r,2))}}function me(t,e,i){var n=de(e,t);i.axis=i.axis||"x";var a=ge(i.axis),r=i.intersect?ce(t,n):fe(t,n,!1,a),o=[];return r.length?(t.data.datasets.forEach(function(e,i){if(t.isDatasetVisible(i)){var n=t.getDatasetMeta(i).data[r[0]._index];n&&!n._view.skip&&o.push(n)}}),o):[]}var pe={modes:{single:function(t,e){var i=de(e,t),n=[];return he(t,function(t){if(t.inRange(i.x,i.y))return n.push(t),n}),n.slice(0,1)},label:me,index:me,dataset:function(t,e,i){var n=de(e,t);i.axis=i.axis||"xy";var a=ge(i.axis),r=i.intersect?ce(t,n):fe(t,n,!1,a);return r.length>0&&(r=t.getDatasetMeta(r[0]._datasetIndex).data),r},"x-axis":function(t,e){return me(t,e,{intersect:!1})},point:function(t,e){return ce(t,de(e,t))},nearest:function(t,e,i){var n=de(e,t);i.axis=i.axis||"xy";var a=ge(i.axis);return fe(t,n,i.intersect,a)},x:function(t,e,i){var n=de(e,t),a=[],r=!1;return he(t,function(t){t.inXRange(n.x)&&a.push(t),t.inRange(n.x,n.y)&&(r=!0)}),i.intersect&&!r&&(a=[]),a},y:function(t,e,i){var n=de(e,t),a=[],r=!1;return he(t,function(t){t.inYRange(n.y)&&a.push(t),t.inRange(n.x,n.y)&&(r=!0)}),i.intersect&&!r&&(a=[]),a}}};function ve(t,e){return ut.where(t,function(t){return t.position===e})}function ye(t,e){t.forEach(function(t,e){return t._tmpIndex_=e,t}),t.sort(function(t,i){var n=e?i:t,a=e?t:i;return n.weight===a.weight?n._tmpIndex_-a._tmpIndex_:n.weight-a.weight}),t.forEach(function(t){delete t._tmpIndex_})}function be(t,e){ut.each(t,function(t){e[t.position]+=t.isHorizontal()?t.height:t.width})}ot._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var xe={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),e.fullWidth=e.fullWidth||!1,e.position=e.position||"top",e.weight=e.weight||0,t.boxes.push(e)},removeBox:function(t,e){var i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure:function(t,e,i){for(var n,a=["fullWidth","position","weight"],r=a.length,o=0;o<r;++o)n=a[o],i.hasOwnProperty(n)&&(e[n]=i[n])},update:function(t,e,i){if(t){var n=t.options.layout||{},a=ut.options.toPadding(n.padding),r=a.left,o=a.right,s=a.top,l=a.bottom,u=ve(t.boxes,"left"),d=ve(t.boxes,"right"),h=ve(t.boxes,"top"),c=ve(t.boxes,"bottom"),f=ve(t.boxes,"chartArea");ye(u,!0),ye(d,!1),ye(h,!0),ye(c,!1);var g,m=u.concat(d),p=h.concat(c),v=m.concat(p),y=e-r-o,b=i-s-l,x=(e-y/2)/m.length,_=y,k=b,w={top:s,left:r,bottom:l,right:o},M=[];ut.each(v,function(t){var e,i=t.isHorizontal();i?(e=t.update(t.fullWidth?y:_,b/2),k-=e.height):(e=t.update(x,k),_-=e.width),M.push({horizontal:i,width:e.width,box:t})}),g=function(t){var e=0,i=0,n=0,a=0;return ut.each(t,function(t){if(t.getPadding){var r=t.getPadding();e=Math.max(e,r.top),i=Math.max(i,r.left),n=Math.max(n,r.bottom),a=Math.max(a,r.right)}}),{top:e,left:i,bottom:n,right:a}}(v),ut.each(m,I),be(m,w),ut.each(p,I),be(p,w),ut.each(m,function(t){var e=ut.findNextWhere(M,function(e){return e.box===t}),i={left:0,right:0,top:w.top,bottom:w.bottom};e&&t.update(e.width,k,i)}),be(v,w={top:s,left:r,bottom:l,right:o});var S=Math.max(g.left-w.left,0);w.left+=S,w.right+=Math.max(g.right-w.right,0);var D=Math.max(g.top-w.top,0);w.top+=D,w.bottom+=Math.max(g.bottom-w.bottom,0);var C=i-w.top-w.bottom,P=e-w.left-w.right;P===_&&C===k||(ut.each(m,function(t){t.height=C}),ut.each(p,function(t){t.fullWidth||(t.width=P)}),k=C,_=P);var T=r+S,O=s+D;ut.each(u.concat(h),A),T+=_,O+=k,ut.each(d,A),ut.each(c,A),t.chartArea={left:w.left,top:w.top,right:w.left+_,bottom:w.top+k},ut.each(f,function(e){e.left=t.chartArea.left,e.top=t.chartArea.top,e.right=t.chartArea.right,e.bottom=t.chartArea.bottom,e.update(_,k)})}function I(t){var e=ut.findNextWhere(M,function(e){return e.box===t});if(e)if(e.horizontal){var i={left:Math.max(w.left,g.left),right:Math.max(w.right,g.right),top:0,bottom:0};t.update(t.fullWidth?y:_,b/2,i)}else t.update(e.width,k)}function A(t){t.isHorizontal()?(t.left=t.fullWidth?r:w.left,t.right=t.fullWidth?e-o:w.left+_,t.top=O,t.bottom=O+t.height,O=t.bottom):(t.left=T,t.right=T+t.width,t.top=w.top,t.bottom=w.top+k,T=t.right)}}};"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function _e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}var ke,we=(ke=Object.freeze({default:"@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}"}))&&ke.default||ke,Me="$chartjs",Se="chartjs-size-monitor",De="chartjs-render-monitor",Ce="chartjs-render-animation",Pe=["animationstart","webkitAnimationStart"],Te={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function Oe(t,e){var i=ut.getStyle(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):void 0}var Ie=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0};function Ae(t,e,i){t.addEventListener(e,i,Ie)}function Fe(t,e,i){t.removeEventListener(e,i,Ie)}function Re(t,e,i,n,a){return{type:t,chart:e,native:a||null,x:void 0!==i?i:null,y:void 0!==n?n:null}}function Le(t){var e=document.createElement("div");return e.className=t||"",e}function We(t,e,i){var n,a,r,o,s=t[Me]||(t[Me]={}),l=s.resizer=function(t){var e=Le(Se),i=Le(Se+"-expand"),n=Le(Se+"-shrink");i.appendChild(Le()),n.appendChild(Le()),e.appendChild(i),e.appendChild(n),e._reset=function(){i.scrollLeft=1e6,i.scrollTop=1e6,n.scrollLeft=1e6,n.scrollTop=1e6};var a=function(){e._reset(),t()};return Ae(i,"scroll",a.bind(i,"expand")),Ae(n,"scroll",a.bind(n,"shrink")),e}((n=function(){if(s.resizer){var n=i.options.maintainAspectRatio&&t.parentNode,a=n?n.clientWidth:0;e(Re("resize",i)),n&&n.clientWidth<a&&i.canvas&&e(Re("resize",i))}},r=!1,o=[],function(){o=Array.prototype.slice.call(arguments),a=a||this,r||(r=!0,ut.requestAnimFrame.call(window,function(){r=!1,n.apply(a,o)}))}));!function(t,e){var i=t[Me]||(t[Me]={}),n=i.renderProxy=function(t){t.animationName===Ce&&e()};ut.each(Pe,function(e){Ae(t,e,n)}),i.reflow=!!t.offsetParent,t.classList.add(De)}(t,function(){if(s.resizer){var e=t.parentNode;e&&e!==l.parentNode&&e.insertBefore(l,e.firstChild),l._reset()}})}function Ye(t){var e=t[Me]||{},i=e.resizer;delete e.resizer,function(t){var e=t[Me]||{},i=e.renderProxy;i&&(ut.each(Pe,function(e){Fe(t,e,i)}),delete e.renderProxy),t.classList.remove(De)}(t),i&&i.parentNode&&i.parentNode.removeChild(i)}var Ne={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(){var t,e,i;this._loaded||(this._loaded=!0,this.disableCSSInjection||(e=we,i=(t=this)._style||document.createElement("style"),t._style||(t._style=i,e="/* Chart.js */\n"+e,i.setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(i)),i.appendChild(document.createTextNode(e))))},acquireContext:function(t,e){"string"==typeof t?t=document.getElementById(t):t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas);var i=t&&t.getContext&&t.getContext("2d");return this._ensureLoaded(),i&&i.canvas===t?(function(t,e){var i=t.style,n=t.getAttribute("height"),a=t.getAttribute("width");if(t[Me]={initial:{height:n,width:a,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",null===a||""===a){var r=Oe(t,"width");void 0!==r&&(t.width=r)}if(null===n||""===n)if(""===t.style.height)t.height=t.width/(e.options.aspectRatio||2);else{var o=Oe(t,"height");void 0!==r&&(t.height=o)}}(t,e),i):null},releaseContext:function(t){var e=t.canvas;if(e[Me]){var i=e[Me].initial;["height","width"].forEach(function(t){var n=i[t];ut.isNullOrUndef(n)?e.removeAttribute(t):e.setAttribute(t,n)}),ut.each(i.style||{},function(t,i){e.style[i]=t}),e.width=e.width,delete e[Me]}},addEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var a=i[Me]||(i[Me]={});Ae(n,e,(a.proxies||(a.proxies={}))[t.id+"_"+e]=function(e){i(function(t,e){var i=Te[t.type]||t.type,n=ut.getRelativePosition(t,e);return Re(i,e,n.x,n.y,t)}(e,t))})}else We(n,i,t)},removeEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var a=((i[Me]||{}).proxies||{})[t.id+"_"+e];a&&Fe(n,e,a)}else Ye(n)}};ut.addEvent=Ae,ut.removeEvent=Fe;var ze=Ne._enabled?Ne:{acquireContext:function(t){return t&&t.canvas&&(t=t.canvas),t&&t.getContext("2d")||null}},Ve=ut.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},ze);ot._set("global",{plugins:{}});var He={_plugins:[],_cacheId:0,register:function(t){var e=this._plugins;[].concat(t).forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),this._cacheId++},unregister:function(t){var e=this._plugins;[].concat(t).forEach(function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e,i){var n,a,r,o,s,l=this.descriptors(t),u=l.length;for(n=0;n<u;++n)if("function"==typeof(s=(r=(a=l[n]).plugin)[e])&&((o=[t].concat(i||[])).push(a.options),!1===s.apply(r,o)))return!1;return!0},descriptors:function(t){var e=t.$plugins||(t.$plugins={});if(e.id===this._cacheId)return e.descriptors;var i=[],n=[],a=t&&t.config||{},r=a.options&&a.options.plugins||{};return this._plugins.concat(a.plugins||[]).forEach(function(t){if(-1===i.indexOf(t)){var e=t.id,a=r[e];!1!==a&&(!0===a&&(a=ut.clone(ot.global.plugins[e])),i.push(t),n.push({plugin:t,options:a||{}}))}}),e.descriptors=n,e.id=this._cacheId,n},_invalidate:function(t){delete t.$plugins}},Ee={constructors:{},defaults:{},registerScaleType:function(t,e,i){this.constructors[t]=e,this.defaults[t]=ut.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?ut.merge({},[ot.scale,this.defaults[t]]):{}},updateScaleDefaults:function(t,e){this.defaults.hasOwnProperty(t)&&(this.defaults[t]=ut.extend(this.defaults[t],e))},addScalesToLayout:function(t){ut.each(t.scales,function(e){e.fullWidth=e.options.fullWidth,e.position=e.options.position,e.weight=e.options.weight,xe.addBox(t,e)})}},Be=ut.valueOrDefault;ot._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:ut.noop,title:function(t,e){var i="",n=e.labels,a=n?n.length:0;if(t.length>0){var r=t[0];r.label?i=r.label:r.xLabel?i=r.xLabel:a>0&&r.index<a&&(i=n[r.index])}return i},afterTitle:ut.noop,beforeBody:ut.noop,beforeLabel:ut.noop,label:function(t,e){var i=e.datasets[t.datasetIndex].label||"";return i&&(i+=": "),ut.isNullOrUndef(t.value)?i+=t.yLabel:i+=t.value,i},labelColor:function(t,e){var i=e.getDatasetMeta(t.datasetIndex).data[t.index]._view;return{borderColor:i.borderColor,backgroundColor:i.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:ut.noop,afterBody:ut.noop,beforeFooter:ut.noop,footer:ut.noop,afterFooter:ut.noop}}});var je={average:function(t){if(!t.length)return!1;var e,i,n=0,a=0,r=0;for(e=0,i=t.length;e<i;++e){var o=t[e];if(o&&o.hasValue()){var s=o.tooltipPosition();n+=s.x,a+=s.y,++r}}return{x:n/r,y:a/r}},nearest:function(t,e){var i,n,a,r=e.x,o=e.y,s=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){var l=t[i];if(l&&l.hasValue()){var u=l.getCenterPoint(),d=ut.distanceBetweenPoints(e,u);d<s&&(s=d,a=l)}}if(a){var h=a.tooltipPosition();r=h.x,o=h.y}return{x:r,y:o}}};function Ue(t,e){return e&&(ut.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ge(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function qe(t){var e=ot.global;return{xPadding:t.xPadding,yPadding:t.yPadding,xAlign:t.xAlign,yAlign:t.yAlign,bodyFontColor:t.bodyFontColor,_bodyFontFamily:Be(t.bodyFontFamily,e.defaultFontFamily),_bodyFontStyle:Be(t.bodyFontStyle,e.defaultFontStyle),_bodyAlign:t.bodyAlign,bodyFontSize:Be(t.bodyFontSize,e.defaultFontSize),bodySpacing:t.bodySpacing,titleFontColor:t.titleFontColor,_titleFontFamily:Be(t.titleFontFamily,e.defaultFontFamily),_titleFontStyle:Be(t.titleFontStyle,e.defaultFontStyle),titleFontSize:Be(t.titleFontSize,e.defaultFontSize),_titleAlign:t.titleAlign,titleSpacing:t.titleSpacing,titleMarginBottom:t.titleMarginBottom,footerFontColor:t.footerFontColor,_footerFontFamily:Be(t.footerFontFamily,e.defaultFontFamily),_footerFontStyle:Be(t.footerFontStyle,e.defaultFontStyle),footerFontSize:Be(t.footerFontSize,e.defaultFontSize),_footerAlign:t.footerAlign,footerSpacing:t.footerSpacing,footerMarginTop:t.footerMarginTop,caretSize:t.caretSize,cornerRadius:t.cornerRadius,backgroundColor:t.backgroundColor,opacity:0,legendColorBackground:t.multiKeyBackground,displayColors:t.displayColors,borderColor:t.borderColor,borderWidth:t.borderWidth}}function Ze(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}function $e(t){return Ue([],Ge(t))}var Xe=gt.extend({initialize:function(){this._model=qe(this._options),this._lastActive=[]},getTitle:function(){var t=this._options.callbacks,e=t.beforeTitle.apply(this,arguments),i=t.title.apply(this,arguments),n=t.afterTitle.apply(this,arguments),a=[];return a=Ue(a,Ge(e)),a=Ue(a,Ge(i)),a=Ue(a,Ge(n))},getBeforeBody:function(){return $e(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(t,e){var i=this,n=i._options.callbacks,a=[];return ut.each(t,function(t){var r={before:[],lines:[],after:[]};Ue(r.before,Ge(n.beforeLabel.call(i,t,e))),Ue(r.lines,n.label.call(i,t,e)),Ue(r.after,Ge(n.afterLabel.call(i,t,e))),a.push(r)}),a},getAfterBody:function(){return $e(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var t=this._options.callbacks,e=t.beforeFooter.apply(this,arguments),i=t.footer.apply(this,arguments),n=t.afterFooter.apply(this,arguments),a=[];return a=Ue(a,Ge(e)),a=Ue(a,Ge(i)),a=Ue(a,Ge(n))},update:function(t){var e,i,n,a,r,o,s,l,u,d,h=this,c=h._options,f=h._model,g=h._model=qe(c),m=h._active,p=h._data,v={xAlign:f.xAlign,yAlign:f.yAlign},y={x:f.x,y:f.y},b={width:f.width,height:f.height},x={x:f.caretX,y:f.caretY};if(m.length){g.opacity=1;var _=[],k=[];x=je[c.position].call(h,m,h._eventPosition);var w=[];for(e=0,i=m.length;e<i;++e)w.push((n=m[e],a=void 0,r=void 0,o=void 0,s=void 0,l=void 0,u=void 0,d=void 0,a=n._xScale,r=n._yScale||n._scale,o=n._index,s=n._datasetIndex,l=n._chart.getDatasetMeta(s).controller,u=l._getIndexScale(),d=l._getValueScale(),{xLabel:a?a.getLabelForIndex(o,s):"",yLabel:r?r.getLabelForIndex(o,s):"",label:u?""+u.getLabelForIndex(o,s):"",value:d?""+d.getLabelForIndex(o,s):"",index:o,datasetIndex:s,x:n._model.x,y:n._model.y}));c.filter&&(w=w.filter(function(t){return c.filter(t,p)})),c.itemSort&&(w=w.sort(function(t,e){return c.itemSort(t,e,p)})),ut.each(w,function(t){_.push(c.callbacks.labelColor.call(h,t,h._chart)),k.push(c.callbacks.labelTextColor.call(h,t,h._chart))}),g.title=h.getTitle(w,p),g.beforeBody=h.getBeforeBody(w,p),g.body=h.getBody(w,p),g.afterBody=h.getAfterBody(w,p),g.footer=h.getFooter(w,p),g.x=x.x,g.y=x.y,g.caretPadding=c.caretPadding,g.labelColors=_,g.labelTextColors=k,g.dataPoints=w,b=function(t,e){var i=t._chart.ctx,n=2*e.yPadding,a=0,r=e.body,o=r.reduce(function(t,e){return t+e.before.length+e.lines.length+e.after.length},0);o+=e.beforeBody.length+e.afterBody.length;var s=e.title.length,l=e.footer.length,u=e.titleFontSize,d=e.bodyFontSize,h=e.footerFontSize;n+=s*u,n+=s?(s-1)*e.titleSpacing:0,n+=s?e.titleMarginBottom:0,n+=o*d,n+=o?(o-1)*e.bodySpacing:0,n+=l?e.footerMarginTop:0,n+=l*h,n+=l?(l-1)*e.footerSpacing:0;var c=0,f=function(t){a=Math.max(a,i.measureText(t).width+c)};return i.font=ut.fontString(u,e._titleFontStyle,e._titleFontFamily),ut.each(e.title,f),i.font=ut.fontString(d,e._bodyFontStyle,e._bodyFontFamily),ut.each(e.beforeBody.concat(e.afterBody),f),c=e.displayColors?d+2:0,ut.each(r,function(t){ut.each(t.before,f),ut.each(t.lines,f),ut.each(t.after,f)}),c=0,i.font=ut.fontString(h,e._footerFontStyle,e._footerFontFamily),ut.each(e.footer,f),{width:a+=2*e.xPadding,height:n}}(this,g),y=function(t,e,i,n){var a=t.x,r=t.y,o=t.caretSize,s=t.caretPadding,l=t.cornerRadius,u=i.xAlign,d=i.yAlign,h=o+s,c=l+s;return"right"===u?a-=e.width:"center"===u&&((a-=e.width/2)+e.width>n.width&&(a=n.width-e.width),a<0&&(a=0)),"top"===d?r+=h:r-="bottom"===d?e.height+h:e.height/2,"center"===d?"left"===u?a+=h:"right"===u&&(a-=h):"left"===u?a-=c:"right"===u&&(a+=c),{x:a,y:r}}(g,b,v=function(t,e){var i,n,a,r,o,s=t._model,l=t._chart,u=t._chart.chartArea,d="center",h="center";s.y<e.height?h="top":s.y>l.height-e.height&&(h="bottom");var c=(u.left+u.right)/2,f=(u.top+u.bottom)/2;"center"===h?(i=function(t){return t<=c},n=function(t){return t>c}):(i=function(t){return t<=e.width/2},n=function(t){return t>=l.width-e.width/2}),a=function(t){return t+e.width+s.caretSize+s.caretPadding>l.width},r=function(t){return t-e.width-s.caretSize-s.caretPadding<0},o=function(t){return t<=f?"top":"bottom"},i(s.x)?(d="left",a(s.x)&&(d="center",h=o(s.y))):n(s.x)&&(d="right",r(s.x)&&(d="center",h=o(s.y)));var g=t._options;return{xAlign:g.xAlign?g.xAlign:d,yAlign:g.yAlign?g.yAlign:h}}(this,b),h._chart)}else g.opacity=0;return g.xAlign=v.xAlign,g.yAlign=v.yAlign,g.x=y.x,g.y=y.y,g.width=b.width,g.height=b.height,g.caretX=x.x,g.caretY=x.y,h._model=g,t&&c.custom&&c.custom.call(h,g),h},drawCaret:function(t,e){var i=this._chart.ctx,n=this._view,a=this.getCaretPosition(t,e,n);i.lineTo(a.x1,a.y1),i.lineTo(a.x2,a.y2),i.lineTo(a.x3,a.y3)},getCaretPosition:function(t,e,i){var n,a,r,o,s,l,u=i.caretSize,d=i.cornerRadius,h=i.xAlign,c=i.yAlign,f=t.x,g=t.y,m=e.width,p=e.height;if("center"===c)s=g+p/2,"left"===h?(a=(n=f)-u,r=n,o=s+u,l=s-u):(a=(n=f+m)+u,r=n,o=s-u,l=s+u);else if("left"===h?(n=(a=f+d+u)-u,r=a+u):"right"===h?(n=(a=f+m-d-u)-u,r=a+u):(n=(a=i.caretX)-u,r=a+u),"top"===c)s=(o=g)-u,l=o;else{s=(o=g+p)+u,l=o;var v=r;r=n,n=v}return{x1:n,x2:a,x3:r,y1:o,y2:s,y3:l}},drawTitle:function(t,e,i){var n=e.title;if(n.length){t.x=Ze(e,e._titleAlign),i.textAlign=e._titleAlign,i.textBaseline="top";var a,r,o=e.titleFontSize,s=e.titleSpacing;for(i.fillStyle=e.titleFontColor,i.font=ut.fontString(o,e._titleFontStyle,e._titleFontFamily),a=0,r=n.length;a<r;++a)i.fillText(n[a],t.x,t.y),t.y+=o+s,a+1===n.length&&(t.y+=e.titleMarginBottom-s)}},drawBody:function(t,e,i){var n,a=e.bodyFontSize,r=e.bodySpacing,o=e._bodyAlign,s=e.body,l=e.displayColors,u=e.labelColors,d=0,h=l?Ze(e,"left"):0;i.textAlign=o,i.textBaseline="top",i.font=ut.fontString(a,e._bodyFontStyle,e._bodyFontFamily),t.x=Ze(e,o);var c=function(e){i.fillText(e,t.x+d,t.y),t.y+=a+r};i.fillStyle=e.bodyFontColor,ut.each(e.beforeBody,c),d=l&&"right"!==o?"center"===o?a/2+1:a+2:0,ut.each(s,function(r,o){n=e.labelTextColors[o],i.fillStyle=n,ut.each(r.before,c),ut.each(r.lines,function(r){l&&(i.fillStyle=e.legendColorBackground,i.fillRect(h,t.y,a,a),i.lineWidth=1,i.strokeStyle=u[o].borderColor,i.strokeRect(h,t.y,a,a),i.fillStyle=u[o].backgroundColor,i.fillRect(h+1,t.y+1,a-2,a-2),i.fillStyle=n),c(r)}),ut.each(r.after,c)}),d=0,ut.each(e.afterBody,c),t.y-=r},drawFooter:function(t,e,i){var n=e.footer;n.length&&(t.x=Ze(e,e._footerAlign),t.y+=e.footerMarginTop,i.textAlign=e._footerAlign,i.textBaseline="top",i.fillStyle=e.footerFontColor,i.font=ut.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),ut.each(n,function(n){i.fillText(n,t.x,t.y),t.y+=e.footerFontSize+e.footerSpacing}))},drawBackground:function(t,e,i,n){i.fillStyle=e.backgroundColor,i.strokeStyle=e.borderColor,i.lineWidth=e.borderWidth;var a=e.xAlign,r=e.yAlign,o=t.x,s=t.y,l=n.width,u=n.height,d=e.cornerRadius;i.beginPath(),i.moveTo(o+d,s),"top"===r&&this.drawCaret(t,n),i.lineTo(o+l-d,s),i.quadraticCurveTo(o+l,s,o+l,s+d),"center"===r&&"right"===a&&this.drawCaret(t,n),i.lineTo(o+l,s+u-d),i.quadraticCurveTo(o+l,s+u,o+l-d,s+u),"bottom"===r&&this.drawCaret(t,n),i.lineTo(o+d,s+u),i.quadraticCurveTo(o,s+u,o,s+u-d),"center"===r&&"left"===a&&this.drawCaret(t,n),i.lineTo(o,s+d),i.quadraticCurveTo(o,s,o+d,s),i.closePath(),i.fill(),e.borderWidth>0&&i.stroke()},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var i={width:e.width,height:e.height},n={x:e.x,y:e.y},a=Math.abs(e.opacity<.001)?0:e.opacity,r=e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length;this._options.enabled&&r&&(t.save(),t.globalAlpha=a,this.drawBackground(n,e,t,i),n.y+=e.yPadding,this.drawTitle(n,e,t),this.drawBody(n,e,t),this.drawFooter(n,e,t),t.restore())}},handleEvent:function(t){var e,i=this,n=i._options;return i._lastActive=i._lastActive||[],"mouseout"===t.type?i._active=[]:i._active=i._chart.getElementsAtEventForMode(t,n.mode,n),(e=!ut.arrayEquals(i._active,i._lastActive))&&(i._lastActive=i._active,(n.enabled||n.custom)&&(i._eventPosition={x:t.x,y:t.y},i.update(!0),i.pivot())),e}}),Ke=je,Je=Xe;Je.positioners=Ke;var Qe=ut.valueOrDefault;function ti(){return ut.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){if("xAxes"===t||"yAxes"===t){var a,r,o,s=i[t].length;for(e[t]||(e[t]=[]),a=0;a<s;++a)o=i[t][a],r=Qe(o.type,"xAxes"===t?"category":"linear"),a>=e[t].length&&e[t].push({}),!e[t][a].type||o.type&&o.type!==e[t][a].type?ut.merge(e[t][a],[Ee.getScaleDefaults(r),o]):ut.merge(e[t][a],o)}else ut._merger(t,e,i,n)}})}function ei(){return ut.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){var a=e[t]||{},r=i[t];"scales"===t?e[t]=ti(a,r):"scale"===t?e[t]=ut.merge(a,[Ee.getScaleDefaults(r.type),r]):ut._merger(t,e,i,n)}})}function ii(t){return"top"===t||"bottom"===t}ot._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var ni=function(t,e){return this.construct(t,e),this};ut.extend(ni.prototype,{construct:function(t,e){var i=this;e=function(t){var e=(t=t||{}).data=t.data||{};return e.datasets=e.datasets||[],e.labels=e.labels||[],t.options=ei(ot.global,ot[t.type],t.options||{}),t}(e);var n=Ve.acquireContext(t,e),a=n&&n.canvas,r=a&&a.height,o=a&&a.width;i.id=ut.uid(),i.ctx=n,i.canvas=a,i.config=e,i.width=o,i.height=r,i.aspectRatio=r?o/r:null,i.options=e.options,i._bufferedRender=!1,i.chart=i,i.controller=i,ni.instances[i.id]=i,Object.defineProperty(i,"data",{get:function(){return i.config.data},set:function(t){i.config.data=t}}),n&&a?(i.initialize(),i.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var t=this;return He.notify(t,"beforeInit"),ut.retinaScale(t,t.options.devicePixelRatio),t.bindEvents(),t.options.responsive&&t.resize(!0),t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),t.initToolTip(),He.notify(t,"afterInit"),t},clear:function(){return ut.canvas.clear(this),this},stop:function(){return vt.cancelAnimation(this),this},resize:function(t){var e=this,i=e.options,n=e.canvas,a=i.maintainAspectRatio&&e.aspectRatio||null,r=Math.max(0,Math.floor(ut.getMaximumWidth(n))),o=Math.max(0,Math.floor(a?r/a:ut.getMaximumHeight(n)));if((e.width!==r||e.height!==o)&&(n.width=e.width=r,n.height=e.height=o,n.style.width=r+"px",n.style.height=o+"px",ut.retinaScale(e,i.devicePixelRatio),!t)){var s={width:r,height:o};He.notify(e,"resize",[s]),i.onResize&&i.onResize(e,s),e.stop(),e.update({duration:i.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var t=this.options,e=t.scales||{},i=t.scale;ut.each(e.xAxes,function(t,e){t.id=t.id||"x-axis-"+e}),ut.each(e.yAxes,function(t,e){t.id=t.id||"y-axis-"+e}),i&&(i.id=i.id||"scale")},buildOrUpdateScales:function(){var t=this,e=t.options,i=t.scales||{},n=[],a=Object.keys(i).reduce(function(t,e){return t[e]=!1,t},{});e.scales&&(n=n.concat((e.scales.xAxes||[]).map(function(t){return{options:t,dtype:"category",dposition:"bottom"}}),(e.scales.yAxes||[]).map(function(t){return{options:t,dtype:"linear",dposition:"left"}}))),e.scale&&n.push({options:e.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),ut.each(n,function(e){var n=e.options,r=n.id,o=Qe(n.type,e.dtype);ii(n.position)!==ii(e.dposition)&&(n.position=e.dposition),a[r]=!0;var s=null;if(r in i&&i[r].type===o)(s=i[r]).options=n,s.ctx=t.ctx,s.chart=t;else{var l=Ee.getScaleConstructor(o);if(!l)return;s=new l({id:r,type:o,options:n,ctx:t.ctx,chart:t}),i[s.id]=s}s.mergeTicksOptions(),e.isDefault&&(t.scale=s)}),ut.each(a,function(t,e){t||delete i[e]}),t.scales=i,Ee.addScalesToLayout(this)},buildOrUpdateControllers:function(){var t=this,e=[];return ut.each(t.data.datasets,function(i,n){var a=t.getDatasetMeta(n),r=i.type||t.config.type;if(a.type&&a.type!==r&&(t.destroyDatasetMeta(n),a=t.getDatasetMeta(n)),a.type=r,a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{var o=ue[a.type];if(void 0===o)throw new Error('"'+a.type+'" is not a chart type.');a.controller=new o(t,n),e.push(a.controller)}},t),e},resetElements:function(){var t=this;ut.each(t.data.datasets,function(e,i){t.getDatasetMeta(i).controller.reset()},t)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var e,i,n=this;if(t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]}),i=(e=n).options,ut.each(e.scales,function(t){xe.removeBox(e,t)}),i=ei(ot.global,ot[e.config.type],i),e.options=e.config.options=i,e.ensureScalesHaveIDs(),e.buildOrUpdateScales(),e.tooltip._options=i.tooltips,e.tooltip.initialize(),He._invalidate(n),!1!==He.notify(n,"beforeUpdate")){n.tooltip._data=n.data;var a=n.buildOrUpdateControllers();ut.each(n.data.datasets,function(t,e){n.getDatasetMeta(e).controller.buildOrUpdateElements()},n),n.updateLayout(),n.options.animation&&n.options.animation.duration&&ut.each(a,function(t){t.reset()}),n.updateDatasets(),n.tooltip.initialize(),n.lastActive=[],He.notify(n,"afterUpdate"),n._bufferedRender?n._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:n.render(t)}},updateLayout:function(){!1!==He.notify(this,"beforeLayout")&&(xe.update(this,this.width,this.height),He.notify(this,"afterScaleUpdate"),He.notify(this,"afterLayout"))},updateDatasets:function(){if(!1!==He.notify(this,"beforeDatasetsUpdate")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);He.notify(this,"afterDatasetsUpdate")}},updateDataset:function(t){var e=this.getDatasetMeta(t),i={meta:e,index:t};!1!==He.notify(this,"beforeDatasetUpdate",[i])&&(e.controller.update(),He.notify(this,"afterDatasetUpdate",[i]))},render:function(t){var e=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var i=e.options.animation,n=Qe(t.duration,i&&i.duration),a=t.lazy;if(!1!==He.notify(e,"beforeRender")){var r=function(t){He.notify(e,"afterRender"),ut.callback(i&&i.onComplete,[t],e)};if(i&&n){var o=new pt({numSteps:n/16.66,easing:t.easing||i.easing,render:function(t,e){var i=ut.easing.effects[e.easing],n=e.currentStep,a=n/e.numSteps;t.draw(i(a),a,n)},onAnimationProgress:i.onProgress,onAnimationComplete:r});vt.addAnimation(e,o,n,a)}else e.draw(),r(new pt({numSteps:0,chart:e}));return e}},draw:function(t){var e=this;e.clear(),ut.isNullOrUndef(t)&&(t=1),e.transition(t),e.width<=0||e.height<=0||!1!==He.notify(e,"beforeDraw",[t])&&(ut.each(e.boxes,function(t){t.draw(e.chartArea)},e),e.drawDatasets(t),e._drawTooltip(t),He.notify(e,"afterDraw",[t]))},transition:function(t){for(var e=0,i=(this.data.datasets||[]).length;e<i;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},drawDatasets:function(t){var e=this;if(!1!==He.notify(e,"beforeDatasetsDraw",[t])){for(var i=(e.data.datasets||[]).length-1;i>=0;--i)e.isDatasetVisible(i)&&e.drawDataset(i,t);He.notify(e,"afterDatasetsDraw",[t])}},drawDataset:function(t,e){var i=this.getDatasetMeta(t),n={meta:i,index:t,easingValue:e};!1!==He.notify(this,"beforeDatasetDraw",[n])&&(i.controller.draw(e),He.notify(this,"afterDatasetDraw",[n]))},_drawTooltip:function(t){var e=this.tooltip,i={tooltip:e,easingValue:t};!1!==He.notify(this,"beforeTooltipDraw",[i])&&(e.draw(),He.notify(this,"afterTooltipDraw",[i]))},getElementAtEvent:function(t){return pe.modes.single(this,t)},getElementsAtEvent:function(t){return pe.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return pe.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,i){var n=pe.modes[e];return"function"==typeof n?n(this,t,i):[]},getDatasetAtEvent:function(t){return pe.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var i=e._meta[this.id];return i||(i=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,i=this.data.datasets.length;e<i;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,i=this.data.datasets[t],n=i._meta&&i._meta[e];n&&(n.controller.destroy(),delete i._meta[e])},destroy:function(){var t,e,i=this,n=i.canvas;for(i.stop(),t=0,e=i.data.datasets.length;t<e;++t)i.destroyDatasetMeta(t);n&&(i.unbindEvents(),ut.canvas.clear(i),Ve.releaseContext(i.ctx),i.canvas=null,i.ctx=null),He.notify(i,"destroy"),delete ni.instances[i.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var t=this;t.tooltip=new Je({_chart:t,_chartInstance:t,_data:t.data,_options:t.options.tooltips},t)},bindEvents:function(){var t=this,e=t._listeners={},i=function(){t.eventHandler.apply(t,arguments)};ut.each(t.options.events,function(n){Ve.addEventListener(t,n,i),e[n]=i}),t.options.responsive&&(i=function(){t.resize()},Ve.addEventListener(t,"resize",i),e.resize=i)},unbindEvents:function(){var t=this,e=t._listeners;e&&(delete t._listeners,ut.each(e,function(e,i){Ve.removeEventListener(t,i,e)}))},updateHoverStyle:function(t,e,i){var n,a,r,o=i?"setHoverStyle":"removeHoverStyle";for(a=0,r=t.length;a<r;++a)(n=t[a])&&this.getDatasetMeta(n._datasetIndex).controller[o](n)},eventHandler:function(t){var e=this,i=e.tooltip;if(!1!==He.notify(e,"beforeEvent",[t])){e._bufferedRender=!0,e._bufferedRequest=null;var n=e.handleEvent(t);i&&(n=i._start?i.handleEvent(t):n|i.handleEvent(t)),He.notify(e,"afterEvent",[t]);var a=e._bufferedRequest;return a?e.render(a):n&&!e.animating&&(e.stop(),e.render({duration:e.options.hover.animationDuration,lazy:!0})),e._bufferedRender=!1,e._bufferedRequest=null,e}},handleEvent:function(t){var e,i=this,n=i.options||{},a=n.hover;return i.lastActive=i.lastActive||[],"mouseout"===t.type?i.active=[]:i.active=i.getElementsAtEventForMode(t,a.mode,a),ut.callback(n.onHover||n.hover.onHover,[t.native,i.active],i),"mouseup"!==t.type&&"click"!==t.type||n.onClick&&n.onClick.call(i,t.native,i.active),i.lastActive.length&&i.updateHoverStyle(i.lastActive,a.mode,!1),i.active.length&&a.mode&&i.updateHoverStyle(i.active,a.mode,!0),e=!ut.arrayEquals(i.active,i.lastActive),i.lastActive=i.active,e}}),ni.instances={};var ai=ni;ni.Controller=ni,ni.types={},ut.configMerge=ei,ut.scaleMerge=ti;function ri(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function oi(t){this.options=t||{}}ut.extend(oi.prototype,{formats:ri,parse:ri,format:ri,add:ri,diff:ri,startOf:ri,endOf:ri,_create:function(t){return t}}),oi.override=function(t){ut.extend(oi.prototype,t)};var si={_date:oi},li={formatters:{values:function(t){return ut.isArray(t)?t:""+t},linear:function(t,e,i){var n=i.length>3?i[2]-i[1]:i[1]-i[0];Math.abs(n)>1&&t!==Math.floor(t)&&(n=t-Math.floor(t));var a=ut.log10(Math.abs(n)),r="";if(0!==t)if(Math.max(Math.abs(i[0]),Math.abs(i[i.length-1]))<1e-4){var o=ut.log10(Math.abs(t));r=t.toExponential(Math.floor(o)-Math.floor(a))}else{var s=-1*Math.floor(a);s=Math.max(Math.min(s,20),0),r=t.toFixed(s)}else r="0";return r},logarithmic:function(t,e,i){var n=t/Math.pow(10,Math.floor(ut.log10(t)));return 0===t?"0":1===n||2===n||5===n||0===e||e===i.length-1?t.toExponential():""}}},ui=ut.valueOrDefault,di=ut.valueAtIndexOrDefault;function hi(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(t[e].label);return n}function ci(t,e,i){return ut.isArray(e)?ut.longestText(t,i,e):t.measureText(e).width}ot._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:li.formatters.values,minor:{},major:{}}});var fi=gt.extend({getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var t=this.options.ticks;for(var e in!1===t.minor&&(t.minor={display:!1}),!1===t.major&&(t.major={display:!1}),t)"major"!==e&&"minor"!==e&&(void 0===t.minor[e]&&(t.minor[e]=t[e]),void 0===t.major[e]&&(t.major[e]=t[e]))},beforeUpdate:function(){ut.callback(this.options.beforeUpdate,[this])},update:function(t,e,i){var n,a,r,o,s,l,u=this;for(u.beforeUpdate(),u.maxWidth=t,u.maxHeight=e,u.margins=ut.extend({left:0,right:0,top:0,bottom:0},i),u._maxLabelLines=0,u.longestLabelWidth=0,u.longestTextCache=u.longestTextCache||{},u.beforeSetDimensions(),u.setDimensions(),u.afterSetDimensions(),u.beforeDataLimits(),u.determineDataLimits(),u.afterDataLimits(),u.beforeBuildTicks(),s=u.buildTicks()||[],s=u.afterBuildTicks(s)||s,u.beforeTickToLabelConversion(),r=u.convertTicksToLabels(s)||u.ticks,u.afterTickToLabelConversion(),u.ticks=r,n=0,a=r.length;n<a;++n)o=r[n],(l=s[n])?l.label=o:s.push(l={label:o,major:!1});return u._ticks=s,u.beforeCalculateTickRotation(),u.calculateTickRotation(),u.afterCalculateTickRotation(),u.beforeFit(),u.fit(),u.afterFit(),u.afterUpdate(),u.minSize},afterUpdate:function(){ut.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){ut.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){ut.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){ut.callback(this.options.beforeDataLimits,[this])},determineDataLimits:ut.noop,afterDataLimits:function(){ut.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){ut.callback(this.options.beforeBuildTicks,[this])},buildTicks:ut.noop,afterBuildTicks:function(t){var e=this;return ut.isArray(t)&&t.length?ut.callback(e.options.afterBuildTicks,[e,t]):(e.ticks=ut.callback(e.options.afterBuildTicks,[e,e.ticks])||e.ticks,t)},beforeTickToLabelConversion:function(){ut.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this.options.ticks;this.ticks=this.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){ut.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){ut.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t=this,e=t.ctx,i=t.options.ticks,n=hi(t._ticks),a=ut.options._parseFont(i);e.font=a.string;var r=i.minRotation||0;if(n.length&&t.options.display&&t.isHorizontal())for(var o,s=ut.longestText(e,a.string,n,t.longestTextCache),l=s,u=t.getPixelForTick(1)-t.getPixelForTick(0)-6;l>u&&r<i.maxRotation;){var d=ut.toRadians(r);if(o=Math.cos(d),Math.sin(d)*s>t.maxHeight){r--;break}r++,l=o*s}t.labelRotation=r},afterCalculateTickRotation:function(){ut.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){ut.callback(this.options.beforeFit,[this])},fit:function(){var t=this,e=t.minSize={width:0,height:0},i=hi(t._ticks),n=t.options,a=n.ticks,r=n.scaleLabel,o=n.gridLines,s=t._isVisible(),l=n.position,u=t.isHorizontal(),d=ut.options._parseFont,h=d(a),c=n.gridLines.tickMarkLength;if(e.width=u?t.isFullWidth()?t.maxWidth-t.margins.left-t.margins.right:t.maxWidth:s&&o.drawTicks?c:0,e.height=u?s&&o.drawTicks?c:0:t.maxHeight,r.display&&s){var f=d(r),g=ut.options.toPadding(r.padding),m=f.lineHeight+g.height;u?e.height+=m:e.width+=m}if(a.display&&s){var p=ut.longestText(t.ctx,h.string,i,t.longestTextCache),v=ut.numberOfLabelLines(i),y=.5*h.size,b=t.options.ticks.padding;if(t._maxLabelLines=v,t.longestLabelWidth=p,u){var x=ut.toRadians(t.labelRotation),_=Math.cos(x),k=Math.sin(x)*p+h.lineHeight*v+y;e.height=Math.min(t.maxHeight,e.height+k+b),t.ctx.font=h.string;var w,M,S=ci(t.ctx,i[0],h.string),D=ci(t.ctx,i[i.length-1],h.string),C=t.getPixelForTick(0)-t.left,P=t.right-t.getPixelForTick(i.length-1);0!==t.labelRotation?(w="bottom"===l?_*S:_*y,M="bottom"===l?_*y:_*D):(w=S/2,M=D/2),t.paddingLeft=Math.max(w-C,0)+3,t.paddingRight=Math.max(M-P,0)+3}else a.mirror?p=0:p+=b+y,e.width=Math.min(t.maxWidth,e.width+p),t.paddingTop=h.size/2,t.paddingBottom=h.size/2}t.handleMargins(),t.width=e.width,t.height=e.height},handleMargins:function(){var t=this;t.margins&&(t.paddingLeft=Math.max(t.paddingLeft-t.margins.left,0),t.paddingTop=Math.max(t.paddingTop-t.margins.top,0),t.paddingRight=Math.max(t.paddingRight-t.margins.right,0),t.paddingBottom=Math.max(t.paddingBottom-t.margins.bottom,0))},afterFit:function(){ut.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(ut.isNullOrUndef(t))return NaN;if(("number"==typeof t||t instanceof Number)&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},getLabelForIndex:ut.noop,getPixelForValue:ut.noop,getValueForPixel:ut.noop,getPixelForTick:function(t){var e=this,i=e.options.offset;if(e.isHorizontal()){var n=(e.width-(e.paddingLeft+e.paddingRight))/Math.max(e._ticks.length-(i?0:1),1),a=n*t+e.paddingLeft;i&&(a+=n/2);var r=e.left+a;return r+=e.isFullWidth()?e.margins.left:0}var o=e.height-(e.paddingTop+e.paddingBottom);return e.top+t*(o/(e._ticks.length-1))},getPixelForDecimal:function(t){var e=this;if(e.isHorizontal()){var i=(e.width-(e.paddingLeft+e.paddingRight))*t+e.paddingLeft,n=e.left+i;return n+=e.isFullWidth()?e.margins.left:0}return e.top+t*e.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this.min,e=this.max;return this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0},_autoSkip:function(t){var e,i,n=this,a=n.isHorizontal(),r=n.options.ticks.minor,o=t.length,s=!1,l=r.maxTicksLimit,u=n._tickSize()*(o-1),d=a?n.width-(n.paddingLeft+n.paddingRight):n.height-(n.paddingTop+n.PaddingBottom),h=[];for(u>d&&(s=1+Math.floor(u/d)),o>l&&(s=Math.max(s,1+Math.floor(o/l))),e=0;e<o;e++)i=t[e],s>1&&e%s>0&&delete i.label,h.push(i);return h},_tickSize:function(){var t=this,e=t.isHorizontal(),i=t.options.ticks.minor,n=ut.toRadians(t.labelRotation),a=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),o=i.autoSkipPadding||0,s=t.longestLabelWidth+o||0,l=ut.options._parseFont(i),u=t._maxLabelLines*l.lineHeight+o||0;return e?u*a>s*r?s/a:u/r:u*r<s*a?u/a:s/r},_isVisible:function(){var t,e,i,n=this.chart,a=this.options.display;if("auto"!==a)return!!a;for(t=0,e=n.data.datasets.length;t<e;++t)if(n.isDatasetVisible(t)&&((i=n.getDatasetMeta(t)).xAxisID===this.id||i.yAxisID===this.id))return!0;return!1},draw:function(t){var e=this,i=e.options;if(e._isVisible()){var n,a,r,o=e.chart,s=e.ctx,l=ot.global.defaultFontColor,u=i.ticks.minor,d=i.ticks.major||u,h=i.gridLines,c=i.scaleLabel,f=i.position,g=0!==e.labelRotation,m=u.mirror,p=e.isHorizontal(),v=ut.options._parseFont,y=u.display&&u.autoSkip?e._autoSkip(e.getTicks()):e.getTicks(),b=ui(u.fontColor,l),x=v(u),_=x.lineHeight,k=ui(d.fontColor,l),w=v(d),M=u.padding,S=u.labelOffset,D=h.drawTicks?h.tickMarkLength:0,C=ui(c.fontColor,l),P=v(c),T=ut.options.toPadding(c.padding),O=ut.toRadians(e.labelRotation),I=[],A=h.drawBorder?di(h.lineWidth,0,0):0,F=ut._alignPixel;"top"===f?(n=F(o,e.bottom,A),a=e.bottom-D,r=n-A/2):"bottom"===f?(n=F(o,e.top,A),a=n+A/2,r=e.top+D):"left"===f?(n=F(o,e.right,A),a=e.right-D,r=n-A/2):(n=F(o,e.left,A),a=n+A/2,r=e.left+D);if(ut.each(y,function(n,s){if(!ut.isNullOrUndef(n.label)){var l,u,d,c,v,y,b,x,k,w,C,P,T,R,L,W,Y=n.label;s===e.zeroLineIndex&&i.offset===h.offsetGridLines?(l=h.zeroLineWidth,u=h.zeroLineColor,d=h.zeroLineBorderDash||[],c=h.zeroLineBorderDashOffset||0):(l=di(h.lineWidth,s),u=di(h.color,s),d=h.borderDash||[],c=h.borderDashOffset||0);var N=ut.isArray(Y)?Y.length:1,z=function(t,e,i){var n=t.getPixelForTick(e);return i&&(1===t.getTicks().length?n-=t.isHorizontal()?Math.max(n-t.left,t.right-n):Math.max(n-t.top,t.bottom-n):n-=0===e?(t.getPixelForTick(1)-n)/2:(n-t.getPixelForTick(e-1))/2),n}(e,s,h.offsetGridLines);if(p){var V=D+M;z<e.left-1e-7&&(u="rgba(0,0,0,0)"),v=b=k=C=F(o,z,l),y=a,x=r,T=e.getPixelForTick(s)+S,"top"===f?(w=F(o,t.top,A)+A/2,P=t.bottom,L=((g?1:.5)-N)*_,W=g?"left":"center",R=e.bottom-V):(w=t.top,P=F(o,t.bottom,A)-A/2,L=(g?0:.5)*_,W=g?"right":"center",R=e.top+V)}else{var H=(m?0:D)+M;z<e.top-1e-7&&(u="rgba(0,0,0,0)"),v=a,b=r,y=x=w=P=F(o,z,l),R=e.getPixelForTick(s)+S,L=(1-N)*_/2,"left"===f?(k=F(o,t.left,A)+A/2,C=t.right,W=m?"left":"right",T=e.right-H):(k=t.left,C=F(o,t.right,A)-A/2,W=m?"right":"left",T=e.left+H)}I.push({tx1:v,ty1:y,tx2:b,ty2:x,x1:k,y1:w,x2:C,y2:P,labelX:T,labelY:R,glWidth:l,glColor:u,glBorderDash:d,glBorderDashOffset:c,rotation:-1*O,label:Y,major:n.major,textOffset:L,textAlign:W})}}),ut.each(I,function(t){var e=t.glWidth,i=t.glColor;if(h.display&&e&&i&&(s.save(),s.lineWidth=e,s.strokeStyle=i,s.setLineDash&&(s.setLineDash(t.glBorderDash),s.lineDashOffset=t.glBorderDashOffset),s.beginPath(),h.drawTicks&&(s.moveTo(t.tx1,t.ty1),s.lineTo(t.tx2,t.ty2)),h.drawOnChartArea&&(s.moveTo(t.x1,t.y1),s.lineTo(t.x2,t.y2)),s.stroke(),s.restore()),u.display){s.save(),s.translate(t.labelX,t.labelY),s.rotate(t.rotation),s.font=t.major?w.string:x.string,s.fillStyle=t.major?k:b,s.textBaseline="middle",s.textAlign=t.textAlign;var n=t.label,a=t.textOffset;if(ut.isArray(n))for(var r=0;r<n.length;++r)s.fillText(""+n[r],0,a),a+=_;else s.fillText(n,0,a);s.restore()}}),c.display){var R,L,W=0,Y=P.lineHeight/2;if(p)R=e.left+(e.right-e.left)/2,L="bottom"===f?e.bottom-Y-T.bottom:e.top+Y+T.top;else{var N="left"===f;R=N?e.left+Y+T.top:e.right-Y-T.top,L=e.top+(e.bottom-e.top)/2,W=N?-.5*Math.PI:.5*Math.PI}s.save(),s.translate(R,L),s.rotate(W),s.textAlign="center",s.textBaseline="middle",s.fillStyle=C,s.font=P.string,s.fillText(c.labelString,0,0),s.restore()}if(A){var z,V,H,E,B=A,j=di(h.lineWidth,y.length-1,0);p?(z=F(o,e.left,B)-B/2,V=F(o,e.right,j)+j/2,H=E=n):(H=F(o,e.top,B)-B/2,E=F(o,e.bottom,j)+j/2,z=V=n),s.lineWidth=A,s.strokeStyle=di(h.color,0),s.beginPath(),s.moveTo(z,H),s.lineTo(V,E),s.stroke()}}}}),gi=fi.extend({getLabels:function(){var t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels},determineDataLimits:function(){var t,e=this,i=e.getLabels();e.minIndex=0,e.maxIndex=i.length-1,void 0!==e.options.ticks.min&&(t=i.indexOf(e.options.ticks.min),e.minIndex=-1!==t?t:e.minIndex),void 0!==e.options.ticks.max&&(t=i.indexOf(e.options.ticks.max),e.maxIndex=-1!==t?t:e.maxIndex),e.min=i[e.minIndex],e.max=i[e.maxIndex]},buildTicks:function(){var t=this,e=t.getLabels();t.ticks=0===t.minIndex&&t.maxIndex===e.length-1?e:e.slice(t.minIndex,t.maxIndex+1)},getLabelForIndex:function(t,e){var i=this,n=i.chart;return n.getDatasetMeta(e).controller._getValueScaleId()===i.id?i.getRightValue(n.data.datasets[e].data[t]):i.ticks[t-i.minIndex]},getPixelForValue:function(t,e){var i,n=this,a=n.options.offset,r=Math.max(n.maxIndex+1-n.minIndex-(a?0:1),1);if(null!=t&&(i=n.isHorizontal()?t.x:t.y),void 0!==i||void 0!==t&&isNaN(e)){t=i||t;var o=n.getLabels().indexOf(t);e=-1!==o?o:e}if(n.isHorizontal()){var s=n.width/r,l=s*(e-n.minIndex);return a&&(l+=s/2),n.left+l}var u=n.height/r,d=u*(e-n.minIndex);return a&&(d+=u/2),n.top+d},getPixelForTick:function(t){return this.getPixelForValue(this.ticks[t],t+this.minIndex,null)},getValueForPixel:function(t){var e=this,i=e.options.offset,n=Math.max(e._ticks.length-(i?0:1),1),a=e.isHorizontal(),r=(a?e.width:e.height)/n;return t-=a?e.left:e.top,i&&(t-=r/2),(t<=0?0:Math.round(t/r))+e.minIndex},getBasePixel:function(){return this.bottom}}),mi={position:"bottom"};gi._defaults=mi;var pi=ut.noop,vi=ut.isNullOrUndef;var yi=fi.extend({getRightValue:function(t){return"string"==typeof t?+t:fi.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;if(e.beginAtZero){var i=ut.sign(t.min),n=ut.sign(t.max);i<0&&n<0?t.max=0:i>0&&n>0&&(t.min=0)}var a=void 0!==e.min||void 0!==e.suggestedMin,r=void 0!==e.max||void 0!==e.suggestedMax;void 0!==e.min?t.min=e.min:void 0!==e.suggestedMin&&(null===t.min?t.min=e.suggestedMin:t.min=Math.min(t.min,e.suggestedMin)),void 0!==e.max?t.max=e.max:void 0!==e.suggestedMax&&(null===t.max?t.max=e.suggestedMax:t.max=Math.max(t.max,e.suggestedMax)),a!==r&&t.min>=t.max&&(a?t.max=t.min+1:t.min=t.max-1),t.min===t.max&&(t.max++,e.beginAtZero||t.min--)},getTickLimit:function(){var t,e=this.options.ticks,i=e.stepSize,n=e.maxTicksLimit;return i?t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1:(t=this._computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:pi,buildTicks:function(){var t=this,e=t.options.ticks,i=t.getTickLimit(),n={maxTicks:i=Math.max(2,i),min:e.min,max:e.max,precision:e.precision,stepSize:ut.valueOrDefault(e.fixedStepSize,e.stepSize)},a=t.ticks=function(t,e){var i,n,a,r,o=[],s=t.stepSize,l=s||1,u=t.maxTicks-1,d=t.min,h=t.max,c=t.precision,f=e.min,g=e.max,m=ut.niceNum((g-f)/u/l)*l;if(m<1e-14&&vi(d)&&vi(h))return[f,g];(r=Math.ceil(g/m)-Math.floor(f/m))>u&&(m=ut.niceNum(r*m/u/l)*l),s||vi(c)?i=Math.pow(10,ut._decimalPlaces(m)):(i=Math.pow(10,c),m=Math.ceil(m*i)/i),n=Math.floor(f/m)*m,a=Math.ceil(g/m)*m,s&&(!vi(d)&&ut.almostWhole(d/m,m/1e3)&&(n=d),!vi(h)&&ut.almostWhole(h/m,m/1e3)&&(a=h)),r=(a-n)/m,r=ut.almostEquals(r,Math.round(r),m/1e3)?Math.round(r):Math.ceil(r),n=Math.round(n*i)/i,a=Math.round(a*i)/i,o.push(vi(d)?n:d);for(var p=1;p<r;++p)o.push(Math.round((n+p*m)*i)/i);return o.push(vi(h)?a:h),o}(n,t);t.handleDirectionalChanges(),t.max=ut.max(a),t.min=ut.min(a),e.reverse?(a.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),fi.prototype.convertTicksToLabels.call(t)}}),bi={position:"left",ticks:{callback:li.formatters.linear}},xi=yi.extend({determineDataLimits:function(){var t=this,e=t.options,i=t.chart,n=i.data.datasets,a=t.isHorizontal();function r(e){return a?e.xAxisID===t.id:e.yAxisID===t.id}t.min=null,t.max=null;var o=e.stacked;if(void 0===o&&ut.each(n,function(t,e){if(!o){var n=i.getDatasetMeta(e);i.isDatasetVisible(e)&&r(n)&&void 0!==n.stack&&(o=!0)}}),e.stacked||o){var s={};ut.each(n,function(n,a){var o=i.getDatasetMeta(a),l=[o.type,void 0===e.stacked&&void 0===o.stack?a:"",o.stack].join(".");void 0===s[l]&&(s[l]={positiveValues:[],negativeValues:[]});var u=s[l].positiveValues,d=s[l].negativeValues;i.isDatasetVisible(a)&&r(o)&&ut.each(n.data,function(i,n){var a=+t.getRightValue(i);isNaN(a)||o.data[n].hidden||(u[n]=u[n]||0,d[n]=d[n]||0,e.relativePoints?u[n]=100:a<0?d[n]+=a:u[n]+=a)})}),ut.each(s,function(e){var i=e.positiveValues.concat(e.negativeValues),n=ut.min(i),a=ut.max(i);t.min=null===t.min?n:Math.min(t.min,n),t.max=null===t.max?a:Math.max(t.max,a)})}else ut.each(n,function(e,n){var a=i.getDatasetMeta(n);i.isDatasetVisible(n)&&r(a)&&ut.each(e.data,function(e,i){var n=+t.getRightValue(e);isNaN(n)||a.data[i].hidden||(null===t.min?t.min=n:n<t.min&&(t.min=n),null===t.max?t.max=n:n>t.max&&(t.max=n))})});t.min=isFinite(t.min)&&!isNaN(t.min)?t.min:0,t.max=isFinite(t.max)&&!isNaN(t.max)?t.max:1,this.handleTickRangeOptions()},_computeTickLimit:function(){var t;return this.isHorizontal()?Math.ceil(this.width/40):(t=ut.options._parseFont(this.options.ticks),Math.ceil(this.height/t.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){var e=this,i=e.start,n=+e.getRightValue(t),a=e.end-i;return e.isHorizontal()?e.left+e.width/a*(n-i):e.bottom-e.height/a*(n-i)},getValueForPixel:function(t){var e=this,i=e.isHorizontal(),n=i?e.width:e.height,a=(i?t-e.left:e.bottom-t)/n;return e.start+(e.end-e.start)*a},getPixelForTick:function(t){return this.getPixelForValue(this.ticksAsNumbers[t])}}),_i=bi;xi._defaults=_i;var ki=ut.valueOrDefault;var wi={position:"left",ticks:{callback:li.formatters.logarithmic}};function Mi(t,e){return ut.isFinite(t)&&t>=0?t:e}var Si=fi.extend({determineDataLimits:function(){var t=this,e=t.options,i=t.chart,n=i.data.datasets,a=t.isHorizontal();function r(e){return a?e.xAxisID===t.id:e.yAxisID===t.id}t.min=null,t.max=null,t.minNotZero=null;var o=e.stacked;if(void 0===o&&ut.each(n,function(t,e){if(!o){var n=i.getDatasetMeta(e);i.isDatasetVisible(e)&&r(n)&&void 0!==n.stack&&(o=!0)}}),e.stacked||o){var s={};ut.each(n,function(n,a){var o=i.getDatasetMeta(a),l=[o.type,void 0===e.stacked&&void 0===o.stack?a:"",o.stack].join(".");i.isDatasetVisible(a)&&r(o)&&(void 0===s[l]&&(s[l]=[]),ut.each(n.data,function(e,i){var n=s[l],a=+t.getRightValue(e);isNaN(a)||o.data[i].hidden||a<0||(n[i]=n[i]||0,n[i]+=a)}))}),ut.each(s,function(e){if(e.length>0){var i=ut.min(e),n=ut.max(e);t.min=null===t.min?i:Math.min(t.min,i),t.max=null===t.max?n:Math.max(t.max,n)}})}else ut.each(n,function(e,n){var a=i.getDatasetMeta(n);i.isDatasetVisible(n)&&r(a)&&ut.each(e.data,function(e,i){var n=+t.getRightValue(e);isNaN(n)||a.data[i].hidden||n<0||(null===t.min?t.min=n:n<t.min&&(t.min=n),null===t.max?t.max=n:n>t.max&&(t.max=n),0!==n&&(null===t.minNotZero||n<t.minNotZero)&&(t.minNotZero=n))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;t.min=Mi(e.min,t.min),t.max=Mi(e.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(ut.log10(t.min))-1),t.max=Math.pow(10,Math.floor(ut.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(ut.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(ut.log10(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(ut.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,e=t.options.ticks,i=!t.isHorizontal(),n={min:Mi(e.min),max:Mi(e.max)},a=t.ticks=function(t,e){var i,n,a=[],r=ki(t.min,Math.pow(10,Math.floor(ut.log10(e.min)))),o=Math.floor(ut.log10(e.max)),s=Math.ceil(e.max/Math.pow(10,o));0===r?(i=Math.floor(ut.log10(e.minNotZero)),n=Math.floor(e.minNotZero/Math.pow(10,i)),a.push(r),r=n*Math.pow(10,i)):(i=Math.floor(ut.log10(r)),n=Math.floor(r/Math.pow(10,i)));var l=i<0?Math.pow(10,Math.abs(i)):1;do{a.push(r),10==++n&&(n=1,l=++i>=0?1:l),r=Math.round(n*Math.pow(10,i)*l)/l}while(i<o||i===o&&n<s);var u=ki(t.max,r);return a.push(u),a}(n,t);t.max=ut.max(a),t.min=ut.min(a),e.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&a.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),fi.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var e=Math.floor(ut.log10(t));return Math.floor(t/Math.pow(10,e))*Math.pow(10,e)},getPixelForValue:function(t){var e,i,n,a,r,o=this,s=o.options.ticks,l=s.reverse,u=ut.log10,d=o._getFirstTickValue(o.minNotZero),h=0;return t=+o.getRightValue(t),l?(n=o.end,a=o.start,r=-1):(n=o.start,a=o.end,r=1),o.isHorizontal()?(e=o.width,i=l?o.right:o.left):(e=o.height,r*=-1,i=l?o.top:o.bottom),t!==n&&(0===n&&(e-=h=ki(s.fontSize,ot.global.defaultFontSize),n=d),0!==t&&(h+=e/(u(a)-u(n))*(u(t)-u(n))),i+=r*h),i},getValueForPixel:function(t){var e,i,n,a,r=this,o=r.options.ticks,s=o.reverse,l=ut.log10,u=r._getFirstTickValue(r.minNotZero);if(s?(i=r.end,n=r.start):(i=r.start,n=r.end),r.isHorizontal()?(e=r.width,a=s?r.right-t:t-r.left):(e=r.height,a=s?t-r.top:r.bottom-t),a!==i){if(0===i){var d=ki(o.fontSize,ot.global.defaultFontSize);a-=d,e-=d,i=u}a*=l(n)-l(i),a/=e,a=Math.pow(10,l(i)+a)}return a}}),Di=wi;Si._defaults=Di;var Ci=ut.valueOrDefault,Pi=ut.valueAtIndexOrDefault,Ti=ut.options.resolve,Oi={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:li.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function Ii(t){var e=t.options;return e.angleLines.display||e.pointLabels.display?t.chart.data.labels.length:0}function Ai(t){var e=t.ticks;return e.display&&t.display?Ci(e.fontSize,ot.global.defaultFontSize)+2*e.backdropPaddingY:0}function Fi(t,e,i,n,a){return t===n||t===a?{start:e-i/2,end:e+i/2}:t<n||t>a?{start:e-i,end:e}:{start:e,end:e+i}}function Ri(t){return 0===t||180===t?"center":t<180?"left":"right"}function Li(t,e,i,n){var a,r,o=i.y+n/2;if(ut.isArray(e))for(a=0,r=e.length;a<r;++a)t.fillText(e[a],i.x,o),o+=n;else t.fillText(e,i.x,o)}function Wi(t,e,i){90===t||270===t?i.y-=e.h/2:(t>270||t<90)&&(i.y-=e.h)}function Yi(t){return ut.isNumber(t)?t:0}var Ni=yi.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=Ai(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var t=this,e=t.chart,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;ut.each(e.data.datasets,function(a,r){if(e.isDatasetVisible(r)){var o=e.getDatasetMeta(r);ut.each(a.data,function(e,a){var r=+t.getRightValue(e);isNaN(r)||o.data[a].hidden||(i=Math.min(r,i),n=Math.max(r,n))})}}),t.min=i===Number.POSITIVE_INFINITY?0:i,t.max=n===Number.NEGATIVE_INFINITY?0:n,t.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Ai(this.options))},convertTicksToLabels:function(){var t=this;yi.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(t.options.pointLabels.callback,t)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,i,n,a=ut.options._parseFont(t.options.pointLabels),r={l:0,r:t.width,t:0,b:t.height-t.paddingTop},o={};t.ctx.font=a.string,t._pointLabelSizes=[];var s,l,u,d=Ii(t);for(e=0;e<d;e++){n=t.getPointPosition(e,t.drawingArea+5),s=t.ctx,l=a.lineHeight,u=t.pointLabels[e]||"",i=ut.isArray(u)?{w:ut.longestText(s,s.font,u),h:u.length*l}:{w:s.measureText(u).width,h:l},t._pointLabelSizes[e]=i;var h=t.getIndexAngle(e),c=ut.toDegrees(h)%360,f=Fi(c,n.x,i.w,0,180),g=Fi(c,n.y,i.h,90,270);f.start<r.l&&(r.l=f.start,o.l=h),f.end>r.r&&(r.r=f.end,o.r=h),g.start<r.t&&(r.t=g.start,o.t=h),g.end>r.b&&(r.b=g.end,o.b=h)}t.setReductions(t.drawingArea,r,o)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,i){var n=this,a=e.l/Math.sin(i.l),r=Math.max(e.r-n.width,0)/Math.sin(i.r),o=-e.t/Math.cos(i.t),s=-Math.max(e.b-(n.height-n.paddingTop),0)/Math.cos(i.b);a=Yi(a),r=Yi(r),o=Yi(o),s=Yi(s),n.drawingArea=Math.min(Math.floor(t-(a+r)/2),Math.floor(t-(o+s)/2)),n.setCenterPoint(a,r,o,s)},setCenterPoint:function(t,e,i,n){var a=this,r=a.width-e-a.drawingArea,o=t+a.drawingArea,s=i+a.drawingArea,l=a.height-a.paddingTop-n-a.drawingArea;a.xCenter=Math.floor((o+r)/2+a.left),a.yCenter=Math.floor((s+l)/2+a.top+a.paddingTop)},getIndexAngle:function(t){return t*(2*Math.PI/Ii(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var i=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*i:(t-e.min)*i},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this.min,e=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0)},draw:function(){var t=this,e=t.options,i=e.gridLines,n=e.ticks;if(e.display){var a=t.ctx,r=this.getIndexAngle(0),o=ut.options._parseFont(n);(e.angleLines.display||e.pointLabels.display)&&function(t){var e=t.ctx,i=t.options,n=i.angleLines,a=i.gridLines,r=i.pointLabels,o=Ci(n.lineWidth,a.lineWidth),s=Ci(n.color,a.color),l=Ai(i);e.save(),e.lineWidth=o,e.strokeStyle=s,e.setLineDash&&(e.setLineDash(Ti([n.borderDash,a.borderDash,[]])),e.lineDashOffset=Ti([n.borderDashOffset,a.borderDashOffset,0]));var u=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),d=ut.options._parseFont(r);e.font=d.string,e.textBaseline="middle";for(var h=Ii(t)-1;h>=0;h--){if(n.display&&o&&s){var c=t.getPointPosition(h,u);e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(c.x,c.y),e.stroke()}if(r.display){var f=0===h?l/2:0,g=t.getPointPosition(h,u+f+5),m=Pi(r.fontColor,h,ot.global.defaultFontColor);e.fillStyle=m;var p=t.getIndexAngle(h),v=ut.toDegrees(p);e.textAlign=Ri(v),Wi(v,t._pointLabelSizes[h],g),Li(e,t.pointLabels[h]||"",g,d.lineHeight)}}e.restore()}(t),ut.each(t.ticks,function(e,s){if(s>0||n.reverse){var l=t.getDistanceFromCenterForValue(t.ticksAsNumbers[s]);if(i.display&&0!==s&&function(t,e,i,n){var a,r=t.ctx,o=e.circular,s=Ii(t),l=Pi(e.color,n-1),u=Pi(e.lineWidth,n-1);if((o||s)&&l&&u){if(r.save(),r.strokeStyle=l,r.lineWidth=u,r.setLineDash&&(r.setLineDash(e.borderDash||[]),r.lineDashOffset=e.borderDashOffset||0),r.beginPath(),o)r.arc(t.xCenter,t.yCenter,i,0,2*Math.PI);else{a=t.getPointPosition(0,i),r.moveTo(a.x,a.y);for(var d=1;d<s;d++)a=t.getPointPosition(d,i),r.lineTo(a.x,a.y)}r.closePath(),r.stroke(),r.restore()}}(t,i,l,s),n.display){var u=Ci(n.fontColor,ot.global.defaultFontColor);if(a.font=o.string,a.save(),a.translate(t.xCenter,t.yCenter),a.rotate(r),n.showLabelBackdrop){var d=a.measureText(e).width;a.fillStyle=n.backdropColor,a.fillRect(-d/2-n.backdropPaddingX,-l-o.size/2-n.backdropPaddingY,d+2*n.backdropPaddingX,o.size+2*n.backdropPaddingY)}a.textAlign="center",a.textBaseline="middle",a.fillStyle=u,a.fillText(e,0,-l),a.restore()}}})}}}),zi=Oi;Ni._defaults=zi;var Vi=ut.valueOrDefault,Hi=Number.MIN_SAFE_INTEGER||-9007199254740991,Ei=Number.MAX_SAFE_INTEGER||9007199254740991,Bi={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},ji=Object.keys(Bi);function Ui(t,e){return t-e}function Gi(t){var e,i,n,a={},r=[];for(e=0,i=t.length;e<i;++e)a[n=t[e]]||(a[n]=!0,r.push(n));return r}function qi(t,e,i,n){var a=function(t,e,i){for(var n,a,r,o=0,s=t.length-1;o>=0&&o<=s;){if(a=t[(n=o+s>>1)-1]||null,r=t[n],!a)return{lo:null,hi:r};if(r[e]<i)o=n+1;else{if(!(a[e]>i))return{lo:a,hi:r};s=n-1}}return{lo:r,hi:null}}(t,e,i),r=a.lo?a.hi?a.lo:t[t.length-2]:t[0],o=a.lo?a.hi?a.hi:t[t.length-1]:t[1],s=o[e]-r[e],l=s?(i-r[e])/s:0,u=(o[n]-r[n])*l;return r[n]+u}function Zi(t,e){var i=t._adapter,n=t.options.time,a=n.parser,r=a||n.format,o=e;return"function"==typeof a&&(o=a(o)),ut.isFinite(o)||(o="string"==typeof r?i.parse(o,r):i.parse(o)),null!==o?+o:(a||"function"!=typeof r||(o=r(e),ut.isFinite(o)||(o=i.parse(o))),o)}function $i(t,e){if(ut.isNullOrUndef(e))return null;var i=t.options.time,n=Zi(t,t.getRightValue(e));return null===n?n:(i.round&&(n=+t._adapter.startOf(n,i.round)),n)}function Xi(t){for(var e=ji.indexOf(t)+1,i=ji.length;e<i;++e)if(Bi[ji[e]].common)return ji[e]}function Ki(t,e,i,n){var a,r=t._adapter,o=t.options,s=o.time,l=s.unit||function(t,e,i,n){var a,r,o,s=ji.length;for(a=ji.indexOf(t);a<s-1;++a)if(o=(r=Bi[ji[a]]).steps?r.steps[r.steps.length-1]:Ei,r.common&&Math.ceil((i-e)/(o*r.size))<=n)return ji[a];return ji[s-1]}(s.minUnit,e,i,n),u=Xi(l),d=Vi(s.stepSize,s.unitStepSize),h="week"===l&&s.isoWeekday,c=o.ticks.major.enabled,f=Bi[l],g=e,m=i,p=[];for(d||(d=function(t,e,i,n){var a,r,o,s=e-t,l=Bi[i],u=l.size,d=l.steps;if(!d)return Math.ceil(s/(n*u));for(a=0,r=d.length;a<r&&(o=d[a],!(Math.ceil(s/(u*o))<=n));++a);return o}(e,i,l,n)),h&&(g=+r.startOf(g,"isoWeek",h),m=+r.startOf(m,"isoWeek",h)),g=+r.startOf(g,h?"day":l),(m=+r.startOf(m,h?"day":l))<i&&(m=+r.add(m,1,l)),a=g,c&&u&&!h&&!s.round&&(a=+r.startOf(a,u),a=+r.add(a,~~((g-a)/(f.size*d))*d,l));a<m;a=+r.add(a,d,l))p.push(+a);return p.push(+a),p}var Ji=fi.extend({initialize:function(){this.mergeTicksOptions(),fi.prototype.initialize.call(this)},update:function(){var t=this.options,e=t.time||(t.time={}),i=this._adapter=new si._date(t.adapters.date);return e.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),ut.mergeIf(e.displayFormats,i.formats()),fi.prototype.update.apply(this,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),fi.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t,e,i,n,a,r,o=this,s=o.chart,l=o._adapter,u=o.options.time,d=u.unit||"day",h=Ei,c=Hi,f=[],g=[],m=[],p=s.data.labels||[];for(t=0,i=p.length;t<i;++t)m.push($i(o,p[t]));for(t=0,i=(s.data.datasets||[]).length;t<i;++t)if(s.isDatasetVisible(t))if(a=s.data.datasets[t].data,ut.isObject(a[0]))for(g[t]=[],e=0,n=a.length;e<n;++e)r=$i(o,a[e]),f.push(r),g[t][e]=r;else{for(e=0,n=m.length;e<n;++e)f.push(m[e]);g[t]=m.slice(0)}else g[t]=[];m.length&&(m=Gi(m).sort(Ui),h=Math.min(h,m[0]),c=Math.max(c,m[m.length-1])),f.length&&(f=Gi(f).sort(Ui),h=Math.min(h,f[0]),c=Math.max(c,f[f.length-1])),h=$i(o,u.min)||h,c=$i(o,u.max)||c,h=h===Ei?+l.startOf(Date.now(),d):h,c=c===Hi?+l.endOf(Date.now(),d)+1:c,o.min=Math.min(h,c),o.max=Math.max(h+1,c),o._horizontal=o.isHorizontal(),o._table=[],o._timestamps={data:f,datasets:g,labels:m}},buildTicks:function(){var t,e,i,n=this,a=n.min,r=n.max,o=n.options,s=o.time,l=[],u=[];switch(o.ticks.source){case"data":l=n._timestamps.data;break;case"labels":l=n._timestamps.labels;break;case"auto":default:l=Ki(n,a,r,n.getLabelCapacity(a))}for("ticks"===o.bounds&&l.length&&(a=l[0],r=l[l.length-1]),a=$i(n,s.min)||a,r=$i(n,s.max)||r,t=0,e=l.length;t<e;++t)(i=l[t])>=a&&i<=r&&u.push(i);return n.min=a,n.max=r,n._unit=s.unit||function(t,e,i,n,a){var r,o;for(r=ji.length-1;r>=ji.indexOf(i);r--)if(o=ji[r],Bi[o].common&&t._adapter.diff(a,n,o)>=e.length)return o;return ji[i?ji.indexOf(i):0]}(n,u,s.minUnit,n.min,n.max),n._majorUnit=Xi(n._unit),n._table=function(t,e,i,n){if("linear"===n||!t.length)return[{time:e,pos:0},{time:i,pos:1}];var a,r,o,s,l,u=[],d=[e];for(a=0,r=t.length;a<r;++a)(s=t[a])>e&&s<i&&d.push(s);for(d.push(i),a=0,r=d.length;a<r;++a)l=d[a+1],o=d[a-1],s=d[a],void 0!==o&&void 0!==l&&Math.round((l+o)/2)===s||u.push({time:s,pos:a/(r-1)});return u}(n._timestamps.data,a,r,o.distribution),n._offsets=function(t,e,i,n,a){var r,o,s=0,l=0;return a.offset&&e.length&&(a.time.min||(r=qi(t,"time",e[0],"pos"),s=1===e.length?1-r:(qi(t,"time",e[1],"pos")-r)/2),a.time.max||(o=qi(t,"time",e[e.length-1],"pos"),l=1===e.length?o:(o-qi(t,"time",e[e.length-2],"pos"))/2)),{start:s,end:l}}(n._table,u,0,0,o),o.ticks.reverse&&u.reverse(),function(t,e,i){var n,a,r,o,s=[];for(n=0,a=e.length;n<a;++n)r=e[n],o=!!i&&r===+t._adapter.startOf(r,i),s.push({value:r,major:o});return s}(n,u,n._majorUnit)},getLabelForIndex:function(t,e){var i=this,n=i._adapter,a=i.chart.data,r=i.options.time,o=a.labels&&t<a.labels.length?a.labels[t]:"",s=a.datasets[e].data[t];return ut.isObject(s)&&(o=i.getRightValue(s)),r.tooltipFormat?n.format(Zi(i,o),r.tooltipFormat):"string"==typeof o?o:n.format(Zi(i,o),r.displayFormats.datetime)},tickFormatFunction:function(t,e,i,n){var a=this._adapter,r=this.options,o=r.time.displayFormats,s=o[this._unit],l=this._majorUnit,u=o[l],d=+a.startOf(t,l),h=r.ticks.major,c=h.enabled&&l&&u&&t===d,f=a.format(t,n||(c?u:s)),g=c?h:r.ticks.minor,m=Vi(g.callback,g.userCallback);return m?m(f,e,i):f},convertTicksToLabels:function(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(this.tickFormatFunction(t[e].value,e,t));return n},getPixelForOffset:function(t){var e=this,i=e.options.ticks.reverse,n=e._horizontal?e.width:e.height,a=e._horizontal?i?e.right:e.left:i?e.bottom:e.top,r=qi(e._table,"time",t,"pos"),o=n*(e._offsets.start+r)/(e._offsets.start+1+e._offsets.end);return i?a-o:a+o},getPixelForValue:function(t,e,i){var n=null;if(void 0!==e&&void 0!==i&&(n=this._timestamps.datasets[i][e]),null===n&&(n=$i(this,t)),null!==n)return this.getPixelForOffset(n)},getPixelForTick:function(t){var e=this.getTicks();return t>=0&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this,i=e._horizontal?e.width:e.height,n=e._horizontal?e.left:e.top,a=(i?(t-n)/i:0)*(e._offsets.start+1+e._offsets.start)-e._offsets.end,r=qi(e._table,"pos",a,"time");return e._adapter._create(r)},getLabelWidth:function(t){var e=this.options.ticks,i=this.ctx.measureText(t).width,n=ut.toRadians(e.maxRotation),a=Math.cos(n),r=Math.sin(n);return i*a+Vi(e.fontSize,ot.global.defaultFontSize)*r},getLabelCapacity:function(t){var e=this,i=e.options.time.displayFormats.millisecond,n=e.tickFormatFunction(t,0,[],i),a=e.getLabelWidth(n),r=e.isHorizontal()?e.width:e.height,o=Math.floor(r/a);return o>0?o:1}}),Qi={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};Ji._defaults=Qi;var tn,en={category:gi,linear:xi,logarithmic:Si,radialLinear:Ni,time:Ji},nn=(function(t,e){t.exports=function(){var e,i;function n(){return e.apply(null,arguments)}function a(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function r(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function o(t){return void 0===t}function s(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function l(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function u(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function d(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function h(t,e){for(var i in e)d(e,i)&&(t[i]=e[i]);return d(e,"toString")&&(t.toString=e.toString),d(e,"valueOf")&&(t.valueOf=e.valueOf),t}function c(t,e,i,n){return Oe(t,e,i,n,!0).utc()}function f(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function g(t){if(null==t._isValid){var e=f(t),n=i.call(e.parsedDateParts,function(t){return null!=t}),a=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(a=a&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return a;t._isValid=a}return t._isValid}function m(t){var e=c(NaN);return null!=t?h(f(e),t):f(e).userInvalidated=!0,e}i=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),i=e.length>>>0,n=0;n<i;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};var p=n.momentProperties=[];function v(t,e){var i,n,a;if(o(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),o(e._i)||(t._i=e._i),o(e._f)||(t._f=e._f),o(e._l)||(t._l=e._l),o(e._strict)||(t._strict=e._strict),o(e._tzm)||(t._tzm=e._tzm),o(e._isUTC)||(t._isUTC=e._isUTC),o(e._offset)||(t._offset=e._offset),o(e._pf)||(t._pf=f(e)),o(e._locale)||(t._locale=e._locale),p.length>0)for(i=0;i<p.length;i++)n=p[i],o(a=e[n])||(t[n]=a);return t}var y=!1;function b(t){v(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===y&&(y=!0,n.updateOffset(this),y=!1)}function x(t){return t instanceof b||null!=t&&null!=t._isAMomentObject}function _(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function k(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=_(e)),i}function w(t,e,i){var n,a=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0;for(n=0;n<a;n++)(i&&t[n]!==e[n]||!i&&k(t[n])!==k(e[n]))&&o++;return o+r}function M(t){!1===n.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function S(t,e){var i=!0;return h(function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,t),i){for(var a,r=[],o=0;o<arguments.length;o++){if(a="","object"==typeof arguments[o]){for(var s in a+="\n["+o+"] ",arguments[0])a+=s+": "+arguments[0][s]+", ";a=a.slice(0,-2)}else a=arguments[o];r.push(a)}M(t+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),i=!1}return e.apply(this,arguments)},e)}var D,C={};function P(t,e){null!=n.deprecationHandler&&n.deprecationHandler(t,e),C[t]||(M(e),C[t]=!0)}function T(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function O(t,e){var i,n=h({},t);for(i in e)d(e,i)&&(r(t[i])&&r(e[i])?(n[i]={},h(n[i],t[i]),h(n[i],e[i])):null!=e[i]?n[i]=e[i]:delete n[i]);for(i in t)d(t,i)&&!d(e,i)&&r(t[i])&&(n[i]=h({},n[i]));return n}function I(t){null!=t&&this.set(t)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,D=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)d(t,e)&&i.push(e);return i};var A={};function F(t,e){var i=t.toLowerCase();A[i]=A[i+"s"]=A[e]=t}function R(t){return"string"==typeof t?A[t]||A[t.toLowerCase()]:void 0}function L(t){var e,i,n={};for(i in t)d(t,i)&&(e=R(i))&&(n[e]=t[i]);return n}var W={};function Y(t,e){W[t]=e}function N(t,e,i){var n=""+Math.abs(t),a=e-n.length,r=t>=0;return(r?i?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+n}var z=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,V=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},E={};function B(t,e,i,n){var a=n;"string"==typeof n&&(a=function(){return this[n]()}),t&&(E[t]=a),e&&(E[e[0]]=function(){return N(a.apply(this,arguments),e[1],e[2])}),i&&(E[i]=function(){return this.localeData().ordinal(a.apply(this,arguments),t)})}function j(t,e){return t.isValid()?(e=U(e,t.localeData()),H[e]=H[e]||function(t){var e,i,n,a=t.match(z);for(e=0,i=a.length;e<i;e++)E[a[e]]?a[e]=E[a[e]]:a[e]=(n=a[e]).match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"");return function(e){var n,r="";for(n=0;n<i;n++)r+=T(a[n])?a[n].call(e,t):a[n];return r}}(e),H[e](t)):t.localeData().invalidDate()}function U(t,e){var i=5;function n(t){return e.longDateFormat(t)||t}for(V.lastIndex=0;i>=0&&V.test(t);)t=t.replace(V,n),V.lastIndex=0,i-=1;return t}var G=/\d/,q=/\d\d/,Z=/\d{3}/,$=/\d{4}/,X=/[+-]?\d{6}/,K=/\d\d?/,J=/\d\d\d\d?/,Q=/\d\d\d\d\d\d?/,tt=/\d{1,3}/,et=/\d{1,4}/,it=/[+-]?\d{1,6}/,nt=/\d+/,at=/[+-]?\d+/,rt=/Z|[+-]\d\d:?\d\d/gi,ot=/Z|[+-]\d\d(?::?\d\d)?/gi,st=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,lt={};function ut(t,e,i){lt[t]=T(e)?e:function(t,n){return t&&i?i:e}}function dt(t,e){return d(lt,t)?lt[t](e._strict,e._locale):new RegExp(ht(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,a){return e||i||n||a})))}function ht(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ct={};function ft(t,e){var i,n=e;for("string"==typeof t&&(t=[t]),s(e)&&(n=function(t,i){i[e]=k(t)}),i=0;i<t.length;i++)ct[t[i]]=n}function gt(t,e){ft(t,function(t,i,n,a){n._w=n._w||{},e(t,n._w,n,a)})}function mt(t,e,i){null!=e&&d(ct,t)&&ct[t](e,i._a,i,t)}var pt=0,vt=1,yt=2,bt=3,xt=4,_t=5,kt=6,wt=7,Mt=8;function St(t){return Dt(t)?366:365}function Dt(t){return t%4==0&&t%100!=0||t%400==0}B("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),B(0,["YY",2],0,function(){return this.year()%100}),B(0,["YYYY",4],0,"year"),B(0,["YYYYY",5],0,"year"),B(0,["YYYYYY",6,!0],0,"year"),F("year","y"),Y("year",1),ut("Y",at),ut("YY",K,q),ut("YYYY",et,$),ut("YYYYY",it,X),ut("YYYYYY",it,X),ft(["YYYYY","YYYYYY"],pt),ft("YYYY",function(t,e){e[pt]=2===t.length?n.parseTwoDigitYear(t):k(t)}),ft("YY",function(t,e){e[pt]=n.parseTwoDigitYear(t)}),ft("Y",function(t,e){e[pt]=parseInt(t,10)}),n.parseTwoDigitYear=function(t){return k(t)+(k(t)>68?1900:2e3)};var Ct,Pt=Tt("FullYear",!0);function Tt(t,e){return function(i){return null!=i?(It(this,t,i),n.updateOffset(this,e),this):Ot(this,t)}}function Ot(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function It(t,e,i){t.isValid()&&!isNaN(i)&&("FullYear"===e&&Dt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](i,t.month(),At(i,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](i))}function At(t,e){if(isNaN(t)||isNaN(e))return NaN;var i,n=(e%(i=12)+i)%i;return t+=(e-n)/12,1===n?Dt(t)?29:28:31-n%7%2}Ct=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},B("M",["MM",2],"Mo",function(){return this.month()+1}),B("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),B("MMMM",0,0,function(t){return this.localeData().months(this,t)}),F("month","M"),Y("month",8),ut("M",K),ut("MM",K,q),ut("MMM",function(t,e){return e.monthsShortRegex(t)}),ut("MMMM",function(t,e){return e.monthsRegex(t)}),ft(["M","MM"],function(t,e){e[vt]=k(t)-1}),ft(["MMM","MMMM"],function(t,e,i,n){var a=i._locale.monthsParse(t,n,i._strict);null!=a?e[vt]=a:f(i).invalidMonth=t});var Ft=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Rt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Lt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Wt(t,e){var i;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=k(e);else if(!s(e=t.localeData().monthsParse(e)))return t;return i=Math.min(t.date(),At(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function Yt(t){return null!=t?(Wt(this,t),n.updateOffset(this,!0),this):Ot(this,"Month")}var Nt=st,zt=st;function Vt(){function t(t,e){return e.length-t.length}var e,i,n=[],a=[],r=[];for(e=0;e<12;e++)i=c([2e3,e]),n.push(this.monthsShort(i,"")),a.push(this.months(i,"")),r.push(this.months(i,"")),r.push(this.monthsShort(i,""));for(n.sort(t),a.sort(t),r.sort(t),e=0;e<12;e++)n[e]=ht(n[e]),a[e]=ht(a[e]);for(e=0;e<24;e++)r[e]=ht(r[e]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function Ht(t){var e;if(t<100&&t>=0){var i=Array.prototype.slice.call(arguments);i[0]=t+400,e=new Date(Date.UTC.apply(null,i)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function Et(t,e,i){var n=7+e-i,a=(7+Ht(t,0,n).getUTCDay()-e)%7;return-a+n-1}function Bt(t,e,i,n,a){var r,o,s=(7+i-n)%7,l=Et(t,n,a),u=1+7*(e-1)+s+l;return u<=0?o=St(r=t-1)+u:u>St(t)?(r=t+1,o=u-St(t)):(r=t,o=u),{year:r,dayOfYear:o}}function jt(t,e,i){var n,a,r=Et(t.year(),e,i),o=Math.floor((t.dayOfYear()-r-1)/7)+1;return o<1?(a=t.year()-1,n=o+Ut(a,e,i)):o>Ut(t.year(),e,i)?(n=o-Ut(t.year(),e,i),a=t.year()+1):(a=t.year(),n=o),{week:n,year:a}}function Ut(t,e,i){var n=Et(t,e,i),a=Et(t+1,e,i);return(St(t)-n+a)/7}function Gt(t,e){return t.slice(e,7).concat(t.slice(0,e))}B("w",["ww",2],"wo","week"),B("W",["WW",2],"Wo","isoWeek"),F("week","w"),F("isoWeek","W"),Y("week",5),Y("isoWeek",5),ut("w",K),ut("ww",K,q),ut("W",K),ut("WW",K,q),gt(["w","ww","W","WW"],function(t,e,i,n){e[n.substr(0,1)]=k(t)}),B("d",0,"do","day"),B("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),B("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),B("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),B("e",0,0,"weekday"),B("E",0,0,"isoWeekday"),F("day","d"),F("weekday","e"),F("isoWeekday","E"),Y("day",11),Y("weekday",11),Y("isoWeekday",11),ut("d",K),ut("e",K),ut("E",K),ut("dd",function(t,e){return e.weekdaysMinRegex(t)}),ut("ddd",function(t,e){return e.weekdaysShortRegex(t)}),ut("dddd",function(t,e){return e.weekdaysRegex(t)}),gt(["dd","ddd","dddd"],function(t,e,i,n){var a=i._locale.weekdaysParse(t,n,i._strict);null!=a?e.d=a:f(i).invalidWeekday=t}),gt(["d","e","E"],function(t,e,i,n){e[n]=k(t)});var qt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Zt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),$t="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Xt=st,Kt=st,Jt=st;function Qt(){function t(t,e){return e.length-t.length}var e,i,n,a,r,o=[],s=[],l=[],u=[];for(e=0;e<7;e++)i=c([2e3,1]).day(e),n=this.weekdaysMin(i,""),a=this.weekdaysShort(i,""),r=this.weekdays(i,""),o.push(n),s.push(a),l.push(r),u.push(n),u.push(a),u.push(r);for(o.sort(t),s.sort(t),l.sort(t),u.sort(t),e=0;e<7;e++)s[e]=ht(s[e]),l[e]=ht(l[e]),u[e]=ht(u[e]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function te(){return this.hours()%12||12}function ee(t,e){B(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function ie(t,e){return e._meridiemParse}B("H",["HH",2],0,"hour"),B("h",["hh",2],0,te),B("k",["kk",2],0,function(){return this.hours()||24}),B("hmm",0,0,function(){return""+te.apply(this)+N(this.minutes(),2)}),B("hmmss",0,0,function(){return""+te.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)}),B("Hmm",0,0,function(){return""+this.hours()+N(this.minutes(),2)}),B("Hmmss",0,0,function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)}),ee("a",!0),ee("A",!1),F("hour","h"),Y("hour",13),ut("a",ie),ut("A",ie),ut("H",K),ut("h",K),ut("k",K),ut("HH",K,q),ut("hh",K,q),ut("kk",K,q),ut("hmm",J),ut("hmmss",Q),ut("Hmm",J),ut("Hmmss",Q),ft(["H","HH"],bt),ft(["k","kk"],function(t,e,i){var n=k(t);e[bt]=24===n?0:n}),ft(["a","A"],function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t}),ft(["h","hh"],function(t,e,i){e[bt]=k(t),f(i).bigHour=!0}),ft("hmm",function(t,e,i){var n=t.length-2;e[bt]=k(t.substr(0,n)),e[xt]=k(t.substr(n)),f(i).bigHour=!0}),ft("hmmss",function(t,e,i){var n=t.length-4,a=t.length-2;e[bt]=k(t.substr(0,n)),e[xt]=k(t.substr(n,2)),e[_t]=k(t.substr(a)),f(i).bigHour=!0}),ft("Hmm",function(t,e,i){var n=t.length-2;e[bt]=k(t.substr(0,n)),e[xt]=k(t.substr(n))}),ft("Hmmss",function(t,e,i){var n=t.length-4,a=t.length-2;e[bt]=k(t.substr(0,n)),e[xt]=k(t.substr(n,2)),e[_t]=k(t.substr(a))});var ne,ae=Tt("Hours",!0),re={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Rt,monthsShort:Lt,week:{dow:0,doy:6},weekdays:qt,weekdaysMin:$t,weekdaysShort:Zt,meridiemParse:/[ap]\.?m?\.?/i},oe={},se={};function le(t){return t?t.toLowerCase().replace("_","-"):t}function ue(e){var i=null;if(!oe[e]&&t&&t.exports)try{i=ne._abbr;var n=_e;n("./locale/"+e),de(i)}catch(t){}return oe[e]}function de(t,e){var i;return t&&((i=o(e)?ce(t):he(t,e))?ne=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),ne._abbr}function he(t,e){if(null!==e){var i,n=re;if(e.abbr=t,null!=oe[t])P("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=oe[t]._config;else if(null!=e.parentLocale)if(null!=oe[e.parentLocale])n=oe[e.parentLocale]._config;else{if(null==(i=ue(e.parentLocale)))return se[e.parentLocale]||(se[e.parentLocale]=[]),se[e.parentLocale].push({name:t,config:e}),null;n=i._config}return oe[t]=new I(O(n,e)),se[t]&&se[t].forEach(function(t){he(t.name,t.config)}),de(t),oe[t]}return delete oe[t],null}function ce(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return ne;if(!a(t)){if(e=ue(t))return e;t=[t]}return function(t){for(var e,i,n,a,r=0;r<t.length;){for(a=le(t[r]).split("-"),e=a.length,i=(i=le(t[r+1]))?i.split("-"):null;e>0;){if(n=ue(a.slice(0,e).join("-")))return n;if(i&&i.length>=e&&w(a,i,!0)>=e-1)break;e--}r++}return ne}(t)}function fe(t){var e,i=t._a;return i&&-2===f(t).overflow&&(e=i[vt]<0||i[vt]>11?vt:i[yt]<1||i[yt]>At(i[pt],i[vt])?yt:i[bt]<0||i[bt]>24||24===i[bt]&&(0!==i[xt]||0!==i[_t]||0!==i[kt])?bt:i[xt]<0||i[xt]>59?xt:i[_t]<0||i[_t]>59?_t:i[kt]<0||i[kt]>999?kt:-1,f(t)._overflowDayOfYear&&(e<pt||e>yt)&&(e=yt),f(t)._overflowWeeks&&-1===e&&(e=wt),f(t)._overflowWeekday&&-1===e&&(e=Mt),f(t).overflow=e),t}function ge(t,e,i){return null!=t?t:null!=e?e:i}function me(t){var e,i,a,r,o,s=[];if(!t._d){for(a=function(t){var e=new Date(n.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[yt]&&null==t._a[vt]&&function(t){var e,i,n,a,r,o,s,l;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)r=1,o=4,i=ge(e.GG,t._a[pt],jt(Ie(),1,4).year),n=ge(e.W,1),((a=ge(e.E,1))<1||a>7)&&(l=!0);else{r=t._locale._week.dow,o=t._locale._week.doy;var u=jt(Ie(),r,o);i=ge(e.gg,t._a[pt],u.year),n=ge(e.w,u.week),null!=e.d?((a=e.d)<0||a>6)&&(l=!0):null!=e.e?(a=e.e+r,(e.e<0||e.e>6)&&(l=!0)):a=r}n<1||n>Ut(i,r,o)?f(t)._overflowWeeks=!0:null!=l?f(t)._overflowWeekday=!0:(s=Bt(i,n,a,r,o),t._a[pt]=s.year,t._dayOfYear=s.dayOfYear)}(t),null!=t._dayOfYear&&(o=ge(t._a[pt],a[pt]),(t._dayOfYear>St(o)||0===t._dayOfYear)&&(f(t)._overflowDayOfYear=!0),i=Ht(o,0,t._dayOfYear),t._a[vt]=i.getUTCMonth(),t._a[yt]=i.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=a[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[bt]&&0===t._a[xt]&&0===t._a[_t]&&0===t._a[kt]&&(t._nextDay=!0,t._a[bt]=0),t._d=(t._useUTC?Ht:function(t,e,i,n,a,r,o){var s;return t<100&&t>=0?(s=new Date(t+400,e,i,n,a,r,o),isFinite(s.getFullYear())&&s.setFullYear(t)):s=new Date(t,e,i,n,a,r,o),s}).apply(null,s),r=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[bt]=24),t._w&&void 0!==t._w.d&&t._w.d!==r&&(f(t).weekdayMismatch=!0)}}var pe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ve=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ye=/Z|[+-]\d\d(?::?\d\d)?/,be=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],xe=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ke=/^\/?Date\((\-?\d+)/i;function we(t){var e,i,n,a,r,o,s=t._i,l=pe.exec(s)||ve.exec(s);if(l){for(f(t).iso=!0,e=0,i=be.length;e<i;e++)if(be[e][1].exec(l[1])){a=be[e][0],n=!1!==be[e][2];break}if(null==a)return void(t._isValid=!1);if(l[3]){for(e=0,i=xe.length;e<i;e++)if(xe[e][1].exec(l[3])){r=(l[2]||" ")+xe[e][0];break}if(null==r)return void(t._isValid=!1)}if(!n&&null!=r)return void(t._isValid=!1);if(l[4]){if(!ye.exec(l[4]))return void(t._isValid=!1);o="Z"}t._f=a+(r||"")+(o||""),Pe(t)}else t._isValid=!1}var Me=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Se(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}var De={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Ce(t){var e,i,n,a,r,o,s,l=Me.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(l){var u=(e=l[4],i=l[3],n=l[2],a=l[5],r=l[6],o=l[7],s=[Se(e),Lt.indexOf(i),parseInt(n,10),parseInt(a,10),parseInt(r,10)],o&&s.push(parseInt(o,10)),s);if(!function(t,e,i){if(t){var n=Zt.indexOf(t),a=new Date(e[0],e[1],e[2]).getDay();if(n!==a)return f(i).weekdayMismatch=!0,i._isValid=!1,!1}return!0}(l[1],u,t))return;t._a=u,t._tzm=function(t,e,i){if(t)return De[t];if(e)return 0;var n=parseInt(i,10),a=n%100,r=(n-a)/100;return 60*r+a}(l[8],l[9],l[10]),t._d=Ht.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),f(t).rfc2822=!0}else t._isValid=!1}function Pe(t){if(t._f!==n.ISO_8601)if(t._f!==n.RFC_2822){t._a=[],f(t).empty=!0;var e,i,a,r,o,s=""+t._i,l=s.length,u=0;for(a=U(t._f,t._locale).match(z)||[],e=0;e<a.length;e++)r=a[e],(i=(s.match(dt(r,t))||[])[0])&&((o=s.substr(0,s.indexOf(i))).length>0&&f(t).unusedInput.push(o),s=s.slice(s.indexOf(i)+i.length),u+=i.length),E[r]?(i?f(t).empty=!1:f(t).unusedTokens.push(r),mt(r,i,t)):t._strict&&!i&&f(t).unusedTokens.push(r);f(t).charsLeftOver=l-u,s.length>0&&f(t).unusedInput.push(s),t._a[bt]<=12&&!0===f(t).bigHour&&t._a[bt]>0&&(f(t).bigHour=void 0),f(t).parsedDateParts=t._a.slice(0),f(t).meridiem=t._meridiem,t._a[bt]=(d=t._locale,h=t._a[bt],null==(c=t._meridiem)?h:null!=d.meridiemHour?d.meridiemHour(h,c):null!=d.isPM?((g=d.isPM(c))&&h<12&&(h+=12),g||12!==h||(h=0),h):h),me(t),fe(t)}else Ce(t);else we(t);var d,h,c,g}function Te(t){var e=t._i,i=t._f;return t._locale=t._locale||ce(t._l),null===e||void 0===i&&""===e?m({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),x(e)?new b(fe(e)):(l(e)?t._d=e:a(i)?function(t){var e,i,n,a,r;if(0===t._f.length)return f(t).invalidFormat=!0,void(t._d=new Date(NaN));for(a=0;a<t._f.length;a++)r=0,e=v({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[a],Pe(e),g(e)&&(r+=f(e).charsLeftOver,r+=10*f(e).unusedTokens.length,f(e).score=r,(null==n||r<n)&&(n=r,i=e));h(t,i||e)}(t):i?Pe(t):function(t){var e=t._i;o(e)?t._d=new Date(n.now()):l(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=ke.exec(t._i);null===e?(we(t),!1===t._isValid&&(delete t._isValid,Ce(t),!1===t._isValid&&(delete t._isValid,n.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):a(e)?(t._a=u(e.slice(0),function(t){return parseInt(t,10)}),me(t)):r(e)?function(t){if(!t._d){var e=L(t._i);t._a=u([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),me(t)}}(t):s(e)?t._d=new Date(e):n.createFromInputFallback(t)}(t),g(t)||(t._d=null),t))}function Oe(t,e,i,n,o){var s,l={};return!0!==i&&!1!==i||(n=i,i=void 0),(r(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||a(t)&&0===t.length)&&(t=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=o,l._l=i,l._i=t,l._f=e,l._strict=n,(s=new b(fe(Te(l))))._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function Ie(t,e,i,n){return Oe(t,e,i,n,!1)}n.createFromInputFallback=S("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),n.ISO_8601=function(){},n.RFC_2822=function(){};var Ae=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ie.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:m()}),Fe=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ie.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:m()});function Re(t,e){var i,n;if(1===e.length&&a(e[0])&&(e=e[0]),!e.length)return Ie();for(i=e[0],n=1;n<e.length;++n)e[n].isValid()&&!e[n][t](i)||(i=e[n]);return i}var Le=["year","quarter","month","week","day","hour","minute","second","millisecond"];function We(t){var e=L(t),i=e.year||0,n=e.quarter||0,a=e.month||0,r=e.week||e.isoWeek||0,o=e.day||0,s=e.hour||0,l=e.minute||0,u=e.second||0,d=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===Ct.call(Le,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var i=!1,n=0;n<Le.length;++n)if(t[Le[n]]){if(i)return!1;parseFloat(t[Le[n]])!==k(t[Le[n]])&&(i=!0)}return!0}(e),this._milliseconds=+d+1e3*u+6e4*l+1e3*s*60*60,this._days=+o+7*r,this._months=+a+3*n+12*i,this._data={},this._locale=ce(),this._bubble()}function Ye(t){return t instanceof We}function Ne(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function ze(t,e){B(t,0,0,function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+N(~~(t/60),2)+e+N(~~t%60,2)})}ze("Z",":"),ze("ZZ",""),ut("Z",ot),ut("ZZ",ot),ft(["Z","ZZ"],function(t,e,i){i._useUTC=!0,i._tzm=He(ot,t)});var Ve=/([\+\-]|\d\d)/gi;function He(t,e){var i=(e||"").match(t);if(null===i)return null;var n=i[i.length-1]||[],a=(n+"").match(Ve)||["-",0,0],r=60*a[1]+k(a[2]);return 0===r?0:"+"===a[0]?r:-r}function Ee(t,e){var i,a;return e._isUTC?(i=e.clone(),a=(x(t)||l(t)?t.valueOf():Ie(t).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+a),n.updateOffset(i,!1),i):Ie(t).local()}function Be(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function je(){return!!this.isValid()&&this._isUTC&&0===this._offset}n.updateOffset=function(){};var Ue=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ge=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function qe(t,e){var i,n,a,r,o,l,u=t,h=null;return Ye(t)?u={ms:t._milliseconds,d:t._days,M:t._months}:s(t)?(u={},e?u[e]=t:u.milliseconds=t):(h=Ue.exec(t))?(i="-"===h[1]?-1:1,u={y:0,d:k(h[yt])*i,h:k(h[bt])*i,m:k(h[xt])*i,s:k(h[_t])*i,ms:k(Ne(1e3*h[kt]))*i}):(h=Ge.exec(t))?(i="-"===h[1]?-1:1,u={y:Ze(h[2],i),M:Ze(h[3],i),w:Ze(h[4],i),d:Ze(h[5],i),h:Ze(h[6],i),m:Ze(h[7],i),s:Ze(h[8],i)}):null==u?u={}:"object"==typeof u&&("from"in u||"to"in u)&&(r=Ie(u.from),o=Ie(u.to),a=r.isValid()&&o.isValid()?(o=Ee(o,r),r.isBefore(o)?l=$e(r,o):((l=$e(o,r)).milliseconds=-l.milliseconds,l.months=-l.months),l):{milliseconds:0,months:0},(u={}).ms=a.milliseconds,u.M=a.months),n=new We(u),Ye(t)&&d(t,"_locale")&&(n._locale=t._locale),n}function Ze(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function $e(t,e){var i={};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function Xe(t,e){return function(i,n){var a;return null===n||isNaN(+n)||(P(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=i,i=n,n=a),Ke(this,qe(i="string"==typeof i?+i:i,n),t),this}}function Ke(t,e,i,a){var r=e._milliseconds,o=Ne(e._days),s=Ne(e._months);t.isValid()&&(a=null==a||a,s&&Wt(t,Ot(t,"Month")+s*i),o&&It(t,"Date",Ot(t,"Date")+o*i),r&&t._d.setTime(t._d.valueOf()+r*i),a&&n.updateOffset(t,o||s))}qe.fn=We.prototype,qe.invalid=function(){return qe(NaN)};var Je=Xe(1,"add"),Qe=Xe(-1,"subtract");function ti(t,e){var i,n,a=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(a,"months");return e-r<0?(i=t.clone().add(a-1,"months"),n=(e-r)/(r-i)):(i=t.clone().add(a+1,"months"),n=(e-r)/(i-r)),-(a+n)||0}function ei(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ce(t))&&(this._locale=e),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ii=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});function ni(){return this._locale}var ai=1e3,ri=60*ai,oi=60*ri,si=3506328*oi;function li(t,e){return(t%e+e)%e}function ui(t,e,i){return t<100&&t>=0?new Date(t+400,e,i)-si:new Date(t,e,i).valueOf()}function di(t,e,i){return t<100&&t>=0?Date.UTC(t+400,e,i)-si:Date.UTC(t,e,i)}function hi(t,e){B(0,[t,t.length],0,e)}function ci(t,e,i,n,a){var r;return null==t?jt(this,n,a).year:(r=Ut(t,n,a),e>r&&(e=r),function(t,e,i,n,a){var r=Bt(t,e,i,n,a),o=Ht(r.year,0,r.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}.call(this,t,e,i,n,a))}B(0,["gg",2],0,function(){return this.weekYear()%100}),B(0,["GG",2],0,function(){return this.isoWeekYear()%100}),hi("gggg","weekYear"),hi("ggggg","weekYear"),hi("GGGG","isoWeekYear"),hi("GGGGG","isoWeekYear"),F("weekYear","gg"),F("isoWeekYear","GG"),Y("weekYear",1),Y("isoWeekYear",1),ut("G",at),ut("g",at),ut("GG",K,q),ut("gg",K,q),ut("GGGG",et,$),ut("gggg",et,$),ut("GGGGG",it,X),ut("ggggg",it,X),gt(["gggg","ggggg","GGGG","GGGGG"],function(t,e,i,n){e[n.substr(0,2)]=k(t)}),gt(["gg","GG"],function(t,e,i,a){e[a]=n.parseTwoDigitYear(t)}),B("Q",0,"Qo","quarter"),F("quarter","Q"),Y("quarter",7),ut("Q",G),ft("Q",function(t,e){e[vt]=3*(k(t)-1)}),B("D",["DD",2],"Do","date"),F("date","D"),Y("date",9),ut("D",K),ut("DD",K,q),ut("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),ft(["D","DD"],yt),ft("Do",function(t,e){e[yt]=k(t.match(K)[0])});var fi=Tt("Date",!0);B("DDD",["DDDD",3],"DDDo","dayOfYear"),F("dayOfYear","DDD"),Y("dayOfYear",4),ut("DDD",tt),ut("DDDD",Z),ft(["DDD","DDDD"],function(t,e,i){i._dayOfYear=k(t)}),B("m",["mm",2],0,"minute"),F("minute","m"),Y("minute",14),ut("m",K),ut("mm",K,q),ft(["m","mm"],xt);var gi=Tt("Minutes",!1);B("s",["ss",2],0,"second"),F("second","s"),Y("second",15),ut("s",K),ut("ss",K,q),ft(["s","ss"],_t);var mi,pi=Tt("Seconds",!1);for(B("S",0,0,function(){return~~(this.millisecond()/100)}),B(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),B(0,["SSS",3],0,"millisecond"),B(0,["SSSS",4],0,function(){return 10*this.millisecond()}),B(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),B(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),B(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),B(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),B(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),F("millisecond","ms"),Y("millisecond",16),ut("S",tt,G),ut("SS",tt,q),ut("SSS",tt,Z),mi="SSSS";mi.length<=9;mi+="S")ut(mi,nt);function vi(t,e){e[kt]=k(1e3*("0."+t))}for(mi="S";mi.length<=9;mi+="S")ft(mi,vi);var yi=Tt("Milliseconds",!1);B("z",0,0,"zoneAbbr"),B("zz",0,0,"zoneName");var bi=b.prototype;function xi(t){return t}bi.add=Je,bi.calendar=function(t,e){var i=t||Ie(),a=Ee(i,this).startOf("day"),r=n.calendarFormat(this,a)||"sameElse",o=e&&(T(e[r])?e[r].call(this,i):e[r]);return this.format(o||this.localeData().calendar(r,this,Ie(i)))},bi.clone=function(){return new b(this)},bi.diff=function(t,e,i){var n,a,r;if(!this.isValid())return NaN;if(!(n=Ee(t,this)).isValid())return NaN;switch(a=6e4*(n.utcOffset()-this.utcOffset()),e=R(e)){case"year":r=ti(this,n)/12;break;case"month":r=ti(this,n);break;case"quarter":r=ti(this,n)/3;break;case"second":r=(this-n)/1e3;break;case"minute":r=(this-n)/6e4;break;case"hour":r=(this-n)/36e5;break;case"day":r=(this-n-a)/864e5;break;case"week":r=(this-n-a)/6048e5;break;default:r=this-n}return i?r:_(r)},bi.endOf=function(t){var e;if(void 0===(t=R(t))||"millisecond"===t||!this.isValid())return this;var i=this._isUTC?di:ui;switch(t){case"year":e=i(this.year()+1,0,1)-1;break;case"quarter":e=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=i(this.year(),this.month()+1,1)-1;break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=oi-li(e+(this._isUTC?0:this.utcOffset()*ri),oi)-1;break;case"minute":e=this._d.valueOf(),e+=ri-li(e,ri)-1;break;case"second":e=this._d.valueOf(),e+=ai-li(e,ai)-1}return this._d.setTime(e),n.updateOffset(this,!0),this},bi.format=function(t){t||(t=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var e=j(this,t);return this.localeData().postformat(e)},bi.from=function(t,e){return this.isValid()&&(x(t)&&t.isValid()||Ie(t).isValid())?qe({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},bi.fromNow=function(t){return this.from(Ie(),t)},bi.to=function(t,e){return this.isValid()&&(x(t)&&t.isValid()||Ie(t).isValid())?qe({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},bi.toNow=function(t){return this.to(Ie(),t)},bi.get=function(t){return T(this[t=R(t)])?this[t]():this},bi.invalidAt=function(){return f(this).overflow},bi.isAfter=function(t,e){var i=x(t)?t:Ie(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=R(e)||"millisecond")?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())},bi.isBefore=function(t,e){var i=x(t)?t:Ie(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=R(e)||"millisecond")?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())},bi.isBetween=function(t,e,i,n){var a=x(t)?t:Ie(t),r=x(e)?e:Ie(e);return!!(this.isValid()&&a.isValid()&&r.isValid())&&(("("===(n=n||"()")[0]?this.isAfter(a,i):!this.isBefore(a,i))&&(")"===n[1]?this.isBefore(r,i):!this.isAfter(r,i)))},bi.isSame=function(t,e){var i,n=x(t)?t:Ie(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=R(e)||"millisecond")?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))},bi.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},bi.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},bi.isValid=function(){return g(this)},bi.lang=ii,bi.locale=ei,bi.localeData=ni,bi.max=Fe,bi.min=Ae,bi.parsingFlags=function(){return h({},f(this))},bi.set=function(t,e){if("object"==typeof t)for(var i=function(t){var e=[];for(var i in t)e.push({unit:i,priority:W[i]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=L(t)),n=0;n<i.length;n++)this[i[n].unit](t[i[n].unit]);else if(T(this[t=R(t)]))return this[t](e);return this},bi.startOf=function(t){var e;if(void 0===(t=R(t))||"millisecond"===t||!this.isValid())return this;var i=this._isUTC?di:ui;switch(t){case"year":e=i(this.year(),0,1);break;case"quarter":e=i(this.year(),this.month()-this.month()%3,1);break;case"month":e=i(this.year(),this.month(),1);break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=i(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=li(e+(this._isUTC?0:this.utcOffset()*ri),oi);break;case"minute":e=this._d.valueOf(),e-=li(e,ri);break;case"second":e=this._d.valueOf(),e-=li(e,ai)}return this._d.setTime(e),n.updateOffset(this,!0),this},bi.subtract=Qe,bi.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},bi.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},bi.toDate=function(){return new Date(this.valueOf())},bi.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,i=e?this.clone().utc():this;return i.year()<0||i.year()>9999?j(i,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):T(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",j(i,"Z")):j(i,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},bi.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var i="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a=e+'[")]';return this.format(i+n+"-MM-DD[T]HH:mm:ss.SSS"+a)},bi.toJSON=function(){return this.isValid()?this.toISOString():null},bi.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},bi.unix=function(){return Math.floor(this.valueOf()/1e3)},bi.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},bi.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},bi.year=Pt,bi.isLeapYear=function(){return Dt(this.year())},bi.weekYear=function(t){return ci.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},bi.isoWeekYear=function(t){return ci.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},bi.quarter=bi.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},bi.month=Yt,bi.daysInMonth=function(){return At(this.year(),this.month())},bi.week=bi.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},bi.isoWeek=bi.isoWeeks=function(t){var e=jt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},bi.weeksInYear=function(){var t=this.localeData()._week;return Ut(this.year(),t.dow,t.doy)},bi.isoWeeksInYear=function(){return Ut(this.year(),1,4)},bi.date=fi,bi.day=bi.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},bi.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},bi.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},bi.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},bi.hour=bi.hours=ae,bi.minute=bi.minutes=gi,bi.second=bi.seconds=pi,bi.millisecond=bi.milliseconds=yi,bi.utcOffset=function(t,e,i){var a,r=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=He(ot,t)))return this}else Math.abs(t)<16&&!i&&(t*=60);return!this._isUTC&&e&&(a=Be(this)),this._offset=t,this._isUTC=!0,null!=a&&this.add(a,"m"),r!==t&&(!e||this._changeInProgress?Ke(this,qe(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Be(this)},bi.utc=function(t){return this.utcOffset(0,t)},bi.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Be(this),"m")),this},bi.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=He(rt,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},bi.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?Ie(t).utcOffset():0,(this.utcOffset()-t)%60==0)},bi.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},bi.isLocal=function(){return!!this.isValid()&&!this._isUTC},bi.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},bi.isUtc=je,bi.isUTC=je,bi.zoneAbbr=function(){return this._isUTC?"UTC":""},bi.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},bi.dates=S("dates accessor is deprecated. Use date instead.",fi),bi.months=S("months accessor is deprecated. Use month instead",Yt),bi.years=S("years accessor is deprecated. Use year instead",Pt),bi.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),bi.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!o(this._isDSTShifted))return this._isDSTShifted;var t={};if(v(t,this),(t=Te(t))._a){var e=t._isUTC?c(t._a):Ie(t._a);this._isDSTShifted=this.isValid()&&w(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var _i=I.prototype;function ki(t,e,i,n){var a=ce(),r=c().set(n,e);return a[i](r,t)}function wi(t,e,i){if(s(t)&&(e=t,t=void 0),t=t||"",null!=e)return ki(t,e,i,"month");var n,a=[];for(n=0;n<12;n++)a[n]=ki(t,n,i,"month");return a}function Mi(t,e,i,n){"boolean"==typeof t?(s(e)&&(i=e,e=void 0),e=e||""):(i=e=t,t=!1,s(e)&&(i=e,e=void 0),e=e||"");var a,r=ce(),o=t?r._week.dow:0;if(null!=i)return ki(e,(i+o)%7,n,"day");var l=[];for(a=0;a<7;a++)l[a]=ki(e,(a+o)%7,n,"day");return l}_i.calendar=function(t,e,i){var n=this._calendar[t]||this._calendar.sameElse;return T(n)?n.call(e,i):n},_i.longDateFormat=function(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},_i.invalidDate=function(){return this._invalidDate},_i.ordinal=function(t){return this._ordinal.replace("%d",t)},_i.preparse=xi,_i.postformat=xi,_i.relativeTime=function(t,e,i,n){var a=this._relativeTime[i];return T(a)?a(t,e,i,n):a.replace(/%d/i,t)},_i.pastFuture=function(t,e){var i=this._relativeTime[t>0?"future":"past"];return T(i)?i(e):i.replace(/%s/i,e)},_i.set=function(t){var e,i;for(i in t)T(e=t[i])?this[i]=e:this["_"+i]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},_i.months=function(t,e){return t?a(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Ft).test(e)?"format":"standalone"][t.month()]:a(this._months)?this._months:this._months.standalone},_i.monthsShort=function(t,e){return t?a(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Ft.test(e)?"format":"standalone"][t.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},_i.monthsParse=function(t,e,i){var n,a,r;if(this._monthsParseExact)return function(t,e,i){var n,a,r,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)r=c([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(r,"").toLocaleLowerCase();return i?"MMM"===e?-1!==(a=Ct.call(this._shortMonthsParse,o))?a:null:-1!==(a=Ct.call(this._longMonthsParse,o))?a:null:"MMM"===e?-1!==(a=Ct.call(this._shortMonthsParse,o))?a:-1!==(a=Ct.call(this._longMonthsParse,o))?a:null:-1!==(a=Ct.call(this._longMonthsParse,o))?a:-1!==(a=Ct.call(this._shortMonthsParse,o))?a:null}.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(a=c([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(r="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(r.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[n].test(t))return n;if(i&&"MMM"===e&&this._shortMonthsParse[n].test(t))return n;if(!i&&this._monthsParse[n].test(t))return n}},_i.monthsRegex=function(t){return this._monthsParseExact?(d(this,"_monthsRegex")||Vt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(d(this,"_monthsRegex")||(this._monthsRegex=zt),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},_i.monthsShortRegex=function(t){return this._monthsParseExact?(d(this,"_monthsRegex")||Vt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(d(this,"_monthsShortRegex")||(this._monthsShortRegex=Nt),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},_i.week=function(t){return jt(t,this._week.dow,this._week.doy).week},_i.firstDayOfYear=function(){return this._week.doy},_i.firstDayOfWeek=function(){return this._week.dow},_i.weekdays=function(t,e){var i=a(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Gt(i,this._week.dow):t?i[t.day()]:i},_i.weekdaysMin=function(t){return!0===t?Gt(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},_i.weekdaysShort=function(t){return!0===t?Gt(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},_i.weekdaysParse=function(t,e,i){var n,a,r;if(this._weekdaysParseExact)return function(t,e,i){var n,a,r,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)r=c([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(r,"").toLocaleLowerCase();return i?"dddd"===e?-1!==(a=Ct.call(this._weekdaysParse,o))?a:null:"ddd"===e?-1!==(a=Ct.call(this._shortWeekdaysParse,o))?a:null:-1!==(a=Ct.call(this._minWeekdaysParse,o))?a:null:"dddd"===e?-1!==(a=Ct.call(this._weekdaysParse,o))?a:-1!==(a=Ct.call(this._shortWeekdaysParse,o))?a:-1!==(a=Ct.call(this._minWeekdaysParse,o))?a:null:"ddd"===e?-1!==(a=Ct.call(this._shortWeekdaysParse,o))?a:-1!==(a=Ct.call(this._weekdaysParse,o))?a:-1!==(a=Ct.call(this._minWeekdaysParse,o))?a:null:-1!==(a=Ct.call(this._minWeekdaysParse,o))?a:-1!==(a=Ct.call(this._weekdaysParse,o))?a:-1!==(a=Ct.call(this._shortWeekdaysParse,o))?a:null}.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(a=c([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(r="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[n]=new RegExp(r.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[n].test(t))return n;if(i&&"ddd"===e&&this._shortWeekdaysParse[n].test(t))return n;if(i&&"dd"===e&&this._minWeekdaysParse[n].test(t))return n;if(!i&&this._weekdaysParse[n].test(t))return n}},_i.weekdaysRegex=function(t){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||Qt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(d(this,"_weekdaysRegex")||(this._weekdaysRegex=Xt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},_i.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||Qt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(d(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Kt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},_i.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||Qt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(d(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Jt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},_i.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},_i.meridiem=function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},de("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,i=1===k(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),n.lang=S("moment.lang is deprecated. Use moment.locale instead.",de),n.langData=S("moment.langData is deprecated. Use moment.localeData instead.",ce);var Si=Math.abs;function Di(t,e,i,n){var a=qe(e,i);return t._milliseconds+=n*a._milliseconds,t._days+=n*a._days,t._months+=n*a._months,t._bubble()}function Ci(t){return t<0?Math.floor(t):Math.ceil(t)}function Pi(t){return 4800*t/146097}function Ti(t){return 146097*t/4800}function Oi(t){return function(){return this.as(t)}}var Ii=Oi("ms"),Ai=Oi("s"),Fi=Oi("m"),Ri=Oi("h"),Li=Oi("d"),Wi=Oi("w"),Yi=Oi("M"),Ni=Oi("Q"),zi=Oi("y");function Vi(t){return function(){return this.isValid()?this._data[t]:NaN}}var Hi=Vi("milliseconds"),Ei=Vi("seconds"),Bi=Vi("minutes"),ji=Vi("hours"),Ui=Vi("days"),Gi=Vi("months"),qi=Vi("years"),Zi=Math.round,$i={ss:44,s:45,m:45,h:22,d:26,M:11},Xi=Math.abs;function Ki(t){return(t>0)-(t<0)||+t}function Ji(){if(!this.isValid())return this.localeData().invalidDate();var t,e,i=Xi(this._milliseconds)/1e3,n=Xi(this._days),a=Xi(this._months);t=_(i/60),e=_(t/60),i%=60,t%=60;var r=_(a/12),o=a%=12,s=n,l=e,u=t,d=i?i.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var c=h<0?"-":"",f=Ki(this._months)!==Ki(h)?"-":"",g=Ki(this._days)!==Ki(h)?"-":"",m=Ki(this._milliseconds)!==Ki(h)?"-":"";return c+"P"+(r?f+r+"Y":"")+(o?f+o+"M":"")+(s?g+s+"D":"")+(l||u||d?"T":"")+(l?m+l+"H":"")+(u?m+u+"M":"")+(d?m+d+"S":"")}var Qi=We.prototype;return Qi.isValid=function(){return this._isValid},Qi.abs=function(){var t=this._data;return this._milliseconds=Si(this._milliseconds),this._days=Si(this._days),this._months=Si(this._months),t.milliseconds=Si(t.milliseconds),t.seconds=Si(t.seconds),t.minutes=Si(t.minutes),t.hours=Si(t.hours),t.months=Si(t.months),t.years=Si(t.years),this},Qi.add=function(t,e){return Di(this,t,e,1)},Qi.subtract=function(t,e){return Di(this,t,e,-1)},Qi.as=function(t){if(!this.isValid())return NaN;var e,i,n=this._milliseconds;if("month"===(t=R(t))||"quarter"===t||"year"===t)switch(e=this._days+n/864e5,i=this._months+Pi(e),t){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(e=this._days+Math.round(Ti(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return 24*e+n/36e5;case"minute":return 1440*e+n/6e4;case"second":return 86400*e+n/1e3;case"millisecond":return Math.floor(864e5*e)+n;default:throw new Error("Unknown unit "+t)}},Qi.asMilliseconds=Ii,Qi.asSeconds=Ai,Qi.asMinutes=Fi,Qi.asHours=Ri,Qi.asDays=Li,Qi.asWeeks=Wi,Qi.asMonths=Yi,Qi.asQuarters=Ni,Qi.asYears=zi,Qi.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},Qi._bubble=function(){var t,e,i,n,a,r=this._milliseconds,o=this._days,s=this._months,l=this._data;return r>=0&&o>=0&&s>=0||r<=0&&o<=0&&s<=0||(r+=864e5*Ci(Ti(s)+o),o=0,s=0),l.milliseconds=r%1e3,t=_(r/1e3),l.seconds=t%60,e=_(t/60),l.minutes=e%60,i=_(e/60),l.hours=i%24,o+=_(i/24),a=_(Pi(o)),s+=a,o-=Ci(Ti(a)),n=_(s/12),s%=12,l.days=o,l.months=s,l.years=n,this},Qi.clone=function(){return qe(this)},Qi.get=function(t){return t=R(t),this.isValid()?this[t+"s"]():NaN},Qi.milliseconds=Hi,Qi.seconds=Ei,Qi.minutes=Bi,Qi.hours=ji,Qi.days=Ui,Qi.weeks=function(){return _(this.days()/7)},Qi.months=Gi,Qi.years=qi,Qi.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),i=function(t,e,i){var n=qe(t).abs(),a=Zi(n.as("s")),r=Zi(n.as("m")),o=Zi(n.as("h")),s=Zi(n.as("d")),l=Zi(n.as("M")),u=Zi(n.as("y")),d=a<=$i.ss&&["s",a]||a<$i.s&&["ss",a]||r<=1&&["m"]||r<$i.m&&["mm",r]||o<=1&&["h"]||o<$i.h&&["hh",o]||s<=1&&["d"]||s<$i.d&&["dd",s]||l<=1&&["M"]||l<$i.M&&["MM",l]||u<=1&&["y"]||["yy",u];return d[2]=e,d[3]=+t>0,d[4]=i,function(t,e,i,n,a){return a.relativeTime(e||1,!!i,t,n)}.apply(null,d)}(this,!t,e);return t&&(i=e.pastFuture(+this,i)),e.postformat(i)},Qi.toISOString=Ji,Qi.toString=Ji,Qi.toJSON=Ji,Qi.locale=ei,Qi.localeData=ni,Qi.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ji),Qi.lang=ii,B("X",0,0,"unix"),B("x",0,0,"valueOf"),ut("x",at),ut("X",/[+-]?\d+(\.\d{1,3})?/),ft("X",function(t,e,i){i._d=new Date(1e3*parseFloat(t,10))}),ft("x",function(t,e,i){i._d=new Date(k(t))}),n.version="2.24.0",e=Ie,n.fn=bi,n.min=function(){return Re("isBefore",[].slice.call(arguments,0))},n.max=function(){return Re("isAfter",[].slice.call(arguments,0))},n.now=function(){return Date.now?Date.now():+new Date},n.utc=c,n.unix=function(t){return Ie(1e3*t)},n.months=function(t,e){return wi(t,e,"months")},n.isDate=l,n.locale=de,n.invalid=m,n.duration=qe,n.isMoment=x,n.weekdays=function(t,e,i){return Mi(t,e,i,"weekdays")},n.parseZone=function(){return Ie.apply(null,arguments).parseZone()},n.localeData=ce,n.isDuration=Ye,n.monthsShort=function(t,e){return wi(t,e,"monthsShort")},n.weekdaysMin=function(t,e,i){return Mi(t,e,i,"weekdaysMin")},n.defineLocale=he,n.updateLocale=function(t,e){if(null!=e){var i,n,a=re;null!=(n=ue(t))&&(a=n._config),e=O(a,e),(i=new I(e)).parentLocale=oe[t],oe[t]=i,de(t)}else null!=oe[t]&&(null!=oe[t].parentLocale?oe[t]=oe[t].parentLocale:null!=oe[t]&&delete oe[t]);return oe[t]},n.locales=function(){return D(oe)},n.weekdaysShort=function(t,e,i){return Mi(t,e,i,"weekdaysShort")},n.normalizeUnits=R,n.relativeTimeRounding=function(t){return void 0===t?Zi:"function"==typeof t&&(Zi=t,!0)},n.relativeTimeThreshold=function(t,e){return void 0!==$i[t]&&(void 0===e?$i[t]:($i[t]=e,"s"===t&&($i.ss=e-1),!0))},n.calendarFormat=function(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"},n.prototype=bi,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}()}(tn={exports:{}},tn.exports),tn.exports),an={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};si._date.override("function"==typeof nn?{_id:"moment",formats:function(){return an},parse:function(t,e){return"string"==typeof t&&"string"==typeof e?t=nn(t,e):t instanceof nn||(t=nn(t)),t.isValid()?t.valueOf():null},format:function(t,e){return nn(t).format(e)},add:function(t,e,i){return nn(t).add(e,i).valueOf()},diff:function(t,e,i){return nn.duration(nn(t).diff(nn(e))).as(i)},startOf:function(t,e,i){return t=nn(t),"isoWeek"===e?t.isoWeekday(i).valueOf():t.startOf(e).valueOf()},endOf:function(t,e){return nn(t).endOf(e).valueOf()},_create:function(t){return nn(t)}}:{}),ot._set("global",{plugins:{filler:{propagate:!0}}});var rn={dataset:function(t){var e=t.fill,i=t.chart,n=i.getDatasetMeta(e),a=n&&i.isDatasetVisible(e)&&n.dataset._children||[],r=a.length||0;return r?function(t,e){return e<r&&a[e]._view||null}:null},boundary:function(t){var e=t.boundary,i=e?e.x:null,n=e?e.y:null;return function(t){return{x:null===i?t.x:i,y:null===n?t.y:n}}}};function on(t,e,i){var n,a=t._model||{},r=a.fill;if(void 0===r&&(r=!!a.backgroundColor),!1===r||null===r)return!1;if(!0===r)return"origin";if(n=parseFloat(r,10),isFinite(n)&&Math.floor(n)===n)return"-"!==r[0]&&"+"!==r[0]||(n=e+n),!(n===e||n<0||n>=i)&&n;switch(r){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return r;default:return!1}}function sn(t){var e,i=t.el._model||{},n=t.el._scale||{},a=t.fill,r=null;if(isFinite(a))return null;if("start"===a?r=void 0===i.scaleBottom?n.bottom:i.scaleBottom:"end"===a?r=void 0===i.scaleTop?n.top:i.scaleTop:void 0!==i.scaleZero?r=i.scaleZero:n.getBasePosition?r=n.getBasePosition():n.getBasePixel&&(r=n.getBasePixel()),null!=r){if(void 0!==r.x&&void 0!==r.y)return r;if(ut.isFinite(r))return{x:(e=n.isHorizontal())?r:null,y:e?null:r}}return null}function ln(t,e,i){var n,a=t[e].fill,r=[e];if(!i)return a;for(;!1!==a&&-1===r.indexOf(a);){if(!isFinite(a))return a;if(!(n=t[a]))return!1;if(n.visible)return a;r.push(a),a=n.fill}return!1}function un(t){var e=t.fill,i="dataset";return!1===e?null:(isFinite(e)||(i="boundary"),rn[i](t))}function dn(t){return t&&!t.skip}function hn(t,e,i,n,a){var r;if(n&&a){for(t.moveTo(e[0].x,e[0].y),r=1;r<n;++r)ut.canvas.lineTo(t,e[r-1],e[r]);for(t.lineTo(i[a-1].x,i[a-1].y),r=a-1;r>0;--r)ut.canvas.lineTo(t,i[r],i[r-1],!0)}}var cn={id:"filler",afterDatasetsUpdate:function(t,e){var i,n,a,r,o=(t.data.datasets||[]).length,s=e.propagate,l=[];for(n=0;n<o;++n)r=null,(a=(i=t.getDatasetMeta(n)).dataset)&&a._model&&a instanceof Nt.Line&&(r={visible:t.isDatasetVisible(n),fill:on(a,n,o),chart:t,el:a}),i.$filler=r,l.push(r);for(n=0;n<o;++n)(r=l[n])&&(r.fill=ln(l,n,s),r.boundary=sn(r),r.mapper=un(r))},beforeDatasetDraw:function(t,e){var i=e.meta.$filler;if(i){var n=t.ctx,a=i.el,r=a._view,o=a._children||[],s=i.mapper,l=r.backgroundColor||ot.global.defaultColor;s&&l&&o.length&&(ut.canvas.clipArea(n,t.chartArea),function(t,e,i,n,a,r){var o,s,l,u,d,h,c,f=e.length,g=n.spanGaps,m=[],p=[],v=0,y=0;for(t.beginPath(),o=0,s=f+!!r;o<s;++o)d=i(u=e[l=o%f]._view,l,n),h=dn(u),c=dn(d),h&&c?(v=m.push(u),y=p.push(d)):v&&y&&(g?(h&&m.push(u),c&&p.push(d)):(hn(t,m,p,v,y),v=y=0,m=[],p=[]));hn(t,m,p,v,y),t.closePath(),t.fillStyle=a,t.fill()}(n,o,s,r,l,a._loop),ut.canvas.unclipArea(n))}}},fn=ut.noop,gn=ut.valueOrDefault;function mn(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}ot._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(t,e){var i=e.datasetIndex,n=this.chart,a=n.getDatasetMeta(i);a.hidden=null===a.hidden?!n.data.datasets[i].hidden:null,n.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(t){var e=t.data;return ut.isArray(e.datasets)?e.datasets.map(function(e,i){return{text:e.label,fillStyle:ut.isArray(e.backgroundColor)?e.backgroundColor[0]:e.backgroundColor,hidden:!t.isDatasetVisible(i),lineCap:e.borderCapStyle,lineDash:e.borderDash,lineDashOffset:e.borderDashOffset,lineJoin:e.borderJoinStyle,lineWidth:e.borderWidth,strokeStyle:e.borderColor,pointStyle:e.pointStyle,datasetIndex:i}},this):[]}}},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var i=0;i<t.data.datasets.length;i++)e.push('<li><span style="background-color:'+t.data.datasets[i].backgroundColor+'"></span>'),t.data.datasets[i].label&&e.push(t.data.datasets[i].label),e.push("</li>");return e.push("</ul>"),e.join("")}});var pn=gt.extend({initialize:function(t){ut.extend(this,t),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:fn,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:fn,beforeSetDimensions:fn,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:fn,beforeBuildLabels:fn,buildLabels:function(){var t=this,e=t.options.labels||{},i=ut.callback(e.generateLabels,[t.chart],t)||[];e.filter&&(i=i.filter(function(i){return e.filter(i,t.chart.data)})),t.options.reverse&&i.reverse(),t.legendItems=i},afterBuildLabels:fn,beforeFit:fn,fit:function(){var t=this,e=t.options,i=e.labels,n=e.display,a=t.ctx,r=ut.options._parseFont(i),o=r.size,s=t.legendHitBoxes=[],l=t.minSize,u=t.isHorizontal();if(u?(l.width=t.maxWidth,l.height=n?10:0):(l.width=n?10:0,l.height=t.maxHeight),n)if(a.font=r.string,u){var d=t.lineWidths=[0],h=0;a.textAlign="left",a.textBaseline="top",ut.each(t.legendItems,function(t,e){var n=mn(i,o)+o/2+a.measureText(t.text).width;(0===e||d[d.length-1]+n+i.padding>l.width)&&(h+=o+i.padding,d[d.length-(e>0?0:1)]=i.padding),s[e]={left:0,top:0,width:n,height:o},d[d.length-1]+=n+i.padding}),l.height+=h}else{var c=i.padding,f=t.columnWidths=[],g=i.padding,m=0,p=0,v=o+c;ut.each(t.legendItems,function(t,e){var n=mn(i,o)+o/2+a.measureText(t.text).width;e>0&&p+v>l.height-c&&(g+=m+i.padding,f.push(m),m=0,p=0),m=Math.max(m,n),p+=v,s[e]={left:0,top:0,width:n,height:o}}),g+=m,f.push(m),l.width+=g}t.width=l.width,t.height=l.height},afterFit:fn,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var t=this,e=t.options,i=e.labels,n=ot.global,a=n.defaultColor,r=n.elements.line,o=t.width,s=t.lineWidths;if(e.display){var l,u=t.ctx,d=gn(i.fontColor,n.defaultFontColor),h=ut.options._parseFont(i),c=h.size;u.textAlign="left",u.textBaseline="middle",u.lineWidth=.5,u.strokeStyle=d,u.fillStyle=d,u.font=h.string;var f=mn(i,c),g=t.legendHitBoxes,m=t.isHorizontal();l=m?{x:t.left+(o-s[0])/2+i.padding,y:t.top+i.padding,line:0}:{x:t.left+i.padding,y:t.top+i.padding,line:0};var p=c+i.padding;ut.each(t.legendItems,function(n,d){var h=u.measureText(n.text).width,v=f+c/2+h,y=l.x,b=l.y;m?d>0&&y+v+i.padding>t.left+t.minSize.width&&(b=l.y+=p,l.line++,y=l.x=t.left+(o-s[l.line])/2+i.padding):d>0&&b+p>t.top+t.minSize.height&&(y=l.x=y+t.columnWidths[l.line]+i.padding,b=l.y=t.top+i.padding,l.line++),function(t,i,n){if(!(isNaN(f)||f<=0)){u.save();var o=gn(n.lineWidth,r.borderWidth);if(u.fillStyle=gn(n.fillStyle,a),u.lineCap=gn(n.lineCap,r.borderCapStyle),u.lineDashOffset=gn(n.lineDashOffset,r.borderDashOffset),u.lineJoin=gn(n.lineJoin,r.borderJoinStyle),u.lineWidth=o,u.strokeStyle=gn(n.strokeStyle,a),u.setLineDash&&u.setLineDash(gn(n.lineDash,r.borderDash)),e.labels&&e.labels.usePointStyle){var s=f*Math.SQRT2/2,l=t+f/2,d=i+c/2;ut.canvas.drawPoint(u,n.pointStyle,s,l,d)}else 0!==o&&u.strokeRect(t,i,f,c),u.fillRect(t,i,f,c);u.restore()}}(y,b,n),g[d].left=y,g[d].top=b,function(t,e,i,n){var a=c/2,r=f+a+t,o=e+a;u.fillText(i.text,r,o),i.hidden&&(u.beginPath(),u.lineWidth=2,u.moveTo(r,o),u.lineTo(r+n,o),u.stroke())}(y,b,n,h),m?l.x+=v+i.padding:l.y+=p})}},_getLegendItemAt:function(t,e){var i,n,a,r=this;if(t>=r.left&&t<=r.right&&e>=r.top&&e<=r.bottom)for(a=r.legendHitBoxes,i=0;i<a.length;++i)if(t>=(n=a[i]).left&&t<=n.left+n.width&&e>=n.top&&e<=n.top+n.height)return r.legendItems[i];return null},handleEvent:function(t){var e,i=this,n=i.options,a="mouseup"===t.type?"click":t.type;if("mousemove"===a){if(!n.onHover&&!n.onLeave)return}else{if("click"!==a)return;if(!n.onClick)return}e=i._getLegendItemAt(t.x,t.y),"click"===a?e&&n.onClick&&n.onClick.call(i,t.native,e):(n.onLeave&&e!==i._hoveredItem&&(i._hoveredItem&&n.onLeave.call(i,t.native,i._hoveredItem),i._hoveredItem=e),n.onHover&&e&&n.onHover.call(i,t.native,e))}});function vn(t,e){var i=new pn({ctx:t.ctx,options:e,chart:t});xe.configure(t,i,e),xe.addBox(t,i),t.legend=i}var yn={id:"legend",_element:pn,beforeInit:function(t){var e=t.options.legend;e&&vn(t,e)},beforeUpdate:function(t){var e=t.options.legend,i=t.legend;e?(ut.mergeIf(e,ot.global.legend),i?(xe.configure(t,i,e),i.options=e):vn(t,e)):i&&(xe.removeBox(t,i),delete t.legend)},afterEvent:function(t,e){var i=t.legend;i&&i.handleEvent(e)}},bn=ut.noop;ot._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var xn=gt.extend({initialize:function(t){ut.extend(this,t),this.legendHitBoxes=[]},beforeUpdate:bn,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:bn,beforeSetDimensions:bn,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:bn,beforeBuildLabels:bn,buildLabels:bn,afterBuildLabels:bn,beforeFit:bn,fit:function(){var t=this,e=t.options,i=e.display,n=t.minSize,a=ut.isArray(e.text)?e.text.length:1,r=ut.options._parseFont(e),o=i?a*r.lineHeight+2*e.padding:0;t.isHorizontal()?(n.width=t.maxWidth,n.height=o):(n.width=o,n.height=t.maxHeight),t.width=n.width,t.height=n.height},afterFit:bn,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var t=this,e=t.ctx,i=t.options;if(i.display){var n,a,r,o=ut.options._parseFont(i),s=o.lineHeight,l=s/2+i.padding,u=0,d=t.top,h=t.left,c=t.bottom,f=t.right;e.fillStyle=ut.valueOrDefault(i.fontColor,ot.global.defaultFontColor),e.font=o.string,t.isHorizontal()?(a=h+(f-h)/2,r=d+l,n=f-h):(a="left"===i.position?h+l:f-l,r=d+(c-d)/2,n=c-d,u=Math.PI*("left"===i.position?-.5:.5)),e.save(),e.translate(a,r),e.rotate(u),e.textAlign="center",e.textBaseline="middle";var g=i.text;if(ut.isArray(g))for(var m=0,p=0;p<g.length;++p)e.fillText(g[p],0,m,n),m+=s;else e.fillText(g,0,0,n);e.restore()}}});function _n(t,e){var i=new xn({ctx:t.ctx,options:e,chart:t});xe.configure(t,i,e),xe.addBox(t,i),t.titleBlock=i}var kn={},wn=cn,Mn=yn,Sn={id:"title",_element:xn,beforeInit:function(t){var e=t.options.title;e&&_n(t,e)},beforeUpdate:function(t){var e=t.options.title,i=t.titleBlock;e?(ut.mergeIf(e,ot.global.title),i?(xe.configure(t,i,e),i.options=e):_n(t,e)):i&&(xe.removeBox(t,i),delete t.titleBlock)}};for(var Dn in kn.filler=wn,kn.legend=Mn,kn.title=Sn,ai.helpers=ut,function(){function t(t,e,i){var n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}function e(t){return null!=t&&"none"!==t}function i(i,n,a){var r=document.defaultView,o=ut._getParentNode(i),s=r.getComputedStyle(i)[n],l=r.getComputedStyle(o)[n],u=e(s),d=e(l),h=Number.POSITIVE_INFINITY;return u||d?Math.min(u?t(s,i,a):h,d?t(l,o,a):h):"none"}ut.where=function(t,e){if(ut.isArray(t)&&Array.prototype.filter)return t.filter(e);var i=[];return ut.each(t,function(t){e(t)&&i.push(t)}),i},ut.findIndex=Array.prototype.findIndex?function(t,e,i){return t.findIndex(e,i)}:function(t,e,i){i=void 0===i?t:i;for(var n=0,a=t.length;n<a;++n)if(e.call(i,t[n],n,t))return n;return-1},ut.findNextWhere=function(t,e,i){ut.isNullOrUndef(i)&&(i=-1);for(var n=i+1;n<t.length;n++){var a=t[n];if(e(a))return a}},ut.findPreviousWhere=function(t,e,i){ut.isNullOrUndef(i)&&(i=t.length);for(var n=i-1;n>=0;n--){var a=t[n];if(e(a))return a}},ut.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},ut.almostEquals=function(t,e,i){return Math.abs(t-e)<i},ut.almostWhole=function(t,e){var i=Math.round(t);return i-e<t&&i+e>t},ut.max=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.max(t,e)},Number.NEGATIVE_INFINITY)},ut.min=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.min(t,e)},Number.POSITIVE_INFINITY)},ut.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1},ut.log10=Math.log10?function(t){return Math.log10(t)}:function(t){var e=Math.log(t)*Math.LOG10E,i=Math.round(e);return t===Math.pow(10,i)?i:e},ut.toRadians=function(t){return t*(Math.PI/180)},ut.toDegrees=function(t){return t*(180/Math.PI)},ut._decimalPlaces=function(t){if(ut.isFinite(t)){for(var e=1,i=0;Math.round(t*e)/e!==t;)e*=10,i++;return i}},ut.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,a=Math.sqrt(i*i+n*n),r=Math.atan2(n,i);return r<-.5*Math.PI&&(r+=2*Math.PI),{angle:r,distance:a}},ut.distanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},ut.aliasPixel=function(t){return t%2==0?0:.5},ut._alignPixel=function(t,e,i){var n=t.currentDevicePixelRatio,a=i/2;return Math.round((e-a)*n)/n+a},ut.splineCurve=function(t,e,i,n){var a=t.skip?e:t,r=e,o=i.skip?e:i,s=Math.sqrt(Math.pow(r.x-a.x,2)+Math.pow(r.y-a.y,2)),l=Math.sqrt(Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)),u=s/(s+l),d=l/(s+l),h=n*(u=isNaN(u)?0:u),c=n*(d=isNaN(d)?0:d);return{previous:{x:r.x-h*(o.x-a.x),y:r.y-h*(o.y-a.y)},next:{x:r.x+c*(o.x-a.x),y:r.y+c*(o.y-a.y)}}},ut.EPSILON=Number.EPSILON||1e-14,ut.splineCurveMonotone=function(t){var e,i,n,a,r,o,s,l,u,d=(t||[]).map(function(t){return{model:t._model,deltaK:0,mK:0}}),h=d.length;for(e=0;e<h;++e)if(!(n=d[e]).model.skip){if(i=e>0?d[e-1]:null,(a=e<h-1?d[e+1]:null)&&!a.model.skip){var c=a.model.x-n.model.x;n.deltaK=0!==c?(a.model.y-n.model.y)/c:0}!i||i.model.skip?n.mK=n.deltaK:!a||a.model.skip?n.mK=i.deltaK:this.sign(i.deltaK)!==this.sign(n.deltaK)?n.mK=0:n.mK=(i.deltaK+n.deltaK)/2}for(e=0;e<h-1;++e)n=d[e],a=d[e+1],n.model.skip||a.model.skip||(ut.almostEquals(n.deltaK,0,this.EPSILON)?n.mK=a.mK=0:(r=n.mK/n.deltaK,o=a.mK/n.deltaK,(l=Math.pow(r,2)+Math.pow(o,2))<=9||(s=3/Math.sqrt(l),n.mK=r*s*n.deltaK,a.mK=o*s*n.deltaK)));for(e=0;e<h;++e)(n=d[e]).model.skip||(i=e>0?d[e-1]:null,a=e<h-1?d[e+1]:null,i&&!i.model.skip&&(u=(n.model.x-i.model.x)/3,n.model.controlPointPreviousX=n.model.x-u,n.model.controlPointPreviousY=n.model.y-u*n.mK),a&&!a.model.skip&&(u=(a.model.x-n.model.x)/3,n.model.controlPointNextX=n.model.x+u,n.model.controlPointNextY=n.model.y+u*n.mK))},ut.nextItem=function(t,e,i){return i?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},ut.previousItem=function(t,e,i){return i?e<=0?t[t.length-1]:t[e-1]:e<=0?t[0]:t[e-1]},ut.niceNum=function(t,e){var i=Math.floor(ut.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},ut.requestAnimFrame="undefined"==typeof window?function(t){t()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},ut.getRelativePosition=function(t,e){var i,n,a=t.originalEvent||t,r=t.target||t.srcElement,o=r.getBoundingClientRect(),s=a.touches;s&&s.length>0?(i=s[0].clientX,n=s[0].clientY):(i=a.clientX,n=a.clientY);var l=parseFloat(ut.getStyle(r,"padding-left")),u=parseFloat(ut.getStyle(r,"padding-top")),d=parseFloat(ut.getStyle(r,"padding-right")),h=parseFloat(ut.getStyle(r,"padding-bottom")),c=o.right-o.left-l-d,f=o.bottom-o.top-u-h;return{x:i=Math.round((i-o.left-l)/c*r.width/e.currentDevicePixelRatio),y:n=Math.round((n-o.top-u)/f*r.height/e.currentDevicePixelRatio)}},ut.getConstraintWidth=function(t){return i(t,"max-width","clientWidth")},ut.getConstraintHeight=function(t){return i(t,"max-height","clientHeight")},ut._calculatePadding=function(t,e,i){return(e=ut.getStyle(t,e)).indexOf("%")>-1?i*parseInt(e,10)/100:parseInt(e,10)},ut._getParentNode=function(t){var e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e},ut.getMaximumWidth=function(t){var e=ut._getParentNode(t);if(!e)return t.clientWidth;var i=e.clientWidth,n=i-ut._calculatePadding(e,"padding-left",i)-ut._calculatePadding(e,"padding-right",i),a=ut.getConstraintWidth(t);return isNaN(a)?n:Math.min(n,a)},ut.getMaximumHeight=function(t){var e=ut._getParentNode(t);if(!e)return t.clientHeight;var i=e.clientHeight,n=i-ut._calculatePadding(e,"padding-top",i)-ut._calculatePadding(e,"padding-bottom",i),a=ut.getConstraintHeight(t);return isNaN(a)?n:Math.min(n,a)},ut.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},ut.retinaScale=function(t,e){var i=t.currentDevicePixelRatio=e||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==i){var n=t.canvas,a=t.height,r=t.width;n.height=a*i,n.width=r*i,t.ctx.scale(i,i),n.style.height||n.style.width||(n.style.height=a+"px",n.style.width=r+"px")}},ut.fontString=function(t,e,i){return e+" "+t+"px "+i},ut.longestText=function(t,e,i,n){var a=(n=n||{}).data=n.data||{},r=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(a=n.data={},r=n.garbageCollect=[],n.font=e),t.font=e;var o=0;ut.each(i,function(e){null!=e&&!0!==ut.isArray(e)?o=ut.measureText(t,a,r,o,e):ut.isArray(e)&&ut.each(e,function(e){null==e||ut.isArray(e)||(o=ut.measureText(t,a,r,o,e))})});var s=r.length/2;if(s>i.length){for(var l=0;l<s;l++)delete a[r[l]];r.splice(0,s)}return o},ut.measureText=function(t,e,i,n,a){var r=e[a];return r||(r=e[a]=t.measureText(a).width,i.push(a)),r>n&&(n=r),n},ut.numberOfLabelLines=function(t){var e=1;return ut.each(t,function(t){ut.isArray(t)&&t.length>e&&(e=t.length)}),e},ut.color=G?function(t){return t instanceof CanvasGradient&&(t=ot.global.defaultColor),G(t)}:function(t){return console.error("Color.js not found!"),t},ut.getHoverColor=function(t){return t instanceof CanvasPattern||t instanceof CanvasGradient?t:ut.color(t).saturate(.5).darken(.1).rgbString()}}(),ai._adapters=si,ai.Animation=pt,ai.animationService=vt,ai.controllers=ue,ai.DatasetController=kt,ai.defaults=ot,ai.Element=gt,ai.elements=Nt,ai.Interaction=pe,ai.layouts=xe,ai.platform=Ve,ai.plugins=He,ai.Scale=fi,ai.scaleService=Ee,ai.Ticks=li,ai.Tooltip=Je,ai.helpers.each(en,function(t,e){ai.scaleService.registerScaleType(e,t,t._defaults)}),kn)kn.hasOwnProperty(Dn)&&ai.plugins.register(kn[Dn]);ai.platform.initialize();var Cn=ai;return"undefined"!=typeof window&&(window.Chart=ai),ai.Chart=ai,ai.Legend=kn.legend._element,ai.Title=kn.title._element,ai.pluginService=ai.plugins,ai.PluginBase=ai.Element.extend({}),ai.canvasHelpers=ai.helpers.canvas,ai.layoutService=ai.layouts,ai.LinearScaleBase=yi,ai.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(t){ai[t]=function(e,i){return new ai(e,ai.helpers.merge(i||{},{type:t.charAt(0).toLowerCase()+t.slice(1)}))}}),Cn});;

/* /base_accounting_kit/static/lib/Chart.min.js defined in bundle 'web.assets_backend' */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(function(){try{return require("moment")}catch(t){}}()):"function"==typeof define&&define.amd?define(["require"],function(t){return e(function(){try{return t("moment")}catch(t){}}())}):t.Chart=e(t.moment)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e={rgb2hsl:i,rgb2hsv:n,rgb2hwb:a,rgb2cmyk:o,rgb2keyword:s,rgb2xyz:l,rgb2lab:d,rgb2lch:function(t){return x(d(t))},hsl2rgb:u,hsl2hsv:function(t){var e=t[0],i=t[1]/100,n=t[2]/100;if(0===n)return[0,0,0];return[e,100*(2*(i*=(n*=2)<=1?n:2-n)/(n+i)),100*((n+i)/2)]},hsl2hwb:function(t){return a(u(t))},hsl2cmyk:function(t){return o(u(t))},hsl2keyword:function(t){return s(u(t))},hsv2rgb:h,hsv2hsl:function(t){var e,i,n=t[0],a=t[1]/100,o=t[2]/100;return e=a*o,[n,100*(e=(e/=(i=(2-a)*o)<=1?i:2-i)||0),100*(i/=2)]},hsv2hwb:function(t){return a(h(t))},hsv2cmyk:function(t){return o(h(t))},hsv2keyword:function(t){return s(h(t))},hwb2rgb:c,hwb2hsl:function(t){return i(c(t))},hwb2hsv:function(t){return n(c(t))},hwb2cmyk:function(t){return o(c(t))},hwb2keyword:function(t){return s(c(t))},cmyk2rgb:f,cmyk2hsl:function(t){return i(f(t))},cmyk2hsv:function(t){return n(f(t))},cmyk2hwb:function(t){return a(f(t))},cmyk2keyword:function(t){return s(f(t))},keyword2rgb:w,keyword2hsl:function(t){return i(w(t))},keyword2hsv:function(t){return n(w(t))},keyword2hwb:function(t){return a(w(t))},keyword2cmyk:function(t){return o(w(t))},keyword2lab:function(t){return d(w(t))},keyword2xyz:function(t){return l(w(t))},xyz2rgb:p,xyz2lab:m,xyz2lch:function(t){return x(m(t))},lab2xyz:v,lab2rgb:y,lab2lch:x,lch2lab:k,lch2xyz:function(t){return v(k(t))},lch2rgb:function(t){return y(k(t))}};function i(t){var e,i,n=t[0]/255,a=t[1]/255,o=t[2]/255,r=Math.min(n,a,o),s=Math.max(n,a,o),l=s-r;return s==r?e=0:n==s?e=(a-o)/l:a==s?e=2+(o-n)/l:o==s&&(e=4+(n-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(r+s)/2,[e,100*(s==r?0:i<=.5?l/(s+r):l/(2-s-r)),100*i]}function n(t){var e,i,n=t[0],a=t[1],o=t[2],r=Math.min(n,a,o),s=Math.max(n,a,o),l=s-r;return i=0==s?0:l/s*1e3/10,s==r?e=0:n==s?e=(a-o)/l:a==s?e=2+(o-n)/l:o==s&&(e=4+(n-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),[e,i,s/255*1e3/10]}function a(t){var e=t[0],n=t[1],a=t[2];return[i(t)[0],100*(1/255*Math.min(e,Math.min(n,a))),100*(a=1-1/255*Math.max(e,Math.max(n,a)))]}function o(t){var e,i=t[0]/255,n=t[1]/255,a=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-n,1-a)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-a-e)/(1-e)||0),100*e]}function s(t){return _[JSON.stringify(t)]}function l(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*i+.0722*n),100*(.0193*e+.1192*i+.9505*n)]}function d(t){var e=l(t),i=e[0],n=e[1],a=e[2];return n/=100,a/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(i-n),200*(n-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]}function u(t){var e,i,n,a,o,r=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[o=255*l,o,o];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),a=[0,0,0];for(var d=0;d<3;d++)(n=r+1/3*-(d-1))<0&&n++,n>1&&n--,o=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,a[d]=255*o;return a}function h(t){var e=t[0]/60,i=t[1]/100,n=t[2]/100,a=Math.floor(e)%6,o=e-Math.floor(e),r=255*n*(1-i),s=255*n*(1-i*o),l=255*n*(1-i*(1-o));n*=255;switch(a){case 0:return[n,l,r];case 1:return[s,n,r];case 2:return[r,n,l];case 3:return[r,s,n];case 4:return[l,r,n];case 5:return[n,r,s]}}function c(t){var e,i,n,a,o=t[0]/360,s=t[1]/100,l=t[2]/100,d=s+l;switch(d>1&&(s/=d,l/=d),n=6*o-(e=Math.floor(6*o)),0!=(1&e)&&(n=1-n),a=s+n*((i=1-l)-s),e){default:case 6:case 0:r=i,g=a,b=s;break;case 1:r=a,g=i,b=s;break;case 2:r=s,g=i,b=a;break;case 3:r=s,g=a,b=i;break;case 4:r=a,g=s,b=i;break;case 5:r=i,g=s,b=a}return[255*r,255*g,255*b]}function f(t){var e=t[0]/100,i=t[1]/100,n=t[2]/100,a=t[3]/100;return[255*(1-Math.min(1,e*(1-a)+a)),255*(1-Math.min(1,i*(1-a)+a)),255*(1-Math.min(1,n*(1-a)+a))]}function p(t){var e,i,n,a=t[0]/100,o=t[1]/100,r=t[2]/100;return i=-.9689*a+1.8758*o+.0415*r,n=.0557*a+-.204*o+1.057*r,e=(e=3.2406*a+-1.5372*o+-.4986*r)>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1))]}function m(t){var e=t[0],i=t[1],n=t[2];return i/=100,n/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]}function v(t){var e,i,n,a,o=t[0],r=t[1],s=t[2];return o<=8?a=(i=100*o/903.3)/100*7.787+16/116:(i=100*Math.pow((o+16)/116,3),a=Math.pow(i/100,1/3)),[e=e/95.047<=.008856?e=95.047*(r/500+a-16/116)/7.787:95.047*Math.pow(r/500+a,3),i,n=n/108.883<=.008859?n=108.883*(a-s/200-16/116)/7.787:108.883*Math.pow(a-s/200,3)]}function x(t){var e,i=t[0],n=t[1],a=t[2];return(e=360*Math.atan2(a,n)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(n*n+a*a),e]}function y(t){return p(v(t))}function k(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]}function w(t){return M[t]}var M={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},_={};for(var C in M)_[JSON.stringify(M[C])]=C;var S=function(){return new T};for(var P in e){S[P+"Raw"]=function(t){return function(i){return"number"==typeof i&&(i=Array.prototype.slice.call(arguments)),e[t](i)}}(P);var I=/(\w+)2(\w+)/.exec(P),A=I[1],D=I[2];(S[A]=S[A]||{})[D]=S[P]=function(t){return function(i){"number"==typeof i&&(i=Array.prototype.slice.call(arguments));var n=e[t](i);if("string"==typeof n||void 0===n)return n;for(var a=0;a<n.length;a++)n[a]=Math.round(n[a]);return n}}(P)}var T=function(){this.convs={}};T.prototype.routeSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i))},T.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},T.prototype.getValues=function(t){var e=this.convs[t];if(!e){var i=this.space,n=this.convs[i];e=S[i][t](n),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(t){T.prototype[t]=function(e){return this.routeSpace(t,arguments)}});var F=S,L={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},R={getRgba:O,getHsla:z,getRgb:function(t){var e=O(t);return e&&e.slice(0,3)},getHsl:function(t){var e=z(t);return e&&e.slice(0,3)},getHwb:B,getAlpha:function(t){var e=O(t);if(e)return e[3];if(e=z(t))return e[3];if(e=B(t))return e[3]},hexString:function(t,e){var e=void 0!==e&&3===t.length?e:t[3];return"#"+H(t[0])+H(t[1])+H(t[2])+(e>=0&&e<1?H(Math.round(255*e)):"")},rgbString:function(t,e){if(e<1||t[3]&&t[3]<1)return N(t,e);return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},rgbaString:N,percentString:function(t,e){if(e<1||t[3]&&t[3]<1)return W(t,e);var i=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),a=Math.round(t[2]/255*100);return"rgb("+i+"%, "+n+"%, "+a+"%)"},percentaString:W,hslString:function(t,e){if(e<1||t[3]&&t[3]<1)return V(t,e);return"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"},hslaString:V,hwbString:function(t,e){void 0===e&&(e=void 0!==t[3]?t[3]:1);return"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"},keyword:function(t){return j[t.slice(0,3)]}};function O(t){if(t){var e=[0,0,0],i=1,n=t.match(/^#([a-fA-F0-9]{3,4})$/i),a="";if(n){a=(n=n[1])[3];for(var o=0;o<e.length;o++)e[o]=parseInt(n[o]+n[o],16);a&&(i=Math.round(parseInt(a+a,16)/255*100)/100)}else if(n=t.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){a=n[2],n=n[1];for(o=0;o<e.length;o++)e[o]=parseInt(n.slice(2*o,2*o+2),16);a&&(i=Math.round(parseInt(a,16)/255*100)/100)}else if(n=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(o=0;o<e.length;o++)e[o]=parseInt(n[o+1]);i=parseFloat(n[4])}else if(n=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(o=0;o<e.length;o++)e[o]=Math.round(2.55*parseFloat(n[o+1]));i=parseFloat(n[4])}else if(n=t.match(/(\w+)/)){if("transparent"==n[1])return[0,0,0,0];if(!(e=L[n[1]]))return}for(o=0;o<e.length;o++)e[o]=E(e[o],0,255);return i=i||0==i?E(i,0,1):1,e[3]=i,e}}function z(t){if(t){var e=t.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[E(parseInt(e[1]),0,360),E(parseFloat(e[2]),0,100),E(parseFloat(e[3]),0,100),E(isNaN(i)?1:i,0,1)]}}}function B(t){if(t){var e=t.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[E(parseInt(e[1]),0,360),E(parseFloat(e[2]),0,100),E(parseFloat(e[3]),0,100),E(isNaN(i)?1:i,0,1)]}}}function N(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function W(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function V(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function E(t,e,i){return Math.min(Math.max(e,t),i)}function H(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var j={};for(var q in L)j[L[q]]=q;var Y=function(t){return t instanceof Y?t:this instanceof Y?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof t?(e=R.getRgba(t))?this.setValues("rgb",e):(e=R.getHsla(t))?this.setValues("hsl",e):(e=R.getHwb(t))&&this.setValues("hwb",e):"object"==typeof t&&(void 0!==(e=t).r||void 0!==e.red?this.setValues("rgb",e):void 0!==e.l||void 0!==e.lightness?this.setValues("hsl",e):void 0!==e.v||void 0!==e.value?this.setValues("hsv",e):void 0!==e.w||void 0!==e.whiteness?this.setValues("hwb",e):void 0===e.c&&void 0===e.cyan||this.setValues("cmyk",e)))):new Y(t);var e};Y.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t=(t%=360)<0?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return R.hexString(this.values.rgb)},rgbString:function(){return R.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return R.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return R.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return R.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return R.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return R.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return R.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],i=0;i<t.length;i++){var n=t[i]/255;e[i]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;e<3;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,i=(e[0]+t)%360;return e[0]=i<0?360+i:i,this.setValues("hsl",e),this},mix:function(t,e){var i=t,n=void 0===e?.5:e,a=2*n-1,o=this.alpha()-i.alpha(),r=((a*o==-1?a:(a+o)/(1+a*o))+1)/2,s=1-r;return this.rgb(r*this.red()+s*i.red(),r*this.green()+s*i.green(),r*this.blue()+s*i.blue()).alpha(this.alpha()*n+i.alpha()*(1-n))},toJSON:function(){return this.rgb()},clone:function(){var t,e,i=new Y,n=this.values,a=i.values;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],"[object Array]"===(e={}.toString.call(t))?a[o]=t.slice(0):"[object Number]"===e?a[o]=t:console.error("unexpected color value:",t));return i}},Y.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},Y.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},Y.prototype.getValues=function(t){for(var e=this.values,i={},n=0;n<t.length;n++)i[t.charAt(n)]=e[t][n];return 1!==e.alpha&&(i.a=e.alpha),i},Y.prototype.setValues=function(t,e){var i,n,a=this.values,o=this.spaces,r=this.maxes,s=1;if(this.valid=!0,"alpha"===t)s=e;else if(e.length)a[t]=e.slice(0,t.length),s=e[t.length];else if(void 0!==e[t.charAt(0)]){for(i=0;i<t.length;i++)a[t][i]=e[t.charAt(i)];s=e.a}else if(void 0!==e[o[t][0]]){var l=o[t];for(i=0;i<t.length;i++)a[t][i]=e[l[i]];s=e.alpha}if(a.alpha=Math.max(0,Math.min(1,void 0===s?a.alpha:s)),"alpha"===t)return!1;for(i=0;i<t.length;i++)n=Math.max(0,Math.min(r[t][i],a[t][i])),a[t][i]=Math.round(n);for(var d in o)d!==t&&(a[d]=F[t][d](a[t]));return!0},Y.prototype.setSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i),this)},Y.prototype.setChannel=function(t,e,i){var n=this.values[t];return void 0===i?n[e]:i===n[e]?this:(n[e]=i,this.setValues(t,n),this)},"undefined"!=typeof window&&(window.Color=Y);var U,X=Y,K={noop:function(){},uid:(U=0,function(){return U++}),isNullOrUndef:function(t){return null==t},isArray:function(t){if(Array.isArray&&Array.isArray(t))return!0;var e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)},isObject:function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},isFinite:function(t){return("number"==typeof t||t instanceof Number)&&isFinite(t)},valueOrDefault:function(t,e){return void 0===t?e:t},valueAtIndexOrDefault:function(t,e,i){return K.valueOrDefault(K.isArray(t)?t[e]:t,i)},callback:function(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)},each:function(t,e,i,n){var a,o,r;if(K.isArray(t))if(o=t.length,n)for(a=o-1;a>=0;a--)e.call(i,t[a],a);else for(a=0;a<o;a++)e.call(i,t[a],a);else if(K.isObject(t))for(o=(r=Object.keys(t)).length,a=0;a<o;a++)e.call(i,t[r[a]],r[a])},arrayEquals:function(t,e){var i,n,a,o;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(a=t[i],o=e[i],a instanceof Array&&o instanceof Array){if(!K.arrayEquals(a,o))return!1}else if(a!==o)return!1;return!0},clone:function(t){if(K.isArray(t))return t.map(K.clone);if(K.isObject(t)){for(var e={},i=Object.keys(t),n=i.length,a=0;a<n;++a)e[i[a]]=K.clone(t[i[a]]);return e}return t},_merger:function(t,e,i,n){var a=e[t],o=i[t];K.isObject(a)&&K.isObject(o)?K.merge(a,o,n):e[t]=K.clone(o)},_mergerIf:function(t,e,i){var n=e[t],a=i[t];K.isObject(n)&&K.isObject(a)?K.mergeIf(n,a):e.hasOwnProperty(t)||(e[t]=K.clone(a))},merge:function(t,e,i){var n,a,o,r,s,l=K.isArray(e)?e:[e],d=l.length;if(!K.isObject(t))return t;for(n=(i=i||{}).merger||K._merger,a=0;a<d;++a)if(e=l[a],K.isObject(e))for(s=0,r=(o=Object.keys(e)).length;s<r;++s)n(o[s],t,e,i);return t},mergeIf:function(t,e){return K.merge(t,e,{merger:K._mergerIf})},extend:function(t){for(var e=function(e,i){t[i]=e},i=1,n=arguments.length;i<n;++i)K.each(arguments[i],e);return t},inherits:function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=K.inherits,t&&K.extend(i.prototype,t),i.__super__=e.prototype,i}},G=K;K.callCallback=K.callback,K.indexOf=function(t,e,i){return Array.prototype.indexOf.call(t,e,i)},K.getValueOrDefault=K.valueOrDefault,K.getValueAtIndexOrDefault=K.valueAtIndexOrDefault;var Z={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.45),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-Z.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*Z.easeInBounce(2*t):.5*Z.easeOutBounce(2*t-1)+.5}},$={effects:Z};G.easingEffects=Z;var J=Math.PI,Q=J/180,tt=2*J,et=J/2,it=J/4,nt=2*J/3,at={clear:function(t){t.ctx.clearRect(0,0,t.width,t.height)},roundedRect:function(t,e,i,n,a,o){if(o){var r=Math.min(o,a/2,n/2),s=e+r,l=i+r,d=e+n-r,u=i+a-r;t.moveTo(e,l),s<d&&l<u?(t.arc(s,l,r,-J,-et),t.arc(d,l,r,-et,0),t.arc(d,u,r,0,et),t.arc(s,u,r,et,J)):s<d?(t.moveTo(s,i),t.arc(d,l,r,-et,et),t.arc(s,l,r,et,J+et)):l<u?(t.arc(s,l,r,-J,0),t.arc(s,u,r,0,J)):t.arc(s,l,r,-J,J),t.closePath(),t.moveTo(e,i)}else t.rect(e,i,n,a)},drawPoint:function(t,e,i,n,a,o){var r,s,l,d,u,h=(o||0)*Q;if(!e||"object"!=typeof e||"[object HTMLImageElement]"!==(r=e.toString())&&"[object HTMLCanvasElement]"!==r){if(!(isNaN(i)||i<=0)){switch(t.beginPath(),e){default:t.arc(n,a,i,0,tt),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(h)*i,a-Math.cos(h)*i),h+=nt,t.lineTo(n+Math.sin(h)*i,a-Math.cos(h)*i),h+=nt,t.lineTo(n+Math.sin(h)*i,a-Math.cos(h)*i),t.closePath();break;case"rectRounded":d=i-(u=.516*i),s=Math.cos(h+it)*d,l=Math.sin(h+it)*d,t.arc(n-s,a-l,u,h-J,h-et),t.arc(n+l,a-s,u,h-et,h),t.arc(n+s,a+l,u,h,h+et),t.arc(n-l,a+s,u,h+et,h+J),t.closePath();break;case"rect":if(!o){d=Math.SQRT1_2*i,t.rect(n-d,a-d,2*d,2*d);break}h+=it;case"rectRot":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+l,a-s),t.lineTo(n+s,a+l),t.lineTo(n-l,a+s),t.closePath();break;case"crossRot":h+=it;case"cross":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l),t.moveTo(n+l,a-s),t.lineTo(n-l,a+s);break;case"star":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l),t.moveTo(n+l,a-s),t.lineTo(n-l,a+s),h+=it,s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l),t.moveTo(n+l,a-s),t.lineTo(n-l,a+s);break;case"line":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,a-l),t.lineTo(n+s,a+l);break;case"dash":t.moveTo(n,a),t.lineTo(n+Math.cos(h)*i,a+Math.sin(h)*i)}t.fill(),t.stroke()}}else t.drawImage(e,n-e.width/2,a-e.height/2,e.width,e.height)},_isPointInArea:function(t,e){return t.x>e.left-1e-6&&t.x<e.right+1e-6&&t.y>e.top-1e-6&&t.y<e.bottom+1e-6},clipArea:function(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()},unclipArea:function(t){t.restore()},lineTo:function(t,e,i,n){var a=i.steppedLine;if(a){if("middle"===a){var o=(e.x+i.x)/2;t.lineTo(o,n?i.y:e.y),t.lineTo(o,n?e.y:i.y)}else"after"===a&&!n||"after"!==a&&n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}else i.tension?t.bezierCurveTo(n?e.controlPointPreviousX:e.controlPointNextX,n?e.controlPointPreviousY:e.controlPointNextY,n?i.controlPointNextX:i.controlPointPreviousX,n?i.controlPointNextY:i.controlPointPreviousY,i.x,i.y):t.lineTo(i.x,i.y)}},ot=at;G.clear=at.clear,G.drawRoundedRectangle=function(t){t.beginPath(),at.roundedRect.apply(at,arguments)};var rt={_set:function(t,e){return G.merge(this[t]||(this[t]={}),e)}};rt._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var st=rt,lt=G.valueOrDefault;var dt={toLineHeight:function(t,e){var i=(""+t).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t},toPadding:function(t){var e,i,n,a;return G.isObject(t)?(e=+t.top||0,i=+t.right||0,n=+t.bottom||0,a=+t.left||0):e=i=n=a=+t||0,{top:e,right:i,bottom:n,left:a,height:e+n,width:a+i}},_parseFont:function(t){var e=st.global,i=lt(t.fontSize,e.defaultFontSize),n={family:lt(t.fontFamily,e.defaultFontFamily),lineHeight:G.options.toLineHeight(lt(t.lineHeight,e.defaultLineHeight),i),size:i,style:lt(t.fontStyle,e.defaultFontStyle),weight:null,string:""};return n.string=function(t){return!t||G.isNullOrUndef(t.size)||G.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(n),n},resolve:function(t,e,i){var n,a,o;for(n=0,a=t.length;n<a;++n)if(void 0!==(o=t[n])&&(void 0!==e&&"function"==typeof o&&(o=o(e)),void 0!==i&&G.isArray(o)&&(o=o[i]),void 0!==o))return o}},ut=G,ht=$,ct=ot,ft=dt;ut.easing=ht,ut.canvas=ct,ut.options=ft;var gt=function(t){ut.extend(this,t),this.initialize.apply(this,arguments)};ut.extend(gt.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=ut.clone(t._model)),t._start={},t},transition:function(t){var e=this,i=e._model,n=e._start,a=e._view;return i&&1!==t?(a||(a=e._view={}),n||(n=e._start={}),function(t,e,i,n){var a,o,r,s,l,d,u,h,c,f=Object.keys(i);for(a=0,o=f.length;a<o;++a)if(d=i[r=f[a]],e.hasOwnProperty(r)||(e[r]=d),(s=e[r])!==d&&"_"!==r[0]){if(t.hasOwnProperty(r)||(t[r]=s),(u=typeof d)==typeof(l=t[r]))if("string"===u){if((h=X(l)).valid&&(c=X(d)).valid){e[r]=c.mix(h,n).rgbString();continue}}else if(ut.isFinite(l)&&ut.isFinite(d)){e[r]=l+(d-l)*n;continue}e[r]=d}}(n,a,i,t),e):(e._view=i,e._start=null,e)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return ut.isNumber(this._model.x)&&ut.isNumber(this._model.y)}}),gt.extend=ut.inherits;var pt=gt,mt=pt.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),vt=mt;Object.defineProperty(mt.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(mt.prototype,"chartInstance",{get:function(){return this.chart},set:function(t){this.chart=t}}),st._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:ut.noop,onComplete:ut.noop}});var bt={animations:[],request:null,addAnimation:function(t,e,i,n){var a,o,r=this.animations;for(e.chart=t,e.startTime=Date.now(),e.duration=i,n||(t.animating=!0),a=0,o=r.length;a<o;++a)if(r[a].chart===t)return void(r[a]=e);r.push(e),1===r.length&&this.requestAnimationFrame()},cancelAnimation:function(t){var e=ut.findIndex(this.animations,function(e){return e.chart===t});-1!==e&&(this.animations.splice(e,1),t.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=ut.requestAnimFrame.call(window,function(){t.request=null,t.startDigest()}))},startDigest:function(){this.advance(),this.animations.length>0&&this.requestAnimationFrame()},advance:function(){for(var t,e,i,n,a=this.animations,o=0;o<a.length;)e=(t=a[o]).chart,i=t.numSteps,n=Math.floor((Date.now()-t.startTime)/t.duration*i)+1,t.currentStep=Math.min(n,i),ut.callback(t.render,[e,t],e),ut.callback(t.onAnimationProgress,[t],e),t.currentStep>=i?(ut.callback(t.onAnimationComplete,[t],e),e.animating=!1,a.splice(o,1)):++o}},xt=ut.options.resolve,yt=["push","pop","shift","splice","unshift"];function kt(t,e){var i=t._chartjs;if(i){var n=i.listeners,a=n.indexOf(e);-1!==a&&n.splice(a,1),n.length>0||(yt.forEach(function(e){delete t[e]}),delete t._chartjs)}}var wt=function(t,e){this.initialize(t,e)};ut.extend(wt.prototype,{datasetElementType:null,dataElementType:null,initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){var t=this,e=t.getMeta(),i=t.getDataset();null!==e.xAxisID&&e.xAxisID in t.chart.scales||(e.xAxisID=i.xAxisID||t.chart.options.scales.xAxes[0].id),null!==e.yAxisID&&e.yAxisID in t.chart.scales||(e.yAxisID=i.yAxisID||t.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this.update(!0)},destroy:function(){this._data&&kt(this._data,this)},createMetaDataset:function(){var t=this.datasetElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(t){var e=this.dataElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index,_index:t})},addElements:function(){var t,e,i=this.getMeta(),n=this.getDataset().data||[],a=i.data;for(t=0,e=n.length;t<e;++t)a[t]=a[t]||this.createMetaData(t);i.dataset=i.dataset||this.createMetaDataset()},addElementAndReset:function(t){var e=this.createMetaData(t);this.getMeta().data.splice(t,0,e),this.updateElement(e,t,!0)},buildOrUpdateElements:function(){var t,e,i=this,n=i.getDataset(),a=n.data||(n.data=[]);i._data!==a&&(i._data&&kt(i._data,i),a&&Object.isExtensible(a)&&(e=i,(t=a)._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),yt.forEach(function(e){var i="onData"+e.charAt(0).toUpperCase()+e.slice(1),n=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),a=n.apply(this,e);return ut.each(t._chartjs.listeners,function(t){"function"==typeof t[i]&&t[i].apply(t,e)}),a}})}))),i._data=a),i.resyncElements()},update:ut.noop,transition:function(t){for(var e=this.getMeta(),i=e.data||[],n=i.length,a=0;a<n;++a)i[a].transition(t);e.dataset&&e.dataset.transition(t)},draw:function(){var t=this.getMeta(),e=t.data||[],i=e.length,n=0;for(t.dataset&&t.dataset.draw();n<i;++n)e[n].draw()},removeHoverStyle:function(t){ut.merge(t._model,t.$previousStyle||{}),delete t.$previousStyle},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},a=t._model,o=ut.getHoverColor;t.$previousStyle={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth},a.backgroundColor=xt([n.hoverBackgroundColor,e.hoverBackgroundColor,o(a.backgroundColor)],void 0,i),a.borderColor=xt([n.hoverBorderColor,e.hoverBorderColor,o(a.borderColor)],void 0,i),a.borderWidth=xt([n.hoverBorderWidth,e.hoverBorderWidth,a.borderWidth],void 0,i)},resyncElements:function(){var t=this.getMeta(),e=this.getDataset().data,i=t.data.length,n=e.length;n<i?t.data.splice(n,i-n):n>i&&this.insertElements(i,n-i)},insertElements:function(t,e){for(var i=0;i<e;++i)this.addElementAndReset(t+i)},onDataPush:function(){var t=arguments.length;this.insertElements(this.getDataset().data.length-t,t)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(t,e){this.getMeta().data.splice(t,e),this.insertElements(t,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),wt.extend=ut.inherits;var Mt=wt;st._set("global",{elements:{arc:{backgroundColor:st.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var _t=pt.extend({inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,e){var i=this._view;if(i){for(var n=ut.getAngleFromPoint(i,{x:t,y:e}),a=n.angle,o=n.distance,r=i.startAngle,s=i.endAngle;s<r;)s+=2*Math.PI;for(;a>s;)a-=2*Math.PI;for(;a<r;)a+=2*Math.PI;var l=a>=r&&a<=s,d=o>=i.innerRadius&&o<=i.outerRadius;return l&&d}return!1},getCenterPoint:function(){var t=this._view,e=(t.startAngle+t.endAngle)/2,i=(t.innerRadius+t.outerRadius)/2;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},getArea:function(){var t=this._view;return Math.PI*((t.endAngle-t.startAngle)/(2*Math.PI))*(Math.pow(t.outerRadius,2)-Math.pow(t.innerRadius,2))},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,i=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},draw:function(){var t,e=this._chart.ctx,i=this._view,n=i.startAngle,a=i.endAngle,o="inner"===i.borderAlign?.33:0;e.save(),e.beginPath(),e.arc(i.x,i.y,Math.max(i.outerRadius-o,0),n,a),e.arc(i.x,i.y,i.innerRadius,a,n,!0),e.closePath(),e.fillStyle=i.backgroundColor,e.fill(),i.borderWidth&&("inner"===i.borderAlign?(e.beginPath(),t=o/i.outerRadius,e.arc(i.x,i.y,i.outerRadius,n-t,a+t),i.innerRadius>o?(t=o/i.innerRadius,e.arc(i.x,i.y,i.innerRadius-o,a+t,n-t,!0)):e.arc(i.x,i.y,o,a+Math.PI/2,n-Math.PI/2),e.closePath(),e.clip(),e.beginPath(),e.arc(i.x,i.y,i.outerRadius,n,a),e.arc(i.x,i.y,i.innerRadius,a,n,!0),e.closePath(),e.lineWidth=2*i.borderWidth,e.lineJoin="round"):(e.lineWidth=i.borderWidth,e.lineJoin="bevel"),e.strokeStyle=i.borderColor,e.stroke()),e.restore()}}),Ct=ut.valueOrDefault,St=st.global.defaultColor;st._set("global",{elements:{line:{tension:.4,backgroundColor:St,borderWidth:3,borderColor:St,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var Pt=pt.extend({draw:function(){var t,e,i,n,a=this._view,o=this._chart.ctx,r=a.spanGaps,s=this._children.slice(),l=st.global,d=l.elements.line,u=-1;for(this._loop&&s.length&&s.push(s[0]),o.save(),o.lineCap=a.borderCapStyle||d.borderCapStyle,o.setLineDash&&o.setLineDash(a.borderDash||d.borderDash),o.lineDashOffset=Ct(a.borderDashOffset,d.borderDashOffset),o.lineJoin=a.borderJoinStyle||d.borderJoinStyle,o.lineWidth=Ct(a.borderWidth,d.borderWidth),o.strokeStyle=a.borderColor||l.defaultColor,o.beginPath(),u=-1,t=0;t<s.length;++t)e=s[t],i=ut.previousItem(s,t),n=e._view,0===t?n.skip||(o.moveTo(n.x,n.y),u=t):(i=-1===u?i:s[u],n.skip||(u!==t-1&&!r||-1===u?o.moveTo(n.x,n.y):ut.canvas.lineTo(o,i._view,e._view),u=t));o.stroke(),o.restore()}}),It=ut.valueOrDefault,At=st.global.defaultColor;function Dt(t){var e=this._view;return!!e&&Math.abs(t-e.x)<e.radius+e.hitRadius}st._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:At,borderColor:At,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var Tt=pt.extend({inRange:function(t,e){var i=this._view;return!!i&&Math.pow(t-i.x,2)+Math.pow(e-i.y,2)<Math.pow(i.hitRadius+i.radius,2)},inLabelRange:Dt,inXRange:Dt,inYRange:function(t){var e=this._view;return!!e&&Math.abs(t-e.y)<e.radius+e.hitRadius},getCenterPoint:function(){var t=this._view;return{x:t.x,y:t.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(t){var e=this._view,i=this._chart.ctx,n=e.pointStyle,a=e.rotation,o=e.radius,r=e.x,s=e.y,l=st.global,d=l.defaultColor;e.skip||(void 0===t||ut.canvas._isPointInArea(e,t))&&(i.strokeStyle=e.borderColor||d,i.lineWidth=It(e.borderWidth,l.elements.point.borderWidth),i.fillStyle=e.backgroundColor||d,ut.canvas.drawPoint(i,n,o,r,s,a))}}),Ft=st.global.defaultColor;function Lt(t){return t&&void 0!==t.width}function Rt(t){var e,i,n,a,o;return Lt(t)?(o=t.width/2,e=t.x-o,i=t.x+o,n=Math.min(t.y,t.base),a=Math.max(t.y,t.base)):(o=t.height/2,e=Math.min(t.x,t.base),i=Math.max(t.x,t.base),n=t.y-o,a=t.y+o),{left:e,top:n,right:i,bottom:a}}function Ot(t,e,i){return t===e?i:t===i?e:t}function zt(t,e,i){var n,a,o,r,s=t.borderWidth,l=function(t){var e=t.borderSkipped,i={};return e?(t.horizontal?t.base>t.x&&(e=Ot(e,"left","right")):t.base<t.y&&(e=Ot(e,"bottom","top")),i[e]=!0,i):i}(t);return ut.isObject(s)?(n=+s.top||0,a=+s.right||0,o=+s.bottom||0,r=+s.left||0):n=a=o=r=+s||0,{t:l.top||n<0?0:n>i?i:n,r:l.right||a<0?0:a>e?e:a,b:l.bottom||o<0?0:o>i?i:o,l:l.left||r<0?0:r>e?e:r}}function Bt(t,e,i){var n=null===e,a=null===i,o=!(!t||n&&a)&&Rt(t);return o&&(n||e>=o.left&&e<=o.right)&&(a||i>=o.top&&i<=o.bottom)}st._set("global",{elements:{rectangle:{backgroundColor:Ft,borderColor:Ft,borderSkipped:"bottom",borderWidth:0}}});var Nt=pt.extend({draw:function(){var t=this._chart.ctx,e=this._view,i=function(t){var e=Rt(t),i=e.right-e.left,n=e.bottom-e.top,a=zt(t,i/2,n/2);return{outer:{x:e.left,y:e.top,w:i,h:n},inner:{x:e.left+a.l,y:e.top+a.t,w:i-a.l-a.r,h:n-a.t-a.b}}}(e),n=i.outer,a=i.inner;t.fillStyle=e.backgroundColor,t.fillRect(n.x,n.y,n.w,n.h),n.w===a.w&&n.h===a.h||(t.save(),t.beginPath(),t.rect(n.x,n.y,n.w,n.h),t.clip(),t.fillStyle=e.borderColor,t.rect(a.x,a.y,a.w,a.h),t.fill("evenodd"),t.restore())},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){return Bt(this._view,t,e)},inLabelRange:function(t,e){var i=this._view;return Lt(i)?Bt(i,t,null):Bt(i,null,e)},inXRange:function(t){return Bt(this._view,t,null)},inYRange:function(t){return Bt(this._view,null,t)},getCenterPoint:function(){var t,e,i=this._view;return Lt(i)?(t=i.x,e=(i.y+i.base)/2):(t=(i.x+i.base)/2,e=i.y),{x:t,y:e}},getArea:function(){var t=this._view;return Lt(t)?t.width*Math.abs(t.y-t.base):t.height*Math.abs(t.x-t.base)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}}),Wt={},Vt=_t,Et=Pt,Ht=Tt,jt=Nt;Wt.Arc=Vt,Wt.Line=Et,Wt.Point=Ht,Wt.Rectangle=jt;var qt=ut.options.resolve;st._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}});var Yt=Mt.extend({dataElementType:Wt.Rectangle,initialize:function(){var t;Mt.prototype.initialize.apply(this,arguments),(t=this.getMeta()).stack=this.getDataset().stack,t.bar=!0},update:function(t){var e,i,n=this.getMeta().data;for(this._ruler=this.getRuler(),e=0,i=n.length;e<i;++e)this.updateElement(n[e],e,t)},updateElement:function(t,e,i){var n=this,a=n.getMeta(),o=n.getDataset(),r=n._resolveElementOptions(t,e);t._xScale=n.getScaleForId(a.xAxisID),t._yScale=n.getScaleForId(a.yAxisID),t._datasetIndex=n.index,t._index=e,t._model={backgroundColor:r.backgroundColor,borderColor:r.borderColor,borderSkipped:r.borderSkipped,borderWidth:r.borderWidth,datasetLabel:o.label,label:n.chart.data.labels[e]},n._updateElementGeometry(t,e,i),t.pivot()},_updateElementGeometry:function(t,e,i){var n=this,a=t._model,o=n._getValueScale(),r=o.getBasePixel(),s=o.isHorizontal(),l=n._ruler||n.getRuler(),d=n.calculateBarValuePixels(n.index,e),u=n.calculateBarIndexPixels(n.index,e,l);a.horizontal=s,a.base=i?r:d.base,a.x=s?i?r:d.head:u.center,a.y=s?u.center:i?r:d.head,a.height=s?u.size:void 0,a.width=s?void 0:u.size},_getStacks:function(t){var e,i,n=this.chart,a=this._getIndexScale().options.stacked,o=void 0===t?n.data.datasets.length:t+1,r=[];for(e=0;e<o;++e)(i=n.getDatasetMeta(e)).bar&&n.isDatasetVisible(e)&&(!1===a||!0===a&&-1===r.indexOf(i.stack)||void 0===a&&(void 0===i.stack||-1===r.indexOf(i.stack)))&&r.push(i.stack);return r},getStackCount:function(){return this._getStacks().length},getStackIndex:function(t,e){var i=this._getStacks(t),n=void 0!==e?i.indexOf(e):-1;return-1===n?i.length-1:n},getRuler:function(){var t,e,i=this._getIndexScale(),n=this.getStackCount(),a=this.index,o=i.isHorizontal(),r=o?i.left:i.top,s=r+(o?i.width:i.height),l=[];for(t=0,e=this.getMeta().data.length;t<e;++t)l.push(i.getPixelForValue(null,t,a));return{min:ut.isNullOrUndef(i.options.barThickness)?function(t,e){var i,n,a,o,r=t.isHorizontal()?t.width:t.height,s=t.getTicks();for(a=1,o=e.length;a<o;++a)r=Math.min(r,Math.abs(e[a]-e[a-1]));for(a=0,o=s.length;a<o;++a)n=t.getPixelForTick(a),r=a>0?Math.min(r,n-i):r,i=n;return r}(i,l):-1,pixels:l,start:r,end:s,stackCount:n,scale:i}},calculateBarValuePixels:function(t,e){var i,n,a,o,r,s,l=this.chart,d=this.getMeta(),u=this._getValueScale(),h=u.isHorizontal(),c=l.data.datasets,f=+u.getRightValue(c[t].data[e]),g=u.options.minBarLength,p=u.options.stacked,m=d.stack,v=0;if(p||void 0===p&&void 0!==m)for(i=0;i<t;++i)(n=l.getDatasetMeta(i)).bar&&n.stack===m&&n.controller._getValueScaleId()===u.id&&l.isDatasetVisible(i)&&(a=+u.getRightValue(c[i].data[e]),(f<0&&a<0||f>=0&&a>0)&&(v+=a));return o=u.getPixelForValue(v),s=(r=u.getPixelForValue(v+f))-o,void 0!==g&&Math.abs(s)<g&&(s=g,r=f>=0&&!h||f<0&&h?o-g:o+g),{size:s,base:o,head:r,center:r+s/2}},calculateBarIndexPixels:function(t,e,i){var n=i.scale.options,a="flex"===n.barThickness?function(t,e,i){var n,a=e.pixels,o=a[t],r=t>0?a[t-1]:null,s=t<a.length-1?a[t+1]:null,l=i.categoryPercentage;return null===r&&(r=o-(null===s?e.end-e.start:s-o)),null===s&&(s=o+o-r),n=o-(o-Math.min(r,s))/2*l,{chunk:Math.abs(s-r)/2*l/e.stackCount,ratio:i.barPercentage,start:n}}(e,i,n):function(t,e,i){var n,a,o=i.barThickness,r=e.stackCount,s=e.pixels[t];return ut.isNullOrUndef(o)?(n=e.min*i.categoryPercentage,a=i.barPercentage):(n=o*r,a=1),{chunk:n/r,ratio:a,start:s-n/2}}(e,i,n),o=this.getStackIndex(t,this.getMeta().stack),r=a.start+a.chunk*o+a.chunk/2,s=Math.min(ut.valueOrDefault(n.maxBarThickness,1/0),a.chunk*a.ratio);return{base:r-s/2,head:r+s/2,center:r,size:s}},draw:function(){var t=this.chart,e=this._getValueScale(),i=this.getMeta().data,n=this.getDataset(),a=i.length,o=0;for(ut.canvas.clipArea(t.ctx,t.chartArea);o<a;++o)isNaN(e.getRightValue(n.data[o]))||i[o].draw();ut.canvas.unclipArea(t.ctx)},_resolveElementOptions:function(t,e){var i,n,a,o=this.chart,r=o.data.datasets[this.index],s=t.custom||{},l=o.options.elements.rectangle,d={},u={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},h=["backgroundColor","borderColor","borderSkipped","borderWidth"];for(i=0,n=h.length;i<n;++i)d[a=h[i]]=qt([s[a],r[a],l[a]],u,e);return d}}),Ut=ut.valueOrDefault,Xt=ut.options.resolve;st._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.datasets[t.datasetIndex].label||"",n=e.datasets[t.datasetIndex].data[t.index];return i+": ("+t.xLabel+", "+t.yLabel+", "+n.r+")"}}}});var Kt=Mt.extend({dataElementType:Wt.Point,update:function(t){var e=this,i=e.getMeta().data;ut.each(i,function(i,n){e.updateElement(i,n,t)})},updateElement:function(t,e,i){var n=this,a=n.getMeta(),o=t.custom||{},r=n.getScaleForId(a.xAxisID),s=n.getScaleForId(a.yAxisID),l=n._resolveElementOptions(t,e),d=n.getDataset().data[e],u=n.index,h=i?r.getPixelForDecimal(.5):r.getPixelForValue("object"==typeof d?d:NaN,e,u),c=i?s.getBasePixel():s.getPixelForValue(d,e,u);t._xScale=r,t._yScale=s,t._options=l,t._datasetIndex=u,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:i?0:l.radius,skip:o.skip||isNaN(h)||isNaN(c),x:h,y:c},t.pivot()},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Ut(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Ut(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Ut(i.hoverBorderWidth,i.borderWidth),e.radius=i.radius+i.hoverRadius},_resolveElementOptions:function(t,e){var i,n,a,o=this.chart,r=o.data.datasets[this.index],s=t.custom||{},l=o.options.elements.point,d=r.data[e],u={},h={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},c=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"];for(i=0,n=c.length;i<n;++i)u[a=c[i]]=Xt([s[a],r[a],l[a]],h,e);return u.radius=Xt([s.radius,d?d.r:void 0,r.radius,l.radius],h,e),u}}),Gt=ut.options.resolve,Zt=ut.valueOrDefault;st._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,a=i.labels;if(n.length)for(var o=0;o<n[0].data.length;++o)e.push('<li><span style="background-color:'+n[0].backgroundColor[o]+'"></span>'),a[o]&&e.push(a[o]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map(function(i,n){var a=t.getDatasetMeta(0),o=e.datasets[0],r=a.data[n],s=r&&r.custom||{},l=t.options.elements.arc;return{text:i,fillStyle:Gt([s.backgroundColor,o.backgroundColor,l.backgroundColor],void 0,n),strokeStyle:Gt([s.borderColor,o.borderColor,l.borderColor],void 0,n),lineWidth:Gt([s.borderWidth,o.borderWidth,l.borderWidth],void 0,n),hidden:isNaN(o.data[n])||a.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var i,n,a,o=e.index,r=this.chart;for(i=0,n=(r.data.datasets||[]).length;i<n;++i)(a=r.getDatasetMeta(i)).data[o]&&(a.data[o].hidden=!a.data[o].hidden);r.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.labels[t.index],n=": "+e.datasets[t.datasetIndex].data[t.index];return ut.isArray(i)?(i=i.slice())[0]+=n:i+=n,i}}}});var $t=Mt.extend({dataElementType:Wt.Arc,linkScales:ut.noop,getRingIndex:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&++e;return e},update:function(t){var e,i,n=this,a=n.chart,o=a.chartArea,r=a.options,s=o.right-o.left,l=o.bottom-o.top,d=Math.min(s,l),u={x:0,y:0},h=n.getMeta(),c=h.data,f=r.cutoutPercentage,g=r.circumference,p=n._getRingWeight(n.index);if(g<2*Math.PI){var m=r.rotation%(2*Math.PI),v=(m+=2*Math.PI*(m>=Math.PI?-1:m<-Math.PI?1:0))+g,b={x:Math.cos(m),y:Math.sin(m)},x={x:Math.cos(v),y:Math.sin(v)},y=m<=0&&v>=0||m<=2*Math.PI&&2*Math.PI<=v,k=m<=.5*Math.PI&&.5*Math.PI<=v||m<=2.5*Math.PI&&2.5*Math.PI<=v,w=m<=-Math.PI&&-Math.PI<=v||m<=Math.PI&&Math.PI<=v,M=m<=.5*-Math.PI&&.5*-Math.PI<=v||m<=1.5*Math.PI&&1.5*Math.PI<=v,_=f/100,C={x:w?-1:Math.min(b.x*(b.x<0?1:_),x.x*(x.x<0?1:_)),y:M?-1:Math.min(b.y*(b.y<0?1:_),x.y*(x.y<0?1:_))},S={x:y?1:Math.max(b.x*(b.x>0?1:_),x.x*(x.x>0?1:_)),y:k?1:Math.max(b.y*(b.y>0?1:_),x.y*(x.y>0?1:_))},P={width:.5*(S.x-C.x),height:.5*(S.y-C.y)};d=Math.min(s/P.width,l/P.height),u={x:-.5*(S.x+C.x),y:-.5*(S.y+C.y)}}for(e=0,i=c.length;e<i;++e)c[e]._options=n._resolveElementOptions(c[e],e);for(a.borderWidth=n.getMaxBorderWidth(),a.outerRadius=Math.max((d-a.borderWidth)/2,0),a.innerRadius=Math.max(f?a.outerRadius/100*f:0,0),a.radiusLength=(a.outerRadius-a.innerRadius)/(n._getVisibleDatasetWeightTotal()||1),a.offsetX=u.x*a.outerRadius,a.offsetY=u.y*a.outerRadius,h.total=n.calculateTotal(),n.outerRadius=a.outerRadius-a.radiusLength*n._getRingWeightOffset(n.index),n.innerRadius=Math.max(n.outerRadius-a.radiusLength*p,0),e=0,i=c.length;e<i;++e)n.updateElement(c[e],e,t)},updateElement:function(t,e,i){var n=this,a=n.chart,o=a.chartArea,r=a.options,s=r.animation,l=(o.left+o.right)/2,d=(o.top+o.bottom)/2,u=r.rotation,h=r.rotation,c=n.getDataset(),f=i&&s.animateRotate?0:t.hidden?0:n.calculateCircumference(c.data[e])*(r.circumference/(2*Math.PI)),g=i&&s.animateScale?0:n.innerRadius,p=i&&s.animateScale?0:n.outerRadius,m=t._options||{};ut.extend(t,{_datasetIndex:n.index,_index:e,_model:{backgroundColor:m.backgroundColor,borderColor:m.borderColor,borderWidth:m.borderWidth,borderAlign:m.borderAlign,x:l+a.offsetX,y:d+a.offsetY,startAngle:u,endAngle:h,circumference:f,outerRadius:p,innerRadius:g,label:ut.valueAtIndexOrDefault(c.label,e,a.data.labels[e])}});var v=t._model;i&&s.animateRotate||(v.startAngle=0===e?r.rotation:n.getMeta().data[e-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},calculateTotal:function(){var t,e=this.getDataset(),i=this.getMeta(),n=0;return ut.each(i.data,function(i,a){t=e.data[a],isNaN(t)||i.hidden||(n+=Math.abs(t))}),n},calculateCircumference:function(t){var e=this.getMeta().total;return e>0&&!isNaN(t)?2*Math.PI*(Math.abs(t)/e):0},getMaxBorderWidth:function(t){var e,i,n,a,o,r,s,l,d=0,u=this.chart;if(!t)for(e=0,i=u.data.datasets.length;e<i;++e)if(u.isDatasetVisible(e)){t=(n=u.getDatasetMeta(e)).data,e!==this.index&&(o=n.controller);break}if(!t)return 0;for(e=0,i=t.length;e<i;++e)a=t[e],"inner"!==(r=o?o._resolveElementOptions(a,e):a._options).borderAlign&&(s=r.borderWidth,d=(l=r.hoverBorderWidth)>(d=s>d?s:d)?l:d);return d},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=Zt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Zt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Zt(i.hoverBorderWidth,i.borderWidth)},_resolveElementOptions:function(t,e){var i,n,a,o=this.chart,r=this.getDataset(),s=t.custom||{},l=o.options.elements.arc,d={},u={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},h=["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"];for(i=0,n=h.length;i<n;++i)d[a=h[i]]=Gt([s[a],r[a],l[a]],u,e);return d},_getRingWeightOffset:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e},_getRingWeight:function(t){return Math.max(Zt(this.chart.data.datasets[t].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});st._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}});var Jt=Yt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Qt=ut.valueOrDefault,te=ut.options.resolve,ee=ut.canvas._isPointInArea;function ie(t,e){return Qt(t.showLine,e.showLines)}st._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var ne=Mt.extend({datasetElementType:Wt.Line,dataElementType:Wt.Point,update:function(t){var e,i,n=this,a=n.getMeta(),o=a.dataset,r=a.data||[],s=n.getScaleForId(a.yAxisID),l=n.getDataset(),d=ie(l,n.chart.options);for(d&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),o._scale=s,o._datasetIndex=n.index,o._children=r,o._model=n._resolveLineOptions(o),o.pivot()),e=0,i=r.length;e<i;++e)n.updateElement(r[e],e,t);for(d&&0!==o._model.tension&&n.updateBezierControlPoints(),e=0,i=r.length;e<i;++e)r[e].pivot()},updateElement:function(t,e,i){var n,a,o=this,r=o.getMeta(),s=t.custom||{},l=o.getDataset(),d=o.index,u=l.data[e],h=o.getScaleForId(r.yAxisID),c=o.getScaleForId(r.xAxisID),f=r.dataset._model,g=o._resolvePointOptions(t,e);n=c.getPixelForValue("object"==typeof u?u:NaN,e,d),a=i?h.getBasePixel():o.calculatePointY(u,e,d),t._xScale=c,t._yScale=h,t._options=g,t._datasetIndex=d,t._index=e,t._model={x:n,y:a,skip:s.skip||isNaN(n)||isNaN(a),radius:g.radius,pointStyle:g.pointStyle,rotation:g.rotation,backgroundColor:g.backgroundColor,borderColor:g.borderColor,borderWidth:g.borderWidth,tension:Qt(s.tension,f?f.tension:0),steppedLine:!!f&&f.steppedLine,hitRadius:g.hitRadius}},_resolvePointOptions:function(t,e){var i,n,a,o=this.chart,r=o.data.datasets[this.index],s=t.custom||{},l=o.options.elements.point,d={},u={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},h={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},c=Object.keys(h);for(i=0,n=c.length;i<n;++i)d[a=c[i]]=te([s[a],r[h[a]],r[a],l[a]],u,e);return d},_resolveLineOptions:function(t){var e,i,n,a=this.chart,o=a.data.datasets[this.index],r=t.custom||{},s=a.options,l=s.elements.line,d={},u=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill","cubicInterpolationMode"];for(e=0,i=u.length;e<i;++e)d[n=u[e]]=te([r[n],o[n],l[n]]);return d.spanGaps=Qt(o.spanGaps,s.spanGaps),d.tension=Qt(o.lineTension,l.tension),d.steppedLine=te([r.steppedLine,o.steppedLine,l.stepped]),d},calculatePointY:function(t,e,i){var n,a,o,r=this.chart,s=this.getMeta(),l=this.getScaleForId(s.yAxisID),d=0,u=0;if(l.options.stacked){for(n=0;n<i;n++)if(a=r.data.datasets[n],"line"===(o=r.getDatasetMeta(n)).type&&o.yAxisID===l.id&&r.isDatasetVisible(n)){var h=Number(l.getRightValue(a.data[e]));h<0?u+=h||0:d+=h||0}var c=Number(l.getRightValue(t));return c<0?l.getPixelForValue(u+c):l.getPixelForValue(d+c)}return l.getPixelForValue(t)},updateBezierControlPoints:function(){var t,e,i,n,a=this.chart,o=this.getMeta(),r=o.dataset._model,s=a.chartArea,l=o.data||[];function d(t,e,i){return Math.max(Math.min(t,i),e)}if(r.spanGaps&&(l=l.filter(function(t){return!t._model.skip})),"monotone"===r.cubicInterpolationMode)ut.splineCurveMonotone(l);else for(t=0,e=l.length;t<e;++t)i=l[t]._model,n=ut.splineCurve(ut.previousItem(l,t)._model,i,ut.nextItem(l,t)._model,r.tension),i.controlPointPreviousX=n.previous.x,i.controlPointPreviousY=n.previous.y,i.controlPointNextX=n.next.x,i.controlPointNextY=n.next.y;if(a.options.elements.line.capBezierPoints)for(t=0,e=l.length;t<e;++t)i=l[t]._model,ee(i,s)&&(t>0&&ee(l[t-1]._model,s)&&(i.controlPointPreviousX=d(i.controlPointPreviousX,s.left,s.right),i.controlPointPreviousY=d(i.controlPointPreviousY,s.top,s.bottom)),t<l.length-1&&ee(l[t+1]._model,s)&&(i.controlPointNextX=d(i.controlPointNextX,s.left,s.right),i.controlPointNextY=d(i.controlPointNextY,s.top,s.bottom)))},draw:function(){var t,e=this.chart,i=this.getMeta(),n=i.data||[],a=e.chartArea,o=n.length,r=0;for(ie(this.getDataset(),e.options)&&(t=(i.dataset._model.borderWidth||0)/2,ut.canvas.clipArea(e.ctx,{left:a.left,right:a.right,top:a.top-t,bottom:a.bottom+t}),i.dataset.draw(),ut.canvas.unclipArea(e.ctx));r<o;++r)n[r].draw(a)},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Qt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Qt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Qt(i.hoverBorderWidth,i.borderWidth),e.radius=Qt(i.hoverRadius,i.radius)}}),ae=ut.options.resolve;st._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,a=i.labels;if(n.length)for(var o=0;o<n[0].data.length;++o)e.push('<li><span style="background-color:'+n[0].backgroundColor[o]+'"></span>'),a[o]&&e.push(a[o]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map(function(i,n){var a=t.getDatasetMeta(0),o=e.datasets[0],r=a.data[n].custom||{},s=t.options.elements.arc;return{text:i,fillStyle:ae([r.backgroundColor,o.backgroundColor,s.backgroundColor],void 0,n),strokeStyle:ae([r.borderColor,o.borderColor,s.borderColor],void 0,n),lineWidth:ae([r.borderWidth,o.borderWidth,s.borderWidth],void 0,n),hidden:isNaN(o.data[n])||a.data[n].hidden,index:n}}):[]}},onClick:function(t,e){var i,n,a,o=e.index,r=this.chart;for(i=0,n=(r.data.datasets||[]).length;i<n;++i)(a=r.getDatasetMeta(i)).data[o].hidden=!a.data[o].hidden;r.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}});var oe=Mt.extend({dataElementType:Wt.Arc,linkScales:ut.noop,update:function(t){var e,i,n,a=this,o=a.getDataset(),r=a.getMeta(),s=a.chart.options.startAngle||0,l=a._starts=[],d=a._angles=[],u=r.data;for(a._updateRadius(),r.count=a.countVisibleElements(),e=0,i=o.data.length;e<i;e++)l[e]=s,n=a._computeAngle(e),d[e]=n,s+=n;for(e=0,i=u.length;e<i;++e)u[e]._options=a._resolveElementOptions(u[e],e),a.updateElement(u[e],e,t)},_updateRadius:function(){var t=this,e=t.chart,i=e.chartArea,n=e.options,a=Math.min(i.right-i.left,i.bottom-i.top);e.outerRadius=Math.max(a/2,0),e.innerRadius=Math.max(n.cutoutPercentage?e.outerRadius/100*n.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),t.outerRadius=e.outerRadius-e.radiusLength*t.index,t.innerRadius=t.outerRadius-e.radiusLength},updateElement:function(t,e,i){var n=this,a=n.chart,o=n.getDataset(),r=a.options,s=r.animation,l=a.scale,d=a.data.labels,u=l.xCenter,h=l.yCenter,c=r.startAngle,f=t.hidden?0:l.getDistanceFromCenterForValue(o.data[e]),g=n._starts[e],p=g+(t.hidden?0:n._angles[e]),m=s.animateScale?0:l.getDistanceFromCenterForValue(o.data[e]),v=t._options||{};ut.extend(t,{_datasetIndex:n.index,_index:e,_scale:l,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,x:u,y:h,innerRadius:0,outerRadius:i?m:f,startAngle:i&&s.animateRotate?c:g,endAngle:i&&s.animateRotate?c:p,label:ut.valueAtIndexOrDefault(d,e,d[e])}}),t.pivot()},countVisibleElements:function(){var t=this.getDataset(),e=this.getMeta(),i=0;return ut.each(e.data,function(e,n){isNaN(t.data[n])||e.hidden||i++}),i},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor,a=ut.valueOrDefault;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=a(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=a(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=a(i.hoverBorderWidth,i.borderWidth)},_resolveElementOptions:function(t,e){var i,n,a,o=this.chart,r=this.getDataset(),s=t.custom||{},l=o.options.elements.arc,d={},u={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},h=["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"];for(i=0,n=h.length;i<n;++i)d[a=h[i]]=ae([s[a],r[a],l[a]],u,e);return d},_computeAngle:function(t){var e=this,i=this.getMeta().count,n=e.getDataset(),a=e.getMeta();if(isNaN(n.data[t])||a.data[t].hidden)return 0;var o={chart:e.chart,dataIndex:t,dataset:n,datasetIndex:e.index};return ae([e.chart.options.elements.arc.angle,2*Math.PI/i],o,t)}});st._set("pie",ut.clone(st.doughnut)),st._set("pie",{cutoutPercentage:0});var re=$t,se=ut.valueOrDefault,le=ut.options.resolve;st._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}});var de=Mt.extend({datasetElementType:Wt.Line,dataElementType:Wt.Point,linkScales:ut.noop,update:function(t){var e,i,n=this,a=n.getMeta(),o=a.dataset,r=a.data||[],s=n.chart.scale,l=n.getDataset();for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),o._scale=s,o._datasetIndex=n.index,o._children=r,o._loop=!0,o._model=n._resolveLineOptions(o),o.pivot(),e=0,i=r.length;e<i;++e)n.updateElement(r[e],e,t);for(n.updateBezierControlPoints(),e=0,i=r.length;e<i;++e)r[e].pivot()},updateElement:function(t,e,i){var n=this,a=t.custom||{},o=n.getDataset(),r=n.chart.scale,s=r.getPointPositionForValue(e,o.data[e]),l=n._resolvePointOptions(t,e),d=n.getMeta().dataset._model,u=i?r.xCenter:s.x,h=i?r.yCenter:s.y;t._scale=r,t._options=l,t._datasetIndex=n.index,t._index=e,t._model={x:u,y:h,skip:a.skip||isNaN(u)||isNaN(h),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:se(a.tension,d?d.tension:0),hitRadius:l.hitRadius}},_resolvePointOptions:function(t,e){var i,n,a,o=this.chart,r=o.data.datasets[this.index],s=t.custom||{},l=o.options.elements.point,d={},u={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},h={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},c=Object.keys(h);for(i=0,n=c.length;i<n;++i)d[a=c[i]]=le([s[a],r[h[a]],r[a],l[a]],u,e);return d},_resolveLineOptions:function(t){var e,i,n,a=this.chart,o=a.data.datasets[this.index],r=t.custom||{},s=a.options.elements.line,l={},d=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"];for(e=0,i=d.length;e<i;++e)l[n=d[e]]=le([r[n],o[n],s[n]]);return l.tension=se(o.lineTension,s.tension),l},updateBezierControlPoints:function(){var t,e,i,n,a=this.getMeta(),o=this.chart.chartArea,r=a.data||[];function s(t,e,i){return Math.max(Math.min(t,i),e)}for(t=0,e=r.length;t<e;++t)i=r[t]._model,n=ut.splineCurve(ut.previousItem(r,t,!0)._model,i,ut.nextItem(r,t,!0)._model,i.tension),i.controlPointPreviousX=s(n.previous.x,o.left,o.right),i.controlPointPreviousY=s(n.previous.y,o.top,o.bottom),i.controlPointNextX=s(n.next.x,o.left,o.right),i.controlPointNextY=s(n.next.y,o.top,o.bottom)},setHoverStyle:function(t){var e=t._model,i=t._options,n=ut.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=se(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=se(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=se(i.hoverBorderWidth,i.borderWidth),e.radius=se(i.hoverRadius,i.radius)}});st._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:!1,tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}});var ue={bar:Yt,bubble:Kt,doughnut:$t,horizontalBar:Jt,line:ne,polarArea:oe,pie:re,radar:de,scatter:ne};function he(t,e){return t.native?{x:t.x,y:t.y}:ut.getRelativePosition(t,e)}function ce(t,e){var i,n,a,o,r;for(n=0,o=t.data.datasets.length;n<o;++n)if(t.isDatasetVisible(n))for(a=0,r=(i=t.getDatasetMeta(n)).data.length;a<r;++a){var s=i.data[a];s._view.skip||e(s)}}function fe(t,e){var i=[];return ce(t,function(t){t.inRange(e.x,e.y)&&i.push(t)}),i}function ge(t,e,i,n){var a=Number.POSITIVE_INFINITY,o=[];return ce(t,function(t){if(!i||t.inRange(e.x,e.y)){var r=t.getCenterPoint(),s=n(e,r);s<a?(o=[t],a=s):s===a&&o.push(t)}}),o}function pe(t){var e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,n){var a=e?Math.abs(t.x-n.x):0,o=i?Math.abs(t.y-n.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function me(t,e,i){var n=he(e,t);i.axis=i.axis||"x";var a=pe(i.axis),o=i.intersect?fe(t,n):ge(t,n,!1,a),r=[];return o.length?(t.data.datasets.forEach(function(e,i){if(t.isDatasetVisible(i)){var n=t.getDatasetMeta(i).data[o[0]._index];n&&!n._view.skip&&r.push(n)}}),r):[]}var ve={modes:{single:function(t,e){var i=he(e,t),n=[];return ce(t,function(t){if(t.inRange(i.x,i.y))return n.push(t),n}),n.slice(0,1)},label:me,index:me,dataset:function(t,e,i){var n=he(e,t);i.axis=i.axis||"xy";var a=pe(i.axis),o=i.intersect?fe(t,n):ge(t,n,!1,a);return o.length>0&&(o=t.getDatasetMeta(o[0]._datasetIndex).data),o},"x-axis":function(t,e){return me(t,e,{intersect:!1})},point:function(t,e){return fe(t,he(e,t))},nearest:function(t,e,i){var n=he(e,t);i.axis=i.axis||"xy";var a=pe(i.axis);return ge(t,n,i.intersect,a)},x:function(t,e,i){var n=he(e,t),a=[],o=!1;return ce(t,function(t){t.inXRange(n.x)&&a.push(t),t.inRange(n.x,n.y)&&(o=!0)}),i.intersect&&!o&&(a=[]),a},y:function(t,e,i){var n=he(e,t),a=[],o=!1;return ce(t,function(t){t.inYRange(n.y)&&a.push(t),t.inRange(n.x,n.y)&&(o=!0)}),i.intersect&&!o&&(a=[]),a}}};function be(t,e){return ut.where(t,function(t){return t.position===e})}function xe(t,e){t.forEach(function(t,e){return t._tmpIndex_=e,t}),t.sort(function(t,i){var n=e?i:t,a=e?t:i;return n.weight===a.weight?n._tmpIndex_-a._tmpIndex_:n.weight-a.weight}),t.forEach(function(t){delete t._tmpIndex_})}function ye(t,e){ut.each(t,function(t){e[t.position]+=t.isHorizontal()?t.height:t.width})}st._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var ke={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),e.fullWidth=e.fullWidth||!1,e.position=e.position||"top",e.weight=e.weight||0,t.boxes.push(e)},removeBox:function(t,e){var i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure:function(t,e,i){for(var n,a=["fullWidth","position","weight"],o=a.length,r=0;r<o;++r)n=a[r],i.hasOwnProperty(n)&&(e[n]=i[n])},update:function(t,e,i){if(t){var n=t.options.layout||{},a=ut.options.toPadding(n.padding),o=a.left,r=a.right,s=a.top,l=a.bottom,d=be(t.boxes,"left"),u=be(t.boxes,"right"),h=be(t.boxes,"top"),c=be(t.boxes,"bottom"),f=be(t.boxes,"chartArea");xe(d,!0),xe(u,!1),xe(h,!0),xe(c,!1);var g,p=d.concat(u),m=h.concat(c),v=p.concat(m),b=e-o-r,x=i-s-l,y=(e-b/2)/p.length,k=b,w=x,M={top:s,left:o,bottom:l,right:r},_=[];ut.each(v,function(t){var e,i=t.isHorizontal();i?(e=t.update(t.fullWidth?b:k,x/2),w-=e.height):(e=t.update(y,w),k-=e.width),_.push({horizontal:i,width:e.width,box:t})}),g=function(t){var e=0,i=0,n=0,a=0;return ut.each(t,function(t){if(t.getPadding){var o=t.getPadding();e=Math.max(e,o.top),i=Math.max(i,o.left),n=Math.max(n,o.bottom),a=Math.max(a,o.right)}}),{top:e,left:i,bottom:n,right:a}}(v),ut.each(p,T),ye(p,M),ut.each(m,T),ye(m,M),ut.each(p,function(t){var e=ut.findNextWhere(_,function(e){return e.box===t}),i={left:0,right:0,top:M.top,bottom:M.bottom};e&&t.update(e.width,w,i)}),ye(v,M={top:s,left:o,bottom:l,right:r});var C=Math.max(g.left-M.left,0);M.left+=C,M.right+=Math.max(g.right-M.right,0);var S=Math.max(g.top-M.top,0);M.top+=S,M.bottom+=Math.max(g.bottom-M.bottom,0);var P=i-M.top-M.bottom,I=e-M.left-M.right;I===k&&P===w||(ut.each(p,function(t){t.height=P}),ut.each(m,function(t){t.fullWidth||(t.width=I)}),w=P,k=I);var A=o+C,D=s+S;ut.each(d.concat(h),F),A+=k,D+=w,ut.each(u,F),ut.each(c,F),t.chartArea={left:M.left,top:M.top,right:M.left+k,bottom:M.top+w},ut.each(f,function(e){e.left=t.chartArea.left,e.top=t.chartArea.top,e.right=t.chartArea.right,e.bottom=t.chartArea.bottom,e.update(k,w)})}function T(t){var e=ut.findNextWhere(_,function(e){return e.box===t});if(e)if(e.horizontal){var i={left:Math.max(M.left,g.left),right:Math.max(M.right,g.right),top:0,bottom:0};t.update(t.fullWidth?b:k,x/2,i)}else t.update(e.width,w)}function F(t){t.isHorizontal()?(t.left=t.fullWidth?o:M.left,t.right=t.fullWidth?e-r:M.left+k,t.top=D,t.bottom=D+t.height,D=t.bottom):(t.left=A,t.right=A+t.width,t.top=M.top,t.bottom=M.top+w,A=t.right)}}};var we,Me=(we=Object.freeze({default:"@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}"}))&&we.default||we,_e="$chartjs",Ce="chartjs-size-monitor",Se="chartjs-render-monitor",Pe="chartjs-render-animation",Ie=["animationstart","webkitAnimationStart"],Ae={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function De(t,e){var i=ut.getStyle(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):void 0}var Te=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0};function Fe(t,e,i){t.addEventListener(e,i,Te)}function Le(t,e,i){t.removeEventListener(e,i,Te)}function Re(t,e,i,n,a){return{type:t,chart:e,native:a||null,x:void 0!==i?i:null,y:void 0!==n?n:null}}function Oe(t){var e=document.createElement("div");return e.className=t||"",e}function ze(t,e,i){var n,a,o,r,s=t[_e]||(t[_e]={}),l=s.resizer=function(t){var e=Oe(Ce),i=Oe(Ce+"-expand"),n=Oe(Ce+"-shrink");i.appendChild(Oe()),n.appendChild(Oe()),e.appendChild(i),e.appendChild(n),e._reset=function(){i.scrollLeft=1e6,i.scrollTop=1e6,n.scrollLeft=1e6,n.scrollTop=1e6};var a=function(){e._reset(),t()};return Fe(i,"scroll",a.bind(i,"expand")),Fe(n,"scroll",a.bind(n,"shrink")),e}((n=function(){if(s.resizer){var n=i.options.maintainAspectRatio&&t.parentNode,a=n?n.clientWidth:0;e(Re("resize",i)),n&&n.clientWidth<a&&i.canvas&&e(Re("resize",i))}},o=!1,r=[],function(){r=Array.prototype.slice.call(arguments),a=a||this,o||(o=!0,ut.requestAnimFrame.call(window,function(){o=!1,n.apply(a,r)}))}));!function(t,e){var i=t[_e]||(t[_e]={}),n=i.renderProxy=function(t){t.animationName===Pe&&e()};ut.each(Ie,function(e){Fe(t,e,n)}),i.reflow=!!t.offsetParent,t.classList.add(Se)}(t,function(){if(s.resizer){var e=t.parentNode;e&&e!==l.parentNode&&e.insertBefore(l,e.firstChild),l._reset()}})}function Be(t){var e=t[_e]||{},i=e.resizer;delete e.resizer,function(t){var e=t[_e]||{},i=e.renderProxy;i&&(ut.each(Ie,function(e){Le(t,e,i)}),delete e.renderProxy),t.classList.remove(Se)}(t),i&&i.parentNode&&i.parentNode.removeChild(i)}var Ne={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(){var t,e,i;this._loaded||(this._loaded=!0,this.disableCSSInjection||(e=Me,i=(t=this)._style||document.createElement("style"),t._style||(t._style=i,e="/* Chart.js */\n"+e,i.setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(i)),i.appendChild(document.createTextNode(e))))},acquireContext:function(t,e){"string"==typeof t?t=document.getElementById(t):t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas);var i=t&&t.getContext&&t.getContext("2d");return this._ensureLoaded(),i&&i.canvas===t?(function(t,e){var i=t.style,n=t.getAttribute("height"),a=t.getAttribute("width");if(t[_e]={initial:{height:n,width:a,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",null===a||""===a){var o=De(t,"width");void 0!==o&&(t.width=o)}if(null===n||""===n)if(""===t.style.height)t.height=t.width/(e.options.aspectRatio||2);else{var r=De(t,"height");void 0!==o&&(t.height=r)}}(t,e),i):null},releaseContext:function(t){var e=t.canvas;if(e[_e]){var i=e[_e].initial;["height","width"].forEach(function(t){var n=i[t];ut.isNullOrUndef(n)?e.removeAttribute(t):e.setAttribute(t,n)}),ut.each(i.style||{},function(t,i){e.style[i]=t}),e.width=e.width,delete e[_e]}},addEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var a=i[_e]||(i[_e]={});Fe(n,e,(a.proxies||(a.proxies={}))[t.id+"_"+e]=function(e){i(function(t,e){var i=Ae[t.type]||t.type,n=ut.getRelativePosition(t,e);return Re(i,e,n.x,n.y,t)}(e,t))})}else ze(n,i,t)},removeEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var a=((i[_e]||{}).proxies||{})[t.id+"_"+e];a&&Le(n,e,a)}else Be(n)}};ut.addEvent=Fe,ut.removeEvent=Le;var We=Ne._enabled?Ne:{acquireContext:function(t){return t&&t.canvas&&(t=t.canvas),t&&t.getContext("2d")||null}},Ve=ut.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},We);st._set("global",{plugins:{}});var Ee={_plugins:[],_cacheId:0,register:function(t){var e=this._plugins;[].concat(t).forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),this._cacheId++},unregister:function(t){var e=this._plugins;[].concat(t).forEach(function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e,i){var n,a,o,r,s,l=this.descriptors(t),d=l.length;for(n=0;n<d;++n)if("function"==typeof(s=(o=(a=l[n]).plugin)[e])&&((r=[t].concat(i||[])).push(a.options),!1===s.apply(o,r)))return!1;return!0},descriptors:function(t){var e=t.$plugins||(t.$plugins={});if(e.id===this._cacheId)return e.descriptors;var i=[],n=[],a=t&&t.config||{},o=a.options&&a.options.plugins||{};return this._plugins.concat(a.plugins||[]).forEach(function(t){if(-1===i.indexOf(t)){var e=t.id,a=o[e];!1!==a&&(!0===a&&(a=ut.clone(st.global.plugins[e])),i.push(t),n.push({plugin:t,options:a||{}}))}}),e.descriptors=n,e.id=this._cacheId,n},_invalidate:function(t){delete t.$plugins}},He={constructors:{},defaults:{},registerScaleType:function(t,e,i){this.constructors[t]=e,this.defaults[t]=ut.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?ut.merge({},[st.scale,this.defaults[t]]):{}},updateScaleDefaults:function(t,e){this.defaults.hasOwnProperty(t)&&(this.defaults[t]=ut.extend(this.defaults[t],e))},addScalesToLayout:function(t){ut.each(t.scales,function(e){e.fullWidth=e.options.fullWidth,e.position=e.options.position,e.weight=e.options.weight,ke.addBox(t,e)})}},je=ut.valueOrDefault;st._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:ut.noop,title:function(t,e){var i="",n=e.labels,a=n?n.length:0;if(t.length>0){var o=t[0];o.label?i=o.label:o.xLabel?i=o.xLabel:a>0&&o.index<a&&(i=n[o.index])}return i},afterTitle:ut.noop,beforeBody:ut.noop,beforeLabel:ut.noop,label:function(t,e){var i=e.datasets[t.datasetIndex].label||"";return i&&(i+=": "),ut.isNullOrUndef(t.value)?i+=t.yLabel:i+=t.value,i},labelColor:function(t,e){var i=e.getDatasetMeta(t.datasetIndex).data[t.index]._view;return{borderColor:i.borderColor,backgroundColor:i.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:ut.noop,afterBody:ut.noop,beforeFooter:ut.noop,footer:ut.noop,afterFooter:ut.noop}}});var qe={average:function(t){if(!t.length)return!1;var e,i,n=0,a=0,o=0;for(e=0,i=t.length;e<i;++e){var r=t[e];if(r&&r.hasValue()){var s=r.tooltipPosition();n+=s.x,a+=s.y,++o}}return{x:n/o,y:a/o}},nearest:function(t,e){var i,n,a,o=e.x,r=e.y,s=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){var l=t[i];if(l&&l.hasValue()){var d=l.getCenterPoint(),u=ut.distanceBetweenPoints(e,d);u<s&&(s=u,a=l)}}if(a){var h=a.tooltipPosition();o=h.x,r=h.y}return{x:o,y:r}}};function Ye(t,e){return e&&(ut.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ue(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function Xe(t){var e=st.global;return{xPadding:t.xPadding,yPadding:t.yPadding,xAlign:t.xAlign,yAlign:t.yAlign,bodyFontColor:t.bodyFontColor,_bodyFontFamily:je(t.bodyFontFamily,e.defaultFontFamily),_bodyFontStyle:je(t.bodyFontStyle,e.defaultFontStyle),_bodyAlign:t.bodyAlign,bodyFontSize:je(t.bodyFontSize,e.defaultFontSize),bodySpacing:t.bodySpacing,titleFontColor:t.titleFontColor,_titleFontFamily:je(t.titleFontFamily,e.defaultFontFamily),_titleFontStyle:je(t.titleFontStyle,e.defaultFontStyle),titleFontSize:je(t.titleFontSize,e.defaultFontSize),_titleAlign:t.titleAlign,titleSpacing:t.titleSpacing,titleMarginBottom:t.titleMarginBottom,footerFontColor:t.footerFontColor,_footerFontFamily:je(t.footerFontFamily,e.defaultFontFamily),_footerFontStyle:je(t.footerFontStyle,e.defaultFontStyle),footerFontSize:je(t.footerFontSize,e.defaultFontSize),_footerAlign:t.footerAlign,footerSpacing:t.footerSpacing,footerMarginTop:t.footerMarginTop,caretSize:t.caretSize,cornerRadius:t.cornerRadius,backgroundColor:t.backgroundColor,opacity:0,legendColorBackground:t.multiKeyBackground,displayColors:t.displayColors,borderColor:t.borderColor,borderWidth:t.borderWidth}}function Ke(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}function Ge(t){return Ye([],Ue(t))}var Ze=pt.extend({initialize:function(){this._model=Xe(this._options),this._lastActive=[]},getTitle:function(){var t=this._options.callbacks,e=t.beforeTitle.apply(this,arguments),i=t.title.apply(this,arguments),n=t.afterTitle.apply(this,arguments),a=[];return a=Ye(a,Ue(e)),a=Ye(a,Ue(i)),a=Ye(a,Ue(n))},getBeforeBody:function(){return Ge(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(t,e){var i=this,n=i._options.callbacks,a=[];return ut.each(t,function(t){var o={before:[],lines:[],after:[]};Ye(o.before,Ue(n.beforeLabel.call(i,t,e))),Ye(o.lines,n.label.call(i,t,e)),Ye(o.after,Ue(n.afterLabel.call(i,t,e))),a.push(o)}),a},getAfterBody:function(){return Ge(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var t=this._options.callbacks,e=t.beforeFooter.apply(this,arguments),i=t.footer.apply(this,arguments),n=t.afterFooter.apply(this,arguments),a=[];return a=Ye(a,Ue(e)),a=Ye(a,Ue(i)),a=Ye(a,Ue(n))},update:function(t){var e,i,n,a,o,r,s,l,d,u,h=this,c=h._options,f=h._model,g=h._model=Xe(c),p=h._active,m=h._data,v={xAlign:f.xAlign,yAlign:f.yAlign},b={x:f.x,y:f.y},x={width:f.width,height:f.height},y={x:f.caretX,y:f.caretY};if(p.length){g.opacity=1;var k=[],w=[];y=qe[c.position].call(h,p,h._eventPosition);var M=[];for(e=0,i=p.length;e<i;++e)M.push((n=p[e],a=void 0,o=void 0,r=void 0,s=void 0,l=void 0,d=void 0,u=void 0,a=n._xScale,o=n._yScale||n._scale,r=n._index,s=n._datasetIndex,l=n._chart.getDatasetMeta(s).controller,d=l._getIndexScale(),u=l._getValueScale(),{xLabel:a?a.getLabelForIndex(r,s):"",yLabel:o?o.getLabelForIndex(r,s):"",label:d?""+d.getLabelForIndex(r,s):"",value:u?""+u.getLabelForIndex(r,s):"",index:r,datasetIndex:s,x:n._model.x,y:n._model.y}));c.filter&&(M=M.filter(function(t){return c.filter(t,m)})),c.itemSort&&(M=M.sort(function(t,e){return c.itemSort(t,e,m)})),ut.each(M,function(t){k.push(c.callbacks.labelColor.call(h,t,h._chart)),w.push(c.callbacks.labelTextColor.call(h,t,h._chart))}),g.title=h.getTitle(M,m),g.beforeBody=h.getBeforeBody(M,m),g.body=h.getBody(M,m),g.afterBody=h.getAfterBody(M,m),g.footer=h.getFooter(M,m),g.x=y.x,g.y=y.y,g.caretPadding=c.caretPadding,g.labelColors=k,g.labelTextColors=w,g.dataPoints=M,x=function(t,e){var i=t._chart.ctx,n=2*e.yPadding,a=0,o=e.body,r=o.reduce(function(t,e){return t+e.before.length+e.lines.length+e.after.length},0);r+=e.beforeBody.length+e.afterBody.length;var s=e.title.length,l=e.footer.length,d=e.titleFontSize,u=e.bodyFontSize,h=e.footerFontSize;n+=s*d,n+=s?(s-1)*e.titleSpacing:0,n+=s?e.titleMarginBottom:0,n+=r*u,n+=r?(r-1)*e.bodySpacing:0,n+=l?e.footerMarginTop:0,n+=l*h,n+=l?(l-1)*e.footerSpacing:0;var c=0,f=function(t){a=Math.max(a,i.measureText(t).width+c)};return i.font=ut.fontString(d,e._titleFontStyle,e._titleFontFamily),ut.each(e.title,f),i.font=ut.fontString(u,e._bodyFontStyle,e._bodyFontFamily),ut.each(e.beforeBody.concat(e.afterBody),f),c=e.displayColors?u+2:0,ut.each(o,function(t){ut.each(t.before,f),ut.each(t.lines,f),ut.each(t.after,f)}),c=0,i.font=ut.fontString(h,e._footerFontStyle,e._footerFontFamily),ut.each(e.footer,f),{width:a+=2*e.xPadding,height:n}}(this,g),b=function(t,e,i,n){var a=t.x,o=t.y,r=t.caretSize,s=t.caretPadding,l=t.cornerRadius,d=i.xAlign,u=i.yAlign,h=r+s,c=l+s;return"right"===d?a-=e.width:"center"===d&&((a-=e.width/2)+e.width>n.width&&(a=n.width-e.width),a<0&&(a=0)),"top"===u?o+=h:o-="bottom"===u?e.height+h:e.height/2,"center"===u?"left"===d?a+=h:"right"===d&&(a-=h):"left"===d?a-=c:"right"===d&&(a+=c),{x:a,y:o}}(g,x,v=function(t,e){var i,n,a,o,r,s=t._model,l=t._chart,d=t._chart.chartArea,u="center",h="center";s.y<e.height?h="top":s.y>l.height-e.height&&(h="bottom");var c=(d.left+d.right)/2,f=(d.top+d.bottom)/2;"center"===h?(i=function(t){return t<=c},n=function(t){return t>c}):(i=function(t){return t<=e.width/2},n=function(t){return t>=l.width-e.width/2}),a=function(t){return t+e.width+s.caretSize+s.caretPadding>l.width},o=function(t){return t-e.width-s.caretSize-s.caretPadding<0},r=function(t){return t<=f?"top":"bottom"},i(s.x)?(u="left",a(s.x)&&(u="center",h=r(s.y))):n(s.x)&&(u="right",o(s.x)&&(u="center",h=r(s.y)));var g=t._options;return{xAlign:g.xAlign?g.xAlign:u,yAlign:g.yAlign?g.yAlign:h}}(this,x),h._chart)}else g.opacity=0;return g.xAlign=v.xAlign,g.yAlign=v.yAlign,g.x=b.x,g.y=b.y,g.width=x.width,g.height=x.height,g.caretX=y.x,g.caretY=y.y,h._model=g,t&&c.custom&&c.custom.call(h,g),h},drawCaret:function(t,e){var i=this._chart.ctx,n=this._view,a=this.getCaretPosition(t,e,n);i.lineTo(a.x1,a.y1),i.lineTo(a.x2,a.y2),i.lineTo(a.x3,a.y3)},getCaretPosition:function(t,e,i){var n,a,o,r,s,l,d=i.caretSize,u=i.cornerRadius,h=i.xAlign,c=i.yAlign,f=t.x,g=t.y,p=e.width,m=e.height;if("center"===c)s=g+m/2,"left"===h?(a=(n=f)-d,o=n,r=s+d,l=s-d):(a=(n=f+p)+d,o=n,r=s-d,l=s+d);else if("left"===h?(n=(a=f+u+d)-d,o=a+d):"right"===h?(n=(a=f+p-u-d)-d,o=a+d):(n=(a=i.caretX)-d,o=a+d),"top"===c)s=(r=g)-d,l=r;else{s=(r=g+m)+d,l=r;var v=o;o=n,n=v}return{x1:n,x2:a,x3:o,y1:r,y2:s,y3:l}},drawTitle:function(t,e,i){var n=e.title;if(n.length){t.x=Ke(e,e._titleAlign),i.textAlign=e._titleAlign,i.textBaseline="top";var a,o,r=e.titleFontSize,s=e.titleSpacing;for(i.fillStyle=e.titleFontColor,i.font=ut.fontString(r,e._titleFontStyle,e._titleFontFamily),a=0,o=n.length;a<o;++a)i.fillText(n[a],t.x,t.y),t.y+=r+s,a+1===n.length&&(t.y+=e.titleMarginBottom-s)}},drawBody:function(t,e,i){var n,a=e.bodyFontSize,o=e.bodySpacing,r=e._bodyAlign,s=e.body,l=e.displayColors,d=e.labelColors,u=0,h=l?Ke(e,"left"):0;i.textAlign=r,i.textBaseline="top",i.font=ut.fontString(a,e._bodyFontStyle,e._bodyFontFamily),t.x=Ke(e,r);var c=function(e){i.fillText(e,t.x+u,t.y),t.y+=a+o};i.fillStyle=e.bodyFontColor,ut.each(e.beforeBody,c),u=l&&"right"!==r?"center"===r?a/2+1:a+2:0,ut.each(s,function(o,r){n=e.labelTextColors[r],i.fillStyle=n,ut.each(o.before,c),ut.each(o.lines,function(o){l&&(i.fillStyle=e.legendColorBackground,i.fillRect(h,t.y,a,a),i.lineWidth=1,i.strokeStyle=d[r].borderColor,i.strokeRect(h,t.y,a,a),i.fillStyle=d[r].backgroundColor,i.fillRect(h+1,t.y+1,a-2,a-2),i.fillStyle=n),c(o)}),ut.each(o.after,c)}),u=0,ut.each(e.afterBody,c),t.y-=o},drawFooter:function(t,e,i){var n=e.footer;n.length&&(t.x=Ke(e,e._footerAlign),t.y+=e.footerMarginTop,i.textAlign=e._footerAlign,i.textBaseline="top",i.fillStyle=e.footerFontColor,i.font=ut.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),ut.each(n,function(n){i.fillText(n,t.x,t.y),t.y+=e.footerFontSize+e.footerSpacing}))},drawBackground:function(t,e,i,n){i.fillStyle=e.backgroundColor,i.strokeStyle=e.borderColor,i.lineWidth=e.borderWidth;var a=e.xAlign,o=e.yAlign,r=t.x,s=t.y,l=n.width,d=n.height,u=e.cornerRadius;i.beginPath(),i.moveTo(r+u,s),"top"===o&&this.drawCaret(t,n),i.lineTo(r+l-u,s),i.quadraticCurveTo(r+l,s,r+l,s+u),"center"===o&&"right"===a&&this.drawCaret(t,n),i.lineTo(r+l,s+d-u),i.quadraticCurveTo(r+l,s+d,r+l-u,s+d),"bottom"===o&&this.drawCaret(t,n),i.lineTo(r+u,s+d),i.quadraticCurveTo(r,s+d,r,s+d-u),"center"===o&&"left"===a&&this.drawCaret(t,n),i.lineTo(r,s+u),i.quadraticCurveTo(r,s,r+u,s),i.closePath(),i.fill(),e.borderWidth>0&&i.stroke()},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var i={width:e.width,height:e.height},n={x:e.x,y:e.y},a=Math.abs(e.opacity<.001)?0:e.opacity,o=e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length;this._options.enabled&&o&&(t.save(),t.globalAlpha=a,this.drawBackground(n,e,t,i),n.y+=e.yPadding,this.drawTitle(n,e,t),this.drawBody(n,e,t),this.drawFooter(n,e,t),t.restore())}},handleEvent:function(t){var e,i=this,n=i._options;return i._lastActive=i._lastActive||[],"mouseout"===t.type?i._active=[]:i._active=i._chart.getElementsAtEventForMode(t,n.mode,n),(e=!ut.arrayEquals(i._active,i._lastActive))&&(i._lastActive=i._active,(n.enabled||n.custom)&&(i._eventPosition={x:t.x,y:t.y},i.update(!0),i.pivot())),e}}),$e=qe,Je=Ze;Je.positioners=$e;var Qe=ut.valueOrDefault;function ti(){return ut.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){if("xAxes"===t||"yAxes"===t){var a,o,r,s=i[t].length;for(e[t]||(e[t]=[]),a=0;a<s;++a)r=i[t][a],o=Qe(r.type,"xAxes"===t?"category":"linear"),a>=e[t].length&&e[t].push({}),!e[t][a].type||r.type&&r.type!==e[t][a].type?ut.merge(e[t][a],[He.getScaleDefaults(o),r]):ut.merge(e[t][a],r)}else ut._merger(t,e,i,n)}})}function ei(){return ut.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){var a=e[t]||{},o=i[t];"scales"===t?e[t]=ti(a,o):"scale"===t?e[t]=ut.merge(a,[He.getScaleDefaults(o.type),o]):ut._merger(t,e,i,n)}})}function ii(t){return"top"===t||"bottom"===t}st._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var ni=function(t,e){return this.construct(t,e),this};ut.extend(ni.prototype,{construct:function(t,e){var i=this;e=function(t){var e=(t=t||{}).data=t.data||{};return e.datasets=e.datasets||[],e.labels=e.labels||[],t.options=ei(st.global,st[t.type],t.options||{}),t}(e);var n=Ve.acquireContext(t,e),a=n&&n.canvas,o=a&&a.height,r=a&&a.width;i.id=ut.uid(),i.ctx=n,i.canvas=a,i.config=e,i.width=r,i.height=o,i.aspectRatio=o?r/o:null,i.options=e.options,i._bufferedRender=!1,i.chart=i,i.controller=i,ni.instances[i.id]=i,Object.defineProperty(i,"data",{get:function(){return i.config.data},set:function(t){i.config.data=t}}),n&&a?(i.initialize(),i.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var t=this;return Ee.notify(t,"beforeInit"),ut.retinaScale(t,t.options.devicePixelRatio),t.bindEvents(),t.options.responsive&&t.resize(!0),t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),t.initToolTip(),Ee.notify(t,"afterInit"),t},clear:function(){return ut.canvas.clear(this),this},stop:function(){return bt.cancelAnimation(this),this},resize:function(t){var e=this,i=e.options,n=e.canvas,a=i.maintainAspectRatio&&e.aspectRatio||null,o=Math.max(0,Math.floor(ut.getMaximumWidth(n))),r=Math.max(0,Math.floor(a?o/a:ut.getMaximumHeight(n)));if((e.width!==o||e.height!==r)&&(n.width=e.width=o,n.height=e.height=r,n.style.width=o+"px",n.style.height=r+"px",ut.retinaScale(e,i.devicePixelRatio),!t)){var s={width:o,height:r};Ee.notify(e,"resize",[s]),i.onResize&&i.onResize(e,s),e.stop(),e.update({duration:i.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var t=this.options,e=t.scales||{},i=t.scale;ut.each(e.xAxes,function(t,e){t.id=t.id||"x-axis-"+e}),ut.each(e.yAxes,function(t,e){t.id=t.id||"y-axis-"+e}),i&&(i.id=i.id||"scale")},buildOrUpdateScales:function(){var t=this,e=t.options,i=t.scales||{},n=[],a=Object.keys(i).reduce(function(t,e){return t[e]=!1,t},{});e.scales&&(n=n.concat((e.scales.xAxes||[]).map(function(t){return{options:t,dtype:"category",dposition:"bottom"}}),(e.scales.yAxes||[]).map(function(t){return{options:t,dtype:"linear",dposition:"left"}}))),e.scale&&n.push({options:e.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),ut.each(n,function(e){var n=e.options,o=n.id,r=Qe(n.type,e.dtype);ii(n.position)!==ii(e.dposition)&&(n.position=e.dposition),a[o]=!0;var s=null;if(o in i&&i[o].type===r)(s=i[o]).options=n,s.ctx=t.ctx,s.chart=t;else{var l=He.getScaleConstructor(r);if(!l)return;s=new l({id:o,type:r,options:n,ctx:t.ctx,chart:t}),i[s.id]=s}s.mergeTicksOptions(),e.isDefault&&(t.scale=s)}),ut.each(a,function(t,e){t||delete i[e]}),t.scales=i,He.addScalesToLayout(this)},buildOrUpdateControllers:function(){var t=this,e=[];return ut.each(t.data.datasets,function(i,n){var a=t.getDatasetMeta(n),o=i.type||t.config.type;if(a.type&&a.type!==o&&(t.destroyDatasetMeta(n),a=t.getDatasetMeta(n)),a.type=o,a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{var r=ue[a.type];if(void 0===r)throw new Error('"'+a.type+'" is not a chart type.');a.controller=new r(t,n),e.push(a.controller)}},t),e},resetElements:function(){var t=this;ut.each(t.data.datasets,function(e,i){t.getDatasetMeta(i).controller.reset()},t)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var e,i,n=this;if(t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]}),i=(e=n).options,ut.each(e.scales,function(t){ke.removeBox(e,t)}),i=ei(st.global,st[e.config.type],i),e.options=e.config.options=i,e.ensureScalesHaveIDs(),e.buildOrUpdateScales(),e.tooltip._options=i.tooltips,e.tooltip.initialize(),Ee._invalidate(n),!1!==Ee.notify(n,"beforeUpdate")){n.tooltip._data=n.data;var a=n.buildOrUpdateControllers();ut.each(n.data.datasets,function(t,e){n.getDatasetMeta(e).controller.buildOrUpdateElements()},n),n.updateLayout(),n.options.animation&&n.options.animation.duration&&ut.each(a,function(t){t.reset()}),n.updateDatasets(),n.tooltip.initialize(),n.lastActive=[],Ee.notify(n,"afterUpdate"),n._bufferedRender?n._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:n.render(t)}},updateLayout:function(){!1!==Ee.notify(this,"beforeLayout")&&(ke.update(this,this.width,this.height),Ee.notify(this,"afterScaleUpdate"),Ee.notify(this,"afterLayout"))},updateDatasets:function(){if(!1!==Ee.notify(this,"beforeDatasetsUpdate")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);Ee.notify(this,"afterDatasetsUpdate")}},updateDataset:function(t){var e=this.getDatasetMeta(t),i={meta:e,index:t};!1!==Ee.notify(this,"beforeDatasetUpdate",[i])&&(e.controller.update(),Ee.notify(this,"afterDatasetUpdate",[i]))},render:function(t){var e=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var i=e.options.animation,n=Qe(t.duration,i&&i.duration),a=t.lazy;if(!1!==Ee.notify(e,"beforeRender")){var o=function(t){Ee.notify(e,"afterRender"),ut.callback(i&&i.onComplete,[t],e)};if(i&&n){var r=new vt({numSteps:n/16.66,easing:t.easing||i.easing,render:function(t,e){var i=ut.easing.effects[e.easing],n=e.currentStep,a=n/e.numSteps;t.draw(i(a),a,n)},onAnimationProgress:i.onProgress,onAnimationComplete:o});bt.addAnimation(e,r,n,a)}else e.draw(),o(new vt({numSteps:0,chart:e}));return e}},draw:function(t){var e=this;e.clear(),ut.isNullOrUndef(t)&&(t=1),e.transition(t),e.width<=0||e.height<=0||!1!==Ee.notify(e,"beforeDraw",[t])&&(ut.each(e.boxes,function(t){t.draw(e.chartArea)},e),e.drawDatasets(t),e._drawTooltip(t),Ee.notify(e,"afterDraw",[t]))},transition:function(t){for(var e=0,i=(this.data.datasets||[]).length;e<i;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},drawDatasets:function(t){var e=this;if(!1!==Ee.notify(e,"beforeDatasetsDraw",[t])){for(var i=(e.data.datasets||[]).length-1;i>=0;--i)e.isDatasetVisible(i)&&e.drawDataset(i,t);Ee.notify(e,"afterDatasetsDraw",[t])}},drawDataset:function(t,e){var i=this.getDatasetMeta(t),n={meta:i,index:t,easingValue:e};!1!==Ee.notify(this,"beforeDatasetDraw",[n])&&(i.controller.draw(e),Ee.notify(this,"afterDatasetDraw",[n]))},_drawTooltip:function(t){var e=this.tooltip,i={tooltip:e,easingValue:t};!1!==Ee.notify(this,"beforeTooltipDraw",[i])&&(e.draw(),Ee.notify(this,"afterTooltipDraw",[i]))},getElementAtEvent:function(t){return ve.modes.single(this,t)},getElementsAtEvent:function(t){return ve.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return ve.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,i){var n=ve.modes[e];return"function"==typeof n?n(this,t,i):[]},getDatasetAtEvent:function(t){return ve.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var i=e._meta[this.id];return i||(i=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,i=this.data.datasets.length;e<i;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,i=this.data.datasets[t],n=i._meta&&i._meta[e];n&&(n.controller.destroy(),delete i._meta[e])},destroy:function(){var t,e,i=this,n=i.canvas;for(i.stop(),t=0,e=i.data.datasets.length;t<e;++t)i.destroyDatasetMeta(t);n&&(i.unbindEvents(),ut.canvas.clear(i),Ve.releaseContext(i.ctx),i.canvas=null,i.ctx=null),Ee.notify(i,"destroy"),delete ni.instances[i.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var t=this;t.tooltip=new Je({_chart:t,_chartInstance:t,_data:t.data,_options:t.options.tooltips},t)},bindEvents:function(){var t=this,e=t._listeners={},i=function(){t.eventHandler.apply(t,arguments)};ut.each(t.options.events,function(n){Ve.addEventListener(t,n,i),e[n]=i}),t.options.responsive&&(i=function(){t.resize()},Ve.addEventListener(t,"resize",i),e.resize=i)},unbindEvents:function(){var t=this,e=t._listeners;e&&(delete t._listeners,ut.each(e,function(e,i){Ve.removeEventListener(t,i,e)}))},updateHoverStyle:function(t,e,i){var n,a,o,r=i?"setHoverStyle":"removeHoverStyle";for(a=0,o=t.length;a<o;++a)(n=t[a])&&this.getDatasetMeta(n._datasetIndex).controller[r](n)},eventHandler:function(t){var e=this,i=e.tooltip;if(!1!==Ee.notify(e,"beforeEvent",[t])){e._bufferedRender=!0,e._bufferedRequest=null;var n=e.handleEvent(t);i&&(n=i._start?i.handleEvent(t):n|i.handleEvent(t)),Ee.notify(e,"afterEvent",[t]);var a=e._bufferedRequest;return a?e.render(a):n&&!e.animating&&(e.stop(),e.render({duration:e.options.hover.animationDuration,lazy:!0})),e._bufferedRender=!1,e._bufferedRequest=null,e}},handleEvent:function(t){var e,i=this,n=i.options||{},a=n.hover;return i.lastActive=i.lastActive||[],"mouseout"===t.type?i.active=[]:i.active=i.getElementsAtEventForMode(t,a.mode,a),ut.callback(n.onHover||n.hover.onHover,[t.native,i.active],i),"mouseup"!==t.type&&"click"!==t.type||n.onClick&&n.onClick.call(i,t.native,i.active),i.lastActive.length&&i.updateHoverStyle(i.lastActive,a.mode,!1),i.active.length&&a.mode&&i.updateHoverStyle(i.active,a.mode,!0),e=!ut.arrayEquals(i.active,i.lastActive),i.lastActive=i.active,e}}),ni.instances={};var ai=ni;ni.Controller=ni,ni.types={},ut.configMerge=ei,ut.scaleMerge=ti;function oi(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function ri(t){this.options=t||{}}ut.extend(ri.prototype,{formats:oi,parse:oi,format:oi,add:oi,diff:oi,startOf:oi,endOf:oi,_create:function(t){return t}}),ri.override=function(t){ut.extend(ri.prototype,t)};var si={_date:ri},li={formatters:{values:function(t){return ut.isArray(t)?t:""+t},linear:function(t,e,i){var n=i.length>3?i[2]-i[1]:i[1]-i[0];Math.abs(n)>1&&t!==Math.floor(t)&&(n=t-Math.floor(t));var a=ut.log10(Math.abs(n)),o="";if(0!==t)if(Math.max(Math.abs(i[0]),Math.abs(i[i.length-1]))<1e-4){var r=ut.log10(Math.abs(t));o=t.toExponential(Math.floor(r)-Math.floor(a))}else{var s=-1*Math.floor(a);s=Math.max(Math.min(s,20),0),o=t.toFixed(s)}else o="0";return o},logarithmic:function(t,e,i){var n=t/Math.pow(10,Math.floor(ut.log10(t)));return 0===t?"0":1===n||2===n||5===n||0===e||e===i.length-1?t.toExponential():""}}},di=ut.valueOrDefault,ui=ut.valueAtIndexOrDefault;function hi(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(t[e].label);return n}function ci(t,e,i){return ut.isArray(e)?ut.longestText(t,i,e):t.measureText(e).width}st._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:li.formatters.values,minor:{},major:{}}});var fi=pt.extend({getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var t=this.options.ticks;for(var e in!1===t.minor&&(t.minor={display:!1}),!1===t.major&&(t.major={display:!1}),t)"major"!==e&&"minor"!==e&&(void 0===t.minor[e]&&(t.minor[e]=t[e]),void 0===t.major[e]&&(t.major[e]=t[e]))},beforeUpdate:function(){ut.callback(this.options.beforeUpdate,[this])},update:function(t,e,i){var n,a,o,r,s,l,d=this;for(d.beforeUpdate(),d.maxWidth=t,d.maxHeight=e,d.margins=ut.extend({left:0,right:0,top:0,bottom:0},i),d._maxLabelLines=0,d.longestLabelWidth=0,d.longestTextCache=d.longestTextCache||{},d.beforeSetDimensions(),d.setDimensions(),d.afterSetDimensions(),d.beforeDataLimits(),d.determineDataLimits(),d.afterDataLimits(),d.beforeBuildTicks(),s=d.buildTicks()||[],s=d.afterBuildTicks(s)||s,d.beforeTickToLabelConversion(),o=d.convertTicksToLabels(s)||d.ticks,d.afterTickToLabelConversion(),d.ticks=o,n=0,a=o.length;n<a;++n)r=o[n],(l=s[n])?l.label=r:s.push(l={label:r,major:!1});return d._ticks=s,d.beforeCalculateTickRotation(),d.calculateTickRotation(),d.afterCalculateTickRotation(),d.beforeFit(),d.fit(),d.afterFit(),d.afterUpdate(),d.minSize},afterUpdate:function(){ut.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){ut.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){ut.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){ut.callback(this.options.beforeDataLimits,[this])},determineDataLimits:ut.noop,afterDataLimits:function(){ut.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){ut.callback(this.options.beforeBuildTicks,[this])},buildTicks:ut.noop,afterBuildTicks:function(t){var e=this;return ut.isArray(t)&&t.length?ut.callback(e.options.afterBuildTicks,[e,t]):(e.ticks=ut.callback(e.options.afterBuildTicks,[e,e.ticks])||e.ticks,t)},beforeTickToLabelConversion:function(){ut.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this.options.ticks;this.ticks=this.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){ut.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){ut.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t=this,e=t.ctx,i=t.options.ticks,n=hi(t._ticks),a=ut.options._parseFont(i);e.font=a.string;var o=i.minRotation||0;if(n.length&&t.options.display&&t.isHorizontal())for(var r,s=ut.longestText(e,a.string,n,t.longestTextCache),l=s,d=t.getPixelForTick(1)-t.getPixelForTick(0)-6;l>d&&o<i.maxRotation;){var u=ut.toRadians(o);if(r=Math.cos(u),Math.sin(u)*s>t.maxHeight){o--;break}o++,l=r*s}t.labelRotation=o},afterCalculateTickRotation:function(){ut.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){ut.callback(this.options.beforeFit,[this])},fit:function(){var t=this,e=t.minSize={width:0,height:0},i=hi(t._ticks),n=t.options,a=n.ticks,o=n.scaleLabel,r=n.gridLines,s=t._isVisible(),l=n.position,d=t.isHorizontal(),u=ut.options._parseFont,h=u(a),c=n.gridLines.tickMarkLength;if(e.width=d?t.isFullWidth()?t.maxWidth-t.margins.left-t.margins.right:t.maxWidth:s&&r.drawTicks?c:0,e.height=d?s&&r.drawTicks?c:0:t.maxHeight,o.display&&s){var f=u(o),g=ut.options.toPadding(o.padding),p=f.lineHeight+g.height;d?e.height+=p:e.width+=p}if(a.display&&s){var m=ut.longestText(t.ctx,h.string,i,t.longestTextCache),v=ut.numberOfLabelLines(i),b=.5*h.size,x=t.options.ticks.padding;if(t._maxLabelLines=v,t.longestLabelWidth=m,d){var y=ut.toRadians(t.labelRotation),k=Math.cos(y),w=Math.sin(y)*m+h.lineHeight*v+b;e.height=Math.min(t.maxHeight,e.height+w+x),t.ctx.font=h.string;var M,_,C=ci(t.ctx,i[0],h.string),S=ci(t.ctx,i[i.length-1],h.string),P=t.getPixelForTick(0)-t.left,I=t.right-t.getPixelForTick(i.length-1);0!==t.labelRotation?(M="bottom"===l?k*C:k*b,_="bottom"===l?k*b:k*S):(M=C/2,_=S/2),t.paddingLeft=Math.max(M-P,0)+3,t.paddingRight=Math.max(_-I,0)+3}else a.mirror?m=0:m+=x+b,e.width=Math.min(t.maxWidth,e.width+m),t.paddingTop=h.size/2,t.paddingBottom=h.size/2}t.handleMargins(),t.width=e.width,t.height=e.height},handleMargins:function(){var t=this;t.margins&&(t.paddingLeft=Math.max(t.paddingLeft-t.margins.left,0),t.paddingTop=Math.max(t.paddingTop-t.margins.top,0),t.paddingRight=Math.max(t.paddingRight-t.margins.right,0),t.paddingBottom=Math.max(t.paddingBottom-t.margins.bottom,0))},afterFit:function(){ut.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(ut.isNullOrUndef(t))return NaN;if(("number"==typeof t||t instanceof Number)&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},getLabelForIndex:ut.noop,getPixelForValue:ut.noop,getValueForPixel:ut.noop,getPixelForTick:function(t){var e=this,i=e.options.offset;if(e.isHorizontal()){var n=(e.width-(e.paddingLeft+e.paddingRight))/Math.max(e._ticks.length-(i?0:1),1),a=n*t+e.paddingLeft;i&&(a+=n/2);var o=e.left+a;return o+=e.isFullWidth()?e.margins.left:0}var r=e.height-(e.paddingTop+e.paddingBottom);return e.top+t*(r/(e._ticks.length-1))},getPixelForDecimal:function(t){var e=this;if(e.isHorizontal()){var i=(e.width-(e.paddingLeft+e.paddingRight))*t+e.paddingLeft,n=e.left+i;return n+=e.isFullWidth()?e.margins.left:0}return e.top+t*e.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this.min,e=this.max;return this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0},_autoSkip:function(t){var e,i,n=this,a=n.isHorizontal(),o=n.options.ticks.minor,r=t.length,s=!1,l=o.maxTicksLimit,d=n._tickSize()*(r-1),u=a?n.width-(n.paddingLeft+n.paddingRight):n.height-(n.paddingTop+n.PaddingBottom),h=[];for(d>u&&(s=1+Math.floor(d/u)),r>l&&(s=Math.max(s,1+Math.floor(r/l))),e=0;e<r;e++)i=t[e],s>1&&e%s>0&&delete i.label,h.push(i);return h},_tickSize:function(){var t=this,e=t.isHorizontal(),i=t.options.ticks.minor,n=ut.toRadians(t.labelRotation),a=Math.abs(Math.cos(n)),o=Math.abs(Math.sin(n)),r=i.autoSkipPadding||0,s=t.longestLabelWidth+r||0,l=ut.options._parseFont(i),d=t._maxLabelLines*l.lineHeight+r||0;return e?d*a>s*o?s/a:d/o:d*o<s*a?d/a:s/o},_isVisible:function(){var t,e,i,n=this.chart,a=this.options.display;if("auto"!==a)return!!a;for(t=0,e=n.data.datasets.length;t<e;++t)if(n.isDatasetVisible(t)&&((i=n.getDatasetMeta(t)).xAxisID===this.id||i.yAxisID===this.id))return!0;return!1},draw:function(t){var e=this,i=e.options;if(e._isVisible()){var n,a,o,r=e.chart,s=e.ctx,l=st.global.defaultFontColor,d=i.ticks.minor,u=i.ticks.major||d,h=i.gridLines,c=i.scaleLabel,f=i.position,g=0!==e.labelRotation,p=d.mirror,m=e.isHorizontal(),v=ut.options._parseFont,b=d.display&&d.autoSkip?e._autoSkip(e.getTicks()):e.getTicks(),x=di(d.fontColor,l),y=v(d),k=y.lineHeight,w=di(u.fontColor,l),M=v(u),_=d.padding,C=d.labelOffset,S=h.drawTicks?h.tickMarkLength:0,P=di(c.fontColor,l),I=v(c),A=ut.options.toPadding(c.padding),D=ut.toRadians(e.labelRotation),T=[],F=h.drawBorder?ui(h.lineWidth,0,0):0,L=ut._alignPixel;"top"===f?(n=L(r,e.bottom,F),a=e.bottom-S,o=n-F/2):"bottom"===f?(n=L(r,e.top,F),a=n+F/2,o=e.top+S):"left"===f?(n=L(r,e.right,F),a=e.right-S,o=n-F/2):(n=L(r,e.left,F),a=n+F/2,o=e.left+S);if(ut.each(b,function(n,s){if(!ut.isNullOrUndef(n.label)){var l,d,u,c,v,b,x,y,w,M,P,I,A,R,O,z,B=n.label;s===e.zeroLineIndex&&i.offset===h.offsetGridLines?(l=h.zeroLineWidth,d=h.zeroLineColor,u=h.zeroLineBorderDash||[],c=h.zeroLineBorderDashOffset||0):(l=ui(h.lineWidth,s),d=ui(h.color,s),u=h.borderDash||[],c=h.borderDashOffset||0);var N=ut.isArray(B)?B.length:1,W=function(t,e,i){var n=t.getPixelForTick(e);return i&&(1===t.getTicks().length?n-=t.isHorizontal()?Math.max(n-t.left,t.right-n):Math.max(n-t.top,t.bottom-n):n-=0===e?(t.getPixelForTick(1)-n)/2:(n-t.getPixelForTick(e-1))/2),n}(e,s,h.offsetGridLines);if(m){var V=S+_;W<e.left-1e-7&&(d="rgba(0,0,0,0)"),v=x=w=P=L(r,W,l),b=a,y=o,A=e.getPixelForTick(s)+C,"top"===f?(M=L(r,t.top,F)+F/2,I=t.bottom,O=((g?1:.5)-N)*k,z=g?"left":"center",R=e.bottom-V):(M=t.top,I=L(r,t.bottom,F)-F/2,O=(g?0:.5)*k,z=g?"right":"center",R=e.top+V)}else{var E=(p?0:S)+_;W<e.top-1e-7&&(d="rgba(0,0,0,0)"),v=a,x=o,b=y=M=I=L(r,W,l),R=e.getPixelForTick(s)+C,O=(1-N)*k/2,"left"===f?(w=L(r,t.left,F)+F/2,P=t.right,z=p?"left":"right",A=e.right-E):(w=t.left,P=L(r,t.right,F)-F/2,z=p?"right":"left",A=e.left+E)}T.push({tx1:v,ty1:b,tx2:x,ty2:y,x1:w,y1:M,x2:P,y2:I,labelX:A,labelY:R,glWidth:l,glColor:d,glBorderDash:u,glBorderDashOffset:c,rotation:-1*D,label:B,major:n.major,textOffset:O,textAlign:z})}}),ut.each(T,function(t){var e=t.glWidth,i=t.glColor;if(h.display&&e&&i&&(s.save(),s.lineWidth=e,s.strokeStyle=i,s.setLineDash&&(s.setLineDash(t.glBorderDash),s.lineDashOffset=t.glBorderDashOffset),s.beginPath(),h.drawTicks&&(s.moveTo(t.tx1,t.ty1),s.lineTo(t.tx2,t.ty2)),h.drawOnChartArea&&(s.moveTo(t.x1,t.y1),s.lineTo(t.x2,t.y2)),s.stroke(),s.restore()),d.display){s.save(),s.translate(t.labelX,t.labelY),s.rotate(t.rotation),s.font=t.major?M.string:y.string,s.fillStyle=t.major?w:x,s.textBaseline="middle",s.textAlign=t.textAlign;var n=t.label,a=t.textOffset;if(ut.isArray(n))for(var o=0;o<n.length;++o)s.fillText(""+n[o],0,a),a+=k;else s.fillText(n,0,a);s.restore()}}),c.display){var R,O,z=0,B=I.lineHeight/2;if(m)R=e.left+(e.right-e.left)/2,O="bottom"===f?e.bottom-B-A.bottom:e.top+B+A.top;else{var N="left"===f;R=N?e.left+B+A.top:e.right-B-A.top,O=e.top+(e.bottom-e.top)/2,z=N?-.5*Math.PI:.5*Math.PI}s.save(),s.translate(R,O),s.rotate(z),s.textAlign="center",s.textBaseline="middle",s.fillStyle=P,s.font=I.string,s.fillText(c.labelString,0,0),s.restore()}if(F){var W,V,E,H,j=F,q=ui(h.lineWidth,b.length-1,0);m?(W=L(r,e.left,j)-j/2,V=L(r,e.right,q)+q/2,E=H=n):(E=L(r,e.top,j)-j/2,H=L(r,e.bottom,q)+q/2,W=V=n),s.lineWidth=F,s.strokeStyle=ui(h.color,0),s.beginPath(),s.moveTo(W,E),s.lineTo(V,H),s.stroke()}}}}),gi=fi.extend({getLabels:function(){var t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels},determineDataLimits:function(){var t,e=this,i=e.getLabels();e.minIndex=0,e.maxIndex=i.length-1,void 0!==e.options.ticks.min&&(t=i.indexOf(e.options.ticks.min),e.minIndex=-1!==t?t:e.minIndex),void 0!==e.options.ticks.max&&(t=i.indexOf(e.options.ticks.max),e.maxIndex=-1!==t?t:e.maxIndex),e.min=i[e.minIndex],e.max=i[e.maxIndex]},buildTicks:function(){var t=this,e=t.getLabels();t.ticks=0===t.minIndex&&t.maxIndex===e.length-1?e:e.slice(t.minIndex,t.maxIndex+1)},getLabelForIndex:function(t,e){var i=this,n=i.chart;return n.getDatasetMeta(e).controller._getValueScaleId()===i.id?i.getRightValue(n.data.datasets[e].data[t]):i.ticks[t-i.minIndex]},getPixelForValue:function(t,e){var i,n=this,a=n.options.offset,o=Math.max(n.maxIndex+1-n.minIndex-(a?0:1),1);if(null!=t&&(i=n.isHorizontal()?t.x:t.y),void 0!==i||void 0!==t&&isNaN(e)){t=i||t;var r=n.getLabels().indexOf(t);e=-1!==r?r:e}if(n.isHorizontal()){var s=n.width/o,l=s*(e-n.minIndex);return a&&(l+=s/2),n.left+l}var d=n.height/o,u=d*(e-n.minIndex);return a&&(u+=d/2),n.top+u},getPixelForTick:function(t){return this.getPixelForValue(this.ticks[t],t+this.minIndex,null)},getValueForPixel:function(t){var e=this,i=e.options.offset,n=Math.max(e._ticks.length-(i?0:1),1),a=e.isHorizontal(),o=(a?e.width:e.height)/n;return t-=a?e.left:e.top,i&&(t-=o/2),(t<=0?0:Math.round(t/o))+e.minIndex},getBasePixel:function(){return this.bottom}}),pi={position:"bottom"};gi._defaults=pi;var mi=ut.noop,vi=ut.isNullOrUndef;var bi=fi.extend({getRightValue:function(t){return"string"==typeof t?+t:fi.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;if(e.beginAtZero){var i=ut.sign(t.min),n=ut.sign(t.max);i<0&&n<0?t.max=0:i>0&&n>0&&(t.min=0)}var a=void 0!==e.min||void 0!==e.suggestedMin,o=void 0!==e.max||void 0!==e.suggestedMax;void 0!==e.min?t.min=e.min:void 0!==e.suggestedMin&&(null===t.min?t.min=e.suggestedMin:t.min=Math.min(t.min,e.suggestedMin)),void 0!==e.max?t.max=e.max:void 0!==e.suggestedMax&&(null===t.max?t.max=e.suggestedMax:t.max=Math.max(t.max,e.suggestedMax)),a!==o&&t.min>=t.max&&(a?t.max=t.min+1:t.min=t.max-1),t.min===t.max&&(t.max++,e.beginAtZero||t.min--)},getTickLimit:function(){var t,e=this.options.ticks,i=e.stepSize,n=e.maxTicksLimit;return i?t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1:(t=this._computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:mi,buildTicks:function(){var t=this,e=t.options.ticks,i=t.getTickLimit(),n={maxTicks:i=Math.max(2,i),min:e.min,max:e.max,precision:e.precision,stepSize:ut.valueOrDefault(e.fixedStepSize,e.stepSize)},a=t.ticks=function(t,e){var i,n,a,o,r=[],s=t.stepSize,l=s||1,d=t.maxTicks-1,u=t.min,h=t.max,c=t.precision,f=e.min,g=e.max,p=ut.niceNum((g-f)/d/l)*l;if(p<1e-14&&vi(u)&&vi(h))return[f,g];(o=Math.ceil(g/p)-Math.floor(f/p))>d&&(p=ut.niceNum(o*p/d/l)*l),s||vi(c)?i=Math.pow(10,ut._decimalPlaces(p)):(i=Math.pow(10,c),p=Math.ceil(p*i)/i),n=Math.floor(f/p)*p,a=Math.ceil(g/p)*p,s&&(!vi(u)&&ut.almostWhole(u/p,p/1e3)&&(n=u),!vi(h)&&ut.almostWhole(h/p,p/1e3)&&(a=h)),o=(a-n)/p,o=ut.almostEquals(o,Math.round(o),p/1e3)?Math.round(o):Math.ceil(o),n=Math.round(n*i)/i,a=Math.round(a*i)/i,r.push(vi(u)?n:u);for(var m=1;m<o;++m)r.push(Math.round((n+m*p)*i)/i);return r.push(vi(h)?a:h),r}(n,t);t.handleDirectionalChanges(),t.max=ut.max(a),t.min=ut.min(a),e.reverse?(a.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),fi.prototype.convertTicksToLabels.call(t)}}),xi={position:"left",ticks:{callback:li.formatters.linear}},yi=bi.extend({determineDataLimits:function(){var t=this,e=t.options,i=t.chart,n=i.data.datasets,a=t.isHorizontal();function o(e){return a?e.xAxisID===t.id:e.yAxisID===t.id}t.min=null,t.max=null;var r=e.stacked;if(void 0===r&&ut.each(n,function(t,e){if(!r){var n=i.getDatasetMeta(e);i.isDatasetVisible(e)&&o(n)&&void 0!==n.stack&&(r=!0)}}),e.stacked||r){var s={};ut.each(n,function(n,a){var r=i.getDatasetMeta(a),l=[r.type,void 0===e.stacked&&void 0===r.stack?a:"",r.stack].join(".");void 0===s[l]&&(s[l]={positiveValues:[],negativeValues:[]});var d=s[l].positiveValues,u=s[l].negativeValues;i.isDatasetVisible(a)&&o(r)&&ut.each(n.data,function(i,n){var a=+t.getRightValue(i);isNaN(a)||r.data[n].hidden||(d[n]=d[n]||0,u[n]=u[n]||0,e.relativePoints?d[n]=100:a<0?u[n]+=a:d[n]+=a)})}),ut.each(s,function(e){var i=e.positiveValues.concat(e.negativeValues),n=ut.min(i),a=ut.max(i);t.min=null===t.min?n:Math.min(t.min,n),t.max=null===t.max?a:Math.max(t.max,a)})}else ut.each(n,function(e,n){var a=i.getDatasetMeta(n);i.isDatasetVisible(n)&&o(a)&&ut.each(e.data,function(e,i){var n=+t.getRightValue(e);isNaN(n)||a.data[i].hidden||(null===t.min?t.min=n:n<t.min&&(t.min=n),null===t.max?t.max=n:n>t.max&&(t.max=n))})});t.min=isFinite(t.min)&&!isNaN(t.min)?t.min:0,t.max=isFinite(t.max)&&!isNaN(t.max)?t.max:1,this.handleTickRangeOptions()},_computeTickLimit:function(){var t;return this.isHorizontal()?Math.ceil(this.width/40):(t=ut.options._parseFont(this.options.ticks),Math.ceil(this.height/t.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){var e=this,i=e.start,n=+e.getRightValue(t),a=e.end-i;return e.isHorizontal()?e.left+e.width/a*(n-i):e.bottom-e.height/a*(n-i)},getValueForPixel:function(t){var e=this,i=e.isHorizontal(),n=i?e.width:e.height,a=(i?t-e.left:e.bottom-t)/n;return e.start+(e.end-e.start)*a},getPixelForTick:function(t){return this.getPixelForValue(this.ticksAsNumbers[t])}}),ki=xi;yi._defaults=ki;var wi=ut.valueOrDefault;var Mi={position:"left",ticks:{callback:li.formatters.logarithmic}};function _i(t,e){return ut.isFinite(t)&&t>=0?t:e}var Ci=fi.extend({determineDataLimits:function(){var t=this,e=t.options,i=t.chart,n=i.data.datasets,a=t.isHorizontal();function o(e){return a?e.xAxisID===t.id:e.yAxisID===t.id}t.min=null,t.max=null,t.minNotZero=null;var r=e.stacked;if(void 0===r&&ut.each(n,function(t,e){if(!r){var n=i.getDatasetMeta(e);i.isDatasetVisible(e)&&o(n)&&void 0!==n.stack&&(r=!0)}}),e.stacked||r){var s={};ut.each(n,function(n,a){var r=i.getDatasetMeta(a),l=[r.type,void 0===e.stacked&&void 0===r.stack?a:"",r.stack].join(".");i.isDatasetVisible(a)&&o(r)&&(void 0===s[l]&&(s[l]=[]),ut.each(n.data,function(e,i){var n=s[l],a=+t.getRightValue(e);isNaN(a)||r.data[i].hidden||a<0||(n[i]=n[i]||0,n[i]+=a)}))}),ut.each(s,function(e){if(e.length>0){var i=ut.min(e),n=ut.max(e);t.min=null===t.min?i:Math.min(t.min,i),t.max=null===t.max?n:Math.max(t.max,n)}})}else ut.each(n,function(e,n){var a=i.getDatasetMeta(n);i.isDatasetVisible(n)&&o(a)&&ut.each(e.data,function(e,i){var n=+t.getRightValue(e);isNaN(n)||a.data[i].hidden||n<0||(null===t.min?t.min=n:n<t.min&&(t.min=n),null===t.max?t.max=n:n>t.max&&(t.max=n),0!==n&&(null===t.minNotZero||n<t.minNotZero)&&(t.minNotZero=n))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;t.min=_i(e.min,t.min),t.max=_i(e.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(ut.log10(t.min))-1),t.max=Math.pow(10,Math.floor(ut.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(ut.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(ut.log10(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(ut.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,e=t.options.ticks,i=!t.isHorizontal(),n={min:_i(e.min),max:_i(e.max)},a=t.ticks=function(t,e){var i,n,a=[],o=wi(t.min,Math.pow(10,Math.floor(ut.log10(e.min)))),r=Math.floor(ut.log10(e.max)),s=Math.ceil(e.max/Math.pow(10,r));0===o?(i=Math.floor(ut.log10(e.minNotZero)),n=Math.floor(e.minNotZero/Math.pow(10,i)),a.push(o),o=n*Math.pow(10,i)):(i=Math.floor(ut.log10(o)),n=Math.floor(o/Math.pow(10,i)));var l=i<0?Math.pow(10,Math.abs(i)):1;do{a.push(o),10==++n&&(n=1,l=++i>=0?1:l),o=Math.round(n*Math.pow(10,i)*l)/l}while(i<r||i===r&&n<s);var d=wi(t.max,o);return a.push(d),a}(n,t);t.max=ut.max(a),t.min=ut.min(a),e.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&a.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),fi.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var e=Math.floor(ut.log10(t));return Math.floor(t/Math.pow(10,e))*Math.pow(10,e)},getPixelForValue:function(t){var e,i,n,a,o,r=this,s=r.options.ticks,l=s.reverse,d=ut.log10,u=r._getFirstTickValue(r.minNotZero),h=0;return t=+r.getRightValue(t),l?(n=r.end,a=r.start,o=-1):(n=r.start,a=r.end,o=1),r.isHorizontal()?(e=r.width,i=l?r.right:r.left):(e=r.height,o*=-1,i=l?r.top:r.bottom),t!==n&&(0===n&&(e-=h=wi(s.fontSize,st.global.defaultFontSize),n=u),0!==t&&(h+=e/(d(a)-d(n))*(d(t)-d(n))),i+=o*h),i},getValueForPixel:function(t){var e,i,n,a,o=this,r=o.options.ticks,s=r.reverse,l=ut.log10,d=o._getFirstTickValue(o.minNotZero);if(s?(i=o.end,n=o.start):(i=o.start,n=o.end),o.isHorizontal()?(e=o.width,a=s?o.right-t:t-o.left):(e=o.height,a=s?t-o.top:o.bottom-t),a!==i){if(0===i){var u=wi(r.fontSize,st.global.defaultFontSize);a-=u,e-=u,i=d}a*=l(n)-l(i),a/=e,a=Math.pow(10,l(i)+a)}return a}}),Si=Mi;Ci._defaults=Si;var Pi=ut.valueOrDefault,Ii=ut.valueAtIndexOrDefault,Ai=ut.options.resolve,Di={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:li.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function Ti(t){var e=t.options;return e.angleLines.display||e.pointLabels.display?t.chart.data.labels.length:0}function Fi(t){var e=t.ticks;return e.display&&t.display?Pi(e.fontSize,st.global.defaultFontSize)+2*e.backdropPaddingY:0}function Li(t,e,i,n,a){return t===n||t===a?{start:e-i/2,end:e+i/2}:t<n||t>a?{start:e-i,end:e}:{start:e,end:e+i}}function Ri(t){return 0===t||180===t?"center":t<180?"left":"right"}function Oi(t,e,i,n){var a,o,r=i.y+n/2;if(ut.isArray(e))for(a=0,o=e.length;a<o;++a)t.fillText(e[a],i.x,r),r+=n;else t.fillText(e,i.x,r)}function zi(t,e,i){90===t||270===t?i.y-=e.h/2:(t>270||t<90)&&(i.y-=e.h)}function Bi(t){return ut.isNumber(t)?t:0}var Ni=bi.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=Fi(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var t=this,e=t.chart,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;ut.each(e.data.datasets,function(a,o){if(e.isDatasetVisible(o)){var r=e.getDatasetMeta(o);ut.each(a.data,function(e,a){var o=+t.getRightValue(e);isNaN(o)||r.data[a].hidden||(i=Math.min(o,i),n=Math.max(o,n))})}}),t.min=i===Number.POSITIVE_INFINITY?0:i,t.max=n===Number.NEGATIVE_INFINITY?0:n,t.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Fi(this.options))},convertTicksToLabels:function(){var t=this;bi.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(t.options.pointLabels.callback,t)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,i,n,a=ut.options._parseFont(t.options.pointLabels),o={l:0,r:t.width,t:0,b:t.height-t.paddingTop},r={};t.ctx.font=a.string,t._pointLabelSizes=[];var s,l,d,u=Ti(t);for(e=0;e<u;e++){n=t.getPointPosition(e,t.drawingArea+5),s=t.ctx,l=a.lineHeight,d=t.pointLabels[e]||"",i=ut.isArray(d)?{w:ut.longestText(s,s.font,d),h:d.length*l}:{w:s.measureText(d).width,h:l},t._pointLabelSizes[e]=i;var h=t.getIndexAngle(e),c=ut.toDegrees(h)%360,f=Li(c,n.x,i.w,0,180),g=Li(c,n.y,i.h,90,270);f.start<o.l&&(o.l=f.start,r.l=h),f.end>o.r&&(o.r=f.end,r.r=h),g.start<o.t&&(o.t=g.start,r.t=h),g.end>o.b&&(o.b=g.end,r.b=h)}t.setReductions(t.drawingArea,o,r)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,i){var n=this,a=e.l/Math.sin(i.l),o=Math.max(e.r-n.width,0)/Math.sin(i.r),r=-e.t/Math.cos(i.t),s=-Math.max(e.b-(n.height-n.paddingTop),0)/Math.cos(i.b);a=Bi(a),o=Bi(o),r=Bi(r),s=Bi(s),n.drawingArea=Math.min(Math.floor(t-(a+o)/2),Math.floor(t-(r+s)/2)),n.setCenterPoint(a,o,r,s)},setCenterPoint:function(t,e,i,n){var a=this,o=a.width-e-a.drawingArea,r=t+a.drawingArea,s=i+a.drawingArea,l=a.height-a.paddingTop-n-a.drawingArea;a.xCenter=Math.floor((r+o)/2+a.left),a.yCenter=Math.floor((s+l)/2+a.top+a.paddingTop)},getIndexAngle:function(t){return t*(2*Math.PI/Ti(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var i=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*i:(t-e.min)*i},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this.min,e=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0)},draw:function(){var t=this,e=t.options,i=e.gridLines,n=e.ticks;if(e.display){var a=t.ctx,o=this.getIndexAngle(0),r=ut.options._parseFont(n);(e.angleLines.display||e.pointLabels.display)&&function(t){var e=t.ctx,i=t.options,n=i.angleLines,a=i.gridLines,o=i.pointLabels,r=Pi(n.lineWidth,a.lineWidth),s=Pi(n.color,a.color),l=Fi(i);e.save(),e.lineWidth=r,e.strokeStyle=s,e.setLineDash&&(e.setLineDash(Ai([n.borderDash,a.borderDash,[]])),e.lineDashOffset=Ai([n.borderDashOffset,a.borderDashOffset,0]));var d=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),u=ut.options._parseFont(o);e.font=u.string,e.textBaseline="middle";for(var h=Ti(t)-1;h>=0;h--){if(n.display&&r&&s){var c=t.getPointPosition(h,d);e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(c.x,c.y),e.stroke()}if(o.display){var f=0===h?l/2:0,g=t.getPointPosition(h,d+f+5),p=Ii(o.fontColor,h,st.global.defaultFontColor);e.fillStyle=p;var m=t.getIndexAngle(h),v=ut.toDegrees(m);e.textAlign=Ri(v),zi(v,t._pointLabelSizes[h],g),Oi(e,t.pointLabels[h]||"",g,u.lineHeight)}}e.restore()}(t),ut.each(t.ticks,function(e,s){if(s>0||n.reverse){var l=t.getDistanceFromCenterForValue(t.ticksAsNumbers[s]);if(i.display&&0!==s&&function(t,e,i,n){var a,o=t.ctx,r=e.circular,s=Ti(t),l=Ii(e.color,n-1),d=Ii(e.lineWidth,n-1);if((r||s)&&l&&d){if(o.save(),o.strokeStyle=l,o.lineWidth=d,o.setLineDash&&(o.setLineDash(e.borderDash||[]),o.lineDashOffset=e.borderDashOffset||0),o.beginPath(),r)o.arc(t.xCenter,t.yCenter,i,0,2*Math.PI);else{a=t.getPointPosition(0,i),o.moveTo(a.x,a.y);for(var u=1;u<s;u++)a=t.getPointPosition(u,i),o.lineTo(a.x,a.y)}o.closePath(),o.stroke(),o.restore()}}(t,i,l,s),n.display){var d=Pi(n.fontColor,st.global.defaultFontColor);if(a.font=r.string,a.save(),a.translate(t.xCenter,t.yCenter),a.rotate(o),n.showLabelBackdrop){var u=a.measureText(e).width;a.fillStyle=n.backdropColor,a.fillRect(-u/2-n.backdropPaddingX,-l-r.size/2-n.backdropPaddingY,u+2*n.backdropPaddingX,r.size+2*n.backdropPaddingY)}a.textAlign="center",a.textBaseline="middle",a.fillStyle=d,a.fillText(e,0,-l),a.restore()}}})}}}),Wi=Di;Ni._defaults=Wi;var Vi=ut.valueOrDefault,Ei=Number.MIN_SAFE_INTEGER||-9007199254740991,Hi=Number.MAX_SAFE_INTEGER||9007199254740991,ji={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},qi=Object.keys(ji);function Yi(t,e){return t-e}function Ui(t){var e,i,n,a={},o=[];for(e=0,i=t.length;e<i;++e)a[n=t[e]]||(a[n]=!0,o.push(n));return o}function Xi(t,e,i,n){var a=function(t,e,i){for(var n,a,o,r=0,s=t.length-1;r>=0&&r<=s;){if(a=t[(n=r+s>>1)-1]||null,o=t[n],!a)return{lo:null,hi:o};if(o[e]<i)r=n+1;else{if(!(a[e]>i))return{lo:a,hi:o};s=n-1}}return{lo:o,hi:null}}(t,e,i),o=a.lo?a.hi?a.lo:t[t.length-2]:t[0],r=a.lo?a.hi?a.hi:t[t.length-1]:t[1],s=r[e]-o[e],l=s?(i-o[e])/s:0,d=(r[n]-o[n])*l;return o[n]+d}function Ki(t,e){var i=t._adapter,n=t.options.time,a=n.parser,o=a||n.format,r=e;return"function"==typeof a&&(r=a(r)),ut.isFinite(r)||(r="string"==typeof o?i.parse(r,o):i.parse(r)),null!==r?+r:(a||"function"!=typeof o||(r=o(e),ut.isFinite(r)||(r=i.parse(r))),r)}function Gi(t,e){if(ut.isNullOrUndef(e))return null;var i=t.options.time,n=Ki(t,t.getRightValue(e));return null===n?n:(i.round&&(n=+t._adapter.startOf(n,i.round)),n)}function Zi(t){for(var e=qi.indexOf(t)+1,i=qi.length;e<i;++e)if(ji[qi[e]].common)return qi[e]}function $i(t,e,i,n){var a,o=t._adapter,r=t.options,s=r.time,l=s.unit||function(t,e,i,n){var a,o,r,s=qi.length;for(a=qi.indexOf(t);a<s-1;++a)if(r=(o=ji[qi[a]]).steps?o.steps[o.steps.length-1]:Hi,o.common&&Math.ceil((i-e)/(r*o.size))<=n)return qi[a];return qi[s-1]}(s.minUnit,e,i,n),d=Zi(l),u=Vi(s.stepSize,s.unitStepSize),h="week"===l&&s.isoWeekday,c=r.ticks.major.enabled,f=ji[l],g=e,p=i,m=[];for(u||(u=function(t,e,i,n){var a,o,r,s=e-t,l=ji[i],d=l.size,u=l.steps;if(!u)return Math.ceil(s/(n*d));for(a=0,o=u.length;a<o&&(r=u[a],!(Math.ceil(s/(d*r))<=n));++a);return r}(e,i,l,n)),h&&(g=+o.startOf(g,"isoWeek",h),p=+o.startOf(p,"isoWeek",h)),g=+o.startOf(g,h?"day":l),(p=+o.startOf(p,h?"day":l))<i&&(p=+o.add(p,1,l)),a=g,c&&d&&!h&&!s.round&&(a=+o.startOf(a,d),a=+o.add(a,~~((g-a)/(f.size*u))*u,l));a<p;a=+o.add(a,u,l))m.push(+a);return m.push(+a),m}var Ji=fi.extend({initialize:function(){this.mergeTicksOptions(),fi.prototype.initialize.call(this)},update:function(){var t=this.options,e=t.time||(t.time={}),i=this._adapter=new si._date(t.adapters.date);return e.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),ut.mergeIf(e.displayFormats,i.formats()),fi.prototype.update.apply(this,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),fi.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t,e,i,n,a,o,r=this,s=r.chart,l=r._adapter,d=r.options.time,u=d.unit||"day",h=Hi,c=Ei,f=[],g=[],p=[],m=s.data.labels||[];for(t=0,i=m.length;t<i;++t)p.push(Gi(r,m[t]));for(t=0,i=(s.data.datasets||[]).length;t<i;++t)if(s.isDatasetVisible(t))if(a=s.data.datasets[t].data,ut.isObject(a[0]))for(g[t]=[],e=0,n=a.length;e<n;++e)o=Gi(r,a[e]),f.push(o),g[t][e]=o;else{for(e=0,n=p.length;e<n;++e)f.push(p[e]);g[t]=p.slice(0)}else g[t]=[];p.length&&(p=Ui(p).sort(Yi),h=Math.min(h,p[0]),c=Math.max(c,p[p.length-1])),f.length&&(f=Ui(f).sort(Yi),h=Math.min(h,f[0]),c=Math.max(c,f[f.length-1])),h=Gi(r,d.min)||h,c=Gi(r,d.max)||c,h=h===Hi?+l.startOf(Date.now(),u):h,c=c===Ei?+l.endOf(Date.now(),u)+1:c,r.min=Math.min(h,c),r.max=Math.max(h+1,c),r._horizontal=r.isHorizontal(),r._table=[],r._timestamps={data:f,datasets:g,labels:p}},buildTicks:function(){var t,e,i,n=this,a=n.min,o=n.max,r=n.options,s=r.time,l=[],d=[];switch(r.ticks.source){case"data":l=n._timestamps.data;break;case"labels":l=n._timestamps.labels;break;case"auto":default:l=$i(n,a,o,n.getLabelCapacity(a))}for("ticks"===r.bounds&&l.length&&(a=l[0],o=l[l.length-1]),a=Gi(n,s.min)||a,o=Gi(n,s.max)||o,t=0,e=l.length;t<e;++t)(i=l[t])>=a&&i<=o&&d.push(i);return n.min=a,n.max=o,n._unit=s.unit||function(t,e,i,n,a){var o,r;for(o=qi.length-1;o>=qi.indexOf(i);o--)if(r=qi[o],ji[r].common&&t._adapter.diff(a,n,r)>=e.length)return r;return qi[i?qi.indexOf(i):0]}(n,d,s.minUnit,n.min,n.max),n._majorUnit=Zi(n._unit),n._table=function(t,e,i,n){if("linear"===n||!t.length)return[{time:e,pos:0},{time:i,pos:1}];var a,o,r,s,l,d=[],u=[e];for(a=0,o=t.length;a<o;++a)(s=t[a])>e&&s<i&&u.push(s);for(u.push(i),a=0,o=u.length;a<o;++a)l=u[a+1],r=u[a-1],s=u[a],void 0!==r&&void 0!==l&&Math.round((l+r)/2)===s||d.push({time:s,pos:a/(o-1)});return d}(n._timestamps.data,a,o,r.distribution),n._offsets=function(t,e,i,n,a){var o,r,s=0,l=0;return a.offset&&e.length&&(a.time.min||(o=Xi(t,"time",e[0],"pos"),s=1===e.length?1-o:(Xi(t,"time",e[1],"pos")-o)/2),a.time.max||(r=Xi(t,"time",e[e.length-1],"pos"),l=1===e.length?r:(r-Xi(t,"time",e[e.length-2],"pos"))/2)),{start:s,end:l}}(n._table,d,0,0,r),r.ticks.reverse&&d.reverse(),function(t,e,i){var n,a,o,r,s=[];for(n=0,a=e.length;n<a;++n)o=e[n],r=!!i&&o===+t._adapter.startOf(o,i),s.push({value:o,major:r});return s}(n,d,n._majorUnit)},getLabelForIndex:function(t,e){var i=this,n=i._adapter,a=i.chart.data,o=i.options.time,r=a.labels&&t<a.labels.length?a.labels[t]:"",s=a.datasets[e].data[t];return ut.isObject(s)&&(r=i.getRightValue(s)),o.tooltipFormat?n.format(Ki(i,r),o.tooltipFormat):"string"==typeof r?r:n.format(Ki(i,r),o.displayFormats.datetime)},tickFormatFunction:function(t,e,i,n){var a=this._adapter,o=this.options,r=o.time.displayFormats,s=r[this._unit],l=this._majorUnit,d=r[l],u=+a.startOf(t,l),h=o.ticks.major,c=h.enabled&&l&&d&&t===u,f=a.format(t,n||(c?d:s)),g=c?h:o.ticks.minor,p=Vi(g.callback,g.userCallback);return p?p(f,e,i):f},convertTicksToLabels:function(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(this.tickFormatFunction(t[e].value,e,t));return n},getPixelForOffset:function(t){var e=this,i=e.options.ticks.reverse,n=e._horizontal?e.width:e.height,a=e._horizontal?i?e.right:e.left:i?e.bottom:e.top,o=Xi(e._table,"time",t,"pos"),r=n*(e._offsets.start+o)/(e._offsets.start+1+e._offsets.end);return i?a-r:a+r},getPixelForValue:function(t,e,i){var n=null;if(void 0!==e&&void 0!==i&&(n=this._timestamps.datasets[i][e]),null===n&&(n=Gi(this,t)),null!==n)return this.getPixelForOffset(n)},getPixelForTick:function(t){var e=this.getTicks();return t>=0&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this,i=e._horizontal?e.width:e.height,n=e._horizontal?e.left:e.top,a=(i?(t-n)/i:0)*(e._offsets.start+1+e._offsets.start)-e._offsets.end,o=Xi(e._table,"pos",a,"time");return e._adapter._create(o)},getLabelWidth:function(t){var e=this.options.ticks,i=this.ctx.measureText(t).width,n=ut.toRadians(e.maxRotation),a=Math.cos(n),o=Math.sin(n);return i*a+Vi(e.fontSize,st.global.defaultFontSize)*o},getLabelCapacity:function(t){var e=this,i=e.options.time.displayFormats.millisecond,n=e.tickFormatFunction(t,0,[],i),a=e.getLabelWidth(n),o=e.isHorizontal()?e.width:e.height,r=Math.floor(o/a);return r>0?r:1}}),Qi={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};Ji._defaults=Qi;var tn={category:gi,linear:yi,logarithmic:Ci,radialLinear:Ni,time:Ji},en={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};si._date.override("function"==typeof t?{_id:"moment",formats:function(){return en},parse:function(e,i){return"string"==typeof e&&"string"==typeof i?e=t(e,i):e instanceof t||(e=t(e)),e.isValid()?e.valueOf():null},format:function(e,i){return t(e).format(i)},add:function(e,i,n){return t(e).add(i,n).valueOf()},diff:function(e,i,n){return t.duration(t(e).diff(t(i))).as(n)},startOf:function(e,i,n){return e=t(e),"isoWeek"===i?e.isoWeekday(n).valueOf():e.startOf(i).valueOf()},endOf:function(e,i){return t(e).endOf(i).valueOf()},_create:function(e){return t(e)}}:{}),st._set("global",{plugins:{filler:{propagate:!0}}});var nn={dataset:function(t){var e=t.fill,i=t.chart,n=i.getDatasetMeta(e),a=n&&i.isDatasetVisible(e)&&n.dataset._children||[],o=a.length||0;return o?function(t,e){return e<o&&a[e]._view||null}:null},boundary:function(t){var e=t.boundary,i=e?e.x:null,n=e?e.y:null;return function(t){return{x:null===i?t.x:i,y:null===n?t.y:n}}}};function an(t,e,i){var n,a=t._model||{},o=a.fill;if(void 0===o&&(o=!!a.backgroundColor),!1===o||null===o)return!1;if(!0===o)return"origin";if(n=parseFloat(o,10),isFinite(n)&&Math.floor(n)===n)return"-"!==o[0]&&"+"!==o[0]||(n=e+n),!(n===e||n<0||n>=i)&&n;switch(o){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return o;default:return!1}}function on(t){var e,i=t.el._model||{},n=t.el._scale||{},a=t.fill,o=null;if(isFinite(a))return null;if("start"===a?o=void 0===i.scaleBottom?n.bottom:i.scaleBottom:"end"===a?o=void 0===i.scaleTop?n.top:i.scaleTop:void 0!==i.scaleZero?o=i.scaleZero:n.getBasePosition?o=n.getBasePosition():n.getBasePixel&&(o=n.getBasePixel()),null!=o){if(void 0!==o.x&&void 0!==o.y)return o;if(ut.isFinite(o))return{x:(e=n.isHorizontal())?o:null,y:e?null:o}}return null}function rn(t,e,i){var n,a=t[e].fill,o=[e];if(!i)return a;for(;!1!==a&&-1===o.indexOf(a);){if(!isFinite(a))return a;if(!(n=t[a]))return!1;if(n.visible)return a;o.push(a),a=n.fill}return!1}function sn(t){var e=t.fill,i="dataset";return!1===e?null:(isFinite(e)||(i="boundary"),nn[i](t))}function ln(t){return t&&!t.skip}function dn(t,e,i,n,a){var o;if(n&&a){for(t.moveTo(e[0].x,e[0].y),o=1;o<n;++o)ut.canvas.lineTo(t,e[o-1],e[o]);for(t.lineTo(i[a-1].x,i[a-1].y),o=a-1;o>0;--o)ut.canvas.lineTo(t,i[o],i[o-1],!0)}}var un={id:"filler",afterDatasetsUpdate:function(t,e){var i,n,a,o,r=(t.data.datasets||[]).length,s=e.propagate,l=[];for(n=0;n<r;++n)o=null,(a=(i=t.getDatasetMeta(n)).dataset)&&a._model&&a instanceof Wt.Line&&(o={visible:t.isDatasetVisible(n),fill:an(a,n,r),chart:t,el:a}),i.$filler=o,l.push(o);for(n=0;n<r;++n)(o=l[n])&&(o.fill=rn(l,n,s),o.boundary=on(o),o.mapper=sn(o))},beforeDatasetDraw:function(t,e){var i=e.meta.$filler;if(i){var n=t.ctx,a=i.el,o=a._view,r=a._children||[],s=i.mapper,l=o.backgroundColor||st.global.defaultColor;s&&l&&r.length&&(ut.canvas.clipArea(n,t.chartArea),function(t,e,i,n,a,o){var r,s,l,d,u,h,c,f=e.length,g=n.spanGaps,p=[],m=[],v=0,b=0;for(t.beginPath(),r=0,s=f+!!o;r<s;++r)u=i(d=e[l=r%f]._view,l,n),h=ln(d),c=ln(u),h&&c?(v=p.push(d),b=m.push(u)):v&&b&&(g?(h&&p.push(d),c&&m.push(u)):(dn(t,p,m,v,b),v=b=0,p=[],m=[]));dn(t,p,m,v,b),t.closePath(),t.fillStyle=a,t.fill()}(n,r,s,o,l,a._loop),ut.canvas.unclipArea(n))}}},hn=ut.noop,cn=ut.valueOrDefault;function fn(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}st._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(t,e){var i=e.datasetIndex,n=this.chart,a=n.getDatasetMeta(i);a.hidden=null===a.hidden?!n.data.datasets[i].hidden:null,n.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(t){var e=t.data;return ut.isArray(e.datasets)?e.datasets.map(function(e,i){return{text:e.label,fillStyle:ut.isArray(e.backgroundColor)?e.backgroundColor[0]:e.backgroundColor,hidden:!t.isDatasetVisible(i),lineCap:e.borderCapStyle,lineDash:e.borderDash,lineDashOffset:e.borderDashOffset,lineJoin:e.borderJoinStyle,lineWidth:e.borderWidth,strokeStyle:e.borderColor,pointStyle:e.pointStyle,datasetIndex:i}},this):[]}}},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var i=0;i<t.data.datasets.length;i++)e.push('<li><span style="background-color:'+t.data.datasets[i].backgroundColor+'"></span>'),t.data.datasets[i].label&&e.push(t.data.datasets[i].label),e.push("</li>");return e.push("</ul>"),e.join("")}});var gn=pt.extend({initialize:function(t){ut.extend(this,t),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:hn,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:hn,beforeSetDimensions:hn,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:hn,beforeBuildLabels:hn,buildLabels:function(){var t=this,e=t.options.labels||{},i=ut.callback(e.generateLabels,[t.chart],t)||[];e.filter&&(i=i.filter(function(i){return e.filter(i,t.chart.data)})),t.options.reverse&&i.reverse(),t.legendItems=i},afterBuildLabels:hn,beforeFit:hn,fit:function(){var t=this,e=t.options,i=e.labels,n=e.display,a=t.ctx,o=ut.options._parseFont(i),r=o.size,s=t.legendHitBoxes=[],l=t.minSize,d=t.isHorizontal();if(d?(l.width=t.maxWidth,l.height=n?10:0):(l.width=n?10:0,l.height=t.maxHeight),n)if(a.font=o.string,d){var u=t.lineWidths=[0],h=0;a.textAlign="left",a.textBaseline="top",ut.each(t.legendItems,function(t,e){var n=fn(i,r)+r/2+a.measureText(t.text).width;(0===e||u[u.length-1]+n+i.padding>l.width)&&(h+=r+i.padding,u[u.length-(e>0?0:1)]=i.padding),s[e]={left:0,top:0,width:n,height:r},u[u.length-1]+=n+i.padding}),l.height+=h}else{var c=i.padding,f=t.columnWidths=[],g=i.padding,p=0,m=0,v=r+c;ut.each(t.legendItems,function(t,e){var n=fn(i,r)+r/2+a.measureText(t.text).width;e>0&&m+v>l.height-c&&(g+=p+i.padding,f.push(p),p=0,m=0),p=Math.max(p,n),m+=v,s[e]={left:0,top:0,width:n,height:r}}),g+=p,f.push(p),l.width+=g}t.width=l.width,t.height=l.height},afterFit:hn,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var t=this,e=t.options,i=e.labels,n=st.global,a=n.defaultColor,o=n.elements.line,r=t.width,s=t.lineWidths;if(e.display){var l,d=t.ctx,u=cn(i.fontColor,n.defaultFontColor),h=ut.options._parseFont(i),c=h.size;d.textAlign="left",d.textBaseline="middle",d.lineWidth=.5,d.strokeStyle=u,d.fillStyle=u,d.font=h.string;var f=fn(i,c),g=t.legendHitBoxes,p=t.isHorizontal();l=p?{x:t.left+(r-s[0])/2+i.padding,y:t.top+i.padding,line:0}:{x:t.left+i.padding,y:t.top+i.padding,line:0};var m=c+i.padding;ut.each(t.legendItems,function(n,u){var h=d.measureText(n.text).width,v=f+c/2+h,b=l.x,x=l.y;p?u>0&&b+v+i.padding>t.left+t.minSize.width&&(x=l.y+=m,l.line++,b=l.x=t.left+(r-s[l.line])/2+i.padding):u>0&&x+m>t.top+t.minSize.height&&(b=l.x=b+t.columnWidths[l.line]+i.padding,x=l.y=t.top+i.padding,l.line++),function(t,i,n){if(!(isNaN(f)||f<=0)){d.save();var r=cn(n.lineWidth,o.borderWidth);if(d.fillStyle=cn(n.fillStyle,a),d.lineCap=cn(n.lineCap,o.borderCapStyle),d.lineDashOffset=cn(n.lineDashOffset,o.borderDashOffset),d.lineJoin=cn(n.lineJoin,o.borderJoinStyle),d.lineWidth=r,d.strokeStyle=cn(n.strokeStyle,a),d.setLineDash&&d.setLineDash(cn(n.lineDash,o.borderDash)),e.labels&&e.labels.usePointStyle){var s=f*Math.SQRT2/2,l=t+f/2,u=i+c/2;ut.canvas.drawPoint(d,n.pointStyle,s,l,u)}else 0!==r&&d.strokeRect(t,i,f,c),d.fillRect(t,i,f,c);d.restore()}}(b,x,n),g[u].left=b,g[u].top=x,function(t,e,i,n){var a=c/2,o=f+a+t,r=e+a;d.fillText(i.text,o,r),i.hidden&&(d.beginPath(),d.lineWidth=2,d.moveTo(o,r),d.lineTo(o+n,r),d.stroke())}(b,x,n,h),p?l.x+=v+i.padding:l.y+=m})}},_getLegendItemAt:function(t,e){var i,n,a,o=this;if(t>=o.left&&t<=o.right&&e>=o.top&&e<=o.bottom)for(a=o.legendHitBoxes,i=0;i<a.length;++i)if(t>=(n=a[i]).left&&t<=n.left+n.width&&e>=n.top&&e<=n.top+n.height)return o.legendItems[i];return null},handleEvent:function(t){var e,i=this,n=i.options,a="mouseup"===t.type?"click":t.type;if("mousemove"===a){if(!n.onHover&&!n.onLeave)return}else{if("click"!==a)return;if(!n.onClick)return}e=i._getLegendItemAt(t.x,t.y),"click"===a?e&&n.onClick&&n.onClick.call(i,t.native,e):(n.onLeave&&e!==i._hoveredItem&&(i._hoveredItem&&n.onLeave.call(i,t.native,i._hoveredItem),i._hoveredItem=e),n.onHover&&e&&n.onHover.call(i,t.native,e))}});function pn(t,e){var i=new gn({ctx:t.ctx,options:e,chart:t});ke.configure(t,i,e),ke.addBox(t,i),t.legend=i}var mn={id:"legend",_element:gn,beforeInit:function(t){var e=t.options.legend;e&&pn(t,e)},beforeUpdate:function(t){var e=t.options.legend,i=t.legend;e?(ut.mergeIf(e,st.global.legend),i?(ke.configure(t,i,e),i.options=e):pn(t,e)):i&&(ke.removeBox(t,i),delete t.legend)},afterEvent:function(t,e){var i=t.legend;i&&i.handleEvent(e)}},vn=ut.noop;st._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var bn=pt.extend({initialize:function(t){ut.extend(this,t),this.legendHitBoxes=[]},beforeUpdate:vn,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:vn,beforeSetDimensions:vn,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:vn,beforeBuildLabels:vn,buildLabels:vn,afterBuildLabels:vn,beforeFit:vn,fit:function(){var t=this,e=t.options,i=e.display,n=t.minSize,a=ut.isArray(e.text)?e.text.length:1,o=ut.options._parseFont(e),r=i?a*o.lineHeight+2*e.padding:0;t.isHorizontal()?(n.width=t.maxWidth,n.height=r):(n.width=r,n.height=t.maxHeight),t.width=n.width,t.height=n.height},afterFit:vn,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var t=this,e=t.ctx,i=t.options;if(i.display){var n,a,o,r=ut.options._parseFont(i),s=r.lineHeight,l=s/2+i.padding,d=0,u=t.top,h=t.left,c=t.bottom,f=t.right;e.fillStyle=ut.valueOrDefault(i.fontColor,st.global.defaultFontColor),e.font=r.string,t.isHorizontal()?(a=h+(f-h)/2,o=u+l,n=f-h):(a="left"===i.position?h+l:f-l,o=u+(c-u)/2,n=c-u,d=Math.PI*("left"===i.position?-.5:.5)),e.save(),e.translate(a,o),e.rotate(d),e.textAlign="center",e.textBaseline="middle";var g=i.text;if(ut.isArray(g))for(var p=0,m=0;m<g.length;++m)e.fillText(g[m],0,p,n),p+=s;else e.fillText(g,0,0,n);e.restore()}}});function xn(t,e){var i=new bn({ctx:t.ctx,options:e,chart:t});ke.configure(t,i,e),ke.addBox(t,i),t.titleBlock=i}var yn={},kn=un,wn=mn,Mn={id:"title",_element:bn,beforeInit:function(t){var e=t.options.title;e&&xn(t,e)},beforeUpdate:function(t){var e=t.options.title,i=t.titleBlock;e?(ut.mergeIf(e,st.global.title),i?(ke.configure(t,i,e),i.options=e):xn(t,e)):i&&(ke.removeBox(t,i),delete t.titleBlock)}};for(var _n in yn.filler=kn,yn.legend=wn,yn.title=Mn,ai.helpers=ut,function(){function t(t,e,i){var n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}function e(t){return null!=t&&"none"!==t}function i(i,n,a){var o=document.defaultView,r=ut._getParentNode(i),s=o.getComputedStyle(i)[n],l=o.getComputedStyle(r)[n],d=e(s),u=e(l),h=Number.POSITIVE_INFINITY;return d||u?Math.min(d?t(s,i,a):h,u?t(l,r,a):h):"none"}ut.where=function(t,e){if(ut.isArray(t)&&Array.prototype.filter)return t.filter(e);var i=[];return ut.each(t,function(t){e(t)&&i.push(t)}),i},ut.findIndex=Array.prototype.findIndex?function(t,e,i){return t.findIndex(e,i)}:function(t,e,i){i=void 0===i?t:i;for(var n=0,a=t.length;n<a;++n)if(e.call(i,t[n],n,t))return n;return-1},ut.findNextWhere=function(t,e,i){ut.isNullOrUndef(i)&&(i=-1);for(var n=i+1;n<t.length;n++){var a=t[n];if(e(a))return a}},ut.findPreviousWhere=function(t,e,i){ut.isNullOrUndef(i)&&(i=t.length);for(var n=i-1;n>=0;n--){var a=t[n];if(e(a))return a}},ut.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},ut.almostEquals=function(t,e,i){return Math.abs(t-e)<i},ut.almostWhole=function(t,e){var i=Math.round(t);return i-e<t&&i+e>t},ut.max=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.max(t,e)},Number.NEGATIVE_INFINITY)},ut.min=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.min(t,e)},Number.POSITIVE_INFINITY)},ut.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1},ut.log10=Math.log10?function(t){return Math.log10(t)}:function(t){var e=Math.log(t)*Math.LOG10E,i=Math.round(e);return t===Math.pow(10,i)?i:e},ut.toRadians=function(t){return t*(Math.PI/180)},ut.toDegrees=function(t){return t*(180/Math.PI)},ut._decimalPlaces=function(t){if(ut.isFinite(t)){for(var e=1,i=0;Math.round(t*e)/e!==t;)e*=10,i++;return i}},ut.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,a=Math.sqrt(i*i+n*n),o=Math.atan2(n,i);return o<-.5*Math.PI&&(o+=2*Math.PI),{angle:o,distance:a}},ut.distanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},ut.aliasPixel=function(t){return t%2==0?0:.5},ut._alignPixel=function(t,e,i){var n=t.currentDevicePixelRatio,a=i/2;return Math.round((e-a)*n)/n+a},ut.splineCurve=function(t,e,i,n){var a=t.skip?e:t,o=e,r=i.skip?e:i,s=Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2)),l=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),d=s/(s+l),u=l/(s+l),h=n*(d=isNaN(d)?0:d),c=n*(u=isNaN(u)?0:u);return{previous:{x:o.x-h*(r.x-a.x),y:o.y-h*(r.y-a.y)},next:{x:o.x+c*(r.x-a.x),y:o.y+c*(r.y-a.y)}}},ut.EPSILON=Number.EPSILON||1e-14,ut.splineCurveMonotone=function(t){var e,i,n,a,o,r,s,l,d,u=(t||[]).map(function(t){return{model:t._model,deltaK:0,mK:0}}),h=u.length;for(e=0;e<h;++e)if(!(n=u[e]).model.skip){if(i=e>0?u[e-1]:null,(a=e<h-1?u[e+1]:null)&&!a.model.skip){var c=a.model.x-n.model.x;n.deltaK=0!==c?(a.model.y-n.model.y)/c:0}!i||i.model.skip?n.mK=n.deltaK:!a||a.model.skip?n.mK=i.deltaK:this.sign(i.deltaK)!==this.sign(n.deltaK)?n.mK=0:n.mK=(i.deltaK+n.deltaK)/2}for(e=0;e<h-1;++e)n=u[e],a=u[e+1],n.model.skip||a.model.skip||(ut.almostEquals(n.deltaK,0,this.EPSILON)?n.mK=a.mK=0:(o=n.mK/n.deltaK,r=a.mK/n.deltaK,(l=Math.pow(o,2)+Math.pow(r,2))<=9||(s=3/Math.sqrt(l),n.mK=o*s*n.deltaK,a.mK=r*s*n.deltaK)));for(e=0;e<h;++e)(n=u[e]).model.skip||(i=e>0?u[e-1]:null,a=e<h-1?u[e+1]:null,i&&!i.model.skip&&(d=(n.model.x-i.model.x)/3,n.model.controlPointPreviousX=n.model.x-d,n.model.controlPointPreviousY=n.model.y-d*n.mK),a&&!a.model.skip&&(d=(a.model.x-n.model.x)/3,n.model.controlPointNextX=n.model.x+d,n.model.controlPointNextY=n.model.y+d*n.mK))},ut.nextItem=function(t,e,i){return i?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},ut.previousItem=function(t,e,i){return i?e<=0?t[t.length-1]:t[e-1]:e<=0?t[0]:t[e-1]},ut.niceNum=function(t,e){var i=Math.floor(ut.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},ut.requestAnimFrame="undefined"==typeof window?function(t){t()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},ut.getRelativePosition=function(t,e){var i,n,a=t.originalEvent||t,o=t.target||t.srcElement,r=o.getBoundingClientRect(),s=a.touches;s&&s.length>0?(i=s[0].clientX,n=s[0].clientY):(i=a.clientX,n=a.clientY);var l=parseFloat(ut.getStyle(o,"padding-left")),d=parseFloat(ut.getStyle(o,"padding-top")),u=parseFloat(ut.getStyle(o,"padding-right")),h=parseFloat(ut.getStyle(o,"padding-bottom")),c=r.right-r.left-l-u,f=r.bottom-r.top-d-h;return{x:i=Math.round((i-r.left-l)/c*o.width/e.currentDevicePixelRatio),y:n=Math.round((n-r.top-d)/f*o.height/e.currentDevicePixelRatio)}},ut.getConstraintWidth=function(t){return i(t,"max-width","clientWidth")},ut.getConstraintHeight=function(t){return i(t,"max-height","clientHeight")},ut._calculatePadding=function(t,e,i){return(e=ut.getStyle(t,e)).indexOf("%")>-1?i*parseInt(e,10)/100:parseInt(e,10)},ut._getParentNode=function(t){var e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e},ut.getMaximumWidth=function(t){var e=ut._getParentNode(t);if(!e)return t.clientWidth;var i=e.clientWidth,n=i-ut._calculatePadding(e,"padding-left",i)-ut._calculatePadding(e,"padding-right",i),a=ut.getConstraintWidth(t);return isNaN(a)?n:Math.min(n,a)},ut.getMaximumHeight=function(t){var e=ut._getParentNode(t);if(!e)return t.clientHeight;var i=e.clientHeight,n=i-ut._calculatePadding(e,"padding-top",i)-ut._calculatePadding(e,"padding-bottom",i),a=ut.getConstraintHeight(t);return isNaN(a)?n:Math.min(n,a)},ut.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},ut.retinaScale=function(t,e){var i=t.currentDevicePixelRatio=e||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==i){var n=t.canvas,a=t.height,o=t.width;n.height=a*i,n.width=o*i,t.ctx.scale(i,i),n.style.height||n.style.width||(n.style.height=a+"px",n.style.width=o+"px")}},ut.fontString=function(t,e,i){return e+" "+t+"px "+i},ut.longestText=function(t,e,i,n){var a=(n=n||{}).data=n.data||{},o=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(a=n.data={},o=n.garbageCollect=[],n.font=e),t.font=e;var r=0;ut.each(i,function(e){null!=e&&!0!==ut.isArray(e)?r=ut.measureText(t,a,o,r,e):ut.isArray(e)&&ut.each(e,function(e){null==e||ut.isArray(e)||(r=ut.measureText(t,a,o,r,e))})});var s=o.length/2;if(s>i.length){for(var l=0;l<s;l++)delete a[o[l]];o.splice(0,s)}return r},ut.measureText=function(t,e,i,n,a){var o=e[a];return o||(o=e[a]=t.measureText(a).width,i.push(a)),o>n&&(n=o),n},ut.numberOfLabelLines=function(t){var e=1;return ut.each(t,function(t){ut.isArray(t)&&t.length>e&&(e=t.length)}),e},ut.color=X?function(t){return t instanceof CanvasGradient&&(t=st.global.defaultColor),X(t)}:function(t){return console.error("Color.js not found!"),t},ut.getHoverColor=function(t){return t instanceof CanvasPattern||t instanceof CanvasGradient?t:ut.color(t).saturate(.5).darken(.1).rgbString()}}(),ai._adapters=si,ai.Animation=vt,ai.animationService=bt,ai.controllers=ue,ai.DatasetController=Mt,ai.defaults=st,ai.Element=pt,ai.elements=Wt,ai.Interaction=ve,ai.layouts=ke,ai.platform=Ve,ai.plugins=Ee,ai.Scale=fi,ai.scaleService=He,ai.Ticks=li,ai.Tooltip=Je,ai.helpers.each(tn,function(t,e){ai.scaleService.registerScaleType(e,t,t._defaults)}),yn)yn.hasOwnProperty(_n)&&ai.plugins.register(yn[_n]);ai.platform.initialize();var Cn=ai;return"undefined"!=typeof window&&(window.Chart=ai),ai.Chart=ai,ai.Legend=yn.legend._element,ai.Title=yn.title._element,ai.pluginService=ai.plugins,ai.PluginBase=ai.Element.extend({}),ai.canvasHelpers=ai.helpers.canvas,ai.layoutService=ai.layouts,ai.LinearScaleBase=bi,ai.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(t){ai[t]=function(e,i){return new ai(e,ai.helpers.merge(i||{},{type:t.charAt(0).toLowerCase()+t.slice(1)}))}}),Cn});;

/* /base_accounting_kit/static/lib/Chart.js defined in bundle 'web.assets_backend' */
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory(function(){try{return require('moment');}catch(e){}}()):typeof define==='function'&&define.amd?define(['require'],function(require){return factory(function(){try{return require('moment');}catch(e){}}());}):(global.Chart=factory(global.moment));}(this,(function(moment){'use strict';moment=moment&&moment.hasOwnProperty('default')?moment['default']:moment;var conversions={rgb2hsl:rgb2hsl,rgb2hsv:rgb2hsv,rgb2hwb:rgb2hwb,rgb2cmyk:rgb2cmyk,rgb2keyword:rgb2keyword,rgb2xyz:rgb2xyz,rgb2lab:rgb2lab,rgb2lch:rgb2lch,hsl2rgb:hsl2rgb,hsl2hsv:hsl2hsv,hsl2hwb:hsl2hwb,hsl2cmyk:hsl2cmyk,hsl2keyword:hsl2keyword,hsv2rgb:hsv2rgb,hsv2hsl:hsv2hsl,hsv2hwb:hsv2hwb,hsv2cmyk:hsv2cmyk,hsv2keyword:hsv2keyword,hwb2rgb:hwb2rgb,hwb2hsl:hwb2hsl,hwb2hsv:hwb2hsv,hwb2cmyk:hwb2cmyk,hwb2keyword:hwb2keyword,cmyk2rgb:cmyk2rgb,cmyk2hsl:cmyk2hsl,cmyk2hsv:cmyk2hsv,cmyk2hwb:cmyk2hwb,cmyk2keyword:cmyk2keyword,keyword2rgb:keyword2rgb,keyword2hsl:keyword2hsl,keyword2hsv:keyword2hsv,keyword2hwb:keyword2hwb,keyword2cmyk:keyword2cmyk,keyword2lab:keyword2lab,keyword2xyz:keyword2xyz,xyz2rgb:xyz2rgb,xyz2lab:xyz2lab,xyz2lch:xyz2lch,lab2xyz:lab2xyz,lab2rgb:lab2rgb,lab2lch:lab2lch,lch2lab:lch2lab,lch2xyz:lch2xyz,lch2rgb:lch2rgb};function rgb2hsl(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,l;if(max==min)
h=0;else if(r==max)
h=(g-b)/delta;else if(g==max)
h=2+(b-r)/delta;else if(b==max)
h=4+(r-g)/delta;h=Math.min(h*60,360);if(h<0)
h+=360;l=(min+max)/2;if(max==min)
s=0;else if(l<=0.5)
s=delta/(max+min);else
s=delta/(2-max-min);return[h,s*100,l*100];}
function rgb2hsv(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,v;if(max==0)
s=0;else
s=(delta/max*1000)/10;if(max==min)
h=0;else if(r==max)
h=(g-b)/delta;else if(g==max)
h=2+(b-r)/delta;else if(b==max)
h=4+(r-g)/delta;h=Math.min(h*60,360);if(h<0)
h+=360;v=((max/255)*1000)/10;return[h,s,v];}
function rgb2hwb(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],h=rgb2hsl(rgb)[0],w=1/255*Math.min(r,Math.min(g,b)),b=1-1/255*Math.max(r,Math.max(g,b));return[h,w*100,b*100];}
function rgb2cmyk(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,c,m,y,k;k=Math.min(1-r,1-g,1-b);c=(1-r-k)/(1-k)||0;m=(1-g-k)/(1-k)||0;y=(1-b-k)/(1-k)||0;return[c*100,m*100,y*100,k*100];}
function rgb2keyword(rgb){return reverseKeywords[JSON.stringify(rgb)];}
function rgb2xyz(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;r=r>0.04045?Math.pow(((r+0.055)/1.055),2.4):(r/12.92);g=g>0.04045?Math.pow(((g+0.055)/1.055),2.4):(g/12.92);b=b>0.04045?Math.pow(((b+0.055)/1.055),2.4):(b/12.92);var x=(r*0.4124)+(g*0.3576)+(b*0.1805);var y=(r*0.2126)+(g*0.7152)+(b*0.0722);var z=(r*0.0193)+(g*0.1192)+(b*0.9505);return[x*100,y*100,z*100];}
function rgb2lab(rgb){var xyz=rgb2xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2],l,a,b;x/=95.047;y/=100;z/=108.883;x=x>0.008856?Math.pow(x,1/3):(7.787*x)+(16/116);y=y>0.008856?Math.pow(y,1/3):(7.787*y)+(16/116);z=z>0.008856?Math.pow(z,1/3):(7.787*z)+(16/116);l=(116*y)-16;a=500*(x-y);b=200*(y-z);return[l,a,b];}
function rgb2lch(args){return lab2lch(rgb2lab(args));}
function hsl2rgb(hsl){var h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100,t1,t2,t3,rgb,val;if(s==0){val=l*255;return[val,val,val];}
if(l<0.5)
t2=l*(1+s);else
t2=l+s-l*s;t1=2*l-t2;rgb=[0,0,0];for(var i=0;i<3;i++){t3=h+1/3*-(i-1);t3<0&&t3++;t3>1&&t3--;if(6*t3<1)
val=t1+(t2-t1)*6*t3;else if(2*t3<1)
val=t2;else if(3*t3<2)
val=t1+(t2-t1)*(2/3-t3)*6;else
val=t1;rgb[i]=val*255;}
return rgb;}
function hsl2hsv(hsl){var h=hsl[0],s=hsl[1]/100,l=hsl[2]/100,sv,v;if(l===0){return[0,0,0];}
l*=2;s*=(l<=1)?l:2-l;v=(l+s)/2;sv=(2*s)/(l+s);return[h,sv*100,v*100];}
function hsl2hwb(args){return rgb2hwb(hsl2rgb(args));}
function hsl2cmyk(args){return rgb2cmyk(hsl2rgb(args));}
function hsl2keyword(args){return rgb2keyword(hsl2rgb(args));}
function hsv2rgb(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6;var f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-(s*f)),t=255*v*(1-(s*(1-f))),v=255*v;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q];}}
function hsv2hsl(hsv){var h=hsv[0],s=hsv[1]/100,v=hsv[2]/100,sl,l;l=(2-s)*v;sl=s*v;sl/=(l<=1)?l:2-l;sl=sl||0;l/=2;return[h,sl*100,l*100];}
function hsv2hwb(args){return rgb2hwb(hsv2rgb(args))}
function hsv2cmyk(args){return rgb2cmyk(hsv2rgb(args));}
function hsv2keyword(args){return rgb2keyword(hsv2rgb(args));}
function hwb2rgb(hwb){var h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl,i,v,f,n;if(ratio>1){wh/=ratio;bl/=ratio;}
i=Math.floor(6*h);v=1-bl;f=6*h-i;if((i&0x01)!=0){f=1-f;}
n=wh+f*(v-wh);switch(i){default:case 6:case 0:r=v;g=n;b=wh;break;case 1:r=n;g=v;b=wh;break;case 2:r=wh;g=v;b=n;break;case 3:r=wh;g=n;b=v;break;case 4:r=n;g=wh;b=v;break;case 5:r=v;g=wh;b=n;break;}
return[r*255,g*255,b*255];}
function hwb2hsl(args){return rgb2hsl(hwb2rgb(args));}
function hwb2hsv(args){return rgb2hsv(hwb2rgb(args));}
function hwb2cmyk(args){return rgb2cmyk(hwb2rgb(args));}
function hwb2keyword(args){return rgb2keyword(hwb2rgb(args));}
function cmyk2rgb(cmyk){var c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100,r,g,b;r=1-Math.min(1,c*(1-k)+k);g=1-Math.min(1,m*(1-k)+k);b=1-Math.min(1,y*(1-k)+k);return[r*255,g*255,b*255];}
function cmyk2hsl(args){return rgb2hsl(cmyk2rgb(args));}
function cmyk2hsv(args){return rgb2hsv(cmyk2rgb(args));}
function cmyk2hwb(args){return rgb2hwb(cmyk2rgb(args));}
function cmyk2keyword(args){return rgb2keyword(cmyk2rgb(args));}
function xyz2rgb(xyz){var x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100,r,g,b;r=(x*3.2406)+(y*-1.5372)+(z*-0.4986);g=(x*-0.9689)+(y*1.8758)+(z*0.0415);b=(x*0.0557)+(y*-0.2040)+(z*1.0570);r=r>0.0031308?((1.055*Math.pow(r,1.0/2.4))-0.055):r=(r*12.92);g=g>0.0031308?((1.055*Math.pow(g,1.0/2.4))-0.055):g=(g*12.92);b=b>0.0031308?((1.055*Math.pow(b,1.0/2.4))-0.055):b=(b*12.92);r=Math.min(Math.max(0,r),1);g=Math.min(Math.max(0,g),1);b=Math.min(Math.max(0,b),1);return[r*255,g*255,b*255];}
function xyz2lab(xyz){var x=xyz[0],y=xyz[1],z=xyz[2],l,a,b;x/=95.047;y/=100;z/=108.883;x=x>0.008856?Math.pow(x,1/3):(7.787*x)+(16/116);y=y>0.008856?Math.pow(y,1/3):(7.787*y)+(16/116);z=z>0.008856?Math.pow(z,1/3):(7.787*z)+(16/116);l=(116*y)-16;a=500*(x-y);b=200*(y-z);return[l,a,b];}
function xyz2lch(args){return lab2lch(xyz2lab(args));}
function lab2xyz(lab){var l=lab[0],a=lab[1],b=lab[2],x,y,z,y2;if(l<=8){y=(l*100)/903.3;y2=(7.787*(y/100))+(16/116);}else{y=100*Math.pow((l+16)/116,3);y2=Math.pow(y/100,1/3);}
x=x/95.047<=0.008856?x=(95.047*((a/500)+y2-(16/116)))/7.787:95.047*Math.pow((a/500)+y2,3);z=z/108.883<=0.008859?z=(108.883*(y2-(b/200)-(16/116)))/7.787:108.883*Math.pow(y2-(b/200),3);return[x,y,z];}
function lab2lch(lab){var l=lab[0],a=lab[1],b=lab[2],hr,h,c;hr=Math.atan2(b,a);h=hr*360/2/Math.PI;if(h<0){h+=360;}
c=Math.sqrt(a*a+b*b);return[l,c,h];}
function lab2rgb(args){return xyz2rgb(lab2xyz(args));}
function lch2lab(lch){var l=lch[0],c=lch[1],h=lch[2],a,b,hr;hr=h/360*2*Math.PI;a=c*Math.cos(hr);b=c*Math.sin(hr);return[l,a,b];}
function lch2xyz(args){return lab2xyz(lch2lab(args));}
function lch2rgb(args){return lab2rgb(lch2lab(args));}
function keyword2rgb(keyword){return cssKeywords[keyword];}
function keyword2hsl(args){return rgb2hsl(keyword2rgb(args));}
function keyword2hsv(args){return rgb2hsv(keyword2rgb(args));}
function keyword2hwb(args){return rgb2hwb(keyword2rgb(args));}
function keyword2cmyk(args){return rgb2cmyk(keyword2rgb(args));}
function keyword2lab(args){return rgb2lab(keyword2rgb(args));}
function keyword2xyz(args){return rgb2xyz(keyword2rgb(args));}
var cssKeywords={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var reverseKeywords={};for(var key in cssKeywords){reverseKeywords[JSON.stringify(cssKeywords[key])]=key;}
var convert=function(){return new Converter();};for(var func in conversions){convert[func+"Raw"]=(function(func){return function(arg){if(typeof arg=="number")
arg=Array.prototype.slice.call(arguments);return conversions[func](arg);}})(func);var pair=/(\w+)2(\w+)/.exec(func),from=pair[1],to=pair[2];convert[from]=convert[from]||{};convert[from][to]=convert[func]=(function(func){return function(arg){if(typeof arg=="number")
arg=Array.prototype.slice.call(arguments);var val=conversions[func](arg);if(typeof val=="string"||val===undefined)
return val;for(var i=0;i<val.length;i++)
val[i]=Math.round(val[i]);return val;}})(func);}
var Converter=function(){this.convs={};};Converter.prototype.routeSpace=function(space,args){var values=args[0];if(values===undefined){return this.getValues(space);}
if(typeof values=="number"){values=Array.prototype.slice.call(args);}
return this.setValues(space,values);};Converter.prototype.setValues=function(space,values){this.space=space;this.convs={};this.convs[space]=values;return this;};Converter.prototype.getValues=function(space){var vals=this.convs[space];if(!vals){var fspace=this.space,from=this.convs[fspace];vals=convert[fspace][space](from);this.convs[space]=vals;}
return vals;};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(space){Converter.prototype[space]=function(vals){return this.routeSpace(space,arguments);};});var colorConvert=convert;var colorName={"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aqua":[0,255,255],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"black":[0,0,0],"blanchedalmond":[255,235,205],"blue":[0,0,255],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"fuchsia":[255,0,255],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"gray":[128,128,128],"green":[0,128,0],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"lime":[0,255,0],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"maroon":[128,0,0],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"navy":[0,0,128],"oldlace":[253,245,230],"olive":[128,128,0],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"purple":[128,0,128],"rebeccapurple":[102,51,153],"red":[255,0,0],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"silver":[192,192,192],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"teal":[0,128,128],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"white":[255,255,255],"whitesmoke":[245,245,245],"yellow":[255,255,0],"yellowgreen":[154,205,50]};var colorString={getRgba:getRgba,getHsla:getHsla,getRgb:getRgb,getHsl:getHsl,getHwb:getHwb,getAlpha:getAlpha,hexString:hexString,rgbString:rgbString,rgbaString:rgbaString,percentString:percentString,percentaString:percentaString,hslString:hslString,hslaString:hslaString,hwbString:hwbString,keyword:keyword};function getRgba(string){if(!string){return;}
var abbr=/^#([a-fA-F0-9]{3,4})$/i,hex=/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i,rgba=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,per=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,keyword=/(\w+)/;var rgb=[0,0,0],a=1,match=string.match(abbr),hexAlpha="";if(match){match=match[1];hexAlpha=match[3];for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match[i]+match[i],16);}
if(hexAlpha){a=Math.round((parseInt(hexAlpha+hexAlpha,16)/255)*100)/100;}}
else if(match=string.match(hex)){hexAlpha=match[2];match=match[1];for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match.slice(i*2,i*2+2),16);}
if(hexAlpha){a=Math.round((parseInt(hexAlpha,16)/255)*100)/100;}}
else if(match=string.match(rgba)){for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match[i+1]);}
a=parseFloat(match[4]);}
else if(match=string.match(per)){for(var i=0;i<rgb.length;i++){rgb[i]=Math.round(parseFloat(match[i+1])*2.55);}
a=parseFloat(match[4]);}
else if(match=string.match(keyword)){if(match[1]=="transparent"){return[0,0,0,0];}
rgb=colorName[match[1]];if(!rgb){return;}}
for(var i=0;i<rgb.length;i++){rgb[i]=scale(rgb[i],0,255);}
if(!a&&a!=0){a=1;}
else{a=scale(a,0,1);}
rgb[3]=a;return rgb;}
function getHsla(string){if(!string){return;}
var hsl=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var match=string.match(hsl);if(match){var alpha=parseFloat(match[4]);var h=scale(parseInt(match[1]),0,360),s=scale(parseFloat(match[2]),0,100),l=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,s,l,a];}}
function getHwb(string){if(!string){return;}
var hwb=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var match=string.match(hwb);if(match){var alpha=parseFloat(match[4]);var h=scale(parseInt(match[1]),0,360),w=scale(parseFloat(match[2]),0,100),b=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,w,b,a];}}
function getRgb(string){var rgba=getRgba(string);return rgba&&rgba.slice(0,3);}
function getHsl(string){var hsla=getHsla(string);return hsla&&hsla.slice(0,3);}
function getAlpha(string){var vals=getRgba(string);if(vals){return vals[3];}
else if(vals=getHsla(string)){return vals[3];}
else if(vals=getHwb(string)){return vals[3];}}
function hexString(rgba,a){var a=(a!==undefined&&rgba.length===3)?a:rgba[3];return"#"+hexDouble(rgba[0])
+hexDouble(rgba[1])
+hexDouble(rgba[2])
+((a>=0&&a<1)?hexDouble(Math.round(a*255)):"");}
function rgbString(rgba,alpha){if(alpha<1||(rgba[3]&&rgba[3]<1)){return rgbaString(rgba,alpha);}
return"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")";}
function rgbaString(rgba,alpha){if(alpha===undefined){alpha=(rgba[3]!==undefined?rgba[3]:1);}
return"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]
+", "+alpha+")";}
function percentString(rgba,alpha){if(alpha<1||(rgba[3]&&rgba[3]<1)){return percentaString(rgba,alpha);}
var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)";}
function percentaString(rgba,alpha){var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgba("+r+"%, "+g+"%, "+b+"%, "+(alpha||rgba[3]||1)+")";}
function hslString(hsla,alpha){if(alpha<1||(hsla[3]&&hsla[3]<1)){return hslaString(hsla,alpha);}
return"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)";}
function hslaString(hsla,alpha){if(alpha===undefined){alpha=(hsla[3]!==undefined?hsla[3]:1);}
return"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "
+alpha+")";}
function hwbString(hwb,alpha){if(alpha===undefined){alpha=(hwb[3]!==undefined?hwb[3]:1);}
return"hwb("+hwb[0]+", "+hwb[1]+"%, "+hwb[2]+"%"
+(alpha!==undefined&&alpha!==1?", "+alpha:"")+")";}
function keyword(rgb){return reverseNames[rgb.slice(0,3)];}
function scale(num,min,max){return Math.min(Math.max(min,num),max);}
function hexDouble(num){var str=num.toString(16).toUpperCase();return(str.length<2)?"0"+str:str;}
var reverseNames={};for(var name in colorName){reverseNames[colorName[name]]=name;}
var Color=function(obj){if(obj instanceof Color){return obj;}
if(!(this instanceof Color)){return new Color(obj);}
this.valid=false;this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var vals;if(typeof obj==='string'){vals=colorString.getRgba(obj);if(vals){this.setValues('rgb',vals);}else if(vals=colorString.getHsla(obj)){this.setValues('hsl',vals);}else if(vals=colorString.getHwb(obj)){this.setValues('hwb',vals);}}else if(typeof obj==='object'){vals=obj;if(vals.r!==undefined||vals.red!==undefined){this.setValues('rgb',vals);}else if(vals.l!==undefined||vals.lightness!==undefined){this.setValues('hsl',vals);}else if(vals.v!==undefined||vals.value!==undefined){this.setValues('hsv',vals);}else if(vals.w!==undefined||vals.whiteness!==undefined){this.setValues('hwb',vals);}else if(vals.c!==undefined||vals.cyan!==undefined){this.setValues('cmyk',vals);}}};Color.prototype={isValid:function(){return this.valid;},rgb:function(){return this.setSpace('rgb',arguments);},hsl:function(){return this.setSpace('hsl',arguments);},hsv:function(){return this.setSpace('hsv',arguments);},hwb:function(){return this.setSpace('hwb',arguments);},cmyk:function(){return this.setSpace('cmyk',arguments);},rgbArray:function(){return this.values.rgb;},hslArray:function(){return this.values.hsl;},hsvArray:function(){return this.values.hsv;},hwbArray:function(){var values=this.values;if(values.alpha!==1){return values.hwb.concat([values.alpha]);}
return values.hwb;},cmykArray:function(){return this.values.cmyk;},rgbaArray:function(){var values=this.values;return values.rgb.concat([values.alpha]);},hslaArray:function(){var values=this.values;return values.hsl.concat([values.alpha]);},alpha:function(val){if(val===undefined){return this.values.alpha;}
this.setValues('alpha',val);return this;},red:function(val){return this.setChannel('rgb',0,val);},green:function(val){return this.setChannel('rgb',1,val);},blue:function(val){return this.setChannel('rgb',2,val);},hue:function(val){if(val){val%=360;val=val<0?360+val:val;}
return this.setChannel('hsl',0,val);},saturation:function(val){return this.setChannel('hsl',1,val);},lightness:function(val){return this.setChannel('hsl',2,val);},saturationv:function(val){return this.setChannel('hsv',1,val);},whiteness:function(val){return this.setChannel('hwb',1,val);},blackness:function(val){return this.setChannel('hwb',2,val);},value:function(val){return this.setChannel('hsv',2,val);},cyan:function(val){return this.setChannel('cmyk',0,val);},magenta:function(val){return this.setChannel('cmyk',1,val);},yellow:function(val){return this.setChannel('cmyk',2,val);},black:function(val){return this.setChannel('cmyk',3,val);},hexString:function(){return colorString.hexString(this.values.rgb);},rgbString:function(){return colorString.rgbString(this.values.rgb,this.values.alpha);},rgbaString:function(){return colorString.rgbaString(this.values.rgb,this.values.alpha);},percentString:function(){return colorString.percentString(this.values.rgb,this.values.alpha);},hslString:function(){return colorString.hslString(this.values.hsl,this.values.alpha);},hslaString:function(){return colorString.hslaString(this.values.hsl,this.values.alpha);},hwbString:function(){return colorString.hwbString(this.values.hwb,this.values.alpha);},keyword:function(){return colorString.keyword(this.values.rgb,this.values.alpha);},rgbNumber:function(){var rgb=this.values.rgb;return(rgb[0]<<16)|(rgb[1]<<8)|rgb[2];},luminosity:function(){var rgb=this.values.rgb;var lum=[];for(var i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=(chan<=0.03928)?chan/12.92:Math.pow(((chan+0.055)/1.055),2.4);}
return 0.2126*lum[0]+0.7152*lum[1]+0.0722*lum[2];},contrast:function(color2){var lum1=this.luminosity();var lum2=color2.luminosity();if(lum1>lum2){return(lum1+0.05)/(lum2+0.05);}
return(lum2+0.05)/(lum1+0.05);},level:function(color2){var contrastRatio=this.contrast(color2);if(contrastRatio>=7.1){return'AAA';}
return(contrastRatio>=4.5)?'AA':'';},dark:function(){var rgb=this.values.rgb;var yiq=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;return yiq<128;},light:function(){return!this.dark();},negate:function(){var rgb=[];for(var i=0;i<3;i++){rgb[i]=255-this.values.rgb[i];}
this.setValues('rgb',rgb);return this;},lighten:function(ratio){var hsl=this.values.hsl;hsl[2]+=hsl[2]*ratio;this.setValues('hsl',hsl);return this;},darken:function(ratio){var hsl=this.values.hsl;hsl[2]-=hsl[2]*ratio;this.setValues('hsl',hsl);return this;},saturate:function(ratio){var hsl=this.values.hsl;hsl[1]+=hsl[1]*ratio;this.setValues('hsl',hsl);return this;},desaturate:function(ratio){var hsl=this.values.hsl;hsl[1]-=hsl[1]*ratio;this.setValues('hsl',hsl);return this;},whiten:function(ratio){var hwb=this.values.hwb;hwb[1]+=hwb[1]*ratio;this.setValues('hwb',hwb);return this;},blacken:function(ratio){var hwb=this.values.hwb;hwb[2]+=hwb[2]*ratio;this.setValues('hwb',hwb);return this;},greyscale:function(){var rgb=this.values.rgb;var val=rgb[0]*0.3+rgb[1]*0.59+rgb[2]*0.11;this.setValues('rgb',[val,val,val]);return this;},clearer:function(ratio){var alpha=this.values.alpha;this.setValues('alpha',alpha-(alpha*ratio));return this;},opaquer:function(ratio){var alpha=this.values.alpha;this.setValues('alpha',alpha+(alpha*ratio));return this;},rotate:function(degrees){var hsl=this.values.hsl;var hue=(hsl[0]+degrees)%360;hsl[0]=hue<0?360+hue:hue;this.setValues('hsl',hsl);return this;},mix:function(mixinColor,weight){var color1=this;var color2=mixinColor;var p=weight===undefined?0.5:weight;var w=2*p-1;var a=color1.alpha()-color2.alpha();var w1=(((w*a===-1)?w:(w+a)/(1+w*a))+1)/2.0;var w2=1-w1;return this.rgb(w1*color1.red()+w2*color2.red(),w1*color1.green()+w2*color2.green(),w1*color1.blue()+w2*color2.blue()).alpha(color1.alpha()*p+color2.alpha()*(1-p));},toJSON:function(){return this.rgb();},clone:function(){var result=new Color();var source=this.values;var target=result.values;var value,type;for(var prop in source){if(source.hasOwnProperty(prop)){value=source[prop];type=({}).toString.call(value);if(type==='[object Array]'){target[prop]=value.slice(0);}else if(type==='[object Number]'){target[prop]=value;}else{console.error('unexpected color value:',value);}}}
return result;}};Color.prototype.spaces={rgb:['red','green','blue'],hsl:['hue','saturation','lightness'],hsv:['hue','saturation','value'],hwb:['hue','whiteness','blackness'],cmyk:['cyan','magenta','yellow','black']};Color.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]};Color.prototype.getValues=function(space){var values=this.values;var vals={};for(var i=0;i<space.length;i++){vals[space.charAt(i)]=values[space][i];}
if(values.alpha!==1){vals.a=values.alpha;}
return vals;};Color.prototype.setValues=function(space,vals){var values=this.values;var spaces=this.spaces;var maxes=this.maxes;var alpha=1;var i;this.valid=true;if(space==='alpha'){alpha=vals;}else if(vals.length){values[space]=vals.slice(0,space.length);alpha=vals[space.length];}else if(vals[space.charAt(0)]!==undefined){for(i=0;i<space.length;i++){values[space][i]=vals[space.charAt(i)];}
alpha=vals.a;}else if(vals[spaces[space][0]]!==undefined){var chans=spaces[space];for(i=0;i<space.length;i++){values[space][i]=vals[chans[i]];}
alpha=vals.alpha;}
values.alpha=Math.max(0,Math.min(1,(alpha===undefined?values.alpha:alpha)));if(space==='alpha'){return false;}
var capped;for(i=0;i<space.length;i++){capped=Math.max(0,Math.min(maxes[space][i],values[space][i]));values[space][i]=Math.round(capped);}
for(var sname in spaces){if(sname!==space){values[sname]=colorConvert[space][sname](values[space]);}}
return true;};Color.prototype.setSpace=function(space,args){var vals=args[0];if(vals===undefined){return this.getValues(space);}
if(typeof vals==='number'){vals=Array.prototype.slice.call(args);}
this.setValues(space,vals);return this;};Color.prototype.setChannel=function(space,index,val){var svalues=this.values[space];if(val===undefined){return svalues[index];}else if(val===svalues[index]){return this;}
svalues[index]=val;this.setValues(space,svalues);return this;};if(typeof window!=='undefined'){window.Color=Color;}
var chartjsColor=Color;var helpers={noop:function(){},uid:(function(){var id=0;return function(){return id++;};}()),isNullOrUndef:function(value){return value===null||typeof value==='undefined';},isArray:function(value){if(Array.isArray&&Array.isArray(value)){return true;}
var type=Object.prototype.toString.call(value);if(type.substr(0,7)==='[object'&&type.substr(-6)==='Array]'){return true;}
return false;},isObject:function(value){return value!==null&&Object.prototype.toString.call(value)==='[object Object]';},isFinite:function(value){return(typeof value==='number'||value instanceof Number)&&isFinite(value);},valueOrDefault:function(value,defaultValue){return typeof value==='undefined'?defaultValue:value;},valueAtIndexOrDefault:function(value,index,defaultValue){return helpers.valueOrDefault(helpers.isArray(value)?value[index]:value,defaultValue);},callback:function(fn,args,thisArg){if(fn&&typeof fn.call==='function'){return fn.apply(thisArg,args);}},each:function(loopable,fn,thisArg,reverse){var i,len,keys;if(helpers.isArray(loopable)){len=loopable.length;if(reverse){for(i=len-1;i>=0;i--){fn.call(thisArg,loopable[i],i);}}else{for(i=0;i<len;i++){fn.call(thisArg,loopable[i],i);}}}else if(helpers.isObject(loopable)){keys=Object.keys(loopable);len=keys.length;for(i=0;i<len;i++){fn.call(thisArg,loopable[keys[i]],keys[i]);}}},arrayEquals:function(a0,a1){var i,ilen,v0,v1;if(!a0||!a1||a0.length!==a1.length){return false;}
for(i=0,ilen=a0.length;i<ilen;++i){v0=a0[i];v1=a1[i];if(v0 instanceof Array&&v1 instanceof Array){if(!helpers.arrayEquals(v0,v1)){return false;}}else if(v0!==v1){return false;}}
return true;},clone:function(source){if(helpers.isArray(source)){return source.map(helpers.clone);}
if(helpers.isObject(source)){var target={};var keys=Object.keys(source);var klen=keys.length;var k=0;for(;k<klen;++k){target[keys[k]]=helpers.clone(source[keys[k]]);}
return target;}
return source;},_merger:function(key,target,source,options){var tval=target[key];var sval=source[key];if(helpers.isObject(tval)&&helpers.isObject(sval)){helpers.merge(tval,sval,options);}else{target[key]=helpers.clone(sval);}},_mergerIf:function(key,target,source){var tval=target[key];var sval=source[key];if(helpers.isObject(tval)&&helpers.isObject(sval)){helpers.mergeIf(tval,sval);}else if(!target.hasOwnProperty(key)){target[key]=helpers.clone(sval);}},merge:function(target,source,options){var sources=helpers.isArray(source)?source:[source];var ilen=sources.length;var merge,i,keys,klen,k;if(!helpers.isObject(target)){return target;}
options=options||{};merge=options.merger||helpers._merger;for(i=0;i<ilen;++i){source=sources[i];if(!helpers.isObject(source)){continue;}
keys=Object.keys(source);for(k=0,klen=keys.length;k<klen;++k){merge(keys[k],target,source,options);}}
return target;},mergeIf:function(target,source){return helpers.merge(target,source,{merger:helpers._mergerIf});},extend:function(target){var setFn=function(value,key){target[key]=value;};for(var i=1,ilen=arguments.length;i<ilen;++i){helpers.each(arguments[i],setFn);}
return target;},inherits:function(extensions){var me=this;var ChartElement=(extensions&&extensions.hasOwnProperty('constructor'))?extensions.constructor:function(){return me.apply(this,arguments);};var Surrogate=function(){this.constructor=ChartElement;};Surrogate.prototype=me.prototype;ChartElement.prototype=new Surrogate();ChartElement.extend=helpers.inherits;if(extensions){helpers.extend(ChartElement.prototype,extensions);}
ChartElement.__super__=me.prototype;return ChartElement;}};var helpers_core=helpers;helpers.callCallback=helpers.callback;helpers.indexOf=function(array,item,fromIndex){return Array.prototype.indexOf.call(array,item,fromIndex);};helpers.getValueOrDefault=helpers.valueOrDefault;helpers.getValueAtIndexOrDefault=helpers.valueAtIndexOrDefault;var effects={linear:function(t){return t;},easeInQuad:function(t){return t*t;},easeOutQuad:function(t){return-t*(t-2);},easeInOutQuad:function(t){if((t/=0.5)<1){return 0.5*t*t;}
return-0.5*((--t)*(t-2)-1);},easeInCubic:function(t){return t*t*t;},easeOutCubic:function(t){return(t=t-1)*t*t+1;},easeInOutCubic:function(t){if((t/=0.5)<1){return 0.5*t*t*t;}
return 0.5*((t-=2)*t*t+2);},easeInQuart:function(t){return t*t*t*t;},easeOutQuart:function(t){return-((t=t-1)*t*t*t-1);},easeInOutQuart:function(t){if((t/=0.5)<1){return 0.5*t*t*t*t;}
return-0.5*((t-=2)*t*t*t-2);},easeInQuint:function(t){return t*t*t*t*t;},easeOutQuint:function(t){return(t=t-1)*t*t*t*t+1;},easeInOutQuint:function(t){if((t/=0.5)<1){return 0.5*t*t*t*t*t;}
return 0.5*((t-=2)*t*t*t*t+2);},easeInSine:function(t){return-Math.cos(t*(Math.PI/2))+1;},easeOutSine:function(t){return Math.sin(t*(Math.PI/2));},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t)-1);},easeInExpo:function(t){return(t===0)?0:Math.pow(2,10*(t-1));},easeOutExpo:function(t){return(t===1)?1:-Math.pow(2,-10*t)+1;},easeInOutExpo:function(t){if(t===0){return 0;}
if(t===1){return 1;}
if((t/=0.5)<1){return 0.5*Math.pow(2,10*(t-1));}
return 0.5*(-Math.pow(2,-10*--t)+2);},easeInCirc:function(t){if(t>=1){return t;}
return-(Math.sqrt(1-t*t)-1);},easeOutCirc:function(t){return Math.sqrt(1-(t=t-1)*t);},easeInOutCirc:function(t){if((t/=0.5)<1){return-0.5*(Math.sqrt(1-t*t)-1);}
return 0.5*(Math.sqrt(1-(t-=2)*t)+1);},easeInElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0;}
if(t===1){return 1;}
if(!p){p=0.3;}
if(a<1){a=1;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(1/a);}
return-(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p));},easeOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0;}
if(t===1){return 1;}
if(!p){p=0.3;}
if(a<1){a=1;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(1/a);}
return a*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/p)+1;},easeInOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0;}
if((t/=0.5)===2){return 1;}
if(!p){p=0.45;}
if(a<1){a=1;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(1/a);}
if(t<1){return-0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p));}
return a*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*0.5+1;},easeInBack:function(t){var s=1.70158;return t*t*((s+1)*t-s);},easeOutBack:function(t){var s=1.70158;return(t=t-1)*t*((s+1)*t+s)+1;},easeInOutBack:function(t){var s=1.70158;if((t/=0.5)<1){return 0.5*(t*t*(((s*=(1.525))+1)*t-s));}
return 0.5*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2);},easeInBounce:function(t){return 1-effects.easeOutBounce(1-t);},easeOutBounce:function(t){if(t<(1/2.75)){return 7.5625*t*t;}
if(t<(2/2.75)){return 7.5625*(t-=(1.5/2.75))*t+0.75;}
if(t<(2.5/2.75)){return 7.5625*(t-=(2.25/2.75))*t+0.9375;}
return 7.5625*(t-=(2.625/2.75))*t+0.984375;},easeInOutBounce:function(t){if(t<0.5){return effects.easeInBounce(t*2)*0.5;}
return effects.easeOutBounce(t*2-1)*0.5+0.5;}};var helpers_easing={effects:effects};helpers_core.easingEffects=effects;var PI=Math.PI;var RAD_PER_DEG=PI/180;var DOUBLE_PI=PI*2;var HALF_PI=PI/2;var QUARTER_PI=PI/4;var TWO_THIRDS_PI=PI*2/3;var exports$1={clear:function(chart){chart.ctx.clearRect(0,0,chart.width,chart.height);},roundedRect:function(ctx,x,y,width,height,radius){if(radius){var r=Math.min(radius,height/2,width/2);var left=x+r;var top=y+r;var right=x+width-r;var bottom=y+height-r;ctx.moveTo(x,top);if(left<right&&top<bottom){ctx.arc(left,top,r,-PI,-HALF_PI);ctx.arc(right,top,r,-HALF_PI,0);ctx.arc(right,bottom,r,0,HALF_PI);ctx.arc(left,bottom,r,HALF_PI,PI);}else if(left<right){ctx.moveTo(left,y);ctx.arc(right,top,r,-HALF_PI,HALF_PI);ctx.arc(left,top,r,HALF_PI,PI+HALF_PI);}else if(top<bottom){ctx.arc(left,top,r,-PI,0);ctx.arc(left,bottom,r,0,PI);}else{ctx.arc(left,top,r,-PI,PI);}
ctx.closePath();ctx.moveTo(x,y);}else{ctx.rect(x,y,width,height);}},drawPoint:function(ctx,style,radius,x,y,rotation){var type,xOffset,yOffset,size,cornerRadius;var rad=(rotation||0)*RAD_PER_DEG;if(style&&typeof style==='object'){type=style.toString();if(type==='[object HTMLImageElement]'||type==='[object HTMLCanvasElement]'){ctx.drawImage(style,x-style.width/2,y-style.height/2,style.width,style.height);return;}}
if(isNaN(radius)||radius<=0){return;}
ctx.beginPath();switch(style){default:ctx.arc(x,y,radius,0,DOUBLE_PI);ctx.closePath();break;case'triangle':ctx.moveTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius);rad+=TWO_THIRDS_PI;ctx.lineTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius);rad+=TWO_THIRDS_PI;ctx.lineTo(x+Math.sin(rad)*radius,y-Math.cos(rad)*radius);ctx.closePath();break;case'rectRounded':cornerRadius=radius*0.516;size=radius-cornerRadius;xOffset=Math.cos(rad+QUARTER_PI)*size;yOffset=Math.sin(rad+QUARTER_PI)*size;ctx.arc(x-xOffset,y-yOffset,cornerRadius,rad-PI,rad-HALF_PI);ctx.arc(x+yOffset,y-xOffset,cornerRadius,rad-HALF_PI,rad);ctx.arc(x+xOffset,y+yOffset,cornerRadius,rad,rad+HALF_PI);ctx.arc(x-yOffset,y+xOffset,cornerRadius,rad+HALF_PI,rad+PI);ctx.closePath();break;case'rect':if(!rotation){size=Math.SQRT1_2*radius;ctx.rect(x-size,y-size,2*size,2*size);break;}
rad+=QUARTER_PI;case'rectRot':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+yOffset,y-xOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.lineTo(x-yOffset,y+xOffset);ctx.closePath();break;case'crossRot':rad+=QUARTER_PI;case'cross':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x+yOffset,y-xOffset);ctx.lineTo(x-yOffset,y+xOffset);break;case'star':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x+yOffset,y-xOffset);ctx.lineTo(x-yOffset,y+xOffset);rad+=QUARTER_PI;xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x+yOffset,y-xOffset);ctx.lineTo(x-yOffset,y+xOffset);break;case'line':xOffset=Math.cos(rad)*radius;yOffset=Math.sin(rad)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);break;case'dash':ctx.moveTo(x,y);ctx.lineTo(x+Math.cos(rad)*radius,y+Math.sin(rad)*radius);break;}
ctx.fill();ctx.stroke();},_isPointInArea:function(point,area){var epsilon=1e-6;return point.x>area.left-epsilon&&point.x<area.right+epsilon&&point.y>area.top-epsilon&&point.y<area.bottom+epsilon;},clipArea:function(ctx,area){ctx.save();ctx.beginPath();ctx.rect(area.left,area.top,area.right-area.left,area.bottom-area.top);ctx.clip();},unclipArea:function(ctx){ctx.restore();},lineTo:function(ctx,previous,target,flip){var stepped=target.steppedLine;if(stepped){if(stepped==='middle'){var midpoint=(previous.x+target.x)/2.0;ctx.lineTo(midpoint,flip?target.y:previous.y);ctx.lineTo(midpoint,flip?previous.y:target.y);}else if((stepped==='after'&&!flip)||(stepped!=='after'&&flip)){ctx.lineTo(previous.x,target.y);}else{ctx.lineTo(target.x,previous.y);}
ctx.lineTo(target.x,target.y);return;}
if(!target.tension){ctx.lineTo(target.x,target.y);return;}
ctx.bezierCurveTo(flip?previous.controlPointPreviousX:previous.controlPointNextX,flip?previous.controlPointPreviousY:previous.controlPointNextY,flip?target.controlPointNextX:target.controlPointPreviousX,flip?target.controlPointNextY:target.controlPointPreviousY,target.x,target.y);}};var helpers_canvas=exports$1;helpers_core.clear=exports$1.clear;helpers_core.drawRoundedRectangle=function(ctx){ctx.beginPath();exports$1.roundedRect.apply(exports$1,arguments);};var defaults={_set:function(scope,values){return helpers_core.merge(this[scope]||(this[scope]={}),values);}};defaults._set('global',{defaultColor:'rgba(0,0,0,0.1)',defaultFontColor:'#666',defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:'normal',defaultLineHeight:1.2,showLines:true});var core_defaults=defaults;var valueOrDefault=helpers_core.valueOrDefault;function toFontString(font){if(!font||helpers_core.isNullOrUndef(font.size)||helpers_core.isNullOrUndef(font.family)){return null;}
return(font.style?font.style+' ':'')
+(font.weight?font.weight+' ':'')
+font.size+'px '
+font.family;}
var helpers_options={toLineHeight:function(value,size){var matches=(''+value).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!matches||matches[1]==='normal'){return size*1.2;}
value=+matches[2];switch(matches[3]){case'px':return value;case'%':value/=100;break;default:break;}
return size*value;},toPadding:function(value){var t,r,b,l;if(helpers_core.isObject(value)){t=+value.top||0;r=+value.right||0;b=+value.bottom||0;l=+value.left||0;}else{t=r=b=l=+value||0;}
return{top:t,right:r,bottom:b,left:l,height:t+b,width:l+r};},_parseFont:function(options){var globalDefaults=core_defaults.global;var size=valueOrDefault(options.fontSize,globalDefaults.defaultFontSize);var font={family:valueOrDefault(options.fontFamily,globalDefaults.defaultFontFamily),lineHeight:helpers_core.options.toLineHeight(valueOrDefault(options.lineHeight,globalDefaults.defaultLineHeight),size),size:size,style:valueOrDefault(options.fontStyle,globalDefaults.defaultFontStyle),weight:null,string:''};font.string=toFontString(font);return font;},resolve:function(inputs,context,index){var i,ilen,value;for(i=0,ilen=inputs.length;i<ilen;++i){value=inputs[i];if(value===undefined){continue;}
if(context!==undefined&&typeof value==='function'){value=value(context);}
if(index!==undefined&&helpers_core.isArray(value)){value=value[index];}
if(value!==undefined){return value;}}}};var helpers$1=helpers_core;var easing=helpers_easing;var canvas=helpers_canvas;var options=helpers_options;helpers$1.easing=easing;helpers$1.canvas=canvas;helpers$1.options=options;function interpolate(start,view,model,ease){var keys=Object.keys(model);var i,ilen,key,actual,origin,target,type,c0,c1;for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];target=model[key];if(!view.hasOwnProperty(key)){view[key]=target;}
actual=view[key];if(actual===target||key[0]==='_'){continue;}
if(!start.hasOwnProperty(key)){start[key]=actual;}
origin=start[key];type=typeof target;if(type===typeof origin){if(type==='string'){c0=chartjsColor(origin);if(c0.valid){c1=chartjsColor(target);if(c1.valid){view[key]=c1.mix(c0,ease).rgbString();continue;}}}else if(helpers$1.isFinite(origin)&&helpers$1.isFinite(target)){view[key]=origin+(target-origin)*ease;continue;}}
view[key]=target;}}
var Element=function(configuration){helpers$1.extend(this,configuration);this.initialize.apply(this,arguments);};helpers$1.extend(Element.prototype,{initialize:function(){this.hidden=false;},pivot:function(){var me=this;if(!me._view){me._view=helpers$1.clone(me._model);}
me._start={};return me;},transition:function(ease){var me=this;var model=me._model;var start=me._start;var view=me._view;if(!model||ease===1){me._view=model;me._start=null;return me;}
if(!view){view=me._view={};}
if(!start){start=me._start={};}
interpolate(start,view,model,ease);return me;},tooltipPosition:function(){return{x:this._model.x,y:this._model.y};},hasValue:function(){return helpers$1.isNumber(this._model.x)&&helpers$1.isNumber(this._model.y);}});Element.extend=helpers$1.inherits;var core_element=Element;var exports$2=core_element.extend({chart:null,currentStep:0,numSteps:60,easing:'',render:null,onAnimationProgress:null,onAnimationComplete:null,});var core_animation=exports$2;Object.defineProperty(exports$2.prototype,'animationObject',{get:function(){return this;}});Object.defineProperty(exports$2.prototype,'chartInstance',{get:function(){return this.chart;},set:function(value){this.chart=value;}});core_defaults._set('global',{animation:{duration:1000,easing:'easeOutQuart',onProgress:helpers$1.noop,onComplete:helpers$1.noop}});var core_animations={animations:[],request:null,addAnimation:function(chart,animation,duration,lazy){var animations=this.animations;var i,ilen;animation.chart=chart;animation.startTime=Date.now();animation.duration=duration;if(!lazy){chart.animating=true;}
for(i=0,ilen=animations.length;i<ilen;++i){if(animations[i].chart===chart){animations[i]=animation;return;}}
animations.push(animation);if(animations.length===1){this.requestAnimationFrame();}},cancelAnimation:function(chart){var index=helpers$1.findIndex(this.animations,function(animation){return animation.chart===chart;});if(index!==-1){this.animations.splice(index,1);chart.animating=false;}},requestAnimationFrame:function(){var me=this;if(me.request===null){me.request=helpers$1.requestAnimFrame.call(window,function(){me.request=null;me.startDigest();});}},startDigest:function(){var me=this;me.advance();if(me.animations.length>0){me.requestAnimationFrame();}},advance:function(){var animations=this.animations;var animation,chart,numSteps,nextStep;var i=0;while(i<animations.length){animation=animations[i];chart=animation.chart;numSteps=animation.numSteps;nextStep=Math.floor((Date.now()-animation.startTime)/animation.duration*numSteps)+1;animation.currentStep=Math.min(nextStep,numSteps);helpers$1.callback(animation.render,[chart,animation],chart);helpers$1.callback(animation.onAnimationProgress,[animation],chart);if(animation.currentStep>=numSteps){helpers$1.callback(animation.onAnimationComplete,[animation],chart);chart.animating=false;animations.splice(i,1);}else{++i;}}}};var resolve=helpers$1.options.resolve;var arrayEvents=['push','pop','shift','splice','unshift'];function listenArrayEvents(array,listener){if(array._chartjs){array._chartjs.listeners.push(listener);return;}
Object.defineProperty(array,'_chartjs',{configurable:true,enumerable:false,value:{listeners:[listener]}});arrayEvents.forEach(function(key){var method='onData'+key.charAt(0).toUpperCase()+key.slice(1);var base=array[key];Object.defineProperty(array,key,{configurable:true,enumerable:false,value:function(){var args=Array.prototype.slice.call(arguments);var res=base.apply(this,args);helpers$1.each(array._chartjs.listeners,function(object){if(typeof object[method]==='function'){object[method].apply(object,args);}});return res;}});});}
function unlistenArrayEvents(array,listener){var stub=array._chartjs;if(!stub){return;}
var listeners=stub.listeners;var index=listeners.indexOf(listener);if(index!==-1){listeners.splice(index,1);}
if(listeners.length>0){return;}
arrayEvents.forEach(function(key){delete array[key];});delete array._chartjs;}
var DatasetController=function(chart,datasetIndex){this.initialize(chart,datasetIndex);};helpers$1.extend(DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(chart,datasetIndex){var me=this;me.chart=chart;me.index=datasetIndex;me.linkScales();me.addElements();},updateIndex:function(datasetIndex){this.index=datasetIndex;},linkScales:function(){var me=this;var meta=me.getMeta();var dataset=me.getDataset();if(meta.xAxisID===null||!(meta.xAxisID in me.chart.scales)){meta.xAxisID=dataset.xAxisID||me.chart.options.scales.xAxes[0].id;}
if(meta.yAxisID===null||!(meta.yAxisID in me.chart.scales)){meta.yAxisID=dataset.yAxisID||me.chart.options.scales.yAxes[0].id;}},getDataset:function(){return this.chart.data.datasets[this.index];},getMeta:function(){return this.chart.getDatasetMeta(this.index);},getScaleForId:function(scaleID){return this.chart.scales[scaleID];},_getValueScaleId:function(){return this.getMeta().yAxisID;},_getIndexScaleId:function(){return this.getMeta().xAxisID;},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId());},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId());},reset:function(){this.update(true);},destroy:function(){if(this._data){unlistenArrayEvents(this._data,this);}},createMetaDataset:function(){var me=this;var type=me.datasetElementType;return type&&new type({_chart:me.chart,_datasetIndex:me.index});},createMetaData:function(index){var me=this;var type=me.dataElementType;return type&&new type({_chart:me.chart,_datasetIndex:me.index,_index:index});},addElements:function(){var me=this;var meta=me.getMeta();var data=me.getDataset().data||[];var metaData=meta.data;var i,ilen;for(i=0,ilen=data.length;i<ilen;++i){metaData[i]=metaData[i]||me.createMetaData(i);}
meta.dataset=meta.dataset||me.createMetaDataset();},addElementAndReset:function(index){var element=this.createMetaData(index);this.getMeta().data.splice(index,0,element);this.updateElement(element,index,true);},buildOrUpdateElements:function(){var me=this;var dataset=me.getDataset();var data=dataset.data||(dataset.data=[]);if(me._data!==data){if(me._data){unlistenArrayEvents(me._data,me);}
if(data&&Object.isExtensible(data)){listenArrayEvents(data,me);}
me._data=data;}
me.resyncElements();},update:helpers$1.noop,transition:function(easingValue){var meta=this.getMeta();var elements=meta.data||[];var ilen=elements.length;var i=0;for(;i<ilen;++i){elements[i].transition(easingValue);}
if(meta.dataset){meta.dataset.transition(easingValue);}},draw:function(){var meta=this.getMeta();var elements=meta.data||[];var ilen=elements.length;var i=0;if(meta.dataset){meta.dataset.draw();}
for(;i<ilen;++i){elements[i].draw();}},removeHoverStyle:function(element){helpers$1.merge(element._model,element.$previousStyle||{});delete element.$previousStyle;},setHoverStyle:function(element){var dataset=this.chart.data.datasets[element._datasetIndex];var index=element._index;var custom=element.custom||{};var model=element._model;var getHoverColor=helpers$1.getHoverColor;element.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth};model.backgroundColor=resolve([custom.hoverBackgroundColor,dataset.hoverBackgroundColor,getHoverColor(model.backgroundColor)],undefined,index);model.borderColor=resolve([custom.hoverBorderColor,dataset.hoverBorderColor,getHoverColor(model.borderColor)],undefined,index);model.borderWidth=resolve([custom.hoverBorderWidth,dataset.hoverBorderWidth,model.borderWidth],undefined,index);},resyncElements:function(){var me=this;var meta=me.getMeta();var data=me.getDataset().data;var numMeta=meta.data.length;var numData=data.length;if(numData<numMeta){meta.data.splice(numData,numMeta-numData);}else if(numData>numMeta){me.insertElements(numMeta,numData-numMeta);}},insertElements:function(start,count){for(var i=0;i<count;++i){this.addElementAndReset(start+i);}},onDataPush:function(){var count=arguments.length;this.insertElements(this.getDataset().data.length-count,count);},onDataPop:function(){this.getMeta().data.pop();},onDataShift:function(){this.getMeta().data.shift();},onDataSplice:function(start,count){this.getMeta().data.splice(start,count);this.insertElements(start,arguments.length-2);},onDataUnshift:function(){this.insertElements(0,arguments.length);}});DatasetController.extend=helpers$1.inherits;var core_datasetController=DatasetController;core_defaults._set('global',{elements:{arc:{backgroundColor:core_defaults.global.defaultColor,borderColor:'#fff',borderWidth:2,borderAlign:'center'}}});var element_arc=core_element.extend({inLabelRange:function(mouseX){var vm=this._view;if(vm){return(Math.pow(mouseX-vm.x,2)<Math.pow(vm.radius+vm.hoverRadius,2));}
return false;},inRange:function(chartX,chartY){var vm=this._view;if(vm){var pointRelativePosition=helpers$1.getAngleFromPoint(vm,{x:chartX,y:chartY});var angle=pointRelativePosition.angle;var distance=pointRelativePosition.distance;var startAngle=vm.startAngle;var endAngle=vm.endAngle;while(endAngle<startAngle){endAngle+=2.0*Math.PI;}
while(angle>endAngle){angle-=2.0*Math.PI;}
while(angle<startAngle){angle+=2.0*Math.PI;}
var betweenAngles=(angle>=startAngle&&angle<=endAngle);var withinRadius=(distance>=vm.innerRadius&&distance<=vm.outerRadius);return(betweenAngles&&withinRadius);}
return false;},getCenterPoint:function(){var vm=this._view;var halfAngle=(vm.startAngle+vm.endAngle)/2;var halfRadius=(vm.innerRadius+vm.outerRadius)/2;return{x:vm.x+Math.cos(halfAngle)*halfRadius,y:vm.y+Math.sin(halfAngle)*halfRadius};},getArea:function(){var vm=this._view;return Math.PI*((vm.endAngle-vm.startAngle)/(2*Math.PI))*(Math.pow(vm.outerRadius,2)-Math.pow(vm.innerRadius,2));},tooltipPosition:function(){var vm=this._view;var centreAngle=vm.startAngle+((vm.endAngle-vm.startAngle)/2);var rangeFromCentre=(vm.outerRadius-vm.innerRadius)/2+vm.innerRadius;return{x:vm.x+(Math.cos(centreAngle)*rangeFromCentre),y:vm.y+(Math.sin(centreAngle)*rangeFromCentre)};},draw:function(){var ctx=this._chart.ctx;var vm=this._view;var sA=vm.startAngle;var eA=vm.endAngle;var pixelMargin=(vm.borderAlign==='inner')?0.33:0;var angleMargin;ctx.save();ctx.beginPath();ctx.arc(vm.x,vm.y,Math.max(vm.outerRadius-pixelMargin,0),sA,eA);ctx.arc(vm.x,vm.y,vm.innerRadius,eA,sA,true);ctx.closePath();ctx.fillStyle=vm.backgroundColor;ctx.fill();if(vm.borderWidth){if(vm.borderAlign==='inner'){ctx.beginPath();angleMargin=pixelMargin/vm.outerRadius;ctx.arc(vm.x,vm.y,vm.outerRadius,sA-angleMargin,eA+angleMargin);if(vm.innerRadius>pixelMargin){angleMargin=pixelMargin/vm.innerRadius;ctx.arc(vm.x,vm.y,vm.innerRadius-pixelMargin,eA+angleMargin,sA-angleMargin,true);}else{ctx.arc(vm.x,vm.y,pixelMargin,eA+Math.PI/2,sA-Math.PI/2);}
ctx.closePath();ctx.clip();ctx.beginPath();ctx.arc(vm.x,vm.y,vm.outerRadius,sA,eA);ctx.arc(vm.x,vm.y,vm.innerRadius,eA,sA,true);ctx.closePath();ctx.lineWidth=vm.borderWidth*2;ctx.lineJoin='round';}else{ctx.lineWidth=vm.borderWidth;ctx.lineJoin='bevel';}
ctx.strokeStyle=vm.borderColor;ctx.stroke();}
ctx.restore();}});var valueOrDefault$1=helpers$1.valueOrDefault;var defaultColor=core_defaults.global.defaultColor;core_defaults._set('global',{elements:{line:{tension:0.4,backgroundColor:defaultColor,borderWidth:3,borderColor:defaultColor,borderCapStyle:'butt',borderDash:[],borderDashOffset:0.0,borderJoinStyle:'miter',capBezierPoints:true,fill:true,}}});var element_line=core_element.extend({draw:function(){var me=this;var vm=me._view;var ctx=me._chart.ctx;var spanGaps=vm.spanGaps;var points=me._children.slice();var globalDefaults=core_defaults.global;var globalOptionLineElements=globalDefaults.elements.line;var lastDrawnIndex=-1;var index,current,previous,currentVM;if(me._loop&&points.length){points.push(points[0]);}
ctx.save();ctx.lineCap=vm.borderCapStyle||globalOptionLineElements.borderCapStyle;if(ctx.setLineDash){ctx.setLineDash(vm.borderDash||globalOptionLineElements.borderDash);}
ctx.lineDashOffset=valueOrDefault$1(vm.borderDashOffset,globalOptionLineElements.borderDashOffset);ctx.lineJoin=vm.borderJoinStyle||globalOptionLineElements.borderJoinStyle;ctx.lineWidth=valueOrDefault$1(vm.borderWidth,globalOptionLineElements.borderWidth);ctx.strokeStyle=vm.borderColor||globalDefaults.defaultColor;ctx.beginPath();lastDrawnIndex=-1;for(index=0;index<points.length;++index){current=points[index];previous=helpers$1.previousItem(points,index);currentVM=current._view;if(index===0){if(!currentVM.skip){ctx.moveTo(currentVM.x,currentVM.y);lastDrawnIndex=index;}}else{previous=lastDrawnIndex===-1?previous:points[lastDrawnIndex];if(!currentVM.skip){if((lastDrawnIndex!==(index-1)&&!spanGaps)||lastDrawnIndex===-1){ctx.moveTo(currentVM.x,currentVM.y);}else{helpers$1.canvas.lineTo(ctx,previous._view,current._view);}
lastDrawnIndex=index;}}}
ctx.stroke();ctx.restore();}});var valueOrDefault$2=helpers$1.valueOrDefault;var defaultColor$1=core_defaults.global.defaultColor;core_defaults._set('global',{elements:{point:{radius:3,pointStyle:'circle',backgroundColor:defaultColor$1,borderColor:defaultColor$1,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});function xRange(mouseX){var vm=this._view;return vm?(Math.abs(mouseX-vm.x)<vm.radius+vm.hitRadius):false;}
function yRange(mouseY){var vm=this._view;return vm?(Math.abs(mouseY-vm.y)<vm.radius+vm.hitRadius):false;}
var element_point=core_element.extend({inRange:function(mouseX,mouseY){var vm=this._view;return vm?((Math.pow(mouseX-vm.x,2)+Math.pow(mouseY-vm.y,2))<Math.pow(vm.hitRadius+vm.radius,2)):false;},inLabelRange:xRange,inXRange:xRange,inYRange:yRange,getCenterPoint:function(){var vm=this._view;return{x:vm.x,y:vm.y};},getArea:function(){return Math.PI*Math.pow(this._view.radius,2);},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y,padding:vm.radius+vm.borderWidth};},draw:function(chartArea){var vm=this._view;var ctx=this._chart.ctx;var pointStyle=vm.pointStyle;var rotation=vm.rotation;var radius=vm.radius;var x=vm.x;var y=vm.y;var globalDefaults=core_defaults.global;var defaultColor=globalDefaults.defaultColor;if(vm.skip){return;}
if(chartArea===undefined||helpers$1.canvas._isPointInArea(vm,chartArea)){ctx.strokeStyle=vm.borderColor||defaultColor;ctx.lineWidth=valueOrDefault$2(vm.borderWidth,globalDefaults.elements.point.borderWidth);ctx.fillStyle=vm.backgroundColor||defaultColor;helpers$1.canvas.drawPoint(ctx,pointStyle,radius,x,y,rotation);}}});var defaultColor$2=core_defaults.global.defaultColor;core_defaults._set('global',{elements:{rectangle:{backgroundColor:defaultColor$2,borderColor:defaultColor$2,borderSkipped:'bottom',borderWidth:0}}});function isVertical(vm){return vm&&vm.width!==undefined;}
function getBarBounds(vm){var x1,x2,y1,y2,half;if(isVertical(vm)){half=vm.width/2;x1=vm.x-half;x2=vm.x+half;y1=Math.min(vm.y,vm.base);y2=Math.max(vm.y,vm.base);}else{half=vm.height/2;x1=Math.min(vm.x,vm.base);x2=Math.max(vm.x,vm.base);y1=vm.y-half;y2=vm.y+half;}
return{left:x1,top:y1,right:x2,bottom:y2};}
function swap(orig,v1,v2){return orig===v1?v2:orig===v2?v1:orig;}
function parseBorderSkipped(vm){var edge=vm.borderSkipped;var res={};if(!edge){return res;}
if(vm.horizontal){if(vm.base>vm.x){edge=swap(edge,'left','right');}}else if(vm.base<vm.y){edge=swap(edge,'bottom','top');}
res[edge]=true;return res;}
function parseBorderWidth(vm,maxW,maxH){var value=vm.borderWidth;var skip=parseBorderSkipped(vm);var t,r,b,l;if(helpers$1.isObject(value)){t=+value.top||0;r=+value.right||0;b=+value.bottom||0;l=+value.left||0;}else{t=r=b=l=+value||0;}
return{t:skip.top||(t<0)?0:t>maxH?maxH:t,r:skip.right||(r<0)?0:r>maxW?maxW:r,b:skip.bottom||(b<0)?0:b>maxH?maxH:b,l:skip.left||(l<0)?0:l>maxW?maxW:l};}
function boundingRects(vm){var bounds=getBarBounds(vm);var width=bounds.right-bounds.left;var height=bounds.bottom-bounds.top;var border=parseBorderWidth(vm,width/2,height/2);return{outer:{x:bounds.left,y:bounds.top,w:width,h:height},inner:{x:bounds.left+border.l,y:bounds.top+border.t,w:width-border.l-border.r,h:height-border.t-border.b}};}
function inRange(vm,x,y){var skipX=x===null;var skipY=y===null;var bounds=!vm||(skipX&&skipY)?false:getBarBounds(vm);return bounds&&(skipX||x>=bounds.left&&x<=bounds.right)&&(skipY||y>=bounds.top&&y<=bounds.bottom);}
var element_rectangle=core_element.extend({draw:function(){var ctx=this._chart.ctx;var vm=this._view;var rects=boundingRects(vm);var outer=rects.outer;var inner=rects.inner;ctx.fillStyle=vm.backgroundColor;ctx.fillRect(outer.x,outer.y,outer.w,outer.h);if(outer.w===inner.w&&outer.h===inner.h){return;}
ctx.save();ctx.beginPath();ctx.rect(outer.x,outer.y,outer.w,outer.h);ctx.clip();ctx.fillStyle=vm.borderColor;ctx.rect(inner.x,inner.y,inner.w,inner.h);ctx.fill('evenodd');ctx.restore();},height:function(){var vm=this._view;return vm.base-vm.y;},inRange:function(mouseX,mouseY){return inRange(this._view,mouseX,mouseY);},inLabelRange:function(mouseX,mouseY){var vm=this._view;return isVertical(vm)?inRange(vm,mouseX,null):inRange(vm,null,mouseY);},inXRange:function(mouseX){return inRange(this._view,mouseX,null);},inYRange:function(mouseY){return inRange(this._view,null,mouseY);},getCenterPoint:function(){var vm=this._view;var x,y;if(isVertical(vm)){x=vm.x;y=(vm.y+vm.base)/2;}else{x=(vm.x+vm.base)/2;y=vm.y;}
return{x:x,y:y};},getArea:function(){var vm=this._view;return isVertical(vm)?vm.width*Math.abs(vm.y-vm.base):vm.height*Math.abs(vm.x-vm.base);},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y};}});var elements={};var Arc=element_arc;var Line=element_line;var Point=element_point;var Rectangle=element_rectangle;elements.Arc=Arc;elements.Line=Line;elements.Point=Point;elements.Rectangle=Rectangle;var resolve$1=helpers$1.options.resolve;core_defaults._set('bar',{hover:{mode:'label'},scales:{xAxes:[{type:'category',categoryPercentage:0.8,barPercentage:0.9,offset:true,gridLines:{offsetGridLines:true}}],yAxes:[{type:'linear'}]}});function computeMinSampleSize(scale,pixels){var min=scale.isHorizontal()?scale.width:scale.height;var ticks=scale.getTicks();var prev,curr,i,ilen;for(i=1,ilen=pixels.length;i<ilen;++i){min=Math.min(min,Math.abs(pixels[i]-pixels[i-1]));}
for(i=0,ilen=ticks.length;i<ilen;++i){curr=scale.getPixelForTick(i);min=i>0?Math.min(min,curr-prev):min;prev=curr;}
return min;}
function computeFitCategoryTraits(index,ruler,options){var thickness=options.barThickness;var count=ruler.stackCount;var curr=ruler.pixels[index];var size,ratio;if(helpers$1.isNullOrUndef(thickness)){size=ruler.min*options.categoryPercentage;ratio=options.barPercentage;}else{size=thickness*count;ratio=1;}
return{chunk:size/count,ratio:ratio,start:curr-(size/2)};}
function computeFlexCategoryTraits(index,ruler,options){var pixels=ruler.pixels;var curr=pixels[index];var prev=index>0?pixels[index-1]:null;var next=index<pixels.length-1?pixels[index+1]:null;var percent=options.categoryPercentage;var start,size;if(prev===null){prev=curr-(next===null?ruler.end-ruler.start:next-curr);}
if(next===null){next=curr+curr-prev;}
start=curr-(curr-Math.min(prev,next))/2*percent;size=Math.abs(next-prev)/2*percent;return{chunk:size/ruler.stackCount,ratio:options.barPercentage,start:start};}
var controller_bar=core_datasetController.extend({dataElementType:elements.Rectangle,initialize:function(){var me=this;var meta;core_datasetController.prototype.initialize.apply(me,arguments);meta=me.getMeta();meta.stack=me.getDataset().stack;meta.bar=true;},update:function(reset){var me=this;var rects=me.getMeta().data;var i,ilen;me._ruler=me.getRuler();for(i=0,ilen=rects.length;i<ilen;++i){me.updateElement(rects[i],i,reset);}},updateElement:function(rectangle,index,reset){var me=this;var meta=me.getMeta();var dataset=me.getDataset();var options=me._resolveElementOptions(rectangle,index);rectangle._xScale=me.getScaleForId(meta.xAxisID);rectangle._yScale=me.getScaleForId(meta.yAxisID);rectangle._datasetIndex=me.index;rectangle._index=index;rectangle._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderSkipped:options.borderSkipped,borderWidth:options.borderWidth,datasetLabel:dataset.label,label:me.chart.data.labels[index]};me._updateElementGeometry(rectangle,index,reset);rectangle.pivot();},_updateElementGeometry:function(rectangle,index,reset){var me=this;var model=rectangle._model;var vscale=me._getValueScale();var base=vscale.getBasePixel();var horizontal=vscale.isHorizontal();var ruler=me._ruler||me.getRuler();var vpixels=me.calculateBarValuePixels(me.index,index);var ipixels=me.calculateBarIndexPixels(me.index,index,ruler);model.horizontal=horizontal;model.base=reset?base:vpixels.base;model.x=horizontal?reset?base:vpixels.head:ipixels.center;model.y=horizontal?ipixels.center:reset?base:vpixels.head;model.height=horizontal?ipixels.size:undefined;model.width=horizontal?undefined:ipixels.size;},_getStacks:function(last){var me=this;var chart=me.chart;var scale=me._getIndexScale();var stacked=scale.options.stacked;var ilen=last===undefined?chart.data.datasets.length:last+1;var stacks=[];var i,meta;for(i=0;i<ilen;++i){meta=chart.getDatasetMeta(i);if(meta.bar&&chart.isDatasetVisible(i)&&(stacked===false||(stacked===true&&stacks.indexOf(meta.stack)===-1)||(stacked===undefined&&(meta.stack===undefined||stacks.indexOf(meta.stack)===-1)))){stacks.push(meta.stack);}}
return stacks;},getStackCount:function(){return this._getStacks().length;},getStackIndex:function(datasetIndex,name){var stacks=this._getStacks(datasetIndex);var index=(name!==undefined)?stacks.indexOf(name):-1;return(index===-1)?stacks.length-1:index;},getRuler:function(){var me=this;var scale=me._getIndexScale();var stackCount=me.getStackCount();var datasetIndex=me.index;var isHorizontal=scale.isHorizontal();var start=isHorizontal?scale.left:scale.top;var end=start+(isHorizontal?scale.width:scale.height);var pixels=[];var i,ilen,min;for(i=0,ilen=me.getMeta().data.length;i<ilen;++i){pixels.push(scale.getPixelForValue(null,i,datasetIndex));}
min=helpers$1.isNullOrUndef(scale.options.barThickness)?computeMinSampleSize(scale,pixels):-1;return{min:min,pixels:pixels,start:start,end:end,stackCount:stackCount,scale:scale};},calculateBarValuePixels:function(datasetIndex,index){var me=this;var chart=me.chart;var meta=me.getMeta();var scale=me._getValueScale();var isHorizontal=scale.isHorizontal();var datasets=chart.data.datasets;var value=+scale.getRightValue(datasets[datasetIndex].data[index]);var minBarLength=scale.options.minBarLength;var stacked=scale.options.stacked;var stack=meta.stack;var start=0;var i,imeta,ivalue,base,head,size;if(stacked||(stacked===undefined&&stack!==undefined)){for(i=0;i<datasetIndex;++i){imeta=chart.getDatasetMeta(i);if(imeta.bar&&imeta.stack===stack&&imeta.controller._getValueScaleId()===scale.id&&chart.isDatasetVisible(i)){ivalue=+scale.getRightValue(datasets[i].data[index]);if((value<0&&ivalue<0)||(value>=0&&ivalue>0)){start+=ivalue;}}}}
base=scale.getPixelForValue(start);head=scale.getPixelForValue(start+value);size=head-base;if(minBarLength!==undefined&&Math.abs(size)<minBarLength){size=minBarLength;if(value>=0&&!isHorizontal||value<0&&isHorizontal){head=base-minBarLength;}else{head=base+minBarLength;}}
return{size:size,base:base,head:head,center:head+size/2};},calculateBarIndexPixels:function(datasetIndex,index,ruler){var me=this;var options=ruler.scale.options;var range=options.barThickness==='flex'?computeFlexCategoryTraits(index,ruler,options):computeFitCategoryTraits(index,ruler,options);var stackIndex=me.getStackIndex(datasetIndex,me.getMeta().stack);var center=range.start+(range.chunk*stackIndex)+(range.chunk/2);var size=Math.min(helpers$1.valueOrDefault(options.maxBarThickness,Infinity),range.chunk*range.ratio);return{base:center-size/2,head:center+size/2,center:center,size:size};},draw:function(){var me=this;var chart=me.chart;var scale=me._getValueScale();var rects=me.getMeta().data;var dataset=me.getDataset();var ilen=rects.length;var i=0;helpers$1.canvas.clipArea(chart.ctx,chart.chartArea);for(;i<ilen;++i){if(!isNaN(scale.getRightValue(dataset.data[i]))){rects[i].draw();}}
helpers$1.canvas.unclipArea(chart.ctx);},_resolveElementOptions:function(rectangle,index){var me=this;var chart=me.chart;var datasets=chart.data.datasets;var dataset=datasets[me.index];var custom=rectangle.custom||{};var options=chart.options.elements.rectangle;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderSkipped','borderWidth'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$1([custom[key],dataset[key],options[key]],context,index);}
return values;}});var valueOrDefault$3=helpers$1.valueOrDefault;var resolve$2=helpers$1.options.resolve;core_defaults._set('bubble',{hover:{mode:'single'},scales:{xAxes:[{type:'linear',position:'bottom',id:'x-axis-0'}],yAxes:[{type:'linear',position:'left',id:'y-axis-0'}]},tooltips:{callbacks:{title:function(){return'';},label:function(item,data){var datasetLabel=data.datasets[item.datasetIndex].label||'';var dataPoint=data.datasets[item.datasetIndex].data[item.index];return datasetLabel+': ('+item.xLabel+', '+item.yLabel+', '+dataPoint.r+')';}}}});var controller_bubble=core_datasetController.extend({dataElementType:elements.Point,update:function(reset){var me=this;var meta=me.getMeta();var points=meta.data;helpers$1.each(points,function(point,index){me.updateElement(point,index,reset);});},updateElement:function(point,index,reset){var me=this;var meta=me.getMeta();var custom=point.custom||{};var xScale=me.getScaleForId(meta.xAxisID);var yScale=me.getScaleForId(meta.yAxisID);var options=me._resolveElementOptions(point,index);var data=me.getDataset().data[index];var dsIndex=me.index;var x=reset?xScale.getPixelForDecimal(0.5):xScale.getPixelForValue(typeof data==='object'?data:NaN,index,dsIndex);var y=reset?yScale.getBasePixel():yScale.getPixelForValue(data,index,dsIndex);point._xScale=xScale;point._yScale=yScale;point._options=options;point._datasetIndex=dsIndex;point._index=index;point._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,hitRadius:options.hitRadius,pointStyle:options.pointStyle,rotation:options.rotation,radius:reset?0:options.radius,skip:custom.skip||isNaN(x)||isNaN(y),x:x,y:y,};point.pivot();},setHoverStyle:function(point){var model=point._model;var options=point._options;var getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius};model.backgroundColor=valueOrDefault$3(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$3(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$3(options.hoverBorderWidth,options.borderWidth);model.radius=options.radius+options.hoverRadius;},_resolveElementOptions:function(point,index){var me=this;var chart=me.chart;var datasets=chart.data.datasets;var dataset=datasets[me.index];var custom=point.custom||{};var options=chart.options.elements.point;var data=dataset.data[index];var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderWidth','hoverBackgroundColor','hoverBorderColor','hoverBorderWidth','hoverRadius','hitRadius','pointStyle','rotation'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$2([custom[key],dataset[key],options[key]],context,index);}
values.radius=resolve$2([custom.radius,data?data.r:undefined,dataset.radius,options.radius],context,index);return values;}});var resolve$3=helpers$1.options.resolve;var valueOrDefault$4=helpers$1.valueOrDefault;core_defaults._set('doughnut',{animation:{animateRotate:true,animateScale:false},hover:{mode:'single'},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data;var datasets=data.datasets;var labels=data.labels;if(datasets.length){for(var i=0;i<datasets[0].data.length;++i){text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>');if(labels[i]){text.push(labels[i]);}
text.push('</li>');}}
text.push('</ul>');return text.join('');},legend:{labels:{generateLabels:function(chart){var data=chart.data;if(data.labels.length&&data.datasets.length){return data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0);var ds=data.datasets[0];var arc=meta.data[i];var custom=arc&&arc.custom||{};var arcOpts=chart.options.elements.arc;var fill=resolve$3([custom.backgroundColor,ds.backgroundColor,arcOpts.backgroundColor],undefined,i);var stroke=resolve$3([custom.borderColor,ds.borderColor,arcOpts.borderColor],undefined,i);var bw=resolve$3([custom.borderWidth,ds.borderWidth,arcOpts.borderWidth],undefined,i);return{text:label,fillStyle:fill,strokeStyle:stroke,lineWidth:bw,hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i};});}
return[];}},onClick:function(e,legendItem){var index=legendItem.index;var chart=this.chart;var i,ilen,meta;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){meta=chart.getDatasetMeta(i);if(meta.data[index]){meta.data[index].hidden=!meta.data[index].hidden;}}
chart.update();}},cutoutPercentage:50,rotation:Math.PI*-0.5,circumference:Math.PI*2.0,tooltips:{callbacks:{title:function(){return'';},label:function(tooltipItem,data){var dataLabel=data.labels[tooltipItem.index];var value=': '+data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];if(helpers$1.isArray(dataLabel)){dataLabel=dataLabel.slice();dataLabel[0]+=value;}else{dataLabel+=value;}
return dataLabel;}}}});var controller_doughnut=core_datasetController.extend({dataElementType:elements.Arc,linkScales:helpers$1.noop,getRingIndex:function(datasetIndex){var ringIndex=0;for(var j=0;j<datasetIndex;++j){if(this.chart.isDatasetVisible(j)){++ringIndex;}}
return ringIndex;},update:function(reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var availableWidth=chartArea.right-chartArea.left;var availableHeight=chartArea.bottom-chartArea.top;var minSize=Math.min(availableWidth,availableHeight);var offset={x:0,y:0};var meta=me.getMeta();var arcs=meta.data;var cutoutPercentage=opts.cutoutPercentage;var circumference=opts.circumference;var chartWeight=me._getRingWeight(me.index);var i,ilen;if(circumference<Math.PI*2.0){var startAngle=opts.rotation%(Math.PI*2.0);startAngle+=Math.PI*2.0*(startAngle>=Math.PI?-1:startAngle<-Math.PI?1:0);var endAngle=startAngle+circumference;var start={x:Math.cos(startAngle),y:Math.sin(startAngle)};var end={x:Math.cos(endAngle),y:Math.sin(endAngle)};var contains0=(startAngle<=0&&endAngle>=0)||(startAngle<=Math.PI*2.0&&Math.PI*2.0<=endAngle);var contains90=(startAngle<=Math.PI*0.5&&Math.PI*0.5<=endAngle)||(startAngle<=Math.PI*2.5&&Math.PI*2.5<=endAngle);var contains180=(startAngle<=-Math.PI&&-Math.PI<=endAngle)||(startAngle<=Math.PI&&Math.PI<=endAngle);var contains270=(startAngle<=-Math.PI*0.5&&-Math.PI*0.5<=endAngle)||(startAngle<=Math.PI*1.5&&Math.PI*1.5<=endAngle);var cutout=cutoutPercentage/100.0;var min={x:contains180?-1:Math.min(start.x*(start.x<0?1:cutout),end.x*(end.x<0?1:cutout)),y:contains270?-1:Math.min(start.y*(start.y<0?1:cutout),end.y*(end.y<0?1:cutout))};var max={x:contains0?1:Math.max(start.x*(start.x>0?1:cutout),end.x*(end.x>0?1:cutout)),y:contains90?1:Math.max(start.y*(start.y>0?1:cutout),end.y*(end.y>0?1:cutout))};var size={width:(max.x-min.x)*0.5,height:(max.y-min.y)*0.5};minSize=Math.min(availableWidth/size.width,availableHeight/size.height);offset={x:(max.x+min.x)*-0.5,y:(max.y+min.y)*-0.5};}
for(i=0,ilen=arcs.length;i<ilen;++i){arcs[i]._options=me._resolveElementOptions(arcs[i],i);}
chart.borderWidth=me.getMaxBorderWidth();chart.outerRadius=Math.max((minSize-chart.borderWidth)/2,0);chart.innerRadius=Math.max(cutoutPercentage?(chart.outerRadius/100)*(cutoutPercentage):0,0);chart.radiusLength=(chart.outerRadius-chart.innerRadius)/(me._getVisibleDatasetWeightTotal()||1);chart.offsetX=offset.x*chart.outerRadius;chart.offsetY=offset.y*chart.outerRadius;meta.total=me.calculateTotal();me.outerRadius=chart.outerRadius-chart.radiusLength*me._getRingWeightOffset(me.index);me.innerRadius=Math.max(me.outerRadius-chart.radiusLength*chartWeight,0);for(i=0,ilen=arcs.length;i<ilen;++i){me.updateElement(arcs[i],i,reset);}},updateElement:function(arc,index,reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var animationOpts=opts.animation;var centerX=(chartArea.left+chartArea.right)/2;var centerY=(chartArea.top+chartArea.bottom)/2;var startAngle=opts.rotation;var endAngle=opts.rotation;var dataset=me.getDataset();var circumference=reset&&animationOpts.animateRotate?0:arc.hidden?0:me.calculateCircumference(dataset.data[index])*(opts.circumference/(2.0*Math.PI));var innerRadius=reset&&animationOpts.animateScale?0:me.innerRadius;var outerRadius=reset&&animationOpts.animateScale?0:me.outerRadius;var options=arc._options||{};helpers$1.extend(arc,{_datasetIndex:me.index,_index:index,_model:{backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,borderAlign:options.borderAlign,x:centerX+chart.offsetX,y:centerY+chart.offsetY,startAngle:startAngle,endAngle:endAngle,circumference:circumference,outerRadius:outerRadius,innerRadius:innerRadius,label:helpers$1.valueAtIndexOrDefault(dataset.label,index,chart.data.labels[index])}});var model=arc._model;if(!reset||!animationOpts.animateRotate){if(index===0){model.startAngle=opts.rotation;}else{model.startAngle=me.getMeta().data[index-1]._model.endAngle;}
model.endAngle=model.startAngle+model.circumference;}
arc.pivot();},calculateTotal:function(){var dataset=this.getDataset();var meta=this.getMeta();var total=0;var value;helpers$1.each(meta.data,function(element,index){value=dataset.data[index];if(!isNaN(value)&&!element.hidden){total+=Math.abs(value);}});return total;},calculateCircumference:function(value){var total=this.getMeta().total;if(total>0&&!isNaN(value)){return(Math.PI*2.0)*(Math.abs(value)/total);}
return 0;},getMaxBorderWidth:function(arcs){var me=this;var max=0;var chart=me.chart;var i,ilen,meta,arc,controller,options,borderWidth,hoverWidth;if(!arcs){for(i=0,ilen=chart.data.datasets.length;i<ilen;++i){if(chart.isDatasetVisible(i)){meta=chart.getDatasetMeta(i);arcs=meta.data;if(i!==me.index){controller=meta.controller;}
break;}}}
if(!arcs){return 0;}
for(i=0,ilen=arcs.length;i<ilen;++i){arc=arcs[i];options=controller?controller._resolveElementOptions(arc,i):arc._options;if(options.borderAlign!=='inner'){borderWidth=options.borderWidth;hoverWidth=options.hoverBorderWidth;max=borderWidth>max?borderWidth:max;max=hoverWidth>max?hoverWidth:max;}}
return max;},setHoverStyle:function(arc){var model=arc._model;var options=arc._options;var getHoverColor=helpers$1.getHoverColor;arc.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,};model.backgroundColor=valueOrDefault$4(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$4(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$4(options.hoverBorderWidth,options.borderWidth);},_resolveElementOptions:function(arc,index){var me=this;var chart=me.chart;var dataset=me.getDataset();var custom=arc.custom||{};var options=chart.options.elements.arc;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderWidth','borderAlign','hoverBackgroundColor','hoverBorderColor','hoverBorderWidth',];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$3([custom[key],dataset[key],options[key]],context,index);}
return values;},_getRingWeightOffset:function(datasetIndex){var ringWeightOffset=0;for(var i=0;i<datasetIndex;++i){if(this.chart.isDatasetVisible(i)){ringWeightOffset+=this._getRingWeight(i);}}
return ringWeightOffset;},_getRingWeight:function(dataSetIndex){return Math.max(valueOrDefault$4(this.chart.data.datasets[dataSetIndex].weight,1),0);},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length);}});core_defaults._set('horizontalBar',{hover:{mode:'index',axis:'y'},scales:{xAxes:[{type:'linear',position:'bottom'}],yAxes:[{type:'category',position:'left',categoryPercentage:0.8,barPercentage:0.9,offset:true,gridLines:{offsetGridLines:true}}]},elements:{rectangle:{borderSkipped:'left'}},tooltips:{mode:'index',axis:'y'}});var controller_horizontalBar=controller_bar.extend({_getValueScaleId:function(){return this.getMeta().xAxisID;},_getIndexScaleId:function(){return this.getMeta().yAxisID;}});var valueOrDefault$5=helpers$1.valueOrDefault;var resolve$4=helpers$1.options.resolve;var isPointInArea=helpers$1.canvas._isPointInArea;core_defaults._set('line',{showLines:true,spanGaps:false,hover:{mode:'label'},scales:{xAxes:[{type:'category',id:'x-axis-0'}],yAxes:[{type:'linear',id:'y-axis-0'}]}});function lineEnabled(dataset,options){return valueOrDefault$5(dataset.showLine,options.showLines);}
var controller_line=core_datasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,update:function(reset){var me=this;var meta=me.getMeta();var line=meta.dataset;var points=meta.data||[];var scale=me.getScaleForId(meta.yAxisID);var dataset=me.getDataset();var showLine=lineEnabled(dataset,me.chart.options);var i,ilen;if(showLine){if((dataset.tension!==undefined)&&(dataset.lineTension===undefined)){dataset.lineTension=dataset.tension;}
line._scale=scale;line._datasetIndex=me.index;line._children=points;line._model=me._resolveLineOptions(line);line.pivot();}
for(i=0,ilen=points.length;i<ilen;++i){me.updateElement(points[i],i,reset);}
if(showLine&&line._model.tension!==0){me.updateBezierControlPoints();}
for(i=0,ilen=points.length;i<ilen;++i){points[i].pivot();}},updateElement:function(point,index,reset){var me=this;var meta=me.getMeta();var custom=point.custom||{};var dataset=me.getDataset();var datasetIndex=me.index;var value=dataset.data[index];var yScale=me.getScaleForId(meta.yAxisID);var xScale=me.getScaleForId(meta.xAxisID);var lineModel=meta.dataset._model;var x,y;var options=me._resolvePointOptions(point,index);x=xScale.getPixelForValue(typeof value==='object'?value:NaN,index,datasetIndex);y=reset?yScale.getBasePixel():me.calculatePointY(value,index,datasetIndex);point._xScale=xScale;point._yScale=yScale;point._options=options;point._datasetIndex=datasetIndex;point._index=index;point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:options.radius,pointStyle:options.pointStyle,rotation:options.rotation,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,tension:valueOrDefault$5(custom.tension,lineModel?lineModel.tension:0),steppedLine:lineModel?lineModel.steppedLine:false,hitRadius:options.hitRadius};},_resolvePointOptions:function(element,index){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options.elements.point;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var ELEMENT_OPTIONS={backgroundColor:'pointBackgroundColor',borderColor:'pointBorderColor',borderWidth:'pointBorderWidth',hitRadius:'pointHitRadius',hoverBackgroundColor:'pointHoverBackgroundColor',hoverBorderColor:'pointHoverBorderColor',hoverBorderWidth:'pointHoverBorderWidth',hoverRadius:'pointHoverRadius',pointStyle:'pointStyle',radius:'pointRadius',rotation:'pointRotation'};var keys=Object.keys(ELEMENT_OPTIONS);for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$4([custom[key],dataset[ELEMENT_OPTIONS[key]],dataset[key],options[key]],context,index);}
return values;},_resolveLineOptions:function(element){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options;var elementOptions=options.elements.line;var values={};var i,ilen,key;var keys=['backgroundColor','borderWidth','borderColor','borderCapStyle','borderDash','borderDashOffset','borderJoinStyle','fill','cubicInterpolationMode'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$4([custom[key],dataset[key],elementOptions[key]]);}
values.spanGaps=valueOrDefault$5(dataset.spanGaps,options.spanGaps);values.tension=valueOrDefault$5(dataset.lineTension,elementOptions.tension);values.steppedLine=resolve$4([custom.steppedLine,dataset.steppedLine,elementOptions.stepped]);return values;},calculatePointY:function(value,index,datasetIndex){var me=this;var chart=me.chart;var meta=me.getMeta();var yScale=me.getScaleForId(meta.yAxisID);var sumPos=0;var sumNeg=0;var i,ds,dsMeta;if(yScale.options.stacked){for(i=0;i<datasetIndex;i++){ds=chart.data.datasets[i];dsMeta=chart.getDatasetMeta(i);if(dsMeta.type==='line'&&dsMeta.yAxisID===yScale.id&&chart.isDatasetVisible(i)){var stackedRightValue=Number(yScale.getRightValue(ds.data[index]));if(stackedRightValue<0){sumNeg+=stackedRightValue||0;}else{sumPos+=stackedRightValue||0;}}}
var rightValue=Number(yScale.getRightValue(value));if(rightValue<0){return yScale.getPixelForValue(sumNeg+rightValue);}
return yScale.getPixelForValue(sumPos+rightValue);}
return yScale.getPixelForValue(value);},updateBezierControlPoints:function(){var me=this;var chart=me.chart;var meta=me.getMeta();var lineModel=meta.dataset._model;var area=chart.chartArea;var points=meta.data||[];var i,ilen,model,controlPoints;if(lineModel.spanGaps){points=points.filter(function(pt){return!pt._model.skip;});}
function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min);}
if(lineModel.cubicInterpolationMode==='monotone'){helpers$1.splineCurveMonotone(points);}else{for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;controlPoints=helpers$1.splineCurve(helpers$1.previousItem(points,i)._model,model,helpers$1.nextItem(points,i)._model,lineModel.tension);model.controlPointPreviousX=controlPoints.previous.x;model.controlPointPreviousY=controlPoints.previous.y;model.controlPointNextX=controlPoints.next.x;model.controlPointNextY=controlPoints.next.y;}}
if(chart.options.elements.line.capBezierPoints){for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;if(isPointInArea(model,area)){if(i>0&&isPointInArea(points[i-1]._model,area)){model.controlPointPreviousX=capControlPoint(model.controlPointPreviousX,area.left,area.right);model.controlPointPreviousY=capControlPoint(model.controlPointPreviousY,area.top,area.bottom);}
if(i<points.length-1&&isPointInArea(points[i+1]._model,area)){model.controlPointNextX=capControlPoint(model.controlPointNextX,area.left,area.right);model.controlPointNextY=capControlPoint(model.controlPointNextY,area.top,area.bottom);}}}}},draw:function(){var me=this;var chart=me.chart;var meta=me.getMeta();var points=meta.data||[];var area=chart.chartArea;var ilen=points.length;var halfBorderWidth;var i=0;if(lineEnabled(me.getDataset(),chart.options)){halfBorderWidth=(meta.dataset._model.borderWidth||0)/2;helpers$1.canvas.clipArea(chart.ctx,{left:area.left,right:area.right,top:area.top-halfBorderWidth,bottom:area.bottom+halfBorderWidth});meta.dataset.draw();helpers$1.canvas.unclipArea(chart.ctx);}
for(;i<ilen;++i){points[i].draw(area);}},setHoverStyle:function(point){var model=point._model;var options=point._options;var getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius};model.backgroundColor=valueOrDefault$5(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$5(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$5(options.hoverBorderWidth,options.borderWidth);model.radius=valueOrDefault$5(options.hoverRadius,options.radius);},});var resolve$5=helpers$1.options.resolve;core_defaults._set('polarArea',{scale:{type:'radialLinear',angleLines:{display:false},gridLines:{circular:true},pointLabels:{display:false},ticks:{beginAtZero:true}},animation:{animateRotate:true,animateScale:true},startAngle:-0.5*Math.PI,legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data;var datasets=data.datasets;var labels=data.labels;if(datasets.length){for(var i=0;i<datasets[0].data.length;++i){text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>');if(labels[i]){text.push(labels[i]);}
text.push('</li>');}}
text.push('</ul>');return text.join('');},legend:{labels:{generateLabels:function(chart){var data=chart.data;if(data.labels.length&&data.datasets.length){return data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0);var ds=data.datasets[0];var arc=meta.data[i];var custom=arc.custom||{};var arcOpts=chart.options.elements.arc;var fill=resolve$5([custom.backgroundColor,ds.backgroundColor,arcOpts.backgroundColor],undefined,i);var stroke=resolve$5([custom.borderColor,ds.borderColor,arcOpts.borderColor],undefined,i);var bw=resolve$5([custom.borderWidth,ds.borderWidth,arcOpts.borderWidth],undefined,i);return{text:label,fillStyle:fill,strokeStyle:stroke,lineWidth:bw,hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i};});}
return[];}},onClick:function(e,legendItem){var index=legendItem.index;var chart=this.chart;var i,ilen,meta;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){meta=chart.getDatasetMeta(i);meta.data[index].hidden=!meta.data[index].hidden;}
chart.update();}},tooltips:{callbacks:{title:function(){return'';},label:function(item,data){return data.labels[item.index]+': '+item.yLabel;}}}});var controller_polarArea=core_datasetController.extend({dataElementType:elements.Arc,linkScales:helpers$1.noop,update:function(reset){var me=this;var dataset=me.getDataset();var meta=me.getMeta();var start=me.chart.options.startAngle||0;var starts=me._starts=[];var angles=me._angles=[];var arcs=meta.data;var i,ilen,angle;me._updateRadius();meta.count=me.countVisibleElements();for(i=0,ilen=dataset.data.length;i<ilen;i++){starts[i]=start;angle=me._computeAngle(i);angles[i]=angle;start+=angle;}
for(i=0,ilen=arcs.length;i<ilen;++i){arcs[i]._options=me._resolveElementOptions(arcs[i],i);me.updateElement(arcs[i],i,reset);}},_updateRadius:function(){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var minSize=Math.min(chartArea.right-chartArea.left,chartArea.bottom-chartArea.top);chart.outerRadius=Math.max(minSize/2,0);chart.innerRadius=Math.max(opts.cutoutPercentage?(chart.outerRadius/100)*(opts.cutoutPercentage):1,0);chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount();me.outerRadius=chart.outerRadius-(chart.radiusLength*me.index);me.innerRadius=me.outerRadius-chart.radiusLength;},updateElement:function(arc,index,reset){var me=this;var chart=me.chart;var dataset=me.getDataset();var opts=chart.options;var animationOpts=opts.animation;var scale=chart.scale;var labels=chart.data.labels;var centerX=scale.xCenter;var centerY=scale.yCenter;var datasetStartAngle=opts.startAngle;var distance=arc.hidden?0:scale.getDistanceFromCenterForValue(dataset.data[index]);var startAngle=me._starts[index];var endAngle=startAngle+(arc.hidden?0:me._angles[index]);var resetRadius=animationOpts.animateScale?0:scale.getDistanceFromCenterForValue(dataset.data[index]);var options=arc._options||{};helpers$1.extend(arc,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,borderAlign:options.borderAlign,x:centerX,y:centerY,innerRadius:0,outerRadius:reset?resetRadius:distance,startAngle:reset&&animationOpts.animateRotate?datasetStartAngle:startAngle,endAngle:reset&&animationOpts.animateRotate?datasetStartAngle:endAngle,label:helpers$1.valueAtIndexOrDefault(labels,index,labels[index])}});arc.pivot();},countVisibleElements:function(){var dataset=this.getDataset();var meta=this.getMeta();var count=0;helpers$1.each(meta.data,function(element,index){if(!isNaN(dataset.data[index])&&!element.hidden){count++;}});return count;},setHoverStyle:function(arc){var model=arc._model;var options=arc._options;var getHoverColor=helpers$1.getHoverColor;var valueOrDefault=helpers$1.valueOrDefault;arc.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,};model.backgroundColor=valueOrDefault(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault(options.hoverBorderWidth,options.borderWidth);},_resolveElementOptions:function(arc,index){var me=this;var chart=me.chart;var dataset=me.getDataset();var custom=arc.custom||{};var options=chart.options.elements.arc;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=['backgroundColor','borderColor','borderWidth','borderAlign','hoverBackgroundColor','hoverBorderColor','hoverBorderWidth',];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$5([custom[key],dataset[key],options[key]],context,index);}
return values;},_computeAngle:function(index){var me=this;var count=this.getMeta().count;var dataset=me.getDataset();var meta=me.getMeta();if(isNaN(dataset.data[index])||meta.data[index].hidden){return 0;}
var context={chart:me.chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};return resolve$5([me.chart.options.elements.arc.angle,(2*Math.PI)/count],context,index);}});core_defaults._set('pie',helpers$1.clone(core_defaults.doughnut));core_defaults._set('pie',{cutoutPercentage:0});var controller_pie=controller_doughnut;var valueOrDefault$6=helpers$1.valueOrDefault;var resolve$6=helpers$1.options.resolve;core_defaults._set('radar',{scale:{type:'radialLinear'},elements:{line:{tension:0}}});var controller_radar=core_datasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,linkScales:helpers$1.noop,update:function(reset){var me=this;var meta=me.getMeta();var line=meta.dataset;var points=meta.data||[];var scale=me.chart.scale;var dataset=me.getDataset();var i,ilen;if((dataset.tension!==undefined)&&(dataset.lineTension===undefined)){dataset.lineTension=dataset.tension;}
line._scale=scale;line._datasetIndex=me.index;line._children=points;line._loop=true;line._model=me._resolveLineOptions(line);line.pivot();for(i=0,ilen=points.length;i<ilen;++i){me.updateElement(points[i],i,reset);}
me.updateBezierControlPoints();for(i=0,ilen=points.length;i<ilen;++i){points[i].pivot();}},updateElement:function(point,index,reset){var me=this;var custom=point.custom||{};var dataset=me.getDataset();var scale=me.chart.scale;var pointPosition=scale.getPointPositionForValue(index,dataset.data[index]);var options=me._resolvePointOptions(point,index);var lineModel=me.getMeta().dataset._model;var x=reset?scale.xCenter:pointPosition.x;var y=reset?scale.yCenter:pointPosition.y;point._scale=scale;point._options=options;point._datasetIndex=me.index;point._index=index;point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:options.radius,pointStyle:options.pointStyle,rotation:options.rotation,backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,tension:valueOrDefault$6(custom.tension,lineModel?lineModel.tension:0),hitRadius:options.hitRadius};},_resolvePointOptions:function(element,index){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options.elements.point;var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var ELEMENT_OPTIONS={backgroundColor:'pointBackgroundColor',borderColor:'pointBorderColor',borderWidth:'pointBorderWidth',hitRadius:'pointHitRadius',hoverBackgroundColor:'pointHoverBackgroundColor',hoverBorderColor:'pointHoverBorderColor',hoverBorderWidth:'pointHoverBorderWidth',hoverRadius:'pointHoverRadius',pointStyle:'pointStyle',radius:'pointRadius',rotation:'pointRotation'};var keys=Object.keys(ELEMENT_OPTIONS);for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$6([custom[key],dataset[ELEMENT_OPTIONS[key]],dataset[key],options[key]],context,index);}
return values;},_resolveLineOptions:function(element){var me=this;var chart=me.chart;var dataset=chart.data.datasets[me.index];var custom=element.custom||{};var options=chart.options.elements.line;var values={};var i,ilen,key;var keys=['backgroundColor','borderWidth','borderColor','borderCapStyle','borderDash','borderDashOffset','borderJoinStyle','fill'];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve$6([custom[key],dataset[key],options[key]]);}
values.tension=valueOrDefault$6(dataset.lineTension,options.tension);return values;},updateBezierControlPoints:function(){var me=this;var meta=me.getMeta();var area=me.chart.chartArea;var points=meta.data||[];var i,ilen,model,controlPoints;function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min);}
for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;controlPoints=helpers$1.splineCurve(helpers$1.previousItem(points,i,true)._model,model,helpers$1.nextItem(points,i,true)._model,model.tension);model.controlPointPreviousX=capControlPoint(controlPoints.previous.x,area.left,area.right);model.controlPointPreviousY=capControlPoint(controlPoints.previous.y,area.top,area.bottom);model.controlPointNextX=capControlPoint(controlPoints.next.x,area.left,area.right);model.controlPointNextY=capControlPoint(controlPoints.next.y,area.top,area.bottom);}},setHoverStyle:function(point){var model=point._model;var options=point._options;var getHoverColor=helpers$1.getHoverColor;point.$previousStyle={backgroundColor:model.backgroundColor,borderColor:model.borderColor,borderWidth:model.borderWidth,radius:model.radius};model.backgroundColor=valueOrDefault$6(options.hoverBackgroundColor,getHoverColor(options.backgroundColor));model.borderColor=valueOrDefault$6(options.hoverBorderColor,getHoverColor(options.borderColor));model.borderWidth=valueOrDefault$6(options.hoverBorderWidth,options.borderWidth);model.radius=valueOrDefault$6(options.hoverRadius,options.radius);}});core_defaults._set('scatter',{hover:{mode:'single'},scales:{xAxes:[{id:'x-axis-1',type:'linear',position:'bottom'}],yAxes:[{id:'y-axis-1',type:'linear',position:'left'}]},showLines:false,tooltips:{callbacks:{title:function(){return'';},label:function(item){return'('+item.xLabel+', '+item.yLabel+')';}}}});var controller_scatter=controller_line;var controllers={bar:controller_bar,bubble:controller_bubble,doughnut:controller_doughnut,horizontalBar:controller_horizontalBar,line:controller_line,polarArea:controller_polarArea,pie:controller_pie,radar:controller_radar,scatter:controller_scatter};function getRelativePosition(e,chart){if(e.native){return{x:e.x,y:e.y};}
return helpers$1.getRelativePosition(e,chart);}
function parseVisibleItems(chart,handler){var datasets=chart.data.datasets;var meta,i,j,ilen,jlen;for(i=0,ilen=datasets.length;i<ilen;++i){if(!chart.isDatasetVisible(i)){continue;}
meta=chart.getDatasetMeta(i);for(j=0,jlen=meta.data.length;j<jlen;++j){var element=meta.data[j];if(!element._view.skip){handler(element);}}}}
function getIntersectItems(chart,position){var elements=[];parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y)){elements.push(element);}});return elements;}
function getNearestItems(chart,position,intersect,distanceMetric){var minDistance=Number.POSITIVE_INFINITY;var nearestItems=[];parseVisibleItems(chart,function(element){if(intersect&&!element.inRange(position.x,position.y)){return;}
var center=element.getCenterPoint();var distance=distanceMetric(position,center);if(distance<minDistance){nearestItems=[element];minDistance=distance;}else if(distance===minDistance){nearestItems.push(element);}});return nearestItems;}
function getDistanceMetricForAxis(axis){var useX=axis.indexOf('x')!==-1;var useY=axis.indexOf('y')!==-1;return function(pt1,pt2){var deltaX=useX?Math.abs(pt1.x-pt2.x):0;var deltaY=useY?Math.abs(pt1.y-pt2.y):0;return Math.sqrt(Math.pow(deltaX,2)+Math.pow(deltaY,2));};}
function indexMode(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||'x';var distanceMetric=getDistanceMetricForAxis(options.axis);var items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,false,distanceMetric);var elements=[];if(!items.length){return[];}
chart.data.datasets.forEach(function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);var element=meta.data[items[0]._index];if(element&&!element._view.skip){elements.push(element);}}});return elements;}
var core_interaction={modes:{single:function(chart,e){var position=getRelativePosition(e,chart);var elements=[];parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y)){elements.push(element);return elements;}});return elements.slice(0,1);},label:indexMode,index:indexMode,dataset:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||'xy';var distanceMetric=getDistanceMetricForAxis(options.axis);var items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,false,distanceMetric);if(items.length>0){items=chart.getDatasetMeta(items[0]._datasetIndex).data;}
return items;},'x-axis':function(chart,e){return indexMode(chart,e,{intersect:false});},point:function(chart,e){var position=getRelativePosition(e,chart);return getIntersectItems(chart,position);},nearest:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||'xy';var distanceMetric=getDistanceMetricForAxis(options.axis);return getNearestItems(chart,position,options.intersect,distanceMetric);},x:function(chart,e,options){var position=getRelativePosition(e,chart);var items=[];var intersectsItem=false;parseVisibleItems(chart,function(element){if(element.inXRange(position.x)){items.push(element);}
if(element.inRange(position.x,position.y)){intersectsItem=true;}});if(options.intersect&&!intersectsItem){items=[];}
return items;},y:function(chart,e,options){var position=getRelativePosition(e,chart);var items=[];var intersectsItem=false;parseVisibleItems(chart,function(element){if(element.inYRange(position.y)){items.push(element);}
if(element.inRange(position.x,position.y)){intersectsItem=true;}});if(options.intersect&&!intersectsItem){items=[];}
return items;}}};function filterByPosition(array,position){return helpers$1.where(array,function(v){return v.position===position;});}
function sortByWeight(array,reverse){array.forEach(function(v,i){v._tmpIndex_=i;return v;});array.sort(function(a,b){var v0=reverse?b:a;var v1=reverse?a:b;return v0.weight===v1.weight?v0._tmpIndex_-v1._tmpIndex_:v0.weight-v1.weight;});array.forEach(function(v){delete v._tmpIndex_;});}
function findMaxPadding(boxes){var top=0;var left=0;var bottom=0;var right=0;helpers$1.each(boxes,function(box){if(box.getPadding){var boxPadding=box.getPadding();top=Math.max(top,boxPadding.top);left=Math.max(left,boxPadding.left);bottom=Math.max(bottom,boxPadding.bottom);right=Math.max(right,boxPadding.right);}});return{top:top,left:left,bottom:bottom,right:right};}
function addSizeByPosition(boxes,size){helpers$1.each(boxes,function(box){size[box.position]+=box.isHorizontal()?box.height:box.width;});}
core_defaults._set('global',{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var core_layouts={defaults:{},addBox:function(chart,item){if(!chart.boxes){chart.boxes=[];}
item.fullWidth=item.fullWidth||false;item.position=item.position||'top';item.weight=item.weight||0;chart.boxes.push(item);},removeBox:function(chart,layoutItem){var index=chart.boxes?chart.boxes.indexOf(layoutItem):-1;if(index!==-1){chart.boxes.splice(index,1);}},configure:function(chart,item,options){var props=['fullWidth','position','weight'];var ilen=props.length;var i=0;var prop;for(;i<ilen;++i){prop=props[i];if(options.hasOwnProperty(prop)){item[prop]=options[prop];}}},update:function(chart,width,height){if(!chart){return;}
var layoutOptions=chart.options.layout||{};var padding=helpers$1.options.toPadding(layoutOptions.padding);var leftPadding=padding.left;var rightPadding=padding.right;var topPadding=padding.top;var bottomPadding=padding.bottom;var leftBoxes=filterByPosition(chart.boxes,'left');var rightBoxes=filterByPosition(chart.boxes,'right');var topBoxes=filterByPosition(chart.boxes,'top');var bottomBoxes=filterByPosition(chart.boxes,'bottom');var chartAreaBoxes=filterByPosition(chart.boxes,'chartArea');sortByWeight(leftBoxes,true);sortByWeight(rightBoxes,false);sortByWeight(topBoxes,true);sortByWeight(bottomBoxes,false);var verticalBoxes=leftBoxes.concat(rightBoxes);var horizontalBoxes=topBoxes.concat(bottomBoxes);var outerBoxes=verticalBoxes.concat(horizontalBoxes);var chartWidth=width-leftPadding-rightPadding;var chartHeight=height-topPadding-bottomPadding;var chartAreaWidth=chartWidth/2;var verticalBoxWidth=(width-chartAreaWidth)/verticalBoxes.length;var maxChartAreaWidth=chartWidth;var maxChartAreaHeight=chartHeight;var outerBoxSizes={top:topPadding,left:leftPadding,bottom:bottomPadding,right:rightPadding};var minBoxSizes=[];var maxPadding;function getMinimumBoxSize(box){var minSize;var isHorizontal=box.isHorizontal();if(isHorizontal){minSize=box.update(box.fullWidth?chartWidth:maxChartAreaWidth,chartHeight/2);maxChartAreaHeight-=minSize.height;}else{minSize=box.update(verticalBoxWidth,maxChartAreaHeight);maxChartAreaWidth-=minSize.width;}
minBoxSizes.push({horizontal:isHorizontal,width:minSize.width,box:box,});}
helpers$1.each(outerBoxes,getMinimumBoxSize);maxPadding=findMaxPadding(outerBoxes);function fitBox(box){var minBoxSize=helpers$1.findNextWhere(minBoxSizes,function(minBox){return minBox.box===box;});if(minBoxSize){if(minBoxSize.horizontal){var scaleMargin={left:Math.max(outerBoxSizes.left,maxPadding.left),right:Math.max(outerBoxSizes.right,maxPadding.right),top:0,bottom:0};box.update(box.fullWidth?chartWidth:maxChartAreaWidth,chartHeight/2,scaleMargin);}else{box.update(minBoxSize.width,maxChartAreaHeight);}}}
helpers$1.each(verticalBoxes,fitBox);addSizeByPosition(verticalBoxes,outerBoxSizes);helpers$1.each(horizontalBoxes,fitBox);addSizeByPosition(horizontalBoxes,outerBoxSizes);function finalFitVerticalBox(box){var minBoxSize=helpers$1.findNextWhere(minBoxSizes,function(minSize){return minSize.box===box;});var scaleMargin={left:0,right:0,top:outerBoxSizes.top,bottom:outerBoxSizes.bottom};if(minBoxSize){box.update(minBoxSize.width,maxChartAreaHeight,scaleMargin);}}
helpers$1.each(verticalBoxes,finalFitVerticalBox);outerBoxSizes={top:topPadding,left:leftPadding,bottom:bottomPadding,right:rightPadding};addSizeByPosition(outerBoxes,outerBoxSizes);var leftPaddingAddition=Math.max(maxPadding.left-outerBoxSizes.left,0);outerBoxSizes.left+=leftPaddingAddition;outerBoxSizes.right+=Math.max(maxPadding.right-outerBoxSizes.right,0);var topPaddingAddition=Math.max(maxPadding.top-outerBoxSizes.top,0);outerBoxSizes.top+=topPaddingAddition;outerBoxSizes.bottom+=Math.max(maxPadding.bottom-outerBoxSizes.bottom,0);var newMaxChartAreaHeight=height-outerBoxSizes.top-outerBoxSizes.bottom;var newMaxChartAreaWidth=width-outerBoxSizes.left-outerBoxSizes.right;if(newMaxChartAreaWidth!==maxChartAreaWidth||newMaxChartAreaHeight!==maxChartAreaHeight){helpers$1.each(verticalBoxes,function(box){box.height=newMaxChartAreaHeight;});helpers$1.each(horizontalBoxes,function(box){if(!box.fullWidth){box.width=newMaxChartAreaWidth;}});maxChartAreaHeight=newMaxChartAreaHeight;maxChartAreaWidth=newMaxChartAreaWidth;}
var left=leftPadding+leftPaddingAddition;var top=topPadding+topPaddingAddition;function placeBox(box){if(box.isHorizontal()){box.left=box.fullWidth?leftPadding:outerBoxSizes.left;box.right=box.fullWidth?width-rightPadding:outerBoxSizes.left+maxChartAreaWidth;box.top=top;box.bottom=top+box.height;top=box.bottom;}else{box.left=left;box.right=left+box.width;box.top=outerBoxSizes.top;box.bottom=outerBoxSizes.top+maxChartAreaHeight;left=box.right;}}
helpers$1.each(leftBoxes.concat(topBoxes),placeBox);left+=maxChartAreaWidth;top+=maxChartAreaHeight;helpers$1.each(rightBoxes,placeBox);helpers$1.each(bottomBoxes,placeBox);chart.chartArea={left:outerBoxSizes.left,top:outerBoxSizes.top,right:outerBoxSizes.left+maxChartAreaWidth,bottom:outerBoxSizes.top+maxChartAreaHeight};helpers$1.each(chartAreaBoxes,function(box){box.left=chart.chartArea.left;box.top=chart.chartArea.top;box.right=chart.chartArea.right;box.bottom=chart.chartArea.bottom;box.update(maxChartAreaWidth,maxChartAreaHeight);});}};var platform_basic={acquireContext:function(item){if(item&&item.canvas){item=item.canvas;}
return item&&item.getContext('2d')||null;}};var platform_dom="/*\n * DOM element rendering detection\n * https://davidwalsh.name/detect-node-insertion\n */\n@keyframes chartjs-render-animation {\n\tfrom { opacity: 0.99; }\n\tto { opacity: 1; }\n}\n\n.chartjs-render-monitor {\n\tanimation: chartjs-render-animation 0.001s;\n}\n\n/*\n * DOM element resizing detection\n * https://github.com/marcj/css-element-queries\n */\n.chartjs-size-monitor,\n.chartjs-size-monitor-expand,\n.chartjs-size-monitor-shrink {\n\tposition: absolute;\n\tdirection: ltr;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\tpointer-events: none;\n\tvisibility: hidden;\n\tz-index: -1;\n}\n\n.chartjs-size-monitor-expand > div {\n\tposition: absolute;\n\twidth: 1000000px;\n\theight: 1000000px;\n\tleft: 0;\n\ttop: 0;\n}\n\n.chartjs-size-monitor-shrink > div {\n\tposition: absolute;\n\twidth: 200%;\n\theight: 200%;\n\tleft: 0;\n\ttop: 0;\n}\n";var platform_dom$1=Object.freeze({default:platform_dom});function getCjsExportFromNamespace(n){return n&&n.default||n;}
var stylesheet=getCjsExportFromNamespace(platform_dom$1);var EXPANDO_KEY='$chartjs';var CSS_PREFIX='chartjs-';var CSS_SIZE_MONITOR=CSS_PREFIX+'size-monitor';var CSS_RENDER_MONITOR=CSS_PREFIX+'render-monitor';var CSS_RENDER_ANIMATION=CSS_PREFIX+'render-animation';var ANIMATION_START_EVENTS=['animationstart','webkitAnimationStart'];var EVENT_TYPES={touchstart:'mousedown',touchmove:'mousemove',touchend:'mouseup',pointerenter:'mouseenter',pointerdown:'mousedown',pointermove:'mousemove',pointerup:'mouseup',pointerleave:'mouseout',pointerout:'mouseout'};function readUsedSize(element,property){var value=helpers$1.getStyle(element,property);var matches=value&&value.match(/^(\d+)(\.\d+)?px$/);return matches?Number(matches[1]):undefined;}
function initCanvas(canvas,config){var style=canvas.style;var renderHeight=canvas.getAttribute('height');var renderWidth=canvas.getAttribute('width');canvas[EXPANDO_KEY]={initial:{height:renderHeight,width:renderWidth,style:{display:style.display,height:style.height,width:style.width}}};style.display=style.display||'block';if(renderWidth===null||renderWidth===''){var displayWidth=readUsedSize(canvas,'width');if(displayWidth!==undefined){canvas.width=displayWidth;}}
if(renderHeight===null||renderHeight===''){if(canvas.style.height===''){canvas.height=canvas.width/(config.options.aspectRatio||2);}else{var displayHeight=readUsedSize(canvas,'height');if(displayWidth!==undefined){canvas.height=displayHeight;}}}
return canvas;}
var supportsEventListenerOptions=(function(){var supports=false;try{var options=Object.defineProperty({},'passive',{get:function(){supports=true;}});window.addEventListener('e',null,options);}catch(e){}
return supports;}());var eventListenerOptions=supportsEventListenerOptions?{passive:true}:false;function addListener(node,type,listener){node.addEventListener(type,listener,eventListenerOptions);}
function removeListener(node,type,listener){node.removeEventListener(type,listener,eventListenerOptions);}
function createEvent(type,chart,x,y,nativeEvent){return{type:type,chart:chart,native:nativeEvent||null,x:x!==undefined?x:null,y:y!==undefined?y:null,};}
function fromNativeEvent(event,chart){var type=EVENT_TYPES[event.type]||event.type;var pos=helpers$1.getRelativePosition(event,chart);return createEvent(type,chart,pos.x,pos.y,event);}
function throttled(fn,thisArg){var ticking=false;var args=[];return function(){args=Array.prototype.slice.call(arguments);thisArg=thisArg||this;if(!ticking){ticking=true;helpers$1.requestAnimFrame.call(window,function(){ticking=false;fn.apply(thisArg,args);});}};}
function createDiv(cls){var el=document.createElement('div');el.className=cls||'';return el;}
function createResizer(handler){var maxSize=1000000;var resizer=createDiv(CSS_SIZE_MONITOR);var expand=createDiv(CSS_SIZE_MONITOR+'-expand');var shrink=createDiv(CSS_SIZE_MONITOR+'-shrink');expand.appendChild(createDiv());shrink.appendChild(createDiv());resizer.appendChild(expand);resizer.appendChild(shrink);resizer._reset=function(){expand.scrollLeft=maxSize;expand.scrollTop=maxSize;shrink.scrollLeft=maxSize;shrink.scrollTop=maxSize;};var onScroll=function(){resizer._reset();handler();};addListener(expand,'scroll',onScroll.bind(expand,'expand'));addListener(shrink,'scroll',onScroll.bind(shrink,'shrink'));return resizer;}
function watchForRender(node,handler){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={});var proxy=expando.renderProxy=function(e){if(e.animationName===CSS_RENDER_ANIMATION){handler();}};helpers$1.each(ANIMATION_START_EVENTS,function(type){addListener(node,type,proxy);});expando.reflow=!!node.offsetParent;node.classList.add(CSS_RENDER_MONITOR);}
function unwatchForRender(node){var expando=node[EXPANDO_KEY]||{};var proxy=expando.renderProxy;if(proxy){helpers$1.each(ANIMATION_START_EVENTS,function(type){removeListener(node,type,proxy);});delete expando.renderProxy;}
node.classList.remove(CSS_RENDER_MONITOR);}
function addResizeListener(node,listener,chart){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={});var resizer=expando.resizer=createResizer(throttled(function(){if(expando.resizer){var container=chart.options.maintainAspectRatio&&node.parentNode;var w=container?container.clientWidth:0;listener(createEvent('resize',chart));if(container&&container.clientWidth<w&&chart.canvas){listener(createEvent('resize',chart));}}}));watchForRender(node,function(){if(expando.resizer){var container=node.parentNode;if(container&&container!==resizer.parentNode){container.insertBefore(resizer,container.firstChild);}
resizer._reset();}});}
function removeResizeListener(node){var expando=node[EXPANDO_KEY]||{};var resizer=expando.resizer;delete expando.resizer;unwatchForRender(node);if(resizer&&resizer.parentNode){resizer.parentNode.removeChild(resizer);}}
function injectCSS(platform,css){var style=platform._style||document.createElement('style');if(!platform._style){platform._style=style;css='/* Chart.js */\n'+css;style.setAttribute('type','text/css');document.getElementsByTagName('head')[0].appendChild(style);}
style.appendChild(document.createTextNode(css));}
var platform_dom$2={disableCSSInjection:false,_enabled:typeof window!=='undefined'&&typeof document!=='undefined',_ensureLoaded:function(){if(this._loaded){return;}
this._loaded=true;if(!this.disableCSSInjection){injectCSS(this,stylesheet);}},acquireContext:function(item,config){if(typeof item==='string'){item=document.getElementById(item);}else if(item.length){item=item[0];}
if(item&&item.canvas){item=item.canvas;}
var context=item&&item.getContext&&item.getContext('2d');this._ensureLoaded();if(context&&context.canvas===item){initCanvas(item,config);return context;}
return null;},releaseContext:function(context){var canvas=context.canvas;if(!canvas[EXPANDO_KEY]){return;}
var initial=canvas[EXPANDO_KEY].initial;['height','width'].forEach(function(prop){var value=initial[prop];if(helpers$1.isNullOrUndef(value)){canvas.removeAttribute(prop);}else{canvas.setAttribute(prop,value);}});helpers$1.each(initial.style||{},function(value,key){canvas.style[key]=value;});canvas.width=canvas.width;delete canvas[EXPANDO_KEY];},addEventListener:function(chart,type,listener){var canvas=chart.canvas;if(type==='resize'){addResizeListener(canvas,listener,chart);return;}
var expando=listener[EXPANDO_KEY]||(listener[EXPANDO_KEY]={});var proxies=expando.proxies||(expando.proxies={});var proxy=proxies[chart.id+'_'+type]=function(event){listener(fromNativeEvent(event,chart));};addListener(canvas,type,proxy);},removeEventListener:function(chart,type,listener){var canvas=chart.canvas;if(type==='resize'){removeResizeListener(canvas);return;}
var expando=listener[EXPANDO_KEY]||{};var proxies=expando.proxies||{};var proxy=proxies[chart.id+'_'+type];if(!proxy){return;}
removeListener(canvas,type,proxy);}};helpers$1.addEvent=addListener;helpers$1.removeEvent=removeListener;var implementation=platform_dom$2._enabled?platform_dom$2:platform_basic;var platform=helpers$1.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},implementation);core_defaults._set('global',{plugins:{}});var core_plugins={_plugins:[],_cacheId:0,register:function(plugins){var p=this._plugins;([]).concat(plugins).forEach(function(plugin){if(p.indexOf(plugin)===-1){p.push(plugin);}});this._cacheId++;},unregister:function(plugins){var p=this._plugins;([]).concat(plugins).forEach(function(plugin){var idx=p.indexOf(plugin);if(idx!==-1){p.splice(idx,1);}});this._cacheId++;},clear:function(){this._plugins=[];this._cacheId++;},count:function(){return this._plugins.length;},getAll:function(){return this._plugins;},notify:function(chart,hook,args){var descriptors=this.descriptors(chart);var ilen=descriptors.length;var i,descriptor,plugin,params,method;for(i=0;i<ilen;++i){descriptor=descriptors[i];plugin=descriptor.plugin;method=plugin[hook];if(typeof method==='function'){params=[chart].concat(args||[]);params.push(descriptor.options);if(method.apply(plugin,params)===false){return false;}}}
return true;},descriptors:function(chart){var cache=chart.$plugins||(chart.$plugins={});if(cache.id===this._cacheId){return cache.descriptors;}
var plugins=[];var descriptors=[];var config=(chart&&chart.config)||{};var options=(config.options&&config.options.plugins)||{};this._plugins.concat(config.plugins||[]).forEach(function(plugin){var idx=plugins.indexOf(plugin);if(idx!==-1){return;}
var id=plugin.id;var opts=options[id];if(opts===false){return;}
if(opts===true){opts=helpers$1.clone(core_defaults.global.plugins[id]);}
plugins.push(plugin);descriptors.push({plugin:plugin,options:opts||{}});});cache.descriptors=descriptors;cache.id=this._cacheId;return descriptors;},_invalidate:function(chart){delete chart.$plugins;}};var core_scaleService={constructors:{},defaults:{},registerScaleType:function(type,scaleConstructor,scaleDefaults){this.constructors[type]=scaleConstructor;this.defaults[type]=helpers$1.clone(scaleDefaults);},getScaleConstructor:function(type){return this.constructors.hasOwnProperty(type)?this.constructors[type]:undefined;},getScaleDefaults:function(type){return this.defaults.hasOwnProperty(type)?helpers$1.merge({},[core_defaults.scale,this.defaults[type]]):{};},updateScaleDefaults:function(type,additions){var me=this;if(me.defaults.hasOwnProperty(type)){me.defaults[type]=helpers$1.extend(me.defaults[type],additions);}},addScalesToLayout:function(chart){helpers$1.each(chart.scales,function(scale){scale.fullWidth=scale.options.fullWidth;scale.position=scale.options.position;scale.weight=scale.options.weight;core_layouts.addBox(chart,scale);});}};var valueOrDefault$7=helpers$1.valueOrDefault;core_defaults._set('global',{tooltips:{enabled:true,custom:null,mode:'nearest',position:'average',intersect:true,backgroundColor:'rgba(0,0,0,0.8)',titleFontStyle:'bold',titleSpacing:2,titleMarginBottom:6,titleFontColor:'#fff',titleAlign:'left',bodySpacing:2,bodyFontColor:'#fff',bodyAlign:'left',footerFontStyle:'bold',footerSpacing:2,footerMarginTop:6,footerFontColor:'#fff',footerAlign:'left',yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:'#fff',displayColors:true,borderColor:'rgba(0,0,0,0)',borderWidth:0,callbacks:{beforeTitle:helpers$1.noop,title:function(tooltipItems,data){var title='';var labels=data.labels;var labelCount=labels?labels.length:0;if(tooltipItems.length>0){var item=tooltipItems[0];if(item.label){title=item.label;}else if(item.xLabel){title=item.xLabel;}else if(labelCount>0&&item.index<labelCount){title=labels[item.index];}}
return title;},afterTitle:helpers$1.noop,beforeBody:helpers$1.noop,beforeLabel:helpers$1.noop,label:function(tooltipItem,data){var label=data.datasets[tooltipItem.datasetIndex].label||'';if(label){label+=': ';}
if(!helpers$1.isNullOrUndef(tooltipItem.value)){label+=tooltipItem.value;}else{label+=tooltipItem.yLabel;}
return label;},labelColor:function(tooltipItem,chart){var meta=chart.getDatasetMeta(tooltipItem.datasetIndex);var activeElement=meta.data[tooltipItem.index];var view=activeElement._view;return{borderColor:view.borderColor,backgroundColor:view.backgroundColor};},labelTextColor:function(){return this._options.bodyFontColor;},afterLabel:helpers$1.noop,afterBody:helpers$1.noop,beforeFooter:helpers$1.noop,footer:helpers$1.noop,afterFooter:helpers$1.noop}}});var positioners={average:function(elements){if(!elements.length){return false;}
var i,len;var x=0;var y=0;var count=0;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var pos=el.tooltipPosition();x+=pos.x;y+=pos.y;++count;}}
return{x:x/count,y:y/count};},nearest:function(elements,eventPosition){var x=eventPosition.x;var y=eventPosition.y;var minDistance=Number.POSITIVE_INFINITY;var i,len,nearestElement;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var center=el.getCenterPoint();var d=helpers$1.distanceBetweenPoints(eventPosition,center);if(d<minDistance){minDistance=d;nearestElement=el;}}}
if(nearestElement){var tp=nearestElement.tooltipPosition();x=tp.x;y=tp.y;}
return{x:x,y:y};}};function pushOrConcat(base,toPush){if(toPush){if(helpers$1.isArray(toPush)){Array.prototype.push.apply(base,toPush);}else{base.push(toPush);}}
return base;}
function splitNewlines(str){if((typeof str==='string'||str instanceof String)&&str.indexOf('\n')>-1){return str.split('\n');}
return str;}
function createTooltipItem(element){var xScale=element._xScale;var yScale=element._yScale||element._scale;var index=element._index;var datasetIndex=element._datasetIndex;var controller=element._chart.getDatasetMeta(datasetIndex).controller;var indexScale=controller._getIndexScale();var valueScale=controller._getValueScale();return{xLabel:xScale?xScale.getLabelForIndex(index,datasetIndex):'',yLabel:yScale?yScale.getLabelForIndex(index,datasetIndex):'',label:indexScale?''+indexScale.getLabelForIndex(index,datasetIndex):'',value:valueScale?''+valueScale.getLabelForIndex(index,datasetIndex):'',index:index,datasetIndex:datasetIndex,x:element._model.x,y:element._model.y};}
function getBaseModel(tooltipOpts){var globalDefaults=core_defaults.global;return{xPadding:tooltipOpts.xPadding,yPadding:tooltipOpts.yPadding,xAlign:tooltipOpts.xAlign,yAlign:tooltipOpts.yAlign,bodyFontColor:tooltipOpts.bodyFontColor,_bodyFontFamily:valueOrDefault$7(tooltipOpts.bodyFontFamily,globalDefaults.defaultFontFamily),_bodyFontStyle:valueOrDefault$7(tooltipOpts.bodyFontStyle,globalDefaults.defaultFontStyle),_bodyAlign:tooltipOpts.bodyAlign,bodyFontSize:valueOrDefault$7(tooltipOpts.bodyFontSize,globalDefaults.defaultFontSize),bodySpacing:tooltipOpts.bodySpacing,titleFontColor:tooltipOpts.titleFontColor,_titleFontFamily:valueOrDefault$7(tooltipOpts.titleFontFamily,globalDefaults.defaultFontFamily),_titleFontStyle:valueOrDefault$7(tooltipOpts.titleFontStyle,globalDefaults.defaultFontStyle),titleFontSize:valueOrDefault$7(tooltipOpts.titleFontSize,globalDefaults.defaultFontSize),_titleAlign:tooltipOpts.titleAlign,titleSpacing:tooltipOpts.titleSpacing,titleMarginBottom:tooltipOpts.titleMarginBottom,footerFontColor:tooltipOpts.footerFontColor,_footerFontFamily:valueOrDefault$7(tooltipOpts.footerFontFamily,globalDefaults.defaultFontFamily),_footerFontStyle:valueOrDefault$7(tooltipOpts.footerFontStyle,globalDefaults.defaultFontStyle),footerFontSize:valueOrDefault$7(tooltipOpts.footerFontSize,globalDefaults.defaultFontSize),_footerAlign:tooltipOpts.footerAlign,footerSpacing:tooltipOpts.footerSpacing,footerMarginTop:tooltipOpts.footerMarginTop,caretSize:tooltipOpts.caretSize,cornerRadius:tooltipOpts.cornerRadius,backgroundColor:tooltipOpts.backgroundColor,opacity:0,legendColorBackground:tooltipOpts.multiKeyBackground,displayColors:tooltipOpts.displayColors,borderColor:tooltipOpts.borderColor,borderWidth:tooltipOpts.borderWidth};}
function getTooltipSize(tooltip,model){var ctx=tooltip._chart.ctx;var height=model.yPadding*2;var width=0;var body=model.body;var combinedBodyLength=body.reduce(function(count,bodyItem){return count+bodyItem.before.length+bodyItem.lines.length+bodyItem.after.length;},0);combinedBodyLength+=model.beforeBody.length+model.afterBody.length;var titleLineCount=model.title.length;var footerLineCount=model.footer.length;var titleFontSize=model.titleFontSize;var bodyFontSize=model.bodyFontSize;var footerFontSize=model.footerFontSize;height+=titleLineCount*titleFontSize;height+=titleLineCount?(titleLineCount-1)*model.titleSpacing:0;height+=titleLineCount?model.titleMarginBottom:0;height+=combinedBodyLength*bodyFontSize;height+=combinedBodyLength?(combinedBodyLength-1)*model.bodySpacing:0;height+=footerLineCount?model.footerMarginTop:0;height+=footerLineCount*(footerFontSize);height+=footerLineCount?(footerLineCount-1)*model.footerSpacing:0;var widthPadding=0;var maxLineWidth=function(line){width=Math.max(width,ctx.measureText(line).width+widthPadding);};ctx.font=helpers$1.fontString(titleFontSize,model._titleFontStyle,model._titleFontFamily);helpers$1.each(model.title,maxLineWidth);ctx.font=helpers$1.fontString(bodyFontSize,model._bodyFontStyle,model._bodyFontFamily);helpers$1.each(model.beforeBody.concat(model.afterBody),maxLineWidth);widthPadding=model.displayColors?(bodyFontSize+2):0;helpers$1.each(body,function(bodyItem){helpers$1.each(bodyItem.before,maxLineWidth);helpers$1.each(bodyItem.lines,maxLineWidth);helpers$1.each(bodyItem.after,maxLineWidth);});widthPadding=0;ctx.font=helpers$1.fontString(footerFontSize,model._footerFontStyle,model._footerFontFamily);helpers$1.each(model.footer,maxLineWidth);width+=2*model.xPadding;return{width:width,height:height};}
function determineAlignment(tooltip,size){var model=tooltip._model;var chart=tooltip._chart;var chartArea=tooltip._chart.chartArea;var xAlign='center';var yAlign='center';if(model.y<size.height){yAlign='top';}else if(model.y>(chart.height-size.height)){yAlign='bottom';}
var lf,rf;var olf,orf;var yf;var midX=(chartArea.left+chartArea.right)/2;var midY=(chartArea.top+chartArea.bottom)/2;if(yAlign==='center'){lf=function(x){return x<=midX;};rf=function(x){return x>midX;};}else{lf=function(x){return x<=(size.width/2);};rf=function(x){return x>=(chart.width-(size.width/2));};}
olf=function(x){return x+size.width+model.caretSize+model.caretPadding>chart.width;};orf=function(x){return x-size.width-model.caretSize-model.caretPadding<0;};yf=function(y){return y<=midY?'top':'bottom';};if(lf(model.x)){xAlign='left';if(olf(model.x)){xAlign='center';yAlign=yf(model.y);}}else if(rf(model.x)){xAlign='right';if(orf(model.x)){xAlign='center';yAlign=yf(model.y);}}
var opts=tooltip._options;return{xAlign:opts.xAlign?opts.xAlign:xAlign,yAlign:opts.yAlign?opts.yAlign:yAlign};}
function getBackgroundPoint(vm,size,alignment,chart){var x=vm.x;var y=vm.y;var caretSize=vm.caretSize;var caretPadding=vm.caretPadding;var cornerRadius=vm.cornerRadius;var xAlign=alignment.xAlign;var yAlign=alignment.yAlign;var paddingAndSize=caretSize+caretPadding;var radiusAndPadding=cornerRadius+caretPadding;if(xAlign==='right'){x-=size.width;}else if(xAlign==='center'){x-=(size.width/2);if(x+size.width>chart.width){x=chart.width-size.width;}
if(x<0){x=0;}}
if(yAlign==='top'){y+=paddingAndSize;}else if(yAlign==='bottom'){y-=size.height+paddingAndSize;}else{y-=(size.height/2);}
if(yAlign==='center'){if(xAlign==='left'){x+=paddingAndSize;}else if(xAlign==='right'){x-=paddingAndSize;}}else if(xAlign==='left'){x-=radiusAndPadding;}else if(xAlign==='right'){x+=radiusAndPadding;}
return{x:x,y:y};}
function getAlignedX(vm,align){return align==='center'?vm.x+vm.width/2:align==='right'?vm.x+vm.width-vm.xPadding:vm.x+vm.xPadding;}
function getBeforeAfterBodyLines(callback){return pushOrConcat([],splitNewlines(callback));}
var exports$3=core_element.extend({initialize:function(){this._model=getBaseModel(this._options);this._lastActive=[];},getTitle:function(){var me=this;var opts=me._options;var callbacks=opts.callbacks;var beforeTitle=callbacks.beforeTitle.apply(me,arguments);var title=callbacks.title.apply(me,arguments);var afterTitle=callbacks.afterTitle.apply(me,arguments);var lines=[];lines=pushOrConcat(lines,splitNewlines(beforeTitle));lines=pushOrConcat(lines,splitNewlines(title));lines=pushOrConcat(lines,splitNewlines(afterTitle));return lines;},getBeforeBody:function(){return getBeforeAfterBodyLines(this._options.callbacks.beforeBody.apply(this,arguments));},getBody:function(tooltipItems,data){var me=this;var callbacks=me._options.callbacks;var bodyItems=[];helpers$1.each(tooltipItems,function(tooltipItem){var bodyItem={before:[],lines:[],after:[]};pushOrConcat(bodyItem.before,splitNewlines(callbacks.beforeLabel.call(me,tooltipItem,data)));pushOrConcat(bodyItem.lines,callbacks.label.call(me,tooltipItem,data));pushOrConcat(bodyItem.after,splitNewlines(callbacks.afterLabel.call(me,tooltipItem,data)));bodyItems.push(bodyItem);});return bodyItems;},getAfterBody:function(){return getBeforeAfterBodyLines(this._options.callbacks.afterBody.apply(this,arguments));},getFooter:function(){var me=this;var callbacks=me._options.callbacks;var beforeFooter=callbacks.beforeFooter.apply(me,arguments);var footer=callbacks.footer.apply(me,arguments);var afterFooter=callbacks.afterFooter.apply(me,arguments);var lines=[];lines=pushOrConcat(lines,splitNewlines(beforeFooter));lines=pushOrConcat(lines,splitNewlines(footer));lines=pushOrConcat(lines,splitNewlines(afterFooter));return lines;},update:function(changed){var me=this;var opts=me._options;var existingModel=me._model;var model=me._model=getBaseModel(opts);var active=me._active;var data=me._data;var alignment={xAlign:existingModel.xAlign,yAlign:existingModel.yAlign};var backgroundPoint={x:existingModel.x,y:existingModel.y};var tooltipSize={width:existingModel.width,height:existingModel.height};var tooltipPosition={x:existingModel.caretX,y:existingModel.caretY};var i,len;if(active.length){model.opacity=1;var labelColors=[];var labelTextColors=[];tooltipPosition=positioners[opts.position].call(me,active,me._eventPosition);var tooltipItems=[];for(i=0,len=active.length;i<len;++i){tooltipItems.push(createTooltipItem(active[i]));}
if(opts.filter){tooltipItems=tooltipItems.filter(function(a){return opts.filter(a,data);});}
if(opts.itemSort){tooltipItems=tooltipItems.sort(function(a,b){return opts.itemSort(a,b,data);});}
helpers$1.each(tooltipItems,function(tooltipItem){labelColors.push(opts.callbacks.labelColor.call(me,tooltipItem,me._chart));labelTextColors.push(opts.callbacks.labelTextColor.call(me,tooltipItem,me._chart));});model.title=me.getTitle(tooltipItems,data);model.beforeBody=me.getBeforeBody(tooltipItems,data);model.body=me.getBody(tooltipItems,data);model.afterBody=me.getAfterBody(tooltipItems,data);model.footer=me.getFooter(tooltipItems,data);model.x=tooltipPosition.x;model.y=tooltipPosition.y;model.caretPadding=opts.caretPadding;model.labelColors=labelColors;model.labelTextColors=labelTextColors;model.dataPoints=tooltipItems;tooltipSize=getTooltipSize(this,model);alignment=determineAlignment(this,tooltipSize);backgroundPoint=getBackgroundPoint(model,tooltipSize,alignment,me._chart);}else{model.opacity=0;}
model.xAlign=alignment.xAlign;model.yAlign=alignment.yAlign;model.x=backgroundPoint.x;model.y=backgroundPoint.y;model.width=tooltipSize.width;model.height=tooltipSize.height;model.caretX=tooltipPosition.x;model.caretY=tooltipPosition.y;me._model=model;if(changed&&opts.custom){opts.custom.call(me,model);}
return me;},drawCaret:function(tooltipPoint,size){var ctx=this._chart.ctx;var vm=this._view;var caretPosition=this.getCaretPosition(tooltipPoint,size,vm);ctx.lineTo(caretPosition.x1,caretPosition.y1);ctx.lineTo(caretPosition.x2,caretPosition.y2);ctx.lineTo(caretPosition.x3,caretPosition.y3);},getCaretPosition:function(tooltipPoint,size,vm){var x1,x2,x3,y1,y2,y3;var caretSize=vm.caretSize;var cornerRadius=vm.cornerRadius;var xAlign=vm.xAlign;var yAlign=vm.yAlign;var ptX=tooltipPoint.x;var ptY=tooltipPoint.y;var width=size.width;var height=size.height;if(yAlign==='center'){y2=ptY+(height/2);if(xAlign==='left'){x1=ptX;x2=x1-caretSize;x3=x1;y1=y2+caretSize;y3=y2-caretSize;}else{x1=ptX+width;x2=x1+caretSize;x3=x1;y1=y2-caretSize;y3=y2+caretSize;}}else{if(xAlign==='left'){x2=ptX+cornerRadius+(caretSize);x1=x2-caretSize;x3=x2+caretSize;}else if(xAlign==='right'){x2=ptX+width-cornerRadius-caretSize;x1=x2-caretSize;x3=x2+caretSize;}else{x2=vm.caretX;x1=x2-caretSize;x3=x2+caretSize;}
if(yAlign==='top'){y1=ptY;y2=y1-caretSize;y3=y1;}else{y1=ptY+height;y2=y1+caretSize;y3=y1;var tmp=x3;x3=x1;x1=tmp;}}
return{x1:x1,x2:x2,x3:x3,y1:y1,y2:y2,y3:y3};},drawTitle:function(pt,vm,ctx){var title=vm.title;if(title.length){pt.x=getAlignedX(vm,vm._titleAlign);ctx.textAlign=vm._titleAlign;ctx.textBaseline='top';var titleFontSize=vm.titleFontSize;var titleSpacing=vm.titleSpacing;ctx.fillStyle=vm.titleFontColor;ctx.font=helpers$1.fontString(titleFontSize,vm._titleFontStyle,vm._titleFontFamily);var i,len;for(i=0,len=title.length;i<len;++i){ctx.fillText(title[i],pt.x,pt.y);pt.y+=titleFontSize+titleSpacing;if(i+1===title.length){pt.y+=vm.titleMarginBottom-titleSpacing;}}}},drawBody:function(pt,vm,ctx){var bodyFontSize=vm.bodyFontSize;var bodySpacing=vm.bodySpacing;var bodyAlign=vm._bodyAlign;var body=vm.body;var drawColorBoxes=vm.displayColors;var labelColors=vm.labelColors;var xLinePadding=0;var colorX=drawColorBoxes?getAlignedX(vm,'left'):0;var textColor;ctx.textAlign=bodyAlign;ctx.textBaseline='top';ctx.font=helpers$1.fontString(bodyFontSize,vm._bodyFontStyle,vm._bodyFontFamily);pt.x=getAlignedX(vm,bodyAlign);var fillLineOfText=function(line){ctx.fillText(line,pt.x+xLinePadding,pt.y);pt.y+=bodyFontSize+bodySpacing;};ctx.fillStyle=vm.bodyFontColor;helpers$1.each(vm.beforeBody,fillLineOfText);xLinePadding=drawColorBoxes&&bodyAlign!=='right'?bodyAlign==='center'?(bodyFontSize/2+1):(bodyFontSize+2):0;helpers$1.each(body,function(bodyItem,i){textColor=vm.labelTextColors[i];ctx.fillStyle=textColor;helpers$1.each(bodyItem.before,fillLineOfText);helpers$1.each(bodyItem.lines,function(line){if(drawColorBoxes){ctx.fillStyle=vm.legendColorBackground;ctx.fillRect(colorX,pt.y,bodyFontSize,bodyFontSize);ctx.lineWidth=1;ctx.strokeStyle=labelColors[i].borderColor;ctx.strokeRect(colorX,pt.y,bodyFontSize,bodyFontSize);ctx.fillStyle=labelColors[i].backgroundColor;ctx.fillRect(colorX+1,pt.y+1,bodyFontSize-2,bodyFontSize-2);ctx.fillStyle=textColor;}
fillLineOfText(line);});helpers$1.each(bodyItem.after,fillLineOfText);});xLinePadding=0;helpers$1.each(vm.afterBody,fillLineOfText);pt.y-=bodySpacing;},drawFooter:function(pt,vm,ctx){var footer=vm.footer;if(footer.length){pt.x=getAlignedX(vm,vm._footerAlign);pt.y+=vm.footerMarginTop;ctx.textAlign=vm._footerAlign;ctx.textBaseline='top';ctx.fillStyle=vm.footerFontColor;ctx.font=helpers$1.fontString(vm.footerFontSize,vm._footerFontStyle,vm._footerFontFamily);helpers$1.each(footer,function(line){ctx.fillText(line,pt.x,pt.y);pt.y+=vm.footerFontSize+vm.footerSpacing;});}},drawBackground:function(pt,vm,ctx,tooltipSize){ctx.fillStyle=vm.backgroundColor;ctx.strokeStyle=vm.borderColor;ctx.lineWidth=vm.borderWidth;var xAlign=vm.xAlign;var yAlign=vm.yAlign;var x=pt.x;var y=pt.y;var width=tooltipSize.width;var height=tooltipSize.height;var radius=vm.cornerRadius;ctx.beginPath();ctx.moveTo(x+radius,y);if(yAlign==='top'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x+width-radius,y);ctx.quadraticCurveTo(x+width,y,x+width,y+radius);if(yAlign==='center'&&xAlign==='right'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x+width,y+height-radius);ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height);if(yAlign==='bottom'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x+radius,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-radius);if(yAlign==='center'&&xAlign==='left'){this.drawCaret(pt,tooltipSize);}
ctx.lineTo(x,y+radius);ctx.quadraticCurveTo(x,y,x+radius,y);ctx.closePath();ctx.fill();if(vm.borderWidth>0){ctx.stroke();}},draw:function(){var ctx=this._chart.ctx;var vm=this._view;if(vm.opacity===0){return;}
var tooltipSize={width:vm.width,height:vm.height};var pt={x:vm.x,y:vm.y};var opacity=Math.abs(vm.opacity<1e-3)?0:vm.opacity;var hasTooltipContent=vm.title.length||vm.beforeBody.length||vm.body.length||vm.afterBody.length||vm.footer.length;if(this._options.enabled&&hasTooltipContent){ctx.save();ctx.globalAlpha=opacity;this.drawBackground(pt,vm,ctx,tooltipSize);pt.y+=vm.yPadding;this.drawTitle(pt,vm,ctx);this.drawBody(pt,vm,ctx);this.drawFooter(pt,vm,ctx);ctx.restore();}},handleEvent:function(e){var me=this;var options=me._options;var changed=false;me._lastActive=me._lastActive||[];if(e.type==='mouseout'){me._active=[];}else{me._active=me._chart.getElementsAtEventForMode(e,options.mode,options);}
changed=!helpers$1.arrayEquals(me._active,me._lastActive);if(changed){me._lastActive=me._active;if(options.enabled||options.custom){me._eventPosition={x:e.x,y:e.y};me.update(true);me.pivot();}}
return changed;}});var positioners_1=positioners;var core_tooltip=exports$3;core_tooltip.positioners=positioners_1;var valueOrDefault$8=helpers$1.valueOrDefault;core_defaults._set('global',{elements:{},events:['mousemove','mouseout','click','touchstart','touchmove'],hover:{onHover:null,mode:'nearest',intersect:true,animationDuration:400},onClick:null,maintainAspectRatio:true,responsive:true,responsiveAnimationDuration:0});function mergeScaleConfig(){return helpers$1.merge({},[].slice.call(arguments),{merger:function(key,target,source,options){if(key==='xAxes'||key==='yAxes'){var slen=source[key].length;var i,type,scale;if(!target[key]){target[key]=[];}
for(i=0;i<slen;++i){scale=source[key][i];type=valueOrDefault$8(scale.type,key==='xAxes'?'category':'linear');if(i>=target[key].length){target[key].push({});}
if(!target[key][i].type||(scale.type&&scale.type!==target[key][i].type)){helpers$1.merge(target[key][i],[core_scaleService.getScaleDefaults(type),scale]);}else{helpers$1.merge(target[key][i],scale);}}}else{helpers$1._merger(key,target,source,options);}}});}
function mergeConfig(){return helpers$1.merge({},[].slice.call(arguments),{merger:function(key,target,source,options){var tval=target[key]||{};var sval=source[key];if(key==='scales'){target[key]=mergeScaleConfig(tval,sval);}else if(key==='scale'){target[key]=helpers$1.merge(tval,[core_scaleService.getScaleDefaults(sval.type),sval]);}else{helpers$1._merger(key,target,source,options);}}});}
function initConfig(config){config=config||{};var data=config.data=config.data||{};data.datasets=data.datasets||[];data.labels=data.labels||[];config.options=mergeConfig(core_defaults.global,core_defaults[config.type],config.options||{});return config;}
function updateConfig(chart){var newOptions=chart.options;helpers$1.each(chart.scales,function(scale){core_layouts.removeBox(chart,scale);});newOptions=mergeConfig(core_defaults.global,core_defaults[chart.config.type],newOptions);chart.options=chart.config.options=newOptions;chart.ensureScalesHaveIDs();chart.buildOrUpdateScales();chart.tooltip._options=newOptions.tooltips;chart.tooltip.initialize();}
function positionIsHorizontal(position){return position==='top'||position==='bottom';}
var Chart=function(item,config){this.construct(item,config);return this;};helpers$1.extend(Chart.prototype,{construct:function(item,config){var me=this;config=initConfig(config);var context=platform.acquireContext(item,config);var canvas=context&&context.canvas;var height=canvas&&canvas.height;var width=canvas&&canvas.width;me.id=helpers$1.uid();me.ctx=context;me.canvas=canvas;me.config=config;me.width=width;me.height=height;me.aspectRatio=height?width/height:null;me.options=config.options;me._bufferedRender=false;me.chart=me;me.controller=me;Chart.instances[me.id]=me;Object.defineProperty(me,'data',{get:function(){return me.config.data;},set:function(value){me.config.data=value;}});if(!context||!canvas){console.error("Failed to create chart: can't acquire context from the given item");return;}
me.initialize();me.update();},initialize:function(){var me=this;core_plugins.notify(me,'beforeInit');helpers$1.retinaScale(me,me.options.devicePixelRatio);me.bindEvents();if(me.options.responsive){me.resize(true);}
me.ensureScalesHaveIDs();me.buildOrUpdateScales();me.initToolTip();core_plugins.notify(me,'afterInit');return me;},clear:function(){helpers$1.canvas.clear(this);return this;},stop:function(){core_animations.cancelAnimation(this);return this;},resize:function(silent){var me=this;var options=me.options;var canvas=me.canvas;var aspectRatio=(options.maintainAspectRatio&&me.aspectRatio)||null;var newWidth=Math.max(0,Math.floor(helpers$1.getMaximumWidth(canvas)));var newHeight=Math.max(0,Math.floor(aspectRatio?newWidth/aspectRatio:helpers$1.getMaximumHeight(canvas)));if(me.width===newWidth&&me.height===newHeight){return;}
canvas.width=me.width=newWidth;canvas.height=me.height=newHeight;canvas.style.width=newWidth+'px';canvas.style.height=newHeight+'px';helpers$1.retinaScale(me,options.devicePixelRatio);if(!silent){var newSize={width:newWidth,height:newHeight};core_plugins.notify(me,'resize',[newSize]);if(options.onResize){options.onResize(me,newSize);}
me.stop();me.update({duration:options.responsiveAnimationDuration});}},ensureScalesHaveIDs:function(){var options=this.options;var scalesOptions=options.scales||{};var scaleOptions=options.scale;helpers$1.each(scalesOptions.xAxes,function(xAxisOptions,index){xAxisOptions.id=xAxisOptions.id||('x-axis-'+index);});helpers$1.each(scalesOptions.yAxes,function(yAxisOptions,index){yAxisOptions.id=yAxisOptions.id||('y-axis-'+index);});if(scaleOptions){scaleOptions.id=scaleOptions.id||'scale';}},buildOrUpdateScales:function(){var me=this;var options=me.options;var scales=me.scales||{};var items=[];var updated=Object.keys(scales).reduce(function(obj,id){obj[id]=false;return obj;},{});if(options.scales){items=items.concat((options.scales.xAxes||[]).map(function(xAxisOptions){return{options:xAxisOptions,dtype:'category',dposition:'bottom'};}),(options.scales.yAxes||[]).map(function(yAxisOptions){return{options:yAxisOptions,dtype:'linear',dposition:'left'};}));}
if(options.scale){items.push({options:options.scale,dtype:'radialLinear',isDefault:true,dposition:'chartArea'});}
helpers$1.each(items,function(item){var scaleOptions=item.options;var id=scaleOptions.id;var scaleType=valueOrDefault$8(scaleOptions.type,item.dtype);if(positionIsHorizontal(scaleOptions.position)!==positionIsHorizontal(item.dposition)){scaleOptions.position=item.dposition;}
updated[id]=true;var scale=null;if(id in scales&&scales[id].type===scaleType){scale=scales[id];scale.options=scaleOptions;scale.ctx=me.ctx;scale.chart=me;}else{var scaleClass=core_scaleService.getScaleConstructor(scaleType);if(!scaleClass){return;}
scale=new scaleClass({id:id,type:scaleType,options:scaleOptions,ctx:me.ctx,chart:me});scales[scale.id]=scale;}
scale.mergeTicksOptions();if(item.isDefault){me.scale=scale;}});helpers$1.each(updated,function(hasUpdated,id){if(!hasUpdated){delete scales[id];}});me.scales=scales;core_scaleService.addScalesToLayout(this);},buildOrUpdateControllers:function(){var me=this;var newControllers=[];helpers$1.each(me.data.datasets,function(dataset,datasetIndex){var meta=me.getDatasetMeta(datasetIndex);var type=dataset.type||me.config.type;if(meta.type&&meta.type!==type){me.destroyDatasetMeta(datasetIndex);meta=me.getDatasetMeta(datasetIndex);}
meta.type=type;if(meta.controller){meta.controller.updateIndex(datasetIndex);meta.controller.linkScales();}else{var ControllerClass=controllers[meta.type];if(ControllerClass===undefined){throw new Error('"'+meta.type+'" is not a chart type.');}
meta.controller=new ControllerClass(me,datasetIndex);newControllers.push(meta.controller);}},me);return newControllers;},resetElements:function(){var me=this;helpers$1.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.reset();},me);},reset:function(){this.resetElements();this.tooltip.initialize();},update:function(config){var me=this;if(!config||typeof config!=='object'){config={duration:config,lazy:arguments[1]};}
updateConfig(me);core_plugins._invalidate(me);if(core_plugins.notify(me,'beforeUpdate')===false){return;}
me.tooltip._data=me.data;var newControllers=me.buildOrUpdateControllers();helpers$1.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.buildOrUpdateElements();},me);me.updateLayout();if(me.options.animation&&me.options.animation.duration){helpers$1.each(newControllers,function(controller){controller.reset();});}
me.updateDatasets();me.tooltip.initialize();me.lastActive=[];core_plugins.notify(me,'afterUpdate');if(me._bufferedRender){me._bufferedRequest={duration:config.duration,easing:config.easing,lazy:config.lazy};}else{me.render(config);}},updateLayout:function(){var me=this;if(core_plugins.notify(me,'beforeLayout')===false){return;}
core_layouts.update(this,this.width,this.height);core_plugins.notify(me,'afterScaleUpdate');core_plugins.notify(me,'afterLayout');},updateDatasets:function(){var me=this;if(core_plugins.notify(me,'beforeDatasetsUpdate')===false){return;}
for(var i=0,ilen=me.data.datasets.length;i<ilen;++i){me.updateDataset(i);}
core_plugins.notify(me,'afterDatasetsUpdate');},updateDataset:function(index){var me=this;var meta=me.getDatasetMeta(index);var args={meta:meta,index:index};if(core_plugins.notify(me,'beforeDatasetUpdate',[args])===false){return;}
meta.controller.update();core_plugins.notify(me,'afterDatasetUpdate',[args]);},render:function(config){var me=this;if(!config||typeof config!=='object'){config={duration:config,lazy:arguments[1]};}
var animationOptions=me.options.animation;var duration=valueOrDefault$8(config.duration,animationOptions&&animationOptions.duration);var lazy=config.lazy;if(core_plugins.notify(me,'beforeRender')===false){return;}
var onComplete=function(animation){core_plugins.notify(me,'afterRender');helpers$1.callback(animationOptions&&animationOptions.onComplete,[animation],me);};if(animationOptions&&duration){var animation=new core_animation({numSteps:duration/16.66,easing:config.easing||animationOptions.easing,render:function(chart,animationObject){var easingFunction=helpers$1.easing.effects[animationObject.easing];var currentStep=animationObject.currentStep;var stepDecimal=currentStep/animationObject.numSteps;chart.draw(easingFunction(stepDecimal),stepDecimal,currentStep);},onAnimationProgress:animationOptions.onProgress,onAnimationComplete:onComplete});core_animations.addAnimation(me,animation,duration,lazy);}else{me.draw();onComplete(new core_animation({numSteps:0,chart:me}));}
return me;},draw:function(easingValue){var me=this;me.clear();if(helpers$1.isNullOrUndef(easingValue)){easingValue=1;}
me.transition(easingValue);if(me.width<=0||me.height<=0){return;}
if(core_plugins.notify(me,'beforeDraw',[easingValue])===false){return;}
helpers$1.each(me.boxes,function(box){box.draw(me.chartArea);},me);me.drawDatasets(easingValue);me._drawTooltip(easingValue);core_plugins.notify(me,'afterDraw',[easingValue]);},transition:function(easingValue){var me=this;for(var i=0,ilen=(me.data.datasets||[]).length;i<ilen;++i){if(me.isDatasetVisible(i)){me.getDatasetMeta(i).controller.transition(easingValue);}}
me.tooltip.transition(easingValue);},drawDatasets:function(easingValue){var me=this;if(core_plugins.notify(me,'beforeDatasetsDraw',[easingValue])===false){return;}
for(var i=(me.data.datasets||[]).length-1;i>=0;--i){if(me.isDatasetVisible(i)){me.drawDataset(i,easingValue);}}
core_plugins.notify(me,'afterDatasetsDraw',[easingValue]);},drawDataset:function(index,easingValue){var me=this;var meta=me.getDatasetMeta(index);var args={meta:meta,index:index,easingValue:easingValue};if(core_plugins.notify(me,'beforeDatasetDraw',[args])===false){return;}
meta.controller.draw(easingValue);core_plugins.notify(me,'afterDatasetDraw',[args]);},_drawTooltip:function(easingValue){var me=this;var tooltip=me.tooltip;var args={tooltip:tooltip,easingValue:easingValue};if(core_plugins.notify(me,'beforeTooltipDraw',[args])===false){return;}
tooltip.draw();core_plugins.notify(me,'afterTooltipDraw',[args]);},getElementAtEvent:function(e){return core_interaction.modes.single(this,e);},getElementsAtEvent:function(e){return core_interaction.modes.label(this,e,{intersect:true});},getElementsAtXAxis:function(e){return core_interaction.modes['x-axis'](this,e,{intersect:true});},getElementsAtEventForMode:function(e,mode,options){var method=core_interaction.modes[mode];if(typeof method==='function'){return method(this,e,options);}
return[];},getDatasetAtEvent:function(e){return core_interaction.modes.dataset(this,e,{intersect:true});},getDatasetMeta:function(datasetIndex){var me=this;var dataset=me.data.datasets[datasetIndex];if(!dataset._meta){dataset._meta={};}
var meta=dataset._meta[me.id];if(!meta){meta=dataset._meta[me.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null};}
return meta;},getVisibleDatasetCount:function(){var count=0;for(var i=0,ilen=this.data.datasets.length;i<ilen;++i){if(this.isDatasetVisible(i)){count++;}}
return count;},isDatasetVisible:function(datasetIndex){var meta=this.getDatasetMeta(datasetIndex);return typeof meta.hidden==='boolean'?!meta.hidden:!this.data.datasets[datasetIndex].hidden;},generateLegend:function(){return this.options.legendCallback(this);},destroyDatasetMeta:function(datasetIndex){var id=this.id;var dataset=this.data.datasets[datasetIndex];var meta=dataset._meta&&dataset._meta[id];if(meta){meta.controller.destroy();delete dataset._meta[id];}},destroy:function(){var me=this;var canvas=me.canvas;var i,ilen;me.stop();for(i=0,ilen=me.data.datasets.length;i<ilen;++i){me.destroyDatasetMeta(i);}
if(canvas){me.unbindEvents();helpers$1.canvas.clear(me);platform.releaseContext(me.ctx);me.canvas=null;me.ctx=null;}
core_plugins.notify(me,'destroy');delete Chart.instances[me.id];},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments);},initToolTip:function(){var me=this;me.tooltip=new core_tooltip({_chart:me,_chartInstance:me,_data:me.data,_options:me.options.tooltips},me);},bindEvents:function(){var me=this;var listeners=me._listeners={};var listener=function(){me.eventHandler.apply(me,arguments);};helpers$1.each(me.options.events,function(type){platform.addEventListener(me,type,listener);listeners[type]=listener;});if(me.options.responsive){listener=function(){me.resize();};platform.addEventListener(me,'resize',listener);listeners.resize=listener;}},unbindEvents:function(){var me=this;var listeners=me._listeners;if(!listeners){return;}
delete me._listeners;helpers$1.each(listeners,function(listener,type){platform.removeEventListener(me,type,listener);});},updateHoverStyle:function(elements,mode,enabled){var method=enabled?'setHoverStyle':'removeHoverStyle';var element,i,ilen;for(i=0,ilen=elements.length;i<ilen;++i){element=elements[i];if(element){this.getDatasetMeta(element._datasetIndex).controller[method](element);}}},eventHandler:function(e){var me=this;var tooltip=me.tooltip;if(core_plugins.notify(me,'beforeEvent',[e])===false){return;}
me._bufferedRender=true;me._bufferedRequest=null;var changed=me.handleEvent(e);if(tooltip){changed=tooltip._start?tooltip.handleEvent(e):changed|tooltip.handleEvent(e);}
core_plugins.notify(me,'afterEvent',[e]);var bufferedRequest=me._bufferedRequest;if(bufferedRequest){me.render(bufferedRequest);}else if(changed&&!me.animating){me.stop();me.render({duration:me.options.hover.animationDuration,lazy:true});}
me._bufferedRender=false;me._bufferedRequest=null;return me;},handleEvent:function(e){var me=this;var options=me.options||{};var hoverOptions=options.hover;var changed=false;me.lastActive=me.lastActive||[];if(e.type==='mouseout'){me.active=[];}else{me.active=me.getElementsAtEventForMode(e,hoverOptions.mode,hoverOptions);}
helpers$1.callback(options.onHover||options.hover.onHover,[e.native,me.active],me);if(e.type==='mouseup'||e.type==='click'){if(options.onClick){options.onClick.call(me,e.native,me.active);}}
if(me.lastActive.length){me.updateHoverStyle(me.lastActive,hoverOptions.mode,false);}
if(me.active.length&&hoverOptions.mode){me.updateHoverStyle(me.active,hoverOptions.mode,true);}
changed=!helpers$1.arrayEquals(me.active,me.lastActive);me.lastActive=me.active;return changed;}});Chart.instances={};var core_controller=Chart;Chart.Controller=Chart;Chart.types={};helpers$1.configMerge=mergeConfig;helpers$1.scaleMerge=mergeScaleConfig;var core_helpers=function(){helpers$1.where=function(collection,filterCallback){if(helpers$1.isArray(collection)&&Array.prototype.filter){return collection.filter(filterCallback);}
var filtered=[];helpers$1.each(collection,function(item){if(filterCallback(item)){filtered.push(item);}});return filtered;};helpers$1.findIndex=Array.prototype.findIndex?function(array,callback,scope){return array.findIndex(callback,scope);}:function(array,callback,scope){scope=scope===undefined?array:scope;for(var i=0,ilen=array.length;i<ilen;++i){if(callback.call(scope,array[i],i,array)){return i;}}
return-1;};helpers$1.findNextWhere=function(arrayToSearch,filterCallback,startIndex){if(helpers$1.isNullOrUndef(startIndex)){startIndex=-1;}
for(var i=startIndex+1;i<arrayToSearch.length;i++){var currentItem=arrayToSearch[i];if(filterCallback(currentItem)){return currentItem;}}};helpers$1.findPreviousWhere=function(arrayToSearch,filterCallback,startIndex){if(helpers$1.isNullOrUndef(startIndex)){startIndex=arrayToSearch.length;}
for(var i=startIndex-1;i>=0;i--){var currentItem=arrayToSearch[i];if(filterCallback(currentItem)){return currentItem;}}};helpers$1.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n);};helpers$1.almostEquals=function(x,y,epsilon){return Math.abs(x-y)<epsilon;};helpers$1.almostWhole=function(x,epsilon){var rounded=Math.round(x);return(((rounded-epsilon)<x)&&((rounded+epsilon)>x));};helpers$1.max=function(array){return array.reduce(function(max,value){if(!isNaN(value)){return Math.max(max,value);}
return max;},Number.NEGATIVE_INFINITY);};helpers$1.min=function(array){return array.reduce(function(min,value){if(!isNaN(value)){return Math.min(min,value);}
return min;},Number.POSITIVE_INFINITY);};helpers$1.sign=Math.sign?function(x){return Math.sign(x);}:function(x){x=+x;if(x===0||isNaN(x)){return x;}
return x>0?1:-1;};helpers$1.log10=Math.log10?function(x){return Math.log10(x);}:function(x){var exponent=Math.log(x)*Math.LOG10E;var powerOf10=Math.round(exponent);var isPowerOf10=x===Math.pow(10,powerOf10);return isPowerOf10?powerOf10:exponent;};helpers$1.toRadians=function(degrees){return degrees*(Math.PI/180);};helpers$1.toDegrees=function(radians){return radians*(180/Math.PI);};helpers$1._decimalPlaces=function(x){if(!helpers$1.isFinite(x)){return;}
var e=1;var p=0;while(Math.round(x*e)/e!==x){e*=10;p++;}
return p;};helpers$1.getAngleFromPoint=function(centrePoint,anglePoint){var distanceFromXCenter=anglePoint.x-centrePoint.x;var distanceFromYCenter=anglePoint.y-centrePoint.y;var radialDistanceFromCenter=Math.sqrt(distanceFromXCenter*distanceFromXCenter+distanceFromYCenter*distanceFromYCenter);var angle=Math.atan2(distanceFromYCenter,distanceFromXCenter);if(angle<(-0.5*Math.PI)){angle+=2.0*Math.PI;}
return{angle:angle,distance:radialDistanceFromCenter};};helpers$1.distanceBetweenPoints=function(pt1,pt2){return Math.sqrt(Math.pow(pt2.x-pt1.x,2)+Math.pow(pt2.y-pt1.y,2));};helpers$1.aliasPixel=function(pixelWidth){return(pixelWidth%2===0)?0:0.5;};helpers$1._alignPixel=function(chart,pixel,width){var devicePixelRatio=chart.currentDevicePixelRatio;var halfWidth=width/2;return Math.round((pixel-halfWidth)*devicePixelRatio)/devicePixelRatio+halfWidth;};helpers$1.splineCurve=function(firstPoint,middlePoint,afterPoint,t){var previous=firstPoint.skip?middlePoint:firstPoint;var current=middlePoint;var next=afterPoint.skip?middlePoint:afterPoint;var d01=Math.sqrt(Math.pow(current.x-previous.x,2)+Math.pow(current.y-previous.y,2));var d12=Math.sqrt(Math.pow(next.x-current.x,2)+Math.pow(next.y-current.y,2));var s01=d01/(d01+d12);var s12=d12/(d01+d12);s01=isNaN(s01)?0:s01;s12=isNaN(s12)?0:s12;var fa=t*s01;var fb=t*s12;return{previous:{x:current.x-fa*(next.x-previous.x),y:current.y-fa*(next.y-previous.y)},next:{x:current.x+fb*(next.x-previous.x),y:current.y+fb*(next.y-previous.y)}};};helpers$1.EPSILON=Number.EPSILON||1e-14;helpers$1.splineCurveMonotone=function(points){var pointsWithTangents=(points||[]).map(function(point){return{model:point._model,deltaK:0,mK:0};});var pointsLen=pointsWithTangents.length;var i,pointBefore,pointCurrent,pointAfter;for(i=0;i<pointsLen;++i){pointCurrent=pointsWithTangents[i];if(pointCurrent.model.skip){continue;}
pointBefore=i>0?pointsWithTangents[i-1]:null;pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null;if(pointAfter&&!pointAfter.model.skip){var slopeDeltaX=(pointAfter.model.x-pointCurrent.model.x);pointCurrent.deltaK=slopeDeltaX!==0?(pointAfter.model.y-pointCurrent.model.y)/slopeDeltaX:0;}
if(!pointBefore||pointBefore.model.skip){pointCurrent.mK=pointCurrent.deltaK;}else if(!pointAfter||pointAfter.model.skip){pointCurrent.mK=pointBefore.deltaK;}else if(this.sign(pointBefore.deltaK)!==this.sign(pointCurrent.deltaK)){pointCurrent.mK=0;}else{pointCurrent.mK=(pointBefore.deltaK+pointCurrent.deltaK)/2;}}
var alphaK,betaK,tauK,squaredMagnitude;for(i=0;i<pointsLen-1;++i){pointCurrent=pointsWithTangents[i];pointAfter=pointsWithTangents[i+1];if(pointCurrent.model.skip||pointAfter.model.skip){continue;}
if(helpers$1.almostEquals(pointCurrent.deltaK,0,this.EPSILON)){pointCurrent.mK=pointAfter.mK=0;continue;}
alphaK=pointCurrent.mK/pointCurrent.deltaK;betaK=pointAfter.mK/pointCurrent.deltaK;squaredMagnitude=Math.pow(alphaK,2)+Math.pow(betaK,2);if(squaredMagnitude<=9){continue;}
tauK=3/Math.sqrt(squaredMagnitude);pointCurrent.mK=alphaK*tauK*pointCurrent.deltaK;pointAfter.mK=betaK*tauK*pointCurrent.deltaK;}
var deltaX;for(i=0;i<pointsLen;++i){pointCurrent=pointsWithTangents[i];if(pointCurrent.model.skip){continue;}
pointBefore=i>0?pointsWithTangents[i-1]:null;pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null;if(pointBefore&&!pointBefore.model.skip){deltaX=(pointCurrent.model.x-pointBefore.model.x)/3;pointCurrent.model.controlPointPreviousX=pointCurrent.model.x-deltaX;pointCurrent.model.controlPointPreviousY=pointCurrent.model.y-deltaX*pointCurrent.mK;}
if(pointAfter&&!pointAfter.model.skip){deltaX=(pointAfter.model.x-pointCurrent.model.x)/3;pointCurrent.model.controlPointNextX=pointCurrent.model.x+deltaX;pointCurrent.model.controlPointNextY=pointCurrent.model.y+deltaX*pointCurrent.mK;}}};helpers$1.nextItem=function(collection,index,loop){if(loop){return index>=collection.length-1?collection[0]:collection[index+1];}
return index>=collection.length-1?collection[collection.length-1]:collection[index+1];};helpers$1.previousItem=function(collection,index,loop){if(loop){return index<=0?collection[collection.length-1]:collection[index-1];}
return index<=0?collection[0]:collection[index-1];};helpers$1.niceNum=function(range,round){var exponent=Math.floor(helpers$1.log10(range));var fraction=range/Math.pow(10,exponent);var niceFraction;if(round){if(fraction<1.5){niceFraction=1;}else if(fraction<3){niceFraction=2;}else if(fraction<7){niceFraction=5;}else{niceFraction=10;}}else if(fraction<=1.0){niceFraction=1;}else if(fraction<=2){niceFraction=2;}else if(fraction<=5){niceFraction=5;}else{niceFraction=10;}
return niceFraction*Math.pow(10,exponent);};helpers$1.requestAnimFrame=(function(){if(typeof window==='undefined'){return function(callback){callback();};}
return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return window.setTimeout(callback,1000/60);};}());helpers$1.getRelativePosition=function(evt,chart){var mouseX,mouseY;var e=evt.originalEvent||evt;var canvas=evt.target||evt.srcElement;var boundingRect=canvas.getBoundingClientRect();var touches=e.touches;if(touches&&touches.length>0){mouseX=touches[0].clientX;mouseY=touches[0].clientY;}else{mouseX=e.clientX;mouseY=e.clientY;}
var paddingLeft=parseFloat(helpers$1.getStyle(canvas,'padding-left'));var paddingTop=parseFloat(helpers$1.getStyle(canvas,'padding-top'));var paddingRight=parseFloat(helpers$1.getStyle(canvas,'padding-right'));var paddingBottom=parseFloat(helpers$1.getStyle(canvas,'padding-bottom'));var width=boundingRect.right-boundingRect.left-paddingLeft-paddingRight;var height=boundingRect.bottom-boundingRect.top-paddingTop-paddingBottom;mouseX=Math.round((mouseX-boundingRect.left-paddingLeft)/(width)*canvas.width/chart.currentDevicePixelRatio);mouseY=Math.round((mouseY-boundingRect.top-paddingTop)/(height)*canvas.height/chart.currentDevicePixelRatio);return{x:mouseX,y:mouseY};};function parseMaxStyle(styleValue,node,parentProperty){var valueInPixels;if(typeof styleValue==='string'){valueInPixels=parseInt(styleValue,10);if(styleValue.indexOf('%')!==-1){valueInPixels=valueInPixels/100*node.parentNode[parentProperty];}}else{valueInPixels=styleValue;}
return valueInPixels;}
function isConstrainedValue(value){return value!==undefined&&value!==null&&value!=='none';}
function getConstraintDimension(domNode,maxStyle,percentageProperty){var view=document.defaultView;var parentNode=helpers$1._getParentNode(domNode);var constrainedNode=view.getComputedStyle(domNode)[maxStyle];var constrainedContainer=view.getComputedStyle(parentNode)[maxStyle];var hasCNode=isConstrainedValue(constrainedNode);var hasCContainer=isConstrainedValue(constrainedContainer);var infinity=Number.POSITIVE_INFINITY;if(hasCNode||hasCContainer){return Math.min(hasCNode?parseMaxStyle(constrainedNode,domNode,percentageProperty):infinity,hasCContainer?parseMaxStyle(constrainedContainer,parentNode,percentageProperty):infinity);}
return'none';}
helpers$1.getConstraintWidth=function(domNode){return getConstraintDimension(domNode,'max-width','clientWidth');};helpers$1.getConstraintHeight=function(domNode){return getConstraintDimension(domNode,'max-height','clientHeight');};helpers$1._calculatePadding=function(container,padding,parentDimension){padding=helpers$1.getStyle(container,padding);return padding.indexOf('%')>-1?parentDimension*parseInt(padding,10)/100:parseInt(padding,10);};helpers$1._getParentNode=function(domNode){var parent=domNode.parentNode;if(parent&&parent.toString()==='[object ShadowRoot]'){parent=parent.host;}
return parent;};helpers$1.getMaximumWidth=function(domNode){var container=helpers$1._getParentNode(domNode);if(!container){return domNode.clientWidth;}
var clientWidth=container.clientWidth;var paddingLeft=helpers$1._calculatePadding(container,'padding-left',clientWidth);var paddingRight=helpers$1._calculatePadding(container,'padding-right',clientWidth);var w=clientWidth-paddingLeft-paddingRight;var cw=helpers$1.getConstraintWidth(domNode);return isNaN(cw)?w:Math.min(w,cw);};helpers$1.getMaximumHeight=function(domNode){var container=helpers$1._getParentNode(domNode);if(!container){return domNode.clientHeight;}
var clientHeight=container.clientHeight;var paddingTop=helpers$1._calculatePadding(container,'padding-top',clientHeight);var paddingBottom=helpers$1._calculatePadding(container,'padding-bottom',clientHeight);var h=clientHeight-paddingTop-paddingBottom;var ch=helpers$1.getConstraintHeight(domNode);return isNaN(ch)?h:Math.min(h,ch);};helpers$1.getStyle=function(el,property){return el.currentStyle?el.currentStyle[property]:document.defaultView.getComputedStyle(el,null).getPropertyValue(property);};helpers$1.retinaScale=function(chart,forceRatio){var pixelRatio=chart.currentDevicePixelRatio=forceRatio||(typeof window!=='undefined'&&window.devicePixelRatio)||1;if(pixelRatio===1){return;}
var canvas=chart.canvas;var height=chart.height;var width=chart.width;canvas.height=height*pixelRatio;canvas.width=width*pixelRatio;chart.ctx.scale(pixelRatio,pixelRatio);if(!canvas.style.height&&!canvas.style.width){canvas.style.height=height+'px';canvas.style.width=width+'px';}};helpers$1.fontString=function(pixelSize,fontStyle,fontFamily){return fontStyle+' '+pixelSize+'px '+fontFamily;};helpers$1.longestText=function(ctx,font,arrayOfThings,cache){cache=cache||{};var data=cache.data=cache.data||{};var gc=cache.garbageCollect=cache.garbageCollect||[];if(cache.font!==font){data=cache.data={};gc=cache.garbageCollect=[];cache.font=font;}
ctx.font=font;var longest=0;helpers$1.each(arrayOfThings,function(thing){if(thing!==undefined&&thing!==null&&helpers$1.isArray(thing)!==true){longest=helpers$1.measureText(ctx,data,gc,longest,thing);}else if(helpers$1.isArray(thing)){helpers$1.each(thing,function(nestedThing){if(nestedThing!==undefined&&nestedThing!==null&&!helpers$1.isArray(nestedThing)){longest=helpers$1.measureText(ctx,data,gc,longest,nestedThing);}});}});var gcLen=gc.length/2;if(gcLen>arrayOfThings.length){for(var i=0;i<gcLen;i++){delete data[gc[i]];}
gc.splice(0,gcLen);}
return longest;};helpers$1.measureText=function(ctx,data,gc,longest,string){var textWidth=data[string];if(!textWidth){textWidth=data[string]=ctx.measureText(string).width;gc.push(string);}
if(textWidth>longest){longest=textWidth;}
return longest;};helpers$1.numberOfLabelLines=function(arrayOfThings){var numberOfLines=1;helpers$1.each(arrayOfThings,function(thing){if(helpers$1.isArray(thing)){if(thing.length>numberOfLines){numberOfLines=thing.length;}}});return numberOfLines;};helpers$1.color=!chartjsColor?function(value){console.error('Color.js not found!');return value;}:function(value){if(value instanceof CanvasGradient){value=core_defaults.global.defaultColor;}
return chartjsColor(value);};helpers$1.getHoverColor=function(colorValue){return(colorValue instanceof CanvasPattern||colorValue instanceof CanvasGradient)?colorValue:helpers$1.color(colorValue).saturate(0.5).darken(0.1).rgbString();};};function abstract(){throw new Error('This method is not implemented: either no adapter can '+'be found or an incomplete integration was provided.');}
function DateAdapter(options){this.options=options||{};}
helpers$1.extend(DateAdapter.prototype,{formats:abstract,parse:abstract,format:abstract,add:abstract,diff:abstract,startOf:abstract,endOf:abstract,_create:function(value){return value;}});DateAdapter.override=function(members){helpers$1.extend(DateAdapter.prototype,members);};var _date=DateAdapter;var core_adapters={_date:_date};var core_ticks={formatters:{values:function(value){return helpers$1.isArray(value)?value:''+value;},linear:function(tickValue,index,ticks){var delta=ticks.length>3?ticks[2]-ticks[1]:ticks[1]-ticks[0];if(Math.abs(delta)>1){if(tickValue!==Math.floor(tickValue)){delta=tickValue-Math.floor(tickValue);}}
var logDelta=helpers$1.log10(Math.abs(delta));var tickString='';if(tickValue!==0){var maxTick=Math.max(Math.abs(ticks[0]),Math.abs(ticks[ticks.length-1]));if(maxTick<1e-4){var logTick=helpers$1.log10(Math.abs(tickValue));tickString=tickValue.toExponential(Math.floor(logTick)-Math.floor(logDelta));}else{var numDecimal=-1*Math.floor(logDelta);numDecimal=Math.max(Math.min(numDecimal,20),0);tickString=tickValue.toFixed(numDecimal);}}else{tickString='0';}
return tickString;},logarithmic:function(tickValue,index,ticks){var remain=tickValue/(Math.pow(10,Math.floor(helpers$1.log10(tickValue))));if(tickValue===0){return'0';}else if(remain===1||remain===2||remain===5||index===0||index===ticks.length-1){return tickValue.toExponential();}
return'';}}};var valueOrDefault$9=helpers$1.valueOrDefault;var valueAtIndexOrDefault=helpers$1.valueAtIndexOrDefault;core_defaults._set('scale',{display:true,position:'left',offset:false,gridLines:{display:true,color:'rgba(0, 0, 0, 0.1)',lineWidth:1,drawBorder:true,drawOnChartArea:true,drawTicks:true,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:'rgba(0,0,0,0.25)',zeroLineBorderDash:[],zeroLineBorderDashOffset:0.0,offsetGridLines:false,borderDash:[],borderDashOffset:0.0},scaleLabel:{display:false,labelString:'',padding:{top:4,bottom:4}},ticks:{beginAtZero:false,minRotation:0,maxRotation:50,mirror:false,padding:0,reverse:false,display:true,autoSkip:true,autoSkipPadding:0,labelOffset:0,callback:core_ticks.formatters.values,minor:{},major:{}}});function labelsFromTicks(ticks){var labels=[];var i,ilen;for(i=0,ilen=ticks.length;i<ilen;++i){labels.push(ticks[i].label);}
return labels;}
function getPixelForGridLine(scale,index,offsetGridLines){var lineValue=scale.getPixelForTick(index);if(offsetGridLines){if(scale.getTicks().length===1){lineValue-=scale.isHorizontal()?Math.max(lineValue-scale.left,scale.right-lineValue):Math.max(lineValue-scale.top,scale.bottom-lineValue);}else if(index===0){lineValue-=(scale.getPixelForTick(1)-lineValue)/2;}else{lineValue-=(lineValue-scale.getPixelForTick(index-1))/2;}}
return lineValue;}
function computeTextSize(context,tick,font){return helpers$1.isArray(tick)?helpers$1.longestText(context,font,tick):context.measureText(tick).width;}
var core_scale=core_element.extend({getPadding:function(){var me=this;return{left:me.paddingLeft||0,top:me.paddingTop||0,right:me.paddingRight||0,bottom:me.paddingBottom||0};},getTicks:function(){return this._ticks;},mergeTicksOptions:function(){var ticks=this.options.ticks;if(ticks.minor===false){ticks.minor={display:false};}
if(ticks.major===false){ticks.major={display:false};}
for(var key in ticks){if(key!=='major'&&key!=='minor'){if(typeof ticks.minor[key]==='undefined'){ticks.minor[key]=ticks[key];}
if(typeof ticks.major[key]==='undefined'){ticks.major[key]=ticks[key];}}}},beforeUpdate:function(){helpers$1.callback(this.options.beforeUpdate,[this]);},update:function(maxWidth,maxHeight,margins){var me=this;var i,ilen,labels,label,ticks,tick;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=helpers$1.extend({left:0,right:0,top:0,bottom:0},margins);me._maxLabelLines=0;me.longestLabelWidth=0;me.longestTextCache=me.longestTextCache||{};me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeDataLimits();me.determineDataLimits();me.afterDataLimits();me.beforeBuildTicks();ticks=me.buildTicks()||[];ticks=me.afterBuildTicks(ticks)||ticks;me.beforeTickToLabelConversion();labels=me.convertTicksToLabels(ticks)||me.ticks;me.afterTickToLabelConversion();me.ticks=labels;for(i=0,ilen=labels.length;i<ilen;++i){label=labels[i];tick=ticks[i];if(!tick){ticks.push(tick={label:label,major:false});}else{tick.label=label;}}
me._ticks=ticks;me.beforeCalculateTickRotation();me.calculateTickRotation();me.afterCalculateTickRotation();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize;},afterUpdate:function(){helpers$1.callback(this.options.afterUpdate,[this]);},beforeSetDimensions:function(){helpers$1.callback(this.options.beforeSetDimensions,[this]);},setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width;}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height;}
me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;},afterSetDimensions:function(){helpers$1.callback(this.options.afterSetDimensions,[this]);},beforeDataLimits:function(){helpers$1.callback(this.options.beforeDataLimits,[this]);},determineDataLimits:helpers$1.noop,afterDataLimits:function(){helpers$1.callback(this.options.afterDataLimits,[this]);},beforeBuildTicks:function(){helpers$1.callback(this.options.beforeBuildTicks,[this]);},buildTicks:helpers$1.noop,afterBuildTicks:function(ticks){var me=this;if(helpers$1.isArray(ticks)&&ticks.length){return helpers$1.callback(me.options.afterBuildTicks,[me,ticks]);}
me.ticks=helpers$1.callback(me.options.afterBuildTicks,[me,me.ticks])||me.ticks;return ticks;},beforeTickToLabelConversion:function(){helpers$1.callback(this.options.beforeTickToLabelConversion,[this]);},convertTicksToLabels:function(){var me=this;var tickOpts=me.options.ticks;me.ticks=me.ticks.map(tickOpts.userCallback||tickOpts.callback,this);},afterTickToLabelConversion:function(){helpers$1.callback(this.options.afterTickToLabelConversion,[this]);},beforeCalculateTickRotation:function(){helpers$1.callback(this.options.beforeCalculateTickRotation,[this]);},calculateTickRotation:function(){var me=this;var context=me.ctx;var tickOpts=me.options.ticks;var labels=labelsFromTicks(me._ticks);var tickFont=helpers$1.options._parseFont(tickOpts);context.font=tickFont.string;var labelRotation=tickOpts.minRotation||0;if(labels.length&&me.options.display&&me.isHorizontal()){var originalLabelWidth=helpers$1.longestText(context,tickFont.string,labels,me.longestTextCache);var labelWidth=originalLabelWidth;var cosRotation,sinRotation;var tickWidth=me.getPixelForTick(1)-me.getPixelForTick(0)-6;while(labelWidth>tickWidth&&labelRotation<tickOpts.maxRotation){var angleRadians=helpers$1.toRadians(labelRotation);cosRotation=Math.cos(angleRadians);sinRotation=Math.sin(angleRadians);if(sinRotation*originalLabelWidth>me.maxHeight){labelRotation--;break;}
labelRotation++;labelWidth=cosRotation*originalLabelWidth;}}
me.labelRotation=labelRotation;},afterCalculateTickRotation:function(){helpers$1.callback(this.options.afterCalculateTickRotation,[this]);},beforeFit:function(){helpers$1.callback(this.options.beforeFit,[this]);},fit:function(){var me=this;var minSize=me.minSize={width:0,height:0};var labels=labelsFromTicks(me._ticks);var opts=me.options;var tickOpts=opts.ticks;var scaleLabelOpts=opts.scaleLabel;var gridLineOpts=opts.gridLines;var display=me._isVisible();var position=opts.position;var isHorizontal=me.isHorizontal();var parseFont=helpers$1.options._parseFont;var tickFont=parseFont(tickOpts);var tickMarkLength=opts.gridLines.tickMarkLength;if(isHorizontal){minSize.width=me.isFullWidth()?me.maxWidth-me.margins.left-me.margins.right:me.maxWidth;}else{minSize.width=display&&gridLineOpts.drawTicks?tickMarkLength:0;}
if(isHorizontal){minSize.height=display&&gridLineOpts.drawTicks?tickMarkLength:0;}else{minSize.height=me.maxHeight;}
if(scaleLabelOpts.display&&display){var scaleLabelFont=parseFont(scaleLabelOpts);var scaleLabelPadding=helpers$1.options.toPadding(scaleLabelOpts.padding);var deltaHeight=scaleLabelFont.lineHeight+scaleLabelPadding.height;if(isHorizontal){minSize.height+=deltaHeight;}else{minSize.width+=deltaHeight;}}
if(tickOpts.display&&display){var largestTextWidth=helpers$1.longestText(me.ctx,tickFont.string,labels,me.longestTextCache);var tallestLabelHeightInLines=helpers$1.numberOfLabelLines(labels);var lineSpace=tickFont.size*0.5;var tickPadding=me.options.ticks.padding;me._maxLabelLines=tallestLabelHeightInLines;me.longestLabelWidth=largestTextWidth;if(isHorizontal){var angleRadians=helpers$1.toRadians(me.labelRotation);var cosRotation=Math.cos(angleRadians);var sinRotation=Math.sin(angleRadians);var labelHeight=(sinRotation*largestTextWidth)
+(tickFont.lineHeight*tallestLabelHeightInLines)
+lineSpace;minSize.height=Math.min(me.maxHeight,minSize.height+labelHeight+tickPadding);me.ctx.font=tickFont.string;var firstLabelWidth=computeTextSize(me.ctx,labels[0],tickFont.string);var lastLabelWidth=computeTextSize(me.ctx,labels[labels.length-1],tickFont.string);var offsetLeft=me.getPixelForTick(0)-me.left;var offsetRight=me.right-me.getPixelForTick(labels.length-1);var paddingLeft,paddingRight;if(me.labelRotation!==0){paddingLeft=position==='bottom'?(cosRotation*firstLabelWidth):(cosRotation*lineSpace);paddingRight=position==='bottom'?(cosRotation*lineSpace):(cosRotation*lastLabelWidth);}else{paddingLeft=firstLabelWidth/2;paddingRight=lastLabelWidth/2;}
me.paddingLeft=Math.max(paddingLeft-offsetLeft,0)+3;me.paddingRight=Math.max(paddingRight-offsetRight,0)+3;}else{if(tickOpts.mirror){largestTextWidth=0;}else{largestTextWidth+=tickPadding+lineSpace;}
minSize.width=Math.min(me.maxWidth,minSize.width+largestTextWidth);me.paddingTop=tickFont.size/2;me.paddingBottom=tickFont.size/2;}}
me.handleMargins();me.width=minSize.width;me.height=minSize.height;},handleMargins:function(){var me=this;if(me.margins){me.paddingLeft=Math.max(me.paddingLeft-me.margins.left,0);me.paddingTop=Math.max(me.paddingTop-me.margins.top,0);me.paddingRight=Math.max(me.paddingRight-me.margins.right,0);me.paddingBottom=Math.max(me.paddingBottom-me.margins.bottom,0);}},afterFit:function(){helpers$1.callback(this.options.afterFit,[this]);},isHorizontal:function(){return this.options.position==='top'||this.options.position==='bottom';},isFullWidth:function(){return(this.options.fullWidth);},getRightValue:function(rawValue){if(helpers$1.isNullOrUndef(rawValue)){return NaN;}
if((typeof rawValue==='number'||rawValue instanceof Number)&&!isFinite(rawValue)){return NaN;}
if(rawValue){if(this.isHorizontal()){if(rawValue.x!==undefined){return this.getRightValue(rawValue.x);}}else if(rawValue.y!==undefined){return this.getRightValue(rawValue.y);}}
return rawValue;},getLabelForIndex:helpers$1.noop,getPixelForValue:helpers$1.noop,getValueForPixel:helpers$1.noop,getPixelForTick:function(index){var me=this;var offset=me.options.offset;if(me.isHorizontal()){var innerWidth=me.width-(me.paddingLeft+me.paddingRight);var tickWidth=innerWidth/Math.max((me._ticks.length-(offset?0:1)),1);var pixel=(tickWidth*index)+me.paddingLeft;if(offset){pixel+=tickWidth/2;}
var finalVal=me.left+pixel;finalVal+=me.isFullWidth()?me.margins.left:0;return finalVal;}
var innerHeight=me.height-(me.paddingTop+me.paddingBottom);return me.top+(index*(innerHeight/(me._ticks.length-1)));},getPixelForDecimal:function(decimal){var me=this;if(me.isHorizontal()){var innerWidth=me.width-(me.paddingLeft+me.paddingRight);var valueOffset=(innerWidth*decimal)+me.paddingLeft;var finalVal=me.left+valueOffset;finalVal+=me.isFullWidth()?me.margins.left:0;return finalVal;}
return me.top+(decimal*me.height);},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue());},getBaseValue:function(){var me=this;var min=me.min;var max=me.max;return me.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0;},_autoSkip:function(ticks){var me=this;var isHorizontal=me.isHorizontal();var optionTicks=me.options.ticks.minor;var tickCount=ticks.length;var skipRatio=false;var maxTicks=optionTicks.maxTicksLimit;var ticksLength=me._tickSize()*(tickCount-1);var axisLength=isHorizontal?me.width-(me.paddingLeft+me.paddingRight):me.height-(me.paddingTop+me.PaddingBottom);var result=[];var i,tick;if(ticksLength>axisLength){skipRatio=1+Math.floor(ticksLength/axisLength);}
if(tickCount>maxTicks){skipRatio=Math.max(skipRatio,1+Math.floor(tickCount/maxTicks));}
for(i=0;i<tickCount;i++){tick=ticks[i];if(skipRatio>1&&i%skipRatio>0){delete tick.label;}
result.push(tick);}
return result;},_tickSize:function(){var me=this;var isHorizontal=me.isHorizontal();var optionTicks=me.options.ticks.minor;var rot=helpers$1.toRadians(me.labelRotation);var cos=Math.abs(Math.cos(rot));var sin=Math.abs(Math.sin(rot));var padding=optionTicks.autoSkipPadding||0;var w=(me.longestLabelWidth+padding)||0;var tickFont=helpers$1.options._parseFont(optionTicks);var h=(me._maxLabelLines*tickFont.lineHeight+padding)||0;return isHorizontal?h*cos>w*sin?w/cos:h/sin:h*sin<w*cos?h/cos:w/sin;},_isVisible:function(){var me=this;var chart=me.chart;var display=me.options.display;var i,ilen,meta;if(display!=='auto'){return!!display;}
for(i=0,ilen=chart.data.datasets.length;i<ilen;++i){if(chart.isDatasetVisible(i)){meta=chart.getDatasetMeta(i);if(meta.xAxisID===me.id||meta.yAxisID===me.id){return true;}}}
return false;},draw:function(chartArea){var me=this;var options=me.options;if(!me._isVisible()){return;}
var chart=me.chart;var context=me.ctx;var globalDefaults=core_defaults.global;var defaultFontColor=globalDefaults.defaultFontColor;var optionTicks=options.ticks.minor;var optionMajorTicks=options.ticks.major||optionTicks;var gridLines=options.gridLines;var scaleLabel=options.scaleLabel;var position=options.position;var isRotated=me.labelRotation!==0;var isMirrored=optionTicks.mirror;var isHorizontal=me.isHorizontal();var parseFont=helpers$1.options._parseFont;var ticks=optionTicks.display&&optionTicks.autoSkip?me._autoSkip(me.getTicks()):me.getTicks();var tickFontColor=valueOrDefault$9(optionTicks.fontColor,defaultFontColor);var tickFont=parseFont(optionTicks);var lineHeight=tickFont.lineHeight;var majorTickFontColor=valueOrDefault$9(optionMajorTicks.fontColor,defaultFontColor);var majorTickFont=parseFont(optionMajorTicks);var tickPadding=optionTicks.padding;var labelOffset=optionTicks.labelOffset;var tl=gridLines.drawTicks?gridLines.tickMarkLength:0;var scaleLabelFontColor=valueOrDefault$9(scaleLabel.fontColor,defaultFontColor);var scaleLabelFont=parseFont(scaleLabel);var scaleLabelPadding=helpers$1.options.toPadding(scaleLabel.padding);var labelRotationRadians=helpers$1.toRadians(me.labelRotation);var itemsToDraw=[];var axisWidth=gridLines.drawBorder?valueAtIndexOrDefault(gridLines.lineWidth,0,0):0;var alignPixel=helpers$1._alignPixel;var borderValue,tickStart,tickEnd;if(position==='top'){borderValue=alignPixel(chart,me.bottom,axisWidth);tickStart=me.bottom-tl;tickEnd=borderValue-axisWidth/2;}else if(position==='bottom'){borderValue=alignPixel(chart,me.top,axisWidth);tickStart=borderValue+axisWidth/2;tickEnd=me.top+tl;}else if(position==='left'){borderValue=alignPixel(chart,me.right,axisWidth);tickStart=me.right-tl;tickEnd=borderValue-axisWidth/2;}else{borderValue=alignPixel(chart,me.left,axisWidth);tickStart=borderValue+axisWidth/2;tickEnd=me.left+tl;}
var epsilon=0.0000001;helpers$1.each(ticks,function(tick,index){if(helpers$1.isNullOrUndef(tick.label)){return;}
var label=tick.label;var lineWidth,lineColor,borderDash,borderDashOffset;if(index===me.zeroLineIndex&&options.offset===gridLines.offsetGridLines){lineWidth=gridLines.zeroLineWidth;lineColor=gridLines.zeroLineColor;borderDash=gridLines.zeroLineBorderDash||[];borderDashOffset=gridLines.zeroLineBorderDashOffset||0.0;}else{lineWidth=valueAtIndexOrDefault(gridLines.lineWidth,index);lineColor=valueAtIndexOrDefault(gridLines.color,index);borderDash=gridLines.borderDash||[];borderDashOffset=gridLines.borderDashOffset||0.0;}
var tx1,ty1,tx2,ty2,x1,y1,x2,y2,labelX,labelY,textOffset,textAlign;var labelCount=helpers$1.isArray(label)?label.length:1;var lineValue=getPixelForGridLine(me,index,gridLines.offsetGridLines);if(isHorizontal){var labelYOffset=tl+tickPadding;if(lineValue<me.left-epsilon){lineColor='rgba(0,0,0,0)';}
tx1=tx2=x1=x2=alignPixel(chart,lineValue,lineWidth);ty1=tickStart;ty2=tickEnd;labelX=me.getPixelForTick(index)+labelOffset;if(position==='top'){y1=alignPixel(chart,chartArea.top,axisWidth)+axisWidth/2;y2=chartArea.bottom;textOffset=((!isRotated?0.5:1)-labelCount)*lineHeight;textAlign=!isRotated?'center':'left';labelY=me.bottom-labelYOffset;}else{y1=chartArea.top;y2=alignPixel(chart,chartArea.bottom,axisWidth)-axisWidth/2;textOffset=(!isRotated?0.5:0)*lineHeight;textAlign=!isRotated?'center':'right';labelY=me.top+labelYOffset;}}else{var labelXOffset=(isMirrored?0:tl)+tickPadding;if(lineValue<me.top-epsilon){lineColor='rgba(0,0,0,0)';}
tx1=tickStart;tx2=tickEnd;ty1=ty2=y1=y2=alignPixel(chart,lineValue,lineWidth);labelY=me.getPixelForTick(index)+labelOffset;textOffset=(1-labelCount)*lineHeight/2;if(position==='left'){x1=alignPixel(chart,chartArea.left,axisWidth)+axisWidth/2;x2=chartArea.right;textAlign=isMirrored?'left':'right';labelX=me.right-labelXOffset;}else{x1=chartArea.left;x2=alignPixel(chart,chartArea.right,axisWidth)-axisWidth/2;textAlign=isMirrored?'right':'left';labelX=me.left+labelXOffset;}}
itemsToDraw.push({tx1:tx1,ty1:ty1,tx2:tx2,ty2:ty2,x1:x1,y1:y1,x2:x2,y2:y2,labelX:labelX,labelY:labelY,glWidth:lineWidth,glColor:lineColor,glBorderDash:borderDash,glBorderDashOffset:borderDashOffset,rotation:-1*labelRotationRadians,label:label,major:tick.major,textOffset:textOffset,textAlign:textAlign});});helpers$1.each(itemsToDraw,function(itemToDraw){var glWidth=itemToDraw.glWidth;var glColor=itemToDraw.glColor;if(gridLines.display&&glWidth&&glColor){context.save();context.lineWidth=glWidth;context.strokeStyle=glColor;if(context.setLineDash){context.setLineDash(itemToDraw.glBorderDash);context.lineDashOffset=itemToDraw.glBorderDashOffset;}
context.beginPath();if(gridLines.drawTicks){context.moveTo(itemToDraw.tx1,itemToDraw.ty1);context.lineTo(itemToDraw.tx2,itemToDraw.ty2);}
if(gridLines.drawOnChartArea){context.moveTo(itemToDraw.x1,itemToDraw.y1);context.lineTo(itemToDraw.x2,itemToDraw.y2);}
context.stroke();context.restore();}
if(optionTicks.display){context.save();context.translate(itemToDraw.labelX,itemToDraw.labelY);context.rotate(itemToDraw.rotation);context.font=itemToDraw.major?majorTickFont.string:tickFont.string;context.fillStyle=itemToDraw.major?majorTickFontColor:tickFontColor;context.textBaseline='middle';context.textAlign=itemToDraw.textAlign;var label=itemToDraw.label;var y=itemToDraw.textOffset;if(helpers$1.isArray(label)){for(var i=0;i<label.length;++i){context.fillText(''+label[i],0,y);y+=lineHeight;}}else{context.fillText(label,0,y);}
context.restore();}});if(scaleLabel.display){var scaleLabelX;var scaleLabelY;var rotation=0;var halfLineHeight=scaleLabelFont.lineHeight/2;if(isHorizontal){scaleLabelX=me.left+((me.right-me.left)/2);scaleLabelY=position==='bottom'?me.bottom-halfLineHeight-scaleLabelPadding.bottom:me.top+halfLineHeight+scaleLabelPadding.top;}else{var isLeft=position==='left';scaleLabelX=isLeft?me.left+halfLineHeight+scaleLabelPadding.top:me.right-halfLineHeight-scaleLabelPadding.top;scaleLabelY=me.top+((me.bottom-me.top)/2);rotation=isLeft?-0.5*Math.PI:0.5*Math.PI;}
context.save();context.translate(scaleLabelX,scaleLabelY);context.rotate(rotation);context.textAlign='center';context.textBaseline='middle';context.fillStyle=scaleLabelFontColor;context.font=scaleLabelFont.string;context.fillText(scaleLabel.labelString,0,0);context.restore();}
if(axisWidth){var firstLineWidth=axisWidth;var lastLineWidth=valueAtIndexOrDefault(gridLines.lineWidth,ticks.length-1,0);var x1,x2,y1,y2;if(isHorizontal){x1=alignPixel(chart,me.left,firstLineWidth)-firstLineWidth/2;x2=alignPixel(chart,me.right,lastLineWidth)+lastLineWidth/2;y1=y2=borderValue;}else{y1=alignPixel(chart,me.top,firstLineWidth)-firstLineWidth/2;y2=alignPixel(chart,me.bottom,lastLineWidth)+lastLineWidth/2;x1=x2=borderValue;}
context.lineWidth=axisWidth;context.strokeStyle=valueAtIndexOrDefault(gridLines.color,0);context.beginPath();context.moveTo(x1,y1);context.lineTo(x2,y2);context.stroke();}}});var defaultConfig={position:'bottom'};var scale_category=core_scale.extend({getLabels:function(){var data=this.chart.data;return this.options.labels||(this.isHorizontal()?data.xLabels:data.yLabels)||data.labels;},determineDataLimits:function(){var me=this;var labels=me.getLabels();me.minIndex=0;me.maxIndex=labels.length-1;var findIndex;if(me.options.ticks.min!==undefined){findIndex=labels.indexOf(me.options.ticks.min);me.minIndex=findIndex!==-1?findIndex:me.minIndex;}
if(me.options.ticks.max!==undefined){findIndex=labels.indexOf(me.options.ticks.max);me.maxIndex=findIndex!==-1?findIndex:me.maxIndex;}
me.min=labels[me.minIndex];me.max=labels[me.maxIndex];},buildTicks:function(){var me=this;var labels=me.getLabels();me.ticks=(me.minIndex===0&&me.maxIndex===labels.length-1)?labels:labels.slice(me.minIndex,me.maxIndex+1);},getLabelForIndex:function(index,datasetIndex){var me=this;var chart=me.chart;if(chart.getDatasetMeta(datasetIndex).controller._getValueScaleId()===me.id){return me.getRightValue(chart.data.datasets[datasetIndex].data[index]);}
return me.ticks[index-me.minIndex];},getPixelForValue:function(value,index){var me=this;var offset=me.options.offset;var offsetAmt=Math.max((me.maxIndex+1-me.minIndex-(offset?0:1)),1);var valueCategory;if(value!==undefined&&value!==null){valueCategory=me.isHorizontal()?value.x:value.y;}
if(valueCategory!==undefined||(value!==undefined&&isNaN(index))){var labels=me.getLabels();value=valueCategory||value;var idx=labels.indexOf(value);index=idx!==-1?idx:index;}
if(me.isHorizontal()){var valueWidth=me.width/offsetAmt;var widthOffset=(valueWidth*(index-me.minIndex));if(offset){widthOffset+=(valueWidth/2);}
return me.left+widthOffset;}
var valueHeight=me.height/offsetAmt;var heightOffset=(valueHeight*(index-me.minIndex));if(offset){heightOffset+=(valueHeight/2);}
return me.top+heightOffset;},getPixelForTick:function(index){return this.getPixelForValue(this.ticks[index],index+this.minIndex,null);},getValueForPixel:function(pixel){var me=this;var offset=me.options.offset;var value;var offsetAmt=Math.max((me._ticks.length-(offset?0:1)),1);var horz=me.isHorizontal();var valueDimension=(horz?me.width:me.height)/offsetAmt;pixel-=horz?me.left:me.top;if(offset){pixel-=(valueDimension/2);}
if(pixel<=0){value=0;}else{value=Math.round(pixel/valueDimension);}
return value+me.minIndex;},getBasePixel:function(){return this.bottom;}});var _defaults=defaultConfig;scale_category._defaults=_defaults;var noop=helpers$1.noop;var isNullOrUndef=helpers$1.isNullOrUndef;function generateTicks(generationOptions,dataRange){var ticks=[];var MIN_SPACING=1e-14;var stepSize=generationOptions.stepSize;var unit=stepSize||1;var maxNumSpaces=generationOptions.maxTicks-1;var min=generationOptions.min;var max=generationOptions.max;var precision=generationOptions.precision;var rmin=dataRange.min;var rmax=dataRange.max;var spacing=helpers$1.niceNum((rmax-rmin)/maxNumSpaces/unit)*unit;var factor,niceMin,niceMax,numSpaces;if(spacing<MIN_SPACING&&isNullOrUndef(min)&&isNullOrUndef(max)){return[rmin,rmax];}
numSpaces=Math.ceil(rmax/spacing)-Math.floor(rmin/spacing);if(numSpaces>maxNumSpaces){spacing=helpers$1.niceNum(numSpaces*spacing/maxNumSpaces/unit)*unit;}
if(stepSize||isNullOrUndef(precision)){factor=Math.pow(10,helpers$1._decimalPlaces(spacing));}else{factor=Math.pow(10,precision);spacing=Math.ceil(spacing*factor)/factor;}
niceMin=Math.floor(rmin/spacing)*spacing;niceMax=Math.ceil(rmax/spacing)*spacing;if(stepSize){if(!isNullOrUndef(min)&&helpers$1.almostWhole(min/spacing,spacing/1000)){niceMin=min;}
if(!isNullOrUndef(max)&&helpers$1.almostWhole(max/spacing,spacing/1000)){niceMax=max;}}
numSpaces=(niceMax-niceMin)/spacing;if(helpers$1.almostEquals(numSpaces,Math.round(numSpaces),spacing/1000)){numSpaces=Math.round(numSpaces);}else{numSpaces=Math.ceil(numSpaces);}
niceMin=Math.round(niceMin*factor)/factor;niceMax=Math.round(niceMax*factor)/factor;ticks.push(isNullOrUndef(min)?niceMin:min);for(var j=1;j<numSpaces;++j){ticks.push(Math.round((niceMin+j*spacing)*factor)/factor);}
ticks.push(isNullOrUndef(max)?niceMax:max);return ticks;}
var scale_linearbase=core_scale.extend({getRightValue:function(value){if(typeof value==='string'){return+value;}
return core_scale.prototype.getRightValue.call(this,value);},handleTickRangeOptions:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;if(tickOpts.beginAtZero){var minSign=helpers$1.sign(me.min);var maxSign=helpers$1.sign(me.max);if(minSign<0&&maxSign<0){me.max=0;}else if(minSign>0&&maxSign>0){me.min=0;}}
var setMin=tickOpts.min!==undefined||tickOpts.suggestedMin!==undefined;var setMax=tickOpts.max!==undefined||tickOpts.suggestedMax!==undefined;if(tickOpts.min!==undefined){me.min=tickOpts.min;}else if(tickOpts.suggestedMin!==undefined){if(me.min===null){me.min=tickOpts.suggestedMin;}else{me.min=Math.min(me.min,tickOpts.suggestedMin);}}
if(tickOpts.max!==undefined){me.max=tickOpts.max;}else if(tickOpts.suggestedMax!==undefined){if(me.max===null){me.max=tickOpts.suggestedMax;}else{me.max=Math.max(me.max,tickOpts.suggestedMax);}}
if(setMin!==setMax){if(me.min>=me.max){if(setMin){me.max=me.min+1;}else{me.min=me.max-1;}}}
if(me.min===me.max){me.max++;if(!tickOpts.beginAtZero){me.min--;}}},getTickLimit:function(){var me=this;var tickOpts=me.options.ticks;var stepSize=tickOpts.stepSize;var maxTicksLimit=tickOpts.maxTicksLimit;var maxTicks;if(stepSize){maxTicks=Math.ceil(me.max/stepSize)-Math.floor(me.min/stepSize)+1;}else{maxTicks=me._computeTickLimit();maxTicksLimit=maxTicksLimit||11;}
if(maxTicksLimit){maxTicks=Math.min(maxTicksLimit,maxTicks);}
return maxTicks;},_computeTickLimit:function(){return Number.POSITIVE_INFINITY;},handleDirectionalChanges:noop,buildTicks:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;var maxTicks=me.getTickLimit();maxTicks=Math.max(2,maxTicks);var numericGeneratorOptions={maxTicks:maxTicks,min:tickOpts.min,max:tickOpts.max,precision:tickOpts.precision,stepSize:helpers$1.valueOrDefault(tickOpts.fixedStepSize,tickOpts.stepSize)};var ticks=me.ticks=generateTicks(numericGeneratorOptions,me);me.handleDirectionalChanges();me.max=helpers$1.max(ticks);me.min=helpers$1.min(ticks);if(tickOpts.reverse){ticks.reverse();me.start=me.max;me.end=me.min;}else{me.start=me.min;me.end=me.max;}},convertTicksToLabels:function(){var me=this;me.ticksAsNumbers=me.ticks.slice();me.zeroLineIndex=me.ticks.indexOf(0);core_scale.prototype.convertTicksToLabels.call(me);}});var defaultConfig$1={position:'left',ticks:{callback:core_ticks.formatters.linear}};var scale_linear=scale_linearbase.extend({determineDataLimits:function(){var me=this;var opts=me.options;var chart=me.chart;var data=chart.data;var datasets=data.datasets;var isHorizontal=me.isHorizontal();var DEFAULT_MIN=0;var DEFAULT_MAX=1;function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id;}
me.min=null;me.max=null;var hasStacks=opts.stacked;if(hasStacks===undefined){helpers$1.each(datasets,function(dataset,datasetIndex){if(hasStacks){return;}
var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&meta.stack!==undefined){hasStacks=true;}});}
if(opts.stacked||hasStacks){var valuesPerStack={};helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);var key=[meta.type,((opts.stacked===undefined&&meta.stack===undefined)?datasetIndex:''),meta.stack].join('.');if(valuesPerStack[key]===undefined){valuesPerStack[key]={positiveValues:[],negativeValues:[]};}
var positiveValues=valuesPerStack[key].positiveValues;var negativeValues=valuesPerStack[key].negativeValues;if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return;}
positiveValues[index]=positiveValues[index]||0;negativeValues[index]=negativeValues[index]||0;if(opts.relativePoints){positiveValues[index]=100;}else if(value<0){negativeValues[index]+=value;}else{positiveValues[index]+=value;}});}});helpers$1.each(valuesPerStack,function(valuesForType){var values=valuesForType.positiveValues.concat(valuesForType.negativeValues);var minVal=helpers$1.min(values);var maxVal=helpers$1.max(values);me.min=me.min===null?minVal:Math.min(me.min,minVal);me.max=me.max===null?maxVal:Math.max(me.max,maxVal);});}else{helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return;}
if(me.min===null){me.min=value;}else if(value<me.min){me.min=value;}
if(me.max===null){me.max=value;}else if(value>me.max){me.max=value;}});}});}
me.min=isFinite(me.min)&&!isNaN(me.min)?me.min:DEFAULT_MIN;me.max=isFinite(me.max)&&!isNaN(me.max)?me.max:DEFAULT_MAX;this.handleTickRangeOptions();},_computeTickLimit:function(){var me=this;var tickFont;if(me.isHorizontal()){return Math.ceil(me.width/40);}
tickFont=helpers$1.options._parseFont(me.options.ticks);return Math.ceil(me.height/tickFont.lineHeight);},handleDirectionalChanges:function(){if(!this.isHorizontal()){this.ticks.reverse();}},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index]);},getPixelForValue:function(value){var me=this;var start=me.start;var rightValue=+me.getRightValue(value);var pixel;var range=me.end-start;if(me.isHorizontal()){pixel=me.left+(me.width/range*(rightValue-start));}else{pixel=me.bottom-(me.height/range*(rightValue-start));}
return pixel;},getValueForPixel:function(pixel){var me=this;var isHorizontal=me.isHorizontal();var innerDimension=isHorizontal?me.width:me.height;var offset=(isHorizontal?pixel-me.left:me.bottom-pixel)/innerDimension;return me.start+((me.end-me.start)*offset);},getPixelForTick:function(index){return this.getPixelForValue(this.ticksAsNumbers[index]);}});var _defaults$1=defaultConfig$1;scale_linear._defaults=_defaults$1;var valueOrDefault$a=helpers$1.valueOrDefault;function generateTicks$1(generationOptions,dataRange){var ticks=[];var tickVal=valueOrDefault$a(generationOptions.min,Math.pow(10,Math.floor(helpers$1.log10(dataRange.min))));var endExp=Math.floor(helpers$1.log10(dataRange.max));var endSignificand=Math.ceil(dataRange.max/Math.pow(10,endExp));var exp,significand;if(tickVal===0){exp=Math.floor(helpers$1.log10(dataRange.minNotZero));significand=Math.floor(dataRange.minNotZero/Math.pow(10,exp));ticks.push(tickVal);tickVal=significand*Math.pow(10,exp);}else{exp=Math.floor(helpers$1.log10(tickVal));significand=Math.floor(tickVal/Math.pow(10,exp));}
var precision=exp<0?Math.pow(10,Math.abs(exp)):1;do{ticks.push(tickVal);++significand;if(significand===10){significand=1;++exp;precision=exp>=0?1:precision;}
tickVal=Math.round(significand*Math.pow(10,exp)*precision)/precision;}while(exp<endExp||(exp===endExp&&significand<endSignificand));var lastTick=valueOrDefault$a(generationOptions.max,tickVal);ticks.push(lastTick);return ticks;}
var defaultConfig$2={position:'left',ticks:{callback:core_ticks.formatters.logarithmic}};function nonNegativeOrDefault(value,defaultValue){return helpers$1.isFinite(value)&&value>=0?value:defaultValue;}
var scale_logarithmic=core_scale.extend({determineDataLimits:function(){var me=this;var opts=me.options;var chart=me.chart;var data=chart.data;var datasets=data.datasets;var isHorizontal=me.isHorizontal();function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id;}
me.min=null;me.max=null;me.minNotZero=null;var hasStacks=opts.stacked;if(hasStacks===undefined){helpers$1.each(datasets,function(dataset,datasetIndex){if(hasStacks){return;}
var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&meta.stack!==undefined){hasStacks=true;}});}
if(opts.stacked||hasStacks){var valuesPerStack={};helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);var key=[meta.type,((opts.stacked===undefined&&meta.stack===undefined)?datasetIndex:''),meta.stack].join('.');if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){if(valuesPerStack[key]===undefined){valuesPerStack[key]=[];}
helpers$1.each(dataset.data,function(rawValue,index){var values=valuesPerStack[key];var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden||value<0){return;}
values[index]=values[index]||0;values[index]+=value;});}});helpers$1.each(valuesPerStack,function(valuesForType){if(valuesForType.length>0){var minVal=helpers$1.min(valuesForType);var maxVal=helpers$1.max(valuesForType);me.min=me.min===null?minVal:Math.min(me.min,minVal);me.max=me.max===null?maxVal:Math.max(me.max,maxVal);}});}else{helpers$1.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden||value<0){return;}
if(me.min===null){me.min=value;}else if(value<me.min){me.min=value;}
if(me.max===null){me.max=value;}else if(value>me.max){me.max=value;}
if(value!==0&&(me.minNotZero===null||value<me.minNotZero)){me.minNotZero=value;}});}});}
this.handleTickRangeOptions();},handleTickRangeOptions:function(){var me=this;var tickOpts=me.options.ticks;var DEFAULT_MIN=1;var DEFAULT_MAX=10;me.min=nonNegativeOrDefault(tickOpts.min,me.min);me.max=nonNegativeOrDefault(tickOpts.max,me.max);if(me.min===me.max){if(me.min!==0&&me.min!==null){me.min=Math.pow(10,Math.floor(helpers$1.log10(me.min))-1);me.max=Math.pow(10,Math.floor(helpers$1.log10(me.max))+1);}else{me.min=DEFAULT_MIN;me.max=DEFAULT_MAX;}}
if(me.min===null){me.min=Math.pow(10,Math.floor(helpers$1.log10(me.max))-1);}
if(me.max===null){me.max=me.min!==0?Math.pow(10,Math.floor(helpers$1.log10(me.min))+1):DEFAULT_MAX;}
if(me.minNotZero===null){if(me.min>0){me.minNotZero=me.min;}else if(me.max<1){me.minNotZero=Math.pow(10,Math.floor(helpers$1.log10(me.max)));}else{me.minNotZero=DEFAULT_MIN;}}},buildTicks:function(){var me=this;var tickOpts=me.options.ticks;var reverse=!me.isHorizontal();var generationOptions={min:nonNegativeOrDefault(tickOpts.min),max:nonNegativeOrDefault(tickOpts.max)};var ticks=me.ticks=generateTicks$1(generationOptions,me);me.max=helpers$1.max(ticks);me.min=helpers$1.min(ticks);if(tickOpts.reverse){reverse=!reverse;me.start=me.max;me.end=me.min;}else{me.start=me.min;me.end=me.max;}
if(reverse){ticks.reverse();}},convertTicksToLabels:function(){this.tickValues=this.ticks.slice();core_scale.prototype.convertTicksToLabels.call(this);},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index]);},getPixelForTick:function(index){return this.getPixelForValue(this.tickValues[index]);},_getFirstTickValue:function(value){var exp=Math.floor(helpers$1.log10(value));var significand=Math.floor(value/Math.pow(10,exp));return significand*Math.pow(10,exp);},getPixelForValue:function(value){var me=this;var tickOpts=me.options.ticks;var reverse=tickOpts.reverse;var log10=helpers$1.log10;var firstTickValue=me._getFirstTickValue(me.minNotZero);var offset=0;var innerDimension,pixel,start,end,sign;value=+me.getRightValue(value);if(reverse){start=me.end;end=me.start;sign=-1;}else{start=me.start;end=me.end;sign=1;}
if(me.isHorizontal()){innerDimension=me.width;pixel=reverse?me.right:me.left;}else{innerDimension=me.height;sign*=-1;pixel=reverse?me.top:me.bottom;}
if(value!==start){if(start===0){offset=valueOrDefault$a(tickOpts.fontSize,core_defaults.global.defaultFontSize);innerDimension-=offset;start=firstTickValue;}
if(value!==0){offset+=innerDimension/(log10(end)-log10(start))*(log10(value)-log10(start));}
pixel+=sign*offset;}
return pixel;},getValueForPixel:function(pixel){var me=this;var tickOpts=me.options.ticks;var reverse=tickOpts.reverse;var log10=helpers$1.log10;var firstTickValue=me._getFirstTickValue(me.minNotZero);var innerDimension,start,end,value;if(reverse){start=me.end;end=me.start;}else{start=me.start;end=me.end;}
if(me.isHorizontal()){innerDimension=me.width;value=reverse?me.right-pixel:pixel-me.left;}else{innerDimension=me.height;value=reverse?pixel-me.top:me.bottom-pixel;}
if(value!==start){if(start===0){var offset=valueOrDefault$a(tickOpts.fontSize,core_defaults.global.defaultFontSize);value-=offset;innerDimension-=offset;start=firstTickValue;}
value*=log10(end)-log10(start);value/=innerDimension;value=Math.pow(10,log10(start)+value);}
return value;}});var _defaults$2=defaultConfig$2;scale_logarithmic._defaults=_defaults$2;var valueOrDefault$b=helpers$1.valueOrDefault;var valueAtIndexOrDefault$1=helpers$1.valueAtIndexOrDefault;var resolve$7=helpers$1.options.resolve;var defaultConfig$3={display:true,animate:true,position:'chartArea',angleLines:{display:true,color:'rgba(0, 0, 0, 0.1)',lineWidth:1,borderDash:[],borderDashOffset:0.0},gridLines:{circular:false},ticks:{showLabelBackdrop:true,backdropColor:'rgba(255,255,255,0.75)',backdropPaddingY:2,backdropPaddingX:2,callback:core_ticks.formatters.linear},pointLabels:{display:true,fontSize:10,callback:function(label){return label;}}};function getValueCount(scale){var opts=scale.options;return opts.angleLines.display||opts.pointLabels.display?scale.chart.data.labels.length:0;}
function getTickBackdropHeight(opts){var tickOpts=opts.ticks;if(tickOpts.display&&opts.display){return valueOrDefault$b(tickOpts.fontSize,core_defaults.global.defaultFontSize)+tickOpts.backdropPaddingY*2;}
return 0;}
function measureLabelSize(ctx,lineHeight,label){if(helpers$1.isArray(label)){return{w:helpers$1.longestText(ctx,ctx.font,label),h:label.length*lineHeight};}
return{w:ctx.measureText(label).width,h:lineHeight};}
function determineLimits(angle,pos,size,min,max){if(angle===min||angle===max){return{start:pos-(size/2),end:pos+(size/2)};}else if(angle<min||angle>max){return{start:pos-size,end:pos};}
return{start:pos,end:pos+size};}
function fitWithPointLabels(scale){var plFont=helpers$1.options._parseFont(scale.options.pointLabels);var furthestLimits={l:0,r:scale.width,t:0,b:scale.height-scale.paddingTop};var furthestAngles={};var i,textSize,pointPosition;scale.ctx.font=plFont.string;scale._pointLabelSizes=[];var valueCount=getValueCount(scale);for(i=0;i<valueCount;i++){pointPosition=scale.getPointPosition(i,scale.drawingArea+5);textSize=measureLabelSize(scale.ctx,plFont.lineHeight,scale.pointLabels[i]||'');scale._pointLabelSizes[i]=textSize;var angleRadians=scale.getIndexAngle(i);var angle=helpers$1.toDegrees(angleRadians)%360;var hLimits=determineLimits(angle,pointPosition.x,textSize.w,0,180);var vLimits=determineLimits(angle,pointPosition.y,textSize.h,90,270);if(hLimits.start<furthestLimits.l){furthestLimits.l=hLimits.start;furthestAngles.l=angleRadians;}
if(hLimits.end>furthestLimits.r){furthestLimits.r=hLimits.end;furthestAngles.r=angleRadians;}
if(vLimits.start<furthestLimits.t){furthestLimits.t=vLimits.start;furthestAngles.t=angleRadians;}
if(vLimits.end>furthestLimits.b){furthestLimits.b=vLimits.end;furthestAngles.b=angleRadians;}}
scale.setReductions(scale.drawingArea,furthestLimits,furthestAngles);}
function getTextAlignForAngle(angle){if(angle===0||angle===180){return'center';}else if(angle<180){return'left';}
return'right';}
function fillText(ctx,text,position,lineHeight){var y=position.y+lineHeight/2;var i,ilen;if(helpers$1.isArray(text)){for(i=0,ilen=text.length;i<ilen;++i){ctx.fillText(text[i],position.x,y);y+=lineHeight;}}else{ctx.fillText(text,position.x,y);}}
function adjustPointPositionForLabelHeight(angle,textSize,position){if(angle===90||angle===270){position.y-=(textSize.h/2);}else if(angle>270||angle<90){position.y-=textSize.h;}}
function drawPointLabels(scale){var ctx=scale.ctx;var opts=scale.options;var angleLineOpts=opts.angleLines;var gridLineOpts=opts.gridLines;var pointLabelOpts=opts.pointLabels;var lineWidth=valueOrDefault$b(angleLineOpts.lineWidth,gridLineOpts.lineWidth);var lineColor=valueOrDefault$b(angleLineOpts.color,gridLineOpts.color);var tickBackdropHeight=getTickBackdropHeight(opts);ctx.save();ctx.lineWidth=lineWidth;ctx.strokeStyle=lineColor;if(ctx.setLineDash){ctx.setLineDash(resolve$7([angleLineOpts.borderDash,gridLineOpts.borderDash,[]]));ctx.lineDashOffset=resolve$7([angleLineOpts.borderDashOffset,gridLineOpts.borderDashOffset,0.0]);}
var outerDistance=scale.getDistanceFromCenterForValue(opts.ticks.reverse?scale.min:scale.max);var plFont=helpers$1.options._parseFont(pointLabelOpts);ctx.font=plFont.string;ctx.textBaseline='middle';for(var i=getValueCount(scale)-1;i>=0;i--){if(angleLineOpts.display&&lineWidth&&lineColor){var outerPosition=scale.getPointPosition(i,outerDistance);ctx.beginPath();ctx.moveTo(scale.xCenter,scale.yCenter);ctx.lineTo(outerPosition.x,outerPosition.y);ctx.stroke();}
if(pointLabelOpts.display){var extra=(i===0?tickBackdropHeight/2:0);var pointLabelPosition=scale.getPointPosition(i,outerDistance+extra+5);var pointLabelFontColor=valueAtIndexOrDefault$1(pointLabelOpts.fontColor,i,core_defaults.global.defaultFontColor);ctx.fillStyle=pointLabelFontColor;var angleRadians=scale.getIndexAngle(i);var angle=helpers$1.toDegrees(angleRadians);ctx.textAlign=getTextAlignForAngle(angle);adjustPointPositionForLabelHeight(angle,scale._pointLabelSizes[i],pointLabelPosition);fillText(ctx,scale.pointLabels[i]||'',pointLabelPosition,plFont.lineHeight);}}
ctx.restore();}
function drawRadiusLine(scale,gridLineOpts,radius,index){var ctx=scale.ctx;var circular=gridLineOpts.circular;var valueCount=getValueCount(scale);var lineColor=valueAtIndexOrDefault$1(gridLineOpts.color,index-1);var lineWidth=valueAtIndexOrDefault$1(gridLineOpts.lineWidth,index-1);var pointPosition;if((!circular&&!valueCount)||!lineColor||!lineWidth){return;}
ctx.save();ctx.strokeStyle=lineColor;ctx.lineWidth=lineWidth;if(ctx.setLineDash){ctx.setLineDash(gridLineOpts.borderDash||[]);ctx.lineDashOffset=gridLineOpts.borderDashOffset||0.0;}
ctx.beginPath();if(circular){ctx.arc(scale.xCenter,scale.yCenter,radius,0,Math.PI*2);}else{pointPosition=scale.getPointPosition(0,radius);ctx.moveTo(pointPosition.x,pointPosition.y);for(var i=1;i<valueCount;i++){pointPosition=scale.getPointPosition(i,radius);ctx.lineTo(pointPosition.x,pointPosition.y);}}
ctx.closePath();ctx.stroke();ctx.restore();}
function numberOrZero(param){return helpers$1.isNumber(param)?param:0;}
var scale_radialLinear=scale_linearbase.extend({setDimensions:function(){var me=this;me.width=me.maxWidth;me.height=me.maxHeight;me.paddingTop=getTickBackdropHeight(me.options)/2;me.xCenter=Math.floor(me.width/2);me.yCenter=Math.floor((me.height-me.paddingTop)/2);me.drawingArea=Math.min(me.height-me.paddingTop,me.width)/2;},determineDataLimits:function(){var me=this;var chart=me.chart;var min=Number.POSITIVE_INFINITY;var max=Number.NEGATIVE_INFINITY;helpers$1.each(chart.data.datasets,function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);helpers$1.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return;}
min=Math.min(value,min);max=Math.max(value,max);});}});me.min=(min===Number.POSITIVE_INFINITY?0:min);me.max=(max===Number.NEGATIVE_INFINITY?0:max);me.handleTickRangeOptions();},_computeTickLimit:function(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options));},convertTicksToLabels:function(){var me=this;scale_linearbase.prototype.convertTicksToLabels.call(me);me.pointLabels=me.chart.data.labels.map(me.options.pointLabels.callback,me);},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index]);},fit:function(){var me=this;var opts=me.options;if(opts.display&&opts.pointLabels.display){fitWithPointLabels(me);}else{me.setCenterPoint(0,0,0,0);}},setReductions:function(largestPossibleRadius,furthestLimits,furthestAngles){var me=this;var radiusReductionLeft=furthestLimits.l/Math.sin(furthestAngles.l);var radiusReductionRight=Math.max(furthestLimits.r-me.width,0)/Math.sin(furthestAngles.r);var radiusReductionTop=-furthestLimits.t/Math.cos(furthestAngles.t);var radiusReductionBottom=-Math.max(furthestLimits.b-(me.height-me.paddingTop),0)/Math.cos(furthestAngles.b);radiusReductionLeft=numberOrZero(radiusReductionLeft);radiusReductionRight=numberOrZero(radiusReductionRight);radiusReductionTop=numberOrZero(radiusReductionTop);radiusReductionBottom=numberOrZero(radiusReductionBottom);me.drawingArea=Math.min(Math.floor(largestPossibleRadius-(radiusReductionLeft+radiusReductionRight)/2),Math.floor(largestPossibleRadius-(radiusReductionTop+radiusReductionBottom)/2));me.setCenterPoint(radiusReductionLeft,radiusReductionRight,radiusReductionTop,radiusReductionBottom);},setCenterPoint:function(leftMovement,rightMovement,topMovement,bottomMovement){var me=this;var maxRight=me.width-rightMovement-me.drawingArea;var maxLeft=leftMovement+me.drawingArea;var maxTop=topMovement+me.drawingArea;var maxBottom=(me.height-me.paddingTop)-bottomMovement-me.drawingArea;me.xCenter=Math.floor(((maxLeft+maxRight)/2)+me.left);me.yCenter=Math.floor(((maxTop+maxBottom)/2)+me.top+me.paddingTop);},getIndexAngle:function(index){var angleMultiplier=(Math.PI*2)/getValueCount(this);var startAngle=this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0;var startAngleRadians=startAngle*Math.PI*2/360;return index*angleMultiplier+startAngleRadians;},getDistanceFromCenterForValue:function(value){var me=this;if(value===null){return 0;}
var scalingFactor=me.drawingArea/(me.max-me.min);if(me.options.ticks.reverse){return(me.max-value)*scalingFactor;}
return(value-me.min)*scalingFactor;},getPointPosition:function(index,distanceFromCenter){var me=this;var thisAngle=me.getIndexAngle(index)-(Math.PI/2);return{x:Math.cos(thisAngle)*distanceFromCenter+me.xCenter,y:Math.sin(thisAngle)*distanceFromCenter+me.yCenter};},getPointPositionForValue:function(index,value){return this.getPointPosition(index,this.getDistanceFromCenterForValue(value));},getBasePosition:function(){var me=this;var min=me.min;var max=me.max;return me.getPointPositionForValue(0,me.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0);},draw:function(){var me=this;var opts=me.options;var gridLineOpts=opts.gridLines;var tickOpts=opts.ticks;if(opts.display){var ctx=me.ctx;var startAngle=this.getIndexAngle(0);var tickFont=helpers$1.options._parseFont(tickOpts);if(opts.angleLines.display||opts.pointLabels.display){drawPointLabels(me);}
helpers$1.each(me.ticks,function(label,index){if(index>0||tickOpts.reverse){var yCenterOffset=me.getDistanceFromCenterForValue(me.ticksAsNumbers[index]);if(gridLineOpts.display&&index!==0){drawRadiusLine(me,gridLineOpts,yCenterOffset,index);}
if(tickOpts.display){var tickFontColor=valueOrDefault$b(tickOpts.fontColor,core_defaults.global.defaultFontColor);ctx.font=tickFont.string;ctx.save();ctx.translate(me.xCenter,me.yCenter);ctx.rotate(startAngle);if(tickOpts.showLabelBackdrop){var labelWidth=ctx.measureText(label).width;ctx.fillStyle=tickOpts.backdropColor;ctx.fillRect(-labelWidth/2-tickOpts.backdropPaddingX,-yCenterOffset-tickFont.size/2-tickOpts.backdropPaddingY,labelWidth+tickOpts.backdropPaddingX*2,tickFont.size+tickOpts.backdropPaddingY*2);}
ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=tickFontColor;ctx.fillText(label,0,-yCenterOffset);ctx.restore();}}});}}});var _defaults$3=defaultConfig$3;scale_radialLinear._defaults=_defaults$3;var valueOrDefault$c=helpers$1.valueOrDefault;var MIN_INTEGER=Number.MIN_SAFE_INTEGER||-9007199254740991;var MAX_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;var INTERVALS={millisecond:{common:true,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:true,size:1000,steps:[1,2,5,10,15,30]},minute:{common:true,size:60000,steps:[1,2,5,10,15,30]},hour:{common:true,size:3600000,steps:[1,2,3,6,12]},day:{common:true,size:86400000,steps:[1,2,5]},week:{common:false,size:604800000,steps:[1,2,3,4]},month:{common:true,size:2.628e9,steps:[1,2,3]},quarter:{common:false,size:7.884e9,steps:[1,2,3,4]},year:{common:true,size:3.154e10}};var UNITS=Object.keys(INTERVALS);function sorter(a,b){return a-b;}
function arrayUnique(items){var hash={};var out=[];var i,ilen,item;for(i=0,ilen=items.length;i<ilen;++i){item=items[i];if(!hash[item]){hash[item]=true;out.push(item);}}
return out;}
function buildLookupTable(timestamps,min,max,distribution){if(distribution==='linear'||!timestamps.length){return[{time:min,pos:0},{time:max,pos:1}];}
var table=[];var items=[min];var i,ilen,prev,curr,next;for(i=0,ilen=timestamps.length;i<ilen;++i){curr=timestamps[i];if(curr>min&&curr<max){items.push(curr);}}
items.push(max);for(i=0,ilen=items.length;i<ilen;++i){next=items[i+1];prev=items[i-1];curr=items[i];if(prev===undefined||next===undefined||Math.round((next+prev)/2)!==curr){table.push({time:curr,pos:i/(ilen-1)});}}
return table;}
function lookup(table,key,value){var lo=0;var hi=table.length-1;var mid,i0,i1;while(lo>=0&&lo<=hi){mid=(lo+hi)>>1;i0=table[mid-1]||null;i1=table[mid];if(!i0){return{lo:null,hi:i1};}else if(i1[key]<value){lo=mid+1;}else if(i0[key]>value){hi=mid-1;}else{return{lo:i0,hi:i1};}}
return{lo:i1,hi:null};}
function interpolate$1(table,skey,sval,tkey){var range=lookup(table,skey,sval);var prev=!range.lo?table[0]:!range.hi?table[table.length-2]:range.lo;var next=!range.lo?table[1]:!range.hi?table[table.length-1]:range.hi;var span=next[skey]-prev[skey];var ratio=span?(sval-prev[skey])/span:0;var offset=(next[tkey]-prev[tkey])*ratio;return prev[tkey]+offset;}
function toTimestamp(scale,input){var adapter=scale._adapter;var options=scale.options.time;var parser=options.parser;var format=parser||options.format;var value=input;if(typeof parser==='function'){value=parser(value);}
if(!helpers$1.isFinite(value)){value=typeof format==='string'?adapter.parse(value,format):adapter.parse(value);}
if(value!==null){return+value;}
if(!parser&&typeof format==='function'){value=format(input);if(!helpers$1.isFinite(value)){value=adapter.parse(value);}}
return value;}
function parse(scale,input){if(helpers$1.isNullOrUndef(input)){return null;}
var options=scale.options.time;var value=toTimestamp(scale,scale.getRightValue(input));if(value===null){return value;}
if(options.round){value=+scale._adapter.startOf(value,options.round);}
return value;}
function determineStepSize(min,max,unit,capacity){var range=max-min;var interval=INTERVALS[unit];var milliseconds=interval.size;var steps=interval.steps;var i,ilen,factor;if(!steps){return Math.ceil(range/(capacity*milliseconds));}
for(i=0,ilen=steps.length;i<ilen;++i){factor=steps[i];if(Math.ceil(range/(milliseconds*factor))<=capacity){break;}}
return factor;}
function determineUnitForAutoTicks(minUnit,min,max,capacity){var ilen=UNITS.length;var i,interval,factor;for(i=UNITS.indexOf(minUnit);i<ilen-1;++i){interval=INTERVALS[UNITS[i]];factor=interval.steps?interval.steps[interval.steps.length-1]:MAX_INTEGER;if(interval.common&&Math.ceil((max-min)/(factor*interval.size))<=capacity){return UNITS[i];}}
return UNITS[ilen-1];}
function determineUnitForFormatting(scale,ticks,minUnit,min,max){var ilen=UNITS.length;var i,unit;for(i=ilen-1;i>=UNITS.indexOf(minUnit);i--){unit=UNITS[i];if(INTERVALS[unit].common&&scale._adapter.diff(max,min,unit)>=ticks.length){return unit;}}
return UNITS[minUnit?UNITS.indexOf(minUnit):0];}
function determineMajorUnit(unit){for(var i=UNITS.indexOf(unit)+1,ilen=UNITS.length;i<ilen;++i){if(INTERVALS[UNITS[i]].common){return UNITS[i];}}}
function generate(scale,min,max,capacity){var adapter=scale._adapter;var options=scale.options;var timeOpts=options.time;var minor=timeOpts.unit||determineUnitForAutoTicks(timeOpts.minUnit,min,max,capacity);var major=determineMajorUnit(minor);var stepSize=valueOrDefault$c(timeOpts.stepSize,timeOpts.unitStepSize);var weekday=minor==='week'?timeOpts.isoWeekday:false;var majorTicksEnabled=options.ticks.major.enabled;var interval=INTERVALS[minor];var first=min;var last=max;var ticks=[];var time;if(!stepSize){stepSize=determineStepSize(min,max,minor,capacity);}
if(weekday){first=+adapter.startOf(first,'isoWeek',weekday);last=+adapter.startOf(last,'isoWeek',weekday);}
first=+adapter.startOf(first,weekday?'day':minor);last=+adapter.startOf(last,weekday?'day':minor);if(last<max){last=+adapter.add(last,1,minor);}
time=first;if(majorTicksEnabled&&major&&!weekday&&!timeOpts.round){time=+adapter.startOf(time,major);time=+adapter.add(time,~~((first-time)/(interval.size*stepSize))*stepSize,minor);}
for(;time<last;time=+adapter.add(time,stepSize,minor)){ticks.push(+time);}
ticks.push(+time);return ticks;}
function computeOffsets(table,ticks,min,max,options){var start=0;var end=0;var first,last;if(options.offset&&ticks.length){if(!options.time.min){first=interpolate$1(table,'time',ticks[0],'pos');if(ticks.length===1){start=1-first;}else{start=(interpolate$1(table,'time',ticks[1],'pos')-first)/2;}}
if(!options.time.max){last=interpolate$1(table,'time',ticks[ticks.length-1],'pos');if(ticks.length===1){end=last;}else{end=(last-interpolate$1(table,'time',ticks[ticks.length-2],'pos'))/2;}}}
return{start:start,end:end};}
function ticksFromTimestamps(scale,values,majorUnit){var ticks=[];var i,ilen,value,major;for(i=0,ilen=values.length;i<ilen;++i){value=values[i];major=majorUnit?value===+scale._adapter.startOf(value,majorUnit):false;ticks.push({value:value,major:major});}
return ticks;}
var defaultConfig$4={position:'bottom',distribution:'linear',bounds:'data',adapters:{},time:{parser:false,format:false,unit:false,round:false,displayFormat:false,isoWeekday:false,minUnit:'millisecond',displayFormats:{}},ticks:{autoSkip:false,source:'auto',major:{enabled:false}}};var scale_time=core_scale.extend({initialize:function(){this.mergeTicksOptions();core_scale.prototype.initialize.call(this);},update:function(){var me=this;var options=me.options;var time=options.time||(options.time={});var adapter=me._adapter=new core_adapters._date(options.adapters.date);if(time.format){console.warn('options.time.format is deprecated and replaced by options.time.parser.');}
helpers$1.mergeIf(time.displayFormats,adapter.formats());return core_scale.prototype.update.apply(me,arguments);},getRightValue:function(rawValue){if(rawValue&&rawValue.t!==undefined){rawValue=rawValue.t;}
return core_scale.prototype.getRightValue.call(this,rawValue);},determineDataLimits:function(){var me=this;var chart=me.chart;var adapter=me._adapter;var timeOpts=me.options.time;var unit=timeOpts.unit||'day';var min=MAX_INTEGER;var max=MIN_INTEGER;var timestamps=[];var datasets=[];var labels=[];var i,j,ilen,jlen,data,timestamp;var dataLabels=chart.data.labels||[];for(i=0,ilen=dataLabels.length;i<ilen;++i){labels.push(parse(me,dataLabels[i]));}
for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){if(chart.isDatasetVisible(i)){data=chart.data.datasets[i].data;if(helpers$1.isObject(data[0])){datasets[i]=[];for(j=0,jlen=data.length;j<jlen;++j){timestamp=parse(me,data[j]);timestamps.push(timestamp);datasets[i][j]=timestamp;}}else{for(j=0,jlen=labels.length;j<jlen;++j){timestamps.push(labels[j]);}
datasets[i]=labels.slice(0);}}else{datasets[i]=[];}}
if(labels.length){labels=arrayUnique(labels).sort(sorter);min=Math.min(min,labels[0]);max=Math.max(max,labels[labels.length-1]);}
if(timestamps.length){timestamps=arrayUnique(timestamps).sort(sorter);min=Math.min(min,timestamps[0]);max=Math.max(max,timestamps[timestamps.length-1]);}
min=parse(me,timeOpts.min)||min;max=parse(me,timeOpts.max)||max;min=min===MAX_INTEGER?+adapter.startOf(Date.now(),unit):min;max=max===MIN_INTEGER?+adapter.endOf(Date.now(),unit)+1:max;me.min=Math.min(min,max);me.max=Math.max(min+1,max);me._horizontal=me.isHorizontal();me._table=[];me._timestamps={data:timestamps,datasets:datasets,labels:labels};},buildTicks:function(){var me=this;var min=me.min;var max=me.max;var options=me.options;var timeOpts=options.time;var timestamps=[];var ticks=[];var i,ilen,timestamp;switch(options.ticks.source){case'data':timestamps=me._timestamps.data;break;case'labels':timestamps=me._timestamps.labels;break;case'auto':default:timestamps=generate(me,min,max,me.getLabelCapacity(min),options);}
if(options.bounds==='ticks'&&timestamps.length){min=timestamps[0];max=timestamps[timestamps.length-1];}
min=parse(me,timeOpts.min)||min;max=parse(me,timeOpts.max)||max;for(i=0,ilen=timestamps.length;i<ilen;++i){timestamp=timestamps[i];if(timestamp>=min&&timestamp<=max){ticks.push(timestamp);}}
me.min=min;me.max=max;me._unit=timeOpts.unit||determineUnitForFormatting(me,ticks,timeOpts.minUnit,me.min,me.max);me._majorUnit=determineMajorUnit(me._unit);me._table=buildLookupTable(me._timestamps.data,min,max,options.distribution);me._offsets=computeOffsets(me._table,ticks,min,max,options);if(options.ticks.reverse){ticks.reverse();}
return ticksFromTimestamps(me,ticks,me._majorUnit);},getLabelForIndex:function(index,datasetIndex){var me=this;var adapter=me._adapter;var data=me.chart.data;var timeOpts=me.options.time;var label=data.labels&&index<data.labels.length?data.labels[index]:'';var value=data.datasets[datasetIndex].data[index];if(helpers$1.isObject(value)){label=me.getRightValue(value);}
if(timeOpts.tooltipFormat){return adapter.format(toTimestamp(me,label),timeOpts.tooltipFormat);}
if(typeof label==='string'){return label;}
return adapter.format(toTimestamp(me,label),timeOpts.displayFormats.datetime);},tickFormatFunction:function(time,index,ticks,format){var me=this;var adapter=me._adapter;var options=me.options;var formats=options.time.displayFormats;var minorFormat=formats[me._unit];var majorUnit=me._majorUnit;var majorFormat=formats[majorUnit];var majorTime=+adapter.startOf(time,majorUnit);var majorTickOpts=options.ticks.major;var major=majorTickOpts.enabled&&majorUnit&&majorFormat&&time===majorTime;var label=adapter.format(time,format?format:major?majorFormat:minorFormat);var tickOpts=major?majorTickOpts:options.ticks.minor;var formatter=valueOrDefault$c(tickOpts.callback,tickOpts.userCallback);return formatter?formatter(label,index,ticks):label;},convertTicksToLabels:function(ticks){var labels=[];var i,ilen;for(i=0,ilen=ticks.length;i<ilen;++i){labels.push(this.tickFormatFunction(ticks[i].value,i,ticks));}
return labels;},getPixelForOffset:function(time){var me=this;var isReverse=me.options.ticks.reverse;var size=me._horizontal?me.width:me.height;var start=me._horizontal?isReverse?me.right:me.left:isReverse?me.bottom:me.top;var pos=interpolate$1(me._table,'time',time,'pos');var offset=size*(me._offsets.start+pos)/(me._offsets.start+1+me._offsets.end);return isReverse?start-offset:start+offset;},getPixelForValue:function(value,index,datasetIndex){var me=this;var time=null;if(index!==undefined&&datasetIndex!==undefined){time=me._timestamps.datasets[datasetIndex][index];}
if(time===null){time=parse(me,value);}
if(time!==null){return me.getPixelForOffset(time);}},getPixelForTick:function(index){var ticks=this.getTicks();return index>=0&&index<ticks.length?this.getPixelForOffset(ticks[index].value):null;},getValueForPixel:function(pixel){var me=this;var size=me._horizontal?me.width:me.height;var start=me._horizontal?me.left:me.top;var pos=(size?(pixel-start)/size:0)*(me._offsets.start+1+me._offsets.start)-me._offsets.end;var time=interpolate$1(me._table,'pos',pos,'time');return me._adapter._create(time);},getLabelWidth:function(label){var me=this;var ticksOpts=me.options.ticks;var tickLabelWidth=me.ctx.measureText(label).width;var angle=helpers$1.toRadians(ticksOpts.maxRotation);var cosRotation=Math.cos(angle);var sinRotation=Math.sin(angle);var tickFontSize=valueOrDefault$c(ticksOpts.fontSize,core_defaults.global.defaultFontSize);return(tickLabelWidth*cosRotation)+(tickFontSize*sinRotation);},getLabelCapacity:function(exampleTime){var me=this;var format=me.options.time.displayFormats.millisecond;var exampleLabel=me.tickFormatFunction(exampleTime,0,[],format);var tickLabelWidth=me.getLabelWidth(exampleLabel);var innerWidth=me.isHorizontal()?me.width:me.height;var capacity=Math.floor(innerWidth/tickLabelWidth);return capacity>0?capacity:1;}});var _defaults$4=defaultConfig$4;scale_time._defaults=_defaults$4;var scales={category:scale_category,linear:scale_linear,logarithmic:scale_logarithmic,radialLinear:scale_radialLinear,time:scale_time};var FORMATS={datetime:'MMM D, YYYY, h:mm:ss a',millisecond:'h:mm:ss.SSS a',second:'h:mm:ss a',minute:'h:mm a',hour:'hA',day:'MMM D',week:'ll',month:'MMM YYYY',quarter:'[Q]Q - YYYY',year:'YYYY'};core_adapters._date.override(typeof moment==='function'?{_id:'moment',formats:function(){return FORMATS;},parse:function(value,format){if(typeof value==='string'&&typeof format==='string'){value=moment(value,format);}else if(!(value instanceof moment)){value=moment(value);}
return value.isValid()?value.valueOf():null;},format:function(time,format){return moment(time).format(format);},add:function(time,amount,unit){return moment(time).add(amount,unit).valueOf();},diff:function(max,min,unit){return moment.duration(moment(max).diff(moment(min))).as(unit);},startOf:function(time,unit,weekday){time=moment(time);if(unit==='isoWeek'){return time.isoWeekday(weekday).valueOf();}
return time.startOf(unit).valueOf();},endOf:function(time,unit){return moment(time).endOf(unit).valueOf();},_create:function(time){return moment(time);},}:{});core_defaults._set('global',{plugins:{filler:{propagate:true}}});var mappers={dataset:function(source){var index=source.fill;var chart=source.chart;var meta=chart.getDatasetMeta(index);var visible=meta&&chart.isDatasetVisible(index);var points=(visible&&meta.dataset._children)||[];var length=points.length||0;return!length?null:function(point,i){return(i<length&&points[i]._view)||null;};},boundary:function(source){var boundary=source.boundary;var x=boundary?boundary.x:null;var y=boundary?boundary.y:null;return function(point){return{x:x===null?point.x:x,y:y===null?point.y:y,};};}};function decodeFill(el,index,count){var model=el._model||{};var fill=model.fill;var target;if(fill===undefined){fill=!!model.backgroundColor;}
if(fill===false||fill===null){return false;}
if(fill===true){return'origin';}
target=parseFloat(fill,10);if(isFinite(target)&&Math.floor(target)===target){if(fill[0]==='-'||fill[0]==='+'){target=index+target;}
if(target===index||target<0||target>=count){return false;}
return target;}
switch(fill){case'bottom':return'start';case'top':return'end';case'zero':return'origin';case'origin':case'start':case'end':return fill;default:return false;}}
function computeBoundary(source){var model=source.el._model||{};var scale=source.el._scale||{};var fill=source.fill;var target=null;var horizontal;if(isFinite(fill)){return null;}
if(fill==='start'){target=model.scaleBottom===undefined?scale.bottom:model.scaleBottom;}else if(fill==='end'){target=model.scaleTop===undefined?scale.top:model.scaleTop;}else if(model.scaleZero!==undefined){target=model.scaleZero;}else if(scale.getBasePosition){target=scale.getBasePosition();}else if(scale.getBasePixel){target=scale.getBasePixel();}
if(target!==undefined&&target!==null){if(target.x!==undefined&&target.y!==undefined){return target;}
if(helpers$1.isFinite(target)){horizontal=scale.isHorizontal();return{x:horizontal?target:null,y:horizontal?null:target};}}
return null;}
function resolveTarget(sources,index,propagate){var source=sources[index];var fill=source.fill;var visited=[index];var target;if(!propagate){return fill;}
while(fill!==false&&visited.indexOf(fill)===-1){if(!isFinite(fill)){return fill;}
target=sources[fill];if(!target){return false;}
if(target.visible){return fill;}
visited.push(fill);fill=target.fill;}
return false;}
function createMapper(source){var fill=source.fill;var type='dataset';if(fill===false){return null;}
if(!isFinite(fill)){type='boundary';}
return mappers[type](source);}
function isDrawable(point){return point&&!point.skip;}
function drawArea(ctx,curve0,curve1,len0,len1){var i;if(!len0||!len1){return;}
ctx.moveTo(curve0[0].x,curve0[0].y);for(i=1;i<len0;++i){helpers$1.canvas.lineTo(ctx,curve0[i-1],curve0[i]);}
ctx.lineTo(curve1[len1-1].x,curve1[len1-1].y);for(i=len1-1;i>0;--i){helpers$1.canvas.lineTo(ctx,curve1[i],curve1[i-1],true);}}
function doFill(ctx,points,mapper,view,color,loop){var count=points.length;var span=view.spanGaps;var curve0=[];var curve1=[];var len0=0;var len1=0;var i,ilen,index,p0,p1,d0,d1;ctx.beginPath();for(i=0,ilen=(count+!!loop);i<ilen;++i){index=i%count;p0=points[index]._view;p1=mapper(p0,index,view);d0=isDrawable(p0);d1=isDrawable(p1);if(d0&&d1){len0=curve0.push(p0);len1=curve1.push(p1);}else if(len0&&len1){if(!span){drawArea(ctx,curve0,curve1,len0,len1);len0=len1=0;curve0=[];curve1=[];}else{if(d0){curve0.push(p0);}
if(d1){curve1.push(p1);}}}}
drawArea(ctx,curve0,curve1,len0,len1);ctx.closePath();ctx.fillStyle=color;ctx.fill();}
var plugin_filler={id:'filler',afterDatasetsUpdate:function(chart,options){var count=(chart.data.datasets||[]).length;var propagate=options.propagate;var sources=[];var meta,i,el,source;for(i=0;i<count;++i){meta=chart.getDatasetMeta(i);el=meta.dataset;source=null;if(el&&el._model&&el instanceof elements.Line){source={visible:chart.isDatasetVisible(i),fill:decodeFill(el,i,count),chart:chart,el:el};}
meta.$filler=source;sources.push(source);}
for(i=0;i<count;++i){source=sources[i];if(!source){continue;}
source.fill=resolveTarget(sources,i,propagate);source.boundary=computeBoundary(source);source.mapper=createMapper(source);}},beforeDatasetDraw:function(chart,args){var meta=args.meta.$filler;if(!meta){return;}
var ctx=chart.ctx;var el=meta.el;var view=el._view;var points=el._children||[];var mapper=meta.mapper;var color=view.backgroundColor||core_defaults.global.defaultColor;if(mapper&&color&&points.length){helpers$1.canvas.clipArea(ctx,chart.chartArea);doFill(ctx,points,mapper,view,color,el._loop);helpers$1.canvas.unclipArea(ctx);}}};var noop$1=helpers$1.noop;var valueOrDefault$d=helpers$1.valueOrDefault;core_defaults._set('global',{legend:{display:true,position:'top',fullWidth:true,reverse:false,weight:1000,onClick:function(e,legendItem){var index=legendItem.datasetIndex;var ci=this.chart;var meta=ci.getDatasetMeta(index);meta.hidden=meta.hidden===null?!ci.data.datasets[index].hidden:null;ci.update();},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(chart){var data=chart.data;return helpers$1.isArray(data.datasets)?data.datasets.map(function(dataset,i){return{text:dataset.label,fillStyle:(!helpers$1.isArray(dataset.backgroundColor)?dataset.backgroundColor:dataset.backgroundColor[0]),hidden:!chart.isDatasetVisible(i),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset.borderColor,pointStyle:dataset.pointStyle,datasetIndex:i};},this):[];}}},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');for(var i=0;i<chart.data.datasets.length;i++){text.push('<li><span style="background-color:'+chart.data.datasets[i].backgroundColor+'"></span>');if(chart.data.datasets[i].label){text.push(chart.data.datasets[i].label);}
text.push('</li>');}
text.push('</ul>');return text.join('');}});function getBoxWidth(labelOpts,fontSize){return labelOpts.usePointStyle&&labelOpts.boxWidth>fontSize?fontSize:labelOpts.boxWidth;}
var Legend=core_element.extend({initialize:function(config){helpers$1.extend(this,config);this.legendHitBoxes=[];this._hoveredItem=null;this.doughnutMode=false;},beforeUpdate:noop$1,update:function(maxWidth,maxHeight,margins){var me=this;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=margins;me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeBuildLabels();me.buildLabels();me.afterBuildLabels();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize;},afterUpdate:noop$1,beforeSetDimensions:noop$1,setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width;}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height;}
me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;me.minSize={width:0,height:0};},afterSetDimensions:noop$1,beforeBuildLabels:noop$1,buildLabels:function(){var me=this;var labelOpts=me.options.labels||{};var legendItems=helpers$1.callback(labelOpts.generateLabels,[me.chart],me)||[];if(labelOpts.filter){legendItems=legendItems.filter(function(item){return labelOpts.filter(item,me.chart.data);});}
if(me.options.reverse){legendItems.reverse();}
me.legendItems=legendItems;},afterBuildLabels:noop$1,beforeFit:noop$1,fit:function(){var me=this;var opts=me.options;var labelOpts=opts.labels;var display=opts.display;var ctx=me.ctx;var labelFont=helpers$1.options._parseFont(labelOpts);var fontSize=labelFont.size;var hitboxes=me.legendHitBoxes=[];var minSize=me.minSize;var isHorizontal=me.isHorizontal();if(isHorizontal){minSize.width=me.maxWidth;minSize.height=display?10:0;}else{minSize.width=display?10:0;minSize.height=me.maxHeight;}
if(display){ctx.font=labelFont.string;if(isHorizontal){var lineWidths=me.lineWidths=[0];var totalHeight=0;ctx.textAlign='left';ctx.textBaseline='top';helpers$1.each(me.legendItems,function(legendItem,i){var boxWidth=getBoxWidth(labelOpts,fontSize);var width=boxWidth+(fontSize/2)+ctx.measureText(legendItem.text).width;if(i===0||lineWidths[lineWidths.length-1]+width+labelOpts.padding>minSize.width){totalHeight+=fontSize+labelOpts.padding;lineWidths[lineWidths.length-(i>0?0:1)]=labelOpts.padding;}
hitboxes[i]={left:0,top:0,width:width,height:fontSize};lineWidths[lineWidths.length-1]+=width+labelOpts.padding;});minSize.height+=totalHeight;}else{var vPadding=labelOpts.padding;var columnWidths=me.columnWidths=[];var totalWidth=labelOpts.padding;var currentColWidth=0;var currentColHeight=0;var itemHeight=fontSize+vPadding;helpers$1.each(me.legendItems,function(legendItem,i){var boxWidth=getBoxWidth(labelOpts,fontSize);var itemWidth=boxWidth+(fontSize/2)+ctx.measureText(legendItem.text).width;if(i>0&&currentColHeight+itemHeight>minSize.height-vPadding){totalWidth+=currentColWidth+labelOpts.padding;columnWidths.push(currentColWidth);currentColWidth=0;currentColHeight=0;}
currentColWidth=Math.max(currentColWidth,itemWidth);currentColHeight+=itemHeight;hitboxes[i]={left:0,top:0,width:itemWidth,height:fontSize};});totalWidth+=currentColWidth;columnWidths.push(currentColWidth);minSize.width+=totalWidth;}}
me.width=minSize.width;me.height=minSize.height;},afterFit:noop$1,isHorizontal:function(){return this.options.position==='top'||this.options.position==='bottom';},draw:function(){var me=this;var opts=me.options;var labelOpts=opts.labels;var globalDefaults=core_defaults.global;var defaultColor=globalDefaults.defaultColor;var lineDefault=globalDefaults.elements.line;var legendWidth=me.width;var lineWidths=me.lineWidths;if(opts.display){var ctx=me.ctx;var fontColor=valueOrDefault$d(labelOpts.fontColor,globalDefaults.defaultFontColor);var labelFont=helpers$1.options._parseFont(labelOpts);var fontSize=labelFont.size;var cursor;ctx.textAlign='left';ctx.textBaseline='middle';ctx.lineWidth=0.5;ctx.strokeStyle=fontColor;ctx.fillStyle=fontColor;ctx.font=labelFont.string;var boxWidth=getBoxWidth(labelOpts,fontSize);var hitboxes=me.legendHitBoxes;var drawLegendBox=function(x,y,legendItem){if(isNaN(boxWidth)||boxWidth<=0){return;}
ctx.save();var lineWidth=valueOrDefault$d(legendItem.lineWidth,lineDefault.borderWidth);ctx.fillStyle=valueOrDefault$d(legendItem.fillStyle,defaultColor);ctx.lineCap=valueOrDefault$d(legendItem.lineCap,lineDefault.borderCapStyle);ctx.lineDashOffset=valueOrDefault$d(legendItem.lineDashOffset,lineDefault.borderDashOffset);ctx.lineJoin=valueOrDefault$d(legendItem.lineJoin,lineDefault.borderJoinStyle);ctx.lineWidth=lineWidth;ctx.strokeStyle=valueOrDefault$d(legendItem.strokeStyle,defaultColor);if(ctx.setLineDash){ctx.setLineDash(valueOrDefault$d(legendItem.lineDash,lineDefault.borderDash));}
if(opts.labels&&opts.labels.usePointStyle){var radius=boxWidth*Math.SQRT2/2;var centerX=x+boxWidth/2;var centerY=y+fontSize/2;helpers$1.canvas.drawPoint(ctx,legendItem.pointStyle,radius,centerX,centerY);}else{if(lineWidth!==0){ctx.strokeRect(x,y,boxWidth,fontSize);}
ctx.fillRect(x,y,boxWidth,fontSize);}
ctx.restore();};var fillText=function(x,y,legendItem,textWidth){var halfFontSize=fontSize/2;var xLeft=boxWidth+halfFontSize+x;var yMiddle=y+halfFontSize;ctx.fillText(legendItem.text,xLeft,yMiddle);if(legendItem.hidden){ctx.beginPath();ctx.lineWidth=2;ctx.moveTo(xLeft,yMiddle);ctx.lineTo(xLeft+textWidth,yMiddle);ctx.stroke();}};var isHorizontal=me.isHorizontal();if(isHorizontal){cursor={x:me.left+((legendWidth-lineWidths[0])/2)+labelOpts.padding,y:me.top+labelOpts.padding,line:0};}else{cursor={x:me.left+labelOpts.padding,y:me.top+labelOpts.padding,line:0};}
var itemHeight=fontSize+labelOpts.padding;helpers$1.each(me.legendItems,function(legendItem,i){var textWidth=ctx.measureText(legendItem.text).width;var width=boxWidth+(fontSize/2)+textWidth;var x=cursor.x;var y=cursor.y;if(isHorizontal){if(i>0&&x+width+labelOpts.padding>me.left+me.minSize.width){y=cursor.y+=itemHeight;cursor.line++;x=cursor.x=me.left+((legendWidth-lineWidths[cursor.line])/2)+labelOpts.padding;}}else if(i>0&&y+itemHeight>me.top+me.minSize.height){x=cursor.x=x+me.columnWidths[cursor.line]+labelOpts.padding;y=cursor.y=me.top+labelOpts.padding;cursor.line++;}
drawLegendBox(x,y,legendItem);hitboxes[i].left=x;hitboxes[i].top=y;fillText(x,y,legendItem,textWidth);if(isHorizontal){cursor.x+=width+labelOpts.padding;}else{cursor.y+=itemHeight;}});}},_getLegendItemAt:function(x,y){var me=this;var i,hitBox,lh;if(x>=me.left&&x<=me.right&&y>=me.top&&y<=me.bottom){lh=me.legendHitBoxes;for(i=0;i<lh.length;++i){hitBox=lh[i];if(x>=hitBox.left&&x<=hitBox.left+hitBox.width&&y>=hitBox.top&&y<=hitBox.top+hitBox.height){return me.legendItems[i];}}}
return null;},handleEvent:function(e){var me=this;var opts=me.options;var type=e.type==='mouseup'?'click':e.type;var hoveredItem;if(type==='mousemove'){if(!opts.onHover&&!opts.onLeave){return;}}else if(type==='click'){if(!opts.onClick){return;}}else{return;}
hoveredItem=me._getLegendItemAt(e.x,e.y);if(type==='click'){if(hoveredItem&&opts.onClick){opts.onClick.call(me,e.native,hoveredItem);}}else{if(opts.onLeave&&hoveredItem!==me._hoveredItem){if(me._hoveredItem){opts.onLeave.call(me,e.native,me._hoveredItem);}
me._hoveredItem=hoveredItem;}
if(opts.onHover&&hoveredItem){opts.onHover.call(me,e.native,hoveredItem);}}}});function createNewLegendAndAttach(chart,legendOpts){var legend=new Legend({ctx:chart.ctx,options:legendOpts,chart:chart});core_layouts.configure(chart,legend,legendOpts);core_layouts.addBox(chart,legend);chart.legend=legend;}
var plugin_legend={id:'legend',_element:Legend,beforeInit:function(chart){var legendOpts=chart.options.legend;if(legendOpts){createNewLegendAndAttach(chart,legendOpts);}},beforeUpdate:function(chart){var legendOpts=chart.options.legend;var legend=chart.legend;if(legendOpts){helpers$1.mergeIf(legendOpts,core_defaults.global.legend);if(legend){core_layouts.configure(chart,legend,legendOpts);legend.options=legendOpts;}else{createNewLegendAndAttach(chart,legendOpts);}}else if(legend){core_layouts.removeBox(chart,legend);delete chart.legend;}},afterEvent:function(chart,e){var legend=chart.legend;if(legend){legend.handleEvent(e);}}};var noop$2=helpers$1.noop;core_defaults._set('global',{title:{display:false,fontStyle:'bold',fullWidth:true,padding:10,position:'top',text:'',weight:2000}});var Title=core_element.extend({initialize:function(config){var me=this;helpers$1.extend(me,config);me.legendHitBoxes=[];},beforeUpdate:noop$2,update:function(maxWidth,maxHeight,margins){var me=this;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=margins;me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeBuildLabels();me.buildLabels();me.afterBuildLabels();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize;},afterUpdate:noop$2,beforeSetDimensions:noop$2,setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width;}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height;}
me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;me.minSize={width:0,height:0};},afterSetDimensions:noop$2,beforeBuildLabels:noop$2,buildLabels:noop$2,afterBuildLabels:noop$2,beforeFit:noop$2,fit:function(){var me=this;var opts=me.options;var display=opts.display;var minSize=me.minSize;var lineCount=helpers$1.isArray(opts.text)?opts.text.length:1;var fontOpts=helpers$1.options._parseFont(opts);var textSize=display?(lineCount*fontOpts.lineHeight)+(opts.padding*2):0;if(me.isHorizontal()){minSize.width=me.maxWidth;minSize.height=textSize;}else{minSize.width=textSize;minSize.height=me.maxHeight;}
me.width=minSize.width;me.height=minSize.height;},afterFit:noop$2,isHorizontal:function(){var pos=this.options.position;return pos==='top'||pos==='bottom';},draw:function(){var me=this;var ctx=me.ctx;var opts=me.options;if(opts.display){var fontOpts=helpers$1.options._parseFont(opts);var lineHeight=fontOpts.lineHeight;var offset=lineHeight/2+opts.padding;var rotation=0;var top=me.top;var left=me.left;var bottom=me.bottom;var right=me.right;var maxWidth,titleX,titleY;ctx.fillStyle=helpers$1.valueOrDefault(opts.fontColor,core_defaults.global.defaultFontColor);ctx.font=fontOpts.string;if(me.isHorizontal()){titleX=left+((right-left)/2);titleY=top+offset;maxWidth=right-left;}else{titleX=opts.position==='left'?left+offset:right-offset;titleY=top+((bottom-top)/2);maxWidth=bottom-top;rotation=Math.PI*(opts.position==='left'?-0.5:0.5);}
ctx.save();ctx.translate(titleX,titleY);ctx.rotate(rotation);ctx.textAlign='center';ctx.textBaseline='middle';var text=opts.text;if(helpers$1.isArray(text)){var y=0;for(var i=0;i<text.length;++i){ctx.fillText(text[i],0,y,maxWidth);y+=lineHeight;}}else{ctx.fillText(text,0,0,maxWidth);}
ctx.restore();}}});function createNewTitleBlockAndAttach(chart,titleOpts){var title=new Title({ctx:chart.ctx,options:titleOpts,chart:chart});core_layouts.configure(chart,title,titleOpts);core_layouts.addBox(chart,title);chart.titleBlock=title;}
var plugin_title={id:'title',_element:Title,beforeInit:function(chart){var titleOpts=chart.options.title;if(titleOpts){createNewTitleBlockAndAttach(chart,titleOpts);}},beforeUpdate:function(chart){var titleOpts=chart.options.title;var titleBlock=chart.titleBlock;if(titleOpts){helpers$1.mergeIf(titleOpts,core_defaults.global.title);if(titleBlock){core_layouts.configure(chart,titleBlock,titleOpts);titleBlock.options=titleOpts;}else{createNewTitleBlockAndAttach(chart,titleOpts);}}else if(titleBlock){core_layouts.removeBox(chart,titleBlock);delete chart.titleBlock;}}};var plugins={};var filler=plugin_filler;var legend=plugin_legend;var title=plugin_title;plugins.filler=filler;plugins.legend=legend;plugins.title=title;core_controller.helpers=helpers$1;core_helpers(core_controller);core_controller._adapters=core_adapters;core_controller.Animation=core_animation;core_controller.animationService=core_animations;core_controller.controllers=controllers;core_controller.DatasetController=core_datasetController;core_controller.defaults=core_defaults;core_controller.Element=core_element;core_controller.elements=elements;core_controller.Interaction=core_interaction;core_controller.layouts=core_layouts;core_controller.platform=platform;core_controller.plugins=core_plugins;core_controller.Scale=core_scale;core_controller.scaleService=core_scaleService;core_controller.Ticks=core_ticks;core_controller.Tooltip=core_tooltip;core_controller.helpers.each(scales,function(scale,type){core_controller.scaleService.registerScaleType(type,scale,scale._defaults);});for(var k in plugins){if(plugins.hasOwnProperty(k)){core_controller.plugins.register(plugins[k]);}}
core_controller.platform.initialize();var src=core_controller;if(typeof window!=='undefined'){window.Chart=core_controller;}
core_controller.Chart=core_controller;core_controller.Legend=plugins.legend._element;core_controller.Title=plugins.title._element;core_controller.pluginService=core_controller.plugins;core_controller.PluginBase=core_controller.Element.extend({});core_controller.canvasHelpers=core_controller.helpers.canvas;core_controller.layoutService=core_controller.layouts;core_controller.LinearScaleBase=scale_linearbase;core_controller.helpers.each(['Bar','Bubble','Doughnut','Line','PolarArea','Radar','Scatter'],function(klass){core_controller[klass]=function(ctx,cfg){return new core_controller(ctx,core_controller.helpers.merge(cfg||{},{type:klass.charAt(0).toLowerCase()+klass.slice(1)}));};});return src;})));;

/* /base_accounting_kit/static/lib/bootstrap-toggle-master/js/bootstrap-toggle.min.js defined in bundle 'web.assets_backend' */
+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.toggle"),f="object"==typeof b&&b;e||d.data("bs.toggle",e=new c(this,f)),"string"==typeof b&&e[b]&&e[b]()})}var c=function(b,c){this.$element=a(b),this.options=a.extend({},this.defaults(),c),this.render()};c.VERSION="2.2.0",c.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:"",width:null,height:null},c.prototype.defaults=function(){return{on:this.$element.attr("data-on")||c.DEFAULTS.on,off:this.$element.attr("data-off")||c.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||c.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||c.DEFAULTS.offstyle,size:this.$element.attr("data-size")||c.DEFAULTS.size,style:this.$element.attr("data-style")||c.DEFAULTS.style,width:this.$element.attr("data-width")||c.DEFAULTS.width,height:this.$element.attr("data-height")||c.DEFAULTS.height}},c.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var b="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",c=a('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+b),d=a('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+b+" active"),e=a('<span class="toggle-handle btn btn-default">').addClass(b),f=a('<div class="toggle-group">').append(c,d,e),g=a('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(b).addClass(this.options.style);this.$element.wrap(g),a.extend(this,{$toggle:this.$element.parent(),$toggleOn:c,$toggleOff:d,$toggleGroup:f}),this.$toggle.append(f);var h=this.options.width||Math.max(c.outerWidth(),d.outerWidth())+e.outerWidth()/2,i=this.options.height||Math.max(c.outerHeight(),d.outerHeight());c.addClass("toggle-on"),d.addClass("toggle-off"),this.$toggle.css({width:h,height:i}),this.options.height&&(c.css("line-height",c.height()+"px"),d.css("line-height",d.height()+"px")),this.update(!0),this.trigger(!0)},c.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},c.prototype.on=function(a){return this.$element.prop("disabled")?!1:(this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),void(a||this.trigger()))},c.prototype.off=function(a){return this.$element.prop("disabled")?!1:(this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),void(a||this.trigger()))},c.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},c.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},c.prototype.update=function(a){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(a):this.off(a)},c.prototype.trigger=function(b){this.$element.off("change.bs.toggle"),b||this.$element.change(),this.$element.on("change.bs.toggle",a.proxy(function(){this.update()},this))},c.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var d=a.fn.bootstrapToggle;a.fn.bootstrapToggle=b,a.fn.bootstrapToggle.Constructor=c,a.fn.toggle.noConflict=function(){return a.fn.bootstrapToggle=d,this},a(function(){a("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()}),a(document).on("click.bs.toggle","div[data-toggle^=toggle]",function(b){var c=a(this).find("input[type=checkbox]");c.bootstrapToggle("toggle"),b.preventDefault()})}(jQuery);;

/* /base_accounting_kit/static/src/js/account_asset.js defined in bundle 'web.assets_backend' */
odoo.define('base_accounting_kit.account_asset',function(require){"use strict";var AbstractField=require('web.AbstractField');var core=require('web.core');var registry=require('web.field_registry');var _t=core._t;var AccountAssetWidget=AbstractField.extend({events:_.extend({},AbstractField.prototype.events,{'click':'_onClick',}),description:"",isSet:function(){return true;},_render:function(){var className='';var disabled=true;var title;if(this.recordData.move_posted_check){className='o_is_posted';title=_t('Posted');}else if(this.recordData.move_check){className='o_unposted';title=_t('Accounting entries waiting for manual verification');}else{disabled=false;title=_t('Unposted');}
var $button=$('<button/>',{type:'button',title:title,disabled:disabled,}).addClass('btn btn-sm btn-link fa fa-circle o_deprec_lines_toggler '+className);this.$el.html($button);},_onClick:function(event){event.stopPropagation();this.trigger_up('button_clicked',{attrs:{name:'create_move',type:'object',},record:this.record,});},});registry.add("deprec_lines_toggler",AccountAssetWidget);});;

/* /hr/static/src/bugfix/bugfix.js defined in bundle 'web.assets_backend' */
odoo.define('hr/static/src/bugfix/bugfix.js',function(require){'use strict';});;

/* /hr/static/src/js/chat.js defined in bundle 'web.assets_backend' */
odoo.define('hr.employee_chat',function(require){'use strict';var viewRegistry=require('web.view_registry');var FormController=require('web.FormController');var FormView=require('web.FormView');var FormRenderer=require('web.FormRenderer');var KanbanController=require('web.KanbanController');var KanbanView=require('web.KanbanView');var KanbanRenderer=require('web.KanbanRenderer');var KanbanRecord=require('web.KanbanRecord');const{Component}=owl;var ChatMixin={_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){var $chat_button=self.$el.find('.o_employee_chat_btn');$chat_button.off('click').on('click',self._onOpenChat.bind(self));});},destroy:function(){if(this.$el){this.$el.find('.o_employee_chat_btn').off('click');}
return this._super();},_onOpenChat:function(ev){ev.preventDefault();ev.stopImmediatePropagation();const env=Component.env;env.messaging.openChat({employeeId:this.state.data.id});return true;},};var EmployeeFormRenderer=FormRenderer.extend(ChatMixin);var EmployeeFormView=FormView.extend({config:_.extend({},FormView.prototype.config,{Controller:FormController,Renderer:EmployeeFormRenderer}),});viewRegistry.add('hr_employee_form',EmployeeFormView);var EmployeeKanbanRecord=KanbanRecord.extend(ChatMixin);var EmployeeKanbanRenderer=KanbanRenderer.extend({config:Object.assign({},KanbanRenderer.prototype.config,{KanbanRecord:EmployeeKanbanRecord,}),});var EmployeeKanbanView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Controller:KanbanController,Renderer:EmployeeKanbanRenderer}),});viewRegistry.add('hr_employee_kanban',EmployeeKanbanView);});;

/* /hr/static/src/js/language.js defined in bundle 'web.assets_backend' */
odoo.define('hr.employee_language',function(require){'use strict';var FormController=require('web.FormController');var FormView=require('web.FormView');var viewRegistry=require('web.view_registry');var EmployeeFormController=FormController.extend({saveRecord:function(){var self=this;return this._super.apply(this,arguments).then(function(){if(arguments[0].indexOf('lang')>=0){self.do_action('reload_context');}});},});var EmployeeProfileFormView=FormView.extend({config:_.extend({},FormView.prototype.config,{Controller:EmployeeFormController,}),});viewRegistry.add('hr_employee_profile_form',EmployeeProfileFormView);return EmployeeProfileFormView;});;

/* /hr/static/src/js/many2one_avatar_employee.js defined in bundle 'web.assets_backend' */
odoo.define('hr.Many2OneAvatarEmployee',function(require){"use strict";const fieldRegistry=require('web.field_registry');const{Many2OneAvatarUser,KanbanMany2OneAvatarUser}=require('mail.Many2OneAvatarUser');const{Component}=owl;const Many2OneAvatarEmployeeMixin={supportedModels:['hr.employee','hr.employee.public'],async _onAvatarClicked(ev){ev.stopPropagation();const env=Component.env;await env.messaging.openChat({employeeId:this.value.res_id});}};const Many2OneAvatarEmployee=Many2OneAvatarUser.extend(Many2OneAvatarEmployeeMixin);const KanbanMany2OneAvatarEmployee=KanbanMany2OneAvatarUser.extend(Many2OneAvatarEmployeeMixin);fieldRegistry.add('many2one_avatar_employee',Many2OneAvatarEmployee);fieldRegistry.add('kanban.many2one_avatar_employee',KanbanMany2OneAvatarEmployee);return{Many2OneAvatarEmployee,KanbanMany2OneAvatarEmployee,};});;

/* /hr/static/src/js/standalone_m2o_avatar_employee.js defined in bundle 'web.assets_backend' */
odoo.define('hr.StandaloneM2OAvatarEmployee',function(require){'use strict';const StandaloneFieldManagerMixin=require('web.StandaloneFieldManagerMixin');const Widget=require('web.Widget');const{Many2OneAvatarEmployee}=require('hr.Many2OneAvatarEmployee');const StandaloneM2OAvatarEmployee=Widget.extend(StandaloneFieldManagerMixin,{className:'o_standalone_avatar_employee',init(parent,value){this._super(...arguments);StandaloneFieldManagerMixin.init.call(this);this.value=value;},willStart(){return Promise.all([this._super(...arguments),this._makeAvatarWidget()]);},start(){this.avatarWidget.$el.appendTo(this.$el);return this._super(...arguments);},async _makeAvatarWidget(){const modelName='hr.employee';const fieldName='employee_id';const recordId=await this.model.makeRecord(modelName,[{name:fieldName,relation:modelName,type:'many2one',value:this.value,}]);const state=this.model.get(recordId);this.avatarWidget=new Many2OneAvatarEmployee(this,fieldName,state);this._registerWidget(recordId,fieldName,this.avatarWidget);return this.avatarWidget.appendTo(document.createDocumentFragment());},});return StandaloneM2OAvatarEmployee;});;

/* /hr/static/src/models/employee/employee.js defined in bundle 'web.assets_backend' */
odoo.define('hr/static/src/models/employee/employee.js',function(require){'use strict';const{registerNewModel}=require('mail/static/src/model/model_core.js');const{attr,one2one}=require('mail/static/src/model/model_field.js');function factory(dependencies){class Employee extends dependencies['mail.model']{static convertData(data){const data2={};if('id'in data){data2.id=data.id;}
if('user_id'in data){data2.hasCheckedUser=true;if(!data.user_id){data2.user=[['unlink']];}else{const partnerNameGet=data['user_partner_id'];const partnerData={display_name:partnerNameGet[1],id:partnerNameGet[0],};const userNameGet=data['user_id'];const userData={id:userNameGet[0],partner:[['insert',partnerData]],display_name:userNameGet[1],};data2.user=[['insert',userData]];}}
return data2;}
static async performRpcRead({context,fields,ids}){const employeesData=await this.env.services.rpc({model:'hr.employee.public',method:'read',args:[ids],kwargs:{context,fields,},});this.env.models['hr.employee'].insert(employeesData.map(employeeData=>this.env.models['hr.employee'].convertData(employeeData)));}
static async performRpcSearchRead({context,domain,fields}){const employeesData=await this.env.services.rpc({model:'hr.employee.public',method:'search_read',kwargs:{context,domain,fields,},});this.env.models['hr.employee'].insert(employeesData.map(employeeData=>this.env.models['hr.employee'].convertData(employeeData)));}
async checkIsUser(){return this.env.models['hr.employee'].performRpcRead({ids:[this.id],fields:['user_id','user_partner_id'],context:{active_test:false},});}
async getChat(){if(!this.user&&!this.hasCheckedUser){await this.async(()=>this.checkIsUser());}
if(!this.user){this.env.services['notification'].notify({message:this.env._t("You can only chat with employees that have a dedicated user."),type:'info',});return;}
return this.user.getChat();}
async openChat(options){const chat=await this.async(()=>this.getChat());if(!chat){return;}
await this.async(()=>chat.open(options));return chat;}
async openProfile(){return this.env.messaging.openDocument({id:this.id,model:'hr.employee.public',});}
static _createRecordLocalId(data){return`${this.modelName}_${data.id}`;}}
Employee.fields={hasCheckedUser:attr({default:false,}),id:attr(),partner:one2one('mail.partner',{inverse:'employee',related:'user.partner',}),user:one2one('mail.user',{inverse:'employee',}),};Employee.modelName='hr.employee';return Employee;}
registerNewModel('hr.employee',factory);});;

/* /hr/static/src/models/messaging/messaging.js defined in bundle 'web.assets_backend' */
odoo.define('hr/static/src/models/messaging/messaging.js',function(require){'use strict';const{registerInstancePatchModel,}=require('mail/static/src/model/model_core.js');registerInstancePatchModel('mail.messaging','hr/static/src/models/messaging/messaging.js',{async getChat({employeeId}){if(employeeId){const employee=this.env.models['hr.employee'].insert({id:employeeId});return employee.getChat();}
return this._super(...arguments);},async openProfile({id,model}){if(model==='hr.employee'||model==='hr.employee.public'){const employee=this.env.models['hr.employee'].insert({id});return employee.openProfile();}
return this._super(...arguments);},});});;

/* /hr/static/src/models/partner/partner.js defined in bundle 'web.assets_backend' */
odoo.define('hr/static/src/models/partner/partner.js',function(require){'use strict';const{registerInstancePatchModel,registerFieldPatchModel,}=require('mail/static/src/model/model_core.js');const{attr,one2one}=require('mail/static/src/model/model_field.js');registerInstancePatchModel('mail.partner','hr/static/src/models/partner/partner.js',{async checkIsEmployee(){await this.async(()=>this.env.models['hr.employee'].performRpcSearchRead({context:{active_test:false},domain:[['user_partner_id','=',this.id]],fields:['user_id','user_partner_id'],}));this.update({hasCheckedEmployee:true});},async openProfile(){const _super=this._super.bind(this,...arguments);if(!this.employee&&!this.hasCheckedEmployee){await this.async(()=>this.checkIsEmployee());}
if(this.employee){return this.employee.openProfile();}
return _super();},});registerFieldPatchModel('mail.partner','hr/static/src/models/partner/partner.js',{employee:one2one('hr.employee',{inverse:'partner',}),hasCheckedEmployee:attr({default:false,}),});});;

/* /hr/static/src/models/user/user.js defined in bundle 'web.assets_backend' */
odoo.define('hr/static/src/models/user/user.js',function(require){'use strict';const{registerFieldPatchModel,}=require('mail/static/src/model/model_core.js');const{one2one}=require('mail/static/src/model/model_field.js');registerFieldPatchModel('mail.user','hr/static/src/models/user/user.js',{employee:one2one('hr.employee',{inverse:'user',}),});});;

/* /hr_org_chart/static/src/js/hr_org_chart.js defined in bundle 'web.assets_backend' */
odoo.define('web.OrgChart',function(require){"use strict";var AbstractField=require('web.AbstractField');var concurrency=require('web.concurrency');var core=require('web.core');var field_registry=require('web.field_registry');var session=require('web.session');var QWeb=core.qweb;var _t=core._t;var FieldOrgChart=AbstractField.extend({events:{"click .o_employee_redirect":"_onEmployeeRedirect","click .o_employee_sub_redirect":"_onEmployeeSubRedirect","click .o_employee_more_managers":"_onEmployeeMoreManager"},init:function(parent,options){this._super.apply(this,arguments);this.dm=new concurrency.DropMisordered();this.employee=null;},_getOrgData:function(){var self=this;return this.dm.add(this._rpc({route:'/hr/get_org_chart',params:{employee_id:this.employee,context:session.user_context,},})).then(function(data){return data;});},_getSubordinatesData:function(employee_id,type){return this.dm.add(this._rpc({route:'/hr/get_subordinates',params:{employee_id:employee_id,subordinates_type:type,context:session.user_context,},}));},_render:function(){if(!this.recordData.id){return this.$el.html(QWeb.render("hr_org_chart",{managers:[],children:[],}));}
else if(!this.employee){this.employee=this.recordData.employee_ids!==undefined?this.recordData.employee_ids.res_ids[0]:this.recordData.id;}
var self=this;return this._getOrgData().then(function(orgData){if(_.isEmpty(orgData)){orgData={managers:[],children:[],}}
orgData.view_employee_id=self.recordData.id;self.$el.html(QWeb.render("hr_org_chart",orgData));self.$('[data-toggle="popover"]').each(function(){$(this).popover({html:true,title:function(){var $title=$(QWeb.render('hr_orgchart_emp_popover_title',{employee:{name:$(this).data('emp-name'),id:$(this).data('emp-id'),},}));$title.on('click','.o_employee_redirect',_.bind(self._onEmployeeRedirect,self));return $title;},container:this,placement:'left',trigger:'focus',content:function(){var $content=$(QWeb.render('hr_orgchart_emp_popover_content',{employee:{id:$(this).data('emp-id'),name:$(this).data('emp-name'),direct_sub_count:parseInt($(this).data('emp-dir-subs')),indirect_sub_count:parseInt($(this).data('emp-ind-subs')),},}));$content.on('click','.o_employee_sub_redirect',_.bind(self._onEmployeeSubRedirect,self));return $content;},template:QWeb.render('hr_orgchart_emp_popover',{}),});});});},_onEmployeeMoreManager:function(event){event.preventDefault();this.employee=parseInt($(event.currentTarget).data('employee-id'));this._render();},_onEmployeeRedirect:function(event){var self=this;event.preventDefault();var employee_id=parseInt($(event.currentTarget).data('employee-id'));return this._rpc({model:'hr.employee',method:'get_formview_action',args:[employee_id],}).then(function(action){return self.do_action(action);});},_onEmployeeSubRedirect:function(event){event.preventDefault();var employee_id=parseInt($(event.currentTarget).data('employee-id'));var employee_name=$(event.currentTarget).data('employee-name');var type=$(event.currentTarget).data('type')||'direct';var self=this;if(employee_id){this._getSubordinatesData(employee_id,type).then(function(data){var domain=[['id','in',data]];return self._rpc({model:'hr.employee',method:'get_formview_action',args:[employee_id],}).then(function(action){action=_.extend(action,{'name':_t('Team'),'view_mode':'kanban,list,form','views':[[false,'kanban'],[false,'list'],[false,'form']],'domain':domain,'context':{'default_parent_id':employee_id,}});delete action['res_id'];return self.do_action(action);});});}},});field_registry.add('hr_org_chart',FieldOrgChart);return FieldOrgChart;});;

/* /hr_recruitment/static/src/js/recruitment.js defined in bundle 'web.assets_backend' */
odoo.define('job.update_kanban',function(require){'use strict';var KanbanRecord=require('web.KanbanRecord');KanbanRecord.include({_openRecord:function(){if(this.modelName==='hr.job'&&this.$(".o_hr_job_boxes a").length){this.$(".o_hr_job_boxes a").first().click();}else{this._super.apply(this,arguments);}}});});;

/* /hr_recruitment/static/src/js/tours/hr_recruitment.js defined in bundle 'web.assets_backend' */
odoo.define('hr_recruitment.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;tour.register('hr_recruitment_tour',{url:"/web",rainbowManMessage:_t("<div>Great job! You hired a new colleague!</div><div>Try the Website app to publish job offers online.</div>"),sequence:230,},[tour.stepUtils.showAppsMenuItem(),{trigger:'.o_app[data-menu-xmlid="hr_recruitment.menu_hr_recruitment_root"]',content:_t("Let's have a look at how to <b>improve</b> your <b>hiring process</b>."),position:'right',edition:'community'},{trigger:'.o_app[data-menu-xmlid="hr_recruitment.menu_hr_recruitment_root"]',content:_t("Let's have a look at how to <b>improve</b> your <b>hiring process</b>."),position:'bottom',edition:'enterprise'},{trigger:".o-kanban-button-new",content:_t("Create your first Job Position."),position:"bottom",width:195},{trigger:".o_job_name",extra_trigger:'.o_hr_job_simple_form',content:_t("What do you want to recruit today? Choose a job title..."),position:"right"},{trigger:".o_job_alias",extra_trigger:'.o_hr_job_simple_form',content:_t("Choose an application email."),position:"right"},{trigger:'.o_create_job',content:_t('Let\'s create the position. An email will be setup for applications, and a public job description, if you use the Website app.'),position:'bottom',run:function(actions){actions.auto('.modal:visible .btn.btn-primary');},},{trigger:".oe_kanban_action_button",extra_trigger:'.o_hr_recruitment_kanban',content:_t("Let\'s have a look at the applications pipeline."),position:"bottom"},{trigger:".o_copy_paste_email",content:_t("Copy this email address, to paste it in your email composer, to apply."),position:"bottom"},{trigger:".breadcrumb-item:not(.active):last",extra_trigger:'.o_kanban_applicant',content:_t("Lets go back to the dashboard."),position:"bottom"},{trigger:".oe_kanban_action_button",extra_trigger:'.o_hr_recruitment_kanban',content:_t("<b>Did you apply by sending an email?</b> Check incoming applications."),position:"bottom"},{trigger:".oe_kanban_card",extra_trigger:'.o_kanban_applicant',content:_t("<b>Drag this card</b>, to qualify him for a first interview."),position:"bottom",run:"drag_and_drop .o_kanban_group:eq(1) ",},{trigger:".oe_kanban_card",extra_trigger:'.o_kanban_applicant',content:_t("<b>Click to view</b> the application."),position:"bottom"},{trigger:".o_Chatter .o_ChatterTopbar_buttonSendMessage",extra_trigger:'.o_applicant_form',content:_t("<div><b>Try to send an email</b> to the applicant.</div><div><i>Tips: All emails sent or received are saved in the history here</i>"),position:"bottom"},{trigger:".o_Chatter .o_Composer_buttonSend",extra_trigger:'.o_applicant_form',content:_t("Send your email. Followers will get a copy of the communication."),position:"bottom"},{trigger:".o_Chatter .o_ChatterTopbar_buttonLogNote",extra_trigger:'.o_applicant_form',content:_t("Or talk about this applicant privately with your colleagues."),position:"bottom"},{trigger:".o_create_employee",extra_trigger:'.o_applicant_form',content:_t("Lets create this new employee now."),position:"bottom"},{trigger:".o_form_button_save",extra_trigger:".o_employee_form",content:_t("Save it !"),position:"bottom",width:80}]);});;

/* /barcodes/static/src/js/barcode_parser.js defined in bundle 'web.assets_backend' */
odoo.define('barcodes.BarcodeParser',function(require){"use strict";var Class=require('web.Class');var rpc=require('web.rpc');var BarcodeParser=Class.extend({init:function(attributes){this.nomenclature_id=attributes.nomenclature_id;this.loaded=this.load();},load:function(){var self=this;if(!this.nomenclature_id){return;}
var id=this.nomenclature_id[0];return rpc.query({model:'barcode.nomenclature',method:'read',args:[[id],['name','rule_ids','upc_ean_conv']],}).then(function(nomenclatures){self.nomenclature=nomenclatures[0];var args=[[['barcode_nomenclature_id','=',self.nomenclature.id]],['name','sequence','type','encoding','pattern','alias'],];return rpc.query({model:'barcode.rule',method:'search_read',args:args,});}).then(function(rules){rules=rules.sort(function(a,b){return a.sequence-b.sequence;});self.nomenclature.rules=rules;});},is_loaded:function(){return this.loaded;},ean_checksum:function(ean){var code=ean.split('');if(code.length!==13){return-1;}
var oddsum=0,evensum=0,total=0;code=code.reverse().splice(1);for(var i=0;i<code.length;i++){if(i%2===0){oddsum+=Number(code[i]);}else{evensum+=Number(code[i]);}}
total=oddsum*3+evensum;return Number((10-total%10)%10);},ean8_checksum:function(ean){var code=ean.split('');if(code.length!==8){return-1;}
var sum1=Number(code[1])+Number(code[3])+Number(code[5]);var sum2=Number(code[0])+Number(code[2])+Number(code[4])+Number(code[6]);var total=sum1+3*sum2;return Number((10-total%10)%10);},check_ean:function(ean){return/^\d+$/.test(ean)&&this.ean_checksum(ean)===Number(ean[ean.length-1]);},check_encoding:function(barcode,encoding){var len=barcode.length;var allnum=/^\d+$/.test(barcode);var check=Number(barcode[len-1]);if(encoding==='ean13'){return len===13&&allnum&&this.ean_checksum(barcode)===check;}else if(encoding==='ean8'){return len===8&&allnum&&this.ean8_checksum(barcode)===check;}else if(encoding==='upca'){return len===12&&allnum&&this.ean_checksum('0'+barcode)===check;}else if(encoding==='any'){return true;}else{return false;}},sanitize_ean:function(ean){ean=ean.substr(0,13);for(var n=0,count=(13-ean.length);n<count;n++){ean='0'+ean;}
return ean.substr(0,12)+this.ean_checksum(ean);},sanitize_upc:function(upc){return this.sanitize_ean('0'+upc).substr(1,12);},match_pattern:function(barcode,pattern,encoding){var match={value:0,base_code:barcode,match:false,};barcode=barcode.replace("\\","\\\\").replace("{",'\{').replace("}","\}").replace(".","\.");var numerical_content=pattern.match(/[{][N]*[D]*[}]/);var base_pattern=pattern;if(numerical_content){var num_start=numerical_content.index;var num_length=numerical_content[0].length;var value_string=barcode.substr(num_start,num_length-2);var whole_part_match=numerical_content[0].match("[{][N]*[D}]");var decimal_part_match=numerical_content[0].match("[{N][D]*[}]");var whole_part=value_string.substr(0,whole_part_match.index+whole_part_match[0].length-2);var decimal_part="0."+value_string.substr(decimal_part_match.index,decimal_part_match[0].length-1);if(whole_part===''){whole_part='0';}
match['value']=parseInt(whole_part)+parseFloat(decimal_part);match['base_code']=barcode.substr(0,num_start);var base_pattern=pattern.substr(0,num_start);for(var i=0;i<(num_length-2);i++){match['base_code']+="0";base_pattern+="0";}
match['base_code']+=barcode.substr(num_start+num_length-2,barcode.length-1);base_pattern+=pattern.substr(num_start+num_length,pattern.length-1);match['base_code']=match['base_code'].replace("\\\\","\\").replace("\{","{").replace("\}","}").replace("\.",".");var base_code=match.base_code.split('')
if(encoding==='ean13'){base_code[12]=''+this.ean_checksum(match.base_code);}else if(encoding==='ean8'){base_code[7]=''+this.ean8_checksum(match.base_code);}else if(encoding==='upca'){base_code[11]=''+this.ean_checksum('0'+match.base_code);}
match.base_code=base_code.join('')}
if(base_pattern[0]!=='^'){base_pattern="^"+base_pattern;}
match.match=match.base_code.match(base_pattern);return match;},parse_barcode:function(barcode){var parsed_result={encoding:'',type:'error',code:barcode,base_code:barcode,value:0,};if(!this.nomenclature){return parsed_result;}
var rules=this.nomenclature.rules;for(var i=0;i<rules.length;i++){var rule=rules[i];var cur_barcode=barcode;if(rule.encoding==='ean13'&&this.check_encoding(barcode,'upca')&&this.nomenclature.upc_ean_conv in{'upc2ean':'','always':''}){cur_barcode='0'+cur_barcode;}else if(rule.encoding==='upca'&&this.check_encoding(barcode,'ean13')&&barcode[0]==='0'&&this.upc_ean_conv in{'ean2upc':'','always':''}){cur_barcode=cur_barcode.substr(1,12);}
if(!this.check_encoding(cur_barcode,rule.encoding)){continue;}
var match=this.match_pattern(cur_barcode,rules[i].pattern,rule.encoding);if(match.match){if(rules[i].type==='alias'){barcode=rules[i].alias;parsed_result.code=barcode;parsed_result.type='alias';}
else{parsed_result.encoding=rules[i].encoding;parsed_result.type=rules[i].type;parsed_result.value=match.value;parsed_result.code=cur_barcode;if(rules[i].encoding==="ean13"){parsed_result.base_code=this.sanitize_ean(match.base_code);}
else{parsed_result.base_code=match.base_code;}
return parsed_result;}}}
return parsed_result;},});return BarcodeParser;});;

/* /barcodes/static/src/js/barcode_events.js defined in bundle 'web.assets_backend' */
odoo.define('barcodes.BarcodeEvents',function(require){"use strict";var config=require('web.config');var core=require('web.core');var mixins=require('web.mixins');var session=require('web.session');function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
CustomEvent.prototype=window.Event.prototype;var BarcodeEvents=core.Class.extend(mixins.PropertiesMixin,{timeout:null,key_pressed:{},buffered_key_events:[],regexp:/(.{3,})[\n\r\t]*/,suffix:/[\n\r\t]+/,max_time_between_keys_in_ms:session.max_time_between_keys_in_ms||55,inputTimeOut:800,init:function(){mixins.PropertiesMixin.init.call(this);this.__keydown_handler=_.bind(this.keydown_handler,this);this.__keyup_handler=_.bind(this.keyup_handler,this);this.__handler=_.bind(this.handler,this);$(_.bind(this.start,this,false));this.isChromeMobile=config.device.isMobileDevice&&navigator.userAgent.match(/Chrome/i);this.$barcodeInput=$('<input/>',{name:'barcode',type:'text',css:{'position':'fixed','top':'50%','transform':'translateY(-50%)','z-index':'-1','opacity':'0',},});this.$barcodeInput.attr('autocomplete','off');this.__blurBarcodeInput=_.debounce(this._blurBarcodeInput,this.inputTimeOut);},handle_buffered_keys:function(){var str=this.buffered_key_events.reduce(function(memo,e){return memo+String.fromCharCode(e.which)},'');var match=str.match(this.regexp);if(match){var barcode=match[1];core.bus.trigger('barcode_scanned',barcode,this.buffered_key_events[0].target);if(this.buffered_key_events[0].target.getAttribute("barcode_events")==="true")
$(this.buffered_key_events[0].target).trigger('barcode_scanned',barcode);}else{this.resend_buffered_keys();}
this.buffered_key_events=[];},resend_buffered_keys:function(){var old_event,new_event;for(var i=0;i<this.buffered_key_events.length;i++){old_event=this.buffered_key_events[i];if(old_event.which!==13){var params={'bubbles':old_event.bubbles,'cancelable':old_event.cancelable,};new_event=$.Event('keypress',params);new_event.viewArg=old_event.viewArg;new_event.ctrl=old_event.ctrl;new_event.alt=old_event.alt;new_event.shift=old_event.shift;new_event.meta=old_event.meta;new_event.char=old_event.char;new_event.key=old_event.key;new_event.charCode=old_event.charCode;new_event.keyCode=old_event.keyCode||old_event.which;new_event.which=old_event.which;new_event.dispatched_by_barcode_reader=true;$(old_event.target).trigger(new_event);}}},element_is_editable:function(element){return $(element).is('input,textarea,[contenteditable="true"]');},is_special_key:function(e){if(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="Escape"||e.key==="Tab"||e.key==="Backspace"||e.key==="Delete"||e.key==="Home"||e.key==="End"||e.key==="PageUp"||e.key==="PageDown"||e.key==="Unidentified"||/F\d\d?/.test(e.key)){return true;}else{return false;}},keydown_handler:function(e){if(this.key_pressed[e.which]){e.preventDefault();}else{this.key_pressed[e.which]=true;}},keyup_handler:function(e){this.key_pressed[e.which]=false;},handler:function(e){if(e.dispatched_by_barcode_reader)
return;if(this.is_special_key(e))
return;if(e.ctrlKey||e.metaKey||e.altKey)
return;if(e.which===13&&this.buffered_key_events.length===0)
return;if((this.element_is_editable(e.target)&&!$(e.target).data('enableBarcode'))&&e.target.getAttribute("barcode_events")!=="true")
return;this.buffered_key_events.push(e);e.preventDefault();e.stopImmediatePropagation();clearTimeout(this.timeout);if(String.fromCharCode(e.which).match(this.suffix)){this.handle_buffered_keys();}else{this.timeout=setTimeout(_.bind(this.handle_buffered_keys,this),this.max_time_between_keys_in_ms);}},_listenBarcodeScanner:function(e){if($(document.activeElement).not('input:text, textarea, [contenteditable], '+'[type="email"], [type="number"], [type="password"], [type="tel"], [type="search"]').length){$('body').append(this.$barcodeInput);this.$barcodeInput.focus();}
if(this.$barcodeInput.is(":focus")){clearTimeout(this.timeout);if(String.fromCharCode(e.which).match(this.suffix)){this._handleBarcodeValue(e);}else{this.timeout=setTimeout(this._handleBarcodeValue.bind(this,e),this.max_time_between_keys_in_ms);}
this.__blurBarcodeInput();}},_handleBarcodeValue:function(e){var barcodeValue=this.$barcodeInput.val();if(barcodeValue.match(this.regexp)){core.bus.trigger('barcode_scanned',barcodeValue,$(e.target).parent()[0]);this._blurBarcodeInput();}},_blurBarcodeInput:function(){this.$barcodeInput.val('').blur();},start:function(prevent_key_repeat){if(this.isChromeMobile){$('body').on("keydown",this._listenBarcodeScanner.bind(this));}else{$('body').bind("keypress",this.__handler);}
if(prevent_key_repeat===true){$('body').bind("keydown",this.__keydown_handler);$('body').bind('keyup',this.__keyup_handler);}},stop:function(){$('body').off("keypress",this.__handler);$('body').off("keydown",this.__keydown_handler);$('body').off('keyup',this.__keyup_handler);},});return{BarcodeEvents:new BarcodeEvents(),ReservedBarcodePrefixes:['O-CMD'],};});;

/* /barcodes/static/src/js/barcode_form_view.js defined in bundle 'web.assets_backend' */
odoo.define('barcodes.FormView',function(require){"use strict";var BarcodeEvents=require('barcodes.BarcodeEvents');var concurrency=require('web.concurrency');var core=require('web.core');var Dialog=require('web.Dialog');var FormController=require('web.FormController');var FormRenderer=require('web.FormRenderer');var _t=core._t;FormController.include({custom_events:_.extend({},FormController.prototype.custom_events,{activeBarcode:'_barcodeActivated',}),init:function(){this._super.apply(this,arguments);this.activeBarcode={form_view:{commands:{'O-CMD.EDIT':this._barcodeEdit.bind(this),'O-CMD.DISCARD':this._barcodeDiscard.bind(this),'O-CMD.SAVE':this._barcodeSave.bind(this),'O-CMD.PREV':this._barcodePagerPrevious.bind(this),'O-CMD.NEXT':this._barcodePagerNext.bind(this),'O-CMD.PAGER-FIRST':this._barcodePagerFirst.bind(this),'O-CMD.PAGER-LAST':this._barcodePagerLast.bind(this),},},};this.barcodeMutex=new concurrency.Mutex();this._barcodeStartListening();},destroy:function(){this._barcodeStopListening();this._super();},_barcodeAddX2MQuantity:function(barcode,activeBarcode){if(this.mode==='readonly'){this.do_warn(false,_t('Enable edit mode to modify this document'));return Promise.reject();}
var record=this.model.get(this.handle);var candidate=this._getBarCodeRecord(record,barcode,activeBarcode);if(candidate){return this._barcodeSelectedCandidate(candidate,record,barcode,activeBarcode);}else{return this._barcodeWithoutCandidate(record,barcode,activeBarcode);}},_barcodeDiscard:function(){return this.discardChanges();},_barcodeEdit:function(){return this._setMode('edit');},_barcodePagerFirst:async function(){return this._updatePage(()=>1);},_barcodePagerLast:async function(){return this._updatePage((min,state)=>state.count);},_barcodePagerNext:function(){return this._updatePage((min,state)=>{min+=1;if(min>state.count){min=1;}
return min;});},_barcodePagerPrevious:function(){return this._updatePage((min,state)=>{min-=1;if(min<1){min=state.count;}
return min;});},_updatePage:async function(updater){await this.mutex.exec(()=>{});const state=this.model.get(this.handle,{raw:true});const pagingInfo=this._getPagingInfo(state);if(!pagingInfo){return this.do_warn(false,_t('Pager unavailable'));}
const currentMinimum=updater(pagingInfo.currentMinimum,state);const limit=pagingInfo.limit;const reloadParams=state.groupedBy&&state.groupedBy.length?{groupsLimit:limit,groupsOffset:currentMinimum-1,}:{limit,offset:currentMinimum-1,};await this.reload(reloadParams);if(state.limit===limit){this.trigger_up('scrollTo',{top:0});}},_barcodeRecordFilter:function(candidate,barcode,activeBarcode){return candidate.data.product_barcode===barcode;},_barcodeSave:function(){return this.saveRecord();},_barcodeSelectedCandidate:function(candidate,record,barcode,activeBarcode,quantity){var changes={};var candidateChanges={};candidateChanges[activeBarcode.quantity]=quantity?quantity:candidate.data[activeBarcode.quantity]+1;changes[activeBarcode.fieldName]={operation:'UPDATE',id:candidate.id,data:candidateChanges,};return this.model.notifyChanges(this.handle,changes,{notifyChange:activeBarcode.notifyChange});},_barcodeStartListening:function(){core.bus.on('barcode_scanned',this,this._barcodeScanned);core.bus.on('keypress',this,this._quantityListener);},_barcodeStopListening:function(){core.bus.off('barcode_scanned',this,this._barcodeScanned);core.bus.off('keypress',this,this._quantityListener);},_barcodeWithoutCandidate:function(record,barcode,activeBarcode){var changes={};changes[activeBarcode.name]=barcode;return this.model.notifyChanges(record.id,changes);},_getBarCodeRecord:function(record,barcode,activeBarcode){var self=this;if(!activeBarcode.fieldName||!record.data[activeBarcode.fieldName]){return;}
return _.find(record.data[activeBarcode.fieldName].data,function(record){return self._barcodeRecordFilter(record,barcode,activeBarcode);});},_barcodeActivated:function(event){event.stopPropagation();var name=event.data.name;this.activeBarcode[name]={name:name,handle:this.handle,target:event.target,widget:event.target.attrs&&event.target.attrs.widget,setQuantityWithKeypress:!!event.data.setQuantityWithKeypress,fieldName:event.data.fieldName,notifyChange:(event.data.notifyChange!==undefined)?event.data.notifyChange:true,quantity:event.data.quantity,commands:event.data.commands||{},candidate:this.activeBarcode[name]&&this.activeBarcode[name].handle===this.handle?this.activeBarcode[name].candidate:null,};this.disableAutofocus=true;},_barcodeActiveScanned:function(method,barcode,activeBarcode){var self=this;var methodDef;var def=new Promise(function(resolve,reject){if(typeof method==='string'){methodDef=self[method](barcode,activeBarcode);}else{methodDef=method.call(self,barcode,activeBarcode);}
methodDef.then(function(){var record=self.model.get(self.handle);var candidate=self._getBarCodeRecord(record,barcode,activeBarcode);activeBarcode.candidate=candidate;}).then(resolve,resolve);});return def;},_barcodeScanned:function(barcode,target){var self=this;return this.barcodeMutex.exec(function(){var prefixed=_.any(BarcodeEvents.ReservedBarcodePrefixes,function(reserved){return barcode.indexOf(reserved)===0;});var hasCommand=false;var defs=[];if(!$.contains(target,self.el)){return;}
for(var k in self.activeBarcode){var activeBarcode=self.activeBarcode[k];var methods=self.activeBarcode[k].commands;var method=prefixed?methods[barcode]:methods.barcode;if(method){if(prefixed){hasCommand=true;}
defs.push(self._barcodeActiveScanned(method,barcode,activeBarcode));}}
if(prefixed&&!hasCommand){self.do_warn(_t('Undefined barcode command'),barcode);}
return self.alive(Promise.all(defs)).then(function(){if(!prefixed){self.current_barcode=barcode;self.update({},{reload:false});}});});},_quantityListener:function(event){var character=String.fromCharCode(event.which);if(!$.contains(event.target,this.el)){return;}
if(!$(event.target).is('body, .modal')||!/[0-9]/.test(character)){return;}
var barcodeInfos=_.filter(this.activeBarcode,'setQuantityWithKeypress');if(!barcodeInfos.length){return;}
if(!_.compact(_.pluck(barcodeInfos,'candidate')).length){return this.do_warn(false,_t('Scan a barcode to set the quantity'));}
for(var k in this.activeBarcode){if(this.activeBarcode[k].candidate){this._quantityOpenDialog(character,this.activeBarcode[k]);}}},_quantityOpenDialog:function(character,activeBarcode){var self=this;var $content=$('<div>').append($('<input>',{type:'text',class:'o_set_qty_input'}));this.dialog=new Dialog(this,{title:_t('Set quantity'),buttons:[{text:_t('Select'),classes:'btn-primary',close:true,click:function(){var new_qty=this.$content.find('.o_set_qty_input').val();var record=self.model.get(self.handle);return self._barcodeSelectedCandidate(activeBarcode.candidate,record,self.current_barcode,activeBarcode,parseFloat(new_qty)).then(function(){self.update({},{reload:false});});}},{text:_t('Discard'),close:true}],$content:$content,});this.dialog.opened().then(function(){var $input=self.dialog.$('.o_set_qty_input').focus().val(character);var $selectBtn=self.dialog.$footer.find('.btn-primary');$input.on('keypress',function(event){if(event.which===13){event.preventDefault();$input.off();$selectBtn.click();}});});this.dialog.open();},});FormRenderer.include({_barcodeButtonHandler:function($button,node){var commands={};commands.barcode=function(){return Promise.resolve();};commands['O-BTN.'+node.attrs.barcode_trigger]=function(){if(!$button.hasClass('o_invisible_modifier')){$button.click();}
return Promise.resolve();};var name=node.attrs.name;if(node.attrs.string){name=name+'_'+node.attrs.string;}
this.trigger_up('activeBarcode',{name:name,commands:commands});},_renderHeaderButton:function(node){var $button=this._super.apply(this,arguments);if(node.attrs.barcode_trigger){this._barcodeButtonHandler($button,node);}
return $button;},_renderStatButton:function(node){var $button=this._super.apply(this,arguments);if(node.attrs.barcode_trigger){this._barcodeButtonHandler($button,node);}
return $button;},_renderTagButton:function(node){var $button=this._super.apply(this,arguments);if(node.attrs.barcode_trigger){this._barcodeButtonHandler($button,node);}
return $button;}});BarcodeEvents.ReservedBarcodePrefixes.push('O-BTN');});;

/* /barcodes/static/src/js/barcode_field.js defined in bundle 'web.assets_backend' */
odoo.define('barcodes.field',function(require){"use strict";var AbstractField=require('web.AbstractField');var basicFields=require('web.basic_fields');var fieldRegistry=require('web.field_registry');var BarcodeEvents=require('barcodes.BarcodeEvents').BarcodeEvents;var FieldFloatScannable=basicFields.FieldFloat.extend({events:_.extend({},basicFields.FieldFloat.prototype.events,{keypress:'_onKeypress',}),_renderEdit:function(){var self=this;return Promise.resolve(this._super()).then(function(){self.$input.data('enableBarcode',true);});},_onKeypress:function(e){if(e.dispatched_by_barcode_reader!==true){if(!BarcodeEvents.is_special_key(e)){e.preventDefault();}
return;}
var character=String.fromCharCode(e.which);var current_str=e.target.value;var str_before_carret=current_str.substring(0,e.target.selectionStart);var str_after_carret=current_str.substring(e.target.selectionEnd);e.target.value=str_before_carret+character+str_after_carret;var new_carret_index=str_before_carret.length+character.length;e.target.setSelectionRange(new_carret_index,new_carret_index);$(e.target).trigger('input');},});var FormViewBarcodeHandler=AbstractField.extend({init:function(){this._super.apply(this,arguments);this.trigger_up('activeBarcode',{name:this.name,commands:{barcode:'_barcodeAddX2MQuantity',}});},});fieldRegistry.add('field_float_scannable',FieldFloatScannable);fieldRegistry.add('barcode_handler',FormViewBarcodeHandler);return{FieldFloatScannable:FieldFloatScannable,FormViewBarcodeHandler:FormViewBarcodeHandler,};});;

/* /stock/static/src/js/inventory_report_list_controller.js defined in bundle 'web.assets_backend' */
odoo.define('stock.InventoryReportListController',function(require){"use strict";var core=require('web.core');var ListController=require('web.ListController');var qweb=core.qweb;var InventoryReportListController=ListController.extend({init:function(parent,model,renderer,params){this.context=renderer.state.getContext();return this._super.apply(this,arguments);},renderButtons:function($node){this._super.apply(this,arguments);if(this.context.no_at_date){return;}
var $buttonToDate=$(qweb.render('InventoryReport.Buttons'));$buttonToDate.on('click',this._onOpenWizard.bind(this));this.$buttons.prepend($buttonToDate);},_onOpenWizard:function(){var state=this.model.get(this.handle,{raw:true});var stateContext=state.getContext();var context={active_model:this.modelName,};if(stateContext.default_product_id){context.product_id=stateContext.default_product_id;}else if(stateContext.product_tmpl_id){context.product_tmpl_id=stateContext.product_tmpl_id;}
this.do_action({res_model:'stock.quantity.history',views:[[false,'form']],target:'new',type:'ir.actions.act_window',context:context,});},});return InventoryReportListController;});;

/* /stock/static/src/js/inventory_report_list_view.js defined in bundle 'web.assets_backend' */
odoo.define('stock.InventoryReportListView',function(require){"use strict";var ListView=require('web.ListView');var InventoryReportListController=require('stock.InventoryReportListController');var viewRegistry=require('web.view_registry');var InventoryReportListView=ListView.extend({config:_.extend({},ListView.prototype.config,{Controller:InventoryReportListController,}),});viewRegistry.add('inventory_report_list',InventoryReportListView);return InventoryReportListView;});;

/* /stock/static/src/js/inventory_singleton_list_controller.js defined in bundle 'web.assets_backend' */
odoo.define('stock.SingletonListController',function(require){"use strict";var core=require('web.core');var InventoryReportListController=require('stock.InventoryReportListController');var _t=core._t;var SingletonListController=InventoryReportListController.extend({_confirmSave:function(id){var newRecord=this.model.localData[id];var model=newRecord.model;var res_id=newRecord.res_id;var findSimilarRecords=function(record){if((record.groupedBy&&record.groupedBy.length>0)||record.data.length){var recordsToReturn=[];for(var i in record.data){var foundRecords=findSimilarRecords(record.data[i]);recordsToReturn=recordsToReturn.concat(foundRecords||[]);}
return recordsToReturn;}else{if(record.res_id===res_id&&record.model===model){if(record.count===0){return[record];}
else if(record.ref&&record.ref.indexOf('virtual')!==-1){return[record];}}}};var handle=this.model.get(this.handle);var similarRecords=findSimilarRecords(handle);if(similarRecords.length>1){var notification=_t("You tried to create a record who already exists."+"<br/>This last one has been modified instead.");this.do_notify(_t("This record already exists."),notification);this.reload();return Promise.reject();}
else{return this._super.apply(this,arguments);}},});return SingletonListController;});;

/* /stock/static/src/js/inventory_singleton_list_view.js defined in bundle 'web.assets_backend' */
odoo.define('stock.SingletonListView',function(require){'use strict';var InventoryReportListView=require('stock.InventoryReportListView');var SingletonListController=require('stock.SingletonListController');var viewRegistry=require('web.view_registry');var SingletonListView=InventoryReportListView.extend({config:_.extend({},InventoryReportListView.prototype.config,{Controller:SingletonListController,}),});viewRegistry.add('singleton_list',SingletonListView);return SingletonListView;});;

/* /stock/static/src/js/inventory_validate_button_controller.js defined in bundle 'web.assets_backend' */
odoo.define('stock.InventoryValidationController',function(require){"use strict";var core=require('web.core');var ListController=require('web.ListController');var _t=core._t;var qweb=core.qweb;var InventoryValidationController=ListController.extend({events:_.extend({'click .o_button_validate_inventory':'_onValidateInventory'},ListController.prototype.events),init:function(parent,model,renderer,params){var context=renderer.state.getContext();this.inventory_id=context.active_id;return this._super.apply(this,arguments);},renderButtons:function(){this._super.apply(this,arguments);var $validationButton=$(qweb.render('InventoryLines.Buttons'));this.$buttons.prepend($validationButton);},_onValidateInventory:function(){var self=this;var prom=Promise.resolve();var recordID=this.renderer.getEditableRecordID();if(recordID){prom=this.saveRecord(recordID);}
prom.then(function(){self._rpc({model:'stock.inventory',method:'action_validate',args:[self.inventory_id]}).then(function(res){var exitCallback=function(infos){if(infos&&infos.special){return;}
self.do_notify(false,_t("The inventory has been validated"));self.trigger_up('history_back');};if(_.isObject(res)){self.do_action(res,{on_close:exitCallback});}else{return exitCallback();}});});},});return InventoryValidationController;});;

/* /stock/static/src/js/inventory_validate_button_view.js defined in bundle 'web.assets_backend' */
odoo.define('stock.InventoryValidationView',function(require){"use strict";var InventoryValidationController=require('stock.InventoryValidationController');var ListView=require('web.ListView');var viewRegistry=require('web.view_registry');var InventoryValidationView=ListView.extend({config:_.extend({},ListView.prototype.config,{Controller:InventoryValidationController})});viewRegistry.add('inventory_validate_button',InventoryValidationView);});;

/* /stock/static/src/js/report_stock_forecasted.js defined in bundle 'web.assets_backend' */
odoo.define('stock.ReplenishReport',function(require){"use strict";const clientAction=require('report.client_action');const core=require('web.core');const dom=require('web.dom');const GraphView=require('web.GraphView');const qweb=core.qweb;const _t=core._t;const ReplenishReport=clientAction.extend({init:function(parent,action,options){this._super.apply(this,arguments);this.context=action.context;this.productId=this.context.active_id;this.resModel=this.context.active_model||this.context.params.active_model||'product.template';const isTemplate=this.resModel==='product.template';this.actionMethod=`action_product_${isTemplate ? 'tmpl_' : ''}forecast_report`;const reportName=`report_product_${isTemplate ? 'template' : 'product'}_replenishment`;this.report_url=`/report/html/stock.${reportName}/${this.productId}`;if(this.context.warehouse){this.active_warehouse={id:this.context.warehouse};}
this.report_url+=`?context=${JSON.stringify(this.context)}&force_context_lang=1`;this._title=action.name;},start:function(){return Promise.all([this._super(...arguments),this._renderWarehouseFilters(),]).then(()=>{this._renderButtons();});},on_attach_callback:function(){this._super();this._createGraphView();},_createGraphView:async function(){let viewController;const appendGraph=()=>{promController.then(()=>{this.iframe.removeEventListener('load',appendGraph);const $reportGraphDiv=$(this.iframe).contents().find('.o_report_graph');if(!$reportGraphDiv){return;}
dom.append(this.$el,viewController.$el,{in_DOM:true,callbacks:[{widget:viewController}],});const renderer=viewController.renderer;$('.o_control_panel:last').remove();const $graphPanel=$('.o_graph_controller');$graphPanel.appendTo($reportGraphDiv);if(!renderer.state.dataPoints.length){const graphHelper=renderer.$('.o_view_nocontent');const newMessage=qweb.render('View.NoContentHelper',{description:_t("Try to add some incoming or outgoing transfers."),});graphHelper.replaceWith(newMessage);}else{this.chart=renderer.chart;setTimeout(()=>{this.chart.canvas.height=300;this.chart.canvas.style.height="300px";this.chart.resize();},1);}});};this.iframe.addEventListener('load',appendGraph);const model='report.stock.quantity';const promController=this._rpc({model:model,method:'fields_view_get',kwargs:{view_type:'graph',}}).then(viewInfo=>{const params={modelName:model,domain:this._getReportDomain(),hasActionMenus:false,};const graphView=new GraphView(viewInfo,params);return graphView.getController(this);}).then(res=>{viewController=res;if(location.href.indexOf('active_model')===-1){const url=window.location.href+`&active_model=${this.resModel}`;window.history.pushState({},"",url);}
const fragment=document.createDocumentFragment();return viewController.appendTo(fragment);});},_getForecastedReportAction:function(){return this._rpc({model:this.resModel,method:this.actionMethod,args:[this.productId],context:this.context,});},_getReportDomain:function(){const domain=[['state','=','forecast'],['warehouse_id','=',this.active_warehouse.id],];if(this.resModel==='product.template'){domain.push(['product_tmpl_id','=',this.productId]);}else if(this.resModel==='product.product'){domain.push(['product_id','=',this.productId]);}
return domain;},_reloadReport:function(additionnalContext){return this._getForecastedReportAction().then((action)=>{action.context=Object.assign({active_id:this.productId,active_model:this.resModel,},this.context,additionnalContext);return this.do_action(action,{replace_last_action:true});});},_renderButtons:function(){const $newButtons=$(qweb.render('replenish_report_buttons',{}));this.$buttons.find('.o_report_print').replaceWith($newButtons);this.$buttons.on('click','.o_report_replenish_buy',this._onClickReplenish.bind(this));this.controlPanelProps.cp_content={$buttons:this.$buttons,};},_renderWarehouseFilters:function(){return this._rpc({model:'report.stock.report_product_product_replenishment',method:'get_filter_state',}).then((res)=>{const warehouses=res.warehouses;const active_warehouse=(this.active_warehouse&&this.active_warehouse.id)||res.active_warehouse;if(active_warehouse){this.active_warehouse=_.findWhere(warehouses,{id:active_warehouse});}else{this.active_warehouse=warehouses[0];}
const $filters=$(qweb.render('warehouseFilter',{active_warehouse:this.active_warehouse,warehouses:warehouses,displayWarehouseFilter:(warehouses.length>1),}));$filters.on('click','.warehouse_filter',this._onClickFilter.bind(this));this.$('.o_search_options').append($filters);});},_onClickReplenish:function(){const context=Object.assign({},this.context);if(this.resModel==='product.product'){context.default_product_id=this.productId;}else if(this.resModel==='product.template'){context.default_product_tmpl_id=this.productId;}
context.default_warehouse_id=this.active_warehouse.id;const on_close=function(res){if(res&&res.special){return;}
return this._reloadReport();};const action={res_model:'product.replenish',name:_t('Product Replenish'),type:'ir.actions.act_window',views:[[false,'form']],target:'new',context:context,};return this.do_action(action,{on_close:on_close.bind(this),});},_onClickFilter:function(ev){const data=ev.target.dataset;const warehouse_id=Number(data.warehouseId);return this._reloadReport({warehouse:warehouse_id});}});core.action_registry.add('replenish_report',ReplenishReport);});;

/* /stock/static/src/js/stock_orderpoint_list_controller.js defined in bundle 'web.assets_backend' */
odoo.define('stock.StockOrderpointListController',function(require){"use strict";var core=require('web.core');var ListController=require('web.ListController');var qweb=core.qweb;var StockOrderpointListController=ListController.extend({renderButtons:function(){this._super.apply(this,arguments);this.$buttons.find('.o_button_import').addClass('d-none');this.$buttons.find('.o_list_export_xlsx').addClass('d-none');this.$buttons.find('.o_list_button_add').removeClass('btn-primary').addClass('btn-secondary');var $buttons=$(qweb.render('StockOrderpoint.Buttons'));var $buttonOrder=$buttons.find('.o_button_order');var $buttonSnooze=$buttons.find('.o_button_snooze');$buttonOrder.on('click',this._onReplenish.bind(this));$buttonSnooze.on('click',this._onSnooze.bind(this));$buttons.prependTo(this.$buttons);},_onButtonClicked:function(ev){if(ev.data.attrs.class.split(' ').includes('o_replenish_buttons')){ev.stopPropagation();var self=this;this._callButtonAction(ev.data.attrs,ev.data.record).then(function(){self.reload();});}else{this._super.apply(this,arguments);}},_onReplenish:function(){var records=this.getSelectedRecords();this.model.replenish(records);},_onSelectionChanged:function(ev){this._super(ev);var $buttonOrder=this.$el.find('.o_button_order');var $buttonSnooze=this.$el.find('.o_button_snooze');if(this.getSelectedIds().length===0){$buttonOrder.addClass('d-none');$buttonSnooze.addClass('d-none');}else{$buttonOrder.removeClass('d-none');$buttonSnooze.removeClass('d-none');}},_onSnooze:function(){var records=this.getSelectedRecords();this.model.snooze(records);},});return StockOrderpointListController;});;

/* /stock/static/src/js/stock_orderpoint_list_model.js defined in bundle 'web.assets_backend' */
odoo.define('stock.StockOrderpointListModel',function(require){"use strict";var core=require('web.core');var ListModel=require('web.ListModel');var qweb=core.qweb;var StockOrderpointListModel=ListModel.extend({replenish:function(records){var self=this;var model=records[0].model;var recordResIds=_.pluck(records,'res_id');var context=records[0].getContext();return this._rpc({model:model,method:'action_replenish',args:[recordResIds],context:context,}).then(function(){return self.do_action('stock.action_replenishment');});},snooze:function(records){var recordResIds=_.pluck(records,'res_id');var self=this;return this.do_action('stock.action_orderpoint_snooze',{additional_context:{default_orderpoint_ids:recordResIds},on_close:()=>self.do_action('stock.action_replenishment')});},});return StockOrderpointListModel;});;

/* /stock/static/src/js/stock_orderpoint_list_view.js defined in bundle 'web.assets_backend' */
odoo.define('stock.StockOrderpointListView',function(require){"use strict";var ListView=require('web.ListView');var StockOrderpointListController=require('stock.StockOrderpointListController');var StockOrderpointListModel=require('stock.StockOrderpointListModel');var viewRegistry=require('web.view_registry');var StockOrderpointListView=ListView.extend({config:_.extend({},ListView.prototype.config,{Controller:StockOrderpointListController,Model:StockOrderpointListModel,}),});viewRegistry.add('stock_orderpoint_list',StockOrderpointListView);return StockOrderpointListView;});;

/* /stock/static/src/js/stock_traceability_report_backend.js defined in bundle 'web.assets_backend' */
odoo.define('stock.stock_report_generic',function(require){'use strict';var AbstractAction=require('web.AbstractAction');var core=require('web.core');var session=require('web.session');var ReportWidget=require('stock.ReportWidget');var framework=require('web.framework');var QWeb=core.qweb;var stock_report_generic=AbstractAction.extend({hasControlPanel:true,init:function(parent,action){this._super.apply(this,arguments);this.actionManager=parent;this.given_context=Object.assign({},session.user_context);this.controller_url=action.context.url;if(action.context.context){this.given_context=action.context.context;}
this.given_context.active_id=action.context.active_id||action.params.active_id;this.given_context.model=action.context.active_model||false;this.given_context.ttype=action.context.ttype||false;this.given_context.auto_unfold=action.context.auto_unfold||false;this.given_context.lot_name=action.context.lot_name||false;},willStart:function(){return Promise.all([this._super.apply(this,arguments),this.get_html()]);},set_html:function(){var self=this;var def=Promise.resolve();if(!this.report_widget){this.report_widget=new ReportWidget(this,this.given_context);def=this.report_widget.appendTo(this.$('.o_content'));}
return def.then(function(){self.report_widget.$el.html(self.html);self.report_widget.$el.find('.o_report_heading').html('<h1>Traceability Report</h1>');if(self.given_context.auto_unfold){_.each(self.$el.find('.fa-caret-right'),function(line){self.report_widget.autounfold(line,self.given_context.lot_name);});}});},start:async function(){this.controlPanelProps.cp_content={$buttons:this.$buttons};await this._super(...arguments);this.set_html();},get_html:async function(){const{html}=await this._rpc({args:[this.given_context],method:'get_html',model:'stock.traceability.report',});this.html=html;this.renderButtons();},update_cp:function(){if(!this.$buttons){this.renderButtons();}
this.controlPanelProps.cp_content={$buttons:this.$buttons};return this.updateControlPanel();},renderButtons:function(){var self=this;this.$buttons=$(QWeb.render("stockReports.buttons",{}));this.$buttons.bind('click',function(){var $element=$(self.$el[0]).find('.o_stock_reports_table tbody tr');var dict=[];$element.each(function(index){var $el=$($element[index]);dict.push({'id':$el.data('id'),'model_id':$el.data('model_id'),'model_name':$el.data('model'),'unfoldable':$el.data('unfold'),'level':$el.find('td:first').data('level')||1});});framework.blockUI();var url_data=self.controller_url.replace('active_id',self.given_context.active_id);session.get_file({url:url_data.replace('output_format','pdf'),data:{data:JSON.stringify(dict)},complete:framework.unblockUI,error:(error)=>self.call('crash_manager','rpc_error',error),});});return this.$buttons;},});core.action_registry.add("stock_report_generic",stock_report_generic);return stock_report_generic;});;

/* /stock/static/src/js/stock_traceability_report_widgets.js defined in bundle 'web.assets_backend' */
odoo.define('stock.ReportWidget',function(require){'use strict';var core=require('web.core');var Widget=require('web.Widget');var QWeb=core.qweb;var _t=core._t;var ReportWidget=Widget.extend({events:{'click span.o_stock_reports_foldable':'fold','click span.o_stock_reports_unfoldable':'unfold','click .o_stock_reports_web_action':'boundLink','click .o_stock_reports_stream':'updownStream','click .o_stock_report_lot_action':'actionOpenLot'},init:function(parent){this._super.apply(this,arguments);},start:function(){QWeb.add_template("/stock/static/src/xml/stock_traceability_report_line.xml");return this._super.apply(this,arguments);},boundLink:function(e){e.preventDefault();return this.do_action({type:'ir.actions.act_window',res_model:$(e.target).data('res-model'),res_id:$(e.target).data('active-id'),views:[[false,'form']],target:'current'});},actionOpenLot:function(e){e.preventDefault();var $el=$(e.target).parents('tr');this.do_action({type:'ir.actions.client',tag:'stock_report_generic',name:$el.data('lot_name')!==undefined&&$el.data('lot_name').toString(),context:{active_id:$el.data('lot_id'),active_model:'stock.production.lot',url:'/stock/output_format/stock/active_id'},});},updownStream:function(e){var $el=$(e.target).parents('tr');this.do_action({type:"ir.actions.client",tag:'stock_report_generic',name:_t("Traceability Report"),context:{active_id:$el.data('model_id'),active_model:$el.data('model'),auto_unfold:true,lot_name:$el.data('lot_name')!==undefined&&$el.data('lot_name').toString(),url:'/stock/output_format/stock/active_id'},});},removeLine:function(element){var self=this;var el,$el;var rec_id=element.data('id');var $stockEl=element.nextAll('tr[data-parent_id='+rec_id+']')
for(el in $stockEl){$el=$($stockEl[el]).find(".o_stock_reports_domain_line_0, .o_stock_reports_domain_line_1");if($el.length===0){break;}
else{var $nextEls=$($el[0]).parents("tr");self.removeLine($nextEls);$nextEls.remove();}
$el.remove();}
return true;},fold:function(e){this.removeLine($(e.target).parents('tr'));var active_id=$(e.target).parents('tr').find('td.o_stock_reports_foldable').data('id');$(e.target).parents('tr').find('td.o_stock_reports_foldable').attr('class','o_stock_reports_unfoldable '+active_id);$(e.target).parents('tr').find('span.o_stock_reports_foldable').replaceWith(QWeb.render("unfoldable",{lineId:active_id}));$(e.target).parents('tr').toggleClass('o_stock_reports_unfolded');},autounfold:function(target,lot_name){var self=this;var $CurretElement;$CurretElement=$(target).parents('tr').find('td.o_stock_reports_unfoldable');var active_id=$CurretElement.data('id');var active_model_name=$CurretElement.data('model');var active_model_id=$CurretElement.data('model_id');var row_level=$CurretElement.data('level');var $cursor=$(target).parents('tr');this._rpc({model:'stock.traceability.report',method:'get_lines',args:[parseInt(active_id,10)],kwargs:{'model_id':active_model_id,'model_name':active_model_name,'level':parseInt(row_level)+30||1},}).then(function(lines){_.each(lines,function(line){$cursor.after(QWeb.render("report_mrp_line",{l:line}));$cursor=$cursor.next();if($cursor&&line.unfoldable&&line.lot_name==lot_name){self.autounfold($cursor.find(".fa-caret-right"),lot_name);}});});$CurretElement.attr('class','o_stock_reports_foldable '+active_id);$(target).parents('tr').find('span.o_stock_reports_unfoldable').replaceWith(QWeb.render("foldable",{lineId:active_id}));$(target).parents('tr').toggleClass('o_stock_reports_unfolded');},unfold:function(e){this.autounfold($(e.target));},});return ReportWidget;});;

/* /stock/static/src/js/popover_widget.js defined in bundle 'web.assets_backend' */
odoo.define('stock.popover_widget',function(require){'use strict';var AbstractField=require('web.AbstractField');var core=require('web.core');var QWeb=core.qweb;var Context=require('web.Context');var data_manager=require('web.data_manager');var fieldRegistry=require('web.field_registry');var PopoverWidgetField=AbstractField.extend({supportedFieldTypes:['char'],buttonTemplape:'stock.popoverButton',popoverTemplate:'stock.popoverContent',trigger:'focus',placement:'top',html:true,color:'text-primary',icon:'fa-info-circle',_render:function(){var value=JSON.parse(this.value);if(!value){this.$el.html('');return;}
this.$el.css('max-width','17px');this.$el.html(QWeb.render(this.buttonTemplape,_.defaults(value,{color:this.color,icon:this.icon})));this.$el.find('a').prop('special_click',true);this.$popover=$(QWeb.render(value.popoverTemplate||this.popoverTemplate,value));this.$popover.on('click','.action_open_forecast',this._openForecast.bind(this));this.$el.find('a').popover({content:this.$popover,html:this.html,placement:this.placement,title:value.title||this.title.toString(),trigger:this.trigger,delay:{'show':0,'hide':100},});},async _openForecast(ev){ev.stopPropagation();const reportContext={active_model:'product.product',active_id:this.recordData.product_id.data.id,};const action=await this._rpc({model:reportContext.active_model,method:'action_product_forecast_report',args:[[reportContext.active_id]],});action.context=new Context(action.context,reportContext);return this.do_action(action);},destroy:function(){this.$el.find('a').popover('dispose');this._super.apply(this,arguments);},});fieldRegistry.add('popover_widget',PopoverWidgetField);return PopoverWidgetField;});;

/* /stock/static/src/js/forecast_widget.js defined in bundle 'web.assets_backend' */
odoo.define('stock.forecast_widget',function(require){'use strict';const AbstractField=require('web.AbstractField');const fieldRegistry=require('web.field_registry');const field_utils=require('web.field_utils');const utils=require('web.utils');const core=require('web.core');const QWeb=core.qweb;const ForecastWidgetField=AbstractField.extend({supportedFieldTypes:['float'],_render:function(){var data=Object.assign({},this.record.data,{forecast_availability_str:field_utils.format.float(this.record.data.forecast_availability,this.record.fields.forecast_availability,this.nodeOptions),reserved_availability_str:field_utils.format.float(this.record.data.reserved_availability,this.record.fields.reserved_availability,this.nodeOptions),forecast_expected_date_str:field_utils.format.date(this.record.data.forecast_expected_date,this.record.fields.forecast_expected_date),});if(data.forecast_expected_date&&data.date_deadline){data.forecast_is_late=data.forecast_expected_date>data.date_deadline;}
data.will_be_fulfilled=utils.round_decimals(data.forecast_availability,this.record.fields.forecast_availability.digits[1])>=utils.round_decimals(data.product_qty,this.record.fields.forecast_availability.digits[1]);this.$el.html(QWeb.render('stock.forecastWidget',data));this.$('.o_forecast_report_button').on('click',this._onOpenReport.bind(this));},isSet:function(){return true;},_onOpenReport:function(ev){ev.preventDefault();ev.stopPropagation();if(!this.recordData.id){return;}
this._rpc({model:'stock.move',method:'action_product_forecast_report',args:[this.recordData.id],}).then(action=>{action.context=Object.assign(action.context||{},{active_model:'product.product',active_id:this.recordData.product_id.res_id,});this.do_action(action);});},});fieldRegistry.add('forecast_widget',ForecastWidgetField);return ForecastWidgetField;});;

/* /stock/static/src/js/basic_model.js defined in bundle 'web.assets_backend' */
odoo.define('stock.BasicModel',function(require){"use strict";var BasicModel=require('web.BasicModel');var localStorage=require('web.local_storage');BasicModel.include({_invalidateCache:function(dataPoint){this._super.apply(this,arguments);if(dataPoint.model==='stock.warehouse'&&!localStorage.getItem('running_tour')){this.do_action('reload_context');}}});});;

/* /stock/static/src/js/stock_rescheduling_popover.js defined in bundle 'web.assets_backend' */
odoo.define('stock.PopoverStockPicking',function(require){"use strict";var core=require('web.core');var PopoverWidgetField=require('stock.popover_widget');var registry=require('web.field_registry');var _lt=core._lt;var PopoverStockPicking=PopoverWidgetField.extend({title:_lt('Planning Issue'),trigger:'focus',color:'text-danger',icon:'fa-exclamation-triangle',_render:function(){this._super();if(this.$popover){var self=this;this.$popover.find('a').on('click',function(ev){ev.preventDefault();ev.stopPropagation();self.do_action({type:'ir.actions.act_window',res_model:ev.currentTarget.getAttribute('element-model'),res_id:parseInt(ev.currentTarget.getAttribute('element-id'),10),views:[[false,'form']],target:'current'});});}},});registry.add('stock_rescheduling_popover',PopoverStockPicking);return PopoverStockPicking;});;

/* /stock/static/tests/tours/stock_report_tests.js defined in bundle 'web.assets_backend' */
odoo.define('stock.reports.setup.tour',function(require){"use strict";const tour=require('web_tour.tour');tour.register('test_stock_route_diagram_report',{test:true,},[{trigger:'.o_kanban_record',extra_trigger:'.breadcrumb',},{trigger:'.nav-item > a:contains("Inventory")',},{trigger:'.btn[id="stock.view_diagram_button"]',},{trigger:'iframe .o_report_stock_rule',},]);});;

/* /sale_stock/static/src/js/qty_at_date_widget.js defined in bundle 'web.assets_backend' */
odoo.define('sale_stock.QtyAtDateWidget',function(require){"use strict";var core=require('web.core');var QWeb=core.qweb;var Widget=require('web.Widget');var widget_registry=require('web.widget_registry');var utils=require('web.utils');var _t=core._t;var time=require('web.time');var QtyAtDateWidget=Widget.extend({template:'sale_stock.qtyAtDate',events:_.extend({},Widget.prototype.events,{'click .fa-area-chart':'_onClickButton',}),init:function(parent,params){this.data=params.data;this.fields=params.fields;this._updateData();this._super(parent);},start:function(){var self=this;return this._super.apply(this,arguments).then(function(){self._setPopOver();});},_updateData:function(){if(this.data.scheduled_date){var qty_considered=this.data.state==='sale'?this.data.free_qty_today:this.data.virtual_available_at_date;this.data.will_be_fulfilled=utils.round_decimals(qty_considered,this.fields.virtual_available_at_date.digits[1])>=utils.round_decimals(this.data.qty_to_deliver,this.fields.qty_to_deliver.digits[1]);this.data.will_be_late=this.data.forecast_expected_date&&this.data.forecast_expected_date>this.data.scheduled_date;if(['draft','sent'].includes(this.data.state)){this.data.forecasted_issue=!this.data.will_be_fulfilled&&!this.data.is_mto;}else{this.data.forecasted_issue=!this.data.will_be_fulfilled||this.data.will_be_late;}}},updateState:function(state){this.$el.popover('dispose');var candidate=state.data[this.getParent().currentRow];if(candidate){this.data=candidate.data;this._updateData();this.renderElement();this._setPopOver();}},async _openForecast(ev){ev.stopPropagation();var action=await this._rpc({model:'product.product',method:'action_product_forecast_report',args:[[this.data.product_id.data.id]]});action.context={active_model:'product.product',active_id:this.data.product_id.data.id,warehouse:this.data.warehouse_id&&this.data.warehouse_id.res_id};return this.do_action(action);},_getContent(){if(!this.data.scheduled_date){return;}
this.data.delivery_date=this.data.scheduled_date.clone().add(this.getSession().getTZOffset(this.data.scheduled_date),'minutes').format(time.getLangDateFormat());if(this.data.forecast_expected_date){this.data.forecast_expected_date_str=this.data.forecast_expected_date.clone().add(this.getSession().getTZOffset(this.data.forecast_expected_date),'minutes').format(time.getLangDateFormat());}
const $content=$(QWeb.render('sale_stock.QtyDetailPopOver',{data:this.data,}));$content.on('click','.action_open_forecast',this._openForecast.bind(this));return $content;},_setPopOver(){const $content=this._getContent();if(!$content){return;}
const options={content:$content,html:true,placement:'left',title:_t('Availability'),trigger:'focus',delay:{'show':0,'hide':100},};this.$el.popover(options);},_onClickButton:function(){this.$el.find('.fa-area-chart').prop('special_click',true);},});widget_registry.add('qty_at_date_widget',QtyAtDateWidget);return QtyAtDateWidget;});;

/* /website/static/src/js/backend/button.js defined in bundle 'web.assets_backend' */
odoo.define('website.backend.button',function(require){'use strict';var AbstractField=require('web.AbstractField');var core=require('web.core');var field_registry=require('web.field_registry');var _t=core._t;var WebsitePublishButton=AbstractField.extend({className:'o_stat_info',supportedFieldTypes:['boolean'],isSet:function(){return true;},_render:function(){this.$el.empty();var text=this.value?_t("Published"):_t("Unpublished");var hover=this.value?_t("Unpublish"):_t("Publish");var valColor=this.value?'text-success':'text-danger';var hoverColor=this.value?'text-danger':'text-success';var $val=$('<span>').addClass('o_stat_text o_not_hover '+valColor).text(text);var $hover=$('<span>').addClass('o_stat_text o_hover '+hoverColor).text(hover);this.$el.append($val).append($hover);},});var WidgetWebsiteButtonIcon=AbstractField.extend({template:'WidgetWebsiteButtonIcon',events:{'click':'_onClick',},start:function(){this.$icon=this.$('.o_button_icon');return this._super.apply(this,arguments);},isSet:function(){return true;},_render:function(){this._super.apply(this,arguments);var published=this.value;var info=published?_t("Published"):_t("Unpublished");this.$el.attr('aria-label',info).prop('title',info);this.$icon.toggleClass('text-danger',!published).toggleClass('text-success',published);},_onClick:function(){this.trigger_up('button_clicked',{attrs:{type:'object',name:'open_website_url',},record:this.record,});},});field_registry.add('website_redirect_button',WidgetWebsiteButtonIcon).add('website_publish_button',WebsitePublishButton);});;

/* /website/static/src/js/backend/dashboard.js defined in bundle 'web.assets_backend' */
odoo.define('website.backend.dashboard',function(require){'use strict';var AbstractAction=require('web.AbstractAction');var ajax=require('web.ajax');var core=require('web.core');var Dialog=require('web.Dialog');var field_utils=require('web.field_utils');var pyUtils=require('web.py_utils');var session=require('web.session');var time=require('web.time');var web_client=require('web.web_client');var _t=core._t;var QWeb=core.qweb;var COLORS=["#1f77b4","#aec7e8"];var FORMAT_OPTIONS={humanReadable:function(value){return Math.abs(value)>=1000;},minDigits:1,decimals:2,formatterCallback:function(str){return str;},};var Dashboard=AbstractAction.extend({hasControlPanel:true,contentTemplate:'website.WebsiteDashboardMain',jsLibs:['/web/static/lib/Chart/Chart.js',],events:{'click .js_link_analytics_settings':'on_link_analytics_settings','click .o_dashboard_action':'on_dashboard_action','click .o_dashboard_action_form':'on_dashboard_action_form',},init:function(parent,context){this._super(parent,context);this.DATE_FORMAT=time.getLangDateFormat();this.date_range='week';this.date_from=moment.utc().subtract(1,'week');this.date_to=moment.utc();this.dashboards_templates=['website.dashboard_header','website.dashboard_content'];this.graphs=[];this.chartIds={};},willStart:function(){var self=this;return Promise.all([ajax.loadLibs(this),this._super()]).then(function(){return self.fetch_data();}).then(function(){var website=_.findWhere(self.websites,{selected:true});self.website_id=website?website.id:false;});},start:function(){var self=this;this._computeControlPanelProps();return this._super().then(function(){self.render_graphs();});},on_attach_callback:function(){this._isInDom=true;this.render_graphs();this._super.apply(this,arguments);},on_detach_callback:function(){this._isInDom=false;this._super.apply(this,arguments);},fetch_data:function(){var self=this;var prom=this._rpc({route:'/website/fetch_dashboard_data',params:{website_id:this.website_id||false,date_from:this.date_from.year()+'-'+(this.date_from.month()+1)+'-'+this.date_from.date(),date_to:this.date_to.year()+'-'+(this.date_to.month()+1)+'-'+this.date_to.date(),},});prom.then(function(result){self.data=result;self.dashboards_data=result.dashboards;self.currency_id=result.currency_id;self.groups=result.groups;self.websites=result.websites;});return prom;},on_link_analytics_settings:function(ev){ev.preventDefault();var self=this;var dialog=new Dialog(this,{size:'medium',title:_t('Connect Google Analytics'),$content:QWeb.render('website.ga_dialog_content',{ga_key:this.dashboards_data.visits.ga_client_id,ga_analytics_key:this.dashboards_data.visits.ga_analytics_key,}),buttons:[{text:_t("Save"),classes:'btn-primary',close:true,click:function(){var ga_client_id=dialog.$el.find('input[name="ga_client_id"]').val();var ga_analytics_key=dialog.$el.find('input[name="ga_analytics_key"]').val();self.on_save_ga_client_id(ga_client_id,ga_analytics_key);},},{text:_t("Cancel"),close:true,},],}).open();},on_go_to_website:function(ev){ev.preventDefault();var website=_.findWhere(this.websites,{selected:true});window.location.href=`/website/force/${website.id}`;},on_save_ga_client_id:function(ga_client_id,ga_analytics_key){var self=this;return this._rpc({route:'/website/dashboard/set_ga_data',params:{'website_id':self.website_id,'ga_client_id':ga_client_id,'ga_analytics_key':ga_analytics_key,},}).then(function(result){if(result.error){self.do_warn(result.error.title,result.error.message);return;}
self.on_date_range_button('week');});},render_dashboards:function(){var self=this;_.each(this.dashboards_templates,function(template){self.$('.o_website_dashboard').append(QWeb.render(template,{widget:self}));});},render_graph:function(div_to_display,chart_values,chart_id){var self=this;this.$(div_to_display).empty();var $canvasContainer=$('<div/>',{class:'o_graph_canvas_container'});this.$canvas=$('<canvas/>').attr('id',chart_id);$canvasContainer.append(this.$canvas);this.$(div_to_display).append($canvasContainer);var labels=chart_values[0].values.map(function(date){return moment(date[0],"YYYY-MM-DD",'en');});var datasets=chart_values.map(function(group,index){return{label:group.key,data:group.values.map(function(value){return value[1];}),dates:group.values.map(function(value){return value[0];}),fill:false,borderColor:COLORS[index],};});var ctx=this.$canvas[0];this.chart=new Chart(ctx,{type:'line',data:{labels:labels,datasets:datasets,},options:{legend:{display:false,},maintainAspectRatio:false,scales:{yAxes:[{type:'linear',ticks:{beginAtZero:true,callback:this.formatValue.bind(this),},}],xAxes:[{ticks:{callback:function(moment){return moment.format(self.DATE_FORMAT);},}}],},tooltips:{mode:'index',intersect:false,bodyFontColor:'rgba(0,0,0,1)',titleFontSize:13,titleFontColor:'rgba(0,0,0,1)',backgroundColor:'rgba(255,255,255,0.6)',borderColor:'rgba(0,0,0,0.2)',borderWidth:2,callbacks:{title:function(tooltipItems,data){return data.datasets[0].label;},label:function(tooltipItem,data){var moment=data.labels[tooltipItem.index];var date=tooltipItem.datasetIndex===0?moment:moment.subtract(1,self.date_range);return date.format(self.DATE_FORMAT)+': '+self.formatValue(tooltipItem.yLabel);},labelColor:function(tooltipItem,chart){var dataset=chart.data.datasets[tooltipItem.datasetIndex];return{borderColor:dataset.borderColor,backgroundColor:dataset.borderColor,};},}}}});},render_graphs:function(){var self=this;if(this._isInDom){_.each(this.graphs,function(e){var renderGraph=self.groups[e.group]&&self.dashboards_data[e.name].summary.order_count;if(!self.chartIds[e.name]){self.chartIds[e.name]=_.uniqueId('chart_'+e.name);}
var chart_id=self.chartIds[e.name];if(renderGraph){self.render_graph('.o_graph_'+e.name,self.dashboards_data[e.name].graph,chart_id);}});this.render_graph_analytics(this.dashboards_data.visits.ga_client_id);}},render_graph_analytics:function(client_id){if(!this.dashboards_data.visits||!this.dashboards_data.visits.ga_client_id){return;}
this.load_analytics_api();var $analytics_components=this.$('.js_analytics_components');this.addLoader($analytics_components);var self=this;gapi.analytics.ready(function(){$analytics_components.empty();var $analytics_auth=$('<div>').addClass('col-lg-12');window.onOriginError=function(){$analytics_components.find('.js_unauthorized_message').remove();self.display_unauthorized_message($analytics_components,'not_initialized');};gapi.analytics.auth.authorize({container:$analytics_auth[0],clientid:client_id});$analytics_auth.appendTo($analytics_components);self.handle_analytics_auth($analytics_components);gapi.analytics.auth.on('signIn',function(){delete window.onOriginError;self.handle_analytics_auth($analytics_components);});});},on_date_range_button:function(date_range){if(date_range==='week'){this.date_range='week';this.date_from=moment.utc().subtract(1,'weeks');}else if(date_range==='month'){this.date_range='month';this.date_from=moment.utc().subtract(1,'months');}else if(date_range==='year'){this.date_range='year';this.date_from=moment.utc().subtract(1,'years');}else{console.log('Unknown date range. Choose between [week, month, year]');return;}
var self=this;Promise.resolve(this.fetch_data()).then(function(){self.$('.o_website_dashboard').empty();self.render_dashboards();self.render_graphs();});},on_website_button:function(website_id){var self=this;this.website_id=website_id;Promise.resolve(this.fetch_data()).then(function(){self.$('.o_website_dashboard').empty();self.render_dashboards();self.render_graphs();});},on_reverse_breadcrumb:function(){var self=this;web_client.do_push_state({});this.fetch_data().then(function(){self.$('.o_website_dashboard').empty();self.render_dashboards();self.render_graphs();});},on_dashboard_action:function(ev){ev.preventDefault();var self=this
var $action=$(ev.currentTarget);var additional_context={};if(this.date_range==='week'){additional_context={search_default_week:true};}else if(this.date_range==='month'){additional_context={search_default_month:true};}else if(this.date_range==='year'){additional_context={search_default_year:true};}
this._rpc({route:'/web/action/load',params:{'action_id':$action.attr('name'),},}).then(function(action){action.domain=pyUtils.assembleDomains([action.domain,`[('website_id', '=', ${self.website_id})]`]);return self.do_action(action,{'additional_context':additional_context,'on_reverse_breadcrumb':self.on_reverse_breadcrumb});});},on_dashboard_action_form:function(ev){ev.preventDefault();var $action=$(ev.currentTarget);this.do_action({name:$action.attr('name'),res_model:$action.data('res_model'),res_id:$action.data('res_id'),views:[[false,'form']],type:'ir.actions.act_window',},{on_reverse_breadcrumb:this.on_reverse_breadcrumb});},_computeControlPanelProps(){const $searchview=$(QWeb.render("website.DateRangeButtons",{widget:this,}));$searchview.find('button.js_date_range').click((ev)=>{$searchview.find('button.js_date_range.active').removeClass('active');$(ev.target).addClass('active');this.on_date_range_button($(ev.target).data('date'));});$searchview.find('button.js_website').click((ev)=>{$searchview.find('button.js_website.active').removeClass('active');$(ev.target).addClass('active');this.on_website_button($(ev.target).data('website-id'));});const $buttons=$(QWeb.render("website.GoToButtons"));$buttons.on('click',this.on_go_to_website.bind(this));this.controlPanelProps.cp_content={$searchview,$buttons};},load_analytics_api:function(){var self=this;if(!("gapi"in window)){(function(w,d,s,g,js,fjs){g=w.gapi||(w.gapi={});g.analytics={q:[],ready:function(cb){this.q.push(cb);}};js=d.createElement(s);fjs=d.getElementsByTagName(s)[0];js.src='https://apis.google.com/js/platform.js';fjs.parentNode.insertBefore(js,fjs);js.onload=function(){g.load('analytics');};}(window,document,'script'));gapi.analytics.ready(function(){self.analytics_create_components();});}},handle_analytics_auth:function($analytics_components){$analytics_components.find('.js_unauthorized_message').remove();if(!gapi.analytics.auth.getAuthResponse()){this.display_unauthorized_message($analytics_components,'not_connected');}else if(gapi.analytics.auth.getAuthResponse()&&gapi.analytics.auth.getAuthResponse().scope.indexOf('https://www.googleapis.com/auth/analytics')===-1){this.display_unauthorized_message($analytics_components,'no_right');}else{this.make_analytics_calls($analytics_components);}},display_unauthorized_message:function($analytics_components,reason){$analytics_components.prepend($(QWeb.render('website.unauthorized_analytics',{reason:reason})));},make_analytics_calls:function($analytics_components){var $analytics_users=$('<div>');var activeUsers=new gapi.analytics.ext.ActiveUsers({container:$analytics_users[0],pollingInterval:10,});$analytics_users.appendTo($analytics_components);var $analytics_view_selector=$('<div>').addClass('col-lg-12 o_properties_selection');var viewSelector=new gapi.analytics.ViewSelector({container:$analytics_view_selector[0],});viewSelector.execute();$analytics_view_selector.appendTo($analytics_components);var start_date='7daysAgo';if(this.date_range==='month'){start_date='30daysAgo';}else if(this.date_range==='year'){start_date='365daysAgo';}
var $analytics_chart_2=$('<div>').addClass('col-lg-6 col-12');var breakdownChart=new gapi.analytics.googleCharts.DataChart({query:{'dimensions':'ga:date','metrics':'ga:sessions','start-date':start_date,'end-date':'yesterday'},chart:{type:'LINE',container:$analytics_chart_2[0],options:{title:'All',width:'100%',tooltip:{isHtml:true},}}});$analytics_chart_2.appendTo($analytics_components);var $analytics_chart_1=$('<div>').addClass('col-lg-6 col-12');var mainChart=new gapi.analytics.googleCharts.DataChart({query:{'dimensions':'ga:medium','metrics':'ga:sessions','sort':'-ga:sessions','max-results':'6'},chart:{type:'TABLE',container:$analytics_chart_1[0],options:{width:'100%'}}});$analytics_chart_1.appendTo($analytics_components);var table_row_listener;viewSelector.on('change',function(ids){var options={query:{ids:ids}};activeUsers.set({ids:ids}).execute();mainChart.set(options).execute();breakdownChart.set(options).execute();if(table_row_listener){google.visualization.events.removeListener(table_row_listener);}});mainChart.on('success',function(response){var chart=response.chart;var dataTable=response.dataTable;table_row_listener=google.visualization.events.addListener(chart,'select',function(){var options;if(chart.getSelection().length){var row=chart.getSelection()[0].row;var medium=dataTable.getValue(row,0);options={query:{filters:'ga:medium=='+medium,},chart:{options:{title:medium,}}};}else{options={chart:{options:{title:'All',}}};delete breakdownChart.get().query.filters;}
breakdownChart.set(options).execute();});});activeUsers.once('success',function(){var element=this.container.firstChild;var timeout;this.on('change',function(data){element=this.container.firstChild;var animationClass=data.delta>0?'is-increasing':'is-decreasing';element.className+=(' '+animationClass);clearTimeout(timeout);timeout=setTimeout(function(){element.className=element.className.replace(/ is-(increasing|decreasing)/g,'');},3000);});});},analytics_create_components:function(){gapi.analytics.createComponent('ActiveUsers',{initialize:function(){this.activeUsers=0;gapi.analytics.auth.once('signOut',this.handleSignOut_.bind(this));},execute:function(){if(this.polling_){this.stop();}
this.render_();if(gapi.analytics.auth.isAuthorized()){this.pollActiveUsers_();}else{gapi.analytics.auth.once('signIn',this.pollActiveUsers_.bind(this));}},stop:function(){clearTimeout(this.timeout_);this.polling_=false;this.emit('stop',{activeUsers:this.activeUsers});},render_:function(){var opts=this.get();this.container=typeof opts.container==='string'?document.getElementById(opts.container):opts.container;this.container.innerHTML=opts.template||this.template;this.container.querySelector('b').innerHTML=this.activeUsers;},pollActiveUsers_:function(){var options=this.get();var pollingInterval=(options.pollingInterval||5)*1000;if(isNaN(pollingInterval)||pollingInterval<5000){throw new Error('Frequency must be 5 seconds or more.');}
this.polling_=true;gapi.client.analytics.data.realtime.get({ids:options.ids,metrics:'rt:activeUsers'}).then(function(response){var result=response.result;var newValue=result.totalResults?+result.rows[0][0]:0;var oldValue=this.activeUsers;this.emit('success',{activeUsers:this.activeUsers});if(newValue!==oldValue){this.activeUsers=newValue;this.onChange_(newValue-oldValue);}
if(this.polling_){this.timeout_=setTimeout(this.pollActiveUsers_.bind(this),pollingInterval);}}.bind(this));},onChange_:function(delta){var valueContainer=this.container.querySelector('b');if(valueContainer){valueContainer.innerHTML=this.activeUsers;}
this.emit('change',{activeUsers:this.activeUsers,delta:delta});if(delta>0){this.emit('increase',{activeUsers:this.activeUsers,delta:delta});}else{this.emit('decrease',{activeUsers:this.activeUsers,delta:delta});}},handleSignOut_:function(){this.stop();gapi.analytics.auth.once('signIn',this.handleSignIn_.bind(this));},handleSignIn_:function(){this.pollActiveUsers_();gapi.analytics.auth.once('signOut',this.handleSignOut_.bind(this));},template:'<div class="ActiveUsers">'+'Active Users: <b class="ActiveUsers-value"></b>'+'</div>'});},addLoader:function(selector){var loader='<span class="fa fa-3x fa-spin fa-spinner fa-pulse"/>';selector.html("<div class='o_loader'>"+loader+"</div>");},getValue:function(d){return d[1];},format_number:function(value,type,digits,symbol){if(type==='currency'){return this.render_monetary_field(value,this.currency_id);}else{return field_utils.format[type](value||0,{digits:digits})+' '+symbol;}},formatValue:function(value){var formatter=field_utils.format.float;var formatedValue=formatter(value,undefined,FORMAT_OPTIONS);return formatedValue;},render_monetary_field:function(value,currency_id){var currency=session.get_currency(currency_id);var formatted_value=field_utils.format.float(value||0,{digits:currency&&currency.digits});if(currency){if(currency.position==="after"){formatted_value+=currency.symbol;}else{formatted_value=currency.symbol+formatted_value;}}
return formatted_value;},});core.action_registry.add('backend_dashboard',Dashboard);return Dashboard;});;

/* /website/static/src/js/backend/res_config_settings.js defined in bundle 'web.assets_backend' */
odoo.define('website.settings',function(require){const BaseSettingController=require('base.settings').Controller;const core=require('web.core');const Dialog=require('web.Dialog');const FieldBoolean=require('web.basic_fields').FieldBoolean;const fieldRegistry=require('web.field_registry');const FormController=require('web.FormController');const QWeb=core.qweb;const _t=core._t;BaseSettingController.include({_onButtonClicked:function(ev){if(ev.data.attrs.name==='website_go_to'||ev.data.attrs.name==='action_open_robots'||ev.data.attrs.name==='action_ping_sitemap'||ev.data.attrs.name==='install_theme_on_current_website'){FormController.prototype._onButtonClicked.apply(this,arguments);}else{this._super.apply(this,arguments);}},});const WebsiteCookiesbarField=FieldBoolean.extend({xmlDependencies:['/website/static/src/xml/website.res_config_settings.xml'],_onChange:function(){const checked=this.$input[0].checked;if(!checked){return this._setValue(checked);}
const cancelCallback=()=>this.$input[0].checked=!checked;Dialog.confirm(this,null,{title:_t("Please confirm"),$content:QWeb.render('website.res_config_settings.cookies_modal_main'),buttons:[{text:_t('Do not activate'),classes:'btn-primary',close:true,click:cancelCallback,},{text:_t('Activate anyway'),close:true,click:()=>this._setValue(checked),}],cancel_callback:cancelCallback,});},});fieldRegistry.add('website_cookiesbar_field',WebsiteCookiesbarField);});;

/* /website/static/src/js/widget_iframe.js defined in bundle 'web.assets_backend' */
odoo.define('website.iframe_widget',function(require){"use strict";var AbstractField=require('web.AbstractField');var core=require('web.core');var fieldRegistry=require('web.field_registry');var QWeb=core.qweb;var FieldIframePreview=AbstractField.extend({className:'d-block o_field_iframe_preview m-0 h-100',_render:function(){this.$el.html(QWeb.render('website.iframeWidget',{url:this.value,}));},});fieldRegistry.add('iframe',FieldIframePreview);return FieldIframePreview;});;

/* /website/static/src/js/theme_preview_kanban.js defined in bundle 'web.assets_backend' */
odoo.define('website.theme_preview_kanban',function(require){"use strict";var KanbanController=require('web.KanbanController');var KanbanView=require('web.KanbanView');var ViewRegistry=require('web.view_registry');const ThemePreviewControllerCommon=require('website.theme_preview_form').ThemePreviewControllerCommon;var core=require('web.core');var _lt=core._lt;var ThemePreviewKanbanController=KanbanController.extend(ThemePreviewControllerCommon,{start:async function(){await this._super(...arguments);this.el.classList.add('o_view_kanban_theme_preview_controller');const websiteLink=Object.assign(document.createElement('a'),{className:'btn btn-secondary ml-3 text-black-75',href:'/',innerHTML:'<i class="fa fa-close"></i>',});const smallBreadcumb=Object.assign(document.createElement('small'),{className:'mx-2 text-muted',innerHTML:_lt("Don't worry, you can switch later."),});this._controlPanelWrapper.el.querySelector('.o_cp_top .breadcrumb li.active').classList.add('text-black-75');this._controlPanelWrapper.el.querySelector('.o_cp_top').appendChild(websiteLink);this._controlPanelWrapper.el.querySelector('.o_cp_top li').appendChild(smallBreadcumb);},_onButtonClicked:function(ev){const attrName=ev.data.attrs.name;if(attrName==='button_choose_theme'||attrName==='button_refresh_theme'){this._handleThemeAction(ev.data.record.res_id,attrName);}else{this._super(...arguments);}},});var ThemePreviewKanbanView=KanbanView.extend({withSearchBar:false,config:_.extend({},KanbanView.prototype.config,{Controller:ThemePreviewKanbanController,}),});ViewRegistry.add('theme_preview_kanban',ThemePreviewKanbanView);});;

/* /website/static/src/js/theme_preview_form.js defined in bundle 'web.assets_backend' */
odoo.define('website.theme_preview_form',function(require){"use strict";var FormController=require('web.FormController');var FormView=require('web.FormView');var viewRegistry=require('web.view_registry');var core=require('web.core');var qweb=core.qweb;const ThemePreviewControllerCommon={_handleThemeAction(res_id,action){this.$loader=$(qweb.render('website.ThemePreview.Loader',{'showTips':action!=='button_refresh_theme',}));let actionCallback=undefined;this._addLoader();switch(action){case'button_choose_theme':actionCallback=result=>this.do_action(result);break;case'button_refresh_theme':actionCallback=()=>this._removeLoader();break;}
const rpcData={model:'ir.module.module',method:action,args:[res_id],context:this.initialState.context,};const rpcOptions={shadow:true,};this._rpc(rpcData,rpcOptions).then(actionCallback).guardedCatch(()=>this._removeLoader());},_addLoader(){$('body').append(this.$loader);},_removeLoader(){this.$loader.remove();}};var ThemePreviewController=FormController.extend(ThemePreviewControllerCommon,{events:Object.assign({},FormController.prototype.events,{'click .o_use_theme':'_onStartNowClick','click .o_switch_theme':'_onSwitchThemeClick','change input[name="viewer"]':'_onSwitchButtonChange',}),start:function(){this.$el.addClass('o_view_form_theme_preview_controller');return this._super.apply(this,arguments);},renderButtons:function($node){this.$buttons=$(qweb.render('website.ThemePreview.Buttons'));if($node){$node.html(this.$buttons);}},updateButtons:function(){},_updateControlPanelProps:async function(){const props=this._super(...arguments);const $switchModeButton=$(qweb.render('website.ThemePreview.SwitchModeButton'));this.controlPanelProps.cp_content.$pager=$switchModeButton;return props;},_onSwitchButtonChange:function(){this.$('.o_preview_frame').toggleClass('is_mobile');},_onSwitchThemeClick:function(){this.trigger_up('history_back');},_onStartNowClick:function(){this._handleThemeAction(this.getSelectedIds()[0],'button_choose_theme');},});var ThemePreviewFormView=FormView.extend({config:_.extend({},FormView.prototype.config,{Controller:ThemePreviewController}),});viewRegistry.add('theme_preview_form',ThemePreviewFormView);return{ThemePreviewControllerCommon:ThemePreviewControllerCommon}});;

/* /mass_mailing/static/src/js/mass_mailing.js defined in bundle 'web.assets_backend' */
odoo.define('mass_mailing.mass_mailing',function(require){"use strict";var KanbanColumn=require('web.KanbanColumn');KanbanColumn.include({init:function(){this._super.apply(this,arguments);if(this.modelName==='mailing.mailing'){this.draggable=false;}},});});;

/* /mass_mailing/static/src/js/mass_mailing_widget.js defined in bundle 'web.assets_backend' */
odoo.define('mass_mailing.FieldHtml',function(require){'use strict';var config=require('web.config');var core=require('web.core');var FieldHtml=require('web_editor.field.html');var fieldRegistry=require('web.field_registry');var convertInline=require('web_editor.convertInline');var _t=core._t;var MassMailingFieldHtml=FieldHtml.extend({xmlDependencies:(FieldHtml.prototype.xmlDependencies||[]).concat(["/mass_mailing/static/src/xml/mass_mailing.xml"]),jsLibs:['/mass_mailing/static/src/js/mass_mailing_link_dialog_fix.js',],custom_events:_.extend({},FieldHtml.prototype.custom_events,{snippets_loaded:'_onSnippetsLoaded',}),init:function(){this._super.apply(this,arguments);if(!this.nodeOptions.snippets){this.nodeOptions.snippets='mass_mailing.email_designer_snippets';}
this.__extraAssetsForIframe=[{jsLibs:['/mass_mailing/static/src/js/mass_mailing_snippets.js'],}];},commitChanges:function(){var self=this;if(config.isDebug()&&this.mode==='edit'){var layoutInfo=$.summernote.core.dom.makeLayoutInfo(this.wysiwyg.$editor);$.summernote.pluginEvents.codeview(undefined,undefined,layoutInfo,false);}
if(this.mode==='readonly'||!this.isRendered){return this._super();}
var fieldName=this.nodeOptions['inline-field'];if(this.$content.find('.o_basic_theme').length){this.$content.find('*').css('font-family','');}
var $editable=this.wysiwyg.getEditable();return this.wysiwyg.saveModifiedImages(this.$content).then(function(){return self.wysiwyg.save().then(function(result){self._isDirty=result.isDirty;convertInline.attachmentThumbnailToLinkImg($editable);convertInline.fontToImg($editable);convertInline.classToStyle($editable);_.each(['width','height'],function(attribute){$editable.find('img[style*="width"], img[style*="height"]').attr(attribute,function(){return $(this)[attribute]();}).css(attribute,function(){return $(this).get(0).style[attribute]||'auto';});});self.trigger_up('field_changed',{dataPointID:self.dataPointID,changes:_.object([fieldName],[self._unWrap($editable.html())])});self.wysiwyg.setValue(result.html);if(self._isDirty&&self.mode==='edit'){return self._doAction();}});});},getDatarecord:function(){return _.omit(this._super(),['mailing_domain','contact_list_ids','body_html','attachment_ids']);},_checkIfMustForceThemeChoice:function(){var firstChoice=this._editableAreaIsEmpty();this.$content.closest('body').toggleClass("o_force_mail_theme_choice",firstChoice);return firstChoice;},_editableAreaIsEmpty:function($layout){$layout=$layout||this.$content.find(".o_layout");var $mailWrapper=$layout.children(".o_mail_wrapper");var $mailWrapperContent=$mailWrapper.find('.o_mail_wrapper_td');if(!$mailWrapperContent.length){$mailWrapperContent=$mailWrapper;}
var value;if($mailWrapperContent.length>0){value=$mailWrapperContent.html();}else if($layout.length){value=$layout.html();}else{value=this.wysiwyg.getValue();}
var blankEditable="<p><br></p>";return value===""||value===blankEditable;},_renderEdit:function(){this._isFromInline=!!this.value;if(!this.value){this.value=this.recordData[this.nodeOptions['inline-field']];}
return this._super.apply(this,arguments);},_renderReadonly:function(){this.value=this.recordData[this.nodeOptions['inline-field']];return this._super.apply(this,arguments);},_renderTranslateButton:function(){var fieldName=this.nodeOptions['inline-field'];if(_t.database.multi_lang&&this.record.fields[fieldName].translate&&this.res_id){return $('<button>',{type:'button','class':'o_field_translate fa fa-globe btn btn-link',}).on('click',this._onTranslate.bind(this));}
return $();},_getSelectedTheme:function(themesParams){var $layout=this.$content.find(".o_layout");var selectedTheme=false;if($layout.length!==0){_.each(themesParams,function(themeParams){if($layout.hasClass(themeParams.className)){selectedTheme=themeParams;}});}
return selectedTheme;},_switchImages:function(themeParams,$container){if(!themeParams){return;}
$container.find("img").each(function(){var $img=$(this);var src=$img.attr("src");var m=src.match(/^\/web\/image\/\w+\.s_default_image_(?:theme_[a-z]+_)?(.+)$/);if(!m){m=src.match(/^\/\w+\/static\/src\/img\/(?:theme_[a-z]+\/)?s_default_image_(.+)\.[a-z]+$/);}
if(!m){return;}
var file=m[1];var img_info=themeParams.get_image_info(file);if(img_info.format){src="/"+img_info.module+"/static/src/img/theme_"+themeParams.name+"/s_default_image_"+file+"."+img_info.format;}else{src="/web/image/"+img_info.module+".s_default_image_theme_"+themeParams.name+"_"+file;}
$img.attr("src",src);});},_switchThemes:function(firstChoice,themeParams){if(!themeParams||this.switchThemeLast===themeParams){return;}
this.switchThemeLast=themeParams;this.$content.closest('body').removeClass(this._allClasses).addClass(themeParams.className);var $old_layout=this.$content.find('.o_layout');var $new_wrapper;var $newWrapperContent;if(themeParams.nowrap){$new_wrapper=$('<div/>',{class:'oe_structure'});$newWrapperContent=$new_wrapper;}else{$new_wrapper=$('<table/>',{class:'o_mail_wrapper'});$newWrapperContent=$('<td/>',{class:'o_mail_no_options o_mail_wrapper_td oe_structure'});$new_wrapper.append($('<tr/>').append($('<td/>',{class:'o_mail_no_resize o_not_editable',contenteditable:'false'}),$newWrapperContent,$('<td/>',{class:'o_mail_no_resize o_not_editable',contenteditable:'false'})));}
var $newLayout=$('<div/>',{class:'o_layout '+themeParams.className}).append($new_wrapper);var $contents;if(firstChoice){$contents=themeParams.template;}else if($old_layout.length){$contents=($old_layout.hasClass('oe_structure')?$old_layout:$old_layout.find('.oe_structure').first()).contents();}else{$contents=this.$content.find('.o_editable').contents();}
$newWrapperContent.append($contents);this._switchImages(themeParams,$newWrapperContent);this.$content.find('.o_editable').empty().append($newLayout);$old_layout.remove();if(firstChoice){$newWrapperContent.find('*').addBack().contents().filter(function(){return this.nodeType===3&&this.textContent.match(/\S/);}).parent().addClass('o_default_snippet_text');if(themeParams.name=='basic'){this.$content.focusIn();}}
this.wysiwyg.trigger('reload_snippet_dropzones');},_onLoadWysiwyg:function(){if(this._isFromInline){this._fromInline();}
if(this.snippetsLoaded){this._onSnippetsLoaded(this.snippetsLoaded);}
this._super();},_onSnippetsLoaded:function(ev){var self=this;if(!this.$content){this.snippetsLoaded=ev;return;}
var $snippetsSideBar=ev.data;var $themes=$snippetsSideBar.find("#email_designer_themes").children();var $snippets=$snippetsSideBar.find(".oe_snippet");var $snippets_menu=$snippetsSideBar.find("#snippets_menu");if(config.device.isMobile){$snippetsSideBar.hide();this.$content.attr('style','padding-left: 0px !important');}
if($themes.length===0){return;}
this._allClasses="";var themesParams=_.map($themes,function(theme){var $theme=$(theme);var name=$theme.data("name");var classname="o_"+name+"_theme";self._allClasses+=" "+classname;var imagesInfo=_.defaults($theme.data("imagesInfo")||{},{all:{}});_.each(imagesInfo,function(info){info=_.defaults(info,imagesInfo.all,{module:"mass_mailing",format:"jpg"});});return{name:name,className:classname||"",img:$theme.data("img")||"",template:$theme.html().trim(),nowrap:!!$theme.data('nowrap'),get_image_info:function(filename){if(imagesInfo[filename]){return imagesInfo[filename];}
return imagesInfo.all;}};});$themes.parent().remove();var $dropdown=$(core.qweb.render("mass_mailing.theme_selector",{themes:themesParams})).dropdown();var firstChoice=this._checkIfMustForceThemeChoice();var $mail_themes_upgrade=$dropdown.find(".o_mass_mailing_themes_upgrade");$mail_themes_upgrade.on("click",function(e){e.stopImmediatePropagation();e.preventDefault();self.do_action("mass_mailing.action_mass_mailing_configuration");});var selectedTheme=false;$dropdown.on("mouseenter",".dropdown-item",function(e){if(firstChoice){return;}
e.preventDefault();var themeParams=themesParams[$(e.currentTarget).index()];self._switchThemes(firstChoice,themeParams);});$dropdown.on("mouseleave",".dropdown-item",function(e){self._switchThemes(false,selectedTheme);});$dropdown.on("click",'[data-toggle="dropdown"]',function(e){var $menu=$dropdown.find('.dropdown-menu');var isVisible=$menu.hasClass('show');if(isVisible){e.preventDefault();e.stopImmediatePropagation();$menu.removeClass('show');}});$dropdown.on("click",".dropdown-item",function(e){e.preventDefault();e.stopImmediatePropagation();var themeParams=themesParams[$(e.currentTarget).index()];if(firstChoice){self._switchThemes(firstChoice,themeParams);self.$content.closest('body').removeClass("o_force_mail_theme_choice");firstChoice=false;if($mail_themes_upgrade.length){$dropdown.remove();$snippets_menu.empty();}}
self._switchImages(themeParams,$snippets);selectedTheme=themeParams;self.wysiwyg.getEditable().trigger('change');$dropdown.find('.dropdown-menu').removeClass('show');$dropdown.find('.dropdown-item.selected').removeClass('selected');$dropdown.find('.dropdown-item:eq('+themesParams.indexOf(selectedTheme)+')').addClass('selected');});$dropdown.on("shown.bs.dropdown",function(){selectedTheme=self._getSelectedTheme(themesParams);$dropdown.find(".dropdown-item").removeClass("selected").filter(function(){return($(this).has(".o_thumb[style=\""+"background-image: url("+(selectedTheme&&selectedTheme.img)+"_small.png)"+"\"]").length>0);}).addClass("selected");});$dropdown.on("hidden.bs.dropdown",function(){self._switchThemes(firstChoice,selectedTheme);});selectedTheme=this._getSelectedTheme(themesParams);if(selectedTheme){this.$content.closest('body').addClass(selectedTheme.className);$dropdown.find('.dropdown-item:eq('+themesParams.indexOf(selectedTheme)+')').addClass('selected');this._switchImages(selectedTheme,$snippets);}else if(this.$content.find('.o_layout').length){themesParams.push({name:'o_mass_mailing_no_theme',className:'o_mass_mailing_no_theme',img:"",template:this.$content.find('.o_layout').addClass('o_mass_mailing_no_theme').clone().find('oe_structure').empty().end().html().trim(),nowrap:true,get_image_info:function(){}});selectedTheme=this._getSelectedTheme(themesParams);}
$dropdown.insertAfter($snippets_menu);},_onTranslate:function(ev){this.trigger_up('translate',{fieldName:this.nodeOptions['inline-field'],id:this.dataPointID,isComingFromTranslationAlert:false,});},});fieldRegistry.add('mass_mailing_html',MassMailingFieldHtml);return MassMailingFieldHtml;});;

/* /mass_mailing/static/src/js/mass_mailing_list_kanban_record.js defined in bundle 'web.assets_backend' */
odoo.define('mass_mailing.ListKanbanRecord',function(require){"use strict";var KanbanRecord=require('web.KanbanRecord');var MassMailingListKanbanRecord=KanbanRecord.extend({_openRecord:function(){this.$('.o_mailing_list_kanban_boxes a').first().click();}});return MassMailingListKanbanRecord;});;

/* /mass_mailing/static/src/js/mass_mailing_list_kanban_renderer.js defined in bundle 'web.assets_backend' */
odoo.define('mass_mailing.ListKanbanRenderer',function(require){"use strict";var MassMailingListKanbanRecord=require('mass_mailing.ListKanbanRecord');var KanbanRenderer=require('web.KanbanRenderer');var MassMailingListKanbanRenderer=KanbanRenderer.extend({config:_.extend({},KanbanRenderer.prototype.config,{KanbanRecord:MassMailingListKanbanRecord,})});return MassMailingListKanbanRenderer;});;

/* /mass_mailing/static/src/js/mass_mailing_list_kanban_view.js defined in bundle 'web.assets_backend' */
odoo.define('mass_mailing.ListKanbanView',function(require){"use strict";var MassMailingListKanbanRenderer=require('mass_mailing.ListKanbanRenderer');var KanbanView=require('web.KanbanView');var view_registry=require('web.view_registry');var MassMailingListKanbanView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Renderer:MassMailingListKanbanRenderer,}),});view_registry.add('mass_mailing_list_kanban',MassMailingListKanbanView);return MassMailingListKanbanView;});;

/* /mass_mailing/static/src/js/unsubscribe.js defined in bundle 'web.assets_backend' */
odoo.define('mass_mailing.unsubscribe',function(require){'use strict';var session=require('web.session');var ajax=require('web.ajax');var core=require('web.core');require('web.dom_ready');var _t=core._t;var email=$("input[name='email']").val();var mailing_id=parseInt($("input[name='mailing_id']").val());var res_id=parseInt($("input[name='res_id']").val());var token=(location.search.split('token'+'=')[1]||'').split('&')[0];if(!$('.o_unsubscribe_form').length){return Promise.reject("DOM doesn't contain '.o_unsubscribe_form'");}
session.load_translations().then(function(){if(email!=''&&email!=undefined){ajax.jsonRpc('/mailing/blacklist/check','call',{'email':email,'mailing_id':mailing_id,'res_id':res_id,'token':token}).then(function(result){if(result=='unauthorized'){$('#button_add_blacklist').hide();$('#button_remove_blacklist').hide();}
else if(result==true){$('#button_remove_blacklist').show();toggle_opt_out_section(false);}
else if(result==false){$('#button_add_blacklist').show();toggle_opt_out_section(true);}
else{$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-warning').addClass('alert-error');}}).guardedCatch(function(){$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-warning').addClass('alert-error');});}
else{$('#div_blacklist').hide();}
var unsubscribed_list=$("input[name='unsubscribed_list']").val();if(unsubscribed_list){$('#subscription_info').html(_.str.sprintf(_t("You have been <strong>successfully unsubscribed from %s</strong>."),_.escape(unsubscribed_list)));}
else{$('#subscription_info').html(_t('You have been <strong>successfully unsubscribed</strong>.'));}});$('#unsubscribe_form').on('submit',function(e){e.preventDefault();var checked_ids=[];$("input[type='checkbox']:checked").each(function(i){checked_ids[i]=parseInt($(this).val());});var unchecked_ids=[];$("input[type='checkbox']:not(:checked)").each(function(i){unchecked_ids[i]=parseInt($(this).val());});ajax.jsonRpc('/mail/mailing/unsubscribe','call',{'opt_in_ids':checked_ids,'opt_out_ids':unchecked_ids,'email':email,'mailing_id':mailing_id,'res_id':res_id,'token':token}).then(function(result){if(result=='unauthorized'){$('#subscription_info').html(_t('You are not authorized to do this!'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-error').addClass('alert-warning');}
else if(result==true){$('#subscription_info').html(_t('Your changes have been saved.'));$('#info_state').removeClass('alert-info').addClass('alert-success');}
else{$('#subscription_info').html(_t('An error occurred. Your changes have not been saved, try again later.'));$('#info_state').removeClass('alert-info').addClass('alert-warning');}}).guardedCatch(function(){$('#subscription_info').html(_t('An error occurred. Your changes have not been saved, try again later.'));$('#info_state').removeClass('alert-info').addClass('alert-warning');});});$('#button_add_blacklist').click(function(e){e.preventDefault();ajax.jsonRpc('/mailing/blacklist/add','call',{'email':email,'mailing_id':mailing_id,'res_id':res_id,'token':token}).then(function(result){if(result=='unauthorized'){$('#subscription_info').html(_t('You are not authorized to do this!'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-error').addClass('alert-warning');}
else
{if(result){$('#subscription_info').html(_t('You have been successfully <strong>added to our blacklist</strong>. '
+'You will not be contacted anymore by our services.'));$('#info_state').removeClass('alert-warning').removeClass('alert-info').removeClass('alert-error').addClass('alert-success');toggle_opt_out_section(false);}
else{$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-warning').addClass('alert-error');}
$('#button_add_blacklist').hide();$('#button_remove_blacklist').show();$('#unsubscribed_info').hide();}}).guardedCatch(function(){$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-warning').addClass('alert-error');});});$('#button_remove_blacklist').click(function(e){e.preventDefault();ajax.jsonRpc('/mailing/blacklist/remove','call',{'email':email,'mailing_id':mailing_id,'res_id':res_id,'token':token}).then(function(result){if(result=='unauthorized'){$('#subscription_info').html(_t('You are not authorized to do this!'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-error').addClass('alert-warning');}
else
{if(result){$('#subscription_info').html(_t("You have been successfully <strong>removed from our blacklist</strong>. "
+"You are now able to be contacted by our services."));$('#info_state').removeClass('alert-warning').removeClass('alert-info').removeClass('alert-error').addClass('alert-success');toggle_opt_out_section(true);}
else{$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-warning').addClass('alert-error');}
$('#button_add_blacklist').show();$('#button_remove_blacklist').hide();$('#unsubscribed_info').hide();}}).guardedCatch(function(){$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-warning').addClass('alert-error');});});$('#button_feedback').click(function(e){var feedback=$("textarea[name='opt_out_feedback']").val();e.preventDefault();ajax.jsonRpc('/mailing/feedback','call',{'mailing_id':mailing_id,'res_id':res_id,'email':email,'feedback':feedback,'token':token}).then(function(result){if(result=='unauthorized'){$('#subscription_info').html(_t('You are not authorized to do this!'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-error').addClass('alert-warning');}
else if(result==true){$('#subscription_info').html(_t('Thank you! Your feedback has been sent successfully!'));$('#info_state').removeClass('alert-warning').removeClass('alert-info').removeClass('alert-error').addClass('alert-success');$("#div_feedback").hide();}
else{$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-success').removeClass('alert-info').removeClass('alert-error').addClass('alert-warning');}}).guardedCatch(function(){$('#subscription_info').html(_t('An error occured. Please try again later or contact us.'));$('#info_state').removeClass('alert-info').removeClass('alert-success').removeClass('alert-error').addClass('alert-warning');});});});function toggle_opt_out_section(value){var result=!value;$("#div_opt_out").find('*').attr('disabled',result);$("#button_add_blacklist").attr('disabled',false);$("#button_remove_blacklist").attr('disabled',false);if(value){$('[name="button_subscription"]').addClass('clickable');}
else{$('[name="button_subscription"]').removeClass('clickable');}};

/* /hr_holidays/static/src/js/time_off_calendar.js defined in bundle 'web.assets_backend' */
odoo.define('hr_holidays.dashboard.view_custo',function(require){'use strict';var core=require('web.core');var CalendarPopover=require('web.CalendarPopover');var CalendarController=require("web.CalendarController");var CalendarRenderer=require("web.CalendarRenderer");var CalendarView=require("web.CalendarView");var viewRegistry=require('web.view_registry');var _t=core._t;var QWeb=core.qweb;var TimeOffCalendarPopover=CalendarPopover.extend({template:'hr_holidays.calendar.popover',init:function(parent,eventInfo){this._super.apply(this,arguments);const state=this.event.extendedProps.record.state;this.canDelete=state&&['validate','refuse'].indexOf(state)===-1;this.canEdit=state!==undefined;this.displayFields=[];if(this.modelName==="hr.leave.report.calendar"){const duration=this.event.extendedProps.record.display_name.split(':').slice(-1);this.display_name=_.str.sprintf(_t("Time Off : %s"),duration);}else{this.display_name=this.event.extendedProps.record.display_name;}},});var TimeOffCalendarController=CalendarController.extend({events:_.extend({},CalendarController.prototype.events,{'click .btn-time-off':'_onNewTimeOff','click .btn-allocation':'_onNewAllocation',}),start:function(){this.$el.addClass('o_timeoff_calendar');return this._super(...arguments);},renderButtons:function($node){this._super.apply(this,arguments);$(QWeb.render('hr_holidays.dashboard.calendar.button',{time_off:_t('New Time Off'),request:_t('New Allocation'),})).appendTo(this.$buttons);if($node){this.$buttons.appendTo($node);}else{this.$('.o_calendar_buttons').replaceWith(this.$buttons);}},_onNewTimeOff:function(){var self=this;this.do_action('hr_holidays.hr_leave_action_my_request',{on_close:function(){self.reload();}});},_onNewAllocation:function(){var self=this;this.do_action({type:'ir.actions.act_window',res_model:'hr.leave.allocation',name:'New Allocation Request',views:[[false,'form']],context:{'form_view_ref':'hr_holidays.hr_leave_allocation_view_form_dashboard'},target:'new',},{on_close:function(){self.reload();}});},});var TimeOffPopoverRenderer=CalendarRenderer.extend({config:_.extend({},CalendarRenderer.prototype.config,{CalendarPopover:TimeOffCalendarPopover,}),_getPopoverParams:function(eventData){let params=this._super.apply(this,arguments);let calendarIcon;let state=eventData.extendedProps.record.state;if(state==='validate'){calendarIcon='fa-calendar-check-o';}else if(state==='refuse'){calendarIcon='fa-calendar-times-o';}else if(state){calendarIcon='fa-calendar-o';}
params['title']=eventData.extendedProps.record.display_name.split(':').slice(0,-1).join(':');params['template']=QWeb.render('hr_holidays.calendar.popover.placeholder',{color:this.getColor(eventData.color_index),calendarIcon:calendarIcon});return params;},_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){self.$el.parent().find('.o_calendar_mini').hide();});},});var TimeOffCalendarRenderer=TimeOffPopoverRenderer.extend({_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){return self._rpc({model:'hr.leave.type',method:'get_days_all_request',context:self.context,});}).then(function(result){self.$el.parent().find('.o_calendar_mini').hide();self.$el.parent().find('.o_timeoff_container').remove();var elem=QWeb.render('hr_holidays.dashboard_calendar_header',{timeoffs:result,});self.$el.before(elem);});},});var TimeOffCalendarView=CalendarView.extend({config:_.extend({},CalendarView.prototype.config,{Controller:TimeOffCalendarController,Renderer:TimeOffCalendarRenderer,}),});var TimeOffCalendarAllView=CalendarView.extend({config:_.extend({},CalendarView.prototype.config,{Renderer:TimeOffPopoverRenderer,}),});viewRegistry.add('time_off_calendar',TimeOffCalendarView);viewRegistry.add('time_off_calendar_all',TimeOffCalendarAllView);});;

/* /hr_holidays/static/src/js/leave_stats_widget.js defined in bundle 'web.assets_backend' */
odoo.define('hr_holidays.LeaveStatsWidget',function(require){"use strict";var time=require('web.time');var Widget=require('web.Widget');var widget_registry=require('web.widget_registry');var LeaveStatsWidget=Widget.extend({template:'hr_holidays.leave_stats',init:function(parent,params){this._setState(params);this._super(parent);},willStart:function(){return Promise.all([this._super(),this._fetchLeaveTypesData(),this._fetchDepartmentLeaves()]);},updateState:function(state){var self=this;var to_await=[];var updatedFields=this._setState(state);if(_.intersection(updatedFields,['employee','date']).length){to_await.push(this._fetchLeaveTypesData());}
if(_.intersection(updatedFields,['department','date']).length){to_await.push(this._fetchDepartmentLeaves());}
return Promise.all(to_await).then(function(){self.renderElement();});},_setState:function(state){var updatedFields=[];if(state.data.employee_id.res_id!==(this.employee&&this.employee.res_id)){updatedFields.push('employee');this.employee=state.data.employee_id;}
if(state.data.department_id.res_id!==(this.department&&this.department.res_id)){updatedFields.push('department');this.department=state.data.department_id;}
if(state.data.date_from!==this.date){updatedFields.push('date');this.date=state.data.date_from;}
return updatedFields;},_fetchDepartmentLeaves:function(){if(!this.date||!this.department){this.departmentLeaves=null;return Promise.resolve();}
var self=this;var month_date_from=this.date.clone().startOf('month');var month_date_to=this.date.clone().endOf('month');return this._rpc({model:'hr.leave',method:'search_read',args:[[['department_id','=',this.department.res_id],['state','=','validate'],['holiday_type','=','employee'],['date_from','<=',month_date_to],['date_to','>=',month_date_from]],['employee_id','date_from','date_to','number_of_days'],],}).then(function(data){var dateFormat=time.getLangDateFormat();self.departmentLeaves=data.map(function(leave){return _.extend(leave,{date_from:moment(leave.date_from).format(dateFormat),date_to:moment(leave.date_to).format(dateFormat),number_of_days:leave.number_of_days,});});});},_fetchLeaveTypesData:function(){if(!this.date||!this.employee){this.leavesPerType=null;return Promise.resolve();}
var self=this;var year_date_from=this.date.clone().startOf('year');var year_date_to=this.date.clone().endOf('year');return this._rpc({model:'hr.leave',method:'read_group',kwargs:{domain:[['employee_id','=',this.employee.res_id],['state','=','validate'],['date_from','<=',year_date_to],['date_to','>=',year_date_from]],fields:['holiday_status_id','number_of_days:sum'],groupby:['holiday_status_id'],},}).then(function(data){self.leavesPerType=data;});}});widget_registry.add('hr_leave_stats',LeaveStatsWidget);return LeaveStatsWidget;});;

/* /hr_holidays/static/src/bugfix/bugfix.js defined in bundle 'web.assets_backend' */
odoo.define('hr_holidays/static/src/bugfix/bugfix.js',function(require){'use strict';});odoo.define('hr_holidays/static/src/models/partner/partner.js',function(require){'use strict';const{registerClassPatchModel,registerFieldPatchModel,registerInstancePatchModel,}=require('mail/static/src/model/model_core.js');const{attr,one2one}=require('mail/static/src/model/model_field.js');const{clear}=require('mail/static/src/model/model_field_command.js');const{str_to_datetime}=require('web.time');registerClassPatchModel('mail.partner','hr_holidays/static/src/models/partner/partner.js',{convertData(data){const data2=this._super(data);if('out_of_office_date_end'in data){data2.outOfOfficeDateEnd=data.out_of_office_date_end?data.out_of_office_date_end:clear();}
return data2;},});registerInstancePatchModel('mail.partner','hr_holidays/static/src/models/partner/partner.js',{_computeOutOfOfficeText(){if(!this.outOfOfficeDateEnd){return clear();}
if(!this.env.messaging.locale.language){return clear();}
const currentDate=new Date();const date=str_to_datetime(this.outOfOfficeDateEnd);const options={day:'numeric',month:'short'};if(currentDate.getFullYear()!==date.getFullYear()){options.year='numeric';}
const localeCode=this.env.messaging.locale.language.replace(/_/g,'-');const formattedDate=date.toLocaleDateString(localeCode,options);return _.str.sprintf(this.env._t("Out of office until %s"),formattedDate);},});registerFieldPatchModel('mail.partner','hr/static/src/models/partner/partner.js',{locale:one2one('mail.locale',{related:'messaging.locale',}),outOfOfficeDateEnd:attr(),outOfOfficeText:attr({compute:'_computeOutOfOfficeText',dependencies:['locale','outOfOfficeDateEnd',],}),});});;

/* /hr_holidays/static/src/components/thread_view/thread_view.js defined in bundle 'web.assets_backend' */
odoo.define('hr_holidays/static/src/components/thread_view/thread_view.js',function(require){'use strict';const components={ThreadView:require('mail/static/src/components/thread_view/thread_view.js'),};const{patch}=require('web.utils');patch(components.ThreadView,'hr_holidays/static/src/components/thread_view/thread_view.js',{_useStoreSelector(props){const res=this._super(...arguments);const thread=res.thread;const correspondent=thread&&thread.correspondent;return Object.assign({},res,{correspondentOutOfOfficeText:correspondent&&correspondent.outOfOfficeText,});},});});;

/* /base_automation/static/src/js/base_automation_error_dialog.js defined in bundle 'web.assets_backend' */
odoo.define('base_automation.BaseAutomatioErrorDialog',function(require){"use strict";const CrashManager=require('web.CrashManager');const ErrorDialog=CrashManager.ErrorDialog;const ErrorDialogRegistry=require('web.ErrorDialogRegistry');const session=require('web.session');const BaseAutomationErrorDialog=ErrorDialog.extend({xmlDependencies:(ErrorDialog.prototype.xmlDependencies||[]).concat(['/base_automation/static/src/xml/base_automation_error_dialog.xml']),template:'CrashManager.BaseAutomationError',events:{'click .o_disable_action_button':'_onDisableAction','click .o_edit_action_button':'_onEditAction',},init:function(parent,options,error){this._super.apply(this,arguments);this.base_automation=error.data.context.base_automation;this.is_admin=session.is_admin;},_onDisableAction:function(ev){ev.preventDefault();this._rpc({model:'base.automation',method:'write',args:[[this.base_automation.id],{active:false,}],}).then(this.destroy.bind(this));},_onEditAction:function(ev){ev.preventDefault();this.do_action({name:'Automated Actions',res_model:'base.automation',res_id:this.base_automation.id,views:[[false,'form']],type:'ir.actions.act_window',view_mode:'form',});},});ErrorDialogRegistry.add('base_automation',BaseAutomationErrorDialog);});;

/* /project/static/src/js/project_kanban.js defined in bundle 'web.assets_backend' */
odoo.define('project.project_kanban',function(require){'use strict';var KanbanController=require('web.KanbanController');var KanbanView=require('web.KanbanView');var KanbanColumn=require('web.KanbanColumn');var view_registry=require('web.view_registry');var KanbanRecord=require('web.KanbanRecord');KanbanRecord.include({_openRecord:function(){if(this.selectionMode!==true&&this.modelName==='project.project'&&this.$(".o_project_kanban_boxes a").length){this.$('.o_project_kanban_boxes a').first().click();}else{this._super.apply(this,arguments);}},});var ProjectKanbanController=KanbanController.extend({custom_events:_.extend({},KanbanController.prototype.custom_events,{'kanban_column_delete_wizard':'_onDeleteColumnWizard',}),_onDeleteColumnWizard:function(ev){ev.stopPropagation();const self=this;const column_id=ev.target.id;var state=this.model.get(this.handle,{raw:true});this._rpc({model:'project.task.type',method:'unlink_wizard',args:[column_id],context:state.getContext(),}).then(function(res){self.do_action(res);});}});var ProjectKanbanView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Controller:ProjectKanbanController}),});KanbanColumn.include({_onDeleteColumn:function(event){event.preventDefault();if(this.modelName==='project.task'){this.trigger_up('kanban_column_delete_wizard');return;}
this._super.apply(this,arguments);}});view_registry.add('project_kanban',ProjectKanbanView);return ProjectKanbanController;});;

/* /project/static/src/js/project_rating_reporting.js defined in bundle 'web.assets_backend' */
odoo.define('project.project_rating_reporting',function(require){'use strict';const core=require('web.core');const _t=core._t;const viewRegistry=require('web.view_registry');const PivotController=require('web.PivotController');const PivotView=require('web.PivotView');const GraphController=require('web.GraphController');const GraphView=require('web.GraphView');var ProjectPivotController=PivotController.extend({init:function(){this._super.apply(this,arguments);var measures=JSON.parse(JSON.stringify(this.measures));if('res_id'in measures){measures.res_id.string=_t('Task');}
if('parent_res_id'in measures){measures.parent_res_id.string=_t('Project');}
if('rating'in measures){measures.rating.string=_t('Rating Value (/5)');}
this.measures=measures;},});var ProjectPivotView=PivotView.extend({config:_.extend({},PivotView.prototype.config,{Controller:ProjectPivotController,}),});viewRegistry.add('project_rating_pivot',ProjectPivotView);var ProjectGraphController=GraphController.extend({init:function(){this._super.apply(this,arguments);_.each(this.measures,measure=>{if(measure.fieldName==='res_id'){measure.description=_t('Task');}else if(measure.fieldName==='parent_res_id'){measure.description=_t('Project');}else if(measure.fieldName==='rating'){measure.description=_t('Rating Value (/5)');}});},});var ProjectGraphView=GraphView.extend({config:_.extend({},GraphView.prototype.config,{Controller:ProjectGraphController,}),});viewRegistry.add('project_rating_graph',ProjectGraphView);});;

/* /project/static/src/js/project_task_kanban_examples.js defined in bundle 'web.assets_backend' */
odoo.define('project.task_kanban_examples',function(require){'use strict';var core=require('web.core');var kanbanExamplesRegistry=require('web.kanban_examples_registry');var _lt=core._lt;var greenBullet='<span class="o_status o_status_green"></span>';var redBullet='<span class="o_status o_status_red"></span>';var star='<a style="color: gold;" class="fa fa-star"/>';var clock='<a class="fa fa-clock-o" />'
var description_activities=escFormat(_lt('%s Use the %s icon to organize your daily activities.'),'<br/>',clock);var description=escFormat(_lt('Prioritize Tasks by using the %s icon.'+'%s Use the %s button to signalize to your colleagues that a task is ready for the next stage.'+'%s Use the %s to signalize a problem or a need for discussion on a task.'+'%s'),star,'<br/>',greenBullet,'<br/>',redBullet,description_activities);function escFormat(){var args=arguments;return{toString:function(){args[0]=_.escape(args[0]);return _.str.sprintf.apply(_.str,args);},};}
kanbanExamplesRegistry.add('project',{ghostColumns:[_lt('New'),_lt('Assigned'),_lt('In Progress'),_lt('Done')],applyExamplesText:_lt("Use This For My Project"),examples:[{name:_lt('Software Development'),columns:[_lt('Backlog'),_lt('Specifications'),_lt('Development'),_lt('Tests'),_lt('Delivered')],description:escFormat(_lt('Prioritize Tasks by using the %s icon.'+'%s Use the %s button to inform your colleagues that a task is ready for the next stage.'+'%s Use the %s to indicate a problem or a need for discussion on a task.'+'%s'),star,'<br/>',greenBullet,'<br/>',redBullet,description_activities),bullets:[greenBullet,redBullet,star],},{name:_lt('Agile Scrum'),columns:[_lt('Backlog'),_lt('Sprint Backlog'),_lt('Sprint in Progress'),_lt('Sprint Complete'),_lt('Old Completed Sprint')],description:escFormat(_lt('Waiting for the next stage: use %s and %s bullets. %s'),greenBullet,redBullet,description_activities),bullets:[greenBullet,redBullet],},{name:_lt('Digital Marketing'),columns:[_lt('Ideas'),_lt('Researching'),_lt('Writing'),_lt('Editing'),_lt('Done')],description:escFormat(_lt('Everyone can propose ideas, and the Editor marks the best ones '+'as %s. Attach all documents or links to the task directly, to have all information about '+'a research centralized. %s'),greenBullet,description_activities),bullets:[greenBullet,redBullet],},{name:_lt('Customer Feedback'),columns:[_lt('New'),_lt('In development'),_lt('Done'),_lt('Refused')],description:escFormat(_lt('Customers propose feedbacks by email; Odoo creates tasks '+'automatically, and you can communicate on the task directly. Your managers decide which '+'feedback is accepted %s and which feedback is moved to the %s column. %s'),greenBullet,_lt('"Refused"'),description_activities),bullets:[greenBullet,redBullet],},{name:_lt('Getting Things Done (GTD)'),columns:[_lt('Inbox'),_lt('Today'),_lt('This Week'),_lt('This Month'),_lt('Long Term')],description:escFormat(_lt('Fill your Inbox easily with the email gateway. Periodically review your '+'Inbox and schedule tasks by moving them to others columns. Every day, you review the '+'%s column to move important tasks %s. Every Monday, you review the %s column. %s'),_lt('"This Week"'),_lt('"Today"'),_lt('"This Month"'),description_activities),},{name:_lt('Consulting'),columns:[_lt('New Projects'),_lt('Resources Allocation'),_lt('In Progress'),_lt('Done')],description:escFormat(_lt('Manage the lifecycle of your project using the kanban view. Add newly acquired projects, assign them and use the %s and %s to define if the project is ready for the next step. %s'),greenBullet,redBullet,description_activities),bullets:[greenBullet,redBullet],},{name:_lt('Research Project'),columns:[_lt('Brainstorm'),_lt('Research'),_lt('Draft'),_lt('Final Document')],description:escFormat(_lt('Handle your idea gathering within Tasks of your new Project and discuss them in the chatter of the tasks. Use the %s and %s to signalize what is the current status of your Idea. %s'),greenBullet,redBullet,description_activities),bullets:[greenBullet,redBullet],},{name:_lt('Website Redesign'),columns:[_lt('Page Ideas'),_lt('Copywriting'),_lt('Design'),_lt('Live')],description:escFormat(_lt('Handle your idea gathering within Tasks of your new Project and discuss them in the chatter of the tasks. Use the %s and %s to signalize what is the current status of your Idea. %s'),greenBullet,redBullet,description_activities),},{name:_lt('T-shirt Printing'),columns:[_lt('New Orders'),_lt('Logo Design'),_lt('To Print'),_lt('Done')],description:escFormat(_lt('Communicate with customers on the task using the email gateway. '+'Attach logo designs to the task, so that information flow from designers to the workers '+'who print the t-shirt. Organize priorities amongst orders %s using the icon. %s'),star,description_activities),bullets:[star],},{name:_lt('Design'),columns:[_lt('New Request'),_lt('Design'),_lt('Client Review'),_lt('Handoff')],description:description,bullets:[greenBullet,redBullet,star,clock],},{name:_lt('Publishing'),columns:[_lt('Ideas'),_lt('Writing'),_lt('Editing'),_lt('Published')],description:description,bullets:[greenBullet,redBullet,star,clock],},{name:_lt('Manufacturing'),columns:[_lt('New Orders'),_lt('Material Sourcing'),_lt('Manufacturing'),_lt('Assembling'),_lt('Delivered')],description:description,bullets:[greenBullet,redBullet,star,clock],},{name:_lt('Podcast and Video Production'),columns:[_lt('Research'),_lt('Script'),_lt('Recording'),_lt('Mixing'),_lt('Publishing')],description:description,bullets:[greenBullet,redBullet,star,clock],}],});});;

/* /project/static/src/js/tours/project.js defined in bundle 'web.assets_backend' */
odoo.define('project.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;tour.register('project_tour',{sequence:110,url:"/web",rainbowManMessage:"Congratulations, you are now a master of project management.",},[tour.stepUtils.showAppsMenuItem(),{trigger:'.o_app[data-menu-xmlid="project.menu_main_pm"]',content:_t('Want a better way to <b>manage your projects</b>? <i>It starts here.</i>'),position:'right',edition:'community',},{trigger:'.o_app[data-menu-xmlid="project.menu_main_pm"]',content:_t('Want a better way to <b>manage your projects</b>? <i>It starts here.</i>'),position:'bottom',edition:'enterprise',},{trigger:'.o-kanban-button-new',extra_trigger:'.o_project_kanban',content:_t('Let\'s create your first <b>project</b>.'),position:'bottom',width:200,},{trigger:'input.o_project_name',content:_t('Choose a <b>name</b> for your project. <i>It can be anything you want: the name of a customer,\
     of a product, of a team, of a construction site...</i>'),position:'right',},{trigger:'.o_open_tasks',content:_t('Let\'s create your first <b>project</b>.'),position:'top',run:function(actions){actions.auto('.modal:visible .btn.btn-primary');},},{trigger:".o_kanban_project_tasks .o_column_quick_create input",content:_t("Add columns to organize your tasks into <b>stages</b> <i>e.g. New - In Progress - Done</i>."),position:'bottom',},{trigger:".o_kanban_project_tasks .o_column_quick_create .o_kanban_add",auto:true,},{trigger:".o_kanban_project_tasks .o_column_quick_create input",extra_trigger:'.o_kanban_group',content:_t("Add columns to organize your tasks into <b>stages</b> <i>e.g. New - In Progress - Done</i>."),position:'bottom',},{trigger:".o_kanban_project_tasks .o_column_quick_create .o_kanban_add",auto:true,},{trigger:'.o-kanban-button-new',extra_trigger:'.o_kanban_group:eq(1)',content:_t("Let's create your first <b>task</b>."),position:'bottom',width:200,},{trigger:'.o_kanban_quick_create input.o_field_char[name=name]',extra_trigger:'.o_kanban_project_tasks',content:_t('Choose a task <b>name</b> <i>(e.g. Website Design, Purchase Goods...)</i>'),position:'right',},{trigger:'.o_kanban_quick_create .o_kanban_add',extra_trigger:'.o_kanban_project_tasks',content:_t("Add your task once it is ready."),position:"bottom",},{trigger:".o_kanban_record .oe_kanban_content",extra_trigger:'.o_kanban_project_tasks',content:_t("<b>Drag &amp; drop</b> the card to change your task from stage."),position:"bottom",run:"drag_and_drop .o_kanban_group:eq(1) ",},{trigger:".o_kanban_record:first",extra_trigger:'.o_kanban_project_tasks',content:_t("Let's start working on your task."),position:"bottom",},{trigger:".o_ChatterTopbar_buttonSendMessage",content:_t("Use this chatter to <b>send emails</b> and communicate efficently with your customers. \
    Add new people in the followers list to make them aware about the main changes about this task."),width:350,position:"bottom",},{trigger:".o_ChatterTopbar_buttonLogNote",content:_t("<b>Log notes</b> for internal communications <i>(the people following this task won't be notified \
    of the note you are logging unless you specifically tag them)</i>. Use @ <b>mentions</b> to ping a colleague \
    or # <b>mentions</b> to reach an entire team."),width:350,position:"bottom"},{trigger:".o_ChatterTopbar_buttonScheduleActivity",content:_t("Use <b>activities</b> to organize your daily work."),},{trigger:".modal-dialog .btn-primary",content:"Schedule your activity once it is ready",position:"bottom",run:"click",},{trigger:".breadcrumb-item:not(.active):last",extra_trigger:'.o_form_project_tasks.o_form_readonly',content:_t("Let's go back to your <b>kanban view</b> to have an overview of your next tasks."),position:"right",run:'click',}]);});;

/* /project/static/src/js/project_calendar.js defined in bundle 'web.assets_backend' */
odoo.define('project.ProjectCalendarView',function(require){"use strict";const CalendarController=require('web.CalendarController');const CalendarView=require('web.CalendarView');const viewRegistry=require('web.view_registry');const ProjectCalendarController=CalendarController.extend({_renderButtonsParameters(){return _.extend({},this._super(...arguments),{scaleDrop:true});},});const ProjectCalendarView=CalendarView.extend({config:_.extend({},CalendarView.prototype.config,{Controller:ProjectCalendarController,}),});viewRegistry.add('project_calendar',ProjectCalendarView);return ProjectCalendarView;});;

/* /hr_timesheet/static/src/js/task_with_hours.js defined in bundle 'web.assets_backend' */
odoo.define('hr_timesheet.task_with_hours',function(require){"use strict";var field_registry=require('web.field_registry');var relational_fields=require('web.relational_fields');var FieldMany2One=relational_fields.FieldMany2One;var TaskWithHours=FieldMany2One.extend({init:function(){this._super.apply(this,arguments);this.additionalContext.hr_timesheet_display_remaining_hours=true;},_getDisplayNameWithoutHours:function(value){return value.split('  ')[0];},_renderEdit:function(){this.m2o_value=this._getDisplayNameWithoutHours(this.m2o_value);this._super.apply(this,arguments);},});field_registry.add('task_with_hours',TaskWithHours);return TaskWithHours;});;

/* /hr_timesheet/static/src/js/timesheet_uom.js defined in bundle 'web.assets_backend' */
odoo.define('hr_timesheet.timesheet_uom',function(require){'use strict';const basicFields=require('web.basic_fields');const fieldUtils=require('web.field_utils');const fieldRegistry=require('web.field_registry');require('web._field_registry');const session=require('web.session');const FieldTimesheetFactor=basicFields.FieldFloatFactor.extend({formatType:'float_factor',init:function(parent,name,record,options){this._super(parent,name,record,options);if(session.timesheet_uom_factor){this.nodeOptions.factor=session.timesheet_uom_factor;this.parseOptions.factor=session.timesheet_uom_factor;}},});const FieldTimesheetToggle=basicFields.FieldFloatToggle.extend({formatType:'float_factor',init:function(parent,name,record,options){options=options||{};var fieldsInfo=record.fieldsInfo[options.viewType||'default'];var attrs=options.attrs||(fieldsInfo&&fieldsInfo[name])||{};var hasRange=_.contains(_.keys(attrs.options||{}),'range');this._super(parent,name,record,options);if(!hasRange){this.nodeOptions.range=[0.00,1.00,0.50];}
this.nodeOptions.factor=session.timesheet_uom_factor;},});const FieldTimesheetTime=basicFields.FieldFloatTime.extend({init:function(){this._super.apply(this,arguments);if(session.timesheet_uom_factor){this.nodeOptions.factor=session.timesheet_uom_factor;this.parseOptions.factor=session.timesheet_uom_factor;}}});const widgetName='timesheet_uom'in session?session.timesheet_uom.timesheet_widget:'float_factor';let FieldTimesheetUom=null;if(widgetName==='float_toggle'){FieldTimesheetUom=FieldTimesheetToggle;}else if(widgetName==='float_time'){FieldTimesheetUom=FieldTimesheetTime;}else{FieldTimesheetUom=(fieldRegistry.get(widgetName)&&fieldRegistry.get(widgetName).extend({}))||FieldTimesheetFactor;}
fieldRegistry.add('timesheet_uom',FieldTimesheetUom);let FieldTimesheetUomWithoutToggle=null;if(widgetName==='float_toggle'){FieldTimesheetUomWithoutToggle=FieldTimesheetFactor;}else{FieldTimesheetUomWithoutToggle=FieldTimesheetTime;}
fieldRegistry.add('timesheet_uom_no_toggle',FieldTimesheetUomWithoutToggle);const _tweak_options=function(options){if(!_.contains(options,'factor')){options.factor=session.timesheet_uom_factor;}
return options;};fieldUtils.format.timesheet_uom=function(value,field,options){options=_tweak_options(options||{});const formatter=fieldUtils.format[FieldTimesheetUom.prototype.formatType];return formatter(value,field,options);};fieldUtils.parse.timesheet_uom=function(value,field,options){options=_tweak_options(options||{});const parser=fieldUtils.parse[FieldTimesheetUom.prototype.formatType];return parser(value,field,options);};fieldUtils.format.timesheet_uom_no_toggle=function(value,field,options){options=_tweak_options(options||{});const formatter=fieldUtils.format[FieldTimesheetUom.prototype.formatType];return formatter(value,field,options);};fieldUtils.parse.timesheet_uom_no_toggle=function(value,field,options){options=_tweak_options(options||{});const parser=fieldUtils.parse[FieldTimesheetUom.prototype.formatType];return parser(value,field,options);};return{FieldTimesheetUom,FieldTimesheetFactor,FieldTimesheetTime,FieldTimesheetToggle};});;

/* /hr_timesheet/static/src/js/timesheet_factor.js defined in bundle 'web.assets_backend' */
odoo.define('hr_timesheet.timesheet_factor',function(require){'use strict';const timesheetUomFields=require('hr_timesheet.timesheet_uom');const fieldUtils=require('web.field_utils');const fieldRegistry=require('web.field_registry');fieldRegistry.add('timesheet_factor',timesheetUomFields.FieldTimesheetFactor);fieldUtils.format.timesheet_factor=function(value,field,options){const formatter=fieldUtils.format[timesheetUomFields.FieldTimesheetFactor.prototype.formatType];return formatter(value,field,options);};fieldUtils.parse.timesheet_factor=function(value,field,options){const parser=fieldUtils.parse[timesheetUomFields.FieldTimesheetFactor.prototype.formatType];return parser(value,field,options);};});;

/* /hr_timesheet/static/src/js/timesheet_config_form_view.js defined in bundle 'web.assets_backend' */
odoo.define('hr_timesheet.res.config.form',function(require){"use strict";const core=require('web.core');const config=require('web.config');const viewRegistry=require('web.view_registry');const BaseSetting=require('base.settings');const _t=core._t;const TimesheetConfigQRCodeMixin={async _renderView(){const self=this;await this._super(...arguments);const google_url="https://play.google.com/store/apps/details?id=com.odoo.OdooTimesheets";const apple_url="https://apps.apple.com/be/app/awesome-timesheet/id1078657549";const action_desktop={name:_t('Download our App'),type:'ir.actions.client',tag:'timesheet_qr_code_modal',target:'new',};this.$el.find('img.o_config_app_store').on('click',function(event){event.preventDefault();if(!config.device.isMobile){self.do_action(_.extend(action_desktop,{params:{'url':apple_url}}));}else{self.do_action({type:'ir.actions.act_url',url:apple_url});}});this.$el.find('img.o_config_play_store').on('click',function(event){event.preventDefault();if(!config.device.isMobile){self.do_action(_.extend(action_desktop,{params:{'url':google_url}}));}else{self.do_action({type:'ir.actions.act_url',url:google_url});}});},};var TimesheetConfigFormRenderer=BaseSetting.Renderer.extend(TimesheetConfigQRCodeMixin);const BaseSettingView=viewRegistry.get('base_settings');var TimesheetConfigFormView=BaseSettingView.extend({config:_.extend({},BaseSettingView.prototype.config,{Renderer:TimesheetConfigFormRenderer,}),});viewRegistry.add('hr_timesheet_config_form',TimesheetConfigFormView);return{TimesheetConfigQRCodeMixin,TimesheetConfigFormRenderer,TimesheetConfigFormView};});;

/* /hr_timesheet/static/src/js/qr_code_action.js defined in bundle 'web.assets_backend' */
odoo.define('hr_timesheet.qr_code_action',function(require){"use strict";const AbstractAction=require('web.AbstractAction');const core=require('web.core');const config=require('web.config');const QRModalAction=AbstractAction.extend({template:'hr_timesheet_qr_code',xmlDependencies:['/hr_timesheet/static/src/xml/qr_modal_template.xml'],init:function(parent,action){this._super.apply(this,arguments);this.url=_.str.sprintf("/report/barcode/?type=QR&value=%s&width=256&height=256&humanreadable=1",action.params.url);},});core.action_registry.add('timesheet_qr_code_modal',QRModalAction);});;

/* /purchase/static/src/js/purchase_dashboard.js defined in bundle 'web.assets_backend' */
odoo.define('purchase.dashboard',function(require){"use strict";var core=require('web.core');var ListController=require('web.ListController');var ListModel=require('web.ListModel');var ListRenderer=require('web.ListRenderer');var ListView=require('web.ListView');var KanbanController=require('web.KanbanController');var KanbanModel=require('web.KanbanModel');var KanbanRenderer=require('web.KanbanRenderer');var KanbanView=require('web.KanbanView');var SampleServer=require('web.SampleServer');var view_registry=require('web.view_registry');var QWeb=core.qweb;let dashboardValues;SampleServer.mockRegistry.add('purchase.order/retrieve_dashboard',()=>{return Object.assign({},dashboardValues);});var PurchaseListDashboardRenderer=ListRenderer.extend({events:_.extend({},ListRenderer.prototype.events,{'click .o_dashboard_action':'_onDashboardActionClicked',}),_renderView:function(){var self=this;return this._super.apply(this,arguments).then(function(){var values=self.state.dashboardValues;var purchase_dashboard=QWeb.render('purchase.PurchaseDashboard',{values:values,});self.$el.prepend(purchase_dashboard);});},_onDashboardActionClicked:function(e){e.preventDefault();var $action=$(e.currentTarget);this.trigger_up('dashboard_open_action',{action_name:$action.attr('name')+"_list",action_context:$action.attr('context'),});},});var PurchaseListDashboardModel=ListModel.extend({init:function(){this.dashboardValues={};this._super.apply(this,arguments);},__get:function(localID){var result=this._super.apply(this,arguments);if(_.isObject(result)){result.dashboardValues=this.dashboardValues[localID];}
return result;},__load:function(){return this._loadDashboard(this._super.apply(this,arguments));},__reload:function(){return this._loadDashboard(this._super.apply(this,arguments));},_loadDashboard:function(super_def){var self=this;var dashboard_def=this._rpc({model:'purchase.order',method:'retrieve_dashboard',});return Promise.all([super_def,dashboard_def]).then(function(results){var id=results[0];dashboardValues=results[1];self.dashboardValues[id]=dashboardValues;return id;});},});var PurchaseListDashboardController=ListController.extend({custom_events:_.extend({},ListController.prototype.custom_events,{dashboard_open_action:'_onDashboardOpenAction',}),_onDashboardOpenAction:function(e){return this.do_action(e.data.action_name,{additional_context:JSON.parse(e.data.action_context)});},});var PurchaseListDashboardView=ListView.extend({config:_.extend({},ListView.prototype.config,{Model:PurchaseListDashboardModel,Renderer:PurchaseListDashboardRenderer,Controller:PurchaseListDashboardController,}),});var PurchaseKanbanDashboardRenderer=KanbanRenderer.extend({events:_.extend({},KanbanRenderer.prototype.events,{'click .o_dashboard_action':'_onDashboardActionClicked',}),_render:function(){var self=this;return this._super.apply(this,arguments).then(function(){var values=self.state.dashboardValues;var purchase_dashboard=QWeb.render('purchase.PurchaseDashboard',{values:values,});self.$el.parent().find(".o_purchase_dashboard").remove();self.$el.before(purchase_dashboard);});},_onDashboardActionClicked:function(e){e.preventDefault();var $action=$(e.currentTarget);this.trigger_up('dashboard_open_action',{action_name:$action.attr('name')+"_kanban",action_context:$action.attr('context'),});},});var PurchaseKanbanDashboardModel=KanbanModel.extend({init:function(){this.dashboardValues={};this._super.apply(this,arguments);},__get:function(localID){var result=this._super.apply(this,arguments);if(_.isObject(result)){result.dashboardValues=this.dashboardValues[localID];}
return result;},__load:function(){return this._loadDashboard(this._super.apply(this,arguments));},__reload:function(){return this._loadDashboard(this._super.apply(this,arguments));},_loadDashboard:function(super_def){var self=this;var dashboard_def=this._rpc({model:'purchase.order',method:'retrieve_dashboard',});return Promise.all([super_def,dashboard_def]).then(function(results){var id=results[0];dashboardValues=results[1];self.dashboardValues[id]=dashboardValues;return id;});},});var PurchaseKanbanDashboardController=KanbanController.extend({custom_events:_.extend({},KanbanController.prototype.custom_events,{dashboard_open_action:'_onDashboardOpenAction',}),_onDashboardOpenAction:function(e){return this.do_action(e.data.action_name,{additional_context:JSON.parse(e.data.action_context)});},});var PurchaseKanbanDashboardView=KanbanView.extend({config:_.extend({},KanbanView.prototype.config,{Model:PurchaseKanbanDashboardModel,Renderer:PurchaseKanbanDashboardRenderer,Controller:PurchaseKanbanDashboardController,}),});view_registry.add('purchase_list_dashboard',PurchaseListDashboardView);view_registry.add('purchase_kanban_dashboard',PurchaseKanbanDashboardView);return{PurchaseListDashboardModel:PurchaseListDashboardModel,PurchaseListDashboardRenderer:PurchaseListDashboardRenderer,PurchaseListDashboardController:PurchaseListDashboardController,PurchaseKanbanDashboardModel:PurchaseKanbanDashboardModel,PurchaseKanbanDashboardRenderer:PurchaseKanbanDashboardRenderer,PurchaseKanbanDashboardController:PurchaseKanbanDashboardController};});;

/* /purchase/static/src/js/purchase_toaster_button.js defined in bundle 'web.assets_backend' */
odoo.define('purchase.ToasterButton',function(require){'use strict';const widgetRegistry=require('web.widget_registry');const Widget=require('web.Widget');const ToasterButton=Widget.extend({template:'purchase.ToasterButton',xmlDependencies:['/purchase/static/src/xml/purchase_toaster_button.xml'],events:Object.assign({},Widget.prototype.events,{'click .fa-info-circle':'_onClickButton',}),init:function(parent,data,node){this._super(...arguments);this.button_name=node.attrs.button_name;this.title=node.attrs.title;this.id=data.res_id;this.model=data.model;},_onClickButton:function(ev){this._rpc({method:this.button_name,model:this.model,args:[[this.id]],}).then(res=>{if(res){this.do_notify(false,res.toast_message);}})},});widgetRegistry.add('toaster_button',ToasterButton);return ToasterButton;});;

/* /purchase/static/src/js/tours/purchase.js defined in bundle 'web.assets_backend' */
odoo.define('purchase.purchase_steps',function(require){"use strict";var core=require('web.core');var PurchaseAdditionalTourSteps=core.Class.extend({_get_purchase_stock_steps:function(){return[{auto:true,trigger:".o_purchase_order",},];},});return PurchaseAdditionalTourSteps;});odoo.define('purchase.tour',function(require){"use strict";var core=require('web.core');var tour=require('web_tour.tour');var _t=core._t;var PurchaseAdditionalTourSteps=require('purchase.purchase_steps');tour.register('purchase_tour',{url:"/web",sequence:40,},[tour.stepUtils.showAppsMenuItem(),{trigger:'.o_app[data-menu-xmlid="purchase.menu_purchase_root"]',content:_t("Let's try the Purchase app to manage the flow from purchase to reception and invoice control."),position:'right',edition:'community'},{trigger:'.o_app[data-menu-xmlid="purchase.menu_purchase_root"]',content:_t("Let's try the Purchase app to manage the flow from purchase to reception and invoice control."),position:'bottom',edition:'enterprise'},{trigger:".o_list_button_add",extra_trigger:".o_purchase_order",content:_t("Let's create your first request for quotation."),position:"bottom",},{trigger:".o_form_editable .o_field_many2one[name='partner_id']",extra_trigger:".o_purchase_order",content:_t("Search a vendor name, or create one on the fly."),position:"bottom",run:function(actions){actions.text("Agrolait",this.$anchor.find("input"));},},{trigger:".ui-menu-item > a",auto:true,in_modal:false,},{trigger:".o_field_x2many_list_row_add > a",extra_trigger:".o_field_many2one[name='partner_id'] .o_external_button",content:_t("Add some products or services to your quotation."),position:"bottom",},{trigger:".o_field_widget[name=product_id], .o_field_widget[name=product_template_id]",extra_trigger:".o_purchase_order",content:_t("Select a product, or create a new one on the fly."),position:"right",run:function(actions){var $input=this.$anchor.find('input');actions.text("DESK0001",$input.length===0?this.$anchor:$input);var keyDownEvent=jQuery.Event("keydown");keyDownEvent.which=42;this.$anchor.trigger(keyDownEvent);var $descriptionElement=$('.o_form_editable textarea[name="name"]');$descriptionElement.change(function(){$descriptionElement.addClass('product_creation_success');});},},{trigger:'.ui-menu.ui-widget .ui-menu-item a:contains("DESK0001")',auto:true,},{trigger:'.o_form_editable textarea[name="name"].product_creation_success',auto:true,run:function(){}},{trigger:".o_form_editable input[name='product_qty'] ",extra_trigger:".o_purchase_order",content:_t("Indicate the product quantity you want to order."),position:"right",run:'text 12.0'},...tour.stepUtils.statusbarButtonsSteps('Send by Email',_t("Send the request for quotation to your vendor."),".o_statusbar_buttons button[name='action_rfq_send']"),{trigger:".modal-content",auto:true,run:function(actions){var $input=$(".modal-content input[name='email']");if($input.length){actions.text("agrolait@example.com",$input);actions.click($(".modal-footer button"));}}},{trigger:".modal-footer button[name='action_send_mail']",extra_trigger:".modal-footer button[name='action_send_mail']",content:_t("Send the request for quotation to your vendor."),position:"left",run:'click',},{trigger:".ui-sortable-handle",extra_trigger:".o_purchase_order",content:_t("Click here to edit or move the quotation line."),position:"bottom",run:'click',},{trigger:".o_form_editable input[name='price_unit']",extra_trigger:".o_form_editable input[name='price_unit']",content:_t("Once you get the price from the vendor, you can complete the purchase order with the right price."),position:"right",run:'text 200.00'},{auto:true,trigger:".o_purchase_order",run:'click',},...tour.stepUtils.statusbarButtonsSteps('Confirm Order',_t("Confirm your purchase.")),...new PurchaseAdditionalTourSteps()._get_purchase_stock_steps(),]);});;

/* /purchase_stock/static/src/js/tours/purchase_stock.js defined in bundle 'web.assets_backend' */
odoo.define('purchase_stock.purchase_steps',function(require){"use strict";var core=require('web.core');var _t=core._t;var PurchaseAdditionalTourSteps=require('purchase.purchase_steps');PurchaseAdditionalTourSteps.include({init:function(){this._super.apply(this,arguments);},_get_purchase_stock_steps:function(){this._super.apply(this,arguments);return[{trigger:".oe_button_box button[name='action_view_picking']",extra_trigger:".oe_button_box button[name='action_view_picking']",content:_t("Receive the ordered products."),position:"bottom",run:'click',},{trigger:".o_statusbar_buttons button[name='button_validate']",content:_t("Validate the receipt of all ordered products."),position:"bottom",run:'click',},{trigger:".modal-footer .btn-primary",extra_trigger:".modal-dialog",content:_t("Process all the receipt quantities."),position:"bottom",},{trigger:".o_back_button a, .breadcrumb-item:not('.active'):last",content:_t('Go back to the purchase order to generate the vendor bill.'),position:'bottom',},{trigger:".o_statusbar_buttons button[name='action_create_invoice']",content:_t("Generate the draft vendor bill."),position:"bottom",run:'click',}];}});return PurchaseAdditionalTourSteps;});;

/* /sh_all_in_one_helpdesk/static/src/js/helpdesk_ticket_kanban_examples.js defined in bundle 'web.assets_backend' */
odoo.define('sh_all_in_one_helpdesk.helpdesk_ticket_kanban_examples',function(require){'use strict';var core=require('web.core');var kanbanExamplesRegistry=require('web.kanban_examples_registry');var _lt=core._lt;kanbanExamplesRegistry.add('sh_all_in_one_helpdesk',{ghostColumns:[_lt('New'),_lt('In Progress'),_lt('Done'),_lt('Closed'),_lt('Reopened'),_lt('Cancelled')],});});;

/* /sh_all_in_one_helpdesk/static/src/js/helpdesk_ticket_dasboard.js defined in bundle 'web.assets_backend' */
odoo.define('sh_all_in_one_helpdesk.helpdesk_ticket_dasboard',function(require){var ajax=require('web.ajax');var core=require('web.core');var rpc=require('web.rpc');var qweb=core.qweb;var _t=core._t;var KanbanRenderer=require("web.KanbanRenderer");KanbanRenderer.include({events:_.extend({},KanbanRenderer.prototype.events||{},{"click .sh_tile_click":"action_all_tickets",}),action_all_tickets:function(event){event.stopPropagation();event.preventDefault();var self=this;var $el=$(event.currentTarget).attr("data-res_ids");if($el==undefined){this._rpc({model:"ir.model.data",method:"xmlid_to_res_model_res_id",args:["sh_all_in_one_helpdesk.helpdesk_ticket_form_view"],}).then(function(data){self.do_action({name:_t("Tickets"),type:"ir.actions.act_window",res_model:"helpdesk.ticket",view_mode:"kanban,tree,form",views:[[false,"kanban"],[false,"list"],[data[1],"form"],],domain:[["id","in",[]]],target:"current",},);});}
else{var list_value=JSON.parse($el);this._rpc({model:"ir.model.data",method:"xmlid_to_res_model_res_id",args:["sh_all_in_one_helpdesk.helpdesk_ticket_form_view"],}).then(function(data){self.do_action({name:_t("Tickets"),type:"ir.actions.act_window",res_model:"helpdesk.ticket",view_mode:"kanban,tree,form",views:[[false,"kanban"],[false,"list"],[data[1],"form"],],domain:[["id","in",list_value]],target:"current",},);});}},});});;

/* /sh_all_in_one_helpdesk/sh_helpdesk_timesheet/static/src/js/time_track.js defined in bundle 'web.assets_backend' */
odoo.define("sh_all_in_one_helpdesk.time_track",function(require){"use strict";var AbstractField=require("web.AbstractField");var core=require("web.core");var field_registry=require("web.field_registry");var time=require("web.time");var Widget=require("web.Widget");var _t=core._t;var TimeCounter=AbstractField.extend({supportedFieldTypes:[],willStart:function(){var self=this;var def=this._rpc({model:"account.analytic.line",method:"search_read",domain:[["ticket_id","=",this.record.data.id],["end_date","=",false],["start_date","!=",false],],}).then(function(result){if(self.mode==="readonly"){var currentDate=new Date();self.duration=0;_.each(result,function(data){self.duration+=data.end_date?self._getDateDifference(data.start_date,data.end_date):self._getDateDifference(time.auto_str_to_date(data.start_date),currentDate);});}});return $.when(this._super.apply(this,arguments),def);},destroy:function(){this._super.apply(this,arguments);clearTimeout(this.timer);},isSet:function(){return true;},_getDateDifference:function(dateStart,dateEnd){return moment(dateEnd).diff(moment(dateStart));},_render:function(){this._startTimeCounter();},_startTimeCounter:function(){var self=this;this.timer="";clearTimeout(this.timer);if(this.record.data.start_time){this.timer=setTimeout(function(){self.duration+=1000;self._startTimeCounter();},1000);}else{clearTimeout(this.timer);}
this.$el.html($("<span>"+moment.utc(this.duration).format("HH:mm:ss")+"</span>"));},});field_registry.add("ticket_time_counter",TimeCounter);});;

/* /sale_timesheet/static/src/js/project_overview.js defined in bundle 'web.assets_backend' */
odoo.define('sale_timesheet.project_overview',function(require){"use strict";var qweb=require('web.qweb');var viewRegistry=require('web.view_registry');const Controller=qweb.Controller.extend({events:_.extend({},qweb.Controller.prototype.events,{'click .project_overview_foldable':'_onFoldToggle',}),_onFoldToggle(ev){const{model,resId}=ev.target.dataset;const shouldOpen=ev.target.classList.contains('fa-caret-right');if(model==='sale.order'&&shouldOpen){this._openSaleOrder(resId);}
else if(model==='sale.order.line'&&shouldOpen){this._openSaleOrderLine(resId);}
else{const targetClass=`.${model.replace(/\./g, '_')}_${resId || 'None'}`;this.$(targetClass).hide();}
$(ev.target).toggleClass('fa-caret-right');$(ev.target).toggleClass('fa-caret-down');},_openSaleOrder(id){id=id||'None';const targetClass=`.sale_order_${id}`;this.$(`.o_timesheet_forecast_sale_order_line${targetClass}`).show();this.$(`.o_timesheet_forecast_hr_employee${targetClass}`).hide();this.$(`.o_timesheet_forecast_sale_order_line${targetClass} .fa`).removeClass('fa-caret-down');this.$(`.o_timesheet_forecast_sale_order_line${targetClass} .fa`).addClass('fa-caret-right');},_openSaleOrderLine(id){id=id||'None';const targetClass=`.sale_order_line_${id}`;this.$(`.o_timesheet_forecast_hr_employee${targetClass}`).show();},});var ProjectOverview=qweb.View.extend({withSearchBar:true,searchMenuTypes:['filter','favorite'],config:_.extend({},qweb.View.prototype.config,{Controller:Controller,}),});viewRegistry.add('project_overview',ProjectOverview);});;

/* /sale_timesheet/static/src/js/sale_project_kanban_controller.js defined in bundle 'web.assets_backend' */
odoo.define('sale_timesheet.sale_project_kanban_controller',function(require){"use strict";var core=require('web.core');var ProjectKanbanController=require('project.project_kanban');var session=require('web.session');var QWeb=core.qweb;var SaleProjectKanbanController=ProjectKanbanController.include({_showCreateSOButton:async function(){var self=this;this.activeProjectIds=this.initialState.context.active_ids;if(!this.activeProjectIds||this.activeProjectIds.length!==1){this.showCreateSaleOrder=false;return;}
var canCreateSO=await session.user_has_group('sales_team.group_sale_salesman');if(canCreateSO){await this._rpc({model:'project.project',method:'search_count',args:[[["id","in",this.activeProjectIds],["bill_type","=","customer_project"],["sale_order_id","=",false],["allow_billable","=",true],["allow_timesheets","=",true],]],}).then(function(projectCount){self.showCreateSaleOrder=projectCount!==0;});}else{this.showCreateSaleOrder=false;}},_onCreateSaleOrder:function(ev){ev.preventDefault();this.do_action('sale_timesheet.project_project_action_multi_create_sale_order',{additional_context:{'active_id':this.activeProjectIds&&this.activeProjectIds[0],'active_model':"project.project",},on_close:async()=>await this.reload()});},});return SaleProjectKanbanController;});;

/* /sale_timesheet_edit/static/src/js/so_line_one2many.js defined in bundle 'web.assets_backend' */
odoo.define('sale_timesheet_edit.so_line_many2one',function(require){"use strict";const fieldRegistry=require('web.field_registry');const FieldOne2Many=require('web.relational_fields').FieldOne2Many;const SoLineOne2Many=FieldOne2Many.extend({_onFieldChanged:function(ev){if(ev.data.changes&&ev.data.changes.hasOwnProperty('timesheet_ids')&&ev.data.changes.timesheet_ids.operation==='UPDATE'&&ev.data.changes.timesheet_ids.data&&ev.data.changes.timesheet_ids.data.hasOwnProperty('so_line')){const line=this.value.data.find(line=>{return line.id===ev.data.changes.timesheet_ids.id;});if(!line.is_so_line_edited){ev.data.changes.timesheet_ids.data.is_so_line_edited=true;}}
this._super.apply(this,arguments);}});fieldRegistry.add('so_line_one2many',SoLineOne2Many);});